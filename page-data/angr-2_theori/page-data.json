{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/angr-2_theori/",
    "result": {"data":{"cur":{"id":"f6538b07-37c9-5934-8a8a-c3719dbe59ea","html":"<h2 id=\"the-loader\" style=\"position:relative;\"><a href=\"#the-loader\" aria-label=\"the loader permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Loader</h2>\n<ul>\n<li>\n<p><code class=\"language-text\">example/fauxware/fauxware</code> 를 로드하고 로더와 상호 작용 하는 방법에 대해 알아보자</p>\n</li>\n<li>\n<p>예제로 사용할 바이너리는 다음 링크에서 다운로드: <a href=\"https://github.com/dnsdudrla97/angr-doc/tree/master/examples/fauxware-SOLVED\">dnsdudrla97/angr-doc</a></p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> angr<span class=\"token punctuation\">,</span> monkeyhex\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader\n<span class=\"token operator\">&lt;</span>Loaded fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0xc08000</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></code></pre></div>\n<hr>\n<h2 id=\"loaded-objects\" style=\"position:relative;\"><a href=\"#loaded-objects\" aria-label=\"loaded objects permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loaded Objects</h2>\n<ul>\n<li>CLE 로더 (cle.Loader)는 로드된 바이너리 객체의 전체 그룹을 나타내며 단일 메모리 공간에 로드되고 매핑된다.</li>\n<li>각 바이너리 객체는 파일 형식(cle.Backend의 subclass)을 처리할 수 있는 loader backend에 의해 로드된다.</li>\n<li><em>예를 들어, cle.ELF 는 ELF 바이너리 파일을 로드 하는 데 사용된다.</em></li>\n<li>메모리에 로드된 바이너리 수 와 일치하지 않는 객체도 있을 것이며 예를 들어, <code class=\"language-text\">Thread-local Storage</code> 지원을 제공하는 데 사용되는 객체와 확인되지 않은 Symbols을 제공하는데 사용되는 외부 객체</li>\n<li>CLE가 <code class=\"language-text\">loader.all_objects</code> 와 함께 로드한 전체 목록뿐만 아니라 다음과 같이 몇 가지 추가 표적 분류도 얻을 수있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>all_objects\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ELF Object libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x700000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x8f14d7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ELF Object ld<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x900000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x92f18f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ExternObject Object cle<span class=\"token comment\">##externs, maps [0xa00000:0xa80000]>,</span>\n <span class=\"token operator\">&lt;</span>ELFTLSObjectV2 Object cle<span class=\"token comment\">##tls, maps [0xb00000:0xb15010]>,</span>\n <span class=\"token operator\">&lt;</span>KernelObject Object cle<span class=\"token comment\">##kernel, maps [0xc00000:0xc08000]>]</span>\n\n<span class=\"token comment\"># 프로젝트 로드시 직접 지정한 main_object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object\n<span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\"># shared 객체와 이름을 매핑해서 보여줌</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>shared_objects\n<span class=\"token punctuation\">{</span><span class=\"token string\">'fauxware'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ELF Object libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x700000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x8f14d7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'ld-linux-x86-64.so.2'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ELF Object ld<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x900000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x92f18f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'extern-address space'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ExternObject Object cle<span class=\"token comment\">##externs, maps [0xa00000:0xa80000]>,</span>\n <span class=\"token string\">'cle##tls'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ELFTLSObjectV2 Object cle<span class=\"token comment\">##tls, maps [0xb00000:0xb15010]>}</span>\n\n<span class=\"token comment\"># ELF 파일에서 로드된 모든 객체</span>\n<span class=\"token comment\"># Window OS 일 경우 all_pe_object를 사용하자</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>all_elf_objects\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ELF Object libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x700000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x8f14d7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ELF Object ld<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x900000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x92f18f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># externs_object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>extern_object\n<span class=\"token operator\">&lt;</span>ExternObject Object cle<span class=\"token comment\">##externs, maps [0xa00000:0xa80000]></span>\n\n<span class=\"token comment\"># kernel_object : syscall에 주소를 제공하는데 사용</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>kernel_object\n<span class=\"token operator\">&lt;</span>KernelObject Object cle<span class=\"token comment\">##kernel, maps [0xc00000:0xc08000]></span>\n\n<span class=\"token comment\">#주소가 주어진 객체에 대한 참조를 얻을 수 있다</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>find_object_containing<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>해당 객체들과 직접 상호 작용하여 메타 데이터를 추출 할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> obj <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object\n<span class=\"token comment\"># 객체의 entry point</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>entry\n<span class=\"token number\">0x400580</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>min_addr<span class=\"token punctuation\">,</span> obj<span class=\"token punctuation\">.</span>max_addr\n<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x60105f</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ELF의 세그먼트와 섹션을 검색한다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>segments\n<span class=\"token operator\">&lt;</span>Regions<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n\t<span class=\"token operator\">&lt;</span>ELFSegment flags<span class=\"token operator\">=</span><span class=\"token number\">0x5</span><span class=\"token punctuation\">,</span> relro<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> vaddr<span class=\"token operator\">=</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">,</span> memsize<span class=\"token operator\">=</span><span class=\"token number\">0xa74</span><span class=\"token punctuation\">,</span> filesize<span class=\"token operator\">=</span><span class=\"token number\">0xa74</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span>ELFSegment flags<span class=\"token operator\">=</span><span class=\"token number\">0x4</span><span class=\"token punctuation\">,</span> relro<span class=\"token operator\">=</span><span class=\"token number\">0x1</span><span class=\"token punctuation\">,</span> vaddr<span class=\"token operator\">=</span><span class=\"token number\">0x600e28</span><span class=\"token punctuation\">,</span> memsize<span class=\"token operator\">=</span><span class=\"token number\">0x1d8</span><span class=\"token punctuation\">,</span> filesize<span class=\"token operator\">=</span><span class=\"token number\">0x1d8</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0xe28</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span>ELFSegment flags<span class=\"token operator\">=</span><span class=\"token number\">0x6</span><span class=\"token punctuation\">,</span>  relro<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> vaddr<span class=\"token operator\">=</span><span class=\"token number\">0x601000</span><span class=\"token punctuation\">,</span> memsize<span class=\"token operator\">=</span><span class=\"token number\">0x60</span><span class=\"token punctuation\">,</span> filesize<span class=\"token operator\">=</span><span class=\"token number\">0x50</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0x1000</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>sections\n<span class=\"token operator\">&lt;</span>Regions<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n\t<span class=\"token operator\">&lt;</span>Unnamed <span class=\"token operator\">|</span> offset <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>interp <span class=\"token operator\">|</span> offset <span class=\"token number\">0x238</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400238</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x1c</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>note<span class=\"token punctuation\">.</span>ABI<span class=\"token operator\">-</span>tag <span class=\"token operator\">|</span> offset <span class=\"token number\">0x254</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400254</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x20</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>note<span class=\"token punctuation\">.</span>gnu<span class=\"token punctuation\">.</span>build<span class=\"token operator\">-</span><span class=\"token builtin\">id</span> <span class=\"token operator\">|</span> offset <span class=\"token number\">0x274</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400274</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x24</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>gnu<span class=\"token punctuation\">.</span><span class=\"token builtin\">hash</span> <span class=\"token operator\">|</span> offset <span class=\"token number\">0x298</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400298</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x1c</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>dynsym <span class=\"token operator\">|</span> offset <span class=\"token number\">0x2b8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4002b8</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0xd8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>dynstr <span class=\"token operator\">|</span> offset <span class=\"token number\">0x390</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400390</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x5a</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>gnu<span class=\"token punctuation\">.</span>version <span class=\"token operator\">|</span> offset <span class=\"token number\">0x3ea</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4003ea</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x12</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>gnu<span class=\"token punctuation\">.</span>version_r <span class=\"token operator\">|</span> offset <span class=\"token number\">0x400</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400400</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x20</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>rela<span class=\"token punctuation\">.</span>dyn <span class=\"token operator\">|</span> offset <span class=\"token number\">0x420</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400420</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x18</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>rela<span class=\"token punctuation\">.</span>plt <span class=\"token operator\">|</span> offset <span class=\"token number\">0x438</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400438</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0xa8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>init <span class=\"token operator\">|</span> offset <span class=\"token number\">0x4e0</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4004e0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x18</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>plt <span class=\"token operator\">|</span> offset <span class=\"token number\">0x500</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400500</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x80</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">|</span> offset <span class=\"token number\">0x580</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400580</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x338</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>fini <span class=\"token operator\">|</span> offset <span class=\"token number\">0x8b8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4008b8</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0xe</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>rodata <span class=\"token operator\">|</span> offset <span class=\"token number\">0x8c8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4008c8</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x63</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>eh_frame_hdr <span class=\"token operator\">|</span> offset <span class=\"token number\">0x92c</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x40092c</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x44</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>eh_frame <span class=\"token operator\">|</span> offset <span class=\"token number\">0x970</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400970</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x104</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>ctors <span class=\"token operator\">|</span> offset <span class=\"token number\">0xe28</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600e28</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x10</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>dtors <span class=\"token operator\">|</span> offset <span class=\"token number\">0xe38</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600e38</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x10</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>jcr <span class=\"token operator\">|</span> offset <span class=\"token number\">0xe48</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600e48</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>dynamic <span class=\"token operator\">|</span> offset <span class=\"token number\">0xe50</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600e50</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x190</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>got <span class=\"token operator\">|</span> offset <span class=\"token number\">0xfe0</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600fe0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">.</span>plt <span class=\"token operator\">|</span> offset <span class=\"token number\">0xfe8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600fe8</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x50</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>data <span class=\"token operator\">|</span> offset <span class=\"token number\">0x1038</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x601038</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x18</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>bss <span class=\"token operator\">|</span> offset <span class=\"token number\">0x1050</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x601050</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x10</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>comment <span class=\"token operator\">|</span> offset <span class=\"token number\">0x1050</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x2a</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>shstrtab <span class=\"token operator\">|</span> offset <span class=\"token number\">0x107a</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0xfe</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>symtab <span class=\"token operator\">|</span> offset <span class=\"token number\">0x18f8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x6d8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>strtab <span class=\"token operator\">|</span> offset <span class=\"token number\">0x1fd0</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x278</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\"># 포함되어진 주소로 개별 세그먼트 또는 섹션을 가져올 수 있다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>find_segment_containing<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>ELFSegment flags<span class=\"token operator\">=</span><span class=\"token number\">0x5</span><span class=\"token punctuation\">,</span> relro<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> vaddr<span class=\"token operator\">=</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">,</span>\n\tmemsize<span class=\"token operator\">=</span><span class=\"token number\">0xa74</span><span class=\"token punctuation\">,</span> filesize<span class=\"token operator\">=</span><span class=\"token number\">0xa74</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>find_section_containing<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">|</span> offset <span class=\"token number\">0x580</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400580</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x338</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\"># symbols 대한 PLT stub 주소를 가져 온다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>plt\n<span class=\"token punctuation\">{</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400510</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'printf'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400520</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'read'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400530</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__libc_start_main'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400540</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'strcmp'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400550</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'open'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400560</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'exit'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400570</span><span class=\"token punctuation\">}</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'strcmp'</span><span class=\"token punctuation\">]</span>\n<span class=\"token number\">0x400550</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>reverse_plt<span class=\"token punctuation\">[</span><span class=\"token number\">0x400550</span><span class=\"token punctuation\">]</span>\n<span class=\"token string\">'strcmp'</span>\n\n<span class=\"token comment\"># prelinked base, CLE에 이해 실제로 메모리에 매핑 된 위치를 표시한다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>linked_base\n<span class=\"token number\">0x400000</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>mapped_base\n<span class=\"token number\">0x400000</span></code></pre></div>\n<hr>\n<h2 id=\"symbols-and-relocations\" style=\"position:relative;\"><a href=\"#symbols-and-relocations\" aria-label=\"symbols and relocations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Symbols and Relocations</h2>\n<ul>\n<li>CLE를 사용하는 동안 Symbolic으로 작업 할 수 도 있다.</li>\n<li>Symbolic은 이름을 주소에 효과적으로 매핑하는 실행 가능한 형식 이다.</li>\n<li>CLE에서 Symbolic을 가져 오는 가장 쉬운 방법은 <code class=\"language-text\">loader.find_symbol</code> 을 사용하는 것이다.</li>\n<li>해당 방법은 이름이나 주소를 취하고 <code class=\"language-text\">Symbol</code> 객체를 반환한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>find_symbol<span class=\"token punctuation\">(</span><span class=\"token string\">'strcmp'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp\n<span class=\"token operator\">&lt;</span>Symbol <span class=\"token string\">\"strcmp\"</span> <span class=\"token keyword\">in</span> libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so at <span class=\"token number\">0x7a22d0</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>Symbolic에서 가장 유용한 속성은 이름, 소유자 및 주소이지만 Symbol의 주소는 모호할 수 있다.</li>\n<li>Symbol 객체에는 주소를 얻을 수 있는 세 가지 방법이 있다.\n<ul>\n<li><code class=\"language-text\">.rebased_addr</code>\n<ul>\n<li>전역 주소 공간의 주소이다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">.linked_addr</code>\n<ul>\n<li>바이너리의 미리 연결된 베이스에 상대적인 주소, 예를 들어 <code class=\"language-text\">readelf(1)</code></li>\n</ul>\n</li>\n<li><code class=\"language-text\">.relative_addr</code>\n<ul>\n<li>객체 기반에 상대적인  주소이다.</li>\n<li>이는 문헌(Window 문헌)에서 RVA(상대 가상 주소)로 알려져 있다.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>name\n<span class=\"token string\">'strcmp'</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>owner\n<span class=\"token operator\">&lt;</span>ELF Object libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x700000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x8f14d7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>rebased_addr\n<span class=\"token number\">0x7a22d0</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>linked_addr\n<span class=\"token number\">0xa22d0</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>relative_addr\n<span class=\"token number\">0xa22d0</span></code></pre></div>\n<ul>\n<li>디버그 정보를 제공하는 것 외에도 심볼은 동적 연결 개념도 지원한다.</li>\n<li><code class=\"language-text\">libc stcmp</code> Symbol를 내보내기로 제공하며 기본 바이너리가 이에 종속이 된다.</li>\n<li>CLE에 게 주 개체에서 직접 <code class=\"language-text\">strcmp</code> 기호를 제공하도록 요청하면 이것이 가져 오기 Symbol임을 알려준다.</li>\n<li>가져 오기 Symbol에는 연관된 의미 있는 주소가 없겠지만 <code class=\"language-text\">.resolvedby</code> 와 같이 이를 해결하는데 사용 된 기호에 대한 참조를 제공한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>is_export\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>is_import\n<span class=\"token boolean\">False</span>\n<span class=\"token comment\"># Loader에서 메서드는 Symbol을 찾기 위해 검색 작업을 수행하므로 find_symbol이다.</span>\n<span class=\"token comment\"># 단일 객체에서 메서드는 주어진 이름을 가진 심볼이 하나만 있을 수 있기 때문에 get_symbol이다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> main_strcmp <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object<span class=\"token punctuation\">.</span>get_symbol<span class=\"token punctuation\">(</span><span class=\"token string\">'strcmp'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>Symbol <span class=\"token string\">\"strcmp\"</span> <span class=\"token keyword\">in</span> fauxware <span class=\"token punctuation\">(</span><span class=\"token keyword\">import</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> main_strcmp<span class=\"token punctuation\">.</span>is_export\n<span class=\"token boolean\">False</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> main_strcmp<span class=\"token punctuation\">.</span>is_import\n<span class=\"token boolean\">True</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> main_strcmp<span class=\"token punctuation\">.</span>resolvedby\n<span class=\"token operator\">&lt;</span>Symbol <span class=\"token string\">\"strcmp\"</span> <span class=\"token keyword\">in</span> libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so at <span class=\"token number\">0x7a22d0</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>\n<p><code class=\"language-text\">import</code> , <code class=\"language-text\">export</code> 사이의 링크가 메모리에 등록되어야 하며 특정 방법은 재배치라는 또 다른 개념에 의해 처리가 된다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">재배치</code> 는 “[import]를 export symbol와 일치 시킬 때 [format] 형식의 [locate]에 export 주소를 써라” 라고 말한다.</p>\n</li>\n<li>\n<p>객체 (Relocation 인스턴스) 에 대한 전체 재배치 목록을 obj.relocs로 볼 수 있거나 심볼 이름에서 Relocationd으로 매핑 (obj.import) 만 볼 수 있다.</p>\n</li>\n<li>\n<p>해당 export symbol 목록이 없</p>\n</li>\n<li>\n<p>재배치의 해당 가져 오기 Symbol로 액세스 할 수 있다.</p>\n</li>\n<li>\n<p>재배치가 쓸 주소는 Symbol에 사용할 수 있는 모든 주소 식벌자을 통해 액세스 할 수 있다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">.owner</code> 로 재배치를 요청하는 객체에 대한 참조도 가져올 수 있다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>shared_objects<span class=\"token punctuation\">[</span><span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>imports\n<span class=\"token punctuation\">{</span><span class=\"token string\">'__libpthread_freeres'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c40a80a0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_rtld_global'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c403af40</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__libc_enable_secure'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c405ad60</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_rtld_global_ro'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c405a100</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_dl_starting_up'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c405aeb0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__libdl_freeres'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c408f8b0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_dl_argv'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c405a2e0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__tls_get_addr'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_JUMP_SLOT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c4045100</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_dl_exception_create'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_JUMP_SLOT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c4045460</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__tunable_get_val'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_JUMP_SLOT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c4045910</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_dl_find_dso_for_object'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_JUMP_SLOT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c408fa00</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>예를 들어 공유 라이브러리를 찾을 수 없어서 import를 export로 확인할 수 있 없는 경우 CLE는 externsn  객체</li>\n<li>(loader.extern_obj) 를 자동으로 업데이트 하여 심볼을 내보내기로 제공한다.</li>\n</ul>\n<hr>\n<h2 id=\"loading-options\" style=\"position:relative;\"><a href=\"#loading-options\" aria-label=\"loading options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loading Options</h2>\n<ul>\n<li><code class=\"language-text\">angr.Project</code>로 바이너리를 로드하고 Project가 암시 적으로 생성하는 <code class=\"language-text\">cle.Loader</code> 인스턴스에 옵션을 전달하려는 경우 키워드 인수를 Project 생성자에 직접 전달할 수 있으며 <code class=\"language-text\">CLE</code> 에 전달된다.</li>\n</ul>\n<h2 id=\"basic-options\" style=\"position:relative;\"><a href=\"#basic-options\" aria-label=\"basic options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Basic Options</h2>\n<ul>\n<li>\n<p><code class=\"language-text\">auto_load_libs</code> 공유 라이브러리 종속성을 자동으로 해결하려는 <code class=\"language-text\">CLE</code> 의 시도를 활성화 또는 비활성화 하며 기본적으로 켜 져 있다.</p>\n</li>\n<li>\n<p>또한 그 반대인 <code class=\"language-text\">except_missing_libs</code> 가 있다. <code class=\"language-text\">True</code> 로 설정하면 바이너리에 해결할 수 없는 공유 라이브러리 종속성이 있을 때마다 예외가 발생한다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">force_load_libs</code> 에 문자열 목록을 전달할 수 있으며 나열된 모든 항목은 게이트에서 바로 해결되지 않은 공유 라이브러리 종속성으로 처리되거나 해당 이름의 라이브러리가 종속성으로 확인되지 않도록 문자열 목록을 <code class=\"language-text\">skip_libs</code> 에 전달할 수 있다.</p>\n</li>\n<li>\n<p>또한 문자열 목록  (또는 단일 문자열)을 <code class=\"language-text\">ld_path</code> 에 전달할 수 있다.</p>\n</li>\n<li>\n<p>이 목록은 공유 라이브러리에 대한 추가 검색 경로로 사용될 수 있다.</p>\n</li>\n<li>\n<p>기본 값은 로드 된 프로그램과 동일한 디렉토리, 현재 작업 디렉토리, 및 시스템 라이브러리 가 있다.</p>\n</li>\n</ul>\n<h2 id=\"per-binary-options\" style=\"position:relative;\"><a href=\"#per-binary-options\" aria-label=\"per binary options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Per-Binary Options</h2>\n<ul>\n<li>\n<p>특정 바이너리 객책에만 적용되는 일부 옵션을 지정하려면 CLE도 그렇게 할 수 있다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">main_opts</code> 및 <code class=\"language-text\">lib_opts</code> 매개 변수는 옵션을 사전을 사용하여 이를 수행한다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">main_opts</code> 는 옵션 이름에서 옵션 값으로 매핑이고 <code class=\"language-text\">libs_opts</code> 는 라이브러리 이름에서 옵션 값으로 옵션 이름을 매핑하는 사전으로의 매핑이다.</p>\n</li>\n<li>\n<p>사용할 수 있는 옵션은 벡엔드마다 다르지만 몇 가지 일반적인 옵션은 다음과 같다.</p>\n<ol>\n<li>backend - class , name으로 사용할 수 있는 백엔드</li>\n<li>base_addr - 기본 주소 사용</li>\n<li>entry_point - 엔트리 포인트 사용</li>\n<li>arch - 사용할 아키텍처의 이름</li>\n</ol>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span>\n\tmain_opts<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'backend'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'blob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'arch'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'i386'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tlib_opts<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span><span class=\"token string\">'backend'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'elf'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span>\nWARNING <span class=\"token operator\">|</span> <span class=\"token number\">2020</span><span class=\"token operator\">-</span><span class=\"token number\">08</span><span class=\"token operator\">-</span><span class=\"token number\">14</span> <span class=\"token number\">18</span><span class=\"token punctuation\">:</span><span class=\"token number\">43</span><span class=\"token punctuation\">:</span><span class=\"token number\">05</span><span class=\"token punctuation\">,</span><span class=\"token number\">284</span> <span class=\"token operator\">|</span> cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>blob <span class=\"token operator\">|</span> No entry_point was specified <span class=\"token keyword\">for</span> blob fauxware<span class=\"token punctuation\">,</span> assuming <span class=\"token number\">0</span>\nWARNING <span class=\"token operator\">|</span> <span class=\"token number\">2020</span><span class=\"token operator\">-</span><span class=\"token number\">08</span><span class=\"token operator\">-</span><span class=\"token number\">14</span> <span class=\"token number\">18</span><span class=\"token punctuation\">:</span><span class=\"token number\">43</span><span class=\"token punctuation\">:</span><span class=\"token number\">05</span><span class=\"token punctuation\">,</span><span class=\"token number\">284</span> <span class=\"token operator\">|</span> cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>blob <span class=\"token operator\">|</span> No base_addr was specified <span class=\"token keyword\">for</span> blob fauxware<span class=\"token punctuation\">,</span> assuming <span class=\"token number\">0</span>\n<span class=\"token operator\">&lt;</span>Project <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>fauxware<span class=\"token operator\">></span></code></pre></div>\n<hr>\n<h2 id=\"backends\" style=\"position:relative;\"><a href=\"#backends\" aria-label=\"backends permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Backends</h2>\n<ul>\n<li><code class=\"language-text\">CLE</code> 에는 현재 <code class=\"language-text\">ELF, PE, CGC, Mach-O, ELF core dump</code> 을 정적으로 로드하고 IDA를 사용하여 바이너리를 로드하고 파일을 flat 주소 공간으로 로드하는 백엔드가 있다.</li>\n<li>CLE는 대부분의 경우에 사용할 올바른 백엔드를 자동으로 감지하므로 이상한 작업을 수행하지 않는 한 사용중인 백엔드를 지정할 필요가 없다.</li>\n<li>옵션 사전에 키를 포함하여 CLE가 객체에 특정 백엔드를 사용하도록 할 수 있다.</li>\n<li>일부 백엔드는 사용할 아키텍처를 자동 감지 할 수 없으며 <code class=\"language-text\">arch</code>를 지정해야 한다.</li>\n<li>키는 아키텍처 목록과 일치할 필요가 없다.</li>\n<li>angr은 지원되는 <code class=\"language-text\">arch</code> 에 대한 거의 모든 공통 식별자를 제공한 아키텍처를 식별한다.</li>\n</ul>\n<script src=\"https://gist.github.com/dnsdudrla97/d19c56ca03c361c1a70a1dd4e33c9bbe.js\"></script>\n<h2 id=\"symbolic-function-summaries\" style=\"position:relative;\"><a href=\"#symbolic-function-summaries\" aria-label=\"symbolic function summaries permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Symbolic Function Summaries</h2>\n<ul>\n<li>Project는 <code class=\"language-text\">SimProcedures</code> 라는 Symbol 요약을 사용하여 라이브러리 함수에 대한 외부 호출을 대체하려고 시도한다.</li>\n<li>사실상 state에 대한 라이브러리 함수의 효과를 모방하는 Python 함수이다.</li>\n</ul>\n<h3 id=\"auto_load_libs-true\" style=\"position:relative;\"><a href=\"#auto_load_libs-true\" aria-label=\"auto_load_libs true permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>auto_load_libs (TRUE)</h3>\n<ul>\n<li>만약 <code class=\"language-text\">auto_load_libs</code> 가 True(기본 값)이면 실제 라이브러리 함수가 대신 실행된다.</li>\n<li>예를 들어, <code class=\"language-text\">libc</code> 의 일부 함수는 분석하기가 배우 복잡하며 이를 실행하려는 경로의 상태 수가 폭발적으로 증가 할 가능성이 높다.</li>\n</ul>\n<h3 id=\"auto_load_libs-false\" style=\"position:relative;\"><a href=\"#auto_load_libs-false\" aria-label=\"auto_load_libs false permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>auto_load_libs (FALSE)</h3>\n<ul>\n<li>만약 <code class=\"language-text\">auto_load_libs</code> 가 False이면 외부 함수가 해결되지 않고 Project는 이를 <code class=\"language-text\">ReturnUnconstrained</code> 라는 일반 “Stub” `SimProcedure로 해결한다.</li>\n<li>이름이 말해는대로 수행한다. 호출될 때 마다 고유 한 제한되지 않은 Symbol을 반환한다.</li>\n</ul>\n<h3 id=\"use_sim_procedure-clelodaer가-아닌-angrproject에-대한-매개변수-false\" style=\"position:relative;\"><a href=\"#use_sim_procedure-clelodaer%EA%B0%80-%EC%95%84%EB%8B%8C-angrproject%EC%97%90-%EB%8C%80%ED%95%9C-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-false\" aria-label=\"use_sim_procedure clelodaer가 아닌 angrproject에 대한 매개변수 false permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>use_sim_procedure (cle.Lodaer가 아닌 angr.Project에 대한 매개변수) (FALSE)</h3>\n<ul>\n<li>False (기본 값 : True) 인 경우, extern 객체에서 제공하는 기호 만 <code class=\"language-text\">SimProcedure</code> 로 대체되고 <code class=\"language-text\">Stub ReturnUnconstrained</code> 대체된다.</li>\n<li>Symbol 값을 반환한다.</li>\n</ul>\n<script src=\"https://gist.github.com/dnsdudrla97/a091b3fbcd251f803e028fdefb4f1f7f.js\"></script>\n<h2 id=\"hooking\" style=\"position:relative;\"><a href=\"#hooking\" aria-label=\"hooking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hooking</h2>\n<ul>\n<li><code class=\"language-text\">angr</code> 이 라이브러리 코드를 파이썬 요약으로 대체하는 메커니즘을 후킹이라고 한다.</li>\n<li>시뮬레이션을 수행 할 때 모든 단계에서 angr은 현재 주소가 <code class=\"language-text\">hook</code> 되었는지 확인하고, 그렇다면 해당 주소에서 바이너리 코드 대신에 <code class=\"language-text\">hook</code>를 실행한다.</li>\n<li>이를 수행 할 수있는 API는 <code class=\"language-text\">proj.hook(addr, hook)</code> 이며, 여기서 <code class=\"language-text\">hook</code> 은 <code class=\"language-text\">SimProcedure</code> 인스턴스이다.</li>\n<li><code class=\"language-text\">.is_hooked, .unhook , .hooked_by</code> 로 프로젝트를 <code class=\"language-text\">hook</code> 를 관리할 수 있다.</li>\n<li><code class=\"language-text\">proj.hook(addr)</code> 을 함수 decorator로 사용하여 <code class=\"language-text\">hook</code> 로 사용할 고유 한 기능을 지정할 주소 <code class=\"language-text\">hooking</code> 을 위한 대체 API가 있다.</li>\n<li>선택적으로 <code class=\"language-text\">length</code> 키워드 인수를 지정하여 <code class=\"language-text\">hook</code>가 완료된 후 실행이 몇 바이트 앞으로 점프하도록 할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> stub_func <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>SIM_PROCEDURES<span class=\"token punctuation\">[</span><span class=\"token string\">'stubs'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ReturnUnconstrained'</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'angr.procedures.stubs.ReturnUnconstrained.ReturnUnconstrained'</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>hook<span class=\"token punctuation\">(</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">,</span> stub_func<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># class의 인스턴스와 연결</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>is_hooked<span class=\"token punctuation\">(</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># class의 인스턴스에 연결되었는지</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>hooked_by<span class=\"token punctuation\">(</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>SimProcedure ReturnUnconstrained<span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>unhook<span class=\"token punctuation\">(</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> @p<span class=\"token punctuation\">.</span>hook<span class=\"token punctuation\">(</span><span class=\"token number\">0x20000</span><span class=\"token punctuation\">,</span> length<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">def</span> <span class=\"token function\">my_hook</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>     state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rax <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> \n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>is_hooked<span class=\"token punctuation\">(</span><span class=\"token number\">0x20000</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">p.hook_symbol(name, hook)</code> 을 사용하여 symbol의 name을 첫 번째 인수로 제공하여 symbol가 있는 주소를 hook 할 수 있다.</li>\n<li>이것의 매우 중요한 용도 중 하나는 angr의 내장 라이브러리 SimProcedures의 동작을 확장하는 것이다.</li>\n<li>이러한 라이브러리 함수는 클래스일 뿐 이므로 하위 클래스를 생성하여 동작의 일부를 재정의 한 다음 후크에서 하위 클래스를 사용할 수 있다.</li>\n</ul>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#the-loader\">The Loader</a></p>\n</li>\n<li>\n<p><a href=\"#loaded-objects\">Loaded Objects</a></p>\n</li>\n<li>\n<p><a href=\"#symbols-and-relocations\">Symbols and Relocations</a></p>\n</li>\n<li>\n<p><a href=\"#loading-options\">Loading Options</a></p>\n</li>\n<li>\n<p><a href=\"#basic-options\">Basic Options</a></p>\n</li>\n<li>\n<p><a href=\"#per-binary-options\">Per-Binary Options</a></p>\n</li>\n<li>\n<p><a href=\"#backends\">Backends</a></p>\n</li>\n<li>\n<p><a href=\"#symbolic-function-summaries\">Symbolic Function Summaries</a></p>\n<ul>\n<li><a href=\"#auto_load_libs-true\">auto_load_libs (TRUE)</a></li>\n<li><a href=\"#auto_load_libs-false\">auto_load_libs (FALSE)</a></li>\n<li><a href=\"#use_sim_procedure-clelodaer%EA%B0%80-%EC%95%84%EB%8B%8C-angrproject%EC%97%90-%EB%8C%80%ED%95%9C-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-false\">use_sim_procedure (cle.Lodaer가 아닌 angr.Project에 대한 매개변수) (FALSE)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#hooking\">Hooking</a></p>\n</li>\n</ul>\n</div>","excerpt":"The Loader  를 로드하고 로더와 상호 작용 하는 방법에 대해 알아보자 예제로 사용할 바이너리는 다음 링크에서 다운로드: dnsdudrla97/angr-doc Loaded Objects CLE 로더 (cle.Loader)는 로드된 바이너리 객체의 전체 그룹을 나타내며 단일 메모리 공간에 로드되고 매핑된다. 각 바이너리 객체는 파일 형식(cle.Backend의 subclass)을 처리할 수 있는 loader backend에 의해 로드된다. 예를 들어, cle.ELF 는 ELF 바이너리 파일을 로드 하는 데 사용된다. 메모리에 로드된 바이너리 수 와 일치하지 않는 객체도 있을 것이며 예를 들어,  지원을 제공하는 데 사용되는 객체와 확인되지 않은 Symbols을 제공하는데 사용되는 외부 객체 CLE가  와 함께 로드한 전체 목록뿐만 아니라 다음과 같이 몇 가지 추가 표적 분류도 얻을 수있다. 해당 객체들과 직접 상호 작용하여 메타 데이터를 추출 할 수 있다. Symbols an…","frontmatter":{"date":"August 14, 2020","title":"angr 바이너리 분석 활용 방안 2","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🤬"},"fields":{"slug":"/angr-2_theori/"}},"next":{"id":"a5f2d145-a5eb-5a18-83b7-adda8a8dabfa","html":"<h1 id=\"angr-fauxware-문제-풀이\" style=\"position:relative;\"><a href=\"#angr-fauxware-%EB%AC%B8%EC%A0%9C-%ED%92%80%EC%9D%B4\" aria-label=\"angr fauxware 문제 풀이 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr fauxware 문제 풀이</h1>\n<blockquote>\n<p>문제 바이너리 <a href=\"https://github.com/dnsdudrla97/angr-doc/tree/master/examples/fauxware-SOLVED\">dnsdudrla97/angr-doc</a></p>\n</blockquote>\n<h2 id=\"data-섹션\" style=\"position:relative;\"><a href=\"#data-%EC%84%B9%EC%85%98\" aria-label=\"data 섹션 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>data 섹션</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAu0lEQVQY043OQW4DIQyF4dz/Ul10k0VP0EYdj6BKSjCQUIPNAI6UbUdq//2n9w6IH9YeAV4Q3/VZjLU20X90COHT2rdlefX+xNznnBhKKPc++t8Y8WoMLMvJue+cuffhkQC/qBFvzJ1lCHduQ+acv5eDtRZgdc7XKtvWmBvJU258I06Z0w+nLGMXG2MAwLnr+RxiTOl2jzUVqaraRLkqs7a2fxuNMesKl4sDyIUkxOqyJyljDmEtRYn28QMpklpMQXdiCgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/63bed866b810e70ccbaebabeca81a892/37523/0.png\"\n        srcset=\"/static/63bed866b810e70ccbaebabeca81a892/e9ff0/0.png 180w,\n/static/63bed866b810e70ccbaebabeca81a892/f21e7/0.png 360w,\n/static/63bed866b810e70ccbaebabeca81a892/37523/0.png 720w,\n/static/63bed866b810e70ccbaebabeca81a892/d9217/0.png 904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"authenticate-함수\" style=\"position:relative;\"><a href=\"#authenticate-%ED%95%A8%EC%88%98\" aria-label=\"authenticate 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>authenticate 함수</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQElEQVQ4y2WNh44UMRBE/f9fBicBOtLubZ4cnSY5u9Asy+wB0pNVcr/qJgHY8BEAKJukVF07JzkbRsWopozjnbZBfMSGC2u5ZxOlS1kZxiwAtQQueLyv9iG+94mNeI8HBB+ypEouxfGYnZOypV3FOot16v6WiYl4AhjnzazW11gT/MfX3f5ai5mLcZyXhQqufNh8ogKeRCjrlbEK9xyQFyzPheDLMI+LsnXNJut0fPhkDngSMVs/a7uGgMnHopKcq6KWPvppRlbI0bnNJ5PHk4DJ+EnZNXiMHnklOLfXVPRcAhBSCu3ue1fI4PEkYDB+UHYNHtKtl6VUWc7ZMMz3y9y4MTx8IjyeBAjjhbJr8OAOWSk4M0WxOO+WBXUrqXEyPHzCHJ54MO3ZYtfgQO1aHqROUtEw7jx6LlvluH/4hDpsrB0TqHLUP37SUghu01RZE4JDz0WrHfszJZ3FRm1iM5tWLo2NnY21xTlvLqd0/5Z9PaX7LD9WZa385pPm3ukjvqX1y+drVXNOqRjnD19+vLwmTd3Rvu+4/PD68+XbreGiprzSobFoLEi9ltF6XPrplDX7W7u7dbtL83mfnwv649KeCra7Nm+3oihFXvBbXZc6rC0LUhr8prIobSw0blNMZny6tC9v/OtlOZTjWZjL4PftdKTzdVBbheQG/1BapDp8P2R5xrTSMehTxwuH8g+bSTKN/7ktPqvVPEIpzFM4NCIzSHX8zaaRRON/biocMrk79LsjPZzbnzVLLRIV/9F+AQR5AnjEP8oIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/37523/1.png\"\n        srcset=\"/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/e9ff0/1.png 180w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/f21e7/1.png 360w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/37523/1.png 720w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/66caf/1.png 853w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">sneaky</code> 전역 변수가 가리키고 있는 문자열 과 유저 이름을 <code class=\"language-text\">strcmp</code> 함수를 바탕으로 비교를 통해 같으면 1을 반환하고 아닐시 유저 이름에 해당 하는 파일 이름을 <code class=\"language-text\">open</code> 함수를 바탕으로 읽고 해당 값과 유저 패스워드와 비교하여 같으면 1을 반환 아니면 0을 반환한다.</li>\n<li>우리가 피해야할 주소 값은 <code class=\"language-text\">0x4006E6</code> 임을 알 수있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 685px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.444444444444445%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaklEQVQI12XLQQtAMBgGYP9D+WXufqciShI3Kc5qjc3Y2rf3m4Oj5/4k05g3TdZ16boV+or7fgH8PEQEY5wPPsbo4aWVyinttLTysIdyCoxkGPqqKtu2XpbZGBLiFuIOAcxMBDD++bTnl19RgW2fdQtYegAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/8c2acbdbc9b4c5725b0627966d9cffc1/8ce22/2.png\"\n        srcset=\"/static/8c2acbdbc9b4c5725b0627966d9cffc1/e9ff0/2.png 180w,\n/static/8c2acbdbc9b4c5725b0627966d9cffc1/f21e7/2.png 360w,\n/static/8c2acbdbc9b4c5725b0627966d9cffc1/8ce22/2.png 685w\"\n        sizes=\"(max-width: 685px) 100vw, 685px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"접근해야-하는-위치\" style=\"position:relative;\"><a href=\"#%EC%A0%91%EA%B7%BC%ED%95%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9C%84%EC%B9%98\" aria-label=\"접근해야 하는 위치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>접근해야 하는 위치</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3UlEQVQY042P0YqDMBBF/f8PEn0LSqRBZOuDP9CClLY2sU3GJE5mFivLUtiHPQ+XYYZ7uZNVVVUUhZTy8dAASwiL1ss0gdYekZkZCVdaMeGaVv4kU0oJIdq2vVzcOHKMZAxfr+wcEzEzvcLLeLMrvVe/5q7rpJTH4xcAIDIiaw3WhvvdAUQiSilRoo20zTv4bpUJIfI8b5rGObfnjeNsjD+d4Pn0iCnGuPglxOC9Dz/EuOVmfd8rpYZhMMbPM1vL53O83RL/g6yu67IslTpME8wzI5K17P12+3zwD/M3i6RUkUgTkgoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/39223845b13477da25018ca3ed3d5330/37523/3.png\"\n        srcset=\"/static/39223845b13477da25018ca3ed3d5330/e9ff0/3.png 180w,\n/static/39223845b13477da25018ca3ed3d5330/f21e7/3.png 360w,\n/static/39223845b13477da25018ca3ed3d5330/37523/3.png 720w,\n/static/39223845b13477da25018ca3ed3d5330/a1792/3.png 780w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>기본적으로 앞에서 <code class=\"language-text\">authenticate</code> 함수에서 반환된 값이 1 일 경우 <code class=\"language-text\">accepted</code> 함수를 호출하게 된다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAArElEQVQI14XJPQuCUBTGcb//Z2hsChqiUSdRCRRBoUGFLpI4iCim15dz7jknHIq2fsN/eB5LqUcUJUEQp2nW99w0AsB9b8aREElEwIAGveCiQRPvy5dVFE/PPznOIQzPIvu3LNC2U9PMVfXaNmSibQUERMDtAwCY2VKqDsOL5x+T5GoMGSPzbOp6HgazriTCzExEe3nvLyvPM9e92bYbx/euk7aVaeKyJET56w2EZuGgNe7jQAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/3847c841642582560fe24c2a75fe09a0/37523/4.png\"\n        srcset=\"/static/3847c841642582560fe24c2a75fe09a0/e9ff0/4.png 180w,\n/static/3847c841642582560fe24c2a75fe09a0/f21e7/4.png 360w,\n/static/3847c841642582560fe24c2a75fe09a0/37523/4.png 720w,\n/static/3847c841642582560fe24c2a75fe09a0/cda19/4.png 785w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"angr-solve-1\" style=\"position:relative;\"><a href=\"#angr-solve-1\" aria-label=\"angr solve 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr solve 1</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">solve2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    state<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sm<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n    sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x4006F6</span><span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x4007CE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4006E6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/0lEQVQY013NW26DMBCFYRbicR0qJcGe8Y3xhRBwCFHV/a+oIlVfKv2v3zkdf+2lPcd653r/HKNIDkqA7EUJavQf7CE5yQ6Sl8kDOxmdDBaSh2g7fj7L9of5P1YcDpC8jA5yOIaileGdtx3fljy3WOfx95nt8ZCcyF4Fp9hL9nI8PJQgk5NTgBrgFiGHbmizfq1Dm82+qMrCIFgLloQjiQRIwhIgCmuPkIRGQSSIwGBX9kfe97iuY9uGyV/KMMx4nfA8WV1xqHSd8ZIRF8RGtBpazDDTudKlYDd9N35tcXuER7PThDVdOSjUCk1vTI/mRFqh7q15p3vSJzIK9QnND+UKQTfxDCABAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/e6a557b26bee82d8f1a1c2799889acd9/37523/5.png\"\n        srcset=\"/static/e6a557b26bee82d8f1a1c2799889acd9/e9ff0/5.png 180w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/f21e7/5.png 360w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/37523/5.png 720w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/302a4/5.png 1080w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/76a99/5.png 1117w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"angr-sovle-2\" style=\"position:relative;\"><a href=\"#angr-sovle-2\" aria-label=\"angr sovle 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr sovle 2</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">solve1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n    sm<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>until <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> sm_<span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sm_<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    input_0 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    input_1 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    r <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_0<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_1<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvUlEQVQI1x2OaWrDMBCFfY9WIyeBhiJpFmm0uA52bBMCheT+xykqfD/eAo83rO+XPo92HGm6lfl+zWoyQRUoAlWs8jnJSWVMBEqQ2WQ2HIACcBiW90u3ra17arc6LVfVz8KmRlPEVLGZT4l7khmUTBXT239beNDfJ7aJf2ZfG03zJckHur4tCIKWcCTqmoKJaJQhYqcf4SE+dtoWfmy4r3Ss3/f5S/Wi0WIA9Db40XnAYL2H4MD7jnMQPAT/B7YXLCQTAIi/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/12139aab9feafe745ed586ce0870bdee/37523/6.png\"\n        srcset=\"/static/12139aab9feafe745ed586ce0870bdee/e9ff0/6.png 180w,\n/static/12139aab9feafe745ed586ce0870bdee/f21e7/6.png 360w,\n/static/12139aab9feafe745ed586ce0870bdee/37523/6.png 720w,\n/static/12139aab9feafe745ed586ce0870bdee/2e694/6.png 1048w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n<span class=\"token keyword\">import</span> sys\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">bse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 먼저 바이너리를 Angr 프로젝트에 로드 한다.</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># entry_state 프로그램의 진입점에서 가능한 프로그램 상태를 매우 일반적인 표현인 SimState로 생성한다.</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># SimulationManager는 단지 그것들을 관리하기 위한 많은 편리한 인터페이스가 부착된</span>\n    <span class=\"token comment\"># 다양한 태그를 가진 상태들의 모음이다</span>\n    sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 실행 시작-> 두 가지 모두 만족할만한 분기 문에 도달할 때 까지 </span>\n    <span class=\"token comment\"># 프로그램을 실행 한다. 현재 active 주소 값이 1 보다 클때 까지</span>\n    sm<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>until <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> sm_<span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sm_<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 입력 조건</span>\n    input_0 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    input_1 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n    r <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    \n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_0<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_1<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    bse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#data-%EC%84%B9%EC%85%98\">data 섹션</a></li>\n<li><a href=\"#authenticate-%ED%95%A8%EC%88%98\">authenticate 함수</a></li>\n<li><a href=\"#%EC%A0%91%EA%B7%BC%ED%95%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9C%84%EC%B9%98\">접근해야 하는 위치</a></li>\n<li><a href=\"#angr-solve-1\">angr solve 1</a></li>\n<li><a href=\"#angr-sovle-2\">angr sovle 2</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 14, 2020","title":"angr 바이너리 분석 활용 방안 3","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🤬"},"fields":{"slug":"/angr-3_theori/"}},"prev":{"id":"5b569ddb-6945-54ec-b567-459680b3a2b7","html":"<h2 id=\"프로젝트-선택\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A0%ED%83%9D\" aria-label=\"프로젝트 선택 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프로젝트 선택</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Angr을 이용해서 실행할 바이너리를 선택한다. (auto_load_libs=False -> unresolved)</span>\n<span class=\"token comment\"># 실행에 부하가 걸릴시 False로 둔다.</span>\np <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./Binary'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\np<span class=\"token punctuation\">.</span>arch  <span class=\"token operator\">-</span><span class=\"token operator\">></span>  아키텍처 출력\np<span class=\"token punctuation\">.</span>enrty <span class=\"token operator\">-</span><span class=\"token operator\">></span>  바이너리 진입점 \np<span class=\"token punctuation\">.</span>filename <span class=\"token operator\">-</span><span class=\"token operator\">></span> 바이너리 이름\n</code></pre></div>\n<h2 id=\"loader\" style=\"position:relative;\"><a href=\"#loader\" aria-label=\"loader permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>loader</h2>\n<ul>\n<li>이진 파일에서 가상 주소 공간에서 표현하는 것은 매우 복잡하다.</li>\n<li>이를 처리하기 위하여 CLE 모듈이 있다.</li>\n<li>로더라고 하는 CLE의 결과는 속성에서 사용할 수 있으며  프로그램과 함께 로드된 공유 라이버리를 보고 로드된 주소 공간에 대한 기본 쿼리를 숭행하는데 사용할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader\n<span class=\"token operator\">&lt;</span>Loaded RedVelvet<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0xa08000</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>shared_objects\nOrderedDict<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'RedVelvet'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>ELF Object RedVelvet<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60209f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'extern-address space'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>ExternObject Object cle<span class=\"token comment\">##externs, maps [0x800000:0x808000]>),</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'cle##tls'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>ELFTLSObjectV2 Object cle<span class=\"token comment\">##tls, maps [0x900000:0x915010]>)])</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>min_addr\n<span class=\"token number\">4194304</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>max_addr\n<span class=\"token number\">10518528</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object\n<span class=\"token operator\">&lt;</span>ELF Object RedVelvet<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60209f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object<span class=\"token punctuation\">.</span>execstack <span class=\"token comment\"># 실행 가능 스택 공간 여부</span>\n<span class=\"token boolean\">False</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object<span class=\"token punctuation\">.</span>pic <span class=\"token comment\"># 바이너리 위치가 독립적인지 여부</span>\n<span class=\"token boolean\">False</span>\n</code></pre></div>\n<h2 id=\"pfactory-생성자들\" style=\"position:relative;\"><a href=\"#pfactory-%EC%83%9D%EC%84%B1%EC%9E%90%EB%93%A4\" aria-label=\"pfactory 생성자들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>p.factory (생성자들)</h2>\n<ul>\n<li><code class=\"language-text\">angr</code> 에는 많은 클래스가 있으며 대부분 프로젝트를 인스턴스화해야 한다.</li>\n<li>모든 곳에서 프로젝트를 사용할 시 자주 사용하고 싶은 공통 객체에 대한 몇 가지 편리한 생성자를 제공한다. <code class=\"language-text\">project.factory</code></li>\n</ul>\n<h2 id=\"block\" style=\"position:relative;\"><a href=\"#block\" aria-label=\"block permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>block</h2>\n<ul>\n<li><code class=\"language-text\">poject.facotry.block()</code> 주어진 주소에서 기본 코드 블록을 추출하는데 사용된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> block <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 프로그램의 진입 점에서 코드 블록을 가져온다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block\n<span class=\"token operator\">&lt;</span>Block <span class=\"token keyword\">for</span> <span class=\"token number\">0x400890</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span> <span class=\"token builtin\">bytes</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block<span class=\"token punctuation\">.</span>pp<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 디스 어셈블리를 stdout에 깔끔하게 출력함</span>\n<span class=\"token number\">0x400890</span><span class=\"token punctuation\">:</span>       xor     ebp<span class=\"token punctuation\">,</span> ebp\n<span class=\"token number\">0x400892</span><span class=\"token punctuation\">:</span>       mov     r9<span class=\"token punctuation\">,</span> rdx\n<span class=\"token number\">0x400895</span><span class=\"token punctuation\">:</span>       pop     rsi\n<span class=\"token number\">0x400896</span><span class=\"token punctuation\">:</span>       mov     rdx<span class=\"token punctuation\">,</span> rsp\n<span class=\"token number\">0x400899</span><span class=\"token punctuation\">:</span>       <span class=\"token keyword\">and</span>     rsp<span class=\"token punctuation\">,</span> <span class=\"token number\">0xfffffffffffffff0</span>\n<span class=\"token number\">0x40089d</span><span class=\"token punctuation\">:</span>       push    rax\n<span class=\"token number\">0x40089e</span><span class=\"token punctuation\">:</span>       push    rsp\n<span class=\"token number\">0x40089f</span><span class=\"token punctuation\">:</span>       mov     r8<span class=\"token punctuation\">,</span> <span class=\"token number\">0x4016b0</span>\n<span class=\"token number\">0x4008a6</span><span class=\"token punctuation\">:</span>       mov     rcx<span class=\"token punctuation\">,</span> <span class=\"token number\">0x401640</span>\n<span class=\"token number\">0x4008ad</span><span class=\"token punctuation\">:</span>       mov     rdi<span class=\"token punctuation\">,</span> <span class=\"token number\">0x4011a9</span>\n<span class=\"token number\">0x4008b4</span><span class=\"token punctuation\">:</span>       call    <span class=\"token number\">0x4007e0</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">.</span>instructions<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 몇 개의 instructions이 있는지</span>\n<span class=\"token string\">'0xb'</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block<span class=\"token punctuation\">.</span>instruction_addrs <span class=\"token comment\"># instructions 메모리 주소</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">4196496</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196498</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196501</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196502</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196505</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196509</span><span class=\"token punctuation\">,</span>\n<span class=\"token number\">4196510</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196511</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196518</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196525</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196532</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block<span class=\"token punctuation\">.</span>capstone <span class=\"token comment\"># castone disassembly</span>\n<span class=\"token operator\">&lt;</span>CapstoneBlock <span class=\"token keyword\">for</span> <span class=\"token number\">0x400890</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block<span class=\"token punctuation\">.</span>vex <span class=\"token comment\"># vex IRSB 프로그램의 메모리 주소</span>\nIRSB <span class=\"token operator\">&lt;</span><span class=\"token number\">0x29</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span> ins<span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>Arch AMD64 <span class=\"token punctuation\">(</span>LE<span class=\"token punctuation\">)</span><span class=\"token operator\">>></span> at <span class=\"token number\">0x400890</span>\n</code></pre></div>\n<h2 id=\"state\" style=\"position:relative;\"><a href=\"#state\" aria-label=\"state permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>state</h2>\n<ul>\n<li>객체는 프로그램의 “초기화 이미지” 만을 나타낸다.</li>\n<li><code class=\"language-text\">angr</code> 로 실행을 수행할 때 시뮬레이션 된 프로그램 상태를 나타내는 특정 개체인 <code class=\"language-text\">SimState</code> 로 작업한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state\n<span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400890</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">SimState</code> 는 프로그램의 메모리, 레지스터, 파일 시스템 데이터를 포함하고 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400890</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rip  <span class=\"token comment\"># 현재 명령 포인터 위치</span>\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x400890</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rax\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x1c</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>p<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">.</span>resolved <span class=\"token comment\"># entry point의 메모리를 C int로 해석</span>\n<span class=\"token operator\">&lt;</span>BV32 <span class=\"token number\">0x8949ed31</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>해당 값들은 파이썬의 정수가 아니다. <code class=\"language-text\">비트 벡터</code>이다.</li>\n<li>파이썬 정수는 CPU의 단어와 동일한 의미를 갖지 않는다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> bv <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">0x1234</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 값이 0x1234인 32비트 벡터를 만든다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> bv\n<span class=\"token operator\">&lt;</span>BV32 <span class=\"token number\">0x1234</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>bv<span class=\"token punctuation\">)</span> <span class=\"token comment\"># python int 형으로 변환한다.</span>\n<span class=\"token number\">4660</span></code></pre></div>\n<ul>\n<li>이러한 비트 벡터를 레지스터 및 메모리에 다시 저장하거나 Python 정수를 직접 저장할 수 있다.</li>\n<li>적절한 크기의 비트 벡터로 변환된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rsi <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rsi\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x3</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rsi\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x3</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span><span class=\"token punctuation\">.</span>resolved\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x3</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span><span class=\"token punctuation\">.</span>resolved</code></pre></div>\n<ul>\n<li><code class=\"language-text\">배열[인덱스]</code> 표기법을 사용해 주소를 지정</li>\n<li><type> : char, short, int, long, size_t, uint8_t, uint16_t…)</li>\n<li>비트 벡터 또는 파이썬 정수 중에 하나에 값을 저장할 수 있다.</li>\n<li>값을 비트 벡터로 가져 오는 데 사용된다. <code class=\"language-text\">.resolved</code></li>\n<li>값을 python int 형으로 가져 오는 데 사용 <code class=\"language-text\">.concrete</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rdi\n<span class=\"token operator\">&lt;</span>BV64 reg_rdi_1_64<span class=\"token punctuation\">{</span>UNINITIALIZED<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>64 비트의 비트 벡터이지만 숫자 값을 포함하지 않는다.</li>\n<li>대신에 이름이 있다. 이를 <code class=\"language-text\">symbolic Variable</code> 라고 하며 토대이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token number\">1.</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> empty state\n<span class=\"token number\">2.</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> entrypoint state 생성 <span class=\"token punctuation\">(</span>main start<span class=\"token punctuation\">)</span>\n<span class=\"token number\">3.</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>full_init_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> _init start\n<span class=\"token number\">4.</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>call_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> select function start</code></pre></div>\n<ul>\n<li>정확한 메모리 주소를 사용해야 하며 해당 프로그램이 인자 값을 받는 경우 entry_state,</li>\n</ul>\n<p>full_init_state를 통해 인자값을 제공</p>\n<h2 id=\"simulation-managers\" style=\"position:relative;\"><a href=\"#simulation-managers\" aria-label=\"simulation managers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Simulation Managers</h2>\n<ul>\n<li><code class=\"language-text\">state</code> 는 우리가 주어진 시점에서 프로그램을 대표할 경우에 얻을 수 있는 방법이 있어야  한다.</li>\n</ul>\n<h2 id=\"pfactorysimgr-pfactorysimulation_manager\" style=\"position:relative;\"><a href=\"#pfactorysimgr-pfactorysimulation_manager\" aria-label=\"pfactorysimgr pfactorysimulation_manager permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>p.factory.simgr (p.factory.simulation_manager)</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\nsm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simulation_manager<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\nsm<span class=\"token punctuation\">.</span>active\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400580</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">symbolic execution</code> 을 제어하고 <code class=\"language-text\">state</code> 공간 탐색을 위한 알고리즘을 적용한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> sm<span class=\"token punctuation\">.</span>step<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>SimulationManager <span class=\"token keyword\">with</span> <span class=\"token number\">1</span> active<span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>방금 명령 과정으로 기본 블록의 Symbolix을 실행하였다.</li>\n<li><code class=\"language-text\">active stash</code> 를 다시 살펴보고 업데이트 되었음을 알 수 있다.</li>\n<li>또한 원래 상태를 수정 하지 않았 음을 알 수 있다.</li>\n<li><code class=\"language-text\">SimState</code> 객체는 실행에 의해 변경 불가능한 것으로 처리된다.</li>\n<li>단일 상태를 여러 번의 실행을 위한 “기본”으로 안전하게 사용할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> sm<span class=\"token punctuation\">.</span>active\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400540</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> simgr<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400540</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rip\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x400580</span><span class=\"token operator\">></span></code></pre></div>\n<h2 id=\"analyses\" style=\"position:relative;\"><a href=\"#analyses\" aria-label=\"analyses permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Analyses</h2>\n<ul>\n<li>angr은 프로그램에서 재미있는 정보를 추출하는데 사용할 수있는 몇 가지 기본 제공 분석과 함께 미리 패키지로 제공된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BackwardSlice<span class=\"token punctuation\">(</span>                   p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>Propagator<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BasePointerSaveSimplifier<span class=\"token punctuation\">(</span>       p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>ReachingDefinitions<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BinDiff<span class=\"token punctuation\">(</span>                         p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>Reassembler<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BinaryOptimizer<span class=\"token punctuation\">(</span>                 p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>RecursiveStructurer<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BoyScout<span class=\"token punctuation\">(</span>                        p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>RegionIdentifier<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CDG<span class=\"token punctuation\">(</span>                             p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>RegionSimplifier<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFB<span class=\"token punctuation\">(</span>                             p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>SootClassHierarchy<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFBlanket<span class=\"token punctuation\">(</span>                       p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>StackCanarySimplifier<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFG<span class=\"token punctuation\">(</span>                             p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>StackPointerTracker<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFGEmulated<span class=\"token punctuation\">(</span>                     p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>StaticHooker<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFGFast<span class=\"token punctuation\">(</span>                         p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>StructuredCodeGenerator<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFGFastSoot<span class=\"token punctuation\">(</span>                     p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>Structurer<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CalleeCleanupFinder<span class=\"token punctuation\">(</span>             p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>Typehoon<span class=\"token punctuation\">(</span></code></pre></div>\n<h2 id=\"smexplore-found-결과-출력\" style=\"position:relative;\"><a href=\"#smexplore-found-%EA%B2%B0%EA%B3%BC-%EC%B6%9C%EB%A0%A5\" aria-label=\"smexplore found 결과 출력 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sm.explore(), found 결과 출력</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># find, avoid 인수 -> find 허용할 값, avoid 피해가야 할 위치</span>\n<span class=\"token comment\"># find, avoid -> (메모리 주소, 문자열)</span>\nsm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x401546</span><span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x4007D0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A0%ED%83%9D\">프로젝트 선택</a></li>\n<li><a href=\"#loader\">loader</a></li>\n<li><a href=\"#pfactory-%EC%83%9D%EC%84%B1%EC%9E%90%EB%93%A4\">p.factory (생성자들)</a></li>\n<li><a href=\"#block\">block</a></li>\n<li><a href=\"#state\">state</a></li>\n<li><a href=\"#simulation-managers\">Simulation Managers</a></li>\n<li><a href=\"#pfactorysimgr-pfactorysimulation_manager\">p.factory.simgr (p.factory.simulation_manager)</a></li>\n<li><a href=\"#analyses\">Analyses</a></li>\n<li><a href=\"#smexplore-found-%EA%B2%B0%EA%B3%BC-%EC%B6%9C%EB%A0%A5\">sm.explore(), found 결과 출력</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 14, 2020","title":"angr 바이너리 분석 활용 방안 1","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🤬"},"fields":{"slug":"/angr-1_theori/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/angr-2_theori/","nextSlug":"/angr-3_theori/","prevSlug":"/angr-1_theori/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}