{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/elf_device_file2/2020-08-16-ELF-file-format/",
    "result": {"data":{"cur":{"id":"be8c73c9-a412-5fbd-8828-bacf94912612","html":"<h1 id=\"elf-파일-형식\" style=\"position:relative;\"><a href=\"#elf-%ED%8C%8C%EC%9D%BC-%ED%98%95%EC%8B%9D\" aria-label=\"elf 파일 형식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ELF 파일 형식</h1>\n<h2 id=\"et_noneelf-type-none\" style=\"position:relative;\"><a href=\"#et_noneelf-type-none\" aria-label=\"et_noneelf type none permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ET_NONE(ELF type none)</h2>\n<ul>\n<li><code class=\"language-text\">unknown type</code></li>\n<li>파일은 아직 정의되지 않았거나 알 수 없다.</li>\n</ul>\n<h2 id=\"et_relelf-type-relocatable\" style=\"position:relative;\"><a href=\"#et_relelf-type-relocatable\" aria-label=\"et_relelf type relocatable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ET_REL(ELF Type relocatable)</h2>\n<ul>\n<li>재배열이 가능한 파일 형식</li>\n<li>이 형식의 파일은 파일의 전체 또는 일부가 재배열 가능하다.</li>\n<li>재배열 가능한 파일은 위치 독립 코드 (PIC, Position Independent Code) 라고 한다.</li>\n<li><code class=\"language-text\">아직 실행 파일에 링킹되지 않은 상태</code></li>\n<li>코드를 컴파일 해 얻을 수 있는 <code class=\"language-text\">.o</code> 파일은 실행 파일을 생성하는 데 필요한 코드와 데이터를 포함한다.</li>\n</ul>\n<h2 id=\"et_execelf-executable\" style=\"position:relative;\"><a href=\"#et_execelf-executable\" aria-label=\"et_execelf executable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ET_EXEC(ELF executable)</h2>\n<ul>\n<li>실행 파일 형식이다.</li>\n<li>이 형식의 파일은 실행 파일이며 프로그램이라고 부른다.</li>\n<li>프로세스의 시작 지점인 Entry Point가 있다.</li>\n</ul>\n<h2 id=\"et_dynelf-type-dynamic\" style=\"position:relative;\"><a href=\"#et_dynelf-type-dynamic\" aria-label=\"et_dynelf type dynamic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ET_DYN(ELF type dynamic)</h2>\n<ul>\n<li>공유 오브젝트 파일 형식</li>\n<li>동적 링킹이 가능한 오브젝트 파일로 공유 라이브러리하고도 함</li>\n<li>실행 시간(runtime) 에 프로그램의 프로세스 이미지로 로드되고 링크된다.</li>\n</ul>\n<h2 id=\"et_coreelf-type-core\" style=\"position:relative;\"><a href=\"#et_coreelf-type-core\" aria-label=\"et_coreelf type core permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ET_CORE(ELF type core)</h2>\n<ul>\n<li>코어 파일 형식</li>\n<li>코어 파일은 프로세스의 이미지의 전체 덤프이다.</li>\n<li>주로 프로그램이 비정상적으로 종료되거나 <code class=\"language-text\">SIGSEGV</code> 시그널 (Segmentation Falut)로 인해 프로세스가 종료됐을 때 생성된다.</li>\n<li>GDB를 이용해 코어 파일의 정보를 읽고 프로그램이 비정상적으로 종료된 시점에서의 원인을 분석할 수 있다</li>\n</ul>\n<h2 id=\"elf-파일-헤더\" style=\"position:relative;\"><a href=\"#elf-%ED%8C%8C%EC%9D%BC-%ED%97%A4%EB%8D%94\" aria-label=\"elf 파일 헤더 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ELF 파일 헤더</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABC0lEQVQY033PXXKDIBQF4Cwkib8IiFgwAQqioBh1ajvT7n8zbdrpS5tk5r6ch2/Oubtle2/9JI3TfdAu6G5U3cCMZUJzaWijyrohT6cYoCj/eztpXJQjWDFEOShrRHnrg/UXJgxXpmTnHNNDWvyXV+zCmkHyE44ZTCBRrW/9hZ11hqoUkqQob8or7sc5hWQfg0NaHDOYocq4IHSv7HB6trSRoKyPGbyNh3kTpjcucGFigBNI/OVFdwNhgjYyx/RRc+uns+6UHRplY4BTSPppVdZXXNCTTAp8r/b752ntxyWsb7ob4xwlRSmtV62LcrhPwD32O3vZ/LSO87a8flAucN1wYRDlMcCP5Rf+BGDXU873WDe2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/5aa1ec71fc5f4db9baf6cc908eeb1011/37523/0.png\"\n        srcset=\"/static/5aa1ec71fc5f4db9baf6cc908eeb1011/e9ff0/0.png 180w,\n/static/5aa1ec71fc5f4db9baf6cc908eeb1011/f21e7/0.png 360w,\n/static/5aa1ec71fc5f4db9baf6cc908eeb1011/37523/0.png 720w,\n/static/5aa1ec71fc5f4db9baf6cc908eeb1011/d9217/0.png 904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ELF 파일 헤더는 파일의 offset <code class=\"language-text\">0</code>에서 시작한다.</li>\n</ul>\n<p><strong>헤더</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token number\">1.</span> ELF 형식\n<span class=\"token number\">2.</span> 아키텍처\n<span class=\"token number\">3.</span> 엔트리 포인트 주소\n<span class=\"token number\">4.</span> 섹션 헤더\n<span class=\"token number\">5.</span> 프로그램 헤더\n<span class=\"token number\">6.</span> 다른 ELF 헤더의 주소 오프셋\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<ul>\n<li>파일에 대한 주요 정보를 제공한다.</li>\n</ul>\n<p><em><strong>Linux Programer;s Manual - ELF(5)</strong></em></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">EI_NIDENT</span> <span class=\"token expression\"><span class=\"token number\">16</span></span></span>\n\n           <span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n               <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> e_ident<span class=\"token punctuation\">[</span>EI_NIDENT<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_type<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_machine<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint32_t</span>      e_version<span class=\"token punctuation\">;</span>\n               ElfN_Addr     e_entry<span class=\"token punctuation\">;</span>\n               ElfN_Off      e_phoff<span class=\"token punctuation\">;</span>\n               ElfN_Off      e_shoff<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint32_t</span>      e_flags<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_ehsize<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_phentsize<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_phnum<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_shentsize<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_shnum<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_shstrndx<span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> ElfN_Ehdr<span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#et_noneelf-type-none\">ET_NONE(ELF type none)</a></li>\n<li><a href=\"#et_relelf-type-relocatable\">ET_REL(ELF Type relocatable)</a></li>\n<li><a href=\"#et_execelf-executable\">ET_EXEC(ELF executable)</a></li>\n<li><a href=\"#et_dynelf-type-dynamic\">ET_DYN(ELF type dynamic)</a></li>\n<li><a href=\"#et_coreelf-type-core\">ET_CORE(ELF type core)</a></li>\n<li><a href=\"#elf-%ED%8C%8C%EC%9D%BC-%ED%97%A4%EB%8D%94\">ELF 파일 헤더</a></li>\n</ul>\n</div>","excerpt":"ELF 파일 형식 ET_NONE(ELF type none)  파일은 아직 정의되지 않았거나 알 수 없다. ET_REL(ELF Type relocatable) 재배열이 가능한 파일 형식 이 형식의 파일은 파일의 전체 또는 일부가 재배열 가능하다. 재배열 가능한 파일은 위치 독립 코드 (PIC, Position Independent Code) 라고 한다.  코드를 컴파일 해 얻을 수 있는  파일은 실행 파일을 생성하는 데 필요한 코드와 데이터를 포함한다. ET_EXEC(ELF executable) 실행 파일 형식이다. 이 형식의 파일은 실행 파일이며 프로그램이라고 부른다. 프로세스의 시작 지점인 Entry Point가 있다. ET_DYN(ELF type dynamic) 공유 오브젝트 파일 형식 동적 링킹이 가능한 오브젝트 파일로 공유 라이브러리하고도 함 실행 시간(runtime) 에 프로그램의 프로세스 이미지로 로드되고 링크된다. ET_CORE(ELF type core) 코어 파일 형…","frontmatter":{"date":"August 16, 2020","title":"ELF 파일 형식 (ELF file format)","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🧨"},"fields":{"slug":"/elf_device_file2/2020-08-16-ELF-file-format/"}},"next":{"id":"ad1d6292-b2dd-5378-a8c7-d97b14e48b7c","html":"<h2 id=\"ld_preload-환경-변수\" style=\"position:relative;\"><a href=\"#ld_preload-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98\" aria-label=\"ld_preload 환경 변수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LD_PRELOAD 환경 변수</h2>\n<ul>\n<li>다른 라이브러리보다 먼저 동적으로 링크하도록 라이브러리 경로를 지정한다.</li>\n<li>해당 설정은 사전에 로드하는 라이브러리의 함수나 심볼을 나중에 링크되는 라이브러리 함수나 심볼을 오버라이드 한다.</li>\n<li>공유 라이브러리 함수를 리다렉션하여 런타임 패치를 수행한다.</li>\n</ul>\n<h2 id=\"ld_show_auxv-환경-변수\" style=\"position:relative;\"><a href=\"#ld_show_auxv-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98\" aria-label=\"ld_show_auxv 환경 변수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LD_SHOW_AUXV 환경 변수</h2>\n<ul>\n<li>실행하는 동안 프로그램의 보조 벡터를 출력하도록 프로그램 로더에게 알린다.</li>\n<li><code class=\"language-text\">보조 벡터</code> 는 프로그램의 스택 (커널의 ELF 로딩 루틴에 의한)에 위치한 정보로 프로그램에 관한 특정 정보와 함께 동적 링커로 전달된다.</li>\n<li>해당 정보는 리버싱과 디버깅에 유용하다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4ElEQVQoz43QTXKDIABA4Zyj1aiACoL8KKQwtZ2aRGOo0WTsovc/SScXqM687bd5u+H28PMCciq08/eFcAXyIgRZmGQRwv+3u4z33k9BkjJlmraDmL7GKE5JnJJ1fL7e2t6HICO8EtpK43h12MN8VT7xdXq0nQ+SlGt7HEZRv0HMtsgn9vNi379eIsiUQaQMQRYk6Vbcf8/nYYwRJqJGBUe4RKTcijs/zT+/EDMqddN2tW2kcXuQbcKfp77tfKlMztTHsWfKFKKGOd2EpXFCO1FbKjWvDlRqpozQNkLrw/8AVAxYpqo/PrsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/c7618e310a37d63bb06cc303d105eb43/37523/0.png\"\n        srcset=\"/static/c7618e310a37d63bb06cc303d105eb43/e9ff0/0.png 180w,\n/static/c7618e310a37d63bb06cc303d105eb43/f21e7/0.png 360w,\n/static/c7618e310a37d63bb06cc303d105eb43/37523/0.png 720w,\n/static/c7618e310a37d63bb06cc303d105eb43/62de4/0.png 746w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>프로세스 이미지에 위치한 <code class=\"language-text\">VDSO</code> 페이지의 메모리 주소는 <code class=\"language-text\">AT_SYSINFO</code> 를 확인해야 한다.</li>\n</ul>\n<h2 id=\"링커-스크립트\" style=\"position:relative;\"><a href=\"#%EB%A7%81%EC%BB%A4-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\" aria-label=\"링커 스크립트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>링커 스크립트</h2>\n<ul>\n<li>링커 스크립트는 링커가 해석해 섹션, 메모리, 심볼 등 프로그램의 레이아웃을 구성한다.</li>\n<li>기본 링커 스크립터는 <code class=\"language-text\">ld -verbose</code> 명령어로 확인한다.</li>\n<li><code class=\"language-text\">ld</code> 링커 프로그램은 (재배치 가능한 객체 파일, 공유 라이브러리, 헤더 파일 등) 입력 파일을 받을 때 해석된다.</li>\n<li>해당 스크립트는 실행 프로그램과 같은 출력 파일을 어떻게 구성할지 지정한다.</li>\n<li>출력이 ELF 실행 파일이라면 링커 스크립트는 어떻게 배치하고 각 세그먼트에 섹션을 지정할 사용한다.</li>\n<li><code class=\"language-text\">.bss</code> 섹션은 항상 데이터 세그먼트 끝에 위치하며 이는 링커 스크립트에 의해 결정된다.</li>\n<li>컴파일하는 동안 링킹 과정에 대한 분석은 중요하다. <code class=\"language-text\">gcc</code> 는 해당 작업을 할 때 링커와 다른 프로그램에 의존한다.</li>\n<li>일부, 실행 파일의 배치를 제어 할 수 있다는 것은 매우 중요한 사실</li>\n</ul>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#ld_preload-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98\">LD_PRELOAD 환경 변수</a></li>\n<li><a href=\"#ld_show_auxv-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98\">LD_SHOW_AUXV 환경 변수</a></li>\n<li><a href=\"#%EB%A7%81%EC%BB%A4-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\">링커 스크립트</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 16, 2020","title":"리눅스 링커 환경 변수","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🎁"},"fields":{"slug":"/elf_device_file3/"}},"prev":{"id":"5bf3a490-6be2-5a4e-a67f-26780fb4cf94","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-실행-결과\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC\" aria-label=\"바이너리 실행 결과 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 실행 결과</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjUlEQVQI152KyQ2DMBREXUZO3rdvwmZjwBgJieSSFtJ/IZFN0kCkp5HmzaD9ePg5hWVbl+TyKbbTh6kdpz7EdgxDiL2Pc8o+7utxf71v+am47pohUAVIQUcVMA204KhumHYVYMW7K7luuAEBhhlLZDFEWoSFIdJiaYm0RBgiDC7UKu13/cmLakqi6/QfH2jqJZrVTugXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/6ad0125884e469a9350fa38de0d04d56/37523/0.png\"\n        srcset=\"/static/6ad0125884e469a9350fa38de0d04d56/e9ff0/0.png 180w,\n/static/6ad0125884e469a9350fa38de0d04d56/f21e7/0.png 360w,\n/static/6ad0125884e469a9350fa38de0d04d56/37523/0.png 720w,\n/static/6ad0125884e469a9350fa38de0d04d56/078fe/0.png 934w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>입력 대기중 😑</li>\n</ul>\n<h2 id=\"바이너리-정보\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\" aria-label=\"바이너리 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 정보</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVQozz2SCY7bMAxF5zRtEi9aSYpavSR2JnGaGbT3P0shuyjwAQGf/4kkwI8w3OZ1sy5SKBgK+oyhWM4KowQWxknLCr3PM+fZuCitE4Z2M3zEcQnlihwNsgGnLLlQpuVJcUCOGtzPSyc0PN5/yvUTOFryeo8p9B9huJXrZw013anpf5xbad0evRv0nTSnRvQKH79+D7eHpSA0dNIKDbWzL9c0rQa56dWlk+dWKOD5/rKcNbjDERrX7SvPqyV/6eSp6VuhK8x54jxr5Esnj4KhsDzemoJBf8DS0H37tpzBxWZ3WmGOnW9pWgyyJW/JN73SwHm6K/AG+dyKU9P3Cu6v73F5kM/S0rkV505WGHyhOAhDhzqNwHlcngoDuHDs0mu4Pd5pXNCnWCZwtU2FJdQHfPkvF0fOcx2Sk8agwFMYpnVDX6xLFAYXB05ThSmO4/I0Lhna5ZJ1qZL7RxgG8MWX6/p8z+uWplVTtHv4HzyvL0P1SCgM9VQ49Ro7CZ2EVkIjrOW0bl/zurk0HZMe+gt7OIQogoUZfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/0c34d274013459e1eb882e5286557a7b/37523/1.png\"\n        srcset=\"/static/0c34d274013459e1eb882e5286557a7b/e9ff0/1.png 180w,\n/static/0c34d274013459e1eb882e5286557a7b/f21e7/1.png 360w,\n/static/0c34d274013459e1eb882e5286557a7b/37523/1.png 720w,\n/static/0c34d274013459e1eb882e5286557a7b/42d54/1.png 858w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABgElEQVQY00WQ2WrbQBhG/SCFYlmzjyTLiuxYWVzoE8QEU3eBlpbelD50aRI7iqyxJEszo8VTHIUGzsW5OfD9/2DzmP/5Gz/cbzbb9GmXPcWxEGKXlV++/UTcdf0zzD1IHURdRF1InZMzF1AncP1B15q2PUp5TPcH1ejj0dSNNsZ8+vodEM4mU0C4jSjA7IXeEbUxG1RVXddtVTU7UW4TkeYiFo/7Mrv5sKZe4AfTESQjSIY2GtrIAtgCuBeA2cAY0zRdklR3d3kiCqWVqmTXmeXq44h5k8vr4Dyanl+OJyF3fcI96oy552Pq2Ii+xCKVm21eFPpwKIVIpdLL1Roxl8/mOAj9cMZc//9ySJiN6GucZXobF1LXWdbmuTLGLFfrt9Sxoisyj5g/tiDpN1sA94e8xklS3T8UoijyXMnyFN+uP7+xbEQdiDns//SMDclwBC2ATnFRKK3btu3qppGqLnWZyb3q1I9fv2cX76LF+7Po+plFz2R+FUYLL5yPpxf/AAc57aIwKh0OAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/65dd55752bf6d4781d8917b03dc549c7/37523/2.png\"\n        srcset=\"/static/65dd55752bf6d4781d8917b03dc549c7/e9ff0/2.png 180w,\n/static/65dd55752bf6d4781d8917b03dc549c7/f21e7/2.png 360w,\n/static/65dd55752bf6d4781d8917b03dc549c7/37523/2.png 720w,\n/static/65dd55752bf6d4781d8917b03dc549c7/abe2a/2.png 1067w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Python<span class=\"token operator\">></span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>end<span class=\"token operator\">-</span>fisrt<span class=\"token punctuation\">)</span>\n0x18fL\nPython<span class=\"token operator\">></span><span class=\"token number\">0x18f</span>\n<span class=\"token number\">399</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">0x14</code> 번 루틴을 돌면서 <code class=\"language-text\">read</code> 함수를 바탕으로 입력을 받는다. 입력을 받을시 해당 <code class=\"language-text\">unk_212E0</code> 버퍼를 사용하는데 해당 사이즈는 400바이트임을 계산할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4UlEQVQY002P0W7DIAxF8/8f2JdKLWoTkiqEYUywIYAnlq3rkZ9sHfneIeckIq1JrUKUASjn0j44cjmOggk9ezrIs88ln6dB6/x4iLV99v3wnlsTAPY+WUvThAAJPL3soletV73CGjnKD8PtlqZJmCWE/vzEmOh9Gke43+22xRCS3azdrPtyTCx/DEodl4soJcvyG15E1nVH5Hkm9QQA6rERMSAzl9JLveV0vco4yuvV5XNvTNy2OE1RKWytlVIAABGdc2+zy8aUee6FnfuPHULa9+RcZe6rWmuMkZmJ6FP+BhguWgi+/6MsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/01616dc0e018246951c86e61b13d47c8/1f083/3.png\"\n        srcset=\"/static/01616dc0e018246951c86e61b13d47c8/e9ff0/3.png 180w,\n/static/01616dc0e018246951c86e61b13d47c8/f21e7/3.png 360w,\n/static/01616dc0e018246951c86e61b13d47c8/1f083/3.png 660w\"\n        sizes=\"(max-width: 660px) 100vw, 660px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>루틴을 돌면서 400바이트 입력을 받은후 해당 <code class=\"language-text\">unk_212E0</code> 를 인자로 하여 <code class=\"language-text\">sub_850</code> 함수를 호출한후 해당 반환 값을 0이 아닐경우 FLAG 값을 출력하는 것을 확인할 수 있다.</li>\n<li>출력 중간 사이에 <code class=\"language-text\">sub_10FF6</code> 함수가 보일텐데 해당 함수는</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoElEQVQY022OSQ7CMBAE8/+v8QSEpYglIjDBHjuzJfYgQHAhde1uVXfjKETemps5sxMtOWtCXmt19/WLb9GFIH3vKfmngCiPSfrT/ZrAbBVhEVXV1trG+HCYz+eX9pOWogn1cpHhBrFkmml+o6qbZgvBh+FnVoB87HcRoJRFRZh40aWudWMMIIg+TR6jMptZZRJ47LMgGUeKiRMKZs3/z59LJCKjEZh+bwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/7de64c55e6188ed584d5d9f3c2bce6c8/37523/4.png\"\n        srcset=\"/static/7de64c55e6188ed584d5d9f3c2bce6c8/e9ff0/4.png 180w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/f21e7/4.png 360w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/37523/4.png 720w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/94829/4.png 878w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">SHA256</code>으로 해쉬화 하여 출력을 한다 즉, 해당 함수는 출력을 해쉬화 하는 과정이고 우리가 알아야 할 것은 어떤 걸 해쉬화를 하는지 입력 값을 바탕으로 어떤 조건을 통해 해쉬화 가되어지는지를 알아야 한다.</li>\n</ul>\n<h2 id=\"sub_850-함수-분석\" style=\"position:relative;\"><a href=\"#sub_850-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_850 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_850 함수 분석</h2>\n<p><strong>_start</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6ElEQVQY0zXOX0+DMBQFcL7/5zFq5E2ikGxLbDJHmEU2lyoNFAOl0H/ca8rc7+G8nXtudCzEdvu92zFKZduic7gsIQEQEYWYxtEKobSxiAgAyw0ARJtN+hQ/xPEdIR/7PZYlUIpS4hXn46RceWpzfmyGTkqttTarUCZvJElekuQ5z7+qCrsOlArjV02jlHKflWBtLdU0z6FmrTXGeO+jw+E9TdMse6WUlSWez8A5rh+G7LpJKdfUv0vfTMqPo/fe+VVYzrL0MbgnhOY5VhVcLqj1/zJjQ9/bohhOPzXj7TBoY+w8z7De/gNlBRXW+OY/BwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/ca4606e1ae6534fbba55a9b7d14be3ae/37523/5.png\"\n        srcset=\"/static/ca4606e1ae6534fbba55a9b7d14be3ae/e9ff0/5.png 180w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/f21e7/5.png 360w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/37523/5.png 720w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/cab8c/5.png 744w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>_end</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoUlEQVQI14WNQQqDMBBFPUAv1CP0Kj2hBangCSxUuxVcSKAkaTJJHDPJlCq2y77d+/zPL8ry0rY3IcgYnmdmzswZMQKglDiOYRi8NcEaCxZooZxySolXirq+9n2HSJuHEAFmxIgYc94yVk5JkAqUeAntNO8UTXN49Efvn6tmANKapEzThN+SBfv59aCtdsH9xlV16u5nIr2PlxAoRvae//IGcxXjEPKxQP4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/fbc803d74f80bf0bbc5b71df1bd25948/37523/6.png\"\n        srcset=\"/static/fbc803d74f80bf0bbc5b71df1bd25948/e9ff0/6.png 180w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/f21e7/6.png 360w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/37523/6.png 720w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/fe9f1/6.png 883w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>무려 시작과 끝의 옵셋 차이가 67493이 가 나는 함수 영역이다. …</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 639px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABCklEQVQY022Q65KDIAxG+/4PuHWdqkWpVUQrVAJRIDv0urfzM8nJl8lOygBAMRIRbRsZQ97TPDutnVJWawwh9eJP6MauKEKeU10TY4R4L5KURms3CMjrplYMrFPKWAvWWgDYtu0hH4/hcKDTiaRMyfel42iWBUUPh3rIRTVdlhV9jDHceCczFjmnYXjEPmUwBnthes7ddXQuGoPWWvfkIZdlOnu/T/53eZ5tL1ByeR3VuQOtfQjBe/+KTTLnoarS2UKkV92ZJquUPXH8rC6NaofLjIjOIQD41xDRrm1DWRLn1DS0ru+HGbP23ZKx415+tKMMFOgPSS6KJHP+S8bubDLWZDLrpjH+J38BKR7MJkN0EigAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/bb1a74fa4329a40fcf42439525441c82/738b8/7.png\"\n        srcset=\"/static/bb1a74fa4329a40fcf42439525441c82/e9ff0/7.png 180w,\n/static/bb1a74fa4329a40fcf42439525441c82/f21e7/7.png 360w,\n/static/bb1a74fa4329a40fcf42439525441c82/738b8/7.png 639w\"\n        sizes=\"(max-width: 639px) 100vw, 639px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>처음 프롤로그 부분에서 스택 영역을 <code class=\"language-text\">0x1E60</code> 만큼이나 할당해준 후 무수히 많은 변수에 값을 대입하고 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 717px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKUlEQVQoz12Q13KDMBAA+f8PdDyOGzhgigSo36ldBheCs0/SzexoT8XlQn1PdU1aZ+8jESmFUiLntixFxdrrdHWAmXJIIaaYcqI3RVkS4nLK+TXSGrVGxm3X6ZxzTBHfgIOUNvJuR9P0ujz9eQbObdPIuhHeJ0TPOZ+myRgTY6QNRV2TlKQ1AWxf9sNgy5r9DINUxhhtH/yXAcg5MoacS4wZgJAzxZi9T4DBopud4HZUXimvBjMoVH/y4UBdR/c7rbsIAfPs+l63ncTgITjvQ84ppZTXj3nK+/3SjEhrkRAgJdwbda1GFwDAW+v0AwDYlhfHI91udDqReudIuchdq7+r+qs7nJtWSoO4aCGED7ksqWmoqpbNV3kcLWP2dGsHy4Qys5g/e1/yL7wcCMl/uD6iAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/3bd856661e7f77dc51c2cae7c5c0aee2/0ad97/8.png\"\n        srcset=\"/static/3bd856661e7f77dc51c2cae7c5c0aee2/e9ff0/8.png 180w,\n/static/3bd856661e7f77dc51c2cae7c5c0aee2/f21e7/8.png 360w,\n/static/3bd856661e7f77dc51c2cae7c5c0aee2/0ad97/8.png 717w\"\n        sizes=\"(max-width: 717px) 100vw, 717px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>비슷한 구조로 한 블록에서 루프를 돌면서 비교를 한 후에 같지 않을 경우 <code class=\"language-text\">mov [rbp+var_1E49], 0</code> 과정을 하는 패턴이 계속 보이는 것을 확인할 수 있으며,</li>\n<li>같을 경우 <code class=\"language-text\">mov [rbp+var_1E48], 0</code> 패턴을 진행하며 함수의 ret 까지 계속 진행한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 714px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDElEQVQY00WPWW7DMAxEff8rJo3brLZlR6JEbZRIFgncZjC/D29mWFdE1Fo1JXEuAxQRqbUTccASMvoUV1wXWLaw3e198Qsx6TvD9zder+q9AGjvoqpEbG0OgQ7jcpwul8WkHGN6FRE7d/3L4H0qRd8Va7NzWVVLaUScS0ulhhpMXG2ykMBEM/mptrrDxyMdDros6tzHbEyMsZ7P8HW7PWD2iD54AIgxppxEZIfHEadJASSlfUxr/fmMiHQ64fgDj3vxLjjrnHU5Zu4sIsz8gmPcIWZBrACl1tY7M0tr2ppS65DBFx9KgAIuO+qkb/dgzAeutefciPo8I/O+rfVmnmZ16+a2eZvnbf7//At4hpM9WPL6VQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/8cc51a04cf277bb40fc81c7f5f34179c/d67ca/9.png\"\n        srcset=\"/static/8cc51a04cf277bb40fc81c7f5f34179c/e9ff0/9.png 180w,\n/static/8cc51a04cf277bb40fc81c7f5f34179c/f21e7/9.png 360w,\n/static/8cc51a04cf277bb40fc81c7f5f34179c/d67ca/9.png 714w\"\n        sizes=\"(max-width: 714px) 100vw, 714px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>결과적으로 반환 되는 함수의 값을 확인해 본 결과 마찬가지로 동일한 패턴으로 되는 것을 알 수 있으며 우리는 해당 반환 값이 0이 아니라 입력 한 값을 바탕으로 해당 함수의 로직으로 생신 값이 필요하기에 <code class=\"language-text\">movzx eax, [rbp+var_1E49]</code> 조건으로 점프할 수 있는 조건이 필요하다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"solved-code\" style=\"position:relative;\"><a href=\"#solved-code\" aria-label=\"solved code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code</h2>\n<ul>\n<li>해당 문제를 풀기 위해 angr 모듈을 사용할 것이다. <code class=\"language-text\">sub_850</code> 함수의 조건을 명제 논리식으로 판단하기 위해 <code class=\"language-text\">Boolean SATisfiability problem</code> 방식으로 접근해야 한다.</li>\n<li>True가 될 조건은 <code class=\"language-text\">jz</code> 분기로 점프한 <code class=\"language-text\">mov eax, []</code> 부분일 것이고</li>\n<li>False가 될 조건은 <code class=\"language-text\">jz</code> 분기로 점프를 하지 않은 <code class=\"language-text\">mov [rbp+var_1E49], 0</code> 해당 부분이 될 것이다.</li>\n<li>피해해야 할 부분의 False는 아주 고맙게도 같은 <code class=\"language-text\">C6 85 B7 E1 FF FF 00</code> 바이트이며</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTElEQVQY04WMy07CQBiF+yw+gg/kyp1v4CO4cKUbI4oxcWdCRKPRBQm9gJiwUBRipoUpTClTptN22qHtlI7h4saNX3L+zTnfr5gjqLbf9bePAWAklFKWmxBKGQvjOJFFXu14BzX3oc9W1arfooCbK/1ov328N6xWgno7e24UTy/lfT38+trMclHEPP2jbWWrctq6231t7Di1w+D8kV7e8otrdnIWdrv/y6D3qWqa0Wl996YEJjmNZBSVYUgxTjhfLDhjMfaDgMU0inkmkkWWpPnmKsCyVFU1dK0/mMOJdL1SFKuv2PNs23Ycx3WnAAAI4Xg8Jr/4vk8IUUwANE01DG00miMk8WxZiGVZLmcYIzSZOg5CiBBCKSWEWEPLtm3TNCGEAAAFANBsNnVdd12SpjLLyiQRnAs8w0PLQghRSqMoomuyLBNr8jwXQvwAJaZ5zmDimo8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/70f61871d08e0ef5cccd1b9630fbb94d/37523/10.png\"\n        srcset=\"/static/70f61871d08e0ef5cccd1b9630fbb94d/e9ff0/10.png 180w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/f21e7/10.png 360w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/37523/10.png 720w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/0eb6d/10.png 913w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>오프셋 차이가 <code class=\"language-text\">7</code> 차이가 나기때문에 False의 주소 + 7을 하여 True를 구해내야 하며 또한 허용해야 할 주소 값이 계산되서 나왔다면 전부 값에 넣을 것이 아니라</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgUlEQVQoz22QOXMTURCE9dvJSCCBPwDGpmQJk1Ng2ZkzSU8rBwIXK8prXbt698y7ZigfgTHq6mzqq+nuXlVVFxeX1/OZMT+s/ar1jTEUUw4ha+ukV53fm2AkSImSmPiZerPZbDQ6F2LeNKwUIxIReZ+sjU1jtrrTqIko5hhz5H/1BI/Hs+Uyl1KYCzMbE9rW396qUhg8aKUDBCp0EB5Np5Pd9grgPISmFEZMzqX1Vm/2UjttnYUAqaTDn4WoNhvfts579D4BJOfiXnoXvUIFCWywBs3LzkKIx9h1Td5zSvdna4OUuPwjHQJiRMSA4aHUodiTSbVYlLoma+9hbbBr4Wd9t1j/3nYyp0REpRSiF2tPx6Pv3+ZiahR7wxFTBAw+gEW5NwHBGA3gED2go5Q4Zc5P7ombu9HVtfi1WuncYVSxROZA7DOvIa4CypIVp46Co/9iV2/fXb56Ld683x2d7T8N1ce+/3CC/aHvn8mTL+2gvzs9ksPP3eC4HRzTYMDP/BfnmCndJQG5DgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/22da3ca737e8d83b0278c59dac031594/37523/11.png\"\n        srcset=\"/static/22da3ca737e8d83b0278c59dac031594/e9ff0/11.png 180w,\n/static/22da3ca737e8d83b0278c59dac031594/f21e7/11.png 360w,\n/static/22da3ca737e8d83b0278c59dac031594/37523/11.png 720w,\n/static/22da3ca737e8d83b0278c59dac031594/6bfd0/11.png 1011w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>첫 번째 , 두 번째 조건은 건너 뛰고 세 번째 부분을 허용 값에 넣어야 한다.</li>\n<li>그러면 이제 Solve 를 작성해보자</li>\n</ul>\n<h2 id=\"solved-code-1\" style=\"position:relative;\"><a href=\"#solved-code-1\" aria-label=\"solved code 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code 1</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n<span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\nPATH<span class=\"token operator\">=</span><span class=\"token string\">'./sakura'</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> PATH\n\t\t<span class=\"token comment\"># 바이트로 읽어오도록 한다.</span>\n    data <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./sakura\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    find_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    avoid_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    idx <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n\t\t\t\t<span class=\"token comment\"># avoid 할 패턴</span>\n        res <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">b\"\\xC6\\x85\\xB7\\xE1\\xFF\\xFF\\x00\"</span><span class=\"token punctuation\">,</span> idx<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> res <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">break</span>\n        <span class=\"token comment\"># 베이스 주소는 0x100000을 하든 상관 없다.</span>\n        avoid_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span> <span class=\"token operator\">+</span> res<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># find 조건 </span>\n        <span class=\"token keyword\">if</span> cnt <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n            find_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span> <span class=\"token operator\">+</span> res <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\n            \n        cnt <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        idx <span class=\"token operator\">=</span> res <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token comment\"># aovid 패턴의 오프셋만큼 더해가면서 다음 오프셋을 찾아낸다.</span>\n\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./sakura'</span><span class=\"token punctuation\">)</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> find <span class=\"token keyword\">in</span> find_list<span class=\"token punctuation\">:</span>\n        sm<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token comment\"># 순차적으로 find조건을 만족 하는지르 확인하기 위해 for문을 돌렸다.</span>\n\t\t\t\t<span class=\"token comment\"># 루프를 돌리지 않고 한번에 바로 해도 된다.</span>\n        sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>find<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>avoid_list<span class=\"token punctuation\">)</span>\n        state<span class=\"token operator\">=</span>sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\t\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n        \n    p<span class=\"token operator\">=</span>process<span class=\"token punctuation\">(</span>PATH<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 프로세스 attach</span>\n    p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 출력 값을 read 함수로 보내버린다.</span>\n    flag <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 응답 받고 출력</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAp0lEQVQI1wXBRxKCMBQAUC7CDMRQIqFD+Gm0GCwgegHGnRvvv/c9x67P27av28s+dvo+GtkDiI6rpoWiahoGVc2k6oXUHOQnNL/wfkA8Y+8bWGcAOU5WjhbUJOXAOsHSsi3qnNAkIDQkWUTyIEpxHJwihJGLfc+LTjh2MXJKNmqz6ukCeub9zJTJuc3BVGJO2ZjxJRVXCgvtDMqUnwiUcD/hHmn9M/wBacYmNikvA6oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/71183e88b5dfdc2f53a4363d5e602736/37523/12.png\"\n        srcset=\"/static/71183e88b5dfdc2f53a4363d5e602736/e9ff0/12.png 180w,\n/static/71183e88b5dfdc2f53a4363d5e602736/f21e7/12.png 360w,\n/static/71183e88b5dfdc2f53a4363d5e602736/37523/12.png 720w,\n/static/71183e88b5dfdc2f53a4363d5e602736/eafa0/12.png 939w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC\">바이너리 실행 결과</a></li>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\">바이너리 정보</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#sub_850-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">sub_850 함수 분석</a></li>\n<li><a href=\"#solved-code\">Solved Code</a></li>\n<li><a href=\"#solved-code-1\">Solved Code 1</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 16, 2020","title":"HitCon2017 Sakura 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🥞"},"fields":{"slug":"/hitcon2017_sakura_ctf_writeup/2020-08-16-HITCON2017-sakura/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/elf_device_file2/2020-08-16-ELF-file-format/","nextSlug":"/elf_device_file3/","prevSlug":"/hitcon2017_sakura_ctf_writeup/2020-08-16-HITCON2017-sakura/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}