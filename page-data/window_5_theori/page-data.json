{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/window_5_theori/",
    "result": {"data":{"cur":{"id":"c815f14e-ef2b-5028-8e13-3ac996822daa","html":"<h1 id=\"thread-local-storage-tls\" style=\"position:relative;\"><a href=\"#thread-local-storage-tls\" aria-label=\"thread local storage tls permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Thread Local Storage (TLS)</h1>\n<ul>\n<li>í”„ë¡œì„¸ìŠ¤ì˜ ëª¨ë“  ìŠ¤ë ˆë“œëŠ” ê°€ìƒ ì£¼ì†Œ ê³µê°„ì„ ê³µìœ í•œë‹¤.</li>\n<li>í•¨ìˆ˜ì˜ ì§€ì—­ ë³€ìˆ˜ëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ” ê° ìŠ¤ë ˆë“œì— ê³µìœ í•œë‹¤.</li>\n<li>ì •ì  ë° ì „ì—­ ë³€ìˆ˜ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ëª¨ë“  ìŠ¤ë ˆë“œì—ì„œ ê³µìœ ëœë‹¤.</li>\n<li>ì¦‰, ìŠ¤ë ˆë“œ ë³„ë¡œ ë…ë¦½ëœ ë°ì´í„° ì €ì¥ ê³µê°„ì´ë©° ìŠ¤ë ˆë“œ ë‚´ì—ì„œ í”„ë¡œì„¸ìŠ¤ì˜ ì „ì—­(Global) ë°ì´í„°ë‚˜ ì •ì (static) ë°ì´í„°ë¥¼ ë§ˆì¹˜ ì§€ì—­(Local) ë°ì´í„° ì²˜ëŸ¼ ë…ë¦½ì ìœ¼ë¡œ ì·¨ê¸‰í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.</li>\n</ul>\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ms686749(VS.85),aspx\"></a></p>\n<h3 id=\"image_data_directory9\" style=\"position:relative;\"><a href=\"#image_data_directory9\" aria-label=\"image_data_directory9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IMAGE_DATA_DIRECTORY[9]</h3>\n<ul>\n<li>PE í—¤ë”ì˜ TLS Table í•­ëª©ì´ ì„¸íŒ…ëœë‹¤.</li>\n<li>IMAGE_NT_HEADERS - IMAGE_OPTIONAL_HEADER - IMAGE_DATA_DIRECTORY[9]</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABH0lEQVQY03WO20rDQBRF8/9/IeIFQRR80zcFLU2TTFKENplOMjknE01rbWPmFmsjrYii7WI9bdjs7URhROmEsdT3fMTCGGOttW2rlEIoRCG01nYPTuD541FME9rv9bM001p/9WXTICDksFgsrbVmFw4JSMpSSunA9XjGv5etVqrAAnKYzV7att29HBGSxAmbsDCMGGN1Xcstb3UNOQBAWZZyD84wGtKE8jQLSQSAP7elREAhSiHKaTXdfdvzgjimSTJxXS/jeaO01EYaWzcSUQCKajaXymzCfzqjMBCcQUofB/2q4B/rtuveu261XpllVb4+4Vzkzfx5G/7VObwhJ3fj49v44Jqc3bMLUl2G042kuvLx3IWjB37ay3/yX34CADW01zVfHdMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/951b7d99cad673b600e2b007c4632544/37523/0.png\"\n        srcset=\"/static/951b7d99cad673b600e2b007c4632544/e9ff0/0.png 180w,\n/static/951b7d99cad673b600e2b007c4632544/f21e7/0.png 360w,\n/static/951b7d99cad673b600e2b007c4632544/37523/0.png 720w,\n/static/951b7d99cad673b600e2b007c4632544/02cd5/0.png 821w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>{: width=â€œ65%â€ height=â€œ65%â€œ}</p>\n<ul>\n<li>RVA 01AAF3A0 ì£¼ì†Œì—ëŠ” IMAGE_TLS_DIRECTORY êµ¬ì¡°ì²´ê°€ ìˆë‹¤.</li>\n</ul>\n<h3 id=\"image_tls_directory\" style=\"position:relative;\"><a href=\"#image_tls_directory\" aria-label=\"image_tls_directory permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IMAGE_TLS_DIRECTORY</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_TLS_DIRECTORY64</span> <span class=\"token punctuation\">{</span>\n    ULONGLONG StartAddressOfRawData<span class=\"token punctuation\">;</span>\n    ULONGLONG EndAddressOfRawData<span class=\"token punctuation\">;</span>\n    ULONGLONG AddressOfIndex<span class=\"token punctuation\">;</span>         <span class=\"token comment\">// PDWORD</span>\n    ULONGLONG AddressOfCallBacks<span class=\"token punctuation\">;</span>     <span class=\"token comment\">// PIMAGE_TLS_CALLBACK *;</span>\n    DWORD SizeOfZeroFill<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">union</span> <span class=\"token punctuation\">{</span>\n        DWORD Characteristics<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n            DWORD Reserved0 <span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n            DWORD Alignment <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n            DWORD Reserved1 <span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> DUMMYSTRUCTNAME<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> DUMMYUNIONNAME<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span> IMAGE_TLS_DIRECTORY64<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">typedef</span> IMAGE_TLS_DIRECTORY64 <span class=\"token operator\">*</span> PIMAGE_TLS_DIRECTORY64<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_TLS_DIRECTORY32</span> <span class=\"token punctuation\">{</span>\n    DWORD   StartAddressOfRawData<span class=\"token punctuation\">;</span>\n    DWORD   EndAddressOfRawData<span class=\"token punctuation\">;</span>\n    DWORD   AddressOfIndex<span class=\"token punctuation\">;</span>             <span class=\"token comment\">// PDWORD</span>\n    DWORD   AddressOfCallBacks<span class=\"token punctuation\">;</span>         <span class=\"token comment\">// PIMAGE_TLS_CALLBACK *</span>\n    DWORD   SizeOfZeroFill<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">union</span> <span class=\"token punctuation\">{</span>\n        DWORD Characteristics<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n            DWORD Reserved0 <span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n            DWORD Alignment <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n            DWORD Reserved1 <span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> DUMMYSTRUCTNAME<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> DUMMYUNIONNAME<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span> IMAGE_TLS_DIRECTORY32<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> IMAGE_TLS_DIRECTORY32 <span class=\"token operator\">*</span> PIMAGE_TLS_DIRECTORY32<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">_WIN64</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">IMAGE_ORDINAL_FLAG</span>              <span class=\"token expression\">IMAGE_ORDINAL_FLAG64</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">IMAGE_ORDINAL</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span>          <span class=\"token function\">IMAGE_ORDINAL64</span><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token keyword\">typedef</span> IMAGE_THUNK_DATA64              IMAGE_THUNK_DATA<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> PIMAGE_THUNK_DATA64             PIMAGE_THUNK_DATA<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">IMAGE_SNAP_BY_ORDINAL</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span>  <span class=\"token function\">IMAGE_SNAP_BY_ORDINAL64</span><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token keyword\">typedef</span> IMAGE_TLS_DIRECTORY64           IMAGE_TLS_DIRECTORY<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> PIMAGE_TLS_DIRECTORY64          PIMAGE_TLS_DIRECTORY<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">IMAGE_ORDINAL_FLAG</span>              <span class=\"token expression\">IMAGE_ORDINAL_FLAG32</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">IMAGE_ORDINAL</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span>          <span class=\"token function\">IMAGE_ORDINAL32</span><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token keyword\">typedef</span> IMAGE_THUNK_DATA32              IMAGE_THUNK_DATA<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> PIMAGE_THUNK_DATA32             PIMAGE_THUNK_DATA<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">IMAGE_SNAP_BY_ORDINAL</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span>  <span class=\"token function\">IMAGE_SNAP_BY_ORDINAL32</span><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token keyword\">typedef</span> IMAGE_TLS_DIRECTORY32           IMAGE_TLS_DIRECTORY<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> PIMAGE_TLS_DIRECTORY32          PIMAGE_TLS_DIRECTORY<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></code></pre></div>\n<ul>\n<li>IMAGE_TLS_DIRECTORY êµ¬ì¡°ì²´ëŠ” x86/x64 bitë¡œ ì„¤ê³„ë˜ì–´ ìˆë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVQY033PUUvDMBAH8Hz/ryEoE9tVBlqf9+xEtzpZW6attKRZlibXmqYuuaHDsQ3193BwHHd/jlxcng3888FV4F/fDEfhbXgXhmEQBJ7n+d+Gh4Kv4v0gK1Gm70nFFVuD+vjEYwCNWAtoQAjBKial1FobY5x1iEg4Wy3TV0S0duMOWGsRMc/zh8kkjpOnx2k0nUWziHPe933XdcYYwhiL41QpwN9QSvMsrypWFmVRFHUtEXEfQEDBYj4vsjeQom3bXeCOtZZSum+dcyenSS2VN45G99n4pTL90c/WWs45/o1orZ8Xy3mSNd3mZOacA4B/lrdg+oIEw1W7fAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/047eb756a6e49b68888846fb2d4bde8e/37523/1.png\"\n        srcset=\"/static/047eb756a6e49b68888846fb2d4bde8e/e9ff0/1.png 180w,\n/static/047eb756a6e49b68888846fb2d4bde8e/f21e7/1.png 360w,\n/static/047eb756a6e49b68888846fb2d4bde8e/37523/1.png 720w,\n/static/047eb756a6e49b68888846fb2d4bde8e/47aef/1.png 1063w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>RVA 01AAF3A0 í•´ë‹¹ ìœ„ì¹˜ì— êµ¬ì¡°ì²´ ë©¤ë²„ë¥¼ í™•ì¸í•´ë³´ê² ë‹¤.</li>\n<li><code class=\"language-text\">AddressOfCallbacks</code> ë©¤ë²„ëŠ” TLS ì½œë°± í•¨ìˆ˜ ì£¼ì†Œ (VA í˜•íƒœ) ë°°ì—´ì„ ê°€ë¦¬í‚¤ë©° ë°°ì—´ì˜ ëì€ NULLë¡œ í‘œì‹œí•œë‹¤.</li>\n<li>í”„ë¡œê·¸ë¨ì— TLS Call Back Function ë¥¼ ì—¬ëŸ¬ ê°œë“±ë¡í•  ìˆ˜ ìˆë‹¤.</li>\n<li>í”„ë¡œì„¸ìŠ¤ê°€ ì‹œì‘ë  ë•Œ Entry Point ì½”ë“œ ì‹¤í–‰ ì „ì— ì‹œìŠ¤í…œì—ì„œ AddressOfCallback ì˜ ë°°ì—´ì— ì €ì¥ëœ í•¨ìˆ˜ë¥¼ í•˜ë‚˜ì”© í˜¸ì¶œí•œë‹¤.</li>\n</ul>\n<h3 id=\"tls-call-back-function\" style=\"position:relative;\"><a href=\"#tls-call-back-function\" aria-label=\"tls call back function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TLS Call Back Function</h3>\n<ul>\n<li>ë¦¬ë²„ì‹± ë¶„ì•¼ì—ì„œ Anti-Debugging ê¸°ë²•ìœ¼ë¡œ ì£¼ë¡œ ë§ì´ ì‚¬ìš©ëœë‹¤.</li>\n<li>TLS Call Back Functionì€ EP(Entry-Point) ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë˜ëŠ” íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆë‹¤.</li>\n<li>í”„ë¡œì„¸ìŠ¤ì˜ ìŠ¤ë ˆë“œê°€ ìƒì„±/ì¢…ë£Œë  ë•Œ ë§ˆë‹¤ ìë™ìœ¼ë¡œ í˜¸ì¶œë˜ëŠ” ì½œë°± í•¨ìˆ˜</li>\n<li>í”„ë¡œì„¸ìŠ¤ì˜ ë©”ì¸ ìŠ¤ë ˆë“œê°€ ìƒì„±ë  ë•Œë„ ì½œë°± í•¨ìˆ˜ê°€ í˜¸ì¶œëœë‹¤.</li>\n<li>Entry Point ì½”ë“œë³´ë‹¤ ë¨¼ì € í˜¸ì¶œë˜ì–´ Anti-Debuggingì—ì„œ ë§ì´ ì“°ì¸ë‹¤.</li>\n<li>ìŠ¤ë ˆë“œì˜ ìƒì„±ì‹œì ê³¼ ì¢…ë£Œì‹œì ì— 2ë²ˆ ìë™ìœ¼ë¡œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì´ë‹¤.</li>\n<li>í”„ë¡œì„¸ìŠ¤ì˜ EP ì½”ë“œë¥¼ ì‹¤í•´í•˜ëŠ” ë©”ì¸ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ë  ë•Œ TLS ì½œë°± í•¨ìˆ˜ê°€ ë¨¼ì € í˜¸ì¶œë˜ëŠ” ì›ë¦¬ì´ë‹¤.</li>\n</ul>\n<h3 id=\"image_tls_callback\" style=\"position:relative;\"><a href=\"#image_tls_callback\" aria-label=\"image_tls_callback permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IMAGE_TLS_CALLBACK</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token function\">VOID</span>\n<span class=\"token punctuation\">(</span>NTAPI <span class=\"token operator\">*</span>PIMAGE_TLS_CALLBACK<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>\n    PVOID DllHandle<span class=\"token punctuation\">,</span>\n    DWORD Reason<span class=\"token punctuation\">,</span>\n    PVOID Reserved\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>TLS ì½œë°± í•¨ìˆ˜ ì •ì˜ëŠ” DllMain() í•¨ìˆ˜ ì •ì˜ì™€ ë¹„ìŠ· í•œ ê²ƒì„ ì•Œ ìˆ˜ìˆë‹¤.</li>\n</ul>\n<h3 id=\"dllmain\" style=\"position:relative;\"><a href=\"#dllmain\" aria-label=\"dllmain permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DllMain()</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">BOOL WINAPI <span class=\"token function\">DllMain</span><span class=\"token punctuation\">(</span>\n    HINSTANCE hinstDLL<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// handle to DLL module</span>\n    <span class=\"token module\">DWORD</span> fdwReason<span class=\"token punctuation\">,</span>     <span class=\"token comment\">// reason for calling function</span>\n    LPVOID lpReserved <span class=\"token punctuation\">)</span>  <span class=\"token comment\">// reserved</span></code></pre></div>\n<ul>\n<li>\n<p>íŒŒë¼ë¯¸í„°ì˜ ìˆœì„œì™€ ì˜ë¯¸ë„ ë™ì¼í•˜ë‹¤.</p>\n</li>\n<li>\n<p>DllHandle íŒŒë¼ë¯¸í„°ëŠ” ëª¨ë“ˆì˜ í•¸ë“¤, ë¡œë”© ì£¼ì†Œ ì´ë‹¤.</p>\n</li>\n<li>\n<p>Reason íŒŒë¼ë¯¸í„°ëŠ” TLS ì½œë°± í•¨ìˆ˜ê°€ í˜¸ì¶œëœ ì´ìœ </p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">defind</span> <span class=\"token expression\">DLL_PROCESS_ATTACH  <span class=\"token number\">1</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DLL_THREAD_ATTACH</span>   <span class=\"token expression\"><span class=\"token number\">2</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DLL_THREAD_DETACH</span>   <span class=\"token expression\"><span class=\"token number\">3</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token expression\">DEFINE </span><span class=\"token macro-name\">DLL_PROCESS_DETACH</span>  <span class=\"token expression\"><span class=\"token number\">0</span></span></span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"dll_process_attach\" style=\"position:relative;\"><a href=\"#dll_process_attach\" aria-label=\"dll_process_attach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DLL_PROCESS_ATTACH</h3>\n<ul>\n<li>í”„ë¡œì„¸ìŠ¤ì˜ ë©”ì¸ ìŠ¤ë ˆë“œê°€ main í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ì „ì— ë“±ë¡ëœ TLS ì½œë°± í•¨ìˆ˜ë“¤ì´ í˜¸ì¶œëœë‹¤.</li>\n<li>ì´ë•Œ Reason  ê°’ì€ 1(DLL_PROCESS_ATTACH)</li>\n</ul>\n<h3 id=\"dll_thread_attach\" style=\"position:relative;\"><a href=\"#dll_thread_attach\" aria-label=\"dll_thread_attach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DLL_THREAD_ATTACH</h3>\n<ul>\n<li>TLS ì½œë°± í•¨ìˆ˜ë“¤ì´ ëª¨ë‘ ì¢…ë£Œë˜ë©´ main í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤.</li>\n<li>ì‚¬ìš©ì ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ëŠ” ìˆœê°„ Reason = 2(DLL_THREAD_ATTACH)ë¡œ TLS ì½œë°± í•¨ìˆ˜ë“¤ì´ ë™ì‘í•œë‹¤.</li>\n</ul>\n<h3 id=\"dll_thread_detach\" style=\"position:relative;\"><a href=\"#dll_thread_detach\" aria-label=\"dll_thread_detach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DLL_THREAD_DETACH</h3>\n<ul>\n<li>TLS ì½œë°± í•¨ìˆ˜ë“¤ì´ ëª¨ë‘ ì¢…ë£Œë˜ë©´ ì‚¬ìš©ì ìŠ¤ë ˆë“œë¡œ ìƒì„±í•œ í•´ë‹¹ í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤.</li>\n<li>ê·¸ë¦¬ê³  ìŠ¤ë ˆë“œ í•¨ìˆ˜ê°€ ì¢…ë£Œë˜ëŠ” ìˆœê°„ Reason = 3(DLL_THREAD_DETACH)ë¡œ TLS ì½œë°± í•¨ìˆ˜ë“¤ì´ í˜¸ì¶œëœë‹¤.</li>\n</ul>\n<h3 id=\"dll_process_detach\" style=\"position:relative;\"><a href=\"#dll_process_detach\" aria-label=\"dll_process_detach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DLL_PROCESS_DETACH</h3>\n<ul>\n<li>ì‚¬ìš©ì ì“°ë ˆë“œê°€ ì¢…ë£Œë˜ë©´ ìŠ¤ë ˆë“œì˜ ì¢…ë£Œë¥¼ ê¸°ë‹¤ë¦¬ë˜ main í•¨ìˆ˜(ë©”ì¸ ìŠ¤ë ˆë“œ) ì—­ì‹œ ì¢…ë£Œí•œë‹¤.</li>\n<li>ì´ë•Œ ë§ˆì§€ë§‰ìœ¼ë¡œ Reason = 0 (DLL_PROCESS_DETACH) ê°’ìœ¼ë¡œ TLS ì½œë°± í•¨ìˆ˜ë“¤ì´ í˜¸ì¶œëœë‹¤.</li>\n</ul>","excerpt":"Thread Local Storage (TLS) í”„ë¡œì„¸ìŠ¤ì˜ ëª¨ë“  ìŠ¤ë ˆë“œëŠ” ê°€ìƒ ì£¼ì†Œ ê³µê°„ì„ ê³µìœ í•œë‹¤. í•¨ìˆ˜ì˜ ì§€ì—­ ë³€ìˆ˜ëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ” ê° ìŠ¤ë ˆë“œì— ê³µìœ í•œë‹¤. ì •ì  ë° ì „ì—­ ë³€ìˆ˜ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ëª¨ë“  ìŠ¤ë ˆë“œì—ì„œ ê³µìœ ëœë‹¤. ì¦‰, ìŠ¤ë ˆë“œ ë³„ë¡œ ë…ë¦½ëœ ë°ì´í„° ì €ì¥ ê³µê°„ì´ë©° ìŠ¤ë ˆë“œ ë‚´ì—ì„œ í”„ë¡œì„¸ìŠ¤ì˜ ì „ì—­(Global) ë°ì´í„°ë‚˜ ì •ì (static) ë°ì´í„°ë¥¼ ë§ˆì¹˜ ì§€ì—­(Local) ë°ì´í„° ì²˜ëŸ¼ ë…ë¦½ì ìœ¼ë¡œ ì·¨ê¸‰í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.  IMAGE_DATA_DIRECTORY[9] PE í—¤ë”ì˜ TLS Table í•­ëª©ì´ ì„¸íŒ…ëœë‹¤. IMAGE_NT_HEADERS - IMAGE_OPTIONAL_HEADER - IMAGE_DATA_DIRECTORY[9] {: width=â€œ65%â€ height=â€œ65%â€œ} RVA 01AAF3A0 ì£¼ì†Œì—ëŠ” IMAGE_TLS_DIRECTORY êµ¬ì¡°ì²´ê°€ ìˆë‹¤. IMAGE_TLS_DIRECTORY IMAGE_TLS_DIRECTORY êµ¬ì¡°ì²´ëŠ” x86/x64 bitë¡œ ì„¤ê³„ë˜ì–´ ìˆë‹¤. â€¦","frontmatter":{"date":"January 03, 2021","title":"TLS(Thread Local Storage CallBack)","categories":"Windows","author":"Zer0Luck","emoji":"ğŸ¯"},"fields":{"slug":"/window_5_theori/"}},"next":{"id":"b1774849-da4b-5855-9b5c-547e7a977783","html":"<h1 id=\"fuzz\" style=\"position:relative;\"><a href=\"#fuzz\" aria-label=\"fuzz permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fuzz</h1>\n<p><strong>Fuzzing</strong>Â orÂ <strong>fuzz testing</strong>Â is an automatedÂ <a href=\"https://en.wikipedia.org/wiki/Software_testing\">software testing</a>Â technique that involves providing invalid, unexpected, orÂ <a href=\"https://en.wikipedia.org/wiki/Random_data\">random data</a>Â as inputs to aÂ <a href=\"https://en.wikipedia.org/wiki/Computer_program\">computer program</a>. The program is then monitored for exceptions such asÂ <a href=\"https://en.wikipedia.org/wiki/Crash_(computing)\">crashes</a>, failing built-in codeÂ <a href=\"https://en.wikipedia.org/wiki/Assertion_(software_development)\">assertions</a>, or potentialÂ <a href=\"https://en.wikipedia.org/wiki/Memory_leak\">memory leaks</a>. Typically, fuzzers are used to test programs that take structured inputs. This structure is specified, e.g., in aÂ <a href=\"https://en.wikipedia.org/wiki/File_format\">file format</a>Â orÂ <a href=\"https://en.wikipedia.org/wiki/Communications_protocol\">protocol</a>Â and distinguishes valid from invalid input. An effective fuzzer generates semi-valid inputs that are â€œvalid enoughâ€ in that they are not directly rejected by the parser, but do create unexpected behaviors deeper in the program and are â€œinvalid enoughâ€ to exposeÂ <a href=\"https://en.wikipedia.org/wiki/Corner_case\">corner cases</a>Â that have not been properly dealt with.</p>\n<p>For the purpose of security, input that crosses aÂ <a href=\"https://en.wikipedia.org/wiki/Trust_boundary\">trust boundary</a>Â is often the most interesting. For example, it is more important to fuzz code that handles the upload of a file by any user than it is to fuzz the code that parses a configuration file that is accessible only to a privileged user.</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Fuzzing\"><em>https://en.wikipedia.org/wiki/Fuzzing</em></a></p>\n<h2 id=\"fuzzer-tool\" style=\"position:relative;\"><a href=\"#fuzzer-tool\" aria-label=\"fuzzer tool permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fuzzer tool</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token number\">1.</span> Window PE <span class=\"token builtin\">file</span> fuzzing operation\n<span class=\"token number\">2.</span> dumb fuzzer\n<span class=\"token number\">3.</span> Customizable TestCase\n<span class=\"token number\">4.</span> GUI Interface using PyQt\n<span class=\"token number\">5.</span> Message Box notification when Crash <span class=\"token keyword\">is</span> detected</code></pre></div>\n<h2 id=\"required-installation\" style=\"position:relative;\"><a href=\"#required-installation\" aria-label=\"required installation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Required installation</h2>\n<ul>\n<li><a href=\"https://vallhalla-edition.tistory.com/attachment/cfile23.uf@9959693E5C98A9A80FBC86.exe\">PaiMei-1.1.win32.exe</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">######################################################################</span>\n<span class=\"token comment\">#  This file should be kept compatible with Python 2.3, see PEP 291. #</span>\n<span class=\"token comment\">######################################################################</span>\n<span class=\"token triple-quoted-string string\">\"\"\"create and manipulate C data types in Python\"\"\"</span>\n\n<span class=\"token keyword\">import</span> os <span class=\"token keyword\">as</span> _os<span class=\"token punctuation\">,</span> sys <span class=\"token keyword\">as</span> _sys\n\n__version__ <span class=\"token operator\">=</span> <span class=\"token string\">\"1.1.0\"</span>\n\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> Union<span class=\"token punctuation\">,</span> Structure<span class=\"token punctuation\">,</span> Array\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> _Pointer\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> CFuncPtr <span class=\"token keyword\">as</span> _CFuncPtr\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> __version__ <span class=\"token keyword\">as</span> _ctypes_version\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> RTLD_LOCAL<span class=\"token punctuation\">,</span> RTLD_GLOBAL\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> ArgumentError\n\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> Structure <span class=\"token keyword\">as</span> _ctypesStructure       <span class=\"token comment\"># Add for Paimei</span>\n<span class=\"token keyword\">from</span> struct <span class=\"token keyword\">import</span> calcsize <span class=\"token keyword\">as</span> _calcsize\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Structure</span> <span class=\"token punctuation\">(</span>_ctypesStructure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">pass</span>                <span class=\"token comment\"># Add for Paimei</span>\n\n<span class=\"token keyword\">if</span> __version__ <span class=\"token operator\">!=</span> _ctypes_version<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">\"Version number mismatch\"</span><span class=\"token punctuation\">,</span> __version__<span class=\"token punctuation\">,</span> _ctypes_version<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>For compatibility with python 2.7.x version, modify the <strong>init</strong>.py file.</li>\n</ul>\n<p><code class=\"language-text\">PATH: C:\\Python27\\Lib\\ctypes\\**init**.py</code></p>\n<ul>\n<li>If you added the code in lines 17 and 19, download the rebuilt pydasm.pyd file for Python 2.7.x.</li>\n<li>After that, copy it to the C:\\Python27\\Lib\\site-packages\\pydbg folder.</li>\n</ul>\n<p>If there is an existing pydasm.pyd file, it will be overwritten.</p>\n<ul>\n<li><a href=\"https://vallhalla-edition.tistory.com/attachment/cfile27.uf@99B4814F5C98AB6A29F4DB.pyd\">pydasm.pyd</a></li>\n</ul>\n<p><strong>pydasm test</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pydbg\n<span class=\"token keyword\">print</span> <span class=\"token string\">\"Hello, pydbg!\"</span></code></pre></div>\n<ul>\n<li>success!</li>\n</ul>\n<h2 id=\"options-cli\" style=\"position:relative;\"><a href=\"#options-cli\" aria-label=\"options cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options (CLI)</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">-</span>t<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>target <span class=\"token punctuation\">:</span> Binary to fuzz\n<span class=\"token operator\">-</span>s<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>sample <span class=\"token punctuation\">:</span> Sample folder name <span class=\"token punctuation\">(</span>Test Case <span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">-</span>h<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token builtin\">help</span> <span class=\"token punctuation\">:</span> <span class=\"token builtin\">help</span></code></pre></div>\n<h2 id=\"blueprint-gui\" style=\"position:relative;\"><a href=\"#blueprint-gui\" aria-label=\"blueprint gui permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BluePrint (GUI)</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoElEQVQoz2XM+0tTARjG8fOXRESJupbToW66s7a57ezsKBYzm23ulmULF5mlJWkX7YK0bmqNLrSuphSDoDQoiCiqfyCJLlQk9EsFRYVt53zDzaLLDx/e93leeAXX2e84TnzAdvwdSuor0TOgjIEyDvUTfxgvaJgo3LxX542BfBHkC1p+Cs7uDM74MO7RTzQOzODrm8bT9QwxPo15/VNM/5jrxI1PsXc8x9XzhNCu+yhnNJQ0eM9pCN6OFA3BrbiTM1TYAuiW6NDrzUh2O8EVTkIr/zbXSXYH5QaR0iU6FhtkrMdziCPgOqkhtPacJtG9AyU5Q7mjBV1JEfoKC32JJh6cDvDqepiZGxFeZyK8yUTg8TomklEMpjrMpmoOj6ZJ3ftK+nGO9jEN4faVNB/v9BMefY/e2oK+pJhiQw1H4n6+ndrAy2QbL5JtvD26jumhNri4kSs7YhgtEqbKKhLd+9g+/oX+TJbgWQ1haPgR14ZvsnroE2VWP3pdKcZqkVCzn55YhM7WAN2xCNuiYbpCQTYHA0Saw9S5Gig3lFFkVBAHs1j2gfOgimDbDaY+sO3MsszsY5lez3Kbm0bfGup9QRRfgIamVhpXh1F8QeqbAvhWrcXmUNDpllIhNiPvmcU7CPKAiuDbk+P85GfStz4wkrqER65n4aISKivNWGqqqDVXYl9uwemw5ndLTTW1NdUYjQZKihZQViUjbZ/F0wueXhVB6lRp258lOviD4cuvSZ2/y4FjGboGbmHxTyG2TCH6p7D4Jwv7b7extkxiCz1E6swhbdGY+yVE+jVc7RpiDNr3avSPqOw+CVsOgacD5AR4NxX8yn+a66S4hhRX81NoSmjIa1WkmIotqFLrL7CuyeGOZPOkaIFrPv8nquKOank/AVcrGqV8PVvaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-8.png\"\n        title=\"./Bl-8.png\"\n        src=\"/static/11b0973c52b4a1db5dee5094314f7265/37523/Bl-8.png\"\n        srcset=\"/static/11b0973c52b4a1db5dee5094314f7265/e9ff0/Bl-8.png 180w,\n/static/11b0973c52b4a1db5dee5094314f7265/f21e7/Bl-8.png 360w,\n/static/11b0973c52b4a1db5dee5094314f7265/37523/Bl-8.png 720w,\n/static/11b0973c52b4a1db5dee5094314f7265/302a4/Bl-8.png 1080w,\n/static/11b0973c52b4a1db5dee5094314f7265/07a9c/Bl-8.png 1440w,\n/static/11b0973c52b4a1db5dee5094314f7265/29114/Bl-8.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8ElEQVQoz3XMS09TQRjG8fPFlF7onJkWiYTKVS4FTEtFAkVMwMICatU2kZ6Woi2KFbysTEzcmLDxQ7jXGKPRaGShiGln/oSeA0kFF7887zt5n7FCD/fxFz8TKH3B73zCX/hI29p7VOk7sXKdjpomvP0vg9oBtWM8nLBU5i0dSy+R1V9EtiFcg8gTEDXwPYbAkVqr9hqoLYPa4hTr7sorni6WiJZ+IDYhXNGIKvRX/pCs7BG//5OE8424Z9L5yuj6HqoKqmpOsaZzH0hn33GxdIDcgEi5QbAKUwuv2RgeZ23kGoXoKM6lGE7vBOXuQdITd5q3qsl46bJ863CuDHYRVNGgCnXUAwglt+gMt9HZ1cXA8BA9A/2IsELYPgJ9c0jHu3eMmx5L5RqEcw1kXiPzBpmrI9dAzOwioinae9P0JYuMzG4S7LlJsHsOeeURkXt4Ha/nseSKQa5o3DymkRmQWZd9C4S3K8+FrCaS0ajV1r4lFw2ttJsLDeRC3UuX3dzr+K838M9D8AYE5lv7VnBaI2YN9pl0q5QmNKPJP9c8e/ObF7v73N4xHP0hUwY7ZbBiy4bIlEEkDPbkGRIGlTTIpDuLhGZsWZNcPeBq5i+jSxoR1yf3VnTKIMcNIvZ/csx1NNsxg++y4fwgTf4h9+349hDx2VedtFeB6QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-10.png\"\n        title=\"./Bl-10.png\"\n        src=\"/static/5f2de169ea7d484f5fa5123a55f7ff56/37523/Bl-10.png\"\n        srcset=\"/static/5f2de169ea7d484f5fa5123a55f7ff56/e9ff0/Bl-10.png 180w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/f21e7/Bl-10.png 360w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/37523/Bl-10.png 720w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/302a4/Bl-10.png 1080w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/07a9c/Bl-10.png 1440w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/29114/Bl-10.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACp0lEQVQoz0WOW28TVxRG5z9VQm1DZ+w5c86ZOeOxPa4bG8eJ4wQIhFzUpLSmVFwCCaSAUMtFUC4CqQakQoGqJFWkPvUJ8YhUqQFFlaB9QyoU0QZ7vFBMgIelb+29pU/bkhf+wz39hNS3j4nOrVI/D+EVMNfeEVwFfx19BcJrIJsw8xtcv79K895Tztx9Sfg9WGLnLbyRE6gzz8h8/YTiV7+T+WIZd3wZMbmMmPgDPbWCmX6MmXpE3PibQuMRwfSfbNr3gF3H7jBy+V8GfgBzsYMVTp4iU5tAn3xKT/Uo6Q9sHCeD81GAYxscW6HFAFvcW+xO3eS0vsFxcQKRinBFjpSIcWZXkOcgOJtgVcauMjU4Q+b4czbWjvJJIYcM8ghl8FSIkAEmyhMXy5goRuoMQhrSwsf1fOy0Rs4+JDwLwakEa772PwvxP5SOwIfVeXoLMSqIcb2wi9IRHxcrDAxuIZvvxTd5dJBbvxuEilAHVghOQvBNgrV5ssXw9jZmHnpKcxR9RU7n8GSIK0OkCskXStSHt3WL18relGo/i17zPSv4x8A/0saSswl6roU5BHbvPL6SyKCA62VwZURaGHKFMvXhUXrLNbL5Etm4TDZfRgf57qdB4yFmFoKZNpa/KyE91cZtwIZwBrvnPZRWSE8gpUC4KcLQp9pXJo6zRJHpYoyP5wk2vO/gjD4g/TmoRhtLfdrhu9ttLt15QfPHu0zv/wmnb4lo66/IgUW8/gXc6s+I/oWu+0NL6PovpCqLDO1c5HLzNhdu/kVzKaG0J8Ea2tthbC5h674XjB+CypcgtoHe8Q5/7DVrrkZfp9wOhc9g/DCM7F9lx8EW2YkOVnGsQ7q/g9MHdiXB7W+h6y3UYAu1nmuzfuvttzuv1sKutHGqYPd1kIMJrwBIUhS7ZfuiggAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-9.png\"\n        title=\"./Bl-9.png\"\n        src=\"/static/ddefedaf5616ff75bb74313a97d51243/37523/Bl-9.png\"\n        srcset=\"/static/ddefedaf5616ff75bb74313a97d51243/e9ff0/Bl-9.png 180w,\n/static/ddefedaf5616ff75bb74313a97d51243/f21e7/Bl-9.png 360w,\n/static/ddefedaf5616ff75bb74313a97d51243/37523/Bl-9.png 720w,\n/static/ddefedaf5616ff75bb74313a97d51243/302a4/Bl-9.png 1080w,\n/static/ddefedaf5616ff75bb74313a97d51243/07a9c/Bl-9.png 1440w,\n/static/ddefedaf5616ff75bb74313a97d51243/29114/Bl-9.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#fuzzer-tool\">Fuzzer tool</a></li>\n<li><a href=\"#required-installation\">Required installation</a></li>\n<li><a href=\"#options-cli\">Options (CLI)</a></li>\n<li><a href=\"#blueprint-gui\">BluePrint (GUI)</a></li>\n</ul>\n</div>","frontmatter":{"date":"December 20, 2020","title":"Development of window GUI binary fuzzing using the dump fuzzing theory.","categories":"projects","author":"Zer0Luck","emoji":"ğŸ”"},"fields":{"slug":"/project_fuzz_/"}},"prev":{"id":"a2b2882f-79f1-5058-be0a-cc4ee51e785c","html":"<h2 id=\"seh\" style=\"position:relative;\"><a href=\"#seh\" aria-label=\"seh permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SEH</h2>\n<ul>\n<li><code class=\"language-text\">exception handlers</code> ëŠ” ê° Threadì™€ ê´€ë ¨ëœ <code class=\"language-text\">Singly-linked list</code> êµ¬ì„±ëœë‹¤.</li>\n<li>ì›ì¹™ì ìœ¼ë¡œ í•´ë‹¹ ëª©ë¡ì˜ ë…¸ë“œëŠ” stackì— í• ë‹¹ëœë‹¤.</li>\n<li>ëª©ë¡ì˜ HeadëŠ” TEB(Thred Environment Block)ì˜ ì‹œì‘ ë¶€ë¶„ì— ìˆëŠ” í¬ì¸í„°ë¡œ ê°€ë¦¬í‚¤ë¯€ë¡œ ì½”ë“œê°€ ìƒˆ ì˜ˆì™¸ì²˜ë¦¬ê¸°ë¥¼ ì¶”ê°€í•˜ë ¤ëŠ” ê²½ìš° ìƒˆ ë…¸ë“œê°€ ëª©ë¡ì˜ í—¤ë“œì™€ í¬ì¸í„°ì— ì¶”ê°€ëœë‹¤.</li>\n<li>TEBì—ì„œ ìƒˆ ë…¸ë“œë¥¼ ê°€ë¦¬í‚¤ë„ë¡ ë³€ê²½ëœë‹¤.</li>\n<li>ê° ë…¸ë“œëŠ” <code class=\"language-text\">_EXCEPTION_REGISTRATION_RECORD</code> ìœ í˜•ì´ë©° í•¸ë“¤ëŸ¬ì˜ ì£¼ì†Œì™€ ëª©ë¡ì˜ ë‹¤ìŒ ë…¸ë“œì— ëŒ€í•œ í¬ì¸í„°ë¥¼ ì €ì¥í•œë‹¤.</li>\n<li>ì´ìƒí•˜ê²Œë„ ëª©ë¡ì˜ ë§ˆì§€ë§‰ ë…¸ë“œì˜ â€œnext pointerâ€ ëŠ” NULLì´ ì•„ë‹ˆì§€ë§Œ <code class=\"language-text\">0xFFFFFFFF</code> ì™€ ê°™ë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">000</span><span class=\"token operator\">></span> dt _EXCEPTION_REGISTRATION_RECORD\nntdll<span class=\"token operator\">!</span>_EXCEPTION_REGISTRATION_RECORD\n<span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Next <span class=\"token operator\">:</span> Ptr32 _EXCEPTION_REGISTRATION_RECORD\n<span class=\"token operator\">+</span><span class=\"token number\">0x004</span> Handler <span class=\"token operator\">:</span> Ptr32 _EXCEPTION_DISPOSITION\n\n<span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">005</span><span class=\"token operator\">></span> dt _EXCEPTION_REGISTRATION_RECORD\ncombase<span class=\"token operator\">!</span>_EXCEPTION_REGISTRATION_RECORD\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Next             <span class=\"token operator\">:</span> Ptr32 _EXCEPTION_REGISTRATION_RECORD\n   <span class=\"token operator\">+</span><span class=\"token number\">0x004</span> Handler          <span class=\"token operator\">:</span> Ptr32     _EXCEPTION_DISPOSITION</code></pre></div>\n<ul>\n<li>TEBëŠ” FS:[0] ë¶€í„° ì‹œì‘í•˜ëŠ” <code class=\"language-text\">selector</code> FSë¥¼ í†µí•´ì„œë„ ì•¡ì„¸ìŠ¤ í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥´ ë³´ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">mov eax<span class=\"token punctuation\">,</span> dword ptr fs<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">00000000</span>h<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span> retrieve the head\npush eax <span class=\"token punctuation\">;</span> save the old head\nlea eax<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">-</span><span class=\"token number\">10</span>h<span class=\"token punctuation\">]</span>\nmov dword ptr fs<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">00000000</span>h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> eax <span class=\"token punctuation\">;</span> set the <span class=\"token keyword\">new</span> head\nmov ecx<span class=\"token punctuation\">,</span> dword ptr <span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">-</span><span class=\"token number\">10</span>h<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span> get the old <span class=\"token function\">head</span> <span class=\"token punctuation\">(</span>NEXT field of the current head<span class=\"token punctuation\">)</span>\nmov dword ptr fs<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">00000000</span>h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> ecx <span class=\"token punctuation\">;</span> restore the old head</code></pre></div>\n<ul>\n<li>\n<p>ì»´íŒŒì¼ëŸ¬ëŠ” ì¼ë°˜ì ìœ¼ë¡œ í”„ë¡œê·¸ë¨ì˜ ì–´ëŠ ì˜ì—­ì´ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ (ì „ì—­ ë³€ìˆ˜ì— ì˜ì¡´) ì•Œê³  í˜¸ì¶œë  ë  ë•Œ ê·¸ì— ë”°ë¼ ë™ì‘í•˜ëŠ” ë‹¨ì¼ ì „ì—­ ì²˜ë¦¬ê¸°ë¥¼ ë“±ë¡í•œë‹¤.</p>\n</li>\n<li>\n<p>ê° ìŠ¤ë ˆë“œì—ëŠ” ë‹¤ë¥¸ <code class=\"language-text\">TEB</code> ê°€ ìˆìœ¼ë¯€ë¡œ ìš´ì˜ ì²´ì œëŠ” <code class=\"language-text\">FS</code> ì— ì˜í•´ ì„ íƒëœ ì„¸ê·¸ë¨¼íŠ¸ê°€ í•­ìƒ ì˜¬ë°”ë¥¸ TEB(ì¦‰, í˜„ì¬ ìŠ¤ë ˆë“œ ì¤‘ í•˜ë‚˜)ë¥¼ ì°¸ì¡°í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.</p>\n</li>\n<li>\n<p>TEBì˜ ì£¼ì†Œë¥¼ ì–»ì„ë ¤ë©´ TEBì˜ Self í•„ë“œì— í•´ë‹¹í•˜ëŠ” <code class=\"language-text\">FS:[18h]</code>ë¥¼ ì½ì–´ì•¼ í•œë‹¤.</p>\n</li>\n<li>\n<p>TEBë¥¼ í™•ì¸í•´ ë³´ì</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">003</span><span class=\"token operator\">></span> <span class=\"token operator\">!</span>teb\nTEB at <span class=\"token number\">00</span>b95000\n    ExceptionList<span class=\"token operator\">:</span>        <span class=\"token number\">032</span>af770\n    StackBase<span class=\"token operator\">:</span>            <span class=\"token number\">032</span>b0000\n    StackLimit<span class=\"token operator\">:</span>           <span class=\"token number\">032</span>ac000\n    SubSystemTib<span class=\"token operator\">:</span>         <span class=\"token number\">00000000</span>\n    FiberData<span class=\"token operator\">:</span>            <span class=\"token number\">00001e00</span>\n    ArbitraryUserPointer<span class=\"token operator\">:</span> <span class=\"token number\">00000000</span>\n    Self<span class=\"token operator\">:</span>                 <span class=\"token number\">00</span>b95000\n    EnvironmentPointer<span class=\"token operator\">:</span>   <span class=\"token number\">00000000</span>\n    ClientId<span class=\"token operator\">:</span>             <span class=\"token number\">0000351</span>c <span class=\"token punctuation\">.</span> <span class=\"token number\">00004360</span>\n    RpcHandle<span class=\"token operator\">:</span>            <span class=\"token number\">00000000</span>\n    Tls Storage<span class=\"token operator\">:</span>          <span class=\"token number\">00000000</span>\n    PEB Address<span class=\"token operator\">:</span>          <span class=\"token number\">00</span>b50000\n    LastErrorValue<span class=\"token operator\">:</span>       <span class=\"token number\">0</span>\n    LastStatusValue<span class=\"token operator\">:</span>      <span class=\"token number\">0</span>\n    Count Owned Locks<span class=\"token operator\">:</span>    <span class=\"token number\">0</span>\n    HardErrorMode<span class=\"token operator\">:</span>        <span class=\"token number\">0</span></code></pre></div>\n<p>FS ì„¸ê·¸ë¨¼íŠ¸ê°€ TEBë¥¼ ì°¸ì¡°í•˜ëŠ” ì§€ í™•ì¸í•´ë³´ì</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">003</span><span class=\"token operator\">></span> dg fs\n                                  P Si Gr Pr Lo\nSel    Base     Limit     Type    l ze an es ng Flags\n<span class=\"token operator\">--</span><span class=\"token operator\">--</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span> <span class=\"token operator\">-</span> <span class=\"token operator\">--</span> <span class=\"token operator\">--</span> <span class=\"token operator\">--</span> <span class=\"token operator\">--</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span>\n<span class=\"token number\">0053</span> <span class=\"token number\">00</span>b95000 <span class=\"token number\">00000fff</span> Data RW Ac <span class=\"token number\">3</span> Bg By P  Nl <span class=\"token number\">000004f</span>3</code></pre></div>\n<ul>\n<li>FS:[18h] ì—ëŠ” TEBì˜ ì£¼ì†Œê°€ í¬í•¨ë˜ì–´ ìˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">003</span><span class=\"token operator\">></span> <span class=\"token operator\">?</span><span class=\"token function\">poi</span><span class=\"token punctuation\">(</span>fs<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nEvaluate expression<span class=\"token operator\">:</span> <span class=\"token number\">12144640</span> <span class=\"token operator\">=</span> <span class=\"token number\">00</span>b95000</code></pre></div>\n<ul>\n<li>ExceptionListê°€ ê°€ë¦¬í‚¤ëŠ” Structureë¥¼ í™•ì¸í•´ë³´ë„ë¡ í•˜ê² ë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">003</span><span class=\"token operator\">></span> dt nt<span class=\"token operator\">!</span>_NT_TIB ExceptionList\nntdll<span class=\"token operator\">!</span>_NT_TIB\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> ExceptionList <span class=\"token operator\">:</span> Ptr32 _EXCEPTION_REGISTRATION_RECORD</code></pre></div>\n<ul>\n<li>ê° ë…¸ë“œëŠ” _EXCPETION_REGISTRATION_RECORDì˜ Instanceì´ë‹¤. ì „ì²´ ëª©ë¡ì„ í™•ì¸í•˜ê³  ì‹¶ìœ¼ë©´ <code class=\"language-text\">!slist</code> ë¥¼ ì‚¬ìš©í•˜ì</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">003</span><span class=\"token operator\">></span> <span class=\"token operator\">!</span>slist $teb _EXCEPTION_REGISTRATION_RECORD\nSLIST HEADER<span class=\"token operator\">:</span>\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Alignment          <span class=\"token operator\">:</span> <span class=\"token number\">32</span>b0000032af770\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Next               <span class=\"token operator\">:</span> <span class=\"token number\">32</span>af770\n   <span class=\"token operator\">+</span><span class=\"token number\">0x004</span> Depth              <span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Sequence           <span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n\nSLIST CONTENTS<span class=\"token operator\">:</span>\n<span class=\"token number\">032</span>af770\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Next             <span class=\"token operator\">:</span> <span class=\"token number\">0x032af7dc</span> _EXCEPTION_REGISTRATION_RECORD\n   <span class=\"token operator\">+</span><span class=\"token number\">0x004</span> Handler          <span class=\"token operator\">:</span> <span class=\"token number\">0x77759990</span>     _EXCEPTION_DISPOSITION  ntdll<span class=\"token operator\">!</span>_except_handler4<span class=\"token operator\">+</span><span class=\"token number\">0</span>\n<span class=\"token number\">032</span>af7dc\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Next             <span class=\"token operator\">:</span> <span class=\"token number\">0x032af7f4</span> _EXCEPTION_REGISTRATION_RECORD\n   <span class=\"token operator\">+</span><span class=\"token number\">0x004</span> Handler          <span class=\"token operator\">:</span> <span class=\"token number\">0x77759990</span>     _EXCEPTION_DISPOSITION  ntdll<span class=\"token operator\">!</span>_except_handler4<span class=\"token operator\">+</span><span class=\"token number\">0</span>\n<span class=\"token number\">032</span>af7f4\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Next             <span class=\"token operator\">:</span> <span class=\"token number\">0xffffffff</span> _EXCEPTION_REGISTRATION_RECORD\n   <span class=\"token operator\">+</span><span class=\"token number\">0x004</span> Handler          <span class=\"token operator\">:</span> <span class=\"token number\">0x7776734b</span>     _EXCEPTION_DISPOSITION  ntdll<span class=\"token operator\">!</span>FinalExceptionHandlerPad27<span class=\"token operator\">+</span><span class=\"token number\">0</span>\nffffffff\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Next             <span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> \n   <span class=\"token operator\">+</span><span class=\"token number\">0x004</span> Handler          <span class=\"token operator\">:</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> \nCan<span class=\"token number\">'</span>t read memory at ffffffff<span class=\"token punctuation\">,</span> error <span class=\"token number\">0</span></code></pre></div>\n<ul>\n<li>\n<p><code class=\"language-text\">$teb</code> ëŠ” TEBì˜ ì£¼ì†Œì´ë‹¤.</p>\n</li>\n<li>\n<p>SEH chainì„ í‘œì‹œí•˜ëŠ” ë” ê°„ë‹¨í•œ ë°©ë²•ì€ ë‹¤ìŒì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">003</span><span class=\"token operator\">></span> <span class=\"token operator\">!</span>exchain\n<span class=\"token number\">032</span>af770<span class=\"token operator\">:</span> ntdll<span class=\"token operator\">!</span>_except_handler4<span class=\"token operator\">+</span><span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">77759990</span><span class=\"token punctuation\">)</span>\n  CRT scope  <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> filter<span class=\"token operator\">:</span> ntdll<span class=\"token operator\">!</span>DbgUiRemoteBreakin<span class=\"token operator\">+</span><span class=\"token number\">3</span>b <span class=\"token punctuation\">(</span><span class=\"token number\">7778</span>db7b<span class=\"token punctuation\">)</span>\n                func<span class=\"token operator\">:</span>   ntdll<span class=\"token operator\">!</span>DbgUiRemoteBreakin<span class=\"token operator\">+</span><span class=\"token number\">3f</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7778</span>db7f<span class=\"token punctuation\">)</span>\n<span class=\"token number\">032</span>af7dc<span class=\"token operator\">:</span> ntdll<span class=\"token operator\">!</span>_except_handler4<span class=\"token operator\">+</span><span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">77759990</span><span class=\"token punctuation\">)</span>\n  CRT scope  <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> filter<span class=\"token operator\">:</span> ntdll<span class=\"token operator\">!</span>__RtlUserThreadStart<span class=\"token operator\">+</span><span class=\"token number\">3</span>d6c5 <span class=\"token punctuation\">(</span><span class=\"token number\">77784</span>c8a<span class=\"token punctuation\">)</span>\n                func<span class=\"token operator\">:</span>   ntdll<span class=\"token operator\">!</span>__RtlUserThreadStart<span class=\"token operator\">+</span><span class=\"token number\">3</span>d75e <span class=\"token punctuation\">(</span><span class=\"token number\">77784</span>d23<span class=\"token punctuation\">)</span>\n<span class=\"token number\">032</span>af7f4<span class=\"token operator\">:</span> ntdll<span class=\"token operator\">!</span>FinalExceptionHandlerPad27<span class=\"token operator\">+</span><span class=\"token number\">0</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7776734</span>b<span class=\"token punctuation\">)</span>\nInvalid exception stack at ffffffff</code></pre></div>\n<ul>\n<li>SEH chainì„ ìˆ˜ë™ìœ¼ë¡œ ê²€ì‚¬ í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">003</span><span class=\"token operator\">></span> dt <span class=\"token number\">032</span>af770 _EXCEPTION_REGISTRATION_RECORD\nntdll<span class=\"token operator\">!</span>_EXCEPTION_REGISTRATION_RECORD\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> Next             <span class=\"token operator\">:</span> <span class=\"token number\">0x032af7dc</span> _EXCEPTION_REGISTRATION_RECORD\n   <span class=\"token operator\">+</span><span class=\"token number\">0x004</span> Handler          <span class=\"token operator\">:</span> <span class=\"token number\">0x77759990</span>     _EXCEPTION_DISPOSITION  ntdll<span class=\"token operator\">!</span>_except_handler4<span class=\"token operator\">+</span><span class=\"token number\">0</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#seh\">SEH</a></li>\n</ul>\n</div>","frontmatter":{"date":"January 03, 2021","title":"Windows SEH (Structured Exception Handler) 1","categories":"Windows","author":"Zer0Luck","emoji":"ğŸ¥–"},"fields":{"slug":"/window_2_theori/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/window_5_theori/","nextSlug":"/project_fuzz_/","prevSlug":"/window_2_theori/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}