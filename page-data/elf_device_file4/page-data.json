{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/elf_device_file4/",
    "result": {"data":{"cur":{"id":"2343cc79-a0f4-5501-afb9-7ffb82f62c18","html":"<h1 id=\"elf-프로그램-헤더\" style=\"position:relative;\"><a href=\"#elf-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%ED%97%A4%EB%8D%94\" aria-label=\"elf 프로그램 헤더 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ELF 프로그램 헤더</h1>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">EI_NIDENT</span> <span class=\"token expression\"><span class=\"token number\">16</span></span></span>\n\n           <span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n               <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> e_ident<span class=\"token punctuation\">[</span>EI_NIDENT<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_type<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_machine<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint32_t</span>      e_version<span class=\"token punctuation\">;</span>\n               ElfN_Addr     e_entry<span class=\"token punctuation\">;</span>\n               ElfN_Off      e_phoff<span class=\"token punctuation\">;</span>\n               ElfN_Off      e_shoff<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint32_t</span>      e_flags<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_ehsize<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_phentsize<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_phnum<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_shentsize<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_shnum<span class=\"token punctuation\">;</span>\n               <span class=\"token class-name\">uint16_t</span>      e_shstrndx<span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> ElfN_Ehdr<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>\n<p>ELF 프로그램 헤더는 프로그램 로딩에 필요한 <code class=\"language-text\">바이너리 세그먼트</code>를 정의한다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">세그먼트</code>는 디스크에 저장된 실행 파일이 커널에 의해 로드되는 과정에서 어떤 메모리 구조로 매핑될 것인지를 정의한다.</p>\n</li>\n<li>\n<p>프로그램 헤더 테이블은 ELF 헤더의 멤버인 <code class=\"language-text\">e_phoff</code> (프로그램 헤더 테이블 오프셋)를 조회해 접근한다.</p>\n</li>\n<li>\n<p>주로 사용하는 프로그램 헤더는 5가지로 실행 파일 및 공유 라이브러리의 세그먼트를 정의하고 세그먼트 형식(어떤 형식의 데이터 또는 코드가 있는지를 나타낸다.)</p>\n</li>\n<li>\n<p>32비트 ELF 실행 파일의 프로그램 헤더 테이블을 조회해 <code class=\"language-text\">ELF32_Phdr</code> 구조체가 형성하는 프로그램 헤더를 분석해도록 하겠다.</p>\n</li>\n</ul>\n<script src=\"https://gist.github.com/cfd77d6ea6a5cab5e51811028893e7cc.js\"></script>\n<h2 id=\"pt_load\" style=\"position:relative;\"><a href=\"#pt_load\" aria-label=\"pt_load permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PT_LOAD</h2>\n<ul>\n<li>실행 파일에는 <code class=\"language-text\">PT_LOAD</code> 형식의 세그먼트가 하나 이상 있어야 한다.</li>\n<li>해당 형식의 프로그램 헤더는 로드 가능한 세그먼트 형식으로 메모리에 로드 또는 매핑된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">동적 링킹이 가능한 ELF 실행 파일에 두 가지 로드 가능한 세그먼트<span class=\"token punctuation\">(</span>PT_LAOD<span class=\"token punctuation\">)</span>가 포함된다<span class=\"token punctuation\">.</span>\n\n<span class=\"token number\">1.</span> 프로그램 코드가 위치한 텍스트 세그먼트\n\n<span class=\"token number\">2.</span> 전역 변수와 동적 링킹 정보가 위치한 데이터 세그먼트</code></pre></div>\n<ul>\n<li>두 세그먼트는 <code class=\"language-text\">p_align</code> 값을 이용해 정렬된 후 메모리에 매핑된다.</li>\n<li>Phdr 구조체가 나타내는 세그먼트가 파일과 메모리에서 어떤 방식으로 동작하는지 이해하기 위해 리눅스의 <code class=\"language-text\">ELF(5) man</code> 페이지를 읽어보자</li>\n<li>프로그램 헤더는 프로그램이 메모리에서 실행될 때의 구조를 나타낸다.</li>\n</ul>\n<h2 id=\"code-segment\" style=\"position:relative;\"><a href=\"#code-segment\" aria-label=\"code segment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><em>Code Segment</em></h2>\n<ul>\n<li><code class=\"language-text\">PF_X | PF_R (READ+EXECUTE)</code> 라는 세그먼트 퍼미션을 가진다.</li>\n</ul>\n<h2 id=\"data-segment\" style=\"position:relative;\"><a href=\"#data-segment\" aria-label=\"data segment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><em>Data Segment</em></h2>\n<ul>\n<li><code class=\"language-text\">PF_W | PF_R (READ+WRITE)</code> 라는 세그먼트 퍼미션을 가진다.</li>\n</ul>\n<h2 id=\"pt_dynamic\" style=\"position:relative;\"><a href=\"#pt_dynamic\" aria-label=\"pt_dynamic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PT_DYNAMIC</h2>\n<ul>\n<li>동적 세그먼트에서 사용하는 프로그램 헤더</li>\n<li>동적 링킹되는 실행 파일에서 사용되며 동적 링커가 사용하는 정보가 담겨 있다.</li>\n</ul>\n<h2 id=\"pt_dynamic-주로-사용하는-값\" style=\"position:relative;\"><a href=\"#pt_dynamic-%EC%A3%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EA%B0%92\" aria-label=\"pt_dynamic 주로 사용하는 값 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PT_DYNAMIC 주로 사용하는 값</h2>\n<ul>\n<li>실행 시간에 링크되는 공유 라이브러리 목록</li>\n<li>전역 오프셋 테이블 (GOT)의 주소나 위치</li>\n<li>재배열 엔트리(relocation entry) 정보</li>\n</ul>\n<h2 id=\"pt_dynamic-주로-사용하는-태그\" style=\"position:relative;\"><a href=\"#pt_dynamic-%EC%A3%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%ED%83%9C%EA%B7%B8\" aria-label=\"pt_dynamic 주로 사용하는 태그 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PT_DYNAMIC 주로 사용하는 태그</h2>\n<script src=\"https://gist.github.com/dnsdudrla97/2b8bbd81148a879c2fc7fd87eea834ba.js\"></script>\n<ul>\n<li>동적 세그먼트에는 동적 링킹 정보가 담겨 있다.</li>\n<li><code class=\"language-text\">d_tag</code> 구조체 멤버는 <code class=\"language-text\">d_num</code> 구조체를 제어한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span>\n<span class=\"token punctuation\">{</span>\n    Elf32_Sword d_tag<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">union</span> <span class=\"token punctuation\">{</span>\n        Elf32_Word d_val<span class=\"token punctuation\">;</span>\n        Elf32_Addr d_ptr<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> d_un<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> Elf32_Dyn<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">extern</span> Elf32_Dyn _DYNAMIC<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"pt_note\" style=\"position:relative;\"><a href=\"#pt_note\" aria-label=\"pt_note permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PT_NOTE</h2>\n<ul>\n<li>\n<p>특정 벤더나 시스템에 관한 부가적인 정보를 포함한다.</p>\n</li>\n<li>\n<p>벤더 또는 시스템 빌더는 <code class=\"language-text\">SHT_NOTE</code> 섹션 형식과 <code class=\"language-text\">PT_NOTE</code> 프로그램 헤더를 이용하여 오브젝트 파일에 호환성 등의 정보를 기록할 수 있다.</p>\n</li>\n<li>\n<p>섹션과 프로그램 헤더는 4바이트 워드 형식의 문자열 형태이며 저장 공간의 제약은 없다.</p>\n</li>\n<li>\n<p>레이블도 추가정보를 나타내기 위해 포함될 수 있으나 필수 요구사항은 아니다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">PT_NOTE</code> 세그먼트는 OS에서만 참조하기 때문에 실행 파일이 실행되는 동안에 꼭 필요한 정보가 아니다.</p>\n</li>\n</ul>\n<h2 id=\"pt_interp\" style=\"position:relative;\"><a href=\"#pt_interp\" aria-label=\"pt_interp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PT_INTERP</h2>\n<ul>\n<li>크기가 작은 해당 섹션은 NULL 종료 문자열의 주소와 크기, 그리고 프로그램 인터프리터의 위치를 나타낸다.</li>\n<li>프로그램 인터프리터는 동적 링커라고 도 하며 일반적으로 <code class=\"language-text\">/lib/linux-ld.so.2</code> 에 위치한다.</li>\n</ul>\n<p><img src=\"/assets/img/posts/ELF/ELF-5/0.png\" alt=\"/assets/img/posts/ELF/ELF-5/0.png\">{: width=“70%” height=“70%“}</p>\n<h2 id=\"pt_phdr\" style=\"position:relative;\"><a href=\"#pt_phdr\" aria-label=\"pt_phdr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PT_PHDR</h2>\n<ul>\n<li>프로그램 해더의 주소와 크기를 나타낸다.</li>\n<li>프로그램 헤더 테이블은 프로그램 헤더의 세그먼트가 파일과 메모리 이미지의 어는 곳에 있는지를 가리킨다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">readelf <span class=\"token operator\">-</span>l <span class=\"token operator\">&lt;</span>binary<span class=\"token operator\">></span></code></pre></div>\n<p><img src=\"/assets/img/posts/ELF/ELF-5/1.png\" alt=\"/assets/img/posts/ELF/ELF-5/1.png\">{: width=“70%” height=“70%“}</p>\n<ul>\n<li>실행 파일의 엔트리 포인트와 앞에서 말한 여러 종류의 세그먼트 형시을 볼 수 있다.</li>\n<li>권한 플래그의 오른쪽에 위치한 오프셋과 두 개의 <code class=\"language-text\">PT_LOAD</code> 세그먼트에 있는 정렬 플래그를 보게 되면</li>\n<li>텍스트 세그먼트는 <code class=\"language-text\">READ+WRITE</code> 퍼미션을 가지고 있으며, 데이터 세그먼트는 <code class=\"language-text\">READ+WRITE</code> 퍼미션을 가지고 있다.</li>\n<li>두 세그먼트는 <code class=\"language-text\">0x600e10</code> , <code class=\"language-text\">0x600e28</code> 정렬 오프셋을 가지고 있으며, 이 값은 32비트 실행 파일에서의 페이지 크기와 같다.</li>\n<li>오프셋은 프로그램이 로드되는 과정에서 정렬을 위해 사용한다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#pt_load\">PT_LOAD</a></li>\n<li><a href=\"#code-segment\"><em>Code Segment</em></a></li>\n<li><a href=\"#data-segment\"><em>Data Segment</em></a></li>\n<li><a href=\"#pt_dynamic\">PT_DYNAMIC</a></li>\n<li><a href=\"#pt_dynamic-%EC%A3%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EA%B0%92\">PT_DYNAMIC 주로 사용하는 값</a></li>\n<li><a href=\"#pt_dynamic-%EC%A3%BC%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%ED%83%9C%EA%B7%B8\">PT_DYNAMIC 주로 사용하는 태그</a></li>\n<li><a href=\"#pt_note\">PT_NOTE</a></li>\n<li><a href=\"#pt_interp\">PT_INTERP</a></li>\n<li><a href=\"#pt_phdr\">PT_PHDR</a></li>\n</ul>\n</div>","excerpt":"ELF 프로그램 헤더 ELF 프로그램 헤더는 프로그램 로딩에 필요한 를 정의한다. 는 디스크에 저장된 실행 파일이 커널에 의해 로드되는 과정에서 어떤 메모리 구조로 매핑될 것인지를 정의한다. 프로그램 헤더 테이블은 ELF 헤더의 멤버인  (프로그램 헤더 테이블 오프셋)를 조회해 접근한다. 주로 사용하는 프로그램 헤더는 5가지로 실행 파일 및 공유 라이브러리의 세그먼트를 정의하고 세그먼트 형식(어떤 형식의 데이터 또는 코드가 있는지를 나타낸다.) 32비트 ELF 실행 파일의 프로그램 헤더 테이블을 조회해  구조체가 형성하는 프로그램 헤더를 분석해도록 하겠다. PT_LOAD 실행 파일에는  형식의 세그먼트가 하나 이상 있어야 한다. 해당 형식의 프로그램 헤더는 로드 가능한 세그먼트 형식으로 메모리에 로드 또는 매핑된다. 두 세그먼트는  값을 이용해 정렬된 후 메모리에 매핑된다. Phdr 구조체가 나타내는 세그먼트가 파일과 메모리에서 어떤 방식으로 동작하는지 이해하기 위해 리눅스의  페…","frontmatter":{"date":"August 16, 2020","title":"ELF 프로그램 헤더 (ELF Program Header)","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"📠"},"fields":{"slug":"/elf_device_file4/"}},"next":{"id":"093caa3f-71ec-5562-a741-87d4d08470d1","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"angry-bird-바이너리-동작-결과\" style=\"position:relative;\"><a href=\"#angry-bird-%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%8F%99%EC%9E%91-%EA%B2%B0%EA%B3%BC\" aria-label=\"angry bird 바이너리 동작 결과 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Angry Bird 바이너리 동작 결과</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 5.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOElEQVQI12OwtbW1NDdXt3fTNzI20Nc3NDQ0NzMztjSL0LJPFjfSl1WSl5YVEBQQ4OcXQgX8/PwATlwI0etcYhwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/3b5865e318632473c734c46d979a6987/37523/0.png\"\n        srcset=\"/static/3b5865e318632473c734c46d979a6987/e9ff0/0.png 180w,\n/static/3b5865e318632473c734c46d979a6987/f21e7/0.png 360w,\n/static/3b5865e318632473c734c46d979a6987/37523/0.png 720w,\n/static/3b5865e318632473c734c46d979a6987/302a4/0.png 1080w,\n/static/3b5865e318632473c734c46d979a6987/07a9c/0.png 1440w,\n/static/3b5865e318632473c734c46d979a6987/f33fc/0.png 1905w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>바이너리 실행시 아무 결과가 안나오는 것을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkUlEQVQI102MSw6CMBQAuf+pLAIHoG4sKpGoSe039Edp6TNGTZztZKbCGCOEmmZPyINSmOeSM5QCAODcypgTIjClXbJutTHFbdvgR4VxX9e7tkWE3McRpql4/42tjVov7OmPtyubpVtCTEtO+T++INR33WEY6PmkOJMhuI/zPhkTKQ1CWQAwxkohlVac85zfixdmyad8f7owJgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/00449beb5b381832f69e68bba481a5dc/37523/1.png\"\n        srcset=\"/static/00449beb5b381832f69e68bba481a5dc/e9ff0/1.png 180w,\n/static/00449beb5b381832f69e68bba481a5dc/f21e7/1.png 360w,\n/static/00449beb5b381832f69e68bba481a5dc/37523/1.png 720w,\n/static/00449beb5b381832f69e68bba481a5dc/108f8/1.png 777w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">Stack Smahsing Protector(SSP)</code> 보호기법이 적용되어 있어 Stack Prlog를 거치면서 <code class=\"language-text\">Stack Canary</code> 를 <code class=\"language-text\">rax</code> 레지스터에 <code class=\"language-text\">TEB</code>에서 생성된 값을 가져와 해당 값을 스택에 집어넣는 것을 확인할 수가 있으며</li>\n<li><code class=\"language-text\">eax</code> 레지스터를 0으로 초기화 한후 0과 비교를 하여 <code class=\"language-text\">exit</code> 함수로 점프하는 것을 볼 수 있다.</li>\n<li>그래서, 해당 바이너리를 실행하였을 때 바로 끝나는 모습을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"nop-sled-적용\" style=\"position:relative;\"><a href=\"#nop-sled-%EC%A0%81%EC%9A%A9\" aria-label=\"nop sled 적용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nop Sled 적용</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmklEQVQI1y3NQQ6CMBBAUe5/Fhcu3egZjIlCrJ3SqQJSZwaoFllIDca3//mZ/UF0RPWNtoq06wvgjWZnBExntL/k5531K+vXDe+ZUggfkTRNKfvHFv2jBcmP7UmzKh4HEHMdnOuw7EroUbFTYuuB3jHFODOncUwZIqJbsLB/kRFTim2e9ypUVaiAQZECBs0Ku5IijTENYSZazl99j6KSKC3PhgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/d69e02d27fa50f6c7aab28bacd1866c4/0a47e/2.png\"\n        srcset=\"/static/d69e02d27fa50f6c7aab28bacd1866c4/e9ff0/2.png 180w,\n/static/d69e02d27fa50f6c7aab28bacd1866c4/f21e7/2.png 360w,\n/static/d69e02d27fa50f6c7aab28bacd1866c4/0a47e/2.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">_exit</code> Hex 값을 90(Nop)으로 패치하여 점프를 뛰어도 끝날 수 없도록 진행하였다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgUlEQVQI12WLsQrDIBRF/f8fagdfhm7JEKUpZMge0Grsw1RfFGJrlgZ6hguHy2HT5Np27rp5HJ3WBbGcWdcNX1sIt5jqQUTWWkT03hMRGwYBcG2aixB3Y37ZvtdFpGWJh1YPITwPcs6lFCal5BwAeN8//mPnojHvc6y1VkqllL7xB8kpqFh4nz+pAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/c7c71e94b6a14b08fcd20f3dd63e27c0/37523/3.png\"\n        srcset=\"/static/c7c71e94b6a14b08fcd20f3dd63e27c0/e9ff0/3.png 180w,\n/static/c7c71e94b6a14b08fcd20f3dd63e27c0/f21e7/3.png 360w,\n/static/c7c71e94b6a14b08fcd20f3dd63e27c0/37523/3.png 720w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABT0lEQVQY013LzUvCYBzA8YduW1sxEXzJg46ITOlNsOhUXeov6O+KoKCQgqhDgxxFHlTMbAOdm9ODh7SUEruU4lut5R73i6QO9eF7/SJOzsefamJTy77pBcP4l6rrZYDjy8hqYGVzbX15KehfDDinvA6bzWq1ooPbwnmpnmz1Y622aGiSibMmyPCThHER4PQisuUObnjn/T7vzNwC65tlPe4JlwuFhBRfrqQ6erLbkwysAKQ1Tey0M7quDOc7gH0+PG5lJr3TLMuyHo/TYbfZ7QzDoJAghEvVzOdABVBMMwcgdnup14Y8MBUTJON73uO4EYQsjIWmaYqiSHKUJEmCINBhWuArFeG9H+u+xJudq3pb1D5UwDkAFUDG+B5glztDCFE0TQyRv9AOL5yI1cuixuUb0Wo/+mAkHvF1zUjWzZtnSNSw0oPtIw4hRNNj5F9fREfVWM7jgIsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/8ce7efe9ddd4a1730a488b3f708c2ef9/37523/4.png\"\n        srcset=\"/static/8ce7efe9ddd4a1730a488b3f708c2ef9/e9ff0/4.png 180w,\n/static/8ce7efe9ddd4a1730a488b3f708c2ef9/f21e7/4.png 360w,\n/static/8ce7efe9ddd4a1730a488b3f708c2ef9/37523/4.png 720w,\n/static/8ce7efe9ddd4a1730a488b3f708c2ef9/302a4/4.png 1080w,\n/static/8ce7efe9ddd4a1730a488b3f708c2ef9/71e8d/4.png 1304w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>디버거를 바탕으로 <code class=\"language-text\">_exit</code> 함수로 점프하는 것은 우회를 하여 <code class=\"language-text\">you shoul return 21 not 1 :(</code> 문자열을 반환하는 것을 확인할 수있다.</li>\n</ul>\n<h2 id=\"you-should-return-21-not-1-\" style=\"position:relative;\"><a href=\"#you-should-return-21-not-1-\" aria-label=\"you should return 21 not 1  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>you should return 21 not 1 :(</h2>\n<ul>\n<li>출력된 결과를 확인해 보면 21을 반환해야 한다고 한다.</li>\n<li>해당 함수를 분석해보도록 하겠다.</li>\n</ul>\n<h2 id=\"sub_4006f6-함수-분석\" style=\"position:relative;\"><a href=\"#sub_4006f6-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_4006f6 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sub_4006F6 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVQI1z2N0QqDMAxF/f+fEhV9U9jDRDYpbHSgKG52mMYmbUYVdgh5uNzkJEqpsizzPG/bDkC8FxExhseREL0xtG1EFFPyDgndsYMEEUmUUlVVFUXRdbfHQ55P+X7lxFpaFhhHGIYNd0Z0FqwFy8RExMxJ3/dZlqVperlcXy95v+OE+FcA3Dxvy7Kv676uOE0GLCAiHUSz1rppmrqu7/eeKJxOY3ia3OcTtOajFvHe88H/+Ads1uEm9gowtwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/e78579349755a3bd0a09187171016d3a/37523/5.png\"\n        srcset=\"/static/e78579349755a3bd0a09187171016d3a/e9ff0/5.png 180w,\n/static/e78579349755a3bd0a09187171016d3a/f21e7/5.png 360w,\n/static/e78579349755a3bd0a09187171016d3a/37523/5.png 720w,\n/static/e78579349755a3bd0a09187171016d3a/5a6dd/5.png 802w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>앞의 문자열을 출력한 함수 블록 내부이며 반환 되는 값 <code class=\"language-text\">dword_606060</code> 영역을 확인해보자</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 539px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZklEQVQI142LMQ6DMBAE+f8bEQQcpTGggLk4B77dyMKmzmiKKXablADgPI3kMm+jez29/4iyAhSvNitNsuk6GQZx7q1q/WPqx9byCPdTJKvKGLmu3HceRz2HgBAMyIrgG0FYSvYPP30Ur3oQ9tIgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/3d0e2f0da47d21a8e2bf152607d98c5b/10f9a/6.png\"\n        srcset=\"/static/3d0e2f0da47d21a8e2bf152607d98c5b/e9ff0/6.png 180w,\n/static/3d0e2f0da47d21a8e2bf152607d98c5b/f21e7/6.png 360w,\n/static/3d0e2f0da47d21a8e2bf152607d98c5b/10f9a/6.png 539w\"\n        sizes=\"(max-width: 539px) 100vw, 539px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>확인 결과 <code class=\"language-text\">1</code>을 담고 있는 것을 확인하였다.</li>\n<li>우리는 21을 반환해야 하기 때문에 <code class=\"language-text\">21</code> 로 패치하도록 한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 676px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAWElEQVQI1yXKwQqAMAwDUP//HwdexCmOsYN2addFqu8QAslynkyJObOU2ZrVKr2PbWtrPh4IP2MQoCrNKBL5W1R53zG4z31HrQLoVUwQF/+YOeCqkb1H+b2EcXRRrUQvpQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/8a2839d7516f5eef637a43f191a408ed/9bb7a/7.png\"\n        srcset=\"/static/8a2839d7516f5eef637a43f191a408ed/e9ff0/7.png 180w,\n/static/8a2839d7516f5eef637a43f191a408ed/f21e7/7.png 360w,\n/static/8a2839d7516f5eef637a43f191a408ed/9bb7a/7.png 676w\"\n        sizes=\"(max-width: 676px) 100vw, 676px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>하지만 중요한 사실은 반환된 결과 값을 mov 명령어를 바탕으로 <code class=\"language-text\">[rbp+n]</code> 대입 하는 것을 확인할 수 있는 데 OPER2에 해당하는 <code class=\"language-text\">eax</code> 레지스터는 32bit 형식이기에 <code class=\"language-text\">mov</code> 명령을 사용하게 되면 성질이 맞지 않아 <code class=\"language-text\">Segment Falut</code> 가 뜨고 만다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 685px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARUlEQVQI1wXB0QqAIAwF0P7/y3wSfJYCYbCEkHC1tqDdzllaO3PmlKgUrlWJ0DtEACAiAIzxzOm8y7od9/VGfGamqu7+A4gON/qaZvMlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/2381009df4e303ad2da06ca16d484748/8ce22/8.png\"\n        srcset=\"/static/2381009df4e303ad2da06ca16d484748/e9ff0/8.png 180w,\n/static/2381009df4e303ad2da06ca16d484748/f21e7/8.png 360w,\n/static/2381009df4e303ad2da06ca16d484748/8ce22/8.png 685w\"\n        sizes=\"(max-width: 685px) 100vw, 685px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAi0lEQVQY04WOyw6EMAhF/f+/NDG6kKZWWwuWx8TWUReTzFkQcsMBunG0YbCUzMxUz+p9di6FwNNE24bMuq6r9x4AYoxHpZSiqt3t3M2yIEB65yEEAHDOMbO9+C3P8yV/k2Wu/Jfb26VIKdLyGGOoMLNWHrnBbETtztH3SCQi1xBWiAgRc877voucez/XpSSmUwifAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/56523e94bfc63dede1162e9089c0362a/1f083/9.png\"\n        srcset=\"/static/56523e94bfc63dede1162e9089c0362a/e9ff0/9.png 180w,\n/static/56523e94bfc63dede1162e9089c0362a/f21e7/9.png 360w,\n/static/56523e94bfc63dede1162e9089c0362a/1f083/9.png 660w\"\n        sizes=\"(max-width: 660px) 100vw, 660px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">NOP</code> 명령으로 해당 값 부분을 패치하여 우회하도록 한다.</li>\n<li>sub_40070C  부분도 똑같이 NOP으로 채워 우회하도록 한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 677px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwUlEQVQoz42QUY7DIAwFe/9jVoJAggJbB4yB2KtCGlVt1d359jDiXaZJvBciYZZaZWDMBkDTdAOgUhpRa21n5r0jDy5KyfUqSt39E2O2lKrWFEIGIGt/nAshBAAopTDzIRsj71i7ldJEZJzljK7TWns+u5ffMWYrZR8ys8SY5nlZluVfslK3UR7EGG2nnqt8kbWGUR6klObOq6z13/Iof5C/DHauiojrunrvX//s3MfBALEiHh0iijGmlHLO2Bnv/gKuUA6+QXzFMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/0cc3c4dd543f217c7fd015061c86f0a5/68de2/10.png\"\n        srcset=\"/static/0cc3c4dd543f217c7fd015061c86f0a5/e9ff0/10.png 180w,\n/static/0cc3c4dd543f217c7fd015061c86f0a5/f21e7/10.png 360w,\n/static/0cc3c4dd543f217c7fd015061c86f0a5/68de2/10.png 677w\"\n        sizes=\"(max-width: 677px) 100vw, 677px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"sub_40072a-함수\" style=\"position:relative;\"><a href=\"#sub_40072a-%ED%95%A8%EC%88%98\" aria-label=\"sub_40072a 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_40072A 함수</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7klEQVQY003I0UuDQBwAYP/6Pfe4CLJFsBpu1FoUzSaE0zO1RVQ0ETdYG2nF9Jw7z/PuFyOCg+/pU/qz+RFCqjXW3kNjXQ0TMi6pD+D9e6jrHVa7nHvSewDKRZSoKFStoPO6usf0Ns4Gq9jAzM90f33ucuowhihFtHJq7gLIlEEUtZDVsk3tLTBzanxt9ATbhD4BTAB8DvaWPQo+AfgbmdJ8njV0qzE095zpybI8DMnBlLQTpqWim4OWivYCny2zzmehZaKLQaacBvN9221azvFLePVDe4viMibXKbsjYlTBqBT9j+LmO9fxdjcUZL9NsgPvjFhhwAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/5eb37b2d4169c724b4719f2c2aa7cc0e/37523/11.png\"\n        srcset=\"/static/5eb37b2d4169c724b4719f2c2aa7cc0e/e9ff0/11.png 180w,\n/static/5eb37b2d4169c724b4719f2c2aa7cc0e/f21e7/11.png 360w,\n/static/5eb37b2d4169c724b4719f2c2aa7cc0e/37523/11.png 720w,\n/static/5eb37b2d4169c724b4719f2c2aa7cc0e/d7542/11.png 810w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>앞 조건을 마치고 해당 함수로 들어오는데 여기서는 <code class=\"language-text\">\"hello\"</code> 문자열 과 입려 값을 비교하여 동일할 경우 정상적으로 반환하는 것을 확인할 수 있다.</li>\n<li><code class=\"language-text\">0x606038</code> 주소가 어디인지 확인하였으나 <code class=\"language-text\">__libc_start_main</code> got 영역의 주소  값인 것을 알았으며 해당 부분에서 어떤 문자열을 가져와 비교하는지를 모르기 때문에 <code class=\"language-text\">Ghidra</code> 디컴파일을 통해 확인하여</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 615px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAu0lEQVQY04XQW47DIAwF0KykbXgYY7ADBBLSzCP7X9VoMr+ZVrL8caUjXXvIcxsp3nh6cHpwuktWpfm2oSRlUYN/McPc91zXXFfjaDwjZVH97bdYto+pNAiiMTgfwUdHDBSR2GIYndPoLYZr3PfvedlgXurnUdc+lVbXZ2l96TtxugUDEqOUyxYDpdK/jtp6Li1IJk4UEwYhTsaRtl5b/1//ASQbnhyxAm/OyDj6ZUCvDz5xrjbw299c4h8Kb0N6MJOGRgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/aeb0f08356c2c8ac7de4a2010e105f1f/f6b72/12.png\"\n        srcset=\"/static/aeb0f08356c2c8ac7de4a2010e105f1f/e9ff0/12.png 180w,\n/static/aeb0f08356c2c8ac7de4a2010e105f1f/f21e7/12.png 360w,\n/static/aeb0f08356c2c8ac7de4a2010e105f1f/f6b72/12.png 615w\"\n        sizes=\"(max-width: 615px) 100vw, 615px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 조건을 마찬가지로 <code class=\"language-text\">NOP</code> 으로 채워 우회하도록 하겠다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABD0lEQVQoz3XRYWuDMBAGYP//fypSokYpbIN96WxkbQMOmpjEWZM0xtyYlWJLex9z75M7uKiqqizDm02x3/82DVwuwXsAAKWslOYkWu/H89n0vXHuEkKARUVl+YXQuigSQtrtFk6nua2UEUJ/H5lQWilrjAOAewvRbndA6A3j96rq6hqMmftSGqXcT22dG7tOa917PwI8YorQB8aflPbTxzNuGn1LSykZY+P4BJdJss7zhNJ2iYW4w5zzJ5gQkiQpxvh4fI5DeI3LskQIZVl6OKgHfEu/XJsQkqZpnmNK2+llxoz11vppchBCcM611tba5bX+J69WqziOOW+uUaWclJ6x0HXhurafahgG59wS/wE/Gf+sQWdCdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./13.png\"\n        title=\"./13.png\"\n        src=\"/static/91a12462ee47d9525dddf6a6ee85e4d1/37523/13.png\"\n        srcset=\"/static/91a12462ee47d9525dddf6a6ee85e4d1/e9ff0/13.png 180w,\n/static/91a12462ee47d9525dddf6a6ee85e4d1/f21e7/13.png 360w,\n/static/91a12462ee47d9525dddf6a6ee85e4d1/37523/13.png 720w,\n/static/91a12462ee47d9525dddf6a6ee85e4d1/7e4a6/13.png 952w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>싹따 채워 버렸다. 😀</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaklEQVQI12MwMzMzMTY2MDEVMndS09BUU1VVVQMBVVVVdXV1VVVVXV1dTU1NbR0dbU2tCDHjJFFzGz4xeXFxMUERBi4uLnYODg52di4WJlZWVlY2KIAzWVhYWGGAgZOZgZOZiZMDpIWTEwC20AsfEByN4wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./14.png\"\n        title=\"./14.png\"\n        src=\"/static/3993938352d4ec16d5ef3f0085933325/37523/14.png\"\n        srcset=\"/static/3993938352d4ec16d5ef3f0085933325/e9ff0/14.png 180w,\n/static/3993938352d4ec16d5ef3f0085933325/f21e7/14.png 360w,\n/static/3993938352d4ec16d5ef3f0085933325/37523/14.png 720w,\n/static/3993938352d4ec16d5ef3f0085933325/302a4/14.png 1080w,\n/static/3993938352d4ec16d5ef3f0085933325/72372/14.png 1149w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>패치후 <code class=\"language-text\">fget</code> 함수를 바탕으로 입력을 받을 수 있도록 되었다.</li>\n</ul>\n<h2 id=\"미친-조건들\" style=\"position:relative;\"><a href=\"#%EB%AF%B8%EC%B9%9C-%EC%A1%B0%EA%B1%B4%EB%93%A4\" aria-label=\"미친 조건들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>미친 조건들</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVQoz3XK207DMBCEYb//0yFAAiRUkebktKSkOXrt3R0UWllOI6Tv6p8xDNwo0I9j3ZxEIQAr4vQfQ4qIgW6c8tqSiFeQIF33zCyIJlYCfqYlq+3E7BTpumcGRqoPOgPt7A6lvVKYFAPrwycyV8aDLuig+F7os7St872sZX+7Mswl4BLQen3QCU6L/yhtM1Mn6+H2TJlzwMnreeuvoGU0xG9lU43uIlingJSxHjWp9UjF0gTUjl8Lm/XLWWC3T1MRSqcVIRVLSag8KpLn3B66yfLmZnLC0eleTrhzKAiFx1PRvLdD4REn8+WwWnTjFhOZw5HwYn8Os2R0j7/pNXuglRLCMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./15.png\"\n        title=\"./15.png\"\n        src=\"/static/d264ef6c46a7e66f6c4d61866acc2f8e/37523/15.png\"\n        srcset=\"/static/d264ef6c46a7e66f6c4d61866acc2f8e/e9ff0/15.png 180w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/f21e7/15.png 360w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/37523/15.png 720w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/302a4/15.png 1080w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/07a9c/15.png 1440w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/29114/15.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>무수히 많은 조건들을 거치고 거쳐 마지막에 “you typed : %s\\n” 출력하는 곳으로 가봐야 될 것 같다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA30lEQVQY002NTUvDQBCG8/+Pnjx49U8UFAStDQVp6TEJSRtrs9pmZ3ey7k72Y6RNoT6HF+blfZhsPv9cLvd9b5k5JfY+SmmHYZzOS6aUWJMGC+jwZE4UiC9kT893eX5flm1V8eFwHhKFGBnAIpIQuN1JrZ0eEDQoVD30ox+v8tvrw2r12DSirrksk/dTz1Japdz+61chBZ+cG8md4X9ks9lLnn8UxVAU3DTJ2puMSF1ndt23NOCsmyCiGONVXizeN5t126IQDHD7rDUZMwpB9dZUtTn+oFIgpTTGhBAm+Q+UGRn5uCcIFAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./16.png\"\n        title=\"./16.png\"\n        src=\"/static/be304a44ada0a4f1949b9eb66cc4e24a/37523/16.png\"\n        srcset=\"/static/be304a44ada0a4f1949b9eb66cc4e24a/e9ff0/16.png 180w,\n/static/be304a44ada0a4f1949b9eb66cc4e24a/f21e7/16.png 360w,\n/static/be304a44ada0a4f1949b9eb66cc4e24a/37523/16.png 720w,\n/static/be304a44ada0a4f1949b9eb66cc4e24a/5a190/16.png 800w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>angr 모듈을 사용하여 solve 를 작성해보겠다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"solved-code\" style=\"position:relative;\"><a href=\"#solved-code\" aria-label=\"solved code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">solved</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p<span class=\"token operator\">=</span>angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./angrybird_3'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token comment\"># state를 임의로 위 함수를 무시한채 해당 지역부터 시작하도록 한다.</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span>addr<span class=\"token operator\">=</span><span class=\"token number\">0x4007C2</span><span class=\"token punctuation\">)</span>\n\n    sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n    sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x404fab</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 최하단 True 주소 값</span>\n\n    flag <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"solved-code2\" style=\"position:relative;\"><a href=\"#solved-code2\" aria-label=\"solved code2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code2</h2>\n<ul>\n<li>앞에서 해당 함수들을 패치를 진행하였는데 해당 패치를 하지 않고 angr 모듈을 사용하여 우회하는 방안도 존재한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 645px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3UlEQVQY01WPy26DMBQF+f+/KqwraBcV0GDH2EVFwQTb2Fz8ulXURZtZnN1IcwpWVvNbQy/nlWHX5nHE40BEzPmxnCvnwjCshC3bHbZ9X7VapZPSSmkLVlXfTU36g1Kcpmwt/kcI7VzgXHfsa1l371MMD84TYgzFWL7MzSvpgVDs+3y7PcmcK2s954rw2VpIKXt/en8CgPeh+KzqsW6H/qRXHC55mjDGv2wh9K880EVtATMq7YwBYwwAFB9lx94ZuQRKcVlw358+C6EAwjybkemWLJuxRqOUMcaQUvoBjpkY697mva0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./17.png\"\n        title=\"./17.png\"\n        src=\"/static/d021af799dffbfa1be4bfde9355fde46/af192/17.png\"\n        srcset=\"/static/d021af799dffbfa1be4bfde9355fde46/e9ff0/17.png 180w,\n/static/d021af799dffbfa1be4bfde9355fde46/f21e7/17.png 360w,\n/static/d021af799dffbfa1be4bfde9355fde46/af192/17.png 645w\"\n        sizes=\"(max-width: 645px) 100vw, 645px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 <code class=\"language-text\">sub_4006F6</code>, <code class=\"language-text\">sub_40070C</code> 함수를 무시한채 <code class=\"language-text\">rbp</code> 기준 값을 현재 <code class=\"language-text\">0x4007c2</code> 주소로 기준을 잡도록 수정하도록 한다. 즉, 메인 함수 프롤로그를 해당 주소로 바꾸는 것이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.555555555555557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfElEQVQI1y3LSw6CMAAFQK7rGTyZMdGwMtGFnwbSWqrQCv0uKCSSEMvThbOfTJK62N+K3ZUfn52G1mAMwwAAKSXnlnE8iGr1UrPoVCU1vwfGPKUeQObLssnzx3ajTpe6AaULIZimf7b2E+OZi7U1cxucCb01b6WilP0vfwFlp2txCBQzVwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./18.png\"\n        title=\"./18.png\"\n        src=\"/static/c3c30d9bc922d388bdf0ba6515463301/37523/18.png\"\n        srcset=\"/static/c3c30d9bc922d388bdf0ba6515463301/e9ff0/18.png 180w,\n/static/c3c30d9bc922d388bdf0ba6515463301/f21e7/18.png 360w,\n/static/c3c30d9bc922d388bdf0ba6515463301/37523/18.png 720w,\n/static/c3c30d9bc922d388bdf0ba6515463301/c8e86/18.png 758w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n\nSTART_ADDR <span class=\"token operator\">=</span> <span class=\"token number\">0x4007c2</span>\nFIND_ADDR <span class=\"token operator\">=</span> <span class=\"token number\">0x404fab</span>  <span class=\"token comment\"># This is right before the printf</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    proj <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./angrybird'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 해당 바이너리에서 함수 부분을 우회 한다.</span>\n    state <span class=\"token operator\">=</span> proj<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span>addr<span class=\"token operator\">=</span>START_ADDR<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 함수 프롤로그 변경</span>\n    state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rsp\n    <span class=\"token comment\"># 0x40의 길이 값</span>\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x74</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x40</span>\n\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x70</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1000</span> <span class=\"token comment\"># strncmp@got</span>\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1008</span> <span class=\"token comment\"># puts@got</span>\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x60</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1010</span> <span class=\"token comment\"># _stack_chk_fail@got</span>\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x58</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1018</span> <span class=\"token comment\"># _lib_start_main</span>\n\n    sm <span class=\"token operator\">=</span> proj<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simulation_manager<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 시뮬레이션 생성</span>\n    sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>FIND_ADDR<span class=\"token punctuation\">)</span>\n\n    found <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    flag <span class=\"token operator\">=</span> found<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>    \n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAm0lEQVQI1xXLQQ6DIBAAQP/RZfHWVERAZMWKClqxifX/32lM5jrFfP3c/hmvs10Tffc2bzx0EB1sBJFYJEhULgSHZ5PFTkOwqBtGuiRTmLyKNKmcxBJkjtURMXSwdJAcrI5FB4l46h/ZQ3SoJFqFdY1alkoVlHeX9/E6mzm8xuE59txp5g0b2ltv2Nty30KwrDe8FvevBDYShfgDNDQjUMpl6PYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./19.png\"\n        title=\"./19.png\"\n        src=\"/static/d86792bff2be708d2a6fcf4ad09b0b58/37523/19.png\"\n        srcset=\"/static/d86792bff2be708d2a6fcf4ad09b0b58/e9ff0/19.png 180w,\n/static/d86792bff2be708d2a6fcf4ad09b0b58/f21e7/19.png 360w,\n/static/d86792bff2be708d2a6fcf4ad09b0b58/37523/19.png 720w,\n/static/d86792bff2be708d2a6fcf4ad09b0b58/6d2da/19.png 936w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#angry-bird-%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%8F%99%EC%9E%91-%EA%B2%B0%EA%B3%BC\">Angry Bird 바이너리 동작 결과</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#nop-sled-%EC%A0%81%EC%9A%A9\">Nop Sled 적용</a></li>\n<li><a href=\"#you-should-return-21-not-1-\">you should return 21 not 1 :(</a></li>\n<li><a href=\"#sub_4006f6-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">Sub_4006F6 함수 분석</a></li>\n<li><a href=\"#sub_40072a-%ED%95%A8%EC%88%98\">sub_40072A 함수</a></li>\n<li><a href=\"#%EB%AF%B8%EC%B9%9C-%EC%A1%B0%EA%B1%B4%EB%93%A4\">미친 조건들</a></li>\n<li><a href=\"#solved-code\">Solved Code</a></li>\n<li><a href=\"#solved-code2\">Solved Code2</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 15, 2020","title":"CodeGate2017 angrybird 분석","categories":"CTF","author":"Zer0Luck","emoji":"🦩"},"fields":{"slug":"/codegate2017_angrybird_ctf_writeup/"}},"prev":{"id":"88ca51e5-5708-59c2-a863-767986781412","html":"<h2 id=\"objdump\" style=\"position:relative;\"><a href=\"#objdump\" aria-label=\"objdump permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Objdump</h2>\n<ul>\n<li>GNU Binutils</li>\n<li>난독화 되지 않은 일반적인 바이너리를 디스어셈블링하여 작업할 수 있다.</li>\n<li>일반적인 ELF 형식이라면 모두 읽을 수 있다.</li>\n</ul>\n<h3 id=\"예제-바이너리\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%A0%9C-%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC\" aria-label=\"예제 바이너리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예제 바이너리</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// gcc -o test test.c</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> n<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>ELF 파일의 모든 섹션, 데이터/코드 출력</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">objdump <span class=\"token operator\">-</span>D <span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>binary<span class=\"token operator\">></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFUlEQVQY02VQC2qDQBT0Hm2i0XW/rvtfV41RiCSBSCptIKX3P0hJLKWkMDxm4A0zTMS19+1gQmfC1re9a3Z+Oyhfc+0L5bj2XHvpaswV5oqWulAuRWydoRjgCBCe4SIGGBVy+WDSAsITQJL8AXi/McA/8sEXRMLW7TBW217aIGwoTdhAukrhOkPrDK1SuPBfw19EyrfTfF26MWEhkxtIEkila6gwqJCk1Dktl+RnMzfVfP18TYCtO98O0oXSVDkVtu7aYXy/fR2n+XB+k75hwjz5I66ry8ctBtg1O9f0mCvIRJLTUlfNMB6nudsf96eJcLVK4XMyk/ZwvsQAc+2FrVEh72vlxFT38Xf7Uz+ehA0vCfhf+xtfZkukzh/EsQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/2c23c866657e4052afc085bdebe493fe/37523/0.png\"\n        srcset=\"/static/2c23c866657e4052afc085bdebe493fe/e9ff0/0.png 180w,\n/static/2c23c866657e4052afc085bdebe493fe/f21e7/0.png 360w,\n/static/2c23c866657e4052afc085bdebe493fe/37523/0.png 720w,\n/static/2c23c866657e4052afc085bdebe493fe/9f82e/0.png 820w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ELF 파일의 프로그램 코드 출력</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">objdump <span class=\"token operator\">-</span>d <span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>binary<span class=\"token operator\">></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAUlEQVQY022Q206DQBiEeZAWpCx7gP33fGAXSkupNdWo0fj+z2KqSW80mcv5ZiZTmDhOy0X5NOyXfFjtMNlhUi6ZkF3a65BBB8oVBU1Bd8rtSF82pEK0QrTAvUQMEINOWiZMrxwFXSFaNqTc4bvvXxXKpzgtOmRhYq9cQ/imbu/M9g9/C/3RDU7z6eX9i4IeT5fj+gQ2ElBce2mH4+V5PJ6ZMIjysiFMWSassFHYSLgqG1K4tL++fmxrnOY1zyewsUKU6+DzfH37nJZzPqzKJyYMGI97WeNuR3iNu1uzcHFaHh9aBiaA8UyYTd120ko3CBuYMA3lbScwV7iXv2/dZ38DEWBAasJKKqoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/d39f6e5180d85cb9954685ab0bb833c0/37523/1.png\"\n        srcset=\"/static/d39f6e5180d85cb9954685ab0bb833c0/e9ff0/1.png 180w,\n/static/d39f6e5180d85cb9954685ab0bb833c0/f21e7/1.png 360w,\n/static/d39f6e5180d85cb9954685ab0bb833c0/37523/1.png 720w,\n/static/d39f6e5180d85cb9954685ab0bb833c0/79e48/1.png 865w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ELF 파일 모든 심볼 출력</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">objdump <span class=\"token operator\">-</span>tT <span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>binary<span class=\"token operator\">></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABhUlEQVQY003P6W6bQAAEYL9GJSc2GHZh2YNlua/E1M5REhtwMIcNco627/8GTZxIqTR/P83MhAiPCY/ZPncj4SciiO0gYcLTqaVTC5m2wR3CHYAoxKZGOGJCBsblAs4UbeKEqeVFmDuIWpBww7Q1wueqriIKEF1oeCqDqaTOFE2GH2YqqRcy+MJFc+hPr2XdEu4oOvXjLEwyESTrfJuXdbnvLC8CBpUAcsLUja6I5QKDAYPNVX2yfera8VQ1vfAiiPnV6t6Plpi7D1VdNn1zHO0gBgaToBEkGRW+iphGOMRnXLWHw/Nb3Q+2H0Fire4egzTDlrs/nsa3v934DBD9cSmriN3lRZBmH0ck9Wv2tu7a4bM5hNj00yz5eWOH6a4bdu0h31bwvFDRqRtfO2EqQ2OmaJ+Z7LpheP2z70fhRzoT4fVqefPr9rE4vvzOi8oOYhkamDsAM3x+eyGDb3z7UGx2zf2mZLYHsSn8KF6u1/lm89TEyzUk5lzViOVCbC408n/tO/4Hg3Nnm7GJL7UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/b774a815ed9cc5e8867da923809af158/37523/2.png\"\n        srcset=\"/static/b774a815ed9cc5e8867da923809af158/e9ff0/2.png 180w,\n/static/b774a815ed9cc5e8867da923809af158/f21e7/2.png 360w,\n/static/b774a815ed9cc5e8867da923809af158/37523/2.png 720w,\n/static/b774a815ed9cc5e8867da923809af158/b4098/2.png 816w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h2 id=\"strace\" style=\"position:relative;\"><a href=\"#strace\" aria-label=\"strace permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Strace</h2>\n<ul>\n<li>System Call Trace</li>\n<li>ptrace(2) 시스템 콜을 기반으로 하는 도구</li>\n<li>프로그램이 실행되는 동안 <code class=\"language-text\">syscall</code> 활동에 대한 정보와 수집되는 시그널을 보여주기 위해 루프 안에서 <code class=\"language-text\">PTRACE_SYSCALL</code> 요청을 사용한다.</li>\n<li>프로세스를 디버깅하거나 실행 중일 때 어떤 syscall이 호출되는지에 대해 정보 수집으로 유용하다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">strace <span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>ls <span class=\"token operator\">-</span>o ls<span class=\"token punctuation\">.</span>out\n\n<span class=\"token comment\">// 프로그램을 추적할 때 사용하는 명령어</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">strace <span class=\"token operator\">-</span>p <span class=\"token operator\">&lt;</span>PID<span class=\"token operator\">></span> <span class=\"token operator\">-</span>o daemon<span class=\"token punctuation\">.</span>out\n\n<span class=\"token comment\">// 프로세스에 attach에 사용하는 명령어</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">SYS_read</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 첫 출력으로 입력값으로 파일 디스크립터를 받는 각 시스템 콜의 파일 디스크립터를 보여준다.</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">strace <span class=\"token operator\">-</span>e read<span class=\"token operator\">=</span><span class=\"token number\">3</span> <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test\n\n<span class=\"token comment\">// 기록한 데이터를 확인할려면 -e write=fd 를 사용한다.</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQoz23Q2U7DMBAF0P4Ii9rSpDiL45jEjbN4ife4CYL//xZUeAFUaTRvR/fO7KQJDZ1y1DR0KjEp6xZUeJR2mm2SwTSvbrtAr0X9/HJ+Oqa/Z8eVH4SmXAmzMOV7rhCho9SD0PgyVC0tMYH4UpN+n4DHQ/IHi1vySAZOp7nnivRs/GbnAsG3S1G3xzR/2N/M4yH5j5ly02x7rthsB67pJGtCuQnaX4UJlKm2ZxBfUNOleXVIs99+J01gynIdmHLKx9nFSTkXNxvfpQ0tZRCTEyjPBTqB8l/znVk2Ha562YTxZlmFDR2bbVzd+iGMr5oOQFy1XQbxndo6rMJ46SLXTocr177n2sXNxE1oh1qa5hWA+ATKO9/WYWXKMu1/krlyZJQ/tYXxqO1Or2UCyiSDd7BZNmmD+b7Qxm12C1Muvn/67VP7JUfNPgHHNLuLvwDG3nKtA4tpEQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/1e863b807cf2b8caf4e8edb180a1c581/37523/3.png\"\n        srcset=\"/static/1e863b807cf2b8caf4e8edb180a1c581/e9ff0/3.png 180w,\n/static/1e863b807cf2b8caf4e8edb180a1c581/f21e7/3.png 360w,\n/static/1e863b807cf2b8caf4e8edb180a1c581/37523/3.png 720w,\n/static/1e863b807cf2b8caf4e8edb180a1c581/9c177/3.png 880w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h2 id=\"ltrace\" style=\"position:relative;\"><a href=\"#ltrace\" aria-label=\"ltrace permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ltrace</h2>\n<ul>\n<li>\n<p>라이브러리 트레이스</p>\n</li>\n<li>\n<p>strace와 유사하다.</p>\n</li>\n<li>\n<p>프로그램의 공유 라이브러리 링킹 정보를 파싱하고 사용되는 라이브러리 함수를 출력한다.</p>\n</li>\n<li>\n<p>시스템 콜 외에 라이브러리 함수 호출도 확인하고자 할시 <code class=\"language-text\">-S</code> 플래그를 사용한다.</p>\n</li>\n<li>\n<p>실행 파일의 동적 세그먼트를 파싱하고 실제 공유 라이브러리와 정적 라이브러리의 심볼 및 함수를 출력해 더 자세히 정보를 출력한다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">ltrace <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test <span class=\"token operator\">-</span>o test<span class=\"token punctuation\">.</span>out</code></pre></div>\n<hr>\n<h2 id=\"readelf\" style=\"position:relative;\"><a href=\"#readelf\" aria-label=\"readelf permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>readelf</h2>\n<ul>\n<li>ELF 바이너리를 분석하는데 가장 유용한 도구이다.</li>\n<li>ELF에 관한 각 데이터 비트에서 객체에 대한 정보를 추출해준다.</li>\n<li>심볼, 세그먼트, 섹션, 엔트리, 데이터 동적 링킹 등의 정보를 얻기 위해 자주 사용된다.</li>\n</ul>\n<h3 id=\"섹션-헤더-테이블-추출\" style=\"position:relative;\"><a href=\"#%EC%84%B9%EC%85%98-%ED%97%A4%EB%8D%94-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%B6%94%EC%B6%9C\" aria-label=\"섹션 헤더 테이블 추출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>섹션 헤더 테이블 추출</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">readelf <span class=\"token operator\">-</span>S <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVQoz33S2W6CQBQGYJ/D1Fp3UBREhBmYfQXcK9ba9P2fo6FtTNqUJuf2y3+2FiSSSouFSalE3ADMEdcA8xgxxPUKoJm/chfhLIic+dKdh92hc69WsE4hla4ftruDoTufeH67Oxg4nh/B3sjtDp3Zcv00ch96o05/3OmPf+DRdJFSuU7x1A8BFuX+ebGKI4hVsdPlnkirN4cIol/sGw8dj+liX12ZyiERh/OVqhwQnjJFpE0ymlK5COPHP/HAmXNTnl7etqeK6kKXO0glJILpnJkiQQwJ40egIdmt8f58BZgDIqvbO1U2wQxLQ5UF9dpMsIaNWOTbzbECiEEqD+drxlWCGJaWKhtnBHEd/Ju8OVSv3BQpUafL7etUpMY5wPXB/FXSnGw3x8tNl7uM1RgLc8d1C8Is44a2J17ATLk9XZKMJlioYlt/SEaJtOQzGYvGmT8ARvh7UE5/nCUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/4c8c3c1b8dfaa3f611b8dfc07d952bc3/37523/4.png\"\n        srcset=\"/static/4c8c3c1b8dfaa3f611b8dfc07d952bc3/e9ff0/4.png 180w,\n/static/4c8c3c1b8dfaa3f611b8dfc07d952bc3/f21e7/4.png 360w,\n/static/4c8c3c1b8dfaa3f611b8dfc07d952bc3/37523/4.png 720w,\n/static/4c8c3c1b8dfaa3f611b8dfc07d952bc3/65654/4.png 872w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"프로그램-헤더-테이블-추출\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%ED%97%A4%EB%8D%94-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%B6%94%EC%B6%9C\" aria-label=\"프로그램 헤더 테이블 추출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프로그램 헤더 테이블 추출</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">readelf <span class=\"token operator\">-</span>l <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVQoz22Q2ZKaUBRF/Y1OqtUwgwIyiRfkXpkREESJgOCEMfn/P0hZ/dTdVp3HvWqtOgPNRLq1AtC1g1gzkAqgsrCm0pyezkiOH5PMiGDGJDsm2RHBfLmBrC8VYD0Z3WR4iWAFaiIyvERPZzgz+Ri9Y9Q7Rr2ARRXIcwOjOEk3AXRIjqemoh3Esm4SLC+oCzdKF5Y9manf5QOGlwRFfxviBnJP93/t9Z5s99tD094ezfnmhAl0gpW/npsIo7kh/hkmOUFdWIKsL52gqNq8rKNNESRZUR2z/cEJU+SFyFvPNPCL4r6aWV6eStrPEWEgt+v/Hq99ui2L309zfbr6cYa86NBdwjR7kc2JigqWP0Y4gE57/dOcbnG2y8u6udyr9uxFG9tfR5tiaXsvzJwgi4pOsLyB3OP13pxvcb7Ly6q59FV3scPEsn3LDTUDYvRkiNOfswVlbiJWkI3V82Gn/pGXdXFouv5x6h9BkkM3cKMUQOcFzPCSBiycnmgGLI/nfX0MkizOd7umK6pm5UcGcqEbaMDCvmX/B87Og46rcFedAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/456bae8f2661f8603742d5892327e192/37523/5.png\"\n        srcset=\"/static/456bae8f2661f8603742d5892327e192/e9ff0/5.png 180w,\n/static/456bae8f2661f8603742d5892327e192/f21e7/5.png 360w,\n/static/456bae8f2661f8603742d5892327e192/37523/5.png 720w,\n/static/456bae8f2661f8603742d5892327e192/8bd7c/5.png 845w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"심볼-테이블-추출\" style=\"position:relative;\"><a href=\"#%EC%8B%AC%EB%B3%BC-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%B6%94%EC%B6%9C\" aria-label=\"심볼 테이블 추출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>심볼 테이블 추출</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">readelf <span class=\"token operator\">-</span>s <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaUlEQVQoz3XO626CMACGYS9k8zARCrVAC6W0nA8iiHhA4pw657L7v4fFbMm2ZCbf3yff25tih4oQO8KgXLcYYZ5JOWEewg5AGCA8xVSGxpMCJRVNNF1S0UACX+spyHSDZL7crHb7KCtsHibFwk9mIszcICGO4GEKDVsCUwmgkaz1x8oPfhhNEGGr7rl7OdfrVoamF2W2CIO0SMvG9WMeZlFeenHO/JgwT0UEIPyNEbll2zxwg8Sk3OIBFSHzE50wGRoyNBBxZGiMFDiQwO/bGx7Jms3D9vm4P1/yaqlbLCuXedkEaZFXK8p9k/Lh39of3B8rmHn70+V4/ag3LUAkKRb1eufFedm02OFPCvxX3vBgrBDmdy+vh8t71Ww1w06Lulq1XpzPl1tM3Ymm38cSoCLan95O149m22nmDS/WnR/PymZnMSFD8y4eTlTXj3eH0+H1WjYbVbeSYlE1rYiyot5YTGg6ebyDPwGBGG6FZygv0AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/c3d0958f1b277d29c0668108e0cfebab/37523/6.png\"\n        srcset=\"/static/c3d0958f1b277d29c0668108e0cfebab/e9ff0/6.png 180w,\n/static/c3d0958f1b277d29c0668108e0cfebab/f21e7/6.png 360w,\n/static/c3d0958f1b277d29c0668108e0cfebab/37523/6.png 720w,\n/static/c3d0958f1b277d29c0668108e0cfebab/b2cef/6.png 847w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"elf-파일-헤더-데이터-추출\" style=\"position:relative;\"><a href=\"#elf-%ED%8C%8C%EC%9D%BC-%ED%97%A4%EB%8D%94-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B6%94%EC%B6%9C\" aria-label=\"elf 파일 헤더 데이터 추출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ELF 파일 헤더 데이터 추출</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">readelf <span class=\"token operator\">-</span>e <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQoz32Q63KCMBBGfZCiEiQSAgQSAkkgiRAv1DJ1eplp3/9JOtZOa6t25vu1u2fO7k6M26GM4rzEOU8oxznPuaCiyViNCcu5jJLcA3C2iC4zUcZ5APow/g5Y4rbbmH5LRRvnZcZqwsQCpdNg+Rfe7Q+YsFmIfqphLHSvrJOmh5iAJfbPu+fwdn9AaeEB6AE4DY7r+RCvNgMTrbLrUulStqS8Ye62D3XbSeOqxkZp8TmB3DCefhETBjHxYTy/Jp+0K1fUTSl1rTsmmimAcxjb9SB0x6RmUme0unR+wXY9VI017l4Zh45mOA+RdYOyboHSOz+8RR7h/eGl342Pr+/j89swPvkwDqJE6I7WzdU7f8FMtITLolJFpWjdJAVPC44y+j92gj8AMnZe7WCPfBYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/e7397001d8b919dabedb924f41abbcbb/37523/7.png\"\n        srcset=\"/static/e7397001d8b919dabedb924f41abbcbb/e9ff0/7.png 180w,\n/static/e7397001d8b919dabedb924f41abbcbb/f21e7/7.png 360w,\n/static/e7397001d8b919dabedb924f41abbcbb/37523/7.png 720w,\n/static/e7397001d8b919dabedb924f41abbcbb/e619b/7.png 787w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"재배치-엔트리-추출\" style=\"position:relative;\"><a href=\"#%EC%9E%AC%EB%B0%B0%EC%B9%98-%EC%97%94%ED%8A%B8%EB%A6%AC-%EC%B6%94%EC%B6%9C\" aria-label=\"재배치 엔트리 추출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>재배치 엔트리 추출</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">readelf <span class=\"token operator\">-</span>r <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0ElEQVQI10XL206DMACA4b2I2yKb41Dogbb0sLbQFgZCmHFqZuL7P4fZjSb/xX/zbSoqclgXiBaI5ohmFYZUAMxK0iCmYP34ArEkLZIUHLJyd0j/2oRxwVzqtu+GqZaGSmPDpdGuOXfDfO1fV2W9MJ5rh7lGVOyP2T8WxgNEMVdM2ZJwQLgwHlKBudJtlNaTRgvjEZMA8xzW2+T09PyyTU4PfP341i6M6/t6+1Iuujj5cT53sR3mt8/77f4zLKtyIU6LbnsbLlSavKozSPbH9BdGpDN0kjvtZwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/636af318ee133c32471765268f6dac61/37523/8.png\"\n        srcset=\"/static/636af318ee133c32471765268f6dac61/e9ff0/8.png 180w,\n/static/636af318ee133c32471765268f6dac61/f21e7/8.png 360w,\n/static/636af318ee133c32471765268f6dac61/37523/8.png 720w,\n/static/636af318ee133c32471765268f6dac61/d2a60/8.png 807w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"동적-세그먼트-추출\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%A0%81-%EC%84%B8%EA%B7%B8%EB%A8%BC%ED%8A%B8-%EC%B6%94%EC%B6%9C\" aria-label=\"동적 세그먼트 추출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>동적 세그먼트 추출</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">readelf <span class=\"token operator\">-</span>d <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>test</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABd0lEQVQoz4XQ61KqUBiH8S7EktPifFIULDVBF3JYxEFAIUChaDft+7+APbupaaayZt6vv3n/81yM9BtBnY6NuahOZM2Qxro01gV1ohkLfb4CvIQBDqd5DHBDiv10F2lRoyTbHSoTuqbtkayEAZ4WFC9KbT+UtRmnaOJoSgvKkGQ+4+z+WDRtVjbQQRsnmFwvCZrHGQHF2WxpDnAwpNirL+wNn55e2j8vVddDFwXJvmxaaTTFaD5MD2sHXZHMt4Pf8K6od/vSj1PTdv0o0+crjGIJRgySfGnB18/ncdX29cNT1T5uURTnJSMoAxyQnLRFsQndc+wdd33d9eXpwQ3iIMlFVRvgAPAK9MKFCX/BSVGlZRXnpWV70A/V6WyAA4qT1w4aG/NzqT6Cdc9/T/0zitIgzmle/j+blaKs2LwG+wnn1TEray9KLccP0+L61rokaIIRrK1/u3F+mX1ourxqbHS3doK7ZG8sVkOKJVlxBR1ZMy4J+gf8Dx5CheQ1pfoiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/119eaf9636fd32b0a3f51ddc2f10f64b/37523/9.png\"\n        srcset=\"/static/119eaf9636fd32b0a3f51ddc2f10f64b/e9ff0/9.png 180w,\n/static/119eaf9636fd32b0a3f51ddc2f10f64b/f21e7/9.png 360w,\n/static/119eaf9636fd32b0a3f51ddc2f10f64b/37523/9.png 720w,\n/static/119eaf9636fd32b0a3f51ddc2f10f64b/cc8d6/9.png 791w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#objdump\">Objdump</a></p>\n<ul>\n<li><a href=\"#%EC%98%88%EC%A0%9C-%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC\">예제 바이너리</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#strace\">Strace</a></p>\n</li>\n<li>\n<p><a href=\"#ltrace\">ltrace</a></p>\n</li>\n<li>\n<p><a href=\"#readelf\">readelf</a></p>\n<ul>\n<li><a href=\"#%EC%84%B9%EC%85%98-%ED%97%A4%EB%8D%94-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%B6%94%EC%B6%9C\">섹션 헤더 테이블 추출</a></li>\n<li><a href=\"#%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%ED%97%A4%EB%8D%94-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%B6%94%EC%B6%9C\">프로그램 헤더 테이블 추출</a></li>\n<li><a href=\"#%EC%8B%AC%EB%B3%BC-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%B6%94%EC%B6%9C\">심볼 테이블 추출</a></li>\n<li><a href=\"#elf-%ED%8C%8C%EC%9D%BC-%ED%97%A4%EB%8D%94-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B6%94%EC%B6%9C\">ELF 파일 헤더 데이터 추출</a></li>\n<li><a href=\"#%EC%9E%AC%EB%B0%B0%EC%B9%98-%EC%97%94%ED%8A%B8%EB%A6%AC-%EC%B6%94%EC%B6%9C\">재배치 엔트리 추출</a></li>\n<li><a href=\"#%EB%8F%99%EC%A0%81-%EC%84%B8%EA%B7%B8%EB%A8%BC%ED%8A%B8-%EC%B6%94%EC%B6%9C\">동적 세그먼트 추출</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"August 16, 2020","title":"ELF 분석 도구","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🗂"},"fields":{"slug":"/elf_device_file5/"}},"site":{"siteMetadata":{"siteUrl":"https://dnsdudrla97.github.io","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/elf_device_file4/","nextSlug":"/codegate2017_angrybird_ctf_writeup/","prevSlug":"/elf_device_file5/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}