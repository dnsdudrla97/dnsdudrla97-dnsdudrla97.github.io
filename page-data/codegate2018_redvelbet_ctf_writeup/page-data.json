{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/codegate2018_redvelbet_ctf_writeup/",
    "result": {"data":{"cur":{"id":"63ac0101-7bca-525d-8b12-a5fa8beb3168","html":"<h2 id=\"바이너리-정보\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\" aria-label=\"바이너리 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 정보</h2>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">RedVelvet<span class=\"token operator\">:</span>\nELF <span class=\"token number\">64</span><span class=\"token operator\">-</span>bit LSB executable\nx86<span class=\"token operator\">-</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> version <span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>SYSV<span class=\"token punctuation\">)</span>\ndynamically linked\ninterpreter <span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> GNU<span class=\"token operator\">/</span>Linux <span class=\"token number\">2.6</span><span class=\"token number\">.32</span>\nBuildID<span class=\"token punctuation\">[</span>sha1<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">84e7</span>ef91c33878cf9eefc00a7a450895aa573494\nnot stripped</code></pre></div>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><strong>Undefined (U) → Create String (a) → WOW String</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 677px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAk0lEQVQI12XLPQ7CMAxA4R6EFYlbsSOuxwUoahWo+BlYWRBChcpp08Y4cVwjBgbEN7ztZet8kW+W290cwCAqUWQWxBjjpymJqo4jMSPzK4RBhPUrM2ZqzOx4mli7GgYlCkTJuYA+3R5QN67vA4BtW8uMIbifuSj2ZXmoqjNApyoi3La+aXoL/nK9188OPSMykeifNzKJpfShfZMoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/faeddf00b84fc7dca712f378372376f7/68de2/0.png\"\n        srcset=\"/static/faeddf00b84fc7dca712f378372376f7/e9ff0/0.png 180w,\n/static/faeddf00b84fc7dca712f378372376f7/f21e7/0.png 360w,\n/static/faeddf00b84fc7dca712f378372376f7/68de2/0.png 677w\"\n        sizes=\"(max-width: 677px) 100vw, 677px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhUlEQVQI14WNywrCMBRE8/+/pAuXhe51obRQk0Ib2hRt87jNzYgRrAjiWcxm5jBCyqJty2E4r2sMIQC4z/7mLTMjQwTn4P0zc78hqmpf1wetTwBSSgAaZRrTEdFrwYwYt/ySd1k+fsrXqecY8Q8hZaFUOY6XEMh5Z63ttOmnYZmX9/kv+QHQHOdpCniqfgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/1b63c78186fe3af5a3a58b64a49a8b83/37523/1.png\"\n        srcset=\"/static/1b63c78186fe3af5a3a58b64a49a8b83/e9ff0/1.png 180w,\n/static/1b63c78186fe3af5a3a58b64a49a8b83/f21e7/1.png 360w,\n/static/1b63c78186fe3af5a3a58b64a49a8b83/37523/1.png 720w,\n/static/1b63c78186fe3af5a3a58b64a49a8b83/a0209/1.png 725w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoUlEQVQI123OTQrCMBQEYK/lxuN15W1cegk33RQLrZgWkrT5bZKXviRSBMXiLGYx8MEc2vu5rk9Nc2TsyjlqrTlXyikdNMSIGWMsMRaArXc5jOOl7ytCKsZvlC5CzFKZ2Qi9aEQs5SsBSs6/eBjmrhOEGEotY9J7Z22Y3GSiAQTptfP4liH8wc+uawl5SOmF2CZrc4CUS0oprbgC5M/zHX4BmpvjnK9aozAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/3875077881d61228c2c87cc812fae820/37523/2.png\"\n        srcset=\"/static/3875077881d61228c2c87cc812fae820/e9ff0/2.png 180w,\n/static/3875077881d61228c2c87cc812fae820/f21e7/2.png 360w,\n/static/3875077881d61228c2c87cc812fae820/37523/2.png 720w,\n/static/3875077881d61228c2c87cc812fae820/5b481/2.png 846w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 478px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIElEQVQoz4XQf2+DIBAG4H7/77bYaRWtKKCgAtb+UrSIsliXdEtcd39e7sndvbswZMNglNJ5fqWnCnIMSxLLBEp8V8paO9vZ/q55XjpCiJ2zJ0qNt9sAgEQVAwX0UOIXx4STW9s/sf0THwLa96YfRpSe0xMCdYBlkYmqVtLM48/pDewd8r5fzk6TM6xTt/KOJY5LzK7sYbTdqhfeu5lSY6c0jBvcZL4IVlzcC/3Expiu67axH3wHhtEFNwRIkPCMSFbdq3Ea19Fpmrbxh4O7Viulo7COROxyN2RpSF+b353tB3RYAtMYX9AJBzJIOUWc8Vasm99h5/P5c7f8HMnYKR3AkqhA+TV/mMc/2PPpmjaEZ9LkQIRpSYkoRSvMZN7jL1HkOB7QlsvBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/b679d76c21d0e89b6e9e9ce20bf37084/50978/3.png\"\n        srcset=\"/static/b679d76c21d0e89b6e9e9ce20bf37084/e9ff0/3.png 180w,\n/static/b679d76c21d0e89b6e9e9ce20bf37084/f21e7/3.png 360w,\n/static/b679d76c21d0e89b6e9e9ce20bf37084/50978/3.png 478w\"\n        sizes=\"(max-width: 478px) 100vw, 478px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token number\">0</span>a435f46288bb5a764d13fca6c901d3750cee73fd7689ce79ef6dc0ff8f380e5</code></pre></div>\n<ul>\n<li>\n<p>인코딩되어진 값을 확인할 수 있다.</p>\n</li>\n<li>\n<p>사용자 입력을 27바이트를 받으며</p>\n</li>\n<li>\n<p><code class=\"language-text\">func1</code> ~ <code class=\"language-text\">func9</code> 까지 함수 호출 과정이 끝나고 <code class=\"language-text\">_ptrace</code> 를 호출하는 것을 확인할 수 있다.</p>\n<p><a href=\"https://www.notion.so/ptrace-Anti-Debugging-aed6d7a2c7f748e69f7144e86b7fe3f5\">ptrace Anti-Debugging</a></p>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 665px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB50lEQVQoz33Sy27bMBQEUP7/b3VRoGmRNmmMIE6st0hLfIminiTvFHaAruwQwx0PLji4LBIIKCvFue/7qa4cV6r3KiXCrbMsi9QGQEjEAiFdsRC+733TOuv9tM10215wrw0BeyK2EwJQNdq57Xye69rfm/kfd9okYEvEVsIGFLUehqVtt7y2cpLKjvue7mGhTQCWRGyJF/yeybZxnLss143qeqdivPtnrswOzJHYnLACH7ksy0GIsSrG3li7mC8K48pswBSJTQkLcCqUkvP5PBa5Xbc9pPBFYa0yK+AjMR8xJeSNGd0mxFY3PqQ9RiK6O7mRZgHGQMxFjISs1n7chZi4VuM2uHEN4XZh87JU0kzAEIgNEe6KlzmI82C9+3wUAvZwG5fSeMAGYjZiIJxq48e962Y5eOCyc27ENN3GhTQjYAIxEzAkvJ462Q15bp9eq2OdndpSDM00O4RAYd3WddvCfr12GLJOO4LeiakAHVFpnwn5UpQvZfV4zJ+z8ij4B+cPP//8+P5cvh0rIbKW19IUneJ+1REqgMkAGaATFNE5bCPgAXeNSuHbw+HpuSrr/vBaHJvOAprIElS8hPU7PsOXcFT6ILvf+bE9VWWn2t5yaSsuDg3/lZd/m/Zd63elH3mRW18Oyz8u+Vx3zZnabQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/e0141e58211928db05c22d72b8e75d8e/5f4af/4.png\"\n        srcset=\"/static/e0141e58211928db05c22d72b8e75d8e/e9ff0/4.png 180w,\n/static/e0141e58211928db05c22d72b8e75d8e/f21e7/4.png 360w,\n/static/e0141e58211928db05c22d72b8e75d8e/5f4af/4.png 665w\"\n        sizes=\"(max-width: 665px) 100vw, 665px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 387px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVQY042PyQ6DIBRF/f9v664xDsUhDRRFcGgFRd6DRru28exP7rlRknTOobVQFiNTYgETQvDBhwtEcSx+MsmHpu8t2nCZKE0lgN+XyUgV124+lhHQq94/iKcsIJ7KndYbIhIy1/Rtlu2QD3z4n79nK7X/LIgtn7qSfLCyM0IY0c5t8+ErrKdylklrAQDzTLJGFfSV1/x2ryrWzttnWieH7kz+AoWIW/Ppti/vAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/d0940ad9a32e6a72ec589acf08e86728/691c3/5.png\"\n        srcset=\"/static/d0940ad9a32e6a72ec589acf08e86728/e9ff0/5.png 180w,\n/static/d0940ad9a32e6a72ec589acf08e86728/f21e7/5.png 360w,\n/static/d0940ad9a32e6a72ec589acf08e86728/691c3/5.png 387w\"\n        sizes=\"(max-width: 387px) 100vw, 387px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">_ptrace</code> 함수는 인자 <code class=\"language-text\">edi:0, esi:0, edx:1, ecx:0</code> 을 받으며 호출되며 반환 되는 값이 <code class=\"language-text\">0xFFFFFFFFFFFFFFFF</code> 값 즉, <code class=\"language-text\">-1</code> 과 비교되어 0 이 아니게 되면 정상 루틴이 아닌 다른 루틴으로 빠지는 것을 확인할 수 있었다.</li>\n<li><code class=\"language-text\">Ptrace</code> 의 <code class=\"language-text\">PTRACE_TRACEME</code> 옵션은 자기 자신에게 디버거를 붙이라는 의미로서 해당 코드에서는 <code class=\"language-text\">ptrace</code>의 결과가 -1인지 검사하고 참이라면 유효하지 않은 코드 영역으로 점프를 하게 된다. 즉 안티 디버깅을 하기 위해 <code class=\"language-text\">자기 자신이 디버깅 당하는 중인지 검사</code> 하는 것이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 667px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhUlEQVQoz0XS2WrDMBCFYb//G5YsdVInihftI1n7KS6ihv/mG0YXAxpKbQCkostl49yP35LNWuzixViMqQG1nTXAeZTaOaR6jLikeTbO5cdoyCYAnAsXYgFyOyuA9Ui1c4j1GHHlGNNE9XqnxXLt6GeaXUwZSO0sA8Yj1s4h1GO0KTeOQqnwfMpp5gttj+ntUkpAbGcJ0B6hdg57OUabctcrl3KfJrOspKN6fRiFFNux+l9s0A576Rx8aRGYBV2umxB+HOW6kS/+sywmpNCw17PQoBx86RyotAAwTu+3Jlu+vrSlAGDdhNqjb3D1zDcIByqdg83N/z3+/uZaxctVjcubyXV8MBWSq8fqf66CE2zuHEyGa/hId78fNz+fal6tifrFPnJPVGHLGVVsBJM7B51BDUy6240rFabJzKsVQfwwJvZkK0w5sxUrQefOQWVY4CVoemlj4vMpjfm7mfPNR1Ohy5mpWAgqdw4yQVdMon+S2zU4f/ywjYvFRVUg85kq+FiI1PkLGDOzhrmB0BkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/5f3a1f5e329fbbe501b40bbde93e4e0c/295bd/6.png\"\n        srcset=\"/static/5f3a1f5e329fbbe501b40bbde93e4e0c/e9ff0/6.png 180w,\n/static/5f3a1f5e329fbbe501b40bbde93e4e0c/f21e7/6.png 360w,\n/static/5f3a1f5e329fbbe501b40bbde93e4e0c/295bd/6.png 667w\"\n        sizes=\"(max-width: 667px) 100vw, 667px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>안티 디버깅 검사를 마친 후에 다시 <code class=\"language-text\">func10</code> ~ <code class=\"language-text\">func15</code> 까지 함수를 이용하여 입력값 검증을 시도한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSElEQVQoz12L647bIBBGef8X659KVRNtNtm1ExMT1hg7DBdjgzFTpa2KVelodKTvDJk2LGRkHKwJt5vvh/A0SmrrEfeN8sWJ27CQ8c6VMbFpZm2jMlqAnRD3zdMXJyZhYcM7B+dC2xqp9OPJOmVtxn0zTMWJTlh4PStrAqVOjhGMFtqajPtGTsWJSljYkHIwemkaSxnQvu20g4z7RkzFyXPFQkL6AGdjQ73Sq599p51Kv6eYxzWPK3ZT6cmw4l9iHhNWrWRMHk/s8EE/6paBkyv24TWpjDIiM68r4+uF/LF/dPPGffzy26mFb4f7J/f1Y+50ON7k97Ogcqn5wnXgsDRjICLinn5FEfOQ8SrhfOYAc1znlOKP4/vx7XpnX5S1QshxkCfaky7i/4QsEtbSUtZfPh8/L9Xhcn1vGdWuHqAaoB50JaEal1+ZOzg0ycUB/AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/16658b5d7a80ee4b004529b03a51166d/37523/7.png\"\n        srcset=\"/static/16658b5d7a80ee4b004529b03a51166d/e9ff0/7.png 180w,\n/static/16658b5d7a80ee4b004529b03a51166d/f21e7/7.png 360w,\n/static/16658b5d7a80ee4b004529b03a51166d/37523/7.png 720w,\n/static/16658b5d7a80ee4b004529b03a51166d/64d87/7.png 818w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">func15</code> 함수의 반환 값을 인자로 삼아 <code class=\"language-text\">_SHA256_Init</code> 함수가 호출되는 것을 확인할 수 있으며,  <code class=\"language-text\">strlen</code> 함수를 바탕으로 rax레지스터 즉, 검증 함수를 거치고 나온 후 해당 값의 길이 값을 반환한후 <code class=\"language-text\">rdx</code> 레지스터에 넣는 것을 확인할 수 있다.</li>\n<li><code class=\"language-text\">_SHA256_Update</code> 함수에서 <code class=\"language-text\">입력 값의 길이 값, 해시 값으로 초기화된 값</code> 을 인자로 하여 업데이트를 한다.</li>\n<li><code class=\"language-text\">OpenSSL API 모듈 SHA256_Init()</code> , <code class=\"language-text\">SHA256_Update()</code> , <code class=\"language-text\">SHA256_Final()</code> 함수는 핵심 기능이다. 할당 <code class=\"language-text\">SHA256_CTX</code> 을 그것을 초기화 <code class=\"language-text\">SHA256_Init()</code> 와 데이터를 통해 실행, <code class=\"language-text\">SHA256_Update()</code> 그리고 마지막으로 사용하여 결과 추출 <code class=\"language-text\">SHA256_Final()</code> 하게 된다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB30lEQVQoz13SyXLbMBAEUP7/r+XiJI7KLi0RSVEEsRAgiAEw2CalONFBVe/Qt+5Dd6XRi0oPjehy5ff7BgF89KdL3/fLxNjMF601WxTm1qVGLxwmwJwAxKL4zD8v46/T73kV2lvrw+YDYLK+YqUuVnrCRpDS23s/3IxgwmjjnJsW9f4xOR9ccCkl8N4hOiSfqfOVnkIji0VI0GuaGJRaxQqLAinA2mR22NEhovZhQ3KZOlfoCSptWIdJjaO+XKSQhmsziZ1zN887k8bGHRFXH0wkm6jbCr3QqWofmbEccCvtJpwUMI7bujkiwpSkDyqSTtTpTOtf+ktqupDGyn14hEqjcHoN82x2iwkbgGcu8EAKqZOZdCNVSGaS5T8sM3jdyBANj2Z/HcVqdYwZwDEILBJH6hZsR76NNkrMwkUuDbfAtb3b/bDI82rPQp5nfmHqc1a9gl7CbS+TowWpGyH/OAyM7YwZvkrvIGHMiBbg2/fjNOqSE7UaoAzasUos04zEkFiiboDKVeDcCiUQW8q51NJqtT4cR35b7CTs6h5brtrdE90j3fGf7gqFiV0rPy3MAlB7HJOIXMTTFm5IQ2xfbkgvuj60Izcfk/w5iLfjeJj4WZoT10dhrr6MSE9DfPUHadXjVeTo6o8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/f95434dfc5e5661a90d340bae19c7b08/37523/8.png\"\n        srcset=\"/static/f95434dfc5e5661a90d340bae19c7b08/e9ff0/8.png 180w,\n/static/f95434dfc5e5661a90d340bae19c7b08/f21e7/8.png 360w,\n/static/f95434dfc5e5661a90d340bae19c7b08/37523/8.png 720w,\n/static/f95434dfc5e5661a90d340bae19c7b08/302a4/8.png 1080w,\n/static/f95434dfc5e5661a90d340bae19c7b08/0940f/8.png 1154w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"solved-code-with-z3\" style=\"position:relative;\"><a href=\"#solved-code-with-z3\" aria-label=\"solved code with z3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>solved code (with z3)</h1>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># This Python file uses the following encoding: utf-8</span>\n<span class=\"token keyword\">from</span> z3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\n<span class=\"token comment\"># x = Solver()</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">func1</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>z <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> z <span class=\"token operator\">==</span> <span class=\"token number\">10858</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">></span> <span class=\"token number\">85</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">&lt;=</span> <span class=\"token number\">95</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">></span> <span class=\"token number\">96</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">&lt;=</span> <span class=\"token number\">111</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func2</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y <span class=\"token operator\">%</span> z <span class=\"token operator\">==</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">></span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func3</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">/</span>z<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">&lt;=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">&lt;=</span> <span class=\"token number\">119</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func4</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>y <span class=\"token operator\">%</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> y <span class=\"token operator\">==</span> <span class=\"token number\">137</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">></span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">&lt;=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func5</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z <span class=\"token operator\">+</span> y<span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>y <span class=\"token operator\">^</span> z <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">225</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">></span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">&lt;=</span> <span class=\"token number\">89</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func6</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">&lt;=</span>z1<span class=\"token punctuation\">,</span> z1 <span class=\"token operator\">&lt;=</span> z2<span class=\"token punctuation\">,</span> y<span class=\"token operator\">></span><span class=\"token number\">85</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">></span><span class=\"token number\">110</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">></span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>y<span class=\"token operator\">+</span>z1<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">161</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func7</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">>=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> y<span class=\"token operator\">&lt;=</span><span class=\"token number\">119</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">></span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">89</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">122</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>z1<span class=\"token operator\">+</span>z2 <span class=\"token operator\">==</span> <span class=\"token number\">101</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func8</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">&lt;=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span>z2<span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z1<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>z2<span class=\"token operator\">*</span>z1 <span class=\"token operator\">==</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>z2<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>y<span class=\"token operator\">-</span>z1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>z1 <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">10088</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">114</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func9</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">==</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">+</span>y<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>z2<span class=\"token operator\">-</span>z1<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>y <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1443</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func10</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">>=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z2<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>z2 <span class=\"token operator\">==</span> <span class=\"token number\">15514</span><span class=\"token punctuation\">,</span> z1 <span class=\"token operator\">></span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> z1 <span class=\"token operator\">&lt;=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func11</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>z1<span class=\"token operator\">>=</span>y<span class=\"token punctuation\">,</span> y<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">></span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span><span class=\"token number\">104</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">-</span>z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>z2 <span class=\"token operator\">==</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>y<span class=\"token operator\">+</span>y <span class=\"token operator\">==</span> <span class=\"token number\">68</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func12</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">>=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span><span class=\"token number\">59</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z2<span class=\"token operator\">+</span>z1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>z2 <span class=\"token operator\">==</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">-</span>z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>z1 <span class=\"token operator\">==</span> <span class=\"token number\">101</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func13</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">&lt;=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span>z2<span class=\"token punctuation\">,</span> y<span class=\"token operator\">></span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">></span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">109</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z2<span class=\"token operator\">+</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>y <span class=\"token operator\">==</span> <span class=\"token number\">269</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>z2<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">-</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>z1 <span class=\"token operator\">==</span> <span class=\"token number\">185</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func14</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">></span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>z2<span class=\"token operator\">==</span><span class=\"token number\">185</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func15</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>y<span class=\"token punctuation\">,</span> z2<span class=\"token operator\">></span><span class=\"token number\">95</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span><span class=\"token number\">109</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">-</span>y<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>z1<span class=\"token operator\">^</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>y<span class=\"token operator\">==</span><span class=\"token number\">1214</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z2<span class=\"token operator\">-</span>z1<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>z2<span class=\"token operator\">^</span>y<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>z1<span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1034</span><span class=\"token punctuation\">)</span>\n\narray <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>BitVec<span class=\"token punctuation\">(</span><span class=\"token string\">'f_%i'</span><span class=\"token operator\">%</span>i<span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\nx <span class=\"token operator\">=</span> Solver<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 실 제약조건을 추가하는 과정 func 들의 결과와 인풀의 범위를 아스키 코드로 고정</span>\nfunc1<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc2<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc3<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc4<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc5<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc6<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc7<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc8<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc9<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc10<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc11<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc12<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc13<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc14<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc15<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">24</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">25</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0x7e</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">assert</span> x<span class=\"token punctuation\">.</span>check<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> sat\n\ntest <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nstring_check <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\ntmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> z <span class=\"token keyword\">in</span> test<span class=\"token punctuation\">:</span>\n    string_check<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token string\">'f_'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> test<span class=\"token punctuation\">[</span>z<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> idx <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>string_check<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>string_check<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>as_long<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nisFlag<span class=\"token operator\">=</span><span class=\"token string\">''</span>\n<span class=\"token keyword\">for</span> cdx <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    isFlag<span class=\"token operator\">+=</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">[</span>cdx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> isFlag</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\">바이너리 정보</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n</ul>\n</div>","excerpt":"바이너리 정보 main 함수 분석 Undefined (U) → Create String (a) → WOW String     인코딩되어진 값을 확인할 수 있다. 사용자 입력을 27바이트를 받으며  ~  까지 함수 호출 과정이 끝나고  를 호출하는 것을 확인할 수 있다. ptrace Anti-Debugging    함수는 인자  을 받으며 호출되며 반환 되는 값이  값 즉,  과 비교되어 0 이 아니게 되면 정상 루틴이 아닌 다른 루틴으로 빠지는 것을 확인할 수 있었다.  의  옵션은 자기 자신에게 디버거를 붙이라는 의미로서 해당 코드에서는 의 결과가 -1인지 검사하고 참이라면 유효하지 않은 코드 영역으로 점프를 하게 된다. 즉 안티 디버깅을 하기 위해  하는 것이다.  안티 디버깅 검사를 마친 후에 다시  ~  까지 함수를 이용하여 입력값 검증을 시도한다.   함수의 반환 값을 인자로 삼아  함수가 호출되는 것을 확인할 수 있으며,   함수를 바탕으로 rax레지스터 즉, 검증 함수…","frontmatter":{"date":"August 14, 2020","title":"CodeGate2018 RedVelvet write-up","categories":"CTF","author":"Zer0Luck","emoji":"💸"},"fields":{"slug":"/codegate2018_redvelbet_ctf_writeup/"}},"next":{"id":"2dc19ec9-63a6-5f68-aff2-ea70f9c0a6e9","html":"<h2 id=\"프로젝트-선택\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A0%ED%83%9D\" aria-label=\"프로젝트 선택 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프로젝트 선택</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Angr을 이용해서 실행할 바이너리를 선택한다. (auto_load_libs=False -> unresolved)</span>\n<span class=\"token comment\"># 실행에 부하가 걸릴시 False로 둔다.</span>\np <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./Binary'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\np<span class=\"token punctuation\">.</span>arch  <span class=\"token operator\">-</span><span class=\"token operator\">></span>  아키텍처 출력\np<span class=\"token punctuation\">.</span>enrty <span class=\"token operator\">-</span><span class=\"token operator\">></span>  바이너리 진입점 \np<span class=\"token punctuation\">.</span>filename <span class=\"token operator\">-</span><span class=\"token operator\">></span> 바이너리 이름\n</code></pre></div>\n<h2 id=\"loader\" style=\"position:relative;\"><a href=\"#loader\" aria-label=\"loader permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>loader</h2>\n<ul>\n<li>이진 파일에서 가상 주소 공간에서 표현하는 것은 매우 복잡하다.</li>\n<li>이를 처리하기 위하여 CLE 모듈이 있다.</li>\n<li>로더라고 하는 CLE의 결과는 속성에서 사용할 수 있으며  프로그램과 함께 로드된 공유 라이버리를 보고 로드된 주소 공간에 대한 기본 쿼리를 숭행하는데 사용할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader\n<span class=\"token operator\">&lt;</span>Loaded RedVelvet<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0xa08000</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>shared_objects\nOrderedDict<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'RedVelvet'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>ELF Object RedVelvet<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60209f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'extern-address space'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>ExternObject Object cle<span class=\"token comment\">##externs, maps [0x800000:0x808000]>),</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'cle##tls'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>ELFTLSObjectV2 Object cle<span class=\"token comment\">##tls, maps [0x900000:0x915010]>)])</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>min_addr\n<span class=\"token number\">4194304</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>max_addr\n<span class=\"token number\">10518528</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object\n<span class=\"token operator\">&lt;</span>ELF Object RedVelvet<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60209f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object<span class=\"token punctuation\">.</span>execstack <span class=\"token comment\"># 실행 가능 스택 공간 여부</span>\n<span class=\"token boolean\">False</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object<span class=\"token punctuation\">.</span>pic <span class=\"token comment\"># 바이너리 위치가 독립적인지 여부</span>\n<span class=\"token boolean\">False</span>\n</code></pre></div>\n<h2 id=\"pfactory-생성자들\" style=\"position:relative;\"><a href=\"#pfactory-%EC%83%9D%EC%84%B1%EC%9E%90%EB%93%A4\" aria-label=\"pfactory 생성자들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>p.factory (생성자들)</h2>\n<ul>\n<li><code class=\"language-text\">angr</code> 에는 많은 클래스가 있으며 대부분 프로젝트를 인스턴스화해야 한다.</li>\n<li>모든 곳에서 프로젝트를 사용할 시 자주 사용하고 싶은 공통 객체에 대한 몇 가지 편리한 생성자를 제공한다. <code class=\"language-text\">project.factory</code></li>\n</ul>\n<h2 id=\"block\" style=\"position:relative;\"><a href=\"#block\" aria-label=\"block permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>block</h2>\n<ul>\n<li><code class=\"language-text\">poject.facotry.block()</code> 주어진 주소에서 기본 코드 블록을 추출하는데 사용된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> block <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>block<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 프로그램의 진입 점에서 코드 블록을 가져온다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block\n<span class=\"token operator\">&lt;</span>Block <span class=\"token keyword\">for</span> <span class=\"token number\">0x400890</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41</span> <span class=\"token builtin\">bytes</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block<span class=\"token punctuation\">.</span>pp<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 디스 어셈블리를 stdout에 깔끔하게 출력함</span>\n<span class=\"token number\">0x400890</span><span class=\"token punctuation\">:</span>       xor     ebp<span class=\"token punctuation\">,</span> ebp\n<span class=\"token number\">0x400892</span><span class=\"token punctuation\">:</span>       mov     r9<span class=\"token punctuation\">,</span> rdx\n<span class=\"token number\">0x400895</span><span class=\"token punctuation\">:</span>       pop     rsi\n<span class=\"token number\">0x400896</span><span class=\"token punctuation\">:</span>       mov     rdx<span class=\"token punctuation\">,</span> rsp\n<span class=\"token number\">0x400899</span><span class=\"token punctuation\">:</span>       <span class=\"token keyword\">and</span>     rsp<span class=\"token punctuation\">,</span> <span class=\"token number\">0xfffffffffffffff0</span>\n<span class=\"token number\">0x40089d</span><span class=\"token punctuation\">:</span>       push    rax\n<span class=\"token number\">0x40089e</span><span class=\"token punctuation\">:</span>       push    rsp\n<span class=\"token number\">0x40089f</span><span class=\"token punctuation\">:</span>       mov     r8<span class=\"token punctuation\">,</span> <span class=\"token number\">0x4016b0</span>\n<span class=\"token number\">0x4008a6</span><span class=\"token punctuation\">:</span>       mov     rcx<span class=\"token punctuation\">,</span> <span class=\"token number\">0x401640</span>\n<span class=\"token number\">0x4008ad</span><span class=\"token punctuation\">:</span>       mov     rdi<span class=\"token punctuation\">,</span> <span class=\"token number\">0x4011a9</span>\n<span class=\"token number\">0x4008b4</span><span class=\"token punctuation\">:</span>       call    <span class=\"token number\">0x4007e0</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">.</span>instructions<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 몇 개의 instructions이 있는지</span>\n<span class=\"token string\">'0xb'</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block<span class=\"token punctuation\">.</span>instruction_addrs <span class=\"token comment\"># instructions 메모리 주소</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">4196496</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196498</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196501</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196502</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196505</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196509</span><span class=\"token punctuation\">,</span>\n<span class=\"token number\">4196510</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196511</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196518</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196525</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4196532</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block<span class=\"token punctuation\">.</span>capstone <span class=\"token comment\"># castone disassembly</span>\n<span class=\"token operator\">&lt;</span>CapstoneBlock <span class=\"token keyword\">for</span> <span class=\"token number\">0x400890</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> block<span class=\"token punctuation\">.</span>vex <span class=\"token comment\"># vex IRSB 프로그램의 메모리 주소</span>\nIRSB <span class=\"token operator\">&lt;</span><span class=\"token number\">0x29</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span> ins<span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>Arch AMD64 <span class=\"token punctuation\">(</span>LE<span class=\"token punctuation\">)</span><span class=\"token operator\">>></span> at <span class=\"token number\">0x400890</span>\n</code></pre></div>\n<h2 id=\"state\" style=\"position:relative;\"><a href=\"#state\" aria-label=\"state permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>state</h2>\n<ul>\n<li>객체는 프로그램의 “초기화 이미지” 만을 나타낸다.</li>\n<li><code class=\"language-text\">angr</code> 로 실행을 수행할 때 시뮬레이션 된 프로그램 상태를 나타내는 특정 개체인 <code class=\"language-text\">SimState</code> 로 작업한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state\n<span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400890</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">SimState</code> 는 프로그램의 메모리, 레지스터, 파일 시스템 데이터를 포함하고 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400890</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rip  <span class=\"token comment\"># 현재 명령 포인터 위치</span>\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x400890</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rax\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x1c</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>p<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">.</span>resolved <span class=\"token comment\"># entry point의 메모리를 C int로 해석</span>\n<span class=\"token operator\">&lt;</span>BV32 <span class=\"token number\">0x8949ed31</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>해당 값들은 파이썬의 정수가 아니다. <code class=\"language-text\">비트 벡터</code>이다.</li>\n<li>파이썬 정수는 CPU의 단어와 동일한 의미를 갖지 않는다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> bv <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">0x1234</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 값이 0x1234인 32비트 벡터를 만든다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> bv\n<span class=\"token operator\">&lt;</span>BV32 <span class=\"token number\">0x1234</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>bv<span class=\"token punctuation\">)</span> <span class=\"token comment\"># python int 형으로 변환한다.</span>\n<span class=\"token number\">4660</span></code></pre></div>\n<ul>\n<li>이러한 비트 벡터를 레지스터 및 메모리에 다시 저장하거나 Python 정수를 직접 저장할 수 있다.</li>\n<li>적절한 크기의 비트 벡터로 변환된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rsi <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>solver<span class=\"token punctuation\">.</span>BVV<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rsi\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x3</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rsi\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x3</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span><span class=\"token punctuation\">.</span>resolved\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x3</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span><span class=\"token punctuation\">.</span>resolved</code></pre></div>\n<ul>\n<li><code class=\"language-text\">배열[인덱스]</code> 표기법을 사용해 주소를 지정</li>\n<li><type> : char, short, int, long, size_t, uint8_t, uint16_t…)</li>\n<li>비트 벡터 또는 파이썬 정수 중에 하나에 값을 저장할 수 있다.</li>\n<li>값을 비트 벡터로 가져 오는 데 사용된다. <code class=\"language-text\">.resolved</code></li>\n<li>값을 python int 형으로 가져 오는 데 사용 <code class=\"language-text\">.concrete</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rdi\n<span class=\"token operator\">&lt;</span>BV64 reg_rdi_1_64<span class=\"token punctuation\">{</span>UNINITIALIZED<span class=\"token punctuation\">}</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>64 비트의 비트 벡터이지만 숫자 값을 포함하지 않는다.</li>\n<li>대신에 이름이 있다. 이를 <code class=\"language-text\">symbolic Variable</code> 라고 하며 토대이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token number\">1</span><span class=\"token punctuation\">.</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> empty state\n<span class=\"token number\">2</span><span class=\"token punctuation\">.</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> entrypoint state 생성 <span class=\"token punctuation\">(</span>main start<span class=\"token punctuation\">)</span>\n<span class=\"token number\">3</span><span class=\"token punctuation\">.</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>full_init_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> _init start\n<span class=\"token number\">4</span><span class=\"token punctuation\">.</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>call_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> select function start</code></pre></div>\n<ul>\n<li>정확한 메모리 주소를 사용해야 하며 해당 프로그램이 인자 값을 받는 경우 entry_state,</li>\n</ul>\n<p>full_init_state를 통해 인자값을 제공</p>\n<h2 id=\"simulation-managers\" style=\"position:relative;\"><a href=\"#simulation-managers\" aria-label=\"simulation managers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Simulation Managers</h2>\n<ul>\n<li><code class=\"language-text\">state</code> 는 우리가 주어진 시점에서 프로그램을 대표할 경우에 얻을 수 있는 방법이 있어야  한다.</li>\n</ul>\n<h2 id=\"pfactorysimgr-pfactorysimulation_manager\" style=\"position:relative;\"><a href=\"#pfactorysimgr-pfactorysimulation_manager\" aria-label=\"pfactorysimgr pfactorysimulation_manager permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>p.factory.simgr (p.factory.simulation_manager)</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\nsm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simulation_manager<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\nsm<span class=\"token punctuation\">.</span>active\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400580</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">symbolic execution</code> 을 제어하고 <code class=\"language-text\">state</code> 공간 탐색을 위한 알고리즘을 적용한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> sm<span class=\"token punctuation\">.</span>step<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>SimulationManager <span class=\"token keyword\">with</span> <span class=\"token number\">1</span> active<span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>방금 명령 과정으로 기본 블록의 Symbolix을 실행하였다.</li>\n<li><code class=\"language-text\">active stash</code> 를 다시 살펴보고 업데이트 되었음을 알 수 있다.</li>\n<li>또한 원래 상태를 수정 하지 않았 음을 알 수 있다.</li>\n<li><code class=\"language-text\">SimState</code> 객체는 실행에 의해 변경 불가능한 것으로 처리된다.</li>\n<li>단일 상태를 여러 번의 실행을 위한 “기본”으로 안전하게 사용할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> sm<span class=\"token punctuation\">.</span>active\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400540</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> simgr<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">&lt;</span>SimState @ <span class=\"token number\">0x400540</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rip\n<span class=\"token operator\">&lt;</span>BV64 <span class=\"token number\">0x400580</span><span class=\"token operator\">></span></code></pre></div>\n<h2 id=\"analyses\" style=\"position:relative;\"><a href=\"#analyses\" aria-label=\"analyses permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Analyses</h2>\n<ul>\n<li>angr은 프로그램에서 재미있는 정보를 추출하는데 사용할 수있는 몇 가지 기본 제공 분석과 함께 미리 패키지로 제공된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BackwardSlice<span class=\"token punctuation\">(</span>                   p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>Propagator<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BasePointerSaveSimplifier<span class=\"token punctuation\">(</span>       p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>ReachingDefinitions<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BinDiff<span class=\"token punctuation\">(</span>                         p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>Reassembler<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BinaryOptimizer<span class=\"token punctuation\">(</span>                 p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>RecursiveStructurer<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>BoyScout<span class=\"token punctuation\">(</span>                        p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>RegionIdentifier<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CDG<span class=\"token punctuation\">(</span>                             p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>RegionSimplifier<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFB<span class=\"token punctuation\">(</span>                             p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>SootClassHierarchy<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFBlanket<span class=\"token punctuation\">(</span>                       p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>StackCanarySimplifier<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFG<span class=\"token punctuation\">(</span>                             p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>StackPointerTracker<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFGEmulated<span class=\"token punctuation\">(</span>                     p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>StaticHooker<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFGFast<span class=\"token punctuation\">(</span>                         p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>StructuredCodeGenerator<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CFGFastSoot<span class=\"token punctuation\">(</span>                     p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>Structurer<span class=\"token punctuation\">(</span>\np<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>CalleeCleanupFinder<span class=\"token punctuation\">(</span>             p<span class=\"token punctuation\">.</span>analyses<span class=\"token punctuation\">.</span>Typehoon<span class=\"token punctuation\">(</span></code></pre></div>\n<h2 id=\"smexplore-found-결과-출력\" style=\"position:relative;\"><a href=\"#smexplore-found-%EA%B2%B0%EA%B3%BC-%EC%B6%9C%EB%A0%A5\" aria-label=\"smexplore found 결과 출력 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sm.explore(), found 결과 출력</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># find, avoid 인수 -> find 허용할 값, avoid 피해가야 할 위치</span>\n<span class=\"token comment\"># find, avoid -> (메모리 주소, 문자열)</span>\nsm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x401546</span><span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x4007D0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A0%ED%83%9D\">프로젝트 선택</a></li>\n<li><a href=\"#loader\">loader</a></li>\n<li><a href=\"#pfactory-%EC%83%9D%EC%84%B1%EC%9E%90%EB%93%A4\">p.factory (생성자들)</a></li>\n<li><a href=\"#block\">block</a></li>\n<li><a href=\"#state\">state</a></li>\n<li><a href=\"#simulation-managers\">Simulation Managers</a></li>\n<li><a href=\"#pfactorysimgr-pfactorysimulation_manager\">p.factory.simgr (p.factory.simulation_manager)</a></li>\n<li><a href=\"#analyses\">Analyses</a></li>\n<li><a href=\"#smexplore-found-%EA%B2%B0%EA%B3%BC-%EC%B6%9C%EB%A0%A5\">sm.explore(), found 결과 출력</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 14, 2020","title":"angr 바이너리 분석 활용 방안 1","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🤬"},"fields":{"slug":"/angr-1_theori/"}},"prev":{"id":"a1cbd834-e57e-573a-b4e3-0cc76df63a00","html":"<h1 id=\"angr-fauxware-문제-풀이\" style=\"position:relative;\"><a href=\"#angr-fauxware-%EB%AC%B8%EC%A0%9C-%ED%92%80%EC%9D%B4\" aria-label=\"angr fauxware 문제 풀이 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr fauxware 문제 풀이</h1>\n<blockquote>\n<p>문제 바이너리 <a href=\"https://github.com/dnsdudrla97/angr-doc/tree/master/examples/fauxware-SOLVED\">dnsdudrla97/angr-doc</a></p>\n</blockquote>\n<h2 id=\"data-섹션\" style=\"position:relative;\"><a href=\"#data-%EC%84%B9%EC%85%98\" aria-label=\"data 섹션 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>data 섹션</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwklEQVQY04WQS04EMQwF+/6XYsOCBScARp0oETOT6Tj9IY5t3DFiWNKC0tuWVHoDwFuMT8495Pxid0ppKGxm3br9yQAwxvg8jo/TdCLS3jsUBFx0V/uPIedbCG4cX1O6bhup7lOuPr+jICmRkuzMyrLL75ABAGKMzvmUJkRW/SSSKvXHXCvNGy8fPG+y9yM5hOCcS+l2PkMp87yspRXkZmbCRu179xMOsnMIwXt3uSTvV0SG0tI2VUbtymSIVquJHMhfOjlaX8ldqggAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/63bed866b810e70ccbaebabeca81a892/37523/0.png\"\n        srcset=\"/static/63bed866b810e70ccbaebabeca81a892/e9ff0/0.png 180w,\n/static/63bed866b810e70ccbaebabeca81a892/f21e7/0.png 360w,\n/static/63bed866b810e70ccbaebabeca81a892/37523/0.png 720w,\n/static/63bed866b810e70ccbaebabeca81a892/d9217/0.png 904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"authenticate-함수\" style=\"position:relative;\"><a href=\"#authenticate-%ED%95%A8%EC%88%98\" aria-label=\"authenticate 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>authenticate 함수</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTUlEQVQ4y2WNh24cORBE5/+/zJYBG5bP3tVKGyZHpklMTdZh5L1Z2Qc8NArNV80kADsUAYDxWSndd0ta8HHSnBnGOT5oOwlF7PiwlQc+M77WteXCAdA6CCni+2kK8aOfuIiPECDFVKR1eilfX/NzWvWsr3nvAAf4P+XERjwArCe36m06ZwN9/v7reG3lKuU0LevKpNAUdj/RAQ8itA/aujXeN0XJi0JKsYzLpLVvWj47b/57TZaABxGLo8W4LQTMFMtGCaGrRlGkZUFeqsn73U9mwoOA2dKs3RYIE6GopBTumstBKABCKWn8+92NZCQ8CBgtjdptgaB8LGullM4Lwcfx98/C+inc/UQRHgQoS0q7LRCkR1FLwW1Zrp5IazSd4taP4e4n3OMBgRviq9uCB3PIazkqk2ay5cITBqk64wXd/YR57HACs4Fpz+h9Q8gqKaXLMu1siIRByM54Tnc/6R12GhvbxXVqbV0cXGwczkV3ecuOL/nzW3bMi9eqagz1/u4n7XtniPiRNU9fr3UjBGNyWj59+/n0PW2bgQ1DL9Tn58OXH7dWyIaJ2oTWoXVImq2MjnBh8znvjml/uA2HS/f1WJ5L9vPSv5X8cG1eblVVyaIUt6apTNhaDkll8ZvaofIoLW4z0gXfLt3TST6f9amaz9JdRzp2yytbrqPeK0lhccfcQ+WQmfDPKS8LbrRBMG+9KP12esNhryS5xV8UBreVikYvE7TGOodTJ3OH3CAz29zNJDX4PzcdXnJ5OA2HV3Y6d78anjmkOv6l/QueiALTr0N3XgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/37523/1.png\"\n        srcset=\"/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/e9ff0/1.png 180w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/f21e7/1.png 360w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/37523/1.png 720w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/66caf/1.png 853w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">sneaky</code> 전역 변수가 가리키고 있는 문자열 과 유저 이름을 <code class=\"language-text\">strcmp</code> 함수를 바탕으로 비교를 통해 같으면 1을 반환하고 아닐시 유저 이름에 해당 하는 파일 이름을 <code class=\"language-text\">open</code> 함수를 바탕으로 읽고 해당 값과 유저 패스워드와 비교하여 같으면 1을 반환 아니면 0을 반환한다.</li>\n<li>우리가 피해야할 주소 값은 <code class=\"language-text\">0x4006E6</code> 임을 알 수있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 685px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.444444444444445%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZ0lEQVQI133L0QpAMBQGYC8iT+YBvKWiqClxpRT3amYzxs7+M2/gu/+SccibJhMiXdbCmLhtJ8D3TUSw9vXBxxg9/O52/WjzGuXU4Q79aDCSvu/qumzbap4na0nKS0oXApiZCGD85A9WaG2wheyAFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/8c2acbdbc9b4c5725b0627966d9cffc1/8ce22/2.png\"\n        srcset=\"/static/8c2acbdbc9b4c5725b0627966d9cffc1/e9ff0/2.png 180w,\n/static/8c2acbdbc9b4c5725b0627966d9cffc1/f21e7/2.png 360w,\n/static/8c2acbdbc9b4c5725b0627966d9cffc1/8ce22/2.png 685w\"\n        sizes=\"(max-width: 685px) 100vw, 685px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"접근해야-하는-위치\" style=\"position:relative;\"><a href=\"#%EC%A0%91%EA%B7%BC%ED%95%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9C%84%EC%B9%98\" aria-label=\"접근해야 하는 위치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>접근해야 하는 위치</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzklEQVQY042MQW6DMBBFuf+BEOxokKVaDRIsuAALFCUhNrIZbMszv6Is2u7y9PUWI70pLpdLVVVKqdfLEu0x7sbsy0LGRGYAyJKP8TH8p9BaN83H9fp1u23zjJTEWtzv2DaIABAXnQ32tPycfuOu65RSfd8T7czIGcaQ9/H59ERJRIQFAgiEhf9wxE3TlGWplCLazn/zvFobpomcizlzSimEcDrGmFI6fcTDMGitx3G0NjgH7zFN6fFgvEHRtm1d11p/LgutK5jFe4TwTotvrAVUuy6lDyYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/39223845b13477da25018ca3ed3d5330/37523/3.png\"\n        srcset=\"/static/39223845b13477da25018ca3ed3d5330/e9ff0/3.png 180w,\n/static/39223845b13477da25018ca3ed3d5330/f21e7/3.png 360w,\n/static/39223845b13477da25018ca3ed3d5330/37523/3.png 720w,\n/static/39223845b13477da25018ca3ed3d5330/a1792/3.png 780w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>기본적으로 앞에서 <code class=\"language-text\">authenticate</code> 함수에서 반환된 값이 1 일 경우 <code class=\"language-text\">accepted</code> 함수를 호출하게 된다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVQI14XJuQrCQBRA0fz/N1jaiYVYmkYxQUgMRBDUgCEYFIbgIA6zvHmLaGEleMp7k7Y9l2Wd59vd7qA1KyUArDUaQzGSiACCjdajt2CJ3+UraZrLOpuk6agopiLv5xwMg1HK9f0zBCQi8ICAEWL4AIAQAjMnbXsty1mWjet6TkSI4hzebvbxQO9JhJmZiPiX5HQ6rlabxWJZVfv7XYZBjOGuoxjlrxeSdOG4uMhfzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/3847c841642582560fe24c2a75fe09a0/37523/4.png\"\n        srcset=\"/static/3847c841642582560fe24c2a75fe09a0/e9ff0/4.png 180w,\n/static/3847c841642582560fe24c2a75fe09a0/f21e7/4.png 360w,\n/static/3847c841642582560fe24c2a75fe09a0/37523/4.png 720w,\n/static/3847c841642582560fe24c2a75fe09a0/cda19/4.png 785w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"angr-solve-1\" style=\"position:relative;\"><a href=\"#angr-solve-1\" aria-label=\"angr solve 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr solve 1</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">solve2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    state<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sm<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n    sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x4006F6</span><span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x4007CE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4006E6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQY012NW27DIBBFvRCGkkRKAswAw8OY2I6duKq6/xVVdtWfSkf3Y3TPnS5/bXV5p2HKw3RJURQPlaEPorJK4SMHKF5mDyXIEmQOMnrJDkqA6Lv8ftfXn5z/yyozZL9r0UPP+1B0kg+C6/Jj7sclDmM6ZMhurxYPfTixV/n4lg6/sixeNoaB4ZFk5U4vk/l86nW026yGLCyCc+BIeJJIQCQcAe4pnBNIwqAg2kHs6rb22xbnZ1peuoVb1XrEe8Nrc2ZA00hPdKuIM+JK9ESarR7p2uhesXt8L2V78bryurjWsJZ7ZoVGkT3jzomsQnt25uyOJPN7OaH9AfTHQVHc0WPgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/e6a557b26bee82d8f1a1c2799889acd9/37523/5.png\"\n        srcset=\"/static/e6a557b26bee82d8f1a1c2799889acd9/e9ff0/5.png 180w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/f21e7/5.png 360w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/37523/5.png 720w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/302a4/5.png 1080w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/76a99/5.png 1117w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"angr-sovle-2\" style=\"position:relative;\"><a href=\"#angr-sovle-2\" aria-label=\"angr sovle 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr sovle 2</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">solve1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n    sm<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>until <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> sm_<span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sm_<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    input_0 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    input_1 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    r <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_0<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_1<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvklEQVQI1x2O4WrDMAyE8x6b5HQbKyOyJdmynSxbk9SUwmB7/8cZLtyP44OPu+Hy92v3NreWlu+y7udskBmrYlGs6kxekp6SjonRGLNAFtCA7FH80OXjmLdrmr/qcjmbPReBGqEoVHVZTkk6yYLGUBWKYBXMgkUG+7mHeZHPlerMy/qa9CkQiEcNqMFxGJnxMQUxgAnGzrEfkSHernxscju4bdL2j319z/Zm0QWPgRzROBEG74jQT0jUMz2Kp3+5BiwsIZClpwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/12139aab9feafe745ed586ce0870bdee/37523/6.png\"\n        srcset=\"/static/12139aab9feafe745ed586ce0870bdee/e9ff0/6.png 180w,\n/static/12139aab9feafe745ed586ce0870bdee/f21e7/6.png 360w,\n/static/12139aab9feafe745ed586ce0870bdee/37523/6.png 720w,\n/static/12139aab9feafe745ed586ce0870bdee/2e694/6.png 1048w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n<span class=\"token keyword\">import</span> sys\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">bse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 먼저 바이너리를 Angr 프로젝트에 로드 한다.</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># entry_state 프로그램의 진입점에서 가능한 프로그램 상태를 매우 일반적인 표현인 SimState로 생성한다.</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># SimulationManager는 단지 그것들을 관리하기 위한 많은 편리한 인터페이스가 부착된</span>\n    <span class=\"token comment\"># 다양한 태그를 가진 상태들의 모음이다</span>\n    sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 실행 시작-> 두 가지 모두 만족할만한 분기 문에 도달할 때 까지 </span>\n    <span class=\"token comment\"># 프로그램을 실행 한다. 현재 active 주소 값이 1 보다 클때 까지</span>\n    sm<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>until <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> sm_<span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sm_<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 입력 조건</span>\n    input_0 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    input_1 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n    r <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    \n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_0<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_1<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    bse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#data-%EC%84%B9%EC%85%98\">data 섹션</a></li>\n<li><a href=\"#authenticate-%ED%95%A8%EC%88%98\">authenticate 함수</a></li>\n<li><a href=\"#%EC%A0%91%EA%B7%BC%ED%95%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9C%84%EC%B9%98\">접근해야 하는 위치</a></li>\n<li><a href=\"#angr-solve-1\">angr solve 1</a></li>\n<li><a href=\"#angr-sovle-2\">angr sovle 2</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 14, 2020","title":"angr 바이너리 분석 활용 방안 3","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🤬"},"fields":{"slug":"/angr-3_theori/"}},"site":{"siteMetadata":{"siteUrl":"https://www.zoomkoding.com","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/codegate2018_redvelbet_ctf_writeup/","nextSlug":"/angr-1_theori/","prevSlug":"/angr-3_theori/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}