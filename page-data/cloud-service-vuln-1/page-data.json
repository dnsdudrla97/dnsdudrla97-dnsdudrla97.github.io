{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/cloud-service-vuln-1/",
    "result": {"data":{"cur":{"id":"c9d7e71f-e3df-5a7e-9d54-77d8ff5ae8f2","html":"<h1 id=\"클라우드-서비스-취약점-분석-1\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-1\" aria-label=\"클라우드 서비스 취약점 분석 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 1</h1>\n<aside>\n💡  클라우드 서비스 취약점 분석 연습을 위해 Rhino Security Lab의 CloudGoat 실습을 진행하도록 하겠습니다.\n<p>다음은 참조 CloudGoat Github 링크입니다.</p>\n<p><a href=\"https://github.com/RhinoSecurityLabs/cloudgoat\">https://github.com/RhinoSecurityLabs/cloudgoat</a></p>\n</aside>\n<h1 id=\"실습-환경-구성\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1\" aria-label=\"실습 환경 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실습 환경 구성</h1>\n<h3 id=\"필수-설치-패키지\" style=\"position:relative;\"><a href=\"#%ED%95%84%EC%88%98-%EC%84%A4%EC%B9%98-%ED%8C%A8%ED%82%A4%EC%A7%80\" aria-label=\"필수 설치 패키지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>필수 설치 패키지</h3>\n<ul>\n<li>Linux or MacOS. Windows is not officially supported.\n<ul>\n<li>Argument tab-completion requires bash 4.2+ (Linux, or OSX with some difficulty).</li>\n</ul>\n</li>\n<li>Python3.6+ is required.</li>\n<li>Terraform >= 0.14 <a href=\"https://learn.hashicorp.com/terraform/getting-started/install.html\">installed and in your $PATH</a>.</li>\n</ul>\n<p><a href=\"https://learn.hashicorp.com/tutorials/terraform/install-cli\">Install Terraform | Terraform - HashiCorp Learn</a></p>\n<ul>\n<li>The AWS CLI <a href=\"https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html\">installed and in your $PATH</a>, and an AWS account with sufficient privileges to create and destroy resources.</li>\n<li><a href=\"https://stedolan.github.io/jq/\">jq</a></li>\n</ul>\n<p><a href=\"https://stedolan.github.io/jq/\">jq</a></p>\n<h3 id=\"설치\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98\" aria-label=\"설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">$ git <span class=\"token keyword\">clone</span> https<span class=\"token punctuation\">:</span><span class=\"token comment\">//github.com/RhinoSecurityLabs/cloudgoat.git</span>\n$ cd <span class=\"token class-name type-declaration\">cloudgoat</span>\n$ pip3 install <span class=\"token operator\">-</span>r <span class=\"token operator\">.</span><span class=\"token operator\">/</span>core<span class=\"token operator\">/</span>python<span class=\"token operator\">/</span>requirements<span class=\"token operator\">.</span><span class=\"token class-name type-declaration\">txt</span>\n$ chmod u<span class=\"token operator\">+</span>x cloudgoat<span class=\"token operator\">.</span>py</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVQI13WOOw6CQAAFUQmxUxIMirKAyB92RQSjUGii9z/SGCmNFq+YYiZPi5ITrlewskO8oGQnMhxRsHZz9gfF1k3Zxxkikdi+QjcsJrMlU938OS2Ma4RfYm8imvaBPA5I1VPJG931SZp3VGqgu72QTc/MMNGmi1H+hL/jWpK1eEHF2olR9UBRXcnKC1HacDrfidNm5CBvcbwI0xIY89Xfl28E+0/iErUWYgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/e4fa6c27ca6e77a3c59139f0577597f1/37523/0.png\"\n        srcset=\"/static/e4fa6c27ca6e77a3c59139f0577597f1/e9ff0/0.png 180w,\n/static/e4fa6c27ca6e77a3c59139f0577597f1/f21e7/0.png 360w,\n/static/e4fa6c27ca6e77a3c59139f0577597f1/37523/0.png 720w,\n/static/e4fa6c27ca6e77a3c59139f0577597f1/71c8e/0.png 875w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAq0lEQVQY03WQ3QoCIRCF9/0fL+hy6SaiHdPWn1x1XE+MVhCRcGD8js5wZopxwyNu2PcdtdYfCW+t/RXXCuaCmTbMlDA550BEMEbDGANrLdZ17bLOwns/6hf/8q3tf4zWOJ4Ih/mKKYSA82XBojTU7Q4ZII+11r0ZKcJC1JkMlibivWtSqt9jcHh4i0kipVzBVSKPeMKYGWhAKhm5lBGP+ePLOuQkzmM1wlvDE3dkNSM8iDotAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/9e04904dd6fc1d129d314db67fedd32e/37523/1.png\"\n        srcset=\"/static/9e04904dd6fc1d129d314db67fedd32e/e9ff0/1.png 180w,\n/static/9e04904dd6fc1d129d314db67fedd32e/f21e7/1.png 360w,\n/static/9e04904dd6fc1d129d314db67fedd32e/37523/1.png 720w,\n/static/9e04904dd6fc1d129d314db67fedd32e/302a4/1.png 1080w,\n/static/9e04904dd6fc1d129d314db67fedd32e/07a9c/1.png 1440w,\n/static/9e04904dd6fc1d129d314db67fedd32e/99375/1.png 1525w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM 사용자 추가를 누른 후 AWS IAM Full-Admin 권한의 사용자 생성을 진행하여 cloudgoat 환경에서 다양한 인스턴스및 여러 기능들을 수행할 수 있도록 환경 구성을 진행해야 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWElEQVQ4y52Ty07DMBBF/e98CztW7PgAVrBFQhVCiCpN82iS+v2IfZHtNmpKgJaRjpxxkhlf6w6hdA8pJWJ47ydCCIml/HT/HILzCAH7fW6itYZSCkKIBGMcxpjDZ2ER4p2FcxbjmDuM44i+71PRCOc8FXNunH76LYjTHIZ1aJsadV2jLEtsNiWqqkp5PNFP8hYlr3cat48F3koK70ySqXVe/xOk6jkent6x+thACjZJjQzDcDXEWYN6vcJ2u0XVdOj7YSp2WvxSyOgDjKSQSkMoC2PdzCbXQpxz4EKCMQbOWVqjZZY8eVFB70coKSA4Az3Y5Mi5uY+2Olpsvp/fESEVimqHz3pA0+7Qtjt0XYeqqtE0LeqmAaVs8iOlNOVCyNyYcTCalUXIa0Fxc/eC++cCWuVpiJaJV2GtTfxl5plt4nGN1rBGZw8qnSTMp/H7DOfngODnV/IFFqf1Xxjnq18AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0\"\n        title=\"0\"\n        src=\"/static/ddc19233c1789764932065ff72685f2c/37523/2.png\"\n        srcset=\"/static/ddc19233c1789764932065ff72685f2c/e9ff0/2.png 180w,\n/static/ddc19233c1789764932065ff72685f2c/f21e7/2.png 360w,\n/static/ddc19233c1789764932065ff72685f2c/37523/2.png 720w,\n/static/ddc19233c1789764932065ff72685f2c/91b29/2.png 983w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>AdministratorAccess 정책 권한을 설정한후 해당 access-key, secret-key를 저장하여 AWS cli profile를 설정을 진행합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">$ aws configure <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile cloudgoat\n\ncat <span class=\"token operator\">~</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>aws<span class=\"token operator\">/</span>credentials\n<span class=\"token punctuation\">[</span>cloudgoat<span class=\"token punctuation\">]</span>\naws_access_key_id <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_KEY<span class=\"token operator\">></span>\naws_secret_access_key <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_SECRET_KEY<span class=\"token operator\">></span>\ncat <span class=\"token operator\">~</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>aws<span class=\"token operator\">/</span>config\n<span class=\"token punctuation\">[</span>cloudgoat<span class=\"token punctuation\">]</span>\nregion <span class=\"token operator\">=</span> us<span class=\"token operator\">-</span>east<span class=\"token operator\">-</span><span class=\"token number\">1</span>\n</code></pre></div>\n<ul>\n<li>설정이 완료되면 credentials, config 파일에 각각 저장이 됩니다.</li>\n<li>앞에서 설정한 각 정보들을 그대로 cloudgoat 에 적용하여 설치를 마무리 합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>cloudgoat<span class=\"token punctuation\">.</span>py config profile\n$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>cloudgoat<span class=\"token punctuation\">.</span>py config whitelist <span class=\"token operator\">-</span><span class=\"token operator\">-</span>auto</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%ED%95%84%EC%88%98-%EC%84%A4%EC%B9%98-%ED%8C%A8%ED%82%A4%EC%A7%80\">필수 설치 패키지</a></li>\n<li><a href=\"#%EC%84%A4%EC%B9%98\">설치</a></li>\n</ul>\n</div>","excerpt":"클라우드 서비스 취약점 분석 1 다음은 참조 CloudGoat Github 링크입니다. https://github.com/RhinoSecurityLabs/cloudgoat 실습 환경 구성 필수 설치 패키지 Linux or MacOS. Windows is not officially supported. Argument tab-completion requires bash 4.2+ (Linux, or OSX with some difficulty). Python3.6+ is required. Terraform >= 0.14 installed and in your $PATH. Install Terraform | Terraform - HashiCorp Learn The AWS CLI installed and in your $PATH, and an AWS account with sufficient privileges to create and destroy resources. jq jq 설치   …","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 1 (클라우드 서비스 취약점 및 공격 벡터)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-1/"}},"next":{"id":"3598a0dc-de2b-598a-bc02-4b43a646bcfa","html":"<h1 id=\"클라우드-서비스-취약점-분석-0\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-0\" aria-label=\"클라우드 서비스 취약점 분석 0 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 0</h1>\n<h1 id=\"클라우드-컴퓨팅-보안\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%BB%B4%ED%93%A8%ED%8C%85-%EB%B3%B4%EC%95%88\" aria-label=\"클라우드 컴퓨팅 보안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 컴퓨팅 보안</h1>\n<ul>\n<li>기업, 조직 내의 데이터, 애플리케이션, 워크로드를 클라우드 컴퓨팅에 저장하고 다양한 서비스로 활용하며 서로가 공유하면서 지속적으로 변화가 발생합니다. 이와 동시에 새로운 보안 위협과 과제도 생겨나며 많은 양의 데이터가 퍼블릭 클라우드 서비스에 저장되면서 해커들의 공격 목표가 됐습니다.</li>\n</ul>\n<h1 id=\"public-cloud---private-cloud\" style=\"position:relative;\"><a href=\"#public-cloud---private-cloud\" aria-label=\"public cloud   private cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Public Cloud &#x26;  Private Cloud</h1>\n<h3 id=\"public-cloud\" style=\"position:relative;\"><a href=\"#public-cloud\" aria-label=\"public cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Public Cloud</h3>\n<ul>\n<li>Azure, AWS, GCP, Alibaba, NCP 등 다양한 클라우드 서비스</li>\n<li>LasS, PasS, SaaS 등 다양한 스펙트럼의 서비스 제공</li>\n</ul>\n<h3 id=\"private-cloud\" style=\"position:relative;\"><a href=\"#private-cloud\" aria-label=\"private cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Private Cloud</h3>\n<ul>\n<li>조직 내 클라우드, 개인정보 관리 등 직접 구축할 이유가 있을 때 사용</li>\n<li>Public Cloud 사업자 시작 이전 단계가 필요한 경우 사용</li>\n<li>OpenStack을 주로 많이 이용</li>\n</ul>\n<h3 id=\"openstack\" style=\"position:relative;\"><a href=\"#openstack\" aria-label=\"openstack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OpenStack</h3>\n<ul>\n<li>Rackspace, NASA가 공동개발로 2010년에 Release한 오픈 소스 클라우드 컴퓨팅 플랫폼입니다.</li>\n<li>이미징, 네트워킹, 컴퓨팅, 볼륨 관리 및 인증 관리 등 클라우드 서비스를 제공하기 위해 각각의 자원관리 지능을 프로젝트 단위로 관리합니다.</li>\n<li>실제로는 EC2, VCP, … 각 역활에 대해서 호환되는 정도가 많습니다.</li>\n<li>클라우드 시스템을 구축할 때는 가상화가 필수 이며 이미지, 볼륨을 관리할 시스템이 필요합니다.</li>\n</ul>\n<p><img src=\"/ad9c44d89f3247960fbf97c3c28f8866/overview-diagram-new.svg\" alt=\"https://www.openstack.org/\"></p>\n<p><a href=\"https://www.openstack.org/\">https://www.openstack.org/</a></p>\n<h3 id=\"nova-compute-service\" style=\"position:relative;\"><a href=\"#nova-compute-service\" aria-label=\"nova compute service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nova Compute Service</h3>\n<ul>\n<li>OpenStack 에서 가장 중요한 서비스에 해당되며, Hyper-V를 호출해서 각 인스터를 생성하고 관리하는 역활을 수행합니다.</li>\n<li>대시보드 등에서 RESETful API 형태인 nova-api를 통해서 인스턴스 생성 등의 명령을 전달합니다.</li>\n<li>Nova-Computer 를 거쳐서 Hyper-V에 명령을 전달하고,최종적으로 명령을 수행합니다.</li>\n<li>생성된 인스턴스는 nova-console을 통해 통신이 가능합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 141.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGD0lEQVRIx5VWe0xTdxQ+bfHB1GX7wzlZgmNZyN5xuO2PxW2yzEFgy5KZIUSjzMTGiaBkkkmQDMPS8FhBHkrHyxYQyvuNUJHHagtFS3ClUGjT2t4+6C2V0gctoN7l3FHGpnHZSX5pe+653+93v/Od7xZ4PB5ERESAz+cDiqJAoVBAXV0dIzMzE8RiMZ3zr/r6Bgafn81sb/+N0dJSAo2NxfBExMfH4weTIIhCkiS7BgYGXr9+/TqUl5dDT0/PwYmJiYbp6enGoaGhrzs7O6G6Ohu6u8uhs7OM0drKexIQdzYYDBeXl5cpXFarVQoAOzAvFovPezwe6tGjRxRBEMWY6+qqZPf1VR24dasWensFDMzl5ORAbm4uxMbG/gWo0+mSfD4fDTg3N9cLAIGY7+vrS0HAx48fU1qtloe54uL0ivr6vKOXLrHh4sUTzKamJob/cC6Xi7F+SrVafUan0+UmJibuQF4BYGtOTk7oyMhI0vj4+LmamppwANi0kVNcfD4fazcDwBaHwwEgEAigurp6p1QqFajV6lq5XF4EADuxeGBg4IBcLv9dqVRKbty4cYzL5e5TqaZndDqdXiaTXcaasrKyfR6PZ9rj8WilUuleEAqFUFtb+6rVaqUwFhYWHADwChb39vYmOJ1OanV1lTKZTIXJyclfzc/P05w6nc5BrNHr9f1IF1JDkuQQfUI+nx9sMplormw2mxUAgh48eAA3b9485nK5qIcPH1Jms/nXpKSkL2w2Gw1os9luIeDIyEjy0tIShXXYCzh8+DCcPHlyk1gsjtRqtYdkMlkEALyAUqqqqgouLS1N4vP5STweb294ePgOmUwWKZVKY4VC4WcAwFjTbvTU1NQ3+J0mlsPhwOjoKFitVpiYmMAcXdjU1FSqVCpJhUJhrKmp+WFjM8bGxjbKDkwmE/0dwsLCgM1mM1JSUgKuXLkS0NHRwVKr1QEqlQqGh4cbkb+VlRXKaDRy1sCw00yZTMZEwKKiIuSRiautrQ2Qp1MlJSV7UHuBgYHb8DHsdjvLbDaDSCTikySJYqc0Gs0vFosFjEYjC54VV69ejYqOjg4GgO0sFutFBPT5fIzm5mbIysraYzAYtCRJLnV0dHwsl8tBqVQy4T/ieexqcHDwtqioqIDQ0FBGRkYGaDQa5t27d5GrPVKp9D21Wo0GQnP7zEhNTWWWl5czx8fHsQk0sXFxcf+Y9Y0gU1PDMDravb6eag4ajQaKi4t3CQSC1/B3QkICVFZWQlpa2vYLFy6EpKenhxw5cuS5srJK+PfoPRH37t3Dbr7tdrvnsKNqtfr7mZkZ6O/vx3yCxWKhcDoUCkXa5OQkgrD8snoqICbNZnMFSgPdxmazEQDwEuYHBwdTMYdBEEQR5mprL3e1t/OSmpsL4No1Di0VgiBY2H1aNrOzsyCXyz9wuVyE1+td1mg0p/27t7a2xrvdbuvq6iqpVCozMBcbG/7p0aMfvpybewnu35fTJyUI4m9h4/FXVlagpaXlS5FIdGLtMVAamzkczu7s7OxYLpcbx2az34mJidldV9f4OZ9fHV1QUPCuf+Pp6elDKpXqO/pePOGdO3c+8nq98/hoEokkHRF7enpw8ONR1IuLi9Ts7OzP+fn54Wgia0bQgwCjo6Op6DZerxdN+Jyfw3JsCF5wOBxaNFKJRIIaPIU34zWj0ZifmJj4rd1up93G4/H0r9nXAIJhnc1mEwHqTyKRvLG4uHgfOezv7z+DhTgpUqn0E5Ik/0ADNRgMp8+ePfu+xWKZ8nq9Bo1GU7lmsGFut3vS6XSqxGLxW/QJPR4Pvjp39fX10ToMCgpCS2cJhcKDXC43LTMz83xcXNybOJZr/G4BgADkv6Kiws85E2fdD8hA5xaJRH7BMvGzu7u7c2FhAd2ZGhwczMJcXl7e1o2Sa2hoWH9JkSTJWFf87du3GWNjY4zCwkKcHBbuJpFIWpAbh8NB2e32NP9m+/fvh5CQECgtLaWBjh8/Tr/fY2Jinj7fSqWShf8g2trafpqbm0OyKblc/qNer6evwf8N/IfgP7ler88zm811kZGRgQUFBbSzPyv+BK8SuqV/N8AYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"https://docs.openstack.org/nova/pike/user/architecture.html\"\n        title=\"https://docs.openstack.org/nova/pike/user/architecture.html\"\n        src=\"/static/c465a15b2718d776f9adf0c859731e9e/37523/nova-arch.png\"\n        srcset=\"/static/c465a15b2718d776f9adf0c859731e9e/e9ff0/nova-arch.png 180w,\n/static/c465a15b2718d776f9adf0c859731e9e/f21e7/nova-arch.png 360w,\n/static/c465a15b2718d776f9adf0c859731e9e/37523/nova-arch.png 720w,\n/static/c465a15b2718d776f9adf0c859731e9e/302a4/nova-arch.png 1080w,\n/static/c465a15b2718d776f9adf0c859731e9e/07a9c/nova-arch.png 1440w,\n/static/c465a15b2718d776f9adf0c859731e9e/dca52/nova-arch.png 1550w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>)</p>\n<p><a href=\"https://docs.openstack.org/nova/pike/user/architecture.html\">https://docs.openstack.org/nova/pike/user/architecture.html</a></p>\n<h1 id=\"aws-iam\" style=\"position:relative;\"><a href=\"#aws-iam\" aria-label=\"aws iam permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS IAM</h1>\n<ul>\n<li>AWS 리소스에 대한 권한 및 접근 제어를 리소스별로 세분화하여 제어할 수 있는 서비스 입니다.</li>\n<li>Group, User, Role, Policy로 설정이 가능합니다.</li>\n<li>권한 상승, 유출 문제 등 취약저 분석 과정에서 가장 눈여겨봐야 하는 부분중 하나입니다.</li>\n<li>주로 구축했던 시기에 취약점이 발생되어 노출이 되는 경우 입니다.</li>\n</ul>\n<h3 id=\"pbac-설명\" style=\"position:relative;\"><a href=\"#pbac-%EC%84%A4%EB%AA%85\" aria-label=\"pbac 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PBAC 설명</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[사용자]\n피터 - 기사     &lt;그룹: 공격대1>\n케빈 - 마법사   &lt;그룹: 공격대1>\n레이 - 힐러     &lt;그룹: 공격대1>\n\n[그룹]\n공격대1         &lt;역활: ['몬스터 잡기']>\n\n[역활]\n몬스터 잡기     &lt;정책:  [일반 공격]>\n\n[정책]\nAllow 일반 공격 if 사용자.마법사? == True (MP Object 사용)\nAllow 일반 공격 if 사용자.전사? == True (HP Object 사용)\nAllow 일반 공격 if 사용자.힐러? == True (GP Object 사용)</code></pre></div>\n<ul>\n<li>관리의 용이성을 위해 동일한 그룹내에 사용자를 편성 합니다.</li>\n<li>편성된 그룹에 한하여 수행할 수있는 역활을 부여합니다.</li>\n<li>역활 수행시 그룹 내 정해진 사용자에 한하여 수행하도록 정책을 설정합니다.</li>\n<li>역활 수행시 정해진 객체에 한해서 접근하여 수행하도록 정책을 설정합니다.</li>\n</ul>\n<h3 id=\"iam-정책\" style=\"position:relative;\"><a href=\"#iam-%EC%A0%95%EC%B1%85\" aria-label=\"iam 정책 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM 정책</h3>\n<ul>\n<li>JSON 포맷을 사용하며 각 데이터를 세분화해서 관리를 진행합니다.</li>\n</ul>\n<p><a href=\"https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_grammar.html\">IAM JSON 정책 언어의 문법</a></p>\n<h1 id=\"ec2\" style=\"position:relative;\"><a href=\"#ec2\" aria-label=\"ec2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EC2</h1>\n<ul>\n<li>virtualization Compute Instance, 가장 일반적으로 생성해서 사용하는 서비스입니다.</li>\n<li>AMI (Image), EBS(Volume)을 이용해서 인스턴스 백업이 가능합니다.</li>\n<li>외부에서 Exploit 진행시 비중이 가장 높은 인스턴스 입니다.</li>\n</ul>\n<h1 id=\"s3\" style=\"position:relative;\"><a href=\"#s3\" aria-label=\"s3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3</h1>\n<ul>\n<li>업로드, 다운로드 등의 행위로만 구성된 Storage Instance 입니다.</li>\n<li>정적 웹 서비스 요소로 구축이 가능합니다.</li>\n<li>보안사고에서 자주 언급된는 S3 data breach가 이 곳의 데이터 유출을 말합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://s3.console.aws.amazon.com/s3/home?region=ap-northeast-2</code></pre></div>\n<h1 id=\"lambda\" style=\"position:relative;\"><a href=\"#lambda\" aria-label=\"lambda permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda</h1>\n<ul>\n<li>이벤트 기반의 서버리스 서비스 인스턴스 (Python, nodeJS, Go, .NET, Ruby 지원) 입니다.</li>\n<li>내부적으로 Amazon Linux AMI에서 생성되는 컨테이너, +egress controller</li>\n<li>API Gateway, S3, SQ3, SNS 등과의 다양한 조합으로 사용가능한 서버리스 구조입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://console.aws.amazon.com/lambda/home?region=ap-northeast-2</code></pre></div>\n<h1 id=\"aws-공격-벡터\" style=\"position:relative;\"><a href=\"#aws-%EA%B3%B5%EA%B2%A9-%EB%B2%A1%ED%84%B0\" aria-label=\"aws 공격 벡터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS 공격 벡터</h1>\n<ul>\n<li>IAM 의 권한 문제로 인해 많은 보안 문제가 야기됩니다.</li>\n<li>IAM Leak  (환경 변수, Instance Post Exploitation, SSRF…)</li>\n<li>IAM Privilege Escalation</li>\n<li>S3 Data Breach</li>\n<li>개발 구축 환경에서 발생 가능한 취약점 (CI/CD, Code Deploy, Terraform, …)</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#public-cloud\">Public Cloud</a></li>\n<li><a href=\"#private-cloud\">Private Cloud</a></li>\n<li><a href=\"#openstack\">OpenStack</a></li>\n<li><a href=\"#nova-compute-service\">Nova Compute Service</a></li>\n<li><a href=\"#pbac-%EC%84%A4%EB%AA%85\">PBAC 설명</a></li>\n<li><a href=\"#iam-%EC%A0%95%EC%B1%85\">IAM 정책</a></li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 0 (클라우드 서비스 취약점 개요)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-0/"}},"prev":{"id":"edaa6ec1-a05a-5b6c-950f-64bc334b2dbc","html":"<h1 id=\"클라우드-서비스-취약점-분석-2\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-2\" aria-label=\"클라우드 서비스 취약점 분석 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 2</h1>\n<h1 id=\"scenario-1--iam-privilege-escalation-by-rollback\" style=\"position:relative;\"><a href=\"#scenario-1--iam-privilege-escalation-by-rollback\" aria-label=\"scenario 1  iam privilege escalation by rollback permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 1]:  IAM Privilege Escalation By Rollback</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Size: Small\nDifficulty: Easy\nCommand: $ ./cloudgoat.py create iam_privesc_by_rollback</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>한 명의 IAM User (5 정책 버전)</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>IAM User: Raynor</li>\n<li><code class=\"language-text\">SetDefaultPolicyVersion</code>을 통한 이전 버전으로 rollback 하는 기능을 이용하여 권한 상승이 가능합니다.</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li>공격자는 highly-limited IAM 사용자 부터 시작해서 이전 IAM 정책 버전을 검토하고 전체 관리자 권한을 허용하는 버전을 복원해서 권한 상승 취약점을 이용할 수 있습니다.</li>\n<li>IAM 사용자 <code class=\"language-text\">Raynor</code> security credentials</li>\n</ul>\n<h3 id=\"시나리오-환경-설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환경 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경 설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABW0lEQVQoz3WRW2+CQBSEERW0yEVuCiwXISqiSLVqg03VNH1u+t70T/T/J9PsMRpt0ofJkJPl25k9Qke1ISvWVdLNt6zYEET9fzU08kbTgNjqkws+m8Edjkl9KyFnYQHLSaEbERTVx4PqoacF6Gk+VD2gmaoz6P2Q5hcYd2G9OaGsXkj5fIe82OHx6YBpsUU2WWHgjQneVQaQOjakrgOp40DuuqS2bN8DeSLbzeAMzuIAw4opAf+BV6KDvN5fCSr5BUiVeZp5WWOxrDGdbcnXmyPKao9JvoHtpjDtBLoZ0SU9PYBmMGhGCMOM6Tku6ejiJKsQxnOwqEDAcvgsRxiXiJIK2XiFJF0iGpUEaUkWVbyIPwGf3QHjUQkWzQjoxYtzIseH63swTEap+BKabfO60Ws90bjbMAHr/RF1fcD29R3D0yeed2/4+Erx/aMiX2QQWw4l4cDbJLe6TfgLejXGYTnmHOMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/30ddf6e63a3311a4fd4e4c117945ae5d/37523/0.png\"\n        srcset=\"/static/30ddf6e63a3311a4fd4e4c117945ae5d/e9ff0/0.png 180w,\n/static/30ddf6e63a3311a4fd4e4c117945ae5d/f21e7/0.png 360w,\n/static/30ddf6e63a3311a4fd4e4c117945ae5d/37523/0.png 720w,\n/static/30ddf6e63a3311a4fd4e4c117945ae5d/302a4/0.png 1080w,\n/static/30ddf6e63a3311a4fd4e4c117945ae5d/46115/0.png 1290w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADDElEQVQoz22SS0xTQRSGDxTovbcXeWPpzL2FthYsUB6l0gIWkUeFermU8jBIQdSoiYlGExODITFQg2AEQQE1sEDR+FgBghJeGxJrjDFESIyJK13owrBQQxXpmCsBNi7+nMnMme/8M+eARqNjDclpBwwGYwYhBMxW+7ncfGH0YIX7oUOsfyQ4Gx47xIanQuWRp1Isr2yS1o9zbOXj5hxHnXQnQaNjMMY0xjgEOI6nk5KSExKTUjAAgNliv5qbX74sVjZ6BWfja1d1k1c46JoVxeo5QXDNOStq50Sxeibbss+bnpLaeOraJ9Dq01ikipOAckAIUQwTHBQexgZjTk0vzBLo65sEqfJnQgBgRl7s8Zvtnj+mYo/fVNi6ZrJ71kzuu8RUeZ1kJ5e2RUQChHDx+g0gxpjiOI7eUDytjlMztlQdY81zsgAQmH9+ObPmum/e3eObcPf4pmq7fFOHunyT9TdWnzs7VifNJ15qpLwEQw6zBcQY0QhxtDIygMq0RNEAMTRnjKZ1mhiKBgiOtl4OV9jux6rESYQqXqDQvYPRMfYnO1XZZ3coAIJ5bSqNkGrboW5PmUJ64v7eL0UFQ+Rd2zzxlg2T9/n9349L+7Xda6+ODayTpv71n03966sNt9Z/uG/5SUXn73Hp3w1ZdoZTa7eBBmsVO0YIlLZ+ddd2r5CR+W/k+MAKKb2y0rlACAjtv0YP9/o/1N/0v63r8S/W9fjf1HT7P9rbfEMAELArrZDheM020JhiZqSD02dmsvqa+4YHWzx3bl/qetB8YUqQHGLLxWjIGs5gi8Zs4aXP9wda7mUFWkcyY9OPhnERIEe8lkYIbXdZFaekNFoDDQBBEmBTACAboEAGKd16tnjCy7umlzjX9GJ81cwSVfBsDvQtKrsCgpRq4+YcbjYF0xJUq89gLLkOtrCghM2zOdjE5FwGxTKUcreDDcns4AOMHWowtqsD0jrj5aZ2TqW3KXBcFIUwT28BEUJyyeX/hKWIeYpXhspFANkxAFkDgOwkQGAJgIz7B+M28pA0KSjkL/EzBdFI93hyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"27.png\"\n        title=\"27.png\"\n        src=\"/static/52e6d27f45fc842ac420ddf38f505b82/37523/27.png\"\n        srcset=\"/static/52e6d27f45fc842ac420ddf38f505b82/e9ff0/27.png 180w,\n/static/52e6d27f45fc842ac420ddf38f505b82/f21e7/27.png 360w,\n/static/52e6d27f45fc842ac420ddf38f505b82/37523/27.png 720w,\n/static/52e6d27f45fc842ac420ddf38f505b82/302a4/27.png 1080w,\n/static/52e6d27f45fc842ac420ddf38f505b82/07a9c/27.png 1440w,\n/static/52e6d27f45fc842ac420ddf38f505b82/4435f/27.png 2479w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<ul>\n<li>IAM 사용자 “Raynor” 로 시작해서 공격자는 사용할 수 있는 권한이 몇 개 밖에 없습니다.</li>\n<li>공격자는 Raynor의 권한을 분석하고 SetDefaultPolicyVersion 권한을 확인합니다.</li>\n<li>이전의 버전을 기본값으로 설정하여 정책의 다른 4개 버전에 대한 액세스를 허용합니다.</li>\n<li>이전 정책 버전을 검토한 후 공격자는 특정 버전이 전체 관리자 권한 을 제공한는 것을 발견</li>\n<li>공격자는 전체 관리자 정책 버전을 복원하여 전체 관리자 권한과 원하는 악의적인 작업을 수행할 수 있는 능력을 얻습니다.</li>\n<li>마지막 단계로 공격자는 Raynor의 정책 버전을 원래 버전으로 되돌리도록 선택할 수 있습니다.</li>\n</ul>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"iam-user-raynor-사용-가능한-권한-열거\" style=\"position:relative;\"><a href=\"#iam-user-raynor-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-%EA%B6%8C%ED%95%9C-%EC%97%B4%EA%B1%B0\" aria-label=\"iam user raynor 사용 가능한 권한 열거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM User: Raynor 사용 가능한 권한 열거</h3>\n<ul>\n<li>클라우드 환경을 분석하던중 <code class=\"language-text\">raynor</code> 사용자의 AWS IAM config 파일을 확인할 수 있었습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXUlEQVQY023P23KaYBiF4V9NZ5pJSLQ2QYNEQESRPchWQBJNxwvoNPd/JW9HmsMePAfrYM33LaGvAhTV5mWxxbRirnllRVjbPUvdw3YyVCNEtXK+SwpCSAxGY4Y3k/8S603SFzXDJ4wbXL/q+WHNxs6IkhY7aNmGHc8zk/uHBbd3M8TgATF4/Ed8GY4Rad5SlB1p1lK3H7wfT9iX39j1L7qmoyhb6uaNY3emPZ4oioZ9WhFGKVFUkuQ+l88Jlz9PyIqMcLy8/8ILKtygYmPHGGufV32HvUtwvQzdcJjNV8gznecv8txgrpgo6hp1ueJVM3mcKAgvOJCXH/hRTZQcMa0Ebemg6z6Kuutn226B410PHpgrW378NHiSTe6kF4Y3U4YjuTf6NkVkRcehPpOkDWneURUdRnVhk59I4pJ91hLva4ryjbJ6pzqcqOoz156muyy0JX51j19KSOMpfwHjVq6An0EyNwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/0611d0f31dc52d59d423dd14d5d437d5/37523/1.png\"\n        srcset=\"/static/0611d0f31dc52d59d423dd14d5d437d5/e9ff0/1.png 180w,\n/static/0611d0f31dc52d59d423dd14d5d437d5/f21e7/1.png 360w,\n/static/0611d0f31dc52d59d423dd14d5d437d5/37523/1.png 720w,\n/static/0611d0f31dc52d59d423dd14d5d437d5/681f1/1.png 899w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 사용자의 <code class=\"language-text\">access_key_id</code>, <code class=\"language-text\">secret_key</code> AWS Credentials를 확인한 결과 유출된 값으로 AWS config Profile을 설정하여 해당 권한을 획득하기로 하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7UlEQVQY01XKy1KCYACAUUbSmcjiqmEJaDqCGHJL8QfSvE1uWvb+j/I10srF2R1pmZRcLaICf57zHhVk9YVEnCmrE9NZytAJcLyQVyfA9UJUbYjSfab7OEDpDjBtjb7zhGoaSFV9RJQH6s8z1ZX4Iv7+Zb77IU83RHHBar2lqk+I6sBG7AnmGX6QEoQpMz9jvbcQlwdmSwtpVRxZJjVpviOKK+Jsy0e+JQxXhJFgPEmwX3xGkxh3FDF0FxjWGKs/QTM8rP4b94qLJGn/evYU3fSaZFgjzN64iXLHRG4bDaml3mjd6TfkzpWG3Nb5A65McAfOu6LUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/10c08c750c23bc681293357cc96fcc8f/37523/2.png\"\n        srcset=\"/static/10c08c750c23bc681293357cc96fcc8f/e9ff0/2.png 180w,\n/static/10c08c750c23bc681293357cc96fcc8f/f21e7/2.png 360w,\n/static/10c08c750c23bc681293357cc96fcc8f/37523/2.png 720w,\n/static/10c08c750c23bc681293357cc96fcc8f/71c8e/2.png 875w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 자격 증명 정보들을 구성하여 하나의 <code class=\"language-text\">Fake AWS Credentials</code> 를 구축하였습니다.</li>\n<li>IAM 보안 정책 그룹을 확인하기 전에 Security Credentials 을 갖고 있는 계정 정보와 IAM 사용자 액세스를 확인하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws sts get-caller-identity</code></pre></div>\n<ul>\n<li>다음 명령은 ARN을 포함하여 총 3 가지 정보를 출력합니다.</li>\n<li>AWS IAM Format를 확인한 결과 해당 Arn 정보를 통해서 Access Account ID , IAM Username 정보를 확인할 수 있었습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVQY02XQ22rCUBCF4a3QGhOzkzQeUuOBGk12jppEa6EIUkqvSkvf/2H+thFE8eJjhllzMyPWmz2R2pBmW9K0Ilq/YG4/WCwzsnxHqNbESUUYFazCotmN4hMVV6gk5/hlcfyWPEV9RKhqorhmGZaU9YGiOhAUrwSrDd44pD98wrR8NH3Y6P4zRhcG9BwT6dpohoPwpwmTWcKjr1DpHpXsWAYF3jjCtCYNQ/r0pI/lzDDMMaY9QdrThuXMkXKBEA8IYSPyYsciSFFJRRQWLOIao3wnWOWouGyyOK2as1VSNrV5T1aT5c9kRcnbj8vhUzJfuQi9512doxkebd3jXuujdYfcddxz3ukOzv3JCE0fYFgWPdumozsI0ZKItnWl1b6c2Tf5DeGc/O3+AgvJnEh5Lm3fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/e2bc2d95989beddca5255cb4048493a3/37523/3.png\"\n        srcset=\"/static/e2bc2d95989beddca5255cb4048493a3/e9ff0/3.png 180w,\n/static/e2bc2d95989beddca5255cb4048493a3/f21e7/3.png 360w,\n/static/e2bc2d95989beddca5255cb4048493a3/37523/3.png 720w,\n/static/e2bc2d95989beddca5255cb4048493a3/d9217/3.png 904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token string\">\"Arn\"</span><span class=\"token builtin class-name\">:</span> \n\t<span class=\"token string\">\"arn:aws:iam::&lt;USERID>:user\n\traynor-iam_privesc_by_rollback_cgidesxwoc66a4\"</span></code></pre></div>\n<ul>\n<li>IAM Credentials 에 대한 보안적 요소들을 평가할 때 정책 및 권한에 대해 리스트하여 나열하는 것은 필수적인 단게입니다.</li>\n<li>username은 생각보다 긴 <code class=\"language-text\">raynor-iam_privesc_by_rollback_cgidesxwoc66a4</code> format을 이루고 있었습니다.</li>\n<li>다음 명령을 사용하여 IAM 사용자 <code class=\"language-text\">Raynor</code> 의 Inline Policy, management policy를 각각 열거해보겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam list-user-policies --user-name raynor-iam_privesc_by_rollback_cgidesxwoc66a4 --profi\nle bob1\n\n-<span class=\"token operator\">></span> list-user-policies 명령은 해당 유저 네임에 대한 IAM 사용자에게 연결된 정책들을 나열합니다.\n\naws iam list-attached-user-policies --user-name raynor-iam_privesc_by_rollback_cgidesxwoc66a\n<span class=\"token number\">4</span> --profile bob1\n\n-<span class=\"token operator\">></span> 관리형 정책들 을 나열합니다.</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQY012P6U7CUBBGL4Ispbe0FOi+uhUMAqUWUSTxAUh8ABPf/ymO6TUR4o+T882XySQjnlY76t2RbXWgrA7s6wPp+4mk+qBc1zzMN6w3L2yrN9blXrmh3L5SPR+p9ztOXz6f3zHpXYyYOjlJtiTNl4wnGUPp0dc9uprDQHO47k3oazPFYOhc4Co03cWwXKTp0BtMEaI1QjcCZu4t2c0KLyiQRoA1TjDHMaZygmWnGGZ47uxz1+7Yik7XRhhmhD3LCeMFxaLGnmaKIJrj+vfKzQdR8ogfzRXNbtP7YYEXFljqeIIchYi+5qjQvNZqmwghES0DIfTfrKxfzPJfloir0R8/Gr+BUVwzdE0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/9f3e2d5bc88f996fbcffba9b2a292381/37523/4.png\"\n        srcset=\"/static/9f3e2d5bc88f996fbcffba9b2a292381/e9ff0/4.png 180w,\n/static/9f3e2d5bc88f996fbcffba9b2a292381/f21e7/4.png 360w,\n/static/9f3e2d5bc88f996fbcffba9b2a292381/37523/4.png 720w,\n/static/9f3e2d5bc88f996fbcffba9b2a292381/636c2/4.png 911w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Customer managed policies 에 연결되어 고객 관리형 정책은 사용자가 생성하고 AWS 계정의 여러 사용자, 그룹 또는 역활에 연결할 수 있는 독립형 자격 증명 기반 정책으로 이루워집니다.</li>\n<li><code class=\"language-text\">cg-raynor-policy</code> 는 IAM 사용자 “cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4” 에 직접 연결됩니다.</li>\n</ul>\n<h3 id=\"raynor-이전-버전의-iam-policies\" style=\"position:relative;\"><a href=\"#raynor-%EC%9D%B4%EC%A0%84-%EB%B2%84%EC%A0%84%EC%9D%98-iam-policies\" aria-label=\"raynor 이전 버전의 iam policies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Raynor 이전 버전의 IAM policies</h3>\n<ul>\n<li>Customer managed policies에서 IAM을 <code class=\"language-text\">list-policies</code>를 통해 관리형 정책들을 나열하고 <code class=\"language-text\">--only attachged</code> 옵션을 통해 연결된 정책만 추출하고 <code class=\"language-text\">--scope</code> 범위를 Local로 지정하여 해당 범위 내에서만 검색하여 고객 관리형 정책만 추출하고 <code class=\"language-text\">--query</code> 옵션을 통해 관련된 정보를 추출하는데 사용하여 좀더 세부적으로 정책들을 나열하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam list-policies <span class=\"token punctuation\">\\</span> \n--only-attached <span class=\"token punctuation\">\\</span> \n--scope Local <span class=\"token punctuation\">\\</span>\n--query <span class=\"token string\">\"Policies[?starts_with(PolicyName, 'cg')]\"</span> <span class=\"token punctuation\">\\</span>\n--profile bob1</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQoz42RyVLCQBCGhwgihGyEJSSEnZiQBYPgvpblQTn5CD6C73/4rBlLL1ZZHr7p6Z5/uubvEe/Fno/ijVW6pTy94Wx3S3a3JyhuiJYFx0lJFJfEyYYk3bKM1sSrjSIrLliXW25fQ55eZmT+HOFYIbYxxLBDLGeEbga47RFGa4BWc6nVO9SOumi1tooqr3epN3oqCmEghP1FxUKIiqmEi2jDbHHCeJqTFlfk62u2Z48k6TmeHykGwfEPQZiommEFmM4XjWYfYbtjdTCa5vS8JT1vgWmHmPaQlukrdGOAbvg0WwOaLY+G7v3sZV1qJQ29jxCazeFRlzS/JCsuSfML/GGM05koW5UDaUdHOhGa9RtZ/0bmcpEXT3cPnF89EyXyc+6JVzsms4L5smQ0yageuqq5VnX+RMghyxd2ejOFtON2p7Q7E2VdjkAixf9p+Ak7/bJOsC7olgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/0c7e2fe9b8e074143c47f00bdac78f03/37523/5.png\"\n        srcset=\"/static/0c7e2fe9b8e074143c47f00bdac78f03/e9ff0/5.png 180w,\n/static/0c7e2fe9b8e074143c47f00bdac78f03/f21e7/5.png 360w,\n/static/0c7e2fe9b8e074143c47f00bdac78f03/37523/5.png 720w,\n/static/0c7e2fe9b8e074143c47f00bdac78f03/6029f/5.png 906w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Customer managed policies에 대한 <code class=\"language-text\">cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4</code> 추가 정보를 확인할 수가 있으며 기본 버전 값은 <code class=\"language-text\">v1</code> 임을 인지할 수 있었습니다.</li>\n<li>aws 정책에 따라 IAM Customer managed policies을 변경하고 AWS가 정책을 변경할 때 젼경된 정책은 기존 정책을 덮어쓰지 않씁니다.</li>\n<li>대신 IAM은 관리형 정책의 새로운 버전을 생성합니다. 총 IAM은 Customer Managed Policies를 최대 5개 버전을 저장합니다.</li>\n<li>정책에 대한 권한에 대한 충분한 정책 세부 정보들을 해당 <code class=\"language-text\">v1</code> 버전에 맞게 정책 권한들을 나열하였습니다. 해당 형태의 format은 <code class=\"language-text\">json</code> 에 따릅니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam get-policy-version <span class=\"token punctuation\">\\</span>\n--policy-arn arn:aws:iam::<span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span>:policy/cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4 <span class=\"token punctuation\">\\</span> \n--version-id <span class=\"token string\">\"v1\"</span> <span class=\"token punctuation\">\\</span> \n--profile bob1 <span class=\"token punctuation\">\\</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeklEQVQoz41SyVLCQBCdsAcC2QlJCDuJgBQGEmRVD0qVB0/6/7/yrG7A4oAUh1c9Mz39+vUiJtMUy9UrZk8rbHbvWD3vMX37QnvziWWyxSxeI15skC5fME+22O0/sH89IEn3iOdbxIs1Dj8eDt8+OqEPYdpdNFtjBJ1HBO0JGl6IemMIy+mDfFa9z6CzYXXguENGVW2irLioVF3IigO50kChZEEISUWp7GAYLTCLd7DqPVSqHr8JqQYhZAhRgRDlkyUoR19GBcWzzaiQMhpEJqezM1cwWWnDj6CbHUZNC1DTAyg1H6oe8L0o10Ex/0FIWY0PZCmzYXURjhIMwhi62WaiqupDM+jcYsJzzE3CM+je7k4xnq7geCE0o8X9I5VCHMs8/7tKeOkk6wcjeMEIpt3jsq8F3qUwX7T+LE2MenrMeGr4RdKbPaTPNO5olGIQzlkhlUgDKJRs7llRtu8iY0JSQqq85gNPmdbG9SPeR9o12xnwWzZv3EX4C9Iu8mGzsK70AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/7c5d6204f9ea499ca8b0a14a8312e28e/37523/6.png\"\n        srcset=\"/static/7c5d6204f9ea499ca8b0a14a8312e28e/e9ff0/6.png 180w,\n/static/7c5d6204f9ea499ca8b0a14a8312e28e/f21e7/6.png 360w,\n/static/7c5d6204f9ea499ca8b0a14a8312e28e/37523/6.png 720w,\n/static/7c5d6204f9ea499ca8b0a14a8312e28e/58213/6.png 902w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Policies Document에 따르면 정책이 있는 IAM credential이 모든 리소스에 대해 IAM 에 대한 import, list 작업을 수행할 수 있었음을 보여드렸습니다.</li>\n<li>해당 정책은 또한 <code class=\"language-text\">\"iam:SetDefaultPolicyVersion</code> 모든 리소스에 대해 하나의 “Setting” 작업이 허용되었다는 것을 보여주고 있습니다.</li>\n<li>해당 권한들의 리스트들은 정상적으로 보이고 많은 보안 스캐너에 의해 플래그가 지정되지 않을 수도 있지만 “iam:SetDefaultPolicyVersion” 허용된다는 점이 심각한 보안 문제를 야기할 수 있습니다.</li>\n</ul>\n<h3 id=\"iamsetdefaultpolicyversion-권한이-왜-보안-문제일까\" style=\"position:relative;\"><a href=\"#iamsetdefaultpolicyversion-%EA%B6%8C%ED%95%9C%EC%9D%B4-%EC%99%9C-%EB%B3%B4%EC%95%88-%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C\" aria-label=\"iamsetdefaultpolicyversion 권한이 왜 보안 문제일까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>iam:SetDefaultPolicyVersion 권한이 왜 보안 문제일까?</h3>\n<ul>\n<li>\n<p><code class=\"language-text\">SetDefualtPolicyVersion</code> 은 지정된 정책의 지정된 버전을 정책의 default 버전으로 설정합니다. 해당 작업은 정책이 연결된 모든 사용자 구룹, 역활에 영향을 줍니다.</p>\n</li>\n<li>\n<p>해당 권한이 있는 IAM Access Credential은 현재 사용하지 않는 기존 정책 버전을 통해 권한을 승격할 수 있습니다.</p>\n</li>\n<li>\n<p>액세스 권한이 있는 정책에 기본값이 아닌 버전이 있는 경우 기본 버전을 다른 기존 버전으로 변경할 수가 있습니다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">iam:SetDefaultPolicyVersion</code> 설정이 어떻게 보안 문제로 이어져있는지 확인하기 위해 다른 버전의 고객 관리 정책이 있는지 확인을 해야 합니다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4</code>  최대 5가지 버전이 존재합니다.</p>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVQY0z3Fy1KCUACA4SOZVlN5ZUJBEU0QBEKUywEkxhldtmvRvk3v/wB/M9W0+OYTSVqRy4Y0KymKI5UsCOoLk+aNdJ+QpDm73QEpS/K8QBYV1fGVsqyp64aqPHG6JHx8qbx/ThDL5wh95jEYmZiWj6bb6LqNqa8xTI+J7rBYhjwZHuPpBqU9QIgHhPKIUHq/t/oIoSLEGOG4CaYVMF/45MWZbSgJo4oorokPDe424yWuseMzxmrPdVelc6PS7oxoXfX/CeXPah2xsHyMuUt8qHG9hE0gmTkJfpBhu3v8UOJ4CZ6fYa1CtOma/nBG91b9cXc/Zqj1GGk9vgHvh3I7RtlAfAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/456359012ed7b3ac5c682cb55fc169fe/37523/7.png\"\n        srcset=\"/static/456359012ed7b3ac5c682cb55fc169fe/e9ff0/7.png 180w,\n/static/456359012ed7b3ac5c682cb55fc169fe/f21e7/7.png 360w,\n/static/456359012ed7b3ac5c682cb55fc169fe/37523/7.png 720w,\n/static/456359012ed7b3ac5c682cb55fc169fe/79e48/7.png 865w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>assets 폴더안에는 각 버전별로 존재하고 있는 것을 확인할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVQ4y52SSU/CUBSFy1AoMnRuKXSmIFIG3TBLwKjRDUu3mhA3rtz5H/zTx9yHTcDEpLA4OX29571+vfdx2+0Ldh9rvH+N8Pn2gO/FK543O0S3T1gvNxhPVpgvNlje3jMnLZZ3mM3XWK0fMZ6ucH0zZe+jzhCcUW+jN+yjPQhhWza8cghLsCDJDkTFg6R4kFUfihZA1UPm5WoTNclhtVLZQiYngy/qyPEqOC4rgi8YEKUQZqOLiuairLgoCBRQQPVMTmTOZWp7ZQ/WrC6xDDmXzcsgaUaAeDBF2BrBCwbwwyEsuwtF82FabUiKyzYk+f/EUYgvaqjUmr8bPVRFmxHyRZVRkiic6sDkQTdb6A2mCFojuH5/T9i8hKx6MOoRRNllv5easCo2UW902AHU8GLJQL6wJ0z8JELNaOEqnjCyY0L/XEIbDTaE4IiQQkkfTyQM0Y3HbMKOF/8hbJ9GSBMlKiJU9QCi7EC4MM/vIQVpyvFwhiDa30Oatm5GBz100hEWBI0RJl9PnKhI1N/kTqYh/AHimDxglXPKeQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/eb2917ca2595825d68aa5aa706911599/37523/8.png\"\n        srcset=\"/static/eb2917ca2595825d68aa5aa706911599/e9ff0/8.png 180w,\n/static/eb2917ca2595825d68aa5aa706911599/f21e7/8.png 360w,\n/static/eb2917ca2595825d68aa5aa706911599/37523/8.png 720w,\n/static/eb2917ca2595825d68aa5aa706911599/65d79/8.png 905w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>5가지 정책 버전이 <code class=\"language-text\">cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4</code> 에 있습니다.</li>\n<li>자 그러면<code class=\"language-text\">raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4</code>  사용자 <code class=\"language-text\">iam:SetDefaultPolicyVersion</code> 에게 기본 버전 v1에 대한 권한이 있으므로 사용자는 모든 버전으로 롤백이 가능합니다.</li>\n<li>이러한 버전에 추가 권한이 있는 경우 권한 상승이 가능하고 추가 권한에 따라 각각 다르게 나타납니다.</li>\n<li>각 정책 버전을 나열하고 추가 권한에 대한 액세스 권한을 얻을 수 있는지 확인해보겠습니다.</li>\n</ul>\n<h3 id=\"취약한-정책-버전\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%ED%95%9C-%EC%A0%95%EC%B1%85-%EB%B2%84%EC%A0%84\" aria-label=\"취약한 정책 버전 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약한 정책 버전</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam get-policy-version --policy-arn arn:aws:iam::<span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span>:policy\n/cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4 --version-id <span class=\"token string\">\"v4\"</span> --profile bob1</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLUlEQVQoz42R3U7CQBCFFxD56bbdUpGfllJSGpGo0FYKtEF6Y/QN9I7EB/D9746ZKYp3cPHtbHbOnN3ZEbvdOz4Pexy+p/j4irFe5Qi2bwjXr8i2BaIkx3P6gmWc8T6K8zIeSdd7pJsCT8sNBk4IYagRRv4M09kcrh/CtDxI2YfUB6Ccbrp8RvuW1odmOGjLAZrtHkN5onJlQdQUhKiaaLRuEUxjREmBbi+AZfssqpKoYpyomqf4yzFXqalSXy4mavUOVMfD0L2H3Z1AGkNcN7ssuhxVGpI7QTdNggXCu4SNqVW67L/mnKkgUb1xw21TZGOhQwhZRmpJGH8F50wFFWj6EMmqwMMiQxBG8CaPcLw5/6Nlj6E648tfSK8idNNhA5okT065PE1pOMylhj/mTsKpNHHf5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/cfb0bf407cddc42a96a750caa66dd198/37523/9.png\"\n        srcset=\"/static/cfb0bf407cddc42a96a750caa66dd198/e9ff0/9.png 180w,\n/static/cfb0bf407cddc42a96a750caa66dd198/f21e7/9.png 360w,\n/static/cfb0bf407cddc42a96a750caa66dd198/37523/9.png 720w,\n/static/cfb0bf407cddc42a96a750caa66dd198/0955e/9.png 901w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>정책 버전 4에는 심각한 취약점이 존재합니다.</li>\n<li>v4의 권한은 사용자에게 AWS 계정에 대한 관리 액세스 권한에대해 <code class=\"language-text\">Effect: Allow</code> 를 부여하고 있습니다.</li>\n<li>Highly-level iam 사용자로부터 v4 를 기본 버전으로 만들어보겠습니다. v4를 기본버전으로 만들어서 관리자 액세스 권한이 있는 사용자가 되도록 Escalation을 진행하는 것 입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam <span class=\"token punctuation\">\\</span>\n set-default-policy-version <span class=\"token punctuation\">\\</span> \n--policy-arn arn:aws:iam::<span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span>:policy/cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4 <span class=\"token punctuation\">\\</span> \n--version-id v4 --profile bob1</code></pre></div>\n<ul>\n<li><code class=\"language-text\">pacu</code> open source tools 를 이용하여 IAM enumerating을 하여 추가 사용 권한을 획득하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">run iam__enum_permissions</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQoz2VRaW+CQBBdj9pYRWBB5D7kFKUtFXokTez//1OvmRG0ST+87OzAO3ZG2F6JoupQHnpGlDTYZ68oDx3y8owgOsJycjytHcwXEkIoEJPNFVP1Xo/3JH3BsfnCuf9B211Q1e+I9g3a8wXP7TeOzSey4o3Fs6JlA+Ls2MSGovpYb1xsNB/LlQ3h+BVMK4XjlQzT2nMa2y2YRD3LzuB4FTQZDuTgJqTq15q+EU9IM8Z2l4KERxE/rOGFNZ+PS4tB7tO5/v+JYy2GO6nTE4gcxCd4wQFym3AyMtBkBGObQDcikLm5SzkApSbMFwYmM43N2NCyc9SnD55dVfcsTosZFyLNhBMSafYgb8S/GPv0j3D9irdMSIsW4ZCS+iRGoES6GXNNs1opLqejWlE9fgHNjwR/ASBjs6IbPz8qAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/7058281f09060b29aab79cbe993142e2/37523/10.png\"\n        srcset=\"/static/7058281f09060b29aab79cbe993142e2/e9ff0/10.png 180w,\n/static/7058281f09060b29aab79cbe993142e2/f21e7/10.png 360w,\n/static/7058281f09060b29aab79cbe993142e2/37523/10.png 720w,\n/static/7058281f09060b29aab79cbe993142e2/1cfc2/10.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>위 단계에서 차례대로 취약한 버전 정보를 도출하였고 해당 정책으로 부터 권한 상승이 가능하지 <code class=\"language-text\">pacu</code> 도구를 사용하여 <code class=\"language-text\">iam__enum_permissions</code> 모듈을 사용하여 권한 상승을 성공적으로 수행하였습니다.</li>\n<li>현재 이미 admin 권한을 획득한 것을 확인할 수 있습니다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">시나리오 환경 설정</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">Exploit 흐름도</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#iam-user-raynor-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-%EA%B6%8C%ED%95%9C-%EC%97%B4%EA%B1%B0\">IAM User: Raynor 사용 가능한 권한 열거</a></li>\n<li><a href=\"#raynor-%EC%9D%B4%EC%A0%84-%EB%B2%84%EC%A0%84%EC%9D%98-iam-policies\">Raynor 이전 버전의 IAM policies</a></li>\n<li><a href=\"#iamsetdefaultpolicyversion-%EA%B6%8C%ED%95%9C%EC%9D%B4-%EC%99%9C-%EB%B3%B4%EC%95%88-%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C\">iam:SetDefaultPolicyVersion 권한이 왜 보안 문제일까?</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%ED%95%9C-%EC%A0%95%EC%B1%85-%EB%B2%84%EC%A0%84\">취약한 정책 버전</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 2 (CloudGoat: IAM Privilege Escalation By Rollback)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-2/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/cloud-service-vuln-1/","nextSlug":"/cloud-service-vuln-0/","prevSlug":"/cloud-service-vuln-2/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}