{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/angr-3_theori/",
    "result": {"data":{"cur":{"id":"a1cbd834-e57e-573a-b4e3-0cc76df63a00","html":"<h1 id=\"angr-fauxware-문제-풀이\" style=\"position:relative;\"><a href=\"#angr-fauxware-%EB%AC%B8%EC%A0%9C-%ED%92%80%EC%9D%B4\" aria-label=\"angr fauxware 문제 풀이 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr fauxware 문제 풀이</h1>\n<blockquote>\n<p>문제 바이너리 <a href=\"https://github.com/dnsdudrla97/angr-doc/tree/master/examples/fauxware-SOLVED\">dnsdudrla97/angr-doc</a></p>\n</blockquote>\n<h2 id=\"data-섹션\" style=\"position:relative;\"><a href=\"#data-%EC%84%B9%EC%85%98\" aria-label=\"data 섹션 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>data 섹션</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwklEQVQY04WQS04EMQwF+/6XYsOCBScARp0oETOT6Tj9IY5t3DFiWNKC0tuWVHoDwFuMT8495Pxid0ppKGxm3br9yQAwxvg8jo/TdCLS3jsUBFx0V/uPIedbCG4cX1O6bhup7lOuPr+jICmRkuzMyrLL75ABAGKMzvmUJkRW/SSSKvXHXCvNGy8fPG+y9yM5hOCcS+l2PkMp87yspRXkZmbCRu179xMOsnMIwXt3uSTvV0SG0tI2VUbtymSIVquJHMhfOjlaX8ldqggAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/63bed866b810e70ccbaebabeca81a892/37523/0.png\"\n        srcset=\"/static/63bed866b810e70ccbaebabeca81a892/e9ff0/0.png 180w,\n/static/63bed866b810e70ccbaebabeca81a892/f21e7/0.png 360w,\n/static/63bed866b810e70ccbaebabeca81a892/37523/0.png 720w,\n/static/63bed866b810e70ccbaebabeca81a892/d9217/0.png 904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"authenticate-함수\" style=\"position:relative;\"><a href=\"#authenticate-%ED%95%A8%EC%88%98\" aria-label=\"authenticate 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>authenticate 함수</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTUlEQVQ4y2WNh24cORBE5/+/zJYBG5bP3tVKGyZHpklMTdZh5L1Z2Qc8NArNV80kADsUAYDxWSndd0ta8HHSnBnGOT5oOwlF7PiwlQc+M77WteXCAdA6CCni+2kK8aOfuIiPECDFVKR1eilfX/NzWvWsr3nvAAf4P+XERjwArCe36m06ZwN9/v7reG3lKuU0LevKpNAUdj/RAQ8itA/aujXeN0XJi0JKsYzLpLVvWj47b/57TZaABxGLo8W4LQTMFMtGCaGrRlGkZUFeqsn73U9mwoOA2dKs3RYIE6GopBTumstBKABCKWn8+92NZCQ8CBgtjdptgaB8LGullM4Lwcfx98/C+inc/UQRHgQoS0q7LRCkR1FLwW1Zrp5IazSd4taP4e4n3OMBgRviq9uCB3PIazkqk2ay5cITBqk64wXd/YR57HACs4Fpz+h9Q8gqKaXLMu1siIRByM54Tnc/6R12GhvbxXVqbV0cXGwczkV3ecuOL/nzW3bMi9eqagz1/u4n7XtniPiRNU9fr3UjBGNyWj59+/n0PW2bgQ1DL9Tn58OXH7dWyIaJ2oTWoXVImq2MjnBh8znvjml/uA2HS/f1WJ5L9vPSv5X8cG1eblVVyaIUt6apTNhaDkll8ZvaofIoLW4z0gXfLt3TST6f9amaz9JdRzp2yytbrqPeK0lhccfcQ+WQmfDPKS8LbrRBMG+9KP12esNhryS5xV8UBreVikYvE7TGOodTJ3OH3CAz29zNJDX4PzcdXnJ5OA2HV3Y6d78anjmkOv6l/QueiALTr0N3XgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/37523/1.png\"\n        srcset=\"/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/e9ff0/1.png 180w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/f21e7/1.png 360w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/37523/1.png 720w,\n/static/a2c4ac8e1d4d49b3b9f1dc5a5d6df1ee/66caf/1.png 853w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">sneaky</code> 전역 변수가 가리키고 있는 문자열 과 유저 이름을 <code class=\"language-text\">strcmp</code> 함수를 바탕으로 비교를 통해 같으면 1을 반환하고 아닐시 유저 이름에 해당 하는 파일 이름을 <code class=\"language-text\">open</code> 함수를 바탕으로 읽고 해당 값과 유저 패스워드와 비교하여 같으면 1을 반환 아니면 0을 반환한다.</li>\n<li>우리가 피해야할 주소 값은 <code class=\"language-text\">0x4006E6</code> 임을 알 수있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 685px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.444444444444445%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZ0lEQVQI133L0QpAMBQGYC8iT+YBvKWiqClxpRT3amYzxs7+M2/gu/+SccibJhMiXdbCmLhtJ8D3TUSw9vXBxxg9/O52/WjzGuXU4Q79aDCSvu/qumzbap4na0nKS0oXApiZCGD85A9WaG2wheyAFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/8c2acbdbc9b4c5725b0627966d9cffc1/8ce22/2.png\"\n        srcset=\"/static/8c2acbdbc9b4c5725b0627966d9cffc1/e9ff0/2.png 180w,\n/static/8c2acbdbc9b4c5725b0627966d9cffc1/f21e7/2.png 360w,\n/static/8c2acbdbc9b4c5725b0627966d9cffc1/8ce22/2.png 685w\"\n        sizes=\"(max-width: 685px) 100vw, 685px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"접근해야-하는-위치\" style=\"position:relative;\"><a href=\"#%EC%A0%91%EA%B7%BC%ED%95%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9C%84%EC%B9%98\" aria-label=\"접근해야 하는 위치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>접근해야 하는 위치</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzklEQVQY042MQW6DMBBFuf+BEOxokKVaDRIsuAALFCUhNrIZbMszv6Is2u7y9PUWI70pLpdLVVVKqdfLEu0x7sbsy0LGRGYAyJKP8TH8p9BaN83H9fp1u23zjJTEWtzv2DaIABAXnQ32tPycfuOu65RSfd8T7czIGcaQ9/H59ERJRIQFAgiEhf9wxE3TlGWplCLazn/zvFobpomcizlzSimEcDrGmFI6fcTDMGitx3G0NjgH7zFN6fFgvEHRtm1d11p/LgutK5jFe4TwTotvrAVUuy6lDyYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/39223845b13477da25018ca3ed3d5330/37523/3.png\"\n        srcset=\"/static/39223845b13477da25018ca3ed3d5330/e9ff0/3.png 180w,\n/static/39223845b13477da25018ca3ed3d5330/f21e7/3.png 360w,\n/static/39223845b13477da25018ca3ed3d5330/37523/3.png 720w,\n/static/39223845b13477da25018ca3ed3d5330/a1792/3.png 780w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>기본적으로 앞에서 <code class=\"language-text\">authenticate</code> 함수에서 반환된 값이 1 일 경우 <code class=\"language-text\">accepted</code> 함수를 호출하게 된다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVQI14XJuQrCQBRA0fz/N1jaiYVYmkYxQUgMRBDUgCEYFIbgIA6zvHmLaGEleMp7k7Y9l2Wd59vd7qA1KyUArDUaQzGSiACCjdajt2CJ3+UraZrLOpuk6agopiLv5xwMg1HK9f0zBCQi8ICAEWL4AIAQAjMnbXsty1mWjet6TkSI4hzebvbxQO9JhJmZiPiX5HQ6rlabxWJZVfv7XYZBjOGuoxjlrxeSdOG4uMhfzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/3847c841642582560fe24c2a75fe09a0/37523/4.png\"\n        srcset=\"/static/3847c841642582560fe24c2a75fe09a0/e9ff0/4.png 180w,\n/static/3847c841642582560fe24c2a75fe09a0/f21e7/4.png 360w,\n/static/3847c841642582560fe24c2a75fe09a0/37523/4.png 720w,\n/static/3847c841642582560fe24c2a75fe09a0/cda19/4.png 785w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"angr-solve-1\" style=\"position:relative;\"><a href=\"#angr-solve-1\" aria-label=\"angr solve 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr solve 1</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">solve2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    state<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sm<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n    sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x4006F6</span><span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x4007CE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4006E6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQY012NW27DIBBFvRCGkkRKAswAw8OY2I6duKq6/xVVdtWfSkf3Y3TPnS5/bXV5p2HKw3RJURQPlaEPorJK4SMHKF5mDyXIEmQOMnrJDkqA6Lv8ftfXn5z/yyozZL9r0UPP+1B0kg+C6/Jj7sclDmM6ZMhurxYPfTixV/n4lg6/sixeNoaB4ZFk5U4vk/l86nW026yGLCyCc+BIeJJIQCQcAe4pnBNIwqAg2kHs6rb22xbnZ1peuoVb1XrEe8Nrc2ZA00hPdKuIM+JK9ESarR7p2uhesXt8L2V78bryurjWsJZ7ZoVGkT3jzomsQnt25uyOJPN7OaH9AfTHQVHc0WPgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/e6a557b26bee82d8f1a1c2799889acd9/37523/5.png\"\n        srcset=\"/static/e6a557b26bee82d8f1a1c2799889acd9/e9ff0/5.png 180w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/f21e7/5.png 360w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/37523/5.png 720w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/302a4/5.png 1080w,\n/static/e6a557b26bee82d8f1a1c2799889acd9/76a99/5.png 1117w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"angr-sovle-2\" style=\"position:relative;\"><a href=\"#angr-sovle-2\" aria-label=\"angr sovle 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>angr sovle 2</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">solve1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n    sm<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>until <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> sm_<span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sm_<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    input_0 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    input_1 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    r <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_0<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_1<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvklEQVQI1x2O4WrDMAyE8x6b5HQbKyOyJdmynSxbk9SUwmB7/8cZLtyP44OPu+Hy92v3NreWlu+y7udskBmrYlGs6kxekp6SjonRGLNAFtCA7FH80OXjmLdrmr/qcjmbPReBGqEoVHVZTkk6yYLGUBWKYBXMgkUG+7mHeZHPlerMy/qa9CkQiEcNqMFxGJnxMQUxgAnGzrEfkSHernxscju4bdL2j319z/Zm0QWPgRzROBEG74jQT0jUMz2Kp3+5BiwsIZClpwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/12139aab9feafe745ed586ce0870bdee/37523/6.png\"\n        srcset=\"/static/12139aab9feafe745ed586ce0870bdee/e9ff0/6.png 180w,\n/static/12139aab9feafe745ed586ce0870bdee/f21e7/6.png 360w,\n/static/12139aab9feafe745ed586ce0870bdee/37523/6.png 720w,\n/static/12139aab9feafe745ed586ce0870bdee/2e694/6.png 1048w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n<span class=\"token keyword\">import</span> sys\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">bse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 먼저 바이너리를 Angr 프로젝트에 로드 한다.</span>\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># entry_state 프로그램의 진입점에서 가능한 프로그램 상태를 매우 일반적인 표현인 SimState로 생성한다.</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># SimulationManager는 단지 그것들을 관리하기 위한 많은 편리한 인터페이스가 부착된</span>\n    <span class=\"token comment\"># 다양한 태그를 가진 상태들의 모음이다</span>\n    sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 실행 시작-> 두 가지 모두 만족할만한 분기 문에 도달할 때 까지 </span>\n    <span class=\"token comment\"># 프로그램을 실행 한다. 현재 active 주소 값이 1 보다 클때 까지</span>\n    sm<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>until <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> sm_<span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sm_<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 입력 조건</span>\n    input_0 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    input_1 <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>active<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n    r <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n    \n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_0<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>input_1<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    bse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#data-%EC%84%B9%EC%85%98\">data 섹션</a></li>\n<li><a href=\"#authenticate-%ED%95%A8%EC%88%98\">authenticate 함수</a></li>\n<li><a href=\"#%EC%A0%91%EA%B7%BC%ED%95%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9C%84%EC%B9%98\">접근해야 하는 위치</a></li>\n<li><a href=\"#angr-solve-1\">angr solve 1</a></li>\n<li><a href=\"#angr-sovle-2\">angr sovle 2</a></li>\n</ul>\n</div>","excerpt":"angr fauxware 문제 풀이 문제 바이너리 dnsdudrla97/angr-doc data 섹션  authenticate 함수   전역 변수가 가리키고 있는 문자열 과 유저 이름을  함수를 바탕으로 비교를 통해 같으면 1을 반환하고 아닐시 유저 이름에 해당 하는 파일 이름을  함수를 바탕으로 읽고 해당 값과 유저 패스워드와 비교하여 같으면 1을 반환 아니면 0을 반환한다. 우리가 피해야할 주소 값은  임을 알 수있다.  접근해야 하는 위치  기본적으로 앞에서  함수에서 반환된 값이 1 일 경우  함수를 호출하게 된다.  angr solve 1  angr sovle 2  data 섹션 authenticate 함수 접근해야 하는 위치 angr solve 1 angr sovle 2","frontmatter":{"date":"August 14, 2020","title":"angr 바이너리 분석 활용 방안 3","categories":"analyzing binaries","author":"Zer0Luck","emoji":"🤬"},"fields":{"slug":"/angr-3_theori/"}},"next":{"id":"63ac0101-7bca-525d-8b12-a5fa8beb3168","html":"<h2 id=\"바이너리-정보\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\" aria-label=\"바이너리 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 정보</h2>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">RedVelvet<span class=\"token operator\">:</span>\nELF <span class=\"token number\">64</span><span class=\"token operator\">-</span>bit LSB executable\nx86<span class=\"token operator\">-</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> version <span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>SYSV<span class=\"token punctuation\">)</span>\ndynamically linked\ninterpreter <span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> GNU<span class=\"token operator\">/</span>Linux <span class=\"token number\">2.6</span><span class=\"token number\">.32</span>\nBuildID<span class=\"token punctuation\">[</span>sha1<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">84e7</span>ef91c33878cf9eefc00a7a450895aa573494\nnot stripped</code></pre></div>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><strong>Undefined (U) → Create String (a) → WOW String</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 677px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAk0lEQVQI12XLPQ7CMAxA4R6EFYlbsSOuxwUoahWo+BlYWRBChcpp08Y4cVwjBgbEN7ztZet8kW+W290cwCAqUWQWxBjjpymJqo4jMSPzK4RBhPUrM2ZqzOx4mli7GgYlCkTJuYA+3R5QN67vA4BtW8uMIbifuSj2ZXmoqjNApyoi3La+aXoL/nK9188OPSMykeifNzKJpfShfZMoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/faeddf00b84fc7dca712f378372376f7/68de2/0.png\"\n        srcset=\"/static/faeddf00b84fc7dca712f378372376f7/e9ff0/0.png 180w,\n/static/faeddf00b84fc7dca712f378372376f7/f21e7/0.png 360w,\n/static/faeddf00b84fc7dca712f378372376f7/68de2/0.png 677w\"\n        sizes=\"(max-width: 677px) 100vw, 677px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhUlEQVQI14WNywrCMBRE8/+/pAuXhe51obRQk0Ib2hRt87jNzYgRrAjiWcxm5jBCyqJty2E4r2sMIQC4z/7mLTMjQwTn4P0zc78hqmpf1wetTwBSSgAaZRrTEdFrwYwYt/ySd1k+fsrXqecY8Q8hZaFUOY6XEMh5Z63ttOmnYZmX9/kv+QHQHOdpCniqfgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/1b63c78186fe3af5a3a58b64a49a8b83/37523/1.png\"\n        srcset=\"/static/1b63c78186fe3af5a3a58b64a49a8b83/e9ff0/1.png 180w,\n/static/1b63c78186fe3af5a3a58b64a49a8b83/f21e7/1.png 360w,\n/static/1b63c78186fe3af5a3a58b64a49a8b83/37523/1.png 720w,\n/static/1b63c78186fe3af5a3a58b64a49a8b83/a0209/1.png 725w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoUlEQVQI123OTQrCMBQEYK/lxuN15W1cegk33RQLrZgWkrT5bZKXviRSBMXiLGYx8MEc2vu5rk9Nc2TsyjlqrTlXyikdNMSIGWMsMRaArXc5jOOl7ytCKsZvlC5CzFKZ2Qi9aEQs5SsBSs6/eBjmrhOEGEotY9J7Z22Y3GSiAQTptfP4liH8wc+uawl5SOmF2CZrc4CUS0oprbgC5M/zHX4BmpvjnK9aozAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/3875077881d61228c2c87cc812fae820/37523/2.png\"\n        srcset=\"/static/3875077881d61228c2c87cc812fae820/e9ff0/2.png 180w,\n/static/3875077881d61228c2c87cc812fae820/f21e7/2.png 360w,\n/static/3875077881d61228c2c87cc812fae820/37523/2.png 720w,\n/static/3875077881d61228c2c87cc812fae820/5b481/2.png 846w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 478px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIElEQVQoz4XQf2+DIBAG4H7/77bYaRWtKKCgAtb+UrSIsliXdEtcd39e7sndvbswZMNglNJ5fqWnCnIMSxLLBEp8V8paO9vZ/q55XjpCiJ2zJ0qNt9sAgEQVAwX0UOIXx4STW9s/sf0THwLa96YfRpSe0xMCdYBlkYmqVtLM48/pDewd8r5fzk6TM6xTt/KOJY5LzK7sYbTdqhfeu5lSY6c0jBvcZL4IVlzcC/3Expiu67axH3wHhtEFNwRIkPCMSFbdq3Ea19Fpmrbxh4O7Viulo7COROxyN2RpSF+b353tB3RYAtMYX9AJBzJIOUWc8Vasm99h5/P5c7f8HMnYKR3AkqhA+TV/mMc/2PPpmjaEZ9LkQIRpSYkoRSvMZN7jL1HkOB7QlsvBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/b679d76c21d0e89b6e9e9ce20bf37084/50978/3.png\"\n        srcset=\"/static/b679d76c21d0e89b6e9e9ce20bf37084/e9ff0/3.png 180w,\n/static/b679d76c21d0e89b6e9e9ce20bf37084/f21e7/3.png 360w,\n/static/b679d76c21d0e89b6e9e9ce20bf37084/50978/3.png 478w\"\n        sizes=\"(max-width: 478px) 100vw, 478px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token number\">0</span>a435f46288bb5a764d13fca6c901d3750cee73fd7689ce79ef6dc0ff8f380e5</code></pre></div>\n<ul>\n<li>\n<p>인코딩되어진 값을 확인할 수 있다.</p>\n</li>\n<li>\n<p>사용자 입력을 27바이트를 받으며</p>\n</li>\n<li>\n<p><code class=\"language-text\">func1</code> ~ <code class=\"language-text\">func9</code> 까지 함수 호출 과정이 끝나고 <code class=\"language-text\">_ptrace</code> 를 호출하는 것을 확인할 수 있다.</p>\n<p><a href=\"https://www.notion.so/ptrace-Anti-Debugging-aed6d7a2c7f748e69f7144e86b7fe3f5\">ptrace Anti-Debugging</a></p>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 665px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB50lEQVQoz33Sy27bMBQEUP7/b3VRoGmRNmmMIE6st0hLfIminiTvFHaAruwQwx0PLji4LBIIKCvFue/7qa4cV6r3KiXCrbMsi9QGQEjEAiFdsRC+733TOuv9tM10215wrw0BeyK2EwJQNdq57Xye69rfm/kfd9okYEvEVsIGFLUehqVtt7y2cpLKjvue7mGhTQCWRGyJF/yeybZxnLss143qeqdivPtnrswOzJHYnLACH7ksy0GIsSrG3li7mC8K48pswBSJTQkLcCqUkvP5PBa5Xbc9pPBFYa0yK+AjMR8xJeSNGd0mxFY3PqQ9RiK6O7mRZgHGQMxFjISs1n7chZi4VuM2uHEN4XZh87JU0kzAEIgNEe6KlzmI82C9+3wUAvZwG5fSeMAGYjZiIJxq48e962Y5eOCyc27ENN3GhTQjYAIxEzAkvJ462Q15bp9eq2OdndpSDM00O4RAYd3WddvCfr12GLJOO4LeiakAHVFpnwn5UpQvZfV4zJ+z8ij4B+cPP//8+P5cvh0rIbKW19IUneJ+1REqgMkAGaATFNE5bCPgAXeNSuHbw+HpuSrr/vBaHJvOAprIElS8hPU7PsOXcFT6ILvf+bE9VWWn2t5yaSsuDg3/lZd/m/Zd63elH3mRW18Oyz8u+Vx3zZnabQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/e0141e58211928db05c22d72b8e75d8e/5f4af/4.png\"\n        srcset=\"/static/e0141e58211928db05c22d72b8e75d8e/e9ff0/4.png 180w,\n/static/e0141e58211928db05c22d72b8e75d8e/f21e7/4.png 360w,\n/static/e0141e58211928db05c22d72b8e75d8e/5f4af/4.png 665w\"\n        sizes=\"(max-width: 665px) 100vw, 665px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 387px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVQY042PyQ6DIBRF/f9v664xDsUhDRRFcGgFRd6DRru28exP7rlRknTOobVQFiNTYgETQvDBhwtEcSx+MsmHpu8t2nCZKE0lgN+XyUgV124+lhHQq94/iKcsIJ7KndYbIhIy1/Rtlu2QD3z4n79nK7X/LIgtn7qSfLCyM0IY0c5t8+ErrKdylklrAQDzTLJGFfSV1/x2ryrWzttnWieH7kz+AoWIW/Ppti/vAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/d0940ad9a32e6a72ec589acf08e86728/691c3/5.png\"\n        srcset=\"/static/d0940ad9a32e6a72ec589acf08e86728/e9ff0/5.png 180w,\n/static/d0940ad9a32e6a72ec589acf08e86728/f21e7/5.png 360w,\n/static/d0940ad9a32e6a72ec589acf08e86728/691c3/5.png 387w\"\n        sizes=\"(max-width: 387px) 100vw, 387px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">_ptrace</code> 함수는 인자 <code class=\"language-text\">edi:0, esi:0, edx:1, ecx:0</code> 을 받으며 호출되며 반환 되는 값이 <code class=\"language-text\">0xFFFFFFFFFFFFFFFF</code> 값 즉, <code class=\"language-text\">-1</code> 과 비교되어 0 이 아니게 되면 정상 루틴이 아닌 다른 루틴으로 빠지는 것을 확인할 수 있었다.</li>\n<li><code class=\"language-text\">Ptrace</code> 의 <code class=\"language-text\">PTRACE_TRACEME</code> 옵션은 자기 자신에게 디버거를 붙이라는 의미로서 해당 코드에서는 <code class=\"language-text\">ptrace</code>의 결과가 -1인지 검사하고 참이라면 유효하지 않은 코드 영역으로 점프를 하게 된다. 즉 안티 디버깅을 하기 위해 <code class=\"language-text\">자기 자신이 디버깅 당하는 중인지 검사</code> 하는 것이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 667px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhUlEQVQoz0XS2WrDMBCFYb//G5YsdVInihftI1n7KS6ihv/mG0YXAxpKbQCkostl49yP35LNWuzixViMqQG1nTXAeZTaOaR6jLikeTbO5cdoyCYAnAsXYgFyOyuA9Ui1c4j1GHHlGNNE9XqnxXLt6GeaXUwZSO0sA8Yj1s4h1GO0KTeOQqnwfMpp5gttj+ntUkpAbGcJ0B6hdg57OUabctcrl3KfJrOspKN6fRiFFNux+l9s0A576Rx8aRGYBV2umxB+HOW6kS/+sywmpNCw17PQoBx86RyotAAwTu+3Jlu+vrSlAGDdhNqjb3D1zDcIByqdg83N/z3+/uZaxctVjcubyXV8MBWSq8fqf66CE2zuHEyGa/hId78fNz+fal6tifrFPnJPVGHLGVVsBJM7B51BDUy6240rFabJzKsVQfwwJvZkK0w5sxUrQefOQWVY4CVoemlj4vMpjfm7mfPNR1Ohy5mpWAgqdw4yQVdMon+S2zU4f/ywjYvFRVUg85kq+FiI1PkLGDOzhrmB0BkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/5f3a1f5e329fbbe501b40bbde93e4e0c/295bd/6.png\"\n        srcset=\"/static/5f3a1f5e329fbbe501b40bbde93e4e0c/e9ff0/6.png 180w,\n/static/5f3a1f5e329fbbe501b40bbde93e4e0c/f21e7/6.png 360w,\n/static/5f3a1f5e329fbbe501b40bbde93e4e0c/295bd/6.png 667w\"\n        sizes=\"(max-width: 667px) 100vw, 667px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>안티 디버깅 검사를 마친 후에 다시 <code class=\"language-text\">func10</code> ~ <code class=\"language-text\">func15</code> 까지 함수를 이용하여 입력값 검증을 시도한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSElEQVQoz12L647bIBBGef8X659KVRNtNtm1ExMT1hg7DBdjgzFTpa2KVelodKTvDJk2LGRkHKwJt5vvh/A0SmrrEfeN8sWJ27CQ8c6VMbFpZm2jMlqAnRD3zdMXJyZhYcM7B+dC2xqp9OPJOmVtxn0zTMWJTlh4PStrAqVOjhGMFtqajPtGTsWJSljYkHIwemkaSxnQvu20g4z7RkzFyXPFQkL6AGdjQ73Sq599p51Kv6eYxzWPK3ZT6cmw4l9iHhNWrWRMHk/s8EE/6paBkyv24TWpjDIiM68r4+uF/LF/dPPGffzy26mFb4f7J/f1Y+50ON7k97Ogcqn5wnXgsDRjICLinn5FEfOQ8SrhfOYAc1znlOKP4/vx7XpnX5S1QshxkCfaky7i/4QsEtbSUtZfPh8/L9Xhcn1vGdWuHqAaoB50JaEal1+ZOzg0ycUB/AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/16658b5d7a80ee4b004529b03a51166d/37523/7.png\"\n        srcset=\"/static/16658b5d7a80ee4b004529b03a51166d/e9ff0/7.png 180w,\n/static/16658b5d7a80ee4b004529b03a51166d/f21e7/7.png 360w,\n/static/16658b5d7a80ee4b004529b03a51166d/37523/7.png 720w,\n/static/16658b5d7a80ee4b004529b03a51166d/64d87/7.png 818w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">func15</code> 함수의 반환 값을 인자로 삼아 <code class=\"language-text\">_SHA256_Init</code> 함수가 호출되는 것을 확인할 수 있으며,  <code class=\"language-text\">strlen</code> 함수를 바탕으로 rax레지스터 즉, 검증 함수를 거치고 나온 후 해당 값의 길이 값을 반환한후 <code class=\"language-text\">rdx</code> 레지스터에 넣는 것을 확인할 수 있다.</li>\n<li><code class=\"language-text\">_SHA256_Update</code> 함수에서 <code class=\"language-text\">입력 값의 길이 값, 해시 값으로 초기화된 값</code> 을 인자로 하여 업데이트를 한다.</li>\n<li><code class=\"language-text\">OpenSSL API 모듈 SHA256_Init()</code> , <code class=\"language-text\">SHA256_Update()</code> , <code class=\"language-text\">SHA256_Final()</code> 함수는 핵심 기능이다. 할당 <code class=\"language-text\">SHA256_CTX</code> 을 그것을 초기화 <code class=\"language-text\">SHA256_Init()</code> 와 데이터를 통해 실행, <code class=\"language-text\">SHA256_Update()</code> 그리고 마지막으로 사용하여 결과 추출 <code class=\"language-text\">SHA256_Final()</code> 하게 된다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB30lEQVQoz13SyXLbMBAEUP7/r+XiJI7KLi0RSVEEsRAgiAEw2CalONFBVe/Qt+5Dd6XRi0oPjehy5ff7BgF89KdL3/fLxNjMF601WxTm1qVGLxwmwJwAxKL4zD8v46/T73kV2lvrw+YDYLK+YqUuVnrCRpDS23s/3IxgwmjjnJsW9f4xOR9ccCkl8N4hOiSfqfOVnkIji0VI0GuaGJRaxQqLAinA2mR22NEhovZhQ3KZOlfoCSptWIdJjaO+XKSQhmsziZ1zN887k8bGHRFXH0wkm6jbCr3QqWofmbEccCvtJpwUMI7bujkiwpSkDyqSTtTpTOtf+ktqupDGyn14hEqjcHoN82x2iwkbgGcu8EAKqZOZdCNVSGaS5T8sM3jdyBANj2Z/HcVqdYwZwDEILBJH6hZsR76NNkrMwkUuDbfAtb3b/bDI82rPQp5nfmHqc1a9gl7CbS+TowWpGyH/OAyM7YwZvkrvIGHMiBbg2/fjNOqSE7UaoAzasUos04zEkFiiboDKVeDcCiUQW8q51NJqtT4cR35b7CTs6h5brtrdE90j3fGf7gqFiV0rPy3MAlB7HJOIXMTTFm5IQ2xfbkgvuj60Izcfk/w5iLfjeJj4WZoT10dhrr6MSE9DfPUHadXjVeTo6o8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/f95434dfc5e5661a90d340bae19c7b08/37523/8.png\"\n        srcset=\"/static/f95434dfc5e5661a90d340bae19c7b08/e9ff0/8.png 180w,\n/static/f95434dfc5e5661a90d340bae19c7b08/f21e7/8.png 360w,\n/static/f95434dfc5e5661a90d340bae19c7b08/37523/8.png 720w,\n/static/f95434dfc5e5661a90d340bae19c7b08/302a4/8.png 1080w,\n/static/f95434dfc5e5661a90d340bae19c7b08/0940f/8.png 1154w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"solved-code-with-z3\" style=\"position:relative;\"><a href=\"#solved-code-with-z3\" aria-label=\"solved code with z3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>solved code (with z3)</h1>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># This Python file uses the following encoding: utf-8</span>\n<span class=\"token keyword\">from</span> z3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\n<span class=\"token comment\"># x = Solver()</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">func1</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>z <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> z <span class=\"token operator\">==</span> <span class=\"token number\">10858</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">></span> <span class=\"token number\">85</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">&lt;=</span> <span class=\"token number\">95</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">></span> <span class=\"token number\">96</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">&lt;=</span> <span class=\"token number\">111</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func2</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y <span class=\"token operator\">%</span> z <span class=\"token operator\">==</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">></span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func3</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">/</span>z<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">&lt;=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">&lt;=</span> <span class=\"token number\">119</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func4</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>y <span class=\"token operator\">%</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> y <span class=\"token operator\">==</span> <span class=\"token number\">137</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">></span> <span class=\"token number\">115</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">&lt;=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func5</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z <span class=\"token operator\">+</span> y<span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>y <span class=\"token operator\">^</span> z <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">225</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">></span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> z <span class=\"token operator\">&lt;=</span> <span class=\"token number\">89</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func6</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">&lt;=</span>z1<span class=\"token punctuation\">,</span> z1 <span class=\"token operator\">&lt;=</span> z2<span class=\"token punctuation\">,</span> y<span class=\"token operator\">></span><span class=\"token number\">85</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">></span><span class=\"token number\">110</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">></span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>y<span class=\"token operator\">+</span>z1<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">161</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func7</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">>=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> y<span class=\"token operator\">&lt;=</span><span class=\"token number\">119</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">></span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">89</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">122</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>z1<span class=\"token operator\">+</span>z2 <span class=\"token operator\">==</span> <span class=\"token number\">101</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func8</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">&lt;=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span>z2<span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z1<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>z2<span class=\"token operator\">*</span>z1 <span class=\"token operator\">==</span> <span class=\"token number\">97</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>z2<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>y<span class=\"token operator\">-</span>z1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>z1 <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">10088</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">114</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func9</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">==</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">+</span>y<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>z2<span class=\"token operator\">-</span>z1<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>y <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1443</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func10</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">>=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>y<span class=\"token operator\">+</span>z2<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>z2 <span class=\"token operator\">==</span> <span class=\"token number\">15514</span><span class=\"token punctuation\">,</span> z1 <span class=\"token operator\">></span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> z1 <span class=\"token operator\">&lt;=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func11</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>z1<span class=\"token operator\">>=</span>y<span class=\"token punctuation\">,</span> y<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">></span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span><span class=\"token number\">104</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">-</span>z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>z2 <span class=\"token operator\">==</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>y<span class=\"token operator\">+</span>y <span class=\"token operator\">==</span> <span class=\"token number\">68</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func12</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">>=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span><span class=\"token number\">59</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z2<span class=\"token operator\">+</span>z1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>z2 <span class=\"token operator\">==</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">-</span>z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>z1 <span class=\"token operator\">==</span> <span class=\"token number\">101</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func13</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">&lt;=</span>z1<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span>z2<span class=\"token punctuation\">,</span> y<span class=\"token operator\">></span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">></span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">&lt;=</span><span class=\"token number\">109</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z2<span class=\"token operator\">+</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>y <span class=\"token operator\">==</span> <span class=\"token number\">269</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>z2<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">-</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>z1 <span class=\"token operator\">==</span> <span class=\"token number\">185</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func14</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>y<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span> z2<span class=\"token operator\">></span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">+</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>z2<span class=\"token operator\">==</span><span class=\"token number\">185</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">func15</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>z1<span class=\"token operator\">>=</span>z2<span class=\"token punctuation\">,</span> z1<span class=\"token operator\">>=</span>y<span class=\"token punctuation\">,</span> z2<span class=\"token operator\">></span><span class=\"token number\">95</span><span class=\"token punctuation\">,</span> z1<span class=\"token operator\">&lt;=</span><span class=\"token number\">109</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z1<span class=\"token operator\">-</span>y<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>z1<span class=\"token operator\">^</span>z2<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>y<span class=\"token operator\">==</span><span class=\"token number\">1214</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>z2<span class=\"token operator\">-</span>z1<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>z2<span class=\"token operator\">^</span>y<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>z1<span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1034</span><span class=\"token punctuation\">)</span>\n\narray <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>BitVec<span class=\"token punctuation\">(</span><span class=\"token string\">'f_%i'</span><span class=\"token operator\">%</span>i<span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\nx <span class=\"token operator\">=</span> Solver<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 실 제약조건을 추가하는 과정 func 들의 결과와 인풀의 범위를 아스키 코드로 고정</span>\nfunc1<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc2<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc3<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc4<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc5<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc6<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc7<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc8<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc9<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc10<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc11<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc12<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc13<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc14<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nfunc15<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">24</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">25</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span> array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0x7e</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">assert</span> x<span class=\"token punctuation\">.</span>check<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> sat\n\ntest <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nstring_check <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\ntmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> z <span class=\"token keyword\">in</span> test<span class=\"token punctuation\">:</span>\n    string_check<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token string\">'f_'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> test<span class=\"token punctuation\">[</span>z<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> idx <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>string_check<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>string_check<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>as_long<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nisFlag<span class=\"token operator\">=</span><span class=\"token string\">''</span>\n<span class=\"token keyword\">for</span> cdx <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    isFlag<span class=\"token operator\">+=</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">[</span>cdx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span> isFlag</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\">바이너리 정보</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 14, 2020","title":"CodeGate2018 RedVelvet write-up","categories":"CTF","author":"Zer0Luck","emoji":"💸"},"fields":{"slug":"/codegate2018_redvelbet_ctf_writeup/"}},"prev":{"id":"ad736f49-eb3e-5545-a7cb-d869773bd0e6","html":"<h2 id=\"the-loader\" style=\"position:relative;\"><a href=\"#the-loader\" aria-label=\"the loader permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Loader</h2>\n<ul>\n<li>\n<p><code class=\"language-text\">example/fauxware/fauxware</code> 를 로드하고 로더와 상호 작용 하는 방법에 대해 알아보자</p>\n</li>\n<li>\n<p>예제로 사용할 바이너리는 다음 링크에서 다운로드: <a href=\"https://github.com/dnsdudrla97/angr-doc/tree/master/examples/fauxware-SOLVED\">dnsdudrla97/angr-doc</a></p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> angr<span class=\"token punctuation\">,</span> monkeyhex\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader\n<span class=\"token operator\">&lt;</span>Loaded fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0xc08000</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></code></pre></div>\n<hr>\n<h2 id=\"loaded-objects\" style=\"position:relative;\"><a href=\"#loaded-objects\" aria-label=\"loaded objects permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loaded Objects</h2>\n<ul>\n<li>CLE 로더 (cle.Loader)는 로드된 바이너리 객체의 전체 그룹을 나타내며 단일 메모리 공간에 로드되고 매핑된다.</li>\n<li>각 바이너리 객체는 파일 형식(cle.Backend의 subclass)을 처리할 수 있는 loader backend에 의해 로드된다.</li>\n<li><em>예를 들어, cle.ELF 는 ELF 바이너리 파일을 로드 하는 데 사용된다.</em></li>\n<li>메모리에 로드된 바이너리 수 와 일치하지 않는 객체도 있을 것이며 예를 들어, <code class=\"language-text\">Thread-local Storage</code> 지원을 제공하는 데 사용되는 객체와 확인되지 않은 Symbols을 제공하는데 사용되는 외부 객체</li>\n<li>CLE가 <code class=\"language-text\">loader.all_objects</code> 와 함께 로드한 전체 목록뿐만 아니라 다음과 같이 몇 가지 추가 표적 분류도 얻을 수있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>all_objects\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ELF Object libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x700000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x8f14d7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ELF Object ld<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x900000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x92f18f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ExternObject Object cle<span class=\"token comment\">##externs, maps [0xa00000:0xa80000]>,</span>\n <span class=\"token operator\">&lt;</span>ELFTLSObjectV2 Object cle<span class=\"token comment\">##tls, maps [0xb00000:0xb15010]>,</span>\n <span class=\"token operator\">&lt;</span>KernelObject Object cle<span class=\"token comment\">##kernel, maps [0xc00000:0xc08000]>]</span>\n\n<span class=\"token comment\"># 프로젝트 로드시 직접 지정한 main_object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object\n<span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\"># shared 객체와 이름을 매핑해서 보여줌</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>shared_objects\n<span class=\"token punctuation\">{</span><span class=\"token string\">'fauxware'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ELF Object libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x700000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x8f14d7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'ld-linux-x86-64.so.2'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ELF Object ld<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x900000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x92f18f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'extern-address space'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ExternObject Object cle<span class=\"token comment\">##externs, maps [0xa00000:0xa80000]>,</span>\n <span class=\"token string\">'cle##tls'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>ELFTLSObjectV2 Object cle<span class=\"token comment\">##tls, maps [0xb00000:0xb15010]>}</span>\n\n<span class=\"token comment\"># ELF 파일에서 로드된 모든 객체</span>\n<span class=\"token comment\"># Window OS 일 경우 all_pe_object를 사용하자</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>all_elf_objects\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ELF Object libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x700000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x8f14d7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token operator\">&lt;</span>ELF Object ld<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x900000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x92f18f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># externs_object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>extern_object\n<span class=\"token operator\">&lt;</span>ExternObject Object cle<span class=\"token comment\">##externs, maps [0xa00000:0xa80000]></span>\n\n<span class=\"token comment\"># kernel_object : syscall에 주소를 제공하는데 사용</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>kernel_object\n<span class=\"token operator\">&lt;</span>KernelObject Object cle<span class=\"token comment\">##kernel, maps [0xc00000:0xc08000]></span>\n\n<span class=\"token comment\">#주소가 주어진 객체에 대한 참조를 얻을 수 있다</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>find_object_containing<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>ELF Object fauxware<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x60105f</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>해당 객체들과 직접 상호 작용하여 메타 데이터를 추출 할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> obj <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object\n<span class=\"token comment\"># 객체의 entry point</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>entry\n<span class=\"token number\">0x400580</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>min_addr<span class=\"token punctuation\">,</span> obj<span class=\"token punctuation\">.</span>max_addr\n<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x60105f</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ELF의 세그먼트와 섹션을 검색한다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>segments\n<span class=\"token operator\">&lt;</span>Regions<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n\t<span class=\"token operator\">&lt;</span>ELFSegment flags<span class=\"token operator\">=</span><span class=\"token number\">0x5</span><span class=\"token punctuation\">,</span> relro<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> vaddr<span class=\"token operator\">=</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">,</span> memsize<span class=\"token operator\">=</span><span class=\"token number\">0xa74</span><span class=\"token punctuation\">,</span> filesize<span class=\"token operator\">=</span><span class=\"token number\">0xa74</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span>ELFSegment flags<span class=\"token operator\">=</span><span class=\"token number\">0x4</span><span class=\"token punctuation\">,</span> relro<span class=\"token operator\">=</span><span class=\"token number\">0x1</span><span class=\"token punctuation\">,</span> vaddr<span class=\"token operator\">=</span><span class=\"token number\">0x600e28</span><span class=\"token punctuation\">,</span> memsize<span class=\"token operator\">=</span><span class=\"token number\">0x1d8</span><span class=\"token punctuation\">,</span> filesize<span class=\"token operator\">=</span><span class=\"token number\">0x1d8</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0xe28</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span>ELFSegment flags<span class=\"token operator\">=</span><span class=\"token number\">0x6</span><span class=\"token punctuation\">,</span>  relro<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> vaddr<span class=\"token operator\">=</span><span class=\"token number\">0x601000</span><span class=\"token punctuation\">,</span> memsize<span class=\"token operator\">=</span><span class=\"token number\">0x60</span><span class=\"token punctuation\">,</span> filesize<span class=\"token operator\">=</span><span class=\"token number\">0x50</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0x1000</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>sections\n<span class=\"token operator\">&lt;</span>Regions<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n\t<span class=\"token operator\">&lt;</span>Unnamed <span class=\"token operator\">|</span> offset <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>interp <span class=\"token operator\">|</span> offset <span class=\"token number\">0x238</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400238</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x1c</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>note<span class=\"token punctuation\">.</span>ABI<span class=\"token operator\">-</span>tag <span class=\"token operator\">|</span> offset <span class=\"token number\">0x254</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400254</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x20</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>note<span class=\"token punctuation\">.</span>gnu<span class=\"token punctuation\">.</span>build<span class=\"token operator\">-</span><span class=\"token builtin\">id</span> <span class=\"token operator\">|</span> offset <span class=\"token number\">0x274</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400274</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x24</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>gnu<span class=\"token punctuation\">.</span><span class=\"token builtin\">hash</span> <span class=\"token operator\">|</span> offset <span class=\"token number\">0x298</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400298</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x1c</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>dynsym <span class=\"token operator\">|</span> offset <span class=\"token number\">0x2b8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4002b8</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0xd8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>dynstr <span class=\"token operator\">|</span> offset <span class=\"token number\">0x390</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400390</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x5a</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>gnu<span class=\"token punctuation\">.</span>version <span class=\"token operator\">|</span> offset <span class=\"token number\">0x3ea</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4003ea</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x12</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>gnu<span class=\"token punctuation\">.</span>version_r <span class=\"token operator\">|</span> offset <span class=\"token number\">0x400</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400400</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x20</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>rela<span class=\"token punctuation\">.</span>dyn <span class=\"token operator\">|</span> offset <span class=\"token number\">0x420</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400420</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x18</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>rela<span class=\"token punctuation\">.</span>plt <span class=\"token operator\">|</span> offset <span class=\"token number\">0x438</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400438</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0xa8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>init <span class=\"token operator\">|</span> offset <span class=\"token number\">0x4e0</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4004e0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x18</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>plt <span class=\"token operator\">|</span> offset <span class=\"token number\">0x500</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400500</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x80</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">|</span> offset <span class=\"token number\">0x580</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400580</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x338</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>fini <span class=\"token operator\">|</span> offset <span class=\"token number\">0x8b8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4008b8</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0xe</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>rodata <span class=\"token operator\">|</span> offset <span class=\"token number\">0x8c8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x4008c8</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x63</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>eh_frame_hdr <span class=\"token operator\">|</span> offset <span class=\"token number\">0x92c</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x40092c</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x44</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>eh_frame <span class=\"token operator\">|</span> offset <span class=\"token number\">0x970</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400970</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x104</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>ctors <span class=\"token operator\">|</span> offset <span class=\"token number\">0xe28</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600e28</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x10</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>dtors <span class=\"token operator\">|</span> offset <span class=\"token number\">0xe38</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600e38</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x10</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>jcr <span class=\"token operator\">|</span> offset <span class=\"token number\">0xe48</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600e48</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>dynamic <span class=\"token operator\">|</span> offset <span class=\"token number\">0xe50</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600e50</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x190</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>got <span class=\"token operator\">|</span> offset <span class=\"token number\">0xfe0</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600fe0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">.</span>plt <span class=\"token operator\">|</span> offset <span class=\"token number\">0xfe8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x600fe8</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x50</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>data <span class=\"token operator\">|</span> offset <span class=\"token number\">0x1038</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x601038</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x18</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>bss <span class=\"token operator\">|</span> offset <span class=\"token number\">0x1050</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x601050</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x10</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>comment <span class=\"token operator\">|</span> offset <span class=\"token number\">0x1050</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x2a</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>shstrtab <span class=\"token operator\">|</span> offset <span class=\"token number\">0x107a</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0xfe</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>symtab <span class=\"token operator\">|</span> offset <span class=\"token number\">0x18f8</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x6d8</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>strtab <span class=\"token operator\">|</span> offset <span class=\"token number\">0x1fd0</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x278</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\"># 포함되어진 주소로 개별 세그먼트 또는 섹션을 가져올 수 있다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>find_segment_containing<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>ELFSegment flags<span class=\"token operator\">=</span><span class=\"token number\">0x5</span><span class=\"token punctuation\">,</span> relro<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> vaddr<span class=\"token operator\">=</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">,</span>\n\tmemsize<span class=\"token operator\">=</span><span class=\"token number\">0xa74</span><span class=\"token punctuation\">,</span> filesize<span class=\"token operator\">=</span><span class=\"token number\">0xa74</span><span class=\"token punctuation\">,</span> offset<span class=\"token operator\">=</span><span class=\"token number\">0x0</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>find_section_containing<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">|</span> offset <span class=\"token number\">0x580</span><span class=\"token punctuation\">,</span> vaddr <span class=\"token number\">0x400580</span><span class=\"token punctuation\">,</span> size <span class=\"token number\">0x338</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\"># symbols 대한 PLT stub 주소를 가져 온다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>plt\n<span class=\"token punctuation\">{</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400510</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'printf'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400520</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'read'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400530</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__libc_start_main'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400540</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'strcmp'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400550</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'open'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400560</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'exit'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0x400570</span><span class=\"token punctuation\">}</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'strcmp'</span><span class=\"token punctuation\">]</span>\n<span class=\"token number\">0x400550</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>reverse_plt<span class=\"token punctuation\">[</span><span class=\"token number\">0x400550</span><span class=\"token punctuation\">]</span>\n<span class=\"token string\">'strcmp'</span>\n\n<span class=\"token comment\"># prelinked base, CLE에 이해 실제로 메모리에 매핑 된 위치를 표시한다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>linked_base\n<span class=\"token number\">0x400000</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>mapped_base\n<span class=\"token number\">0x400000</span></code></pre></div>\n<hr>\n<h2 id=\"symbols-and-relocations\" style=\"position:relative;\"><a href=\"#symbols-and-relocations\" aria-label=\"symbols and relocations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Symbols and Relocations</h2>\n<ul>\n<li>CLE를 사용하는 동안 Symbolic으로 작업 할 수 도 있다.</li>\n<li>Symbolic은 이름을 주소에 효과적으로 매핑하는 실행 가능한 형식 이다.</li>\n<li>CLE에서 Symbolic을 가져 오는 가장 쉬운 방법은 <code class=\"language-text\">loader.find_symbol</code> 을 사용하는 것이다.</li>\n<li>해당 방법은 이름이나 주소를 취하고 <code class=\"language-text\">Symbol</code> 객체를 반환한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>find_symbol<span class=\"token punctuation\">(</span><span class=\"token string\">'strcmp'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp\n<span class=\"token operator\">&lt;</span>Symbol <span class=\"token string\">\"strcmp\"</span> <span class=\"token keyword\">in</span> libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so at <span class=\"token number\">0x7a22d0</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>Symbolic에서 가장 유용한 속성은 이름, 소유자 및 주소이지만 Symbol의 주소는 모호할 수 있다.</li>\n<li>Symbol 객체에는 주소를 얻을 수 있는 세 가지 방법이 있다.\n<ul>\n<li><code class=\"language-text\">.rebased_addr</code>\n<ul>\n<li>전역 주소 공간의 주소이다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">.linked_addr</code>\n<ul>\n<li>바이너리의 미리 연결된 베이스에 상대적인 주소, 예를 들어 <code class=\"language-text\">readelf(1)</code></li>\n</ul>\n</li>\n<li><code class=\"language-text\">.relative_addr</code>\n<ul>\n<li>객체 기반에 상대적인  주소이다.</li>\n<li>이는 문헌(Window 문헌)에서 RVA(상대 가상 주소)로 알려져 있다.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>name\n<span class=\"token string\">'strcmp'</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>owner\n<span class=\"token operator\">&lt;</span>ELF Object libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">,</span> maps <span class=\"token punctuation\">[</span><span class=\"token number\">0x700000</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x8f14d7</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>rebased_addr\n<span class=\"token number\">0x7a22d0</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>linked_addr\n<span class=\"token number\">0xa22d0</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>relative_addr\n<span class=\"token number\">0xa22d0</span></code></pre></div>\n<ul>\n<li>디버그 정보를 제공하는 것 외에도 심볼은 동적 연결 개념도 지원한다.</li>\n<li><code class=\"language-text\">libc stcmp</code> Symbol를 내보내기로 제공하며 기본 바이너리가 이에 종속이 된다.</li>\n<li>CLE에 게 주 개체에서 직접 <code class=\"language-text\">strcmp</code> 기호를 제공하도록 요청하면 이것이 가져 오기 Symbol임을 알려준다.</li>\n<li>가져 오기 Symbol에는 연관된 의미 있는 주소가 없겠지만 <code class=\"language-text\">.resolvedby</code> 와 같이 이를 해결하는데 사용 된 기호에 대한 참조를 제공한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>is_export\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> strcmp<span class=\"token punctuation\">.</span>is_import\n<span class=\"token boolean\">False</span>\n<span class=\"token comment\"># Loader에서 메서드는 Symbol을 찾기 위해 검색 작업을 수행하므로 find_symbol이다.</span>\n<span class=\"token comment\"># 단일 객체에서 메서드는 주어진 이름을 가진 심볼이 하나만 있을 수 있기 때문에 get_symbol이다.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> main_strcmp <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>main_object<span class=\"token punctuation\">.</span>get_symbol<span class=\"token punctuation\">(</span><span class=\"token string\">'strcmp'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>Symbol <span class=\"token string\">\"strcmp\"</span> <span class=\"token keyword\">in</span> fauxware <span class=\"token punctuation\">(</span><span class=\"token keyword\">import</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> main_strcmp<span class=\"token punctuation\">.</span>is_export\n<span class=\"token boolean\">False</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> main_strcmp<span class=\"token punctuation\">.</span>is_import\n<span class=\"token boolean\">True</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> main_strcmp<span class=\"token punctuation\">.</span>resolvedby\n<span class=\"token operator\">&lt;</span>Symbol <span class=\"token string\">\"strcmp\"</span> <span class=\"token keyword\">in</span> libc<span class=\"token operator\">-</span><span class=\"token number\">2.31</span><span class=\"token punctuation\">.</span>so at <span class=\"token number\">0x7a22d0</span><span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>\n<p><code class=\"language-text\">import</code> , <code class=\"language-text\">export</code> 사이의 링크가 메모리에 등록되어야 하며 특정 방법은 재배치라는 또 다른 개념에 의해 처리가 된다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">재배치</code> 는 “[import]를 export symbol와 일치 시킬 때 [format] 형식의 [locate]에 export 주소를 써라” 라고 말한다.</p>\n</li>\n<li>\n<p>객체 (Relocation 인스턴스) 에 대한 전체 재배치 목록을 obj.relocs로 볼 수 있거나 심볼 이름에서 Relocationd으로 매핑 (obj.import) 만 볼 수 있다.</p>\n</li>\n<li>\n<p>해당 export symbol 목록이 없</p>\n</li>\n<li>\n<p>재배치의 해당 가져 오기 Symbol로 액세스 할 수 있다.</p>\n</li>\n<li>\n<p>재배치가 쓸 주소는 Symbol에 사용할 수 있는 모든 주소 식벌자을 통해 액세스 할 수 있다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">.owner</code> 로 재배치를 요청하는 객체에 대한 참조도 가져올 수 있다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">.</span>shared_objects<span class=\"token punctuation\">[</span><span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>imports\n<span class=\"token punctuation\">{</span><span class=\"token string\">'__libpthread_freeres'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c40a80a0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_rtld_global'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c403af40</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__libc_enable_secure'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c405ad60</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_rtld_global_ro'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c405a100</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_dl_starting_up'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c405aeb0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__libdl_freeres'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c408f8b0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_dl_argv'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_GLOB_DAT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c405a2e0</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__tls_get_addr'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_JUMP_SLOT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c4045100</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_dl_exception_create'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_JUMP_SLOT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c4045460</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'__tunable_get_val'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_JUMP_SLOT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c4045910</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'_dl_find_dso_for_object'</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>elf<span class=\"token punctuation\">.</span>relocation<span class=\"token punctuation\">.</span>amd64<span class=\"token punctuation\">.</span>R_X86_64_JUMP_SLOT <span class=\"token builtin\">object</span> at <span class=\"token number\">0x7f96c408fa00</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>예를 들어 공유 라이브러리를 찾을 수 없어서 import를 export로 확인할 수 있 없는 경우 CLE는 externsn  객체</li>\n<li>(loader.extern_obj) 를 자동으로 업데이트 하여 심볼을 내보내기로 제공한다.</li>\n</ul>\n<hr>\n<h2 id=\"loading-options\" style=\"position:relative;\"><a href=\"#loading-options\" aria-label=\"loading options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loading Options</h2>\n<ul>\n<li><code class=\"language-text\">angr.Project</code>로 바이너리를 로드하고 Project가 암시 적으로 생성하는 <code class=\"language-text\">cle.Loader</code> 인스턴스에 옵션을 전달하려는 경우 키워드 인수를 Project 생성자에 직접 전달할 수 있으며 <code class=\"language-text\">CLE</code> 에 전달된다.</li>\n</ul>\n<h2 id=\"basic-options\" style=\"position:relative;\"><a href=\"#basic-options\" aria-label=\"basic options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Basic Options</h2>\n<ul>\n<li>\n<p><code class=\"language-text\">auto_load_libs</code> 공유 라이브러리 종속성을 자동으로 해결하려는 <code class=\"language-text\">CLE</code> 의 시도를 활성화 또는 비활성화 하며 기본적으로 켜 져 있다.</p>\n</li>\n<li>\n<p>또한 그 반대인 <code class=\"language-text\">except_missing_libs</code> 가 있다. <code class=\"language-text\">True</code> 로 설정하면 바이너리에 해결할 수 없는 공유 라이브러리 종속성이 있을 때마다 예외가 발생한다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">force_load_libs</code> 에 문자열 목록을 전달할 수 있으며 나열된 모든 항목은 게이트에서 바로 해결되지 않은 공유 라이브러리 종속성으로 처리되거나 해당 이름의 라이브러리가 종속성으로 확인되지 않도록 문자열 목록을 <code class=\"language-text\">skip_libs</code> 에 전달할 수 있다.</p>\n</li>\n<li>\n<p>또한 문자열 목록  (또는 단일 문자열)을 <code class=\"language-text\">ld_path</code> 에 전달할 수 있다.</p>\n</li>\n<li>\n<p>이 목록은 공유 라이브러리에 대한 추가 검색 경로로 사용될 수 있다.</p>\n</li>\n<li>\n<p>기본 값은 로드 된 프로그램과 동일한 디렉토리, 현재 작업 디렉토리, 및 시스템 라이브러리 가 있다.</p>\n</li>\n</ul>\n<h2 id=\"per-binary-options\" style=\"position:relative;\"><a href=\"#per-binary-options\" aria-label=\"per binary options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Per-Binary Options</h2>\n<ul>\n<li>\n<p>특정 바이너리 객책에만 적용되는 일부 옵션을 지정하려면 CLE도 그렇게 할 수 있다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">main_opts</code> 및 <code class=\"language-text\">lib_opts</code> 매개 변수는 옵션을 사전을 사용하여 이를 수행한다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">main_opts</code> 는 옵션 이름에서 옵션 값으로 매핑이고 <code class=\"language-text\">libs_opts</code> 는 라이브러리 이름에서 옵션 값으로 옵션 이름을 매핑하는 사전으로의 매핑이다.</p>\n</li>\n<li>\n<p>사용할 수 있는 옵션은 벡엔드마다 다르지만 몇 가지 일반적인 옵션은 다음과 같다.</p>\n<ol>\n<li>backend - class , name으로 사용할 수 있는 백엔드</li>\n<li>base_addr - 기본 주소 사용</li>\n<li>entry_point - 엔트리 포인트 사용</li>\n<li>arch - 사용할 아키텍처의 이름</li>\n</ol>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./fauxware'</span><span class=\"token punctuation\">,</span>\n\tmain_opts<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'backend'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'blob'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'arch'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'i386'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tlib_opts<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span><span class=\"token string\">'backend'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'elf'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span>\nWARNING <span class=\"token operator\">|</span> <span class=\"token number\">2020</span><span class=\"token operator\">-</span><span class=\"token number\">08</span><span class=\"token operator\">-</span><span class=\"token number\">14</span> <span class=\"token number\">18</span><span class=\"token punctuation\">:</span><span class=\"token number\">43</span><span class=\"token punctuation\">:</span><span class=\"token number\">05</span><span class=\"token punctuation\">,</span><span class=\"token number\">284</span> <span class=\"token operator\">|</span> cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>blob <span class=\"token operator\">|</span> No entry_point was specified <span class=\"token keyword\">for</span> blob fauxware<span class=\"token punctuation\">,</span> assuming <span class=\"token number\">0</span>\nWARNING <span class=\"token operator\">|</span> <span class=\"token number\">2020</span><span class=\"token operator\">-</span><span class=\"token number\">08</span><span class=\"token operator\">-</span><span class=\"token number\">14</span> <span class=\"token number\">18</span><span class=\"token punctuation\">:</span><span class=\"token number\">43</span><span class=\"token punctuation\">:</span><span class=\"token number\">05</span><span class=\"token punctuation\">,</span><span class=\"token number\">284</span> <span class=\"token operator\">|</span> cle<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>blob <span class=\"token operator\">|</span> No base_addr was specified <span class=\"token keyword\">for</span> blob fauxware<span class=\"token punctuation\">,</span> assuming <span class=\"token number\">0</span>\n<span class=\"token operator\">&lt;</span>Project <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>fauxware<span class=\"token operator\">></span></code></pre></div>\n<hr>\n<h2 id=\"backends\" style=\"position:relative;\"><a href=\"#backends\" aria-label=\"backends permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Backends</h2>\n<ul>\n<li><code class=\"language-text\">CLE</code> 에는 현재 <code class=\"language-text\">ELF, PE, CGC, Mach-O, ELF core dump</code> 을 정적으로 로드하고 IDA를 사용하여 바이너리를 로드하고 파일을 flat 주소 공간으로 로드하는 백엔드가 있다.</li>\n<li>CLE는 대부분의 경우에 사용할 올바른 백엔드를 자동으로 감지하므로 이상한 작업을 수행하지 않는 한 사용중인 백엔드를 지정할 필요가 없다.</li>\n<li>옵션 사전에 키를 포함하여 CLE가 객체에 특정 백엔드를 사용하도록 할 수 있다.</li>\n<li>일부 백엔드는 사용할 아키텍처를 자동 감지 할 수 없으며 <code class=\"language-text\">arch</code>를 지정해야 한다.</li>\n<li>키는 아키텍처 목록과 일치할 필요가 없다.</li>\n<li>angr은 지원되는 <code class=\"language-text\">arch</code> 에 대한 거의 모든 공통 식별자를 제공한 아키텍처를 식별한다.</li>\n</ul>\n<script src=\"https://gist.github.com/dnsdudrla97/d19c56ca03c361c1a70a1dd4e33c9bbe.js\"></script>\n<h2 id=\"symbolic-function-summaries\" style=\"position:relative;\"><a href=\"#symbolic-function-summaries\" aria-label=\"symbolic function summaries permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Symbolic Function Summaries</h2>\n<ul>\n<li>Project는 <code class=\"language-text\">SimProcedures</code> 라는 Symbol 요약을 사용하여 라이브러리 함수에 대한 외부 호출을 대체하려고 시도한다.</li>\n<li>사실상 state에 대한 라이브러리 함수의 효과를 모방하는 Python 함수이다.</li>\n</ul>\n<h3 id=\"auto_load_libs-true\" style=\"position:relative;\"><a href=\"#auto_load_libs-true\" aria-label=\"auto_load_libs true permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>auto_load_libs (TRUE)</h3>\n<ul>\n<li>만약 <code class=\"language-text\">auto_load_libs</code> 가 True(기본 값)이면 실제 라이브러리 함수가 대신 실행된다.</li>\n<li>예를 들어, <code class=\"language-text\">libc</code> 의 일부 함수는 분석하기가 배우 복잡하며 이를 실행하려는 경로의 상태 수가 폭발적으로 증가 할 가능성이 높다.</li>\n</ul>\n<h3 id=\"auto_load_libs-false\" style=\"position:relative;\"><a href=\"#auto_load_libs-false\" aria-label=\"auto_load_libs false permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>auto_load_libs (FALSE)</h3>\n<ul>\n<li>만약 <code class=\"language-text\">auto_load_libs</code> 가 False이면 외부 함수가 해결되지 않고 Project는 이를 <code class=\"language-text\">ReturnUnconstrained</code> 라는 일반 “Stub” `SimProcedure로 해결한다.</li>\n<li>이름이 말해는대로 수행한다. 호출될 때 마다 고유 한 제한되지 않은 Symbol을 반환한다.</li>\n</ul>\n<h3 id=\"use_sim_procedure-clelodaer가-아닌-angrproject에-대한-매개변수-false\" style=\"position:relative;\"><a href=\"#use_sim_procedure-clelodaer%EA%B0%80-%EC%95%84%EB%8B%8C-angrproject%EC%97%90-%EB%8C%80%ED%95%9C-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-false\" aria-label=\"use_sim_procedure clelodaer가 아닌 angrproject에 대한 매개변수 false permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>use_sim_procedure (cle.Lodaer가 아닌 angr.Project에 대한 매개변수) (FALSE)</h3>\n<ul>\n<li>False (기본 값 : True) 인 경우, extern 객체에서 제공하는 기호 만 <code class=\"language-text\">SimProcedure</code> 로 대체되고 <code class=\"language-text\">Stub ReturnUnconstrained</code> 대체된다.</li>\n<li>Symbol 값을 반환한다.</li>\n</ul>\n<script src=\"https://gist.github.com/dnsdudrla97/a091b3fbcd251f803e028fdefb4f1f7f.js\"></script>\n<h2 id=\"hooking\" style=\"position:relative;\"><a href=\"#hooking\" aria-label=\"hooking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hooking</h2>\n<ul>\n<li><code class=\"language-text\">angr</code> 이 라이브러리 코드를 파이썬 요약으로 대체하는 메커니즘을 후킹이라고 한다.</li>\n<li>시뮬레이션을 수행 할 때 모든 단계에서 angr은 현재 주소가 <code class=\"language-text\">hook</code> 되었는지 확인하고, 그렇다면 해당 주소에서 바이너리 코드 대신에 <code class=\"language-text\">hook</code>를 실행한다.</li>\n<li>이를 수행 할 수있는 API는 <code class=\"language-text\">proj.hook(addr, hook)</code> 이며, 여기서 <code class=\"language-text\">hook</code> 은 <code class=\"language-text\">SimProcedure</code> 인스턴스이다.</li>\n<li><code class=\"language-text\">.is_hooked, .unhook , .hooked_by</code> 로 프로젝트를 <code class=\"language-text\">hook</code> 를 관리할 수 있다.</li>\n<li><code class=\"language-text\">proj.hook(addr)</code> 을 함수 decorator로 사용하여 <code class=\"language-text\">hook</code> 로 사용할 고유 한 기능을 지정할 주소 <code class=\"language-text\">hooking</code> 을 위한 대체 API가 있다.</li>\n<li>선택적으로 <code class=\"language-text\">length</code> 키워드 인수를 지정하여 <code class=\"language-text\">hook</code>가 완료된 후 실행이 몇 바이트 앞으로 점프하도록 할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> stub_func <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>SIM_PROCEDURES<span class=\"token punctuation\">[</span><span class=\"token string\">'stubs'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ReturnUnconstrained'</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'angr.procedures.stubs.ReturnUnconstrained.ReturnUnconstrained'</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>hook<span class=\"token punctuation\">(</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">,</span> stub_func<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># class의 인스턴스와 연결</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>is_hooked<span class=\"token punctuation\">(</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># class의 인스턴스에 연결되었는지</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>hooked_by<span class=\"token punctuation\">(</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>SimProcedure ReturnUnconstrained<span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>unhook<span class=\"token punctuation\">(</span><span class=\"token number\">0x10000</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> @p<span class=\"token punctuation\">.</span>hook<span class=\"token punctuation\">(</span><span class=\"token number\">0x20000</span><span class=\"token punctuation\">,</span> length<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">def</span> <span class=\"token function\">my_hook</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>     state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rax <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> \n<span class=\"token operator\">>></span><span class=\"token operator\">></span> p<span class=\"token punctuation\">.</span>is_hooked<span class=\"token punctuation\">(</span><span class=\"token number\">0x20000</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">p.hook_symbol(name, hook)</code> 을 사용하여 symbol의 name을 첫 번째 인수로 제공하여 symbol가 있는 주소를 hook 할 수 있다.</li>\n<li>이것의 매우 중요한 용도 중 하나는 angr의 내장 라이브러리 SimProcedures의 동작을 확장하는 것이다.</li>\n<li>이러한 라이브러리 함수는 클래스일 뿐 이므로 하위 클래스를 생성하여 동작의 일부를 재정의 한 다음 후크에서 하위 클래스를 사용할 수 있다.</li>\n</ul>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#the-loader\">The Loader</a></p>\n</li>\n<li>\n<p><a href=\"#loaded-objects\">Loaded Objects</a></p>\n</li>\n<li>\n<p><a href=\"#symbols-and-relocations\">Symbols and Relocations</a></p>\n</li>\n<li>\n<p><a href=\"#loading-options\">Loading Options</a></p>\n</li>\n<li>\n<p><a href=\"#basic-options\">Basic Options</a></p>\n</li>\n<li>\n<p><a href=\"#per-binary-options\">Per-Binary Options</a></p>\n</li>\n<li>\n<p><a href=\"#backends\">Backends</a></p>\n</li>\n<li>\n<p><a href=\"#symbolic-function-summaries\">Symbolic Function Summaries</a></p>\n<ul>\n<li><a href=\"#auto_load_libs-true\">auto_load_libs (TRUE)</a></li>\n<li><a href=\"#auto_load_libs-false\">auto_load_libs (FALSE)</a></li>\n<li><a href=\"#use_sim_procedure-clelodaer%EA%B0%80-%EC%95%84%EB%8B%8C-angrproject%EC%97%90-%EB%8C%80%ED%95%9C-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-false\">use_sim_procedure (cle.Lodaer가 아닌 angr.Project에 대한 매개변수) (FALSE)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#hooking\">Hooking</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"August 14, 2020","title":"angr 바이너리 분석 활용 방안 2","categories":"analyzing binaries","author":"Zer0Luck","emoji":"🤬"},"fields":{"slug":"/angr-2_theori/"}},"site":{"siteMetadata":{"siteUrl":"https://www.zoomkoding.com","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/angr-3_theori/","nextSlug":"/codegate2018_redvelbet_ctf_writeup/","prevSlug":"/angr-2_theori/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}