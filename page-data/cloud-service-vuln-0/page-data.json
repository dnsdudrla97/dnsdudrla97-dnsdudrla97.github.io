{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/cloud-service-vuln-0/",
    "result": {"data":{"cur":{"id":"3598a0dc-de2b-598a-bc02-4b43a646bcfa","html":"<h1 id=\"클라우드-서비스-취약점-분석-0\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-0\" aria-label=\"클라우드 서비스 취약점 분석 0 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 0</h1>\n<h1 id=\"클라우드-컴퓨팅-보안\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%BB%B4%ED%93%A8%ED%8C%85-%EB%B3%B4%EC%95%88\" aria-label=\"클라우드 컴퓨팅 보안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 컴퓨팅 보안</h1>\n<ul>\n<li>기업, 조직 내의 데이터, 애플리케이션, 워크로드를 클라우드 컴퓨팅에 저장하고 다양한 서비스로 활용하며 서로가 공유하면서 지속적으로 변화가 발생합니다. 이와 동시에 새로운 보안 위협과 과제도 생겨나며 많은 양의 데이터가 퍼블릭 클라우드 서비스에 저장되면서 해커들의 공격 목표가 됐습니다.</li>\n</ul>\n<h1 id=\"public-cloud---private-cloud\" style=\"position:relative;\"><a href=\"#public-cloud---private-cloud\" aria-label=\"public cloud   private cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Public Cloud &#x26;  Private Cloud</h1>\n<h3 id=\"public-cloud\" style=\"position:relative;\"><a href=\"#public-cloud\" aria-label=\"public cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Public Cloud</h3>\n<ul>\n<li>Azure, AWS, GCP, Alibaba, NCP 등 다양한 클라우드 서비스</li>\n<li>LasS, PasS, SaaS 등 다양한 스펙트럼의 서비스 제공</li>\n</ul>\n<h3 id=\"private-cloud\" style=\"position:relative;\"><a href=\"#private-cloud\" aria-label=\"private cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Private Cloud</h3>\n<ul>\n<li>조직 내 클라우드, 개인정보 관리 등 직접 구축할 이유가 있을 때 사용</li>\n<li>Public Cloud 사업자 시작 이전 단계가 필요한 경우 사용</li>\n<li>OpenStack을 주로 많이 이용</li>\n</ul>\n<h3 id=\"openstack\" style=\"position:relative;\"><a href=\"#openstack\" aria-label=\"openstack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OpenStack</h3>\n<ul>\n<li>Rackspace, NASA가 공동개발로 2010년에 Release한 오픈 소스 클라우드 컴퓨팅 플랫폼입니다.</li>\n<li>이미징, 네트워킹, 컴퓨팅, 볼륨 관리 및 인증 관리 등 클라우드 서비스를 제공하기 위해 각각의 자원관리 지능을 프로젝트 단위로 관리합니다.</li>\n<li>실제로는 EC2, VCP, … 각 역활에 대해서 호환되는 정도가 많습니다.</li>\n<li>클라우드 시스템을 구축할 때는 가상화가 필수 이며 이미지, 볼륨을 관리할 시스템이 필요합니다.</li>\n</ul>\n<p><img src=\"/ad9c44d89f3247960fbf97c3c28f8866/overview-diagram-new.svg\" alt=\"https://www.openstack.org/\"></p>\n<p><a href=\"https://www.openstack.org/\">https://www.openstack.org/</a></p>\n<h3 id=\"nova-compute-service\" style=\"position:relative;\"><a href=\"#nova-compute-service\" aria-label=\"nova compute service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nova Compute Service</h3>\n<ul>\n<li>OpenStack 에서 가장 중요한 서비스에 해당되며, Hyper-V를 호출해서 각 인스터를 생성하고 관리하는 역활을 수행합니다.</li>\n<li>대시보드 등에서 RESETful API 형태인 nova-api를 통해서 인스턴스 생성 등의 명령을 전달합니다.</li>\n<li>Nova-Computer 를 거쳐서 Hyper-V에 명령을 전달하고,최종적으로 명령을 수행합니다.</li>\n<li>생성된 인스턴스는 nova-console을 통해 통신이 가능합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 141.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGD0lEQVRIx5VWe0xTdxQ+bfHB1GX7wzlZgmNZyN5xuO2PxW2yzEFgy5KZIUSjzMTGiaBkkkmQDMPS8FhBHkrHyxYQyvuNUJHHagtFS3ClUGjT2t4+6C2V0gctoN7l3FHGpnHZSX5pe+653+93v/Od7xZ4PB5ERESAz+cDiqJAoVBAXV0dIzMzE8RiMZ3zr/r6Bgafn81sb/+N0dJSAo2NxfBExMfH4weTIIhCkiS7BgYGXr9+/TqUl5dDT0/PwYmJiYbp6enGoaGhrzs7O6G6Ohu6u8uhs7OM0drKexIQdzYYDBeXl5cpXFarVQoAOzAvFovPezwe6tGjRxRBEMWY6+qqZPf1VR24dasWensFDMzl5ORAbm4uxMbG/gWo0+mSfD4fDTg3N9cLAIGY7+vrS0HAx48fU1qtloe54uL0ivr6vKOXLrHh4sUTzKamJob/cC6Xi7F+SrVafUan0+UmJibuQF4BYGtOTk7oyMhI0vj4+LmamppwANi0kVNcfD4fazcDwBaHwwEgEAigurp6p1QqFajV6lq5XF4EADuxeGBg4IBcLv9dqVRKbty4cYzL5e5TqaZndDqdXiaTXcaasrKyfR6PZ9rj8WilUuleEAqFUFtb+6rVaqUwFhYWHADwChb39vYmOJ1OanV1lTKZTIXJyclfzc/P05w6nc5BrNHr9f1IF1JDkuQQfUI+nx9sMplormw2mxUAgh48eAA3b9485nK5qIcPH1Jms/nXpKSkL2w2Gw1os9luIeDIyEjy0tIShXXYCzh8+DCcPHlyk1gsjtRqtYdkMlkEALyAUqqqqgouLS1N4vP5STweb294ePgOmUwWKZVKY4VC4WcAwFjTbvTU1NQ3+J0mlsPhwOjoKFitVpiYmMAcXdjU1FSqVCpJhUJhrKmp+WFjM8bGxjbKDkwmE/0dwsLCgM1mM1JSUgKuXLkS0NHRwVKr1QEqlQqGh4cbkb+VlRXKaDRy1sCw00yZTMZEwKKiIuSRiautrQ2Qp1MlJSV7UHuBgYHb8DHsdjvLbDaDSCTikySJYqc0Gs0vFosFjEYjC54VV69ejYqOjg4GgO0sFutFBPT5fIzm5mbIysraYzAYtCRJLnV0dHwsl8tBqVQy4T/ieexqcHDwtqioqIDQ0FBGRkYGaDQa5t27d5GrPVKp9D21Wo0GQnP7zEhNTWWWl5czx8fHsQk0sXFxcf+Y9Y0gU1PDMDravb6eag4ajQaKi4t3CQSC1/B3QkICVFZWQlpa2vYLFy6EpKenhxw5cuS5srJK+PfoPRH37t3Dbr7tdrvnsKNqtfr7mZkZ6O/vx3yCxWKhcDoUCkXa5OQkgrD8snoqICbNZnMFSgPdxmazEQDwEuYHBwdTMYdBEEQR5mprL3e1t/OSmpsL4No1Di0VgiBY2H1aNrOzsyCXyz9wuVyE1+td1mg0p/27t7a2xrvdbuvq6iqpVCozMBcbG/7p0aMfvpybewnu35fTJyUI4m9h4/FXVlagpaXlS5FIdGLtMVAamzkczu7s7OxYLpcbx2az34mJidldV9f4OZ9fHV1QUPCuf+Pp6elDKpXqO/pePOGdO3c+8nq98/hoEokkHRF7enpw8ONR1IuLi9Ts7OzP+fn54Wgia0bQgwCjo6Op6DZerxdN+Jyfw3JsCF5wOBxaNFKJRIIaPIU34zWj0ZifmJj4rd1up93G4/H0r9nXAIJhnc1mEwHqTyKRvLG4uHgfOezv7z+DhTgpUqn0E5Ik/0ADNRgMp8+ePfu+xWKZ8nq9Bo1GU7lmsGFut3vS6XSqxGLxW/QJPR4Pvjp39fX10ToMCgpCS2cJhcKDXC43LTMz83xcXNybOJZr/G4BgADkv6Kiws85E2fdD8hA5xaJRH7BMvGzu7u7c2FhAd2ZGhwczMJcXl7e1o2Sa2hoWH9JkSTJWFf87du3GWNjY4zCwkKcHBbuJpFIWpAbh8NB2e32NP9m+/fvh5CQECgtLaWBjh8/Tr/fY2Jinj7fSqWShf8g2trafpqbm0OyKblc/qNer6evwf8N/IfgP7ler88zm811kZGRgQUFBbSzPyv+BK8SuqV/N8AYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"https://docs.openstack.org/nova/pike/user/architecture.html\"\n        title=\"https://docs.openstack.org/nova/pike/user/architecture.html\"\n        src=\"/static/c465a15b2718d776f9adf0c859731e9e/37523/nova-arch.png\"\n        srcset=\"/static/c465a15b2718d776f9adf0c859731e9e/e9ff0/nova-arch.png 180w,\n/static/c465a15b2718d776f9adf0c859731e9e/f21e7/nova-arch.png 360w,\n/static/c465a15b2718d776f9adf0c859731e9e/37523/nova-arch.png 720w,\n/static/c465a15b2718d776f9adf0c859731e9e/302a4/nova-arch.png 1080w,\n/static/c465a15b2718d776f9adf0c859731e9e/07a9c/nova-arch.png 1440w,\n/static/c465a15b2718d776f9adf0c859731e9e/dca52/nova-arch.png 1550w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>)</p>\n<p><a href=\"https://docs.openstack.org/nova/pike/user/architecture.html\">https://docs.openstack.org/nova/pike/user/architecture.html</a></p>\n<h1 id=\"aws-iam\" style=\"position:relative;\"><a href=\"#aws-iam\" aria-label=\"aws iam permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS IAM</h1>\n<ul>\n<li>AWS 리소스에 대한 권한 및 접근 제어를 리소스별로 세분화하여 제어할 수 있는 서비스 입니다.</li>\n<li>Group, User, Role, Policy로 설정이 가능합니다.</li>\n<li>권한 상승, 유출 문제 등 취약저 분석 과정에서 가장 눈여겨봐야 하는 부분중 하나입니다.</li>\n<li>주로 구축했던 시기에 취약점이 발생되어 노출이 되는 경우 입니다.</li>\n</ul>\n<h3 id=\"pbac-설명\" style=\"position:relative;\"><a href=\"#pbac-%EC%84%A4%EB%AA%85\" aria-label=\"pbac 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PBAC 설명</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[사용자]\n피터 - 기사     &lt;그룹: 공격대1>\n케빈 - 마법사   &lt;그룹: 공격대1>\n레이 - 힐러     &lt;그룹: 공격대1>\n\n[그룹]\n공격대1         &lt;역활: ['몬스터 잡기']>\n\n[역활]\n몬스터 잡기     &lt;정책:  [일반 공격]>\n\n[정책]\nAllow 일반 공격 if 사용자.마법사? == True (MP Object 사용)\nAllow 일반 공격 if 사용자.전사? == True (HP Object 사용)\nAllow 일반 공격 if 사용자.힐러? == True (GP Object 사용)</code></pre></div>\n<ul>\n<li>관리의 용이성을 위해 동일한 그룹내에 사용자를 편성 합니다.</li>\n<li>편성된 그룹에 한하여 수행할 수있는 역활을 부여합니다.</li>\n<li>역활 수행시 그룹 내 정해진 사용자에 한하여 수행하도록 정책을 설정합니다.</li>\n<li>역활 수행시 정해진 객체에 한해서 접근하여 수행하도록 정책을 설정합니다.</li>\n</ul>\n<h3 id=\"iam-정책\" style=\"position:relative;\"><a href=\"#iam-%EC%A0%95%EC%B1%85\" aria-label=\"iam 정책 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM 정책</h3>\n<ul>\n<li>JSON 포맷을 사용하며 각 데이터를 세분화해서 관리를 진행합니다.</li>\n</ul>\n<p><a href=\"https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_grammar.html\">IAM JSON 정책 언어의 문법</a></p>\n<h1 id=\"ec2\" style=\"position:relative;\"><a href=\"#ec2\" aria-label=\"ec2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EC2</h1>\n<ul>\n<li>virtualization Compute Instance, 가장 일반적으로 생성해서 사용하는 서비스입니다.</li>\n<li>AMI (Image), EBS(Volume)을 이용해서 인스턴스 백업이 가능합니다.</li>\n<li>외부에서 Exploit 진행시 비중이 가장 높은 인스턴스 입니다.</li>\n</ul>\n<h1 id=\"s3\" style=\"position:relative;\"><a href=\"#s3\" aria-label=\"s3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3</h1>\n<ul>\n<li>업로드, 다운로드 등의 행위로만 구성된 Storage Instance 입니다.</li>\n<li>정적 웹 서비스 요소로 구축이 가능합니다.</li>\n<li>보안사고에서 자주 언급된는 S3 data breach가 이 곳의 데이터 유출을 말합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://s3.console.aws.amazon.com/s3/home?region=ap-northeast-2</code></pre></div>\n<h1 id=\"lambda\" style=\"position:relative;\"><a href=\"#lambda\" aria-label=\"lambda permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda</h1>\n<ul>\n<li>이벤트 기반의 서버리스 서비스 인스턴스 (Python, nodeJS, Go, .NET, Ruby 지원) 입니다.</li>\n<li>내부적으로 Amazon Linux AMI에서 생성되는 컨테이너, +egress controller</li>\n<li>API Gateway, S3, SQ3, SNS 등과의 다양한 조합으로 사용가능한 서버리스 구조입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://console.aws.amazon.com/lambda/home?region=ap-northeast-2</code></pre></div>\n<h1 id=\"aws-공격-벡터\" style=\"position:relative;\"><a href=\"#aws-%EA%B3%B5%EA%B2%A9-%EB%B2%A1%ED%84%B0\" aria-label=\"aws 공격 벡터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS 공격 벡터</h1>\n<ul>\n<li>IAM 의 권한 문제로 인해 많은 보안 문제가 야기됩니다.</li>\n<li>IAM Leak  (환경 변수, Instance Post Exploitation, SSRF…)</li>\n<li>IAM Privilege Escalation</li>\n<li>S3 Data Breach</li>\n<li>개발 구축 환경에서 발생 가능한 취약점 (CI/CD, Code Deploy, Terraform, …)</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#public-cloud\">Public Cloud</a></li>\n<li><a href=\"#private-cloud\">Private Cloud</a></li>\n<li><a href=\"#openstack\">OpenStack</a></li>\n<li><a href=\"#nova-compute-service\">Nova Compute Service</a></li>\n<li><a href=\"#pbac-%EC%84%A4%EB%AA%85\">PBAC 설명</a></li>\n<li><a href=\"#iam-%EC%A0%95%EC%B1%85\">IAM 정책</a></li>\n</ul>\n</div>","excerpt":"클라우드 서비스 취약점 분석 0 클라우드 컴퓨팅 보안 기업, 조직 내의 데이터, 애플리케이션, 워크로드를 클라우드 컴퓨팅에 저장하고 다양한 서비스로 활용하며 서로가 공유하면서 지속적으로 변화가 발생합니다. 이와 동시에 새로운 보안 위협과 과제도 생겨나며 많은 양의 데이터가 퍼블릭 클라우드 서비스에 저장되면서 해커들의 공격 목표가 됐습니다. Public Cloud &  Private Cloud Public Cloud Azure, AWS, GCP, Alibaba, NCP 등 다양한 클라우드 서비스 LasS, PasS, SaaS 등 다양한 스펙트럼의 서비스 제공 Private Cloud 조직 내 클라우드, 개인정보 관리 등 직접 구축할 이유가 있을 때 사용 Public Cloud 사업자 시작 이전 단계가 필요한 경우 사용 OpenStack을 주로 많이 이용 OpenStack Rackspace, NASA가 공동개발로 2010년에 Release한 오픈 소스 클라우드 컴퓨팅 플랫폼입니다. 이…","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 0 (클라우드 서비스 취약점 개요)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-0/"}},"next":{"id":"fd3424cb-3a5d-55af-a909-b515988cc73d","html":"<h1 id=\"클라우드-서비스-취약점-분석-6\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-6\" aria-label=\"클라우드 서비스 취약점 분석 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 6</h1>\n<h1 id=\"scenario-5-ec2-ssrf\" style=\"position:relative;\"><a href=\"#scenario-5-ec2-ssrf\" aria-label=\"scenario 5 ec2 ssrf permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 5]: EC2 SSRF</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Size: Medium\nDifficulty: Moderate\nCommand: $ ./cloudgoat.py create ec2_ssrf</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>VPC (EC2)</li>\n<li>Lambda Function</li>\n<li>1 S3 Bucket</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>Solus IAM 사용자</li>\n<li>Lambda 함수 읽기 전용 권한</li>\n<li>Lambda 환경 변수안에 하드코딩된 Wrex Access key</li>\n<li>하드코딩된 민감한 데이터 정보</li>\n<li>웹 애플리케이션의 SSRF 취약점으로 인한 AWS 메타데이터 API를 통해서 다른 Credential 접근 가능 여부</li>\n<li>Admin Credential 정보가 S3 Bucket 내에 하드 코딩되어 저장</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li><code class=\"language-text\">cg-lambda-/cloud goat id/</code> 람다 함수를 실행합니다.</li>\n<li>Solus IAM 사용자로 시작해서 Lambda 함수를 읽을 수 있는 권한을 발견하였습니다.</li>\n<li>SSRF에 취약한 웹 애플리케이션을 실행하는 EC2 인스턴스로 유도합니다.</li>\n<li>취약한 앱을 Exploit하고 EC2 Metadata Service에서 Key를 획득한 후 공격자는 Lambda 함수를 호출하고 시나리오를 완료할 수 있는 Key를 획득함으로써 권한을 탈취를 합니다.</li>\n</ul>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADYUlEQVQozz2SbUxTZxTHD6Jt7y3KHCVe7/Pc3ra0UiogIO3tpS0T1BZKGdxBILXQdW7JkpEZN4wjkoEN5WVWhdJiYtwSE5NNui++ZsliYqzLTJYte8n2YX6bbNGEZIGtrUN7+ywXl306OR/OL7//yR9MJnOZbW99h21vQxPseaNEcAdGBXfXDcHd9ZnD1ZX2tEnpbun1dKA3nBZbu5cFl39ZcAeuCu7ATYer6wgAgMls0yLEUhhjFXAYU1ZbnXGPgWff/Y2Avcl9WnAe/kFo8X5ldxzIeFo77vdKwUyPFPpadHc8cIjeB4Lz4D3B2f6dvdn5ZvDsBvCY0WK9gUKIVQNnqNIAQGnDOwmtZ/7HmparhPf8QrbbZwhtnyJ68wmCKiI5PRx6tEOcJpVijFiEKKlujBJ908lnBnHk2+pqR5+WqaA0nN6kBovQQxNCoH585cDwFULGbxVJ6/w/y/7o+mRoUSZHLxTy4ZRMOmP5i90zuUtDSZlElgrPwqlCIZySiwPz8ppr5BszAGyxNPo0ULvPQyt/6B+52xyb/eKni8lrD9+fyJx1fLDW3jObXZTmcvHAdG6hfXx1oG1s5eCrM9l4z2x2tncuG5fmsmc6omvHa7yT5bptoObNdWpA7G4N4s2UoQTUALAVANQnCAH/VPZUaFHORZbk34cW5XxnLH9OfDvD950rPh5KFtfDqeJqMEGK/lh+YqpIoPaVt7YjllEDxliDEUshg4WyCi7K6fMrxtu8k38elT56erk/nr/Ud+bpZe/pv97bH/lSL47+ccw38eTDQPTJmOfk41PCsYftSlxDTQuNMX4BRAhRGHOU0SrSaAuo9N4LFQPnn38fTsn54aS8OpyU/x5cKP7KSPfaSlqWP9H5b19jum+nd/qu34D9V4YhQ6DS5NJuAhFCm0BlcnojZbE5FMPS1+bWRwfPb9wJzm/cDCU27gzEs5N6b1K3w5U00kLCSAsLBlpcqnqpebzS8DKoEWei/jfEGCuL0iPK6hws+5QQ8EXXj4cShUeR1POfgwuFlcB0dlr5cWcDqAIApX6ArRJAqbUcVCxnpPCLYm8aqv+z1KDN+FjDIUaDm4bK6H1j5bsOfayr6r/F1g5+vqtGPKLVMTy129hIMXwdxfD1FMtZFJhyp6RU/QsMJCoiwHYKywAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"31.png\"\n        title=\"31.png\"\n        src=\"/static/2a0f2b90f16f2cf7664ca2f7b323a795/37523/31.png\"\n        srcset=\"/static/2a0f2b90f16f2cf7664ca2f7b323a795/e9ff0/31.png 180w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/f21e7/31.png 360w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/37523/31.png 720w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/302a4/31.png 1080w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/07a9c/31.png 1440w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/4435f/31.png 2479w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"시나리오-환경설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환경설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0klEQVQoz1WSbW+aUBSA77TaNzvBNzoRQRCKgNJSUbQFZbVWl23N2ixLti/7/3/iWSRdsn14cnNzbs45zzlXhDcprjfDtG9oKxatjkVHGdKQVOSmgap5WE5Es21ycqZwftGlXGkiRA0h3iOE/Eadd2UJ8fL6i/tsyyrfF2w2n8l2r/hPP4imKav1ns32K49Pz0V8nX8izbYE4wWLNGH7zWG6UugabarHHUS23mHZY1TNode/Qtdd2kZAxYpRLk20vku7Y9DTbPp9B91wi/cDc8KVP2SaS0yWdXRboXqiIFx/XugoH2z0wRi176EbAbrm0jfGdLURXdVF0QJkdcyZPECI8zcuEEL6R7mOOMyvczlk5M+5jdeEN/dMZzlhlHL9xsiLccMMO3pE6XlUjpvFvEpHMuWqTLkiUarIxV2Yw2saLQNzGBJMFoz8GUG4xBhe43oxXpAwsEL8ccLd/RbPnxXLOyyoctLiqCoVlP8m1PSAC0njcB66tZxbfH+OYwZYdoTjxoW6M4oZ+UnxGxqtAbW6Sqnc+k9ZHJR3+2ei2wVptiH/uGfzsCPZvdDIvxPPU9b5UxG/Sx/IVo/MkxXRdFEUjRKbL79P2f+sES17nJ6p/AHJr+Phzu/hiAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0\"\n        title=\"0\"\n        src=\"/static/d801f8e70d81855a1dbee0d30756c74c/37523/0.png\"\n        srcset=\"/static/d801f8e70d81855a1dbee0d30756c74c/e9ff0/0.png 180w,\n/static/d801f8e70d81855a1dbee0d30756c74c/f21e7/0.png 360w,\n/static/d801f8e70d81855a1dbee0d30756c74c/37523/0.png 720w,\n/static/d801f8e70d81855a1dbee0d30756c74c/27b7a/0.png 804w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<ol>\n<li>IAM 에 포함된 Solus 계정을 토대로 AWS 환경을 분석하고 계정에서 Lambda 함수 리스트들이 있음을 확인하였습니다.</li>\n<li>Lambda 함수 내에서 공격자는 다른 사용자즉 IAM 사용자 Wrex에 속한 AWS Access key를 찾습니다.</li>\n<li>IAM Wrex 사용자 로 작동하는 공겨자는 SSRF 취약점에 취약한 웹 애플리케이션을 실행하는 EC2 인스턴스를 발견합니다.</li>\n<li>GET 메서드로 요청을 보낼때 <code class=\"language-text\">url</code> 파라미터를 통해 SSRF 취약점을 트리거하여 공격자는 EC2 Metadata service에서 AWS 키를 탈취합니다.</li>\n<li>공격자는 EC2 인스턴스의 키를 사용하여 권한이 더 높은 사용자인 Shepard에 대한 다른 AWS Credential 가 포함된 Private S3 Bucket을 발견하였습니다.</li>\n<li>Full Privilege으로 Shepeard인척 공격자는 원래의 Lambda 함수를 호출하여 시나리오가 완료됩니다</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token constant\">IAM</span> <span class=\"token operator\">:</span> <span class=\"token function\">Solus</span> <span class=\"token punctuation\">(</span>Read Only Key Access<span class=\"token punctuation\">)</span>\n\nLambda <span class=\"token keyword\">function</span> list <span class=\"token operator\">-</span><span class=\"token operator\">></span> Secret key\n\nWrex <span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span></code></pre></div>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"solus-key-정보를-읽기전용을-접근\" style=\"position:relative;\"><a href=\"#solus-key-%EC%A0%95%EB%B3%B4%EB%A5%BC-%EC%9D%BD%EA%B8%B0%EC%A0%84%EC%9A%A9%EC%9D%84-%EC%A0%91%EA%B7%BC\" aria-label=\"solus key 정보를 읽기전용을 접근 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solus key 정보를 읽기전용을 접근</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABv0lEQVQoz02S227aQBRFJ0BTghKCAySBAGPA+DJjjy84NpBAuDxUavvW1/7/b6wK09vD1pbO1lnaRzNi83bED1KiuMCEGXa6pZWe8N0I14uZOxqtU5ROSdISpUryd5uvP5vsvlsMRxNuWgNu2y9c1TuIkdT0nxwW3hI5jbBnhqkTM1+kjKVGzgy9scEaBNQaFrV65+KNTqUz5I/OczGaKM7KiwMqXKHNmiTbEWdbXH9JGL/hJkfkIue62UNctX/DrP/8n8RwFPA0WFCsThXQxBtUkGPSLY6bEYQlRXmo8sGLT7szptboIUQHISxE7dJO1O4v7rgJcqopVkfieI1efjA27yTJGl/l6KjApBtCs2IsA/qPc55enpH+HcOpReuuT+O6y+ebR+qfHhAmXuH6abWoVMbMbGj7awI/ITQlXpAibYW0A+ypYjD0sN1nzKZJkFk89IbctJ6xurKCio/DN7J8x2t5YPn6QbY6ESz36LDgbfuF/fGSn7Nzy4kMcVWEFzlY/S7Xze7l1Kv2xQOVMV9EVRPfNYx0yW24Yz4NsGeKifSr77PwYnSU4/mvZGuH04978r3F42BEvdH9+yi/AJ9y31R5GIyHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/f68b2b48d6f5941ae953cf6507a51eff/37523/1.png\"\n        srcset=\"/static/f68b2b48d6f5941ae953cf6507a51eff/e9ff0/1.png 180w,\n/static/f68b2b48d6f5941ae953cf6507a51eff/f21e7/1.png 360w,\n/static/f68b2b48d6f5941ae953cf6507a51eff/37523/1.png 720w,\n/static/f68b2b48d6f5941ae953cf6507a51eff/a2b88/1.png 908w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 클라우드 환경을 분석하면서 <code class=\"language-text\">start.txt</code> 문서로 AWS Credential 정보를 읽기 전용으로 해당 정보를 확인할 수 있습니다.</li>\n<li>AWS Credential 을 사용하여 어떤 AWS 작업을 할 수 있는지 확인하기 위해 IAM 리스트를 열거하여 정보를 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrUlEQVQozyWRS2+bUBCFaVq1aZtiYxMImLcB8zDmZQcIGIdEVhS1UdSq2+6qbvv/V6ea6eLqSvM4880Z4fH8DW03oap73LYn9N0JzvQDxekrhn5C1z9wvGknHO9HvP5y8PO3jz/NGX+D73ixB7hJDT8oMZMsCMP4jCi5heNlMO0U2moD3Yyh6iEsZ4uVGUM3Is4ZVgzTjmG5CQwzhmWl/Cjv+QVkZQ0hK3pkeY+8HOCHFUTJxEJ28GVmQLkJcPlJxbW6xnxh40pcQVZ8LGSXaZaKB2npQJybEOcG1wrt3Rn1YUJeHUG0JBpGe6ajQYaV8O+uc9huhiy/Q5K1THWjh0xmezuGePN2DqHa3yPZtgg2FTdSQZw23FxUIzemWYtNcuA41dLQNOsgKx6uRB0zyWT6i3cShH58ZsJd0ePQPDJdXh6xDkocmgeoWoBueGLRsh7ZmqI6suCHjwqvyULCZwgXMyI8cXEQ1SxKq4bxno9AjbTyrhj4cPH2PyHlKUYr0xHJR6JkD6nAYQ9caKuIk3QtMl03YkhLmympWdVCKFrAjzyjGK1KQvS/v7zGP5vd51P8LLYfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/23b70d53f44d3cd1846e298d9f2f597c/37523/2.png\"\n        srcset=\"/static/23b70d53f44d3cd1846e298d9f2f597c/e9ff0/2.png 180w,\n/static/23b70d53f44d3cd1846e298d9f2f597c/f21e7/2.png 360w,\n/static/23b70d53f44d3cd1846e298d9f2f597c/37523/2.png 720w,\n/static/23b70d53f44d3cd1846e298d9f2f597c/3a737/2.png 897w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 리스트를 통해서 Lambda 서비스를 이용할 수있는 벡터가 존재하는 것을 확인할 수 있습니다. 이에 관해서 좀더 분석을 하기로 했습니다.</li>\n</ul>\n<h3 id=\"lambda-환경-변수-데이터-확인\" style=\"position:relative;\"><a href=\"#lambda-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%99%95%EC%9D%B8\" aria-label=\"lambda 환경 변수 데이터 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda 환경 변수 데이터 확인</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABuUlEQVQoz5WS6XKiQBRG2y2OCCKCIIi4sa9CAJM4SZyZ93+mb6qvVVacibP8+OoW3cXpc/s2y4oXJNkz/LCGF1SwnRj2OoFlh9jscjibFIOhhk5vim5f+WtYUb2iqt8JWj6+oazfUTVn5IevtB7GDYYj/d+BHBRnT/CCR4KGcYswabH3Svp2/er/DKv6jLr9hqw4kdElZyT5xdi0w7s/f3YIi5IjeNygItMgaih7v7zaMSaBdWWw7gSsc0mnP/0Uzrhdc/yBNH/BoXxD3X4nwyw/kbU630EQTYyEBQTRgiSvMJYsdHsKGONw+QrjlfFN1djA2rqwtns4XgjHC7BLIqw8H2s/gpdlcLMEXp4iLAssVi4mqgVRWUCQjVtD3m5aPCNKGyTFEWX9iqI6IS5apIcnmCsfI0nHcKxhKGoYjlV8ETUIEx1j2aC9GyC/fN7axylH8eVed/sD+g/qtbV7uWl5brgwTA+avsPSibGwfHrUY8mkgfQGClUO7j/MqP5p4kySbZjLgKD64gI2LB+CZEJRN5jOHKjzLUWSl7TWG8zuvksC8kymK0xna8iKQ3akT0/l93xs8VfgT+c2L1gitvQ9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/fcd67411f58be4230dbb56177c6920f4/37523/3.png\"\n        srcset=\"/static/fcd67411f58be4230dbb56177c6920f4/e9ff0/3.png 180w,\n/static/fcd67411f58be4230dbb56177c6920f4/f21e7/3.png 360w,\n/static/fcd67411f58be4230dbb56177c6920f4/37523/3.png 720w,\n/static/fcd67411f58be4230dbb56177c6920f4/59000/3.png 917w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Pacu를 통해서 lambda service 에서 <code class=\"language-text\">cg-lambda-id</code> 호출하는 값이 있는 지 확인한 결과 ENV 값으로 EC2_ACCESS_KEY_ID, SECRET_KEY_ID 가 있는 것을 확인할 수 있었습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">]</span> <span class=\"token function\">Secret</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">ENV</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token constant\">EC2_ACCESS_KEY_ID</span><span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ACCESS_KEY</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n[+] Secret (ENV): EC2_SECRET_KEY_ID= </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ACCESS_SECRET_KEY</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>대상 람다 함수는 AWS 계정에 존재하고 lambda 함수의 환경변수에 일부 하드 코딩이 되었이기 떄문에 이는 AWS Security Credential이 있는 것을 확인할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7ElEQVQozz2QSW/aUACEX5sQDCEQMLaxzWLg4QW8YCANZGFJkzZqSpYqyiE95NYql3Lo/9dXkUo5faPRaKQZsVxdM50tmS+u+DRdsFpcEi6/01m/MBpNCaMJrhfj+Qk9NyLop0TxBN+fkBw5XD/nuXoqEAwtlJyFiIdn9KMpQXiM9FKS0TmePyaJpgzHc7zgiG3GqgdUjS6aId+p6l2EKCNECSGKZLJVRDqeEyUnRPGCMFwwGl0QTZZkKm1KhzaVaotSuY6qOahV541bb8vDSgMlr7F/YJDb18nmNMRms+Hx8YnXzT2//qx5/b3m/OWV8s+/fF5esL59YL5YcXNzy93dD66+fKPRcmm0vDe2O30Ms42mN1HyOuJ4OmeYnnB5b3HzbPP1QdLqRWhOTLsTYdoumtHBMOWbrupt8gWT4mGDQslG1R12MmXEhyJ728lVQyK9CcWSRMoZ/cGcYXJKzxlQs332FJ2MorG7p7KTUfmYqZDNGeQKNbKKiRDq+4+ZrIoIBhM63RDXH9IPx/T7KU40oxovkDLCC0Z0ZIR0E1w/xfNTknRGGM2IxwPSszLB+ACzqaPkagjZi6lZXey6i2n3aNQl5VbIbnuEYThY9R6q1sS0JaYlqTdcGk0Py/ZoSYvh+T7JaRG7/b/wH4sC5g/zF08nAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/5516bb3559eef107fcf086c5cc07eb45/37523/4.png\"\n        srcset=\"/static/5516bb3559eef107fcf086c5cc07eb45/e9ff0/4.png 180w,\n/static/5516bb3559eef107fcf086c5cc07eb45/f21e7/4.png 360w,\n/static/5516bb3559eef107fcf086c5cc07eb45/37523/4.png 720w,\n/static/5516bb3559eef107fcf086c5cc07eb45/e1031/4.png 803w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>사용자 Solus에게 <code class=\"language-text\">lambda:InvokeFunction</code> 권한 이 없기 때문에 직접 Lambda 함수를 호출하려는 시도가 동작하지를 않습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVQY03WQWQ+CMBCE8SASD8BaqNxyWYxySXzQaPz/v2pMm5gI6sNkt+1+m5kq9jYDZSkcr4DoCY2hmwE2VgJ1RjGamBhP17IO9b4X9S3FJBH2RYcka5DxM6K4RLg7YbFyfwJCE5X03j5nFG3O0HZPHKsr6vYBfrigau4o65vsmbMHtRPpnNAdLJbJNOIsFn85FLEcjyPnHeK0lsOuX8jIW4+DObmEN1YMbW5DGRtfkXsODRLCWAfQTV9Cwo3QUnd78BD89x0vE9J44mP6XSgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/ada45d5e440be5b12d3473496dd033c2/37523/5.png\"\n        srcset=\"/static/ada45d5e440be5b12d3473496dd033c2/e9ff0/5.png 180w,\n/static/ada45d5e440be5b12d3473496dd033c2/f21e7/5.png 360w,\n/static/ada45d5e440be5b12d3473496dd033c2/37523/5.png 720w,\n/static/ada45d5e440be5b12d3473496dd033c2/65654/5.png 872w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"lambda-기능-나열-및-분석\" style=\"position:relative;\"><a href=\"#lambda-%EA%B8%B0%EB%8A%A5-%EB%82%98%EC%97%B4-%EB%B0%8F-%EB%B6%84%EC%84%9D\" aria-label=\"lambda 기능 나열 및 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda 기능 나열 및 분석</h3>\n<ul>\n<li>lambda 환경 변수에서 유출된 AWS Credential 을 PACU <code class=\"language-text\">run aws__enum_account</code> 사용해서 추가로 나열하여 어떤 Credential 이 있는지 확인하였습니다.</li>\n<li>해당 Credential을 확인해보면 IAM 사용자는 wrex라는 것을 확인할수 있습니다.</li>\n<li>해당 Wrex의 정보를 토대로 IAM에서 사용할 수 있는 서비스를 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 93.88888888888887%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/0lEQVQ4y12U53LbQBCD6RbHVtStXq0ukaIaVajiHuf9nwiZbyl6nPzgUHfiYbEA9pyJt9VkutN8+SR/cVSh1FW9ObF3s+0pX3hUtT6ydTrbUKPlqvU4VSpT18/7kpLpmu3z++IqI2e3/63Z8qRl8Kz98Y+6/YUWwbMGo0Cr9au9g82b1rt3+ybYvCrYvtmeOw1tTYFiuaerm5yc6fyg4XitibfTYvVkDADhDftSpa/H7kz+/KDRZKORuzEgzgzGgcrVoZyLlJzLtC6vsxFDgKgaHj7VGyy1WD2rN1xqtX6xtt3pTrvDp6azvbH050ctgxcDpaC1epmOnpghh2aLk+nHGqCxu1W5OrAi/Mc6ZgfTan2sX6ma7hJl3SVKur0ryvFmeztMW93BwrRAk7jV3NmUTm9u3/HUmhO1O76Klb4qtaEVhUgm15SDu1T2zu2g3djd2AHXD1WpjzQYrUwGdKRtGM4WRwOBfe6hrZvbfGTKavNqYPPlyZyEnefvjR17tcb47PiLFQKUtnk8P9Rogo4DAyVKDrZPZwfL4Tb8UH+4MkBa9M8s6GCze7c1BsKWb+gom28bMxw2l+OWAcU5mBEXmLJXrg0tm4AxAESHiFEQeQBM55oqlHq6/1WRQ2X0oBoMaY/DgFCMQ7RHbAg8RWEJQwxiUky7i1TEkExFsQm/hEaXKH+hOQgb4kWx4WQdBfz8sNfq+DaalsPvweY3LbMm2LAxYD+00MMYc2C63r6ZVBAgbolkJQL8l+FJ9Zb7jeHOHKR9GBJmdAQIZrzJ5EOxq2S6rpvbBzmb8MPiQWUuB9oDmHzFucQE2KPt/05TjNsmkazq+kdeDrqhBQwBbrQ9Y4jLMGQSiBL/EWqKUWDsbZUvdJTJtezqcpxkNNNoQTyoynXFhBBemM5XT9YSkjAArt2bp6+5hwRFcBqHvwDj2CA8AqNrHJu6xebc8vxoRYP4zDrKLbNOuxYfxMfy0nnAGSEuiGy+ZYYwTrRWqY1sHwkIMZcHD7Hincm3TMu/QsgunJHa4XgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/7c79d4446da6d59f0b639a1e228b0948/37523/6.png\"\n        srcset=\"/static/7c79d4446da6d59f0b639a1e228b0948/e9ff0/6.png 180w,\n/static/7c79d4446da6d59f0b639a1e228b0948/f21e7/6.png 360w,\n/static/7c79d4446da6d59f0b639a1e228b0948/37523/6.png 720w,\n/static/7c79d4446da6d59f0b639a1e228b0948/0955e/6.png 901w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>생각보다 많은 서비스에 대해 권한을 갖고 있는 것을 확인할 수 있습니다. 실행중인 EC2 인스턴스가 있는지를 확인하겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSElEQVQ4y6WUW2+CQBCF17s1FhEQtUUFRQG5iogVbZs+9f//otPMNCa1T4IPswE2fDmz58wKSTZgzLd4Hhjo9SdotlXUGjLqzWGlEu3uCEFUoLh8w/OP6DzpEPVBdSApslYxgrjAbOGj1dEeU9hoKVhYIaLkAnMZgd4fApJCanWXfaIvvULUJN6oCmWF1PJqvQOd519QFaighWDuNmdD/kPKQgX9QAptJ+XIUMvk8rWu0HvB3PKL4WJquJiZAT+T24PhHN3ebYTugbIpYXyGH74hiE7w/Bz7wxe77vo5xtN1qVwyMEk/ECZnBmU5wc78TZ/Y6PbG5V0mU6gcL4PjHbBxM9ibHRTNuhnFu1r+Hb0TZzFJ3xHGBdbOHuqoPIyBNGoEsOwE9iaFFxxZLV0YimaWnmsxVE1I8gyyMoeqL1kZnR3dPlVy+AOqh1/X1NZ1XgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"7\"\n        title=\"7\"\n        src=\"/static/7a2ced0401f6bb877805f69d1a1b7261/37523/7.png\"\n        srcset=\"/static/7a2ced0401f6bb877805f69d1a1b7261/e9ff0/7.png 180w,\n/static/7a2ced0401f6bb877805f69d1a1b7261/f21e7/7.png 360w,\n/static/7a2ced0401f6bb877805f69d1a1b7261/37523/7.png 720w,\n/static/7a2ced0401f6bb877805f69d1a1b7261/42d54/7.png 858w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>전체 지역을 대상으로 ec2에서 사용되고 있는 전체적인 정보를 확인하였습니다. 필요한 정보들을 추려내기위해 세세한 정보들은 aws query 문을 통해 손수 검사를 진행하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQY0y2Qy27aUBRFb+y2qtqowRhqNcEE/Gjsi19J/ABbNthAIMkgijLrtP//DavFYrC0B2cfaWmLTXskzWvWmwOb7plu80S8e2dcPJM+lv0tSgqWZduzKlua9Z6yPNC9RHz8ndK+GcSpj6KOEHM7ZBGeHnZYTsTd3T3GPOLL2EHTJmhDk8Ep9WnPcDRFH8/Q9BnGzS8sqTNxNLSRgaIOEfX6iaxoesOq3tHUW7zqiP6wJY5ykocSGTz2pmnekOVNb5llHfU+5PWPyWo/Jk4XKKqOmFkxY8PlxpTcziOmVsxn5QpVfEWoGkL8OOflmW8I8f3MFUL8RIghQmgonwaI5aolLxoOx7d+ozwt8asDZvXKsqhZVR1BlGE5C+a2xP0d4vkJtp0Qpibl8ZK8G3DrTLhQhghfJnh+iOedihGBjLDjgut4he8F+DLGcSVSxvgyYhEkPb5/T5K5lNtrirWJ61lc/N/wH8nKsB44gEbtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8\"\n        title=\"8\"\n        src=\"/static/5dd966a09ac3fe04eca9bcb058233438/37523/8.png\"\n        srcset=\"/static/5dd966a09ac3fe04eca9bcb058233438/e9ff0/8.png 180w,\n/static/5dd966a09ac3fe04eca9bcb058233438/f21e7/8.png 360w,\n/static/5dd966a09ac3fe04eca9bcb058233438/37523/8.png 720w,\n/static/5dd966a09ac3fe04eca9bcb058233438/44fd6/8.png 789w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>인스턴스의 상태와 동작중인 서비스르 확인하였지만 기존의 인스턴스르 제외하고는 정확한 서비스 정보를 확인할 수 없었습니다.</li>\n</ul>\n<h3 id=\"ec2-내에서-동작중인-웹-서비스-파악-및-분석\" style=\"position:relative;\"><a href=\"#ec2-%EB%82%B4%EC%97%90%EC%84%9C-%EB%8F%99%EC%9E%91%EC%A4%91%EC%9D%B8-%EC%9B%B9-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%8C%8C%EC%95%85-%EB%B0%8F-%EB%B6%84%EC%84%9D\" aria-label=\"ec2 내에서 동작중인 웹 서비스 파악 및 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EC2 내에서 동작중인 웹 서비스 파악 및 분석</h3>\n<ul>\n<li>좀더 정확한 서비스를 파악하기 위해서 새로운 인스턴스를 시작하고 실행 중인 서비스가 있는지 확인하겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVQoz31RTU+DQBTcflJqtVRKt1uxUihQkALVkIp48GC8mSZ68mBi4834/69jdu0aGqqH2c2+tzNvJo/UmwO0OwbUIwpFNaCoIzTbOmoNDbx3CP/1yM/Rh3lxiWVSYDzxhCgn8TohxyCk94tDYuUaKRe4U8uO4XgrTK0I9jwVmJwHYOYC7MwXf8SgHSRX3mRPvdZHGN0gLx7hBxmus3tsP77wvv3E88sbnjav0I0ZSF1Dp0uFeKN1WnVYtr5MbrHOH7AIMzjuCnF6hzgtEERr8Y7iXAzlbilz0e0x4bQiKKcMRzZc/wozJwFlnoh+oploKcPd8sZ7sSuRy4J8uwadw5yGGOiWIPNoPJYkS6G/lvINDYqp9j8BcYEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"9\"\n        title=\"9\"\n        src=\"/static/f724cd7fdb961cfebf2e184fcc51f95a/37523/9.png\"\n        srcset=\"/static/f724cd7fdb961cfebf2e184fcc51f95a/e9ff0/9.png 180w,\n/static/f724cd7fdb961cfebf2e184fcc51f95a/f21e7/9.png 360w,\n/static/f724cd7fdb961cfebf2e184fcc51f95a/37523/9.png 720w,\n/static/f724cd7fdb961cfebf2e184fcc51f95a/0098c/9.png 775w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>EC2 인스턴스에 연결된 보안 그룹은 웹 서비스가 실행중인 상태로 나타납니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSElEQVQoz4WQS0/CQBSFpx3KQ+iDAqVMKaURaXm4QIOkSkBaxeLGlYkmro07///qmJlaNCbC4kxu7pz57rlDZhcRNnGK+dUSq/UW0U2MbZKCJc/wl4/YrBIsojVmlxHiZIfbzQPS3RPiJEUU3eHlPcTbZwevH0OcBQGIRA3UG3202RBm04dheqiqDqikglIdVGlALtQhF0xR5yKyASLrIJIFQizIclv4CD8qVRuq7sBxR+j5UzhuiBOVgVADfGAGzGpp38v7upDERY0MKCbJOmoaw2iyAOuG6PbGIm1myu5/4P9rD+QpPf8crjeBzQJY9kBAW/YAHSdAq30KpdQ8ChXAfA3mjrC4vkc4nqPXn0IzXAEpVSwUyy3k3oNAbigUG+IBVUzUNAdKuQlV76Kqdvbr/l75EJRwEE/BYdmE78+VNAH5++BYwi8uucJ8QY4r9gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"10\"\n        title=\"10\"\n        src=\"/static/ffcb78e788e575c97fb85e179b5d55ac/37523/10.png\"\n        srcset=\"/static/ffcb78e788e575c97fb85e179b5d55ac/e9ff0/10.png 180w,\n/static/ffcb78e788e575c97fb85e179b5d55ac/f21e7/10.png 360w,\n/static/ffcb78e788e575c97fb85e179b5d55ac/37523/10.png 720w,\n/static/ffcb78e788e575c97fb85e179b5d55ac/7fee5/10.png 781w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>특정 서버의 연결하기 위해 공용 IP 주소를 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxUlEQVQI1x3Oy06DQBiAUZbGxLpqgVqKAaJIsQPzzwUoBaMxJrJxWX3/9/iMrs72BEfl0XJCNR3Oz4g9491IdP4iVSd043lWnqoWxIy0esB3M8ZOaNOxXBKWnx3TR8HNak9QVgbfvyF2pqwsTwfH4eDI9Qt55YiinHWYEcYF8d0DmzD/d7sr2cQZ948xebUlLVKuriMCLQPT9IqxHSJ/W4/RhmhcyNoeaYSj0tS1otUWLQ7vB6ztEWNYLiGf32vG94TVbcIv/1BcnlOFPHoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"11\"\n        title=\"11\"\n        src=\"/static/5c23d07689ff38bd017888c5b48eded4/37523/11.png\"\n        srcset=\"/static/5c23d07689ff38bd017888c5b48eded4/e9ff0/11.png 180w,\n/static/5c23d07689ff38bd017888c5b48eded4/f21e7/11.png 360w,\n/static/5c23d07689ff38bd017888c5b48eded4/37523/11.png 720w,\n/static/5c23d07689ff38bd017888c5b48eded4/41d3b/11.png 774w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>80 port에서 실행되는 웹 애플리케이션이 있는 것을 추정할 수 가 있고 이에 따라 Node js 에러메시지를 확인한 결과 <code class=\"language-text\">URL</code> 이라는 파라미터 값에 문자열이 아닌 NULL 값이 들어가 있어 에러가 난것을 확인할 수있으며 이에 따라 <code class=\"language-text\">URL</code> 파라미터에 특정 문자열 타입을 입력해 보았습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABT0lEQVQoz5WPW2vCQBSE84vaxtREpSZuGo1asPSh/cUVkzyLzUUSUxXxQcVgvOBlylmsBFsoPfBxhmV3dkZ4KDMUiirEnIybWwnSvQJFKaJQKEGWFdyJOYii9Ac5SFIeeVmBUKs38fb6gkazhUa9BrNuotmo4bn1BKNqoqJXUWEGdKaC6Y/QNA2MVaDrBIPONKiqDsMwUSyVIViWhXb7HbbtwLZtOI6DTqcD27bQ7XbR633A9Tz4vg/PI7wzLlzXRRAE8Ak/4PeEyWSCMIwQxzHi+BNRFGE4HGI8HmO5XGKxWCBNU6xWKdbrNWe73eJ4PHKuRyCjfr/PoRREGIb8ZzojPRqNMJ1OkSQJ5vM5Nz2dThfTLMJgMMjU8LiRd65ImtLOZrNL2s1mg8PhwNOQKfGtecLdbscrZOvQpoekae/3+x8Vr40ulfHP+S1V1vALB4wKcLV2z00AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"12\"\n        title=\"12\"\n        src=\"/static/04d0488e3bb8d89c8ea645a71a7ab1db/37523/12.png\"\n        srcset=\"/static/04d0488e3bb8d89c8ea645a71a7ab1db/e9ff0/12.png 180w,\n/static/04d0488e3bb8d89c8ea645a71a7ab1db/f21e7/12.png 360w,\n/static/04d0488e3bb8d89c8ea645a71a7ab1db/37523/12.png 720w,\n/static/04d0488e3bb8d89c8ea645a71a7ab1db/1cfc2/12.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQY033M/06CABiFYa5I0UhzyFar7kBABPyV1yrO5gyX3oCEkHM5VJzQeBvW6i/7tmfnbGf7hOqNjKLcIddvKYoSpZLEdaWKJFUol68QxRKFgnhZUeT+4RG5rlCryQiabjIY9LDsLpZpYBgGva6Fbds0WzaaZmA0NRpqE11XUVUVs6VjWSbtdp9GQyf/0e706XSfEIbDIePnMa47Y7GYM3JGTKcvzFwXx3GYTCa8zufExyNxHJ8dDoffnouiiCjasd/vEdbrNZ63ZLPZEIYhK9//7kFAEIR4vs/xzYPlkvfVio/tlv9OSNOU0+lEnkmSnHuef1I+k4TsZ89lWXbRF+8VLWhfL3mIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"13\"\n        title=\"13\"\n        src=\"/static/7399373fdb0c330f2b2fd397d54662ec/37523/13.png\"\n        srcset=\"/static/7399373fdb0c330f2b2fd397d54662ec/e9ff0/13.png 180w,\n/static/7399373fdb0c330f2b2fd397d54662ec/f21e7/13.png 360w,\n/static/7399373fdb0c330f2b2fd397d54662ec/37523/13.png 720w,\n/static/7399373fdb0c330f2b2fd397d54662ec/fd84e/13.png 1056w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"ssrf-취약점-분석및-imds-기능을-이용한-정보-탈취\" style=\"position:relative;\"><a href=\"#ssrf-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D%EB%B0%8F-imds-%EA%B8%B0%EB%8A%A5%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A0%95%EB%B3%B4-%ED%83%88%EC%B7%A8\" aria-label=\"ssrf 취약점 분석및 imds 기능을 이용한 정보 탈취 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSRF 취약점 분석및 IMDS 기능을 이용한 정보 탈취</h3>\n<ul>\n<li>해당 웹 서버가 SSRF 취약점이 존재하는지를 확인하기 위해서 <code class=\"language-text\">link address</code> 를 입력 함으로써 출력되는 결과를 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVQY03WN7UrDMBSGe3Oz1aa2bsxfIl7qhI4KDga7CLPOpU3aNWlh+EgzygT1wMP7ceCcIBEpaTZHiIQ4FqTpPUkiuI0T7mJBGEbchBFRFHrGnKUPLOZzFoslL89PPGZLYpExm8UEq9cVxVvBbrcjz3M2m3eKomCdr9lut5RlyX6/pywvjF7KUaX3E1JKPqQk6LqOqqo4HA6cTidqXWOMQSmFtZbP45FO16CU50spdNPw3wTGaLS+Mh4z2nj92U+7xjS0bYvrnX9orcO5C2MOpnAprv4X1nrtXc8wDJzP5z/5BoheVa8iTJauAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"14\"\n        title=\"14\"\n        src=\"/static/1285c66d47051286d1f7a3e4c4e94476/37523/14.png\"\n        srcset=\"/static/1285c66d47051286d1f7a3e4c4e94476/e9ff0/14.png 180w,\n/static/1285c66d47051286d1f7a3e4c4e94476/f21e7/14.png 360w,\n/static/1285c66d47051286d1f7a3e4c4e94476/37523/14.png 720w,\n/static/1285c66d47051286d1f7a3e4c4e94476/302a4/14.png 1080w,\n/static/1285c66d47051286d1f7a3e4c4e94476/663b1/14.png 1313w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>확인한 결과 출력되는 값에는 해당 인스턴스의 환경 정보들을 확인할 수 있었습니다.</li>\n<li>이를 바탕으로 애플리케이션은 SSRF에 취약하고 EC2 인스턴스에 있기 때문에 IMDSv1을 활용하여 IAM Rule credentials을 탈취할 것입니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVQY042M7UqDYBiGPS5fPybqGLEW1I/OdEvGQnYI26vrCNoEbSo2dbqu8G1EBEE3XDz3Bzya70+wbQfLsvE8F8cZYVoOo5GDEAa6biCEwDAEhmnjuR5j32c6veXhbsaNO0EXFqYYM7t/RFsul4RhyGLxxPNqRRAEzOcL1us1u90LUkZE0YAkkpHKcshxzFb5mM1WslGbRNvvXzkcEo5vR9I0JcsykiShLAryouBcFFCWMNyBPL/6azdsVQXll9eqqqJpGtq2peu6b/q+V33XtlzaM5fzD1T3i6ZRVxsevZ9O1HXNX/rg//oEZddRvx9AG8UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"15\"\n        title=\"15\"\n        src=\"/static/8a68fc9aa7b7d7763976cb0ee89306cf/37523/15.png\"\n        srcset=\"/static/8a68fc9aa7b7d7763976cb0ee89306cf/e9ff0/15.png 180w,\n/static/8a68fc9aa7b7d7763976cb0ee89306cf/f21e7/15.png 360w,\n/static/8a68fc9aa7b7d7763976cb0ee89306cf/37523/15.png 720w,\n/static/8a68fc9aa7b7d7763976cb0ee89306cf/302a4/15.png 1080w,\n/static/8a68fc9aa7b7d7763976cb0ee89306cf/d4e7f/15.png 1416w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">cg<span class=\"token operator\">-</span>ec2<span class=\"token operator\">-</span>role<span class=\"token operator\">-</span>ec2_ssrf_cgid84kpkl3ssy</code></pre></div>\n<ul>\n<li>해당 Security-credential 정보를 확인할 수 있고</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRUlEQVQY0z2O707iQBRH+1aaLNSFokTMRuN+2Xc1SiPu+gh2pnzwT6MUaGc6AaHTaY+hLN7k5HfuvbnJ9c7ORgTBAN//yelgQBD06XRP6PV3M58fHZ+u32290+nS6w04Hw4ZjS64/n3N1fCCfnDK8dEJvy7/4N2GIX8f/3E7HnM/mXAXhtzcjQknD8g4ZjqdEktBLASxlEghESJqXUQRQkqiSPC0cyHw5nHMu5QsX15a8tc30ihCPz+TJgmLNAWt9xQFKLXHmH1/4H95TZ5TK0VtDI0xOKWo0jlNlmMWC5TWuLLEWUtVli2u3HttLY1zNFVFU9c0DXjJx4z32YzXJGnzI02ZZxnFaoUuCowxKKValsslWZaRK0WW5+1us93wudmy2W5Zr9d4xe6oKNBas16tsKXF7j6pqm+cc9954LCz1rYc/AtX5ZxkZe5/5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"16\"\n        title=\"16\"\n        src=\"/static/c969fcc59e84528c37b53d74dacc7fa5/37523/16.png\"\n        srcset=\"/static/c969fcc59e84528c37b53d74dacc7fa5/e9ff0/16.png 180w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/f21e7/16.png 360w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/37523/16.png 720w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/302a4/16.png 1080w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/07a9c/16.png 1440w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/ab3e6/16.png 1441w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">{</span> <span class=\"token string-property property\">\"Code\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"LastUpdated\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"2021-08-13T12:26:30Z\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"Type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"AWS-HMAC\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"AccessKeyId\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;ACCESS_KEY>\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"SecretAccessKey\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;ACCESS_SECRET_KEY>\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"Token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;ACCESS_SESSION_KEY>\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"Expiration\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"2021-08-13T18:44:43Z\"</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>탈취한 IAM Rule Credential 은 다른 IAM Credential 처럼 사용이 가능합니다. 이를 이용하여 Rule Credential을 사용하여 수행할 수 있는 작업을 열거하기 위해 AWS CLI를 사용하여 새로운 프로필을 생성하지만 IAM Rule Credential 은 Life-cycle이 짧은 Session_token이 있습니다.</li>\n<li>이를 통해 새롭게 추가를 하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABSklEQVQoz01Rx07DUBC0hIAUcUFKg5BeSHHv9vNzidMDR/7/TwbtBkscRvtmvTNbrKw2PjQjxkYNsdVCLD4duH6BJL0giPZIixtUPcZy7WKrRQzDlpjMDHR6c0arO0P3bYHmSw+KF5SQ2RUivXBM8xuEPCNOTojEkd+hOHID+k75rPhClJyY5+U3a87XH4wm2t2QRDK/sZDeXnjPhfGBDSiSITWgqWV+RRAd2JC4H5ZszIa0qmlLFtleDsvJ4Hg5w/V3nNcMActJYbs5dFNwjRfsYFiSoVsJDCvh9RXdTLiABI5f8P2omGDaKRveeclrVhP9R1XXH6yhkBmNTuvE8sz3ICGtKP44mRAsN2P40R6OV3CsmpNh730JpT9SMZ0b/NcGYxXDsYrBaIvxVOebUPwYblBvdlBrtPFcb6PW6OCp3uJYccLD4yt+AdIv4eyjb4PgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"17\"\n        title=\"17\"\n        src=\"/static/aee959fcd1bf72b65d53331875925a09/37523/17.png\"\n        srcset=\"/static/aee959fcd1bf72b65d53331875925a09/e9ff0/17.png 180w,\n/static/aee959fcd1bf72b65d53331875925a09/f21e7/17.png 360w,\n/static/aee959fcd1bf72b65d53331875925a09/37523/17.png 720w,\n/static/aee959fcd1bf72b65d53331875925a09/5a190/17.png 800w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABP0lEQVQY0zWR127CQBBFV1FEKC6AcbdxwWDcCzWUJIT3/P/f3GgmytNopdkzZ+6INDsgK06o2yuq5oK2v2ObH6FbCWTVg+NnkBQXurmCbiaY6xHmiwgLYwVJcaDpMUx7jYUR421kQBzOT4bk5Ql5dUZZv2O17tB0dyRpj8fzB8uwRNPdUHc3JJse3e4D+9M3/KDARHagTH3IqovBUIcg2O74QNVcGVK3N6zTHYrqjGTTod9/QZ0tEcY1W5Op420ZRoMsJ4WmR7DdFGPJhiAYQf4b4qTlFbxlzutkxZEhZEtQMqTeIK757QUFV4KyIWXX7T9BWZb1hdedaSFbzLSAbWmAH5Y8kD4zMKrg+hkMK2E7ypCBtrv9C3sRshHVsWRxLqOJyQd4HWhQph4fiYbRatQ3HJsQQoIQMsSLCkl28Au8Q6ZZWzMSxgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"18\"\n        title=\"18\"\n        src=\"/static/3aa8dc79569ae66f55effc728f5e262e/37523/18.png\"\n        srcset=\"/static/3aa8dc79569ae66f55effc728f5e262e/e9ff0/18.png 180w,\n/static/3aa8dc79569ae66f55effc728f5e262e/f21e7/18.png 360w,\n/static/3aa8dc79569ae66f55effc728f5e262e/37523/18.png 720w,\n/static/3aa8dc79569ae66f55effc728f5e262e/764be/18.png 806w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>탈취한 IAM AWS Credential 정보를 통해서 사용가능한 나열을 하여 <code class=\"language-text\">s3.list_buckets</code> 작업이 작동 중인 것을 확인할 수 있습니다.</li>\n</ul>\n<h3 id=\"s3-bucket내에서-데이터-및-credential-분석-추출-및-함수-호출\" style=\"position:relative;\"><a href=\"#s3-bucket%EB%82%B4%EC%97%90%EC%84%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%8F-credential-%EB%B6%84%EC%84%9D-%EC%B6%94%EC%B6%9C-%EB%B0%8F-%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C\" aria-label=\"s3 bucket내에서 데이터 및 credential 분석 추출 및 함수 호출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3 Bucket내에서 데이터 및 Credential 분석, 추출 및 함수 호출</h3>\n<ul>\n<li>S3가 작동중이니 해당 데이터를 pacu 도구를 통해 다운로드를 받아봤습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVQY00VQ23KCUAw81VpLEUTkcLUtKjcFOSJqtfX2/z+1ncSpfdhJsjPZZFe4fgLbmcJxZ/DDDEGUwwsySD+B9BLmdSOEab3Dsj8gvTlztKfpHoQwIDpDPHUtdJ5HEKo5Y705o2kvqNQ3ytUBzfYK4lVzQjyroZsh+prE2yBgaLoP05pAN/7nXt9hUbEov9Dubthsb1i3FxaoahI+ol6fuNLBfLHDPG2wUj/Iii1G45idhZOCHQ2G0V2wqo+8RJ8tqwPbpjpNFOhYUe5RLPfcx/Oa+zRv4QYpXD9l+8Ywgu3E6PZsiM/pCl6QPvKj1wdmxP1Y3rMlkDXK6A8vr/IB2iFulij8Ap1uhn/lWPdEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"19\"\n        title=\"19\"\n        src=\"/static/173582a0bb77b091ca38005598e4f277/37523/19.png\"\n        srcset=\"/static/173582a0bb77b091ca38005598e4f277/e9ff0/19.png 180w,\n/static/173582a0bb77b091ca38005598e4f277/f21e7/19.png 360w,\n/static/173582a0bb77b091ca38005598e4f277/37523/19.png 720w,\n/static/173582a0bb77b091ca38005598e4f277/d48f1/19.png 796w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVQY0zXIXU+CYABAYS4S+ZC8UAnL1BTlRUBAhCibtqk1t9RWq7ytLvr/v+C0cF2cPduRng8ZyTQljK6L8myGyJdo9+/YIsT3JwyGAX3bY+TFOH8vSBiHKX4w5arn4vkJk+QGz0+RDt8Zs/mCcXRHfrtiKBIuuz5tO8Zs2hjVCxTV5ESuISt1SuV6oVw+9v/LagNZaSB9/Xyw27+w27+xenhi87glW+9pbT/JZ0vmizXuKKbTdRg6IfbAR7gRI2+CcGPaHQdHRARhiiNipPVrjZ7dR9MtVN1E1RrIuoVUaVFS6qiaeUw/QzcstIqFbjSpnDYLFc0sNKrnhb9UA3KgML3qcwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"20\"\n        title=\"20\"\n        src=\"/static/7ee8adaf0f3554c4735199dc745bf14e/37523/20.png\"\n        srcset=\"/static/7ee8adaf0f3554c4735199dc745bf14e/e9ff0/20.png 180w,\n/static/7ee8adaf0f3554c4735199dc745bf14e/f21e7/20.png 360w,\n/static/7ee8adaf0f3554c4735199dc745bf14e/37523/20.png 720w,\n/static/7ee8adaf0f3554c4735199dc745bf14e/321ea/20.png 786w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다운 받은 데이터를 통해 AWS Credential 값이 들어 있는 것을 확인할 수 있습니다. 또 똑같이 해당 데이터를 통해 새로운 프로필을 만들어 보겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVQY0x2Py26CUAAFSZriI9ZYAR+JRkEQ2wuCgnilD63VxorWdOum+3bZTf9+GlmcZM7sRvn+zdgf9my2R952H5wOn3inL/zszOH9yHyxYuiOGQcJwo8JwjnhROau13cRfoTrzkhfu7TNCsrpPGYSz3CGEcKXBJNHRp4kiJbIdEOcvCDTLY475U4kWHaYc7PtUK60UYs6atFALdW5UmsolrkkCJ+JkxXRbEUi19hCUtVNGs0BmmGiGX3qei/nW62H3rAwmhbVWodCyaBQalC+0bgu1lB+/lJ2+w1x/EQ4XRCFCa00oyoeGFojBo5Hp2szsAWmdZ+nXnb5ebI3xXVjFusurX6Ff5N8eEHaoPHWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"21\"\n        title=\"21\"\n        src=\"/static/21d271ba88988668a39050deac212694/37523/21.png\"\n        srcset=\"/static/21d271ba88988668a39050deac212694/e9ff0/21.png 180w,\n/static/21d271ba88988668a39050deac212694/f21e7/21.png 360w,\n/static/21d271ba88988668a39050deac212694/37523/21.png 720w,\n/static/21d271ba88988668a39050deac212694/5a6dd/21.png 802w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>생성된 프로파일에 기반하여 어떤 유저에게 속하는지를 파악하기 위해 <code class=\"language-text\">get-caller-identity</code> cmd를 이용하여 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/klEQVQY0y3IzVKCUABA4ZvTxhHUbFJTkRDl55IXBBG0i5pa06ZpV/sewCfo3U8z2eJbnCPevyTnnxX745os0+RFxabcYp0+ccoXdvqZJC1ZpCXleke+qtDVEV2dyFeaJ31AV2+khURtDITZMXH8ASPbw2haOG6M7Sj8ySOjoYfRshCiiai1L65aF7U2tevO/2siRAMhbhBCdOn3MtxphuMqkrRCxRuibI89WzC2Jd3+lKEV0h/M6N1P/3r8EDEaX1690aNu3FE324jXD8n3eYneFsxVgR8khL7CTA7cBjkyiHFncybTCM9XeEFMKBfIKGXiSvwwJgiWqDRA5ga/NKJzgtgGeE0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"22\"\n        title=\"22\"\n        src=\"/static/7c58cf47ade67b836bb57c305199ba6c/37523/22.png\"\n        srcset=\"/static/7c58cf47ade67b836bb57c305199ba6c/e9ff0/22.png 180w,\n/static/7c58cf47ade67b836bb57c305199ba6c/f21e7/22.png 360w,\n/static/7c58cf47ade67b836bb57c305199ba6c/37523/22.png 720w,\n/static/7c58cf47ade67b836bb57c305199ba6c/d2a60/22.png 807w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>확인한 결과 <code class=\"language-text\">shepard</code> 유저에게 참조가 되고 있고 이에 대한 정책을 식별해봤습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYklEQVQY0z2Ny27TQABFp6UP2zO248TjsR2/4ziBtIEmKVHaJhKtUAtrKliw5wP4fx1UK2JxdHSlq3vF39tXfm6+sdru2R++8uXwxPzlF83umbvtnpv1HVfLW9abez5vD33nZrVjtd7x8PDM08s9P/4kvP7O+F58QuRewzRfUk0+khULTDrDlQYhHITwjqij3SMe4sRHnPqcnI4QIkKIIeJsgBBnPue2JhiWlPU1Jm7xgoJ4PMMkU+K0Ix53aDMhyWbk5YIobrGl4cLSXNghlgxRnuHS0ghHJf3TpR2hTYs3yPH9MTpqCEYVYTTBJF3vkW76sTf8oMD1M1w/R6qSUdgh3TEi1DWhrlBegnRjXDfmPCh556ZIGWE5useWEY40OMr0+c3KS/GCCFModKaw5BAxaa9p2iuKat67bT4wmG/x6yV1OSPNpoyzKVnRUVTvqZvF/1w3S9p5w+ZRsToM0HHKP/cnnvxZaZ68AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"23\"\n        title=\"23\"\n        src=\"/static/32937540cf21217bb12edaea733c17e5/37523/23.png\"\n        srcset=\"/static/32937540cf21217bb12edaea733c17e5/e9ff0/23.png 180w,\n/static/32937540cf21217bb12edaea733c17e5/f21e7/23.png 360w,\n/static/32937540cf21217bb12edaea733c17e5/37523/23.png 720w,\n/static/32937540cf21217bb12edaea733c17e5/6c745/23.png 893w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM 사용자 <code class=\"language-text\">shepard-ec2_ssrf_cgid84kpkl3ssy</code> 에 연결된 정책에 대한 권한을 확인하여 다음 공격 방향을 잡았습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfElEQVQoz32Re2+iQBTFR0AqdJXX8qgpFKGtG3k4DCqotNmN6W7ST9Dv/0VOw602tmn3j9/cmblzTk7usPS2gKg71OsHtLsDOG+x2P1FxB9RVVtkxQZF2WBZ7VDVHbb7Azbtb3rPRYeCV+j+zbB/ihHGCdhI9xFM51jkLeKkhD6eQtc86JoLWXWgjjxolwEuNJ+q/uOKuBxPIQ1tMDYBY/YbAxNsIBkYyCb8qzvk5RZecAvHSzCxIiiqDSYZXzOYkE4eWpCHJiEpFli/9I2+mnaE8CaD66e4jjJYTkzivvcdJ+0Jdn7B2BizdIn7XysyNqzog+Fn8Ve8GyqqQ1UduejnejI453sj80gfSjJwoXmUKk5LmuXEDGnw8tB+57/J5CO9oUI/6SK8yRHFObzgDtNwQThuQueffgpJOX6QbIJJZ1B6g6De/Zxj03QoCoFKNBC8RtL8QSAeUZUCWV5hkS1RlAKcryHqhvZ5wbFa7bFuOZ5fXDy/eEjnM7wCrVzgKjXUn00AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"24\"\n        title=\"24\"\n        src=\"/static/bf629f8da8995bf1bc126f73f5159b2a/37523/24.png\"\n        srcset=\"/static/bf629f8da8995bf1bc126f73f5159b2a/e9ff0/24.png 180w,\n/static/bf629f8da8995bf1bc126f73f5159b2a/f21e7/24.png 360w,\n/static/bf629f8da8995bf1bc126f73f5159b2a/37523/24.png 720w,\n/static/bf629f8da8995bf1bc126f73f5159b2a/38af3/24.png 894w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>예상데로 IAM 사용자 “shepard”로서 AWS 계정에 대한 관리자 접근 권한을 갖고 있었습니다. 해당 AWS Credential을 사용하여 <code class=\"language-text\">cg-lambda-ec2_ssrf_cgid84kpkl3ssy</code> Lambda 함수를 호출하겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyklEQVQI1yWJbU+CUACF2QKVV+2C4BWsrVJhs5nYTCE3Fco1x9b8yB/p5z+t24ez5zznaD9lS7tteC0P1B8N1fHMor6Snb75rL5Yb/as8oJdcWRXnijKSvX3fc3m7cBylXNpx5yvE5rpC9q8P+MpypCTjHGcIpOUwSBBiDv64h6jG6B3fDq9oeKNIdT25/9fgG5IDEOid4doloh5THMWz1vm2Zo4mSEflnijKT0zwHIiTDtUtN2RimlHmFaI7UocL8KXLrehh+X4/ALlAlO/Mq6T4wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"25\"\n        title=\"25\"\n        src=\"/static/41c4a57f52899f40ba91e0f426bfc3c3/37523/25.png\"\n        srcset=\"/static/41c4a57f52899f40ba91e0f426bfc3c3/e9ff0/25.png 180w,\n/static/41c4a57f52899f40ba91e0f426bfc3c3/f21e7/25.png 360w,\n/static/41c4a57f52899f40ba91e0f426bfc3c3/37523/25.png 720w,\n/static/41c4a57f52899f40ba91e0f426bfc3c3/eac55/25.png 887w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 흐름도</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\">시나리오 환경설정</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#solus-key-%EC%A0%95%EB%B3%B4%EB%A5%BC-%EC%9D%BD%EA%B8%B0%EC%A0%84%EC%9A%A9%EC%9D%84-%EC%A0%91%EA%B7%BC\">Solus key 정보를 읽기전용을 접근</a></li>\n<li><a href=\"#lambda-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%99%95%EC%9D%B8\">Lambda 환경 변수 데이터 확인</a></li>\n<li><a href=\"#lambda-%EA%B8%B0%EB%8A%A5-%EB%82%98%EC%97%B4-%EB%B0%8F-%EB%B6%84%EC%84%9D\">Lambda 기능 나열 및 분석</a></li>\n<li><a href=\"#ec2-%EB%82%B4%EC%97%90%EC%84%9C-%EB%8F%99%EC%9E%91%EC%A4%91%EC%9D%B8-%EC%9B%B9-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%8C%8C%EC%95%85-%EB%B0%8F-%EB%B6%84%EC%84%9D\">EC2 내에서 동작중인 웹 서비스 파악 및 분석</a></li>\n<li><a href=\"#ssrf-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D%EB%B0%8F-imds-%EA%B8%B0%EB%8A%A5%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A0%95%EB%B3%B4-%ED%83%88%EC%B7%A8\">SSRF 취약점 분석및 IMDS 기능을 이용한 정보 탈취</a></li>\n<li><a href=\"#s3-bucket%EB%82%B4%EC%97%90%EC%84%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%8F-credential-%EB%B6%84%EC%84%9D-%EC%B6%94%EC%B6%9C-%EB%B0%8F-%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C\">S3 Bucket내에서 데이터 및 Credential 분석, 추출 및 함수 호출</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 6 (CloudGoat: EC2 SSRF)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-6/"}},"prev":{"id":"cbd8c0f7-ec77-5d99-8436-43038a368e52","html":"<h1 id=\"클라우드-서비스-취약점-분석-4\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-4\" aria-label=\"클라우드 서비스 취약점 분석 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 4</h1>\n<h1 id=\"scenario-3--cloud-breach-s3\" style=\"position:relative;\"><a href=\"#scenario-3--cloud-breach-s3\" aria-label=\"scenario 3  cloud breach s3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 3]:  Cloud Breach s3</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Size: Small\nDifficulty: Moderate\nCommand: $ ./cloudgoat.py create cloud_breach_s3</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>VPC (EC2, S3)</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>개발자의 실수로 인한 ReverseProxy 환경 구성 미흡</li>\n<li>설정 값이 잘못 구성되어 Reverse Proxy로 동작하는 EC2 서버의 IP 주소</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li>S3 bucket에서 Confidential files을 다운로드 합니다.</li>\n<li>액세스 권한이 없는 상태인 외부 접근자로 시나리오는 시작합니다. 설정이 잘못된 Reverse Proxy server를 Exploit하여 EC2 MetaData Service를 통해 인스턴스 프로필 키를 획득합니다. 그런 다음 해당 키를 사용하여 S3 Bucket에서 권한을 우회하여 데이터를 추출합니다.</li>\n</ul>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADRElEQVQoz02SX0xTdxTHj1Pa+7stBSRpb/v73Vt6W0sprNgsUArtNKxDWm5BMGoRccw5txn/bJOZGTdl04QtaqkwIyhIolHqMrNMEEVtwgNGl7GaLG6Z2Ysxe9r2sE1UejU55uqy+HAezsk533y++R6QZZfRW17Z6PX6/IgI1bWNHwTqYt9V10bPBsNKOhbvSMeaO9JKS2d6RVMiXROKpQN10TFtpyq4IqHdyE43zxgjjDEdiKJEPJ5yR6mnggGAJvhFoC72c3Vt9GYwrPygtHZl461d2ZZVG7Ox5s5sMNycrQnFZ2tC8V+rQ807cK4CZNll+E9QD5RSjid5i4oK8/O04eQswpZdp2Dnxyfg/eRt2H0eYd8FhOPXEUZmELpP3ofukfuw4dCfkBhC+BERJJePUKuFUEr1wBjjRMaIKNnJkuBKgz/clO9/vasgH0AfejcjN+zPZdYk1RubjuWubh3OZd4ZzGU2D+audR6Zv9rUq/4U+ezhIc2Z0xcxiHZZI7RxTLQTodjE3UOEOUT4GxEmESG4+QqL9DxIRQ/Mf736sHprXUr9fm1SnW1PqbPxXnWm4fNHY5G9/+wAgJfk8jDPpBI9SLKbE0x5nGfZKuNrw/92rhn+bWfryO8fLT/2VwQAFm7NIkQ/nLavTeYmEn1qJtGnTnccUacThx8c1ALpRwSHt46nNuG5ZYc3QAoAdJXrR4ob+x//8dbAL7h+4C5GUk/SQ4jgbztYpBGEtmdf7kg9mtrQP3+t7cu5o4tLwkbZHze6q9oM1CZw/4dS4vSRChPo4ZVMQU/PpXN9ewduJXtO3O7+dGa3RlBf5Sa2cYRRRFj+9nlTZNcdsb79AKm9ggCIQB0+ntksHKUvpMxEiZjNxVwp8KQQ2nkK9TyDIuIVQLfA9d5iU8N4L2udGrYok19ZW6ZOmpWLA2bl8mndq9+8qYkKrrCBUvpcUEtZa0RRJFa3xEmlHMc8Js7qLiNlFtAvcr5RaIp8u42tvLhPiE98YlHG9wjKxB5z08R+XWis5TTAAsEZ4F/8Q71GSSnj7PZS4nCUPStJkjkrtXNu20K98SjCsjMI/lGEylGEpaMIZf0I8BDB5qgkzGZ+BkUp1T0FXJ4gj4FcqqIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"29.png\"\n        title=\"29.png\"\n        src=\"/static/47ff7d97423579247e2d9cb0309d3849/37523/29.png\"\n        srcset=\"/static/47ff7d97423579247e2d9cb0309d3849/e9ff0/29.png 180w,\n/static/47ff7d97423579247e2d9cb0309d3849/f21e7/29.png 360w,\n/static/47ff7d97423579247e2d9cb0309d3849/37523/29.png 720w,\n/static/47ff7d97423579247e2d9cb0309d3849/302a4/29.png 1080w,\n/static/47ff7d97423579247e2d9cb0309d3849/07a9c/29.png 1440w,\n/static/47ff7d97423579247e2d9cb0309d3849/4435f/29.png 2479w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"시나리오-환결설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%B0%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환결설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환결설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnklEQVQoz32RWW/aQBSFh8UBx2Bs45XFNsYLxhjCkhZSNe1D2///j75qJhGqorYPn+be2XTOuWK7+8yn2w+Ol2/sDi9cX34qzs/fOZ5f2e6uNPsbty+/SLKWp9Orute0Vwa6h+iYdHoWomu9rXHaUlYX1sWRZNVS1c+KvDyR5U8sk4bV+kC5uajzNNsrkmyPF6zxwpxoXimGjwHCdEMM20c3XYZjV62abmNYPg+Ggz7xGIymGHbA2Anp9CZKlehO6PZteppzR/bCi1LcIMUYzzDGESNzxsicM9B9tTdxYh5HobIjH/yJ3PuIsiwtShvSmkTWcbpjtqhVH69agqh4y+xd2b8QModFvMVxU4KoxA9z3GDNfFkTzkrsafJ+VmA58f3DvylWH8qwD6evFNVZBV/VF8r6ogYieznlZbxl6q3QjZBO16Lb+6/CnEXcKDWyVlOTtZ+pHLWhx8MoQDN8RH+C0CxE30LI4Sg+ZGiMQ+K0YRHXzJcbkrQhTFv8ZU00L5gFORt/Sx3t2IQNhVuRmBleP8Tp++iajTaY3hX+Bmt65OjIyAcbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0\"\n        title=\"0\"\n        src=\"/static/caaff94dfd459777f1bda4ea4433d145/37523/0.png\"\n        srcset=\"/static/caaff94dfd459777f1bda4ea4433d145/e9ff0/0.png 180w,\n/static/caaff94dfd459777f1bda4ea4433d145/f21e7/0.png 360w,\n/static/caaff94dfd459777f1bda4ea4433d145/37523/0.png 720w,\n/static/caaff94dfd459777f1bda4ea4433d145/84cc5/0.png 898w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<ul>\n<li>공격자가 EC2 인스턴스의 IP를 발견하였습니다. 다양한 방법으로 분석을 빈행하면서 reverse proxy 서버 역활을 하고 있음을 인자하였습니다.</li>\n<li>이러한 EC2 서버를 Reverse Proxy로 구성하는 이유는 on-premise에서 클라우드로 전환하는 과정에있는 아키텍처에서 자주 있는 상황입니다.</li>\n<li>분석후 공격자는 <code class=\"language-text\">curl</code> 을 통해 웹 서버에 요청을 보낼때 호스트 헤더를 EC2 metadata service의 ip 주소로 설정합니다.</li>\n<li>공격자가 조작한 요청 패킷이 성공적으로 수행되었다면 EC2 인스턴스에 연결된 IAM 인스턴스 프로파일의 액세스 키ID, Security 액세스 키, 세션 토큰등을 얻게됩니다.</li>\n<li>IAM credential 을 가지고 공격자는 Rule 정채에 부여된 강력한 권한을 사용하여 피해자의 클라우드 환경을 탐색할 수 가 있습니다.</li>\n<li>공격자는 Private S3 Bucket 을 list화 식별, 접근등 비인가된 행위를 지속적으로 합니다.</li>\n<li>Private S3 Bucket 내에서 공격자는 민감한 정보로 가득찬 여러 파일을 찾아서 로컬로 다운받아 배포를 하고 시나리오를 마칩니다.</li>\n</ul>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"ec2-instance-ip-분석및-활용\" style=\"position:relative;\"><a href=\"#ec2-instance-ip-%EB%B6%84%EC%84%9D%EB%B0%8F-%ED%99%9C%EC%9A%A9\" aria-label=\"ec2 instance ip 분석및 활용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EC2 Instance, IP 분석및 활용</h3>\n<ul>\n<li>해당 시나리오는 공격자로부터 특정 서버를 분석하여 Reverse proxy 서버로 80포트가 운영되고 있는 곳을 알아냈습니다.</li>\n<li>Reverse proxy로 자주 사용되는 프레임워크인 Nginx, Traefik 등, 애플리케이션 계층의 <code class=\"language-text\">Edge Route</code> 를 실행하는 일반적인 시나리오 입니다.</li>\n<li>Reverse Proxy Server를 Exploit하여 EC2 Instance Metadata server(IMDS)에 연결을 할 수 있는지 확인을 해보겠습니다.</li>\n<li><code class=\"language-text\">CURL</code>  HTTP 클라이언트를 사용하여 메타데이터 검색용으로 새로운 HTTP 요청을 만듭니다.</li>\n<li>IMDS 서비스상에서 IP 주소를 참조하는 “Host” header를 추가하였습니다.</li>\n<li>만약에 Reverse Proxy Server에 관용적으로 Enable상태이면 IMDS Service로 전달이 되고 일부 메타데이터 정보를 얻을 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s http://54.147.185.174/latest/meta-data/ -H <span class=\"token string\">'Host:169.254.169.254'</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0UlEQVQY042RXU+DQBBFpwsskPKx0rXYLWiaGqOpLfbJiH32//+jY4BgSIPRh5M7DzM3c2ekOX/y+PSGLfeEec0yKUmyDWnmSIxjFTuqqGYb11TRPVavcVGF1Rv80KKj254wXvfIsWkp7A4vKBBJEZUji5EMUVd4OeINuvAMoswwM/JyeMdVz/h6hfJvZvEmqInOIa+nFlM8oHzza9OcaUe34XUth+MHQWgRyYaIfcy/Y48GnU5rac4XdvsTy/SOJN/+7zFhSaCLH6Ph/jHt5Ytv7JaJ/M+QfEsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/366fe2f7b66ebc122eb2a3a4daac00ee/37523/1.png\"\n        srcset=\"/static/366fe2f7b66ebc122eb2a3a4daac00ee/e9ff0/1.png 180w,\n/static/366fe2f7b66ebc122eb2a3a4daac00ee/f21e7/1.png 360w,\n/static/366fe2f7b66ebc122eb2a3a4daac00ee/37523/1.png 720w,\n/static/366fe2f7b66ebc122eb2a3a4daac00ee/302a4/1.png 1080w,\n/static/366fe2f7b66ebc122eb2a3a4daac00ee/07a9c/1.png 1440w,\n/static/366fe2f7b66ebc122eb2a3a4daac00ee/7575b/1.png 1608w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다음과 같이 Link Local Address IP주소를 사용하여 외부 애플리케이션에 대해 연결을 관리할 수 가 있습니다.</li>\n</ul>\n<h3 id=\"ec2-metadata-service-query를-위해-잘못-구성한-reverse-proxy를-exploit\" style=\"position:relative;\"><a href=\"#ec2-metadata-service-query%EB%A5%BC-%EC%9C%84%ED%95%B4-%EC%9E%98%EB%AA%BB-%EA%B5%AC%EC%84%B1%ED%95%9C-reverse-proxy%EB%A5%BC-exploit\" aria-label=\"ec2 metadata service query를 위해 잘못 구성한 reverse proxy를 exploit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EC2 Metadata Service Query를 위해 잘못 구성한 reverse proxy를 Exploit</h3>\n<ul>\n<li><code class=\"language-text\">Instance Metadata</code> 기능 때문에 클라우드 리소스상에서 더욱 심각한 보안 문제가 발생하고 있습니다.</li>\n</ul>\n<p><strong>Instance Metadata가 무엇일까?</strong></p>\n<ul>\n<li>실행중인 인스턴스를 구성하거나 관리하는데 사용할 수 있는 인스턴스에 대한 데이터입니다.</li>\n<li>인스턴스 메타데이터는 Link Local Address인 IP주소 호스트로 액세스할 수 있으며 인스턴스에서만 유효합니다.</li>\n<li>AWS 도큐먼트를 참고하면 AWS EC2 console, AWS CLI를 사용할 필요가 없고 인스턴스 메터데이터에서 인스턴스의 로컬 IP 주소에 액세스 하여 외부 애플리케이션에 대한 연결을 관리할 수 있다고 나와있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">http://169.254.169.254/latest/meta-data/</code></pre></div>\n<ul>\n<li>Reverse Proxy Server에 AWS EC2 IMDS에 액세스 할기 위해 Exploit을 할 수 있는 이유가 잘못된 구성입니다.</li>\n<li>공격자의 관점에서 IMDS에 저장된 가장 가치가 있는 정보는 IAM Rule Credential 입니다.</li>\n<li>IAM Rule Credential을 탈취할 수 있다면 IAM Rule에 해당하는 모든 것을 확인할 수 있습니다.</li>\n<li>실제로 EC2 Instance에 S3 Bucket과 같은 AWS 계정의 다른 서비스와 상호 작용하는데 사용하는 IAM Rule이 있는 것이 일반적입니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABUklEQVQozz2RS46cMBRF2f8eMkrW0RvIoAcZpAatKNW2wVAU2BT4gzEnsqvST7rcN0BHR89NSok4/mHXF4K+cGyWMx2UmeeZcbwTvMe5DefcK54UAtE5tm0j7jsxRo7joNn3Hd/9Joh33Oc7x2PijKkCjV24CsWt1fSy51NqrleFkIq+G+jantkuFbSuG0WuKZ8988wJMSXymZ/AZUUOE3o06LGlGxWd/kvfd+hhZF5WTp4TQngaplR0PTEGYgjs+8H5+ssYgxSKrhMI8R0hvtVW6kKrNK1S2GKYM491ZS+GOVMBpXM+OY6FlMbXDQ1CSqQqZj3GWoyxFTLNc9299+Scv9Ks6y9u4w+MuTJNjmX5ifdvX0Api6Gm7TRa9wzDDd2XHuo+3u+c54m1lvIejfd37PLB5pZqWOb/XaqhkLRtV1Pgxbbuqq2tVFvv93isFfgPUBoWTarjkSYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/d9a2984dece1a730c4b609238e4012bb/37523/2.png\"\n        srcset=\"/static/d9a2984dece1a730c4b609238e4012bb/e9ff0/2.png 180w,\n/static/d9a2984dece1a730c4b609238e4012bb/f21e7/2.png 360w,\n/static/d9a2984dece1a730c4b609238e4012bb/37523/2.png 720w,\n/static/d9a2984dece1a730c4b609238e4012bb/302a4/2.png 1080w,\n/static/d9a2984dece1a730c4b609238e4012bb/7321b/2.png 1184w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>AWS 도큐먼트를 살펴보면 해당 IMDS 형태로 특정 경로를 통해 다양한 정보들을 확인할 수 있는 리스트를 확인할 수 있습니다.</li>\n<li>EC2 Instance에서 IMDS를 통해 액세스할 수 있는 IAM Credential을 추출해 보겠습니다.</li>\n<li><code class=\"language-text\">/iam/security-credentials/</code> 해당 route에 접근하여 사용되는 <code class=\"language-text\">role-name</code>을 확인할 수 있습니다. 이러한 정책에 해당하는 규칙이 어떤 접근을 하는지, 어떤 역활을 하는지가 중요합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s http://54.147.185.174/latest/meta-data/iam/security-credentials/ -H <span class=\"token string\">'Host:169.254.169.254'</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAT0lEQVQI1wXBTQqAIBCA0Q7Sqk3Qz6iBYyooIwRtu/9hvt6bdsmcrpLyoPUXvY2oHX9VSjZW+zjyQy2DmBriIuIU5xXxyhUSW+zMaqQl8AMfQSCeD+05twAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/69752f8622a20fc1d659e962434aedc5/37523/3.png\"\n        srcset=\"/static/69752f8622a20fc1d659e962434aedc5/e9ff0/3.png 180w,\n/static/69752f8622a20fc1d659e962434aedc5/f21e7/3.png 360w,\n/static/69752f8622a20fc1d659e962434aedc5/37523/3.png 720w,\n/static/69752f8622a20fc1d659e962434aedc5/cda19/3.png 785w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">cg-banking-WAF-Role-cloud_breach_s3_cgidmy4bprdx0t</code> 탈취한 정책 이름을 토대로 route 하게되면 AccessKeyId, SecretAccessKey, Token  정보를 알아낼 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s http://54.147.185.174/latest/meta-data/iam/security-credentials/cg-banking-WAF-Role-cloud_breach_s3_cgidmy4bprdx0t <span class=\"token punctuation\">\\</span>\n-H <span class=\"token string\">'Host:169.254.169.254'</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8ElEQVQY013LS1OCYBiGYdKmAjGtaVJUBMqULwICOX0e84Btmpq2/f//cTdiqxb3XO/ieRXhJfhBhhtKOqMIczhhaAseRz59y2WsP5A2BXHTJdUFlmpwod6hNrpoukGj2UO/PqXpXRTTekF4ObbjYw6fad9aXGkdLtV7lFoLpd5COT/W/vOG2r/O6u3Kau8FkqzYk8s9clZSzA/ks5JclkTTNcF0iZ8sCbP1qWRNnLyR5lvSYlfd0XRV/RxV4mRFIbcUywPB/J3wVeL5GX5YECYLVmLB59OGj/Gmcu7E2I6HMXDpDdxKoz/BtDy+vn/4BegGcsTHx8ftAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/fa17d351396aaf3fdf82e1061d0fc178/37523/4.png\"\n        srcset=\"/static/fa17d351396aaf3fdf82e1061d0fc178/e9ff0/4.png 180w,\n/static/fa17d351396aaf3fdf82e1061d0fc178/f21e7/4.png 360w,\n/static/fa17d351396aaf3fdf82e1061d0fc178/37523/4.png 720w,\n/static/fa17d351396aaf3fdf82e1061d0fc178/302a4/4.png 1080w,\n/static/fa17d351396aaf3fdf82e1061d0fc178/07a9c/4.png 1440w,\n/static/fa17d351396aaf3fdf82e1061d0fc178/eee07/4.png 1628w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>탈취한 IAM Rule Credential 은 다른 IAM Credential처럼 사용할 수 있습니다.</li>\n</ul>\n<h3 id=\"상호-연결된-ec2-인스턴스-프로파일을-가정\" style=\"position:relative;\"><a href=\"#%EC%83%81%ED%98%B8-%EC%97%B0%EA%B2%B0%EB%90%9C-ec2-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%ED%94%84%EB%A1%9C%ED%8C%8C%EC%9D%BC%EC%9D%84-%EA%B0%80%EC%A0%95\" aria-label=\"상호 연결된 ec2 인스턴스 프로파일을 가정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>상호 연결된 EC2 인스턴스 프로파일을 가정</h3>\n<ul>\n<li>앞에서 탈취한 IAM Rule Credential을 사용하여 수행할 수 있는 작업들을 Enum 하기 위해서 AWS CLI를 사용하여 프로파일을 지정해야 합니다.</li>\n<li>하지만 IAM Rule Credential은 Life cycle이 짧고 Session Token이 존재하기 때문에 Session Token은 파일의 프로파일에 수동으로 추가해야 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKklEQVQY03VQ207CQBTcB6MiYqKoIKAhCNgLLaXttl3oZUsLFRCjxv//lTFng4nR+HAyszOzJ7vDnnSOVmeM2/YIV9d9dO91DMcu+gMbjyMHg6GDy2YfJ7Ub1OptnJ61FNIcHTfBWOPHXICZVgTTFrCdGBN7rhaZloBYrBFEBVw/g8el4l6QYzqLFSd/Ygv1gE5PQ+/BwF1XA6MwD5dw3ERd5lGBUJRwfQkRV4qTT/idJY/4zMvgh0t4PEcQlSrDZLFHuX5HnG6Q5S9YJM8grdp+oli9IS9flU6YZFvI5V7pqdxhnlRKS+QOq+oDi3QDRgvGmg/qkr5KqJsBXC7heKnyjEkIzQxgUD2WUGeqinLWdA7dDKEZXFXHqGTG6r/KPT9o9QP/bxp/tC+sALIIqVMbvgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/a253c569ba43a147a56cd7bdd846fda9/37523/5.png\"\n        srcset=\"/static/a253c569ba43a147a56cd7bdd846fda9/e9ff0/5.png 180w,\n/static/a253c569ba43a147a56cd7bdd846fda9/f21e7/5.png 360w,\n/static/a253c569ba43a147a56cd7bdd846fda9/37523/5.png 720w,\n/static/a253c569ba43a147a56cd7bdd846fda9/c67d4/5.png 723w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"s3-bucket-리스트\" style=\"position:relative;\"><a href=\"#s3-bucket-%EB%A6%AC%EC%8A%A4%ED%8A%B8\" aria-label=\"s3 bucket 리스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3 Bucket 리스트</h3>\n<ul>\n<li>앞선 IAM Rule Credential 정보를 토대로 AWS Profile을 생성했습니다.</li>\n<li>해당 정보를 사용하여 IAM enumerate하여 Rule Access를 확인하여 해당 권한에 맞는 공격 벡터를 찾게 되었습니다.</li>\n<li>iam Rule Enumerate를 사용하는데 있어서 밑의 enumerate-iam 오픈 소스 도구를 활용하여 정보를 확인하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws_access_key_id <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_KEY<span class=\"token operator\">></span>\naws_secret_access_key <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_SECRET_KEY<span class=\"token operator\">></span>\naws_session_access_key <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_SESSION_KEY<span class=\"token operator\">></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">https://github.com/andresriancho/enumerate-iam</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABT0lEQVQY002OS4/TQBCEDVdgOSGksAnZJOvE3sT2jMfvVzx2YjYEIUV7yt648f9/wIc8oIhDqau7S1VlibBkr0/U+2e0PlEMF2R/IVIlWdFTNQOt/o7uz+juTNkMvIgTv+srr+onV/GDqzjzK33h6GRYWy+nqJ+Js560GMiLI2miSbKDQV4ON65iTZR0hNUBUfaE9ZGg6PCyFi9vab5dsHxRkuYHZLQnTjt8URmeZD0irFGJRsUtYbS/QY3/pGPn5SwWHrYtWa8Vy1WAFcgaX1bYG4UXFMwXHstHgbtNeVj67PyCxSpg48YI1bCypdGMczbfGj6db5k97JhMHSypxtQW5ynBE6UR2o5CqgZ3lxpDETYEsjKBaze6GRqzr098+rzk3YcJ7+8mWPYm5HEdmrSx2Zepw/3MNe1G4Xj7H5P7jblbbz9ivbn7i5H/2/8Alkm8TzJzd30AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/2e85d60c37ef34d568e662d7567f4ae9/37523/6.png\"\n        srcset=\"/static/2e85d60c37ef34d568e662d7567f4ae9/e9ff0/6.png 180w,\n/static/2e85d60c37ef34d568e662d7567f4ae9/f21e7/6.png 360w,\n/static/2e85d60c37ef34d568e662d7567f4ae9/37523/6.png 720w,\n/static/2e85d60c37ef34d568e662d7567f4ae9/22475/6.png 1039w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM Rule에는 계정의 S3 Bucket에대한 권한이 있는 사실을 알 수 가 있습니다. AWS CLI를 사용하여 Bucket을 Enum하고 S3bucket에 저장된 데이터를 다운로드 해보겠습니다.</li>\n</ul>\n<h3 id=\"s3-sync-명령을-통해-cardholder-data-bucket에서-중요한-데이터-탈취\" style=\"position:relative;\"><a href=\"#s3-sync-%EB%AA%85%EB%A0%B9%EC%9D%84-%ED%86%B5%ED%95%B4-cardholder-data-bucket%EC%97%90%EC%84%9C-%EC%A4%91%EC%9A%94%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%88%EC%B7%A8\" aria-label=\"s3 sync 명령을 통해 cardholder data bucket에서 중요한 데이터 탈취 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3 “SYNC” 명령을 통해 Cardholder-data Bucket에서 중요한 데이터 탈취</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.555555555555557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkUlEQVQI1x3F2QqCQABAUSspkRZzaaOFzHQ0xxkVTLK3iN6q//+ZG3RejpHLhrK60XQPovaJyCqkuiJlQyQU8lDw9ho+m47vquPlKtQ8ZDs5MnX3BMsTU2eHPV5jDj2MKNaItOZStETqzjkpiUVFImritEKEmsLN0EGO9nMKT7D095j2gpEVYNkLegMHoz/7/wN/CjhaseHfUQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"7\"\n        title=\"7\"\n        src=\"/static/8ffe0df924ce57859e529560d0bcac7c/37523/7.png\"\n        srcset=\"/static/8ffe0df924ce57859e529560d0bcac7c/e9ff0/7.png 180w,\n/static/8ffe0df924ce57859e529560d0bcac7c/f21e7/7.png 360w,\n/static/8ffe0df924ce57859e529560d0bcac7c/37523/7.png 720w,\n/static/8ffe0df924ce57859e529560d0bcac7c/302a4/7.png 1080w,\n/static/8ffe0df924ce57859e529560d0bcac7c/07a9c/7.png 1440w,\n/static/8ffe0df924ce57859e529560d0bcac7c/9fafa/7.png 1565w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>s3 bucket 내에 존재하는 데이터를 나열하여 추출할 데이터의 이름을 수집합니다</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxElEQVQI1y3Di06CUACAYTSdc21WTKUVGHEHGddzPHAQxNV6/zf621rf9hlS3SkqTa+/KPUPVTtS/++Hb1o1o84DczJxz2e03zOlV1Qo6fyOKG7xwxrXKzAPnxhC3ojTlrLqCZqZNL+QZoK86GjESKtuiODCaEvGD4V+F4yOwLU8tqbN/uhxfA04WD7bRwsjiCrCuKYoe6J6oqgH4qShLK9kmSQ5S9x9iLO2cTYOp80Je/XGbm2yXL1gLHYYy6e/i4dnfgHeNlgmzUZeQAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8\"\n        title=\"8\"\n        src=\"/static/a2c2ddd6e15f1169848cf15abb1e7351/37523/8.png\"\n        srcset=\"/static/a2c2ddd6e15f1169848cf15abb1e7351/e9ff0/8.png 180w,\n/static/a2c2ddd6e15f1169848cf15abb1e7351/f21e7/8.png 360w,\n/static/a2c2ddd6e15f1169848cf15abb1e7351/37523/8.png 720w,\n/static/a2c2ddd6e15f1169848cf15abb1e7351/302a4/8.png 1080w,\n/static/a2c2ddd6e15f1169848cf15abb1e7351/2a08f/8.png 1422w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>S3 bucket 내의 데이터를 로컬로 다운로드 받을 수 있도록 sync 를 진행하여 목표인 파일을 추출 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACzUlEQVQoz22Ra0uTARiGR5HVNt37ui01syiKNHVubkMzD5lblmaZhzyUSSstN7JazjJXMg95yt6aipbF1gpbrQnZiQrSigo6EPSHrtiqD0UfLm544L644ZElp6xHnbAGUZtMrLgqijxOE0VUJxIXH7kloF61mnhtEoI6CUGz+ldq16BJXBftRm5xYiIyTfJaRG1StKhUqYmRC+zebqapMp/ibWnYD5XRUm9hf4WRK5famB5w4u1rxzd+mQlpkEFJ4t6DMF++fcfWYkeWkJyCoElCEacmVtCwXBlPywELbpsVV/NOrp9twD/aTeuRWjqdxwn5xhnqOsRQrwNpwEXA28OrRwE+vHlOY109MkGbSKyoZYVCxUqFKrqwsiiNnsMlzJxvYvCYhUC/k+BNL+HZAK9fvcZ17hS25j28vzvGZ18vX4NeXk65aSwvQaYSNchjxV9CpYplChFHTQlt5XrcRyu45W5l0tnAs8AkPxaesTgfYn5ujo72Ru54uxn1nODBlIfbYy7SM1KRrVAIv2VClGVyFUeqy5l01THlqsdevZ1r7bW89Y1yu7+LheAML2Z9OBwHGeho4nRbDe5OO6O9XZhMZmR/RBEiS5fEKLjQ4SR0Z4Y5/w2uj40wLQ3zKTTDm4d+Fu96eSx1My0NIg156DztwN5QRaWlgGyd/n9COZ6ey8yHnxL0B3kSDLMYDrLgv8piyM/HsJ93IR83Rvqprqphl9VK475ybDV7yDGa/hEqBZYuV9LRchjfcA/XLp1nzOPB4zpD814rtTsLkS66uD8xTN9JG3tLrWxavxZrnpn25joKcvP+FkaIkasoK97Gwcrd7MjfSoHZQJ4xi0JTFubMVHKMRiwF+dRXlFK6o4jUDSkU6VNprS2jMHfrv0IVkSdt3JyOwWBCrzeg1+mjGHQ6dBkZZOoM6PSmaGZnG8lIT8eUpcNalM+WtEx+Aknkp94fb+b6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"9\"\n        title=\"9\"\n        src=\"/static/3225eaf09493dfc67ef633f0ef4167f6/37523/9.png\"\n        srcset=\"/static/3225eaf09493dfc67ef633f0ef4167f6/e9ff0/9.png 180w,\n/static/3225eaf09493dfc67ef633f0ef4167f6/f21e7/9.png 360w,\n/static/3225eaf09493dfc67ef633f0ef4167f6/37523/9.png 720w,\n/static/3225eaf09493dfc67ef633f0ef4167f6/302a4/9.png 1080w,\n/static/3225eaf09493dfc67ef633f0ef4167f6/d073d/9.png 1297w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 흐름도</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%B0%EC%84%A4%EC%A0%95\">시나리오 환결설정</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#ec2-instance-ip-%EB%B6%84%EC%84%9D%EB%B0%8F-%ED%99%9C%EC%9A%A9\">EC2 Instance, IP 분석및 활용</a></li>\n<li><a href=\"#ec2-metadata-service-query%EB%A5%BC-%EC%9C%84%ED%95%B4-%EC%9E%98%EB%AA%BB-%EA%B5%AC%EC%84%B1%ED%95%9C-reverse-proxy%EB%A5%BC-exploit\">EC2 Metadata Service Query를 위해 잘못 구성한 reverse proxy를 Exploit</a></li>\n<li><a href=\"#%EC%83%81%ED%98%B8-%EC%97%B0%EA%B2%B0%EB%90%9C-ec2-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%ED%94%84%EB%A1%9C%ED%8C%8C%EC%9D%BC%EC%9D%84-%EA%B0%80%EC%A0%95\">상호 연결된 EC2 인스턴스 프로파일을 가정</a></li>\n<li><a href=\"#s3-bucket-%EB%A6%AC%EC%8A%A4%ED%8A%B8\">S3 Bucket 리스트</a></li>\n<li><a href=\"#s3-sync-%EB%AA%85%EB%A0%B9%EC%9D%84-%ED%86%B5%ED%95%B4-cardholder-data-bucket%EC%97%90%EC%84%9C-%EC%A4%91%EC%9A%94%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%88%EC%B7%A8\">S3 “SYNC” 명령을 통해 Cardholder-data Bucket에서 중요한 데이터 탈취</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 4 (CloudGoat: Cloud Breach s3)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-4/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/cloud-service-vuln-0/","nextSlug":"/cloud-service-vuln-6/","prevSlug":"/cloud-service-vuln-4/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}