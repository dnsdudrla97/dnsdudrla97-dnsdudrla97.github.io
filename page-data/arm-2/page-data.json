{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/arm-2/",
    "result": {"data":{"cur":{"id":"61af3ad2-c811-5f8f-afa0-f2fffa0d4177","html":"<h1 id=\"arm-conditional-execution\" style=\"position:relative;\"><a href=\"#arm-conditional-execution\" aria-label=\"arm conditional execution permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ARM Conditional Execution</h1>\n<h2 id=\"conditional-execution\" style=\"position:relative;\"><a href=\"#conditional-execution\" aria-label=\"conditional execution permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conditional Execution</h2>\n<ul>\n<li>\n<p>ARM 상태에서 각 데이터 처리 명령어에는 작업 결과에 따라 CPSR(Current Program State Register)의 ALU 상태 플래그를 업데이트 하는 옵션이 있다.</p>\n</li>\n<li>\n<p>ARM 데이터 처리 명령어에 S 접미사를 추가하여 CPSR에서 ALU 상태 플래그를 업데이트 한다.</p>\n</li>\n<li>\n<p>CMP, CMN, TST, TEQ에 S 접미사를 사용하면 안된다. 이러한 비교 명령어는 항상 플래그를 업데이트 하기 때문이다.</p>\n</li>\n<li>\n<p>Thumb 상태에서는 옵셥이 없다.</p>\n</li>\n<li>\n<p>MOV, ADD 명령어에서 하나 이상의 상위 레지스터가 사용되는 경우를 제외하고 모든 데이터 처리 명령어는 CPSR의 ALU 상태 플래그를 업데이트 한다.</p>\n</li>\n<li>\n<p>MOV 및 ADD는 이러한 경우 상태 플래그를 업데이트 할 수 없다.</p>\n</li>\n</ul>\n<h3 id=\"arm-상태-수행\" style=\"position:relative;\"><a href=\"#arm-%EC%83%81%ED%83%9C-%EC%88%98%ED%96%89\" aria-label=\"arm 상태 수행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ARM 상태 수행</h3>\n<ul>\n<li>데이터 작업의 결과에 대해 CPSR의 ALU 상태 플래그를 업데이트 한다.</li>\n<li>플래그를 업데이트 하지 않고 다른 여러 데이터 작업을 실행한다.</li>\n<li>첫 번째 작업에서 업데이트 된 플래그의 상태에 따라 다음 명령을 실행하거나 실행하지 않는다.</li>\n<li>Thumb 상태에서 대부분의 데이터 작업은 항상 플래그를 업데이트하며 조건부 실행은 조건부 분기 명령어 (<code class=\"language-text\">B</code>) 를 사용해야 만 수행 가능 해당 명령어의 접미사는 ARM 상태와 동일하며 다른 명령은 조건부일 수 없다.</li>\n</ul>\n<h2 id=\"alu-status-flags\" style=\"position:relative;\"><a href=\"#alu-status-flags\" aria-label=\"alu status flags permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ALU Status Flags</h2>\n<ul>\n<li>CPSR에는 ALU 상태 플래그가 포함된다.</li>\n<li>CPSR 레지스터에 condition Flag에 정보에 맞춰서 분기</li>\n<li>ARM의 모든 명령은 조건 필드를 가지고 있고, 조건에 따라 실행 여부를 결정한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABz0lEQVQY02O4bD3t10XP2W+vu8z6vker6byminuSuXVjkqqqS5KEgkWCjpJT2nHZuvuXpBq/XNbu+nDJddaHM6od7y6IN345LFV9m5FVXsTVNozh////YMxQV/X8f1HOjf+FOY//x0es+6+i4vc/Jubof0lZh/88glr/hUVN/0cHHfpflHf/f27Gzf+FOTf/11Xe+d/W9OR/Zvy+/1JSlgH///9nnDR5Ec/////ZGIIDVr3zcJ3z3ttj6Qc3h+6nauo+tz295r+UkXe8IiSmf1VS2vKGt+us9/4+K957uy/+4Oe15k5o4PrrUWFbbgR4zLlpYxc6MyO7OnnylAU2////V2NwcQos1dN16Le18e4JDU4IVNe2U3H3iijLzpvMkJhUw5qSXioYFpbU6usd0RQemtTrbm4gwwABbFDMxMDAwwj3cm3jBNfE1HK/zNz6wK7eOYZBoRkCU6Yu9umfOJvB2jacYdXqrWyNLZNDaxr6g6rrelMmz97IH+buyoAMpGTNEGFoYRnEwcDAwBobV8jV1TWTg4FBgMnZNYYDpnje/FVM+/YdE5oyZSHPzl0HTQ8cOMnz//83hqSIHkZLrQwGDW1nhrjEQobM7CqwgQA0pcsbNMOf0wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./ARM-CPSR.png\"\n        title=\"./ARM-CPSR.png\"\n        src=\"/static/b4f9de9b7908179611816da8632106ac/37523/ARM-CPSR.png\"\n        srcset=\"/static/b4f9de9b7908179611816da8632106ac/e9ff0/ARM-CPSR.png 180w,\n/static/b4f9de9b7908179611816da8632106ac/f21e7/ARM-CPSR.png 360w,\n/static/b4f9de9b7908179611816da8632106ac/37523/ARM-CPSR.png 720w,\n/static/b4f9de9b7908179611816da8632106ac/302a4/ARM-CPSR.png 1080w,\n/static/b4f9de9b7908179611816da8632106ac/07a9c/ARM-CPSR.png 1440w,\n/static/b4f9de9b7908179611816da8632106ac/6789f/ARM-CPSR.png 2599w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>N flag : 연산 결과가 음수 일때 설정</li>\n<li>Z Flag : 연산결과가 0 일때 설정</li>\n<li>C Flag : 작업 결과 캐리가 발생하면 설정된다.\n<ul>\n<li>덧셈 결과가 2^32 이상이거나 뺄셈 결과가 양수인 경우 또는 이동 또는 논리적 명령에서 인라인 배럴 시프터 작업의 결과로 캐기 가 발생함</li>\n</ul>\n</li>\n<li>V Flag : 작업으로 인해 OVerflow가 발생했을 떄 설정\n<ul>\n<li>더하기, 빼기 또는 비교의 결고과 2^31 보다 크거나 -2^31 보다 작은 경우 오버플로우가 발생한다.</li>\n</ul>\n</li>\n<li>Q Flag : ARM 아키텍처 v5E에 해당되며 고정 플래그이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">\t접미사         \t플래그              \t      의미\n    EQ              Z Set                       같은\n    NE\t            Z clear                     같지 않음\n    CS<span class=\"token operator\">/</span>HS\t          C Set                       높거나 같음 <span class=\"token punctuation\">(</span>Unsigned<span class=\"token operator\">></span> <span class=\"token operator\">=</span><span class=\"token punctuation\">)</span>\n    CC<span class=\"token operator\">/</span>LO\t          C clear                     낮은 <span class=\"token punctuation\">(</span>Unsigned <span class=\"token operator\">&lt;</span><span class=\"token punctuation\">)</span>\n    MI\t            N Set                       부정\n    PL\t            N clear                     양수 <span class=\"token operator\">or</span> <span class=\"token number\">0</span>\n    VS\t            V Set                       Overflow\n    VC\t            V clear                     No Overflow\n    HI\t            C set <span class=\"token operator\">and</span> Z clear\t          더 높음 <span class=\"token punctuation\">(</span>Unsigned<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n    LS\t            C clear <span class=\"token operator\">or</span> Z set\t          낮거나 같음 <span class=\"token punctuation\">(</span>Unsigned <span class=\"token operator\">&lt;=</span><span class=\"token punctuation\">)</span>\n    GE\t            N <span class=\"token operator\">and</span> V the same\t          Signed <span class=\"token operator\">></span> <span class=\"token operator\">=</span>\n    LT\t            N <span class=\"token operator\">and</span> V differ\t            Signed <span class=\"token operator\">&lt;</span>\n    GT\t            Z clear N <span class=\"token operator\">and</span> V the same\t  Signed <span class=\"token operator\">></span>\n    LE\t            Z set N <span class=\"token operator\">and</span> V differ\t      Signed <span class=\"token operator\">&lt;=</span>\n    AL\t            Any\t                        항상<span class=\"token punctuation\">.</span> 이 접미사는 일반적으로 생략됨</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">\t\tADD     r0<span class=\"token punctuation\">,</span> r1<span class=\"token punctuation\">,</span> r2    <span class=\"token punctuation\">;</span> r0 <span class=\"token operator\">=</span> r1 <span class=\"token operator\">+</span> r2<span class=\"token punctuation\">,</span> don<span class=\"token number\">'</span>t update flags\n    ADDS    r0<span class=\"token punctuation\">,</span> r1<span class=\"token punctuation\">,</span> r2    <span class=\"token punctuation\">;</span> r0 <span class=\"token operator\">=</span> r1 <span class=\"token operator\">+</span> r2<span class=\"token punctuation\">,</span> <span class=\"token operator\">and</span> update flags\n    ADDCSS  r0<span class=\"token punctuation\">,</span> r1<span class=\"token punctuation\">,</span> r2    <span class=\"token punctuation\">;</span> If C flag set then r0 <span class=\"token operator\">=</span> r1 <span class=\"token operator\">+</span> r2<span class=\"token punctuation\">,</span> <span class=\"token operator\">and</span> update flags\n    CMP     r0<span class=\"token punctuation\">,</span> r1        <span class=\"token punctuation\">;</span> update flags based on r0<span class=\"token operator\">-</span>r1<span class=\"token punctuation\">.</span></code></pre></div>\n<h3 id=\"arm-상태에서-조건부-실행\" style=\"position:relative;\"><a href=\"#arm-%EC%83%81%ED%83%9C%EC%97%90%EC%84%9C-%EC%A1%B0%EA%B1%B4%EB%B6%80-%EC%8B%A4%ED%96%89\" aria-label=\"arm 상태에서 조건부 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ARM 상태에서 조건부 실행</h3>\n<ul>\n<li>arm 명령어의 조건부 실행을 사용하여 코드에서 분기 명령어 수를 줄 일 수 있으며 코드 밀도를 향상시킬 수 있음</li>\n<li>분기 명령어는 프로세서 주기에서도 비용이 많이 든다.</li>\n<li>분기 예측 하드웨어가 없는 ARM 프로세서에서는 일반적으로 분기가 수행될 때 마다 프로세서 파이프 라인을 다시 채우는 데 3개의 프로세서 주기가 필요하다.</li>\n<li>ARM10, StrongARM과 같은 일부 ARM 프로세서에는 분기 예측 하드웨어가 있다.</li>\n<li>이러한 프로세서를 사용하는 시스템에서는 잘못된 예측이 있을 때만 파이프 라인을 flushed 하고 다시 채우면 된다.</li>\n</ul>\n<h3 id=\"조건부-실행-연습\" style=\"position:relative;\"><a href=\"#%EC%A1%B0%EA%B1%B4%EB%B6%80-%EC%8B%A4%ED%96%89-%EC%97%B0%EC%8A%B5\" aria-label=\"조건부 실행 연습 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>조건부 실행 연습</h3>\n<ul>\n<li>Euclid의 최대 공약수 (gcd) 알고리즘의 두 가지 구현을 사용한다.</li>\n<li>조건부 실행을 사용하여 코드 밀도와 실행 속도를 향상 시키는 방법을 보여준다.</li>\n<li>실행 속도에 대한 자세한 분석은 ARM7 프로세서에만 적용된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">gcd</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> a<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> b<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">!=</span> b<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">></span> b<span class=\"token punctuation\">)</span>\n\t\t\ta <span class=\"token operator\">-=</span> b<span class=\"token punctuation\">;</span>\n\t\tb <span class=\"token operator\">=</span><span class=\"token operator\">-</span> a<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> a<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>분기의 조건부 실행으로 gcd 함수 구현</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">gcd     CMP     r0<span class=\"token punctuation\">,</span> r1\n        BEQ     end\n        BLT     less\nless\n        SUB     r0<span class=\"token punctuation\">,</span> r0<span class=\"token punctuation\">,</span> r1\n        B       gcd\nend</code></pre></div>\n<ul>\n<li>\n<p>분기 수가 많기 때문에 코드는 7개의 명령어 길이이다.</p>\n</li>\n<li>\n<p>분기를 사용할 때마다 프로세서는 파이프 라인을 다시 채우고 새 위치에서 계속해야 한다.</p>\n</li>\n<li>\n<p>다른 명령어와 실행되지 않은 분기는 각각 단일 사이클을 사용해야 한다.</p>\n</li>\n<li>\n<p>ARM 명령어 집합의 조건부 실행 기능을 사용하여 다음 네 개의 명령어에서만 gcd 함수를 구현할 수 있다.</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">gcd\n        CMP     r0<span class=\"token punctuation\">,</span> r1\n        SUBGT   r0<span class=\"token punctuation\">,</span> r0<span class=\"token punctuation\">,</span> r1\n        SUBLT   r1<span class=\"token punctuation\">,</span> r1<span class=\"token punctuation\">,</span> r0\n        BNE     gcd</code></pre></div>\n<ul>\n<li>코드 크기를 개선하는 것 외에도 해당 코드는 대부분의 경우 더 빠르게 실행된다.</li>\n<li>다음은 r0 : 1, r1: 2 인 경우 각 구현에서 사용된는 사이클 수를 확인할 수 있다.</li>\n<li>해당 경우 분기를 모든 명령어의 조건부 실행으로 바꾸면 세 사이클이 절약된다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">r0<span class=\"token operator\">:</span> a\tr1<span class=\"token operator\">:</span> b\tInstruction\t<span class=\"token function\">Cycles</span> <span class=\"token punctuation\">(</span>ARM7<span class=\"token punctuation\">)</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">2</span>\tCMP r0<span class=\"token punctuation\">,</span> r1\t<span class=\"token number\">1</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">2</span>\tBEQ end\t<span class=\"token number\">1</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">not</span> executed<span class=\"token punctuation\">)</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">2</span>\tBLT less\t<span class=\"token number\">3</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">2</span>\tSUB r1<span class=\"token punctuation\">,</span> r1<span class=\"token punctuation\">,</span> r0\t<span class=\"token number\">1</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">2</span>\tB gcd\t<span class=\"token number\">3</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">1</span>\tCMP r0<span class=\"token punctuation\">,</span> r1\t<span class=\"token number\">1</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">1</span>\tBEQ end\t<span class=\"token number\">3</span>\nTotal <span class=\"token operator\">=</span> <span class=\"token number\">13</span>\n\nr0<span class=\"token operator\">:</span> a\tr1<span class=\"token operator\">:</span> b\tInstruction\t<span class=\"token function\">Cycles</span> <span class=\"token punctuation\">(</span>ARM7<span class=\"token punctuation\">)</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">2</span>\tCMP r0<span class=\"token punctuation\">,</span> r1\t<span class=\"token number\">1</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">2</span>\tSUBGT r0<span class=\"token punctuation\">,</span>r0<span class=\"token punctuation\">,</span>r1\t<span class=\"token number\">1</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">not</span> executed<span class=\"token punctuation\">)</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">1</span>\tSUBLT r1<span class=\"token punctuation\">,</span>r1<span class=\"token punctuation\">,</span>r0\t<span class=\"token number\">1</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">1</span>\tBNE gcd\t<span class=\"token number\">3</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">1</span>\tCMP r0<span class=\"token punctuation\">,</span>r1\t<span class=\"token number\">1</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">1</span>\tSUBGT r0<span class=\"token punctuation\">,</span>r0<span class=\"token punctuation\">,</span>r1\t<span class=\"token number\">1</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">not</span> executed<span class=\"token punctuation\">)</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">1</span>\tSUBLT r1<span class=\"token punctuation\">,</span>r1<span class=\"token punctuation\">,</span>r0\t<span class=\"token number\">1</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">not</span> executed<span class=\"token punctuation\">)</span>\n<span class=\"token number\">1</span>\t<span class=\"token number\">1</span>\tBNE gcd\t<span class=\"token number\">1</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">not</span> executed<span class=\"token punctuation\">)</span>\nTotal <span class=\"token operator\">=</span> <span class=\"token number\">10</span></code></pre></div>\n<ul>\n<li>연습 2</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">loop\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\tSUBS         r1<span class=\"token punctuation\">,</span> r1<span class=\"token punctuation\">,</span> #<span class=\"token number\">1</span>\n\tBNE          loop</code></pre></div>\n<ul>\n<li>\n<p>SUB 명령을 실행한 결과 Z flag가 SET 되면 명령 실행 suffix가 S 로 설정되어 있기떄문에 명령 실행결과를 CPSR 에 반영</p>\n</li>\n<li>\n<p>연습 3</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a1 <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nCMP     r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">0</span>\nMOVEQ   r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">1</span>\nBLEQ     func\n</code></pre></div>\n<ul>\n<li>연습 4</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a2 <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a2 <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  x <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\nCMP     r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">0</span>\nMOVEQ   r1<span class=\"token punctuation\">,</span> #<span class=\"token number\">0</span>\nMOVGT   r2<span class=\"token punctuation\">,</span> #<span class=\"token number\">1</span></code></pre></div>\n<ul>\n<li>연습 5</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>a<span class=\"token operator\">==</span><span class=\"token number\">4</span> <span class=\"token operator\">||</span> a<span class=\"token operator\">==</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> x<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\nCMP     r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">4</span>\nCMPNE   r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">10</span>\nMOVEQ   r1<span class=\"token punctuation\">,</span> #<span class=\"token number\">0</span></code></pre></div>\n<h2 id=\"calling-convention\" style=\"position:relative;\"><a href=\"#calling-convention\" aria-label=\"calling convention permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calling Convention</h2>\n<ul>\n<li>r0~r3 순서대로 인자를 저장</li>\n<li>인자가 4개 이상이면 스택을 사용한다.</li>\n<li>BL 명령으로 호출할 시 리턴주소는 LR 레지스터에 저장</li>\n<li>함수 리턴 값 반환은 r0 레지스터를 사용한다.</li>\n</ul>\n<h3 id=\"thumb-converting\" style=\"position:relative;\"><a href=\"#thumb-converting\" aria-label=\"thumb converting permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Thumb Converting</h3>\n<ul>\n<li>Thumb로 변환</li>\n<li><code class=\"language-text\">B</code>는 조건부로 실행할 수 있는 유일한 Thumb 명령어이다. gcd 알고리즘은 Thumb 코드의 조건부 분기로 작성되어야 한다.</li>\n<li>ARM 조건부 분기 구현과 마찬가지로 Thumb 코드에는 7개의 명령어가 필요하다.</li>\n<li>그러나 Thumb 명령어의 길이는 16비트에 불과하기 때문에 전체 코드 크기는 14바이트이다.</li>\n<li>16비트 메모리를 사용하는 시스템에서는 각 Thumb 명령어에 대해 하나의 메모리 액세스 만 필요하지만 각 ARM 명령어에는 두 번의 fetch가 필요하다.</li>\n<li>Thumb 버전이 두 번째 ARM 구현보다 빠르게 실행된다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#conditional-execution\">Conditional Execution</a></p>\n<ul>\n<li><a href=\"#arm-%EC%83%81%ED%83%9C-%EC%88%98%ED%96%89\">ARM 상태 수행</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#alu-status-flags\">ALU Status Flags</a></p>\n<ul>\n<li><a href=\"#arm-%EC%83%81%ED%83%9C%EC%97%90%EC%84%9C-%EC%A1%B0%EA%B1%B4%EB%B6%80-%EC%8B%A4%ED%96%89\">ARM 상태에서 조건부 실행</a></li>\n<li><a href=\"#%EC%A1%B0%EA%B1%B4%EB%B6%80-%EC%8B%A4%ED%96%89-%EC%97%B0%EC%8A%B5\">조건부 실행 연습</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#calling-convention\">Calling Convention</a></p>\n<ul>\n<li><a href=\"#thumb-converting\">Thumb Converting</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"ARM Conditional Execution Conditional Execution ARM 상태에서 각 데이터 처리 명령어에는 작업 결과에 따라 CPSR(Current Program State Register)의 ALU 상태 플래그를 업데이트 하는 옵션이 있다. ARM 데이터 처리 명령어에 S 접미사를 추가하여 CPSR에서 ALU 상태 플래그를 업데이트 한다. CMP, CMN, TST, TEQ에 S 접미사를 사용하면 안된다. 이러한 비교 명령어는 항상 플래그를 업데이트 하기 때문이다. Thumb 상태에서는 옵셥이 없다. MOV, ADD 명령어에서 하나 이상의 상위 레지스터가 사용되는 경우를 제외하고 모든 데이터 처리 명령어는 CPSR의 ALU 상태 플래그를 업데이트 한다. MOV 및 ADD는 이러한 경우 상태 플래그를 업데이트 할 수 없다. ARM 상태 수행 데이터 작업의 결과에 대해 CPSR의 ALU 상태 플래그를 업데이트 한다. 플래그를 업데이트 하지 않고 다른 여러 데이터 …","frontmatter":{"date":"February 09, 2021","title":"ARM Conditional Execution","categories":"ARM","author":"Zer0Luck","emoji":"🍜"},"fields":{"slug":"/arm-2/"}},"next":{"id":"c815f14e-ef2b-5028-8e13-3ac996822daa","html":"<h1 id=\"thread-local-storage-tls\" style=\"position:relative;\"><a href=\"#thread-local-storage-tls\" aria-label=\"thread local storage tls permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Thread Local Storage (TLS)</h1>\n<ul>\n<li>프로세스의 모든 스레드는 가상 주소 공간을 공유한다.</li>\n<li>함수의 지역 변수는 함수를 실행하는 각 스레드에 공유한다.</li>\n<li>정적 및 전역 변수는 프로세스의 모든 스레드에서 공유된다.</li>\n<li>즉, 스레드 별로 독립된 데이터 저장 공간이며 스레드 내에서 프로세스의 전역(Global) 데이터나 정적(static) 데이터를 마치 지역(Local) 데이터 처럼 독립적으로 취급하고 싶을 때 사용한다.</li>\n</ul>\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ms686749(VS.85),aspx\"></a></p>\n<h3 id=\"image_data_directory9\" style=\"position:relative;\"><a href=\"#image_data_directory9\" aria-label=\"image_data_directory9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IMAGE_DATA_DIRECTORY[9]</h3>\n<ul>\n<li>PE 헤더의 TLS Table 항목이 세팅된다.</li>\n<li>IMAGE_NT_HEADERS - IMAGE_OPTIONAL_HEADER - IMAGE_DATA_DIRECTORY[9]</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABH0lEQVQY03WO20rDQBRF8/9/IeIFQRR80zcFLU2TTFKENplOMjknE01rbWPmFmsjrYii7WI9bdjs7URhROmEsdT3fMTCGGOttW2rlEIoRCG01nYPTuD541FME9rv9bM001p/9WXTICDksFgsrbVmFw4JSMpSSunA9XjGv5etVqrAAnKYzV7att29HBGSxAmbsDCMGGN1Xcstb3UNOQBAWZZyD84wGtKE8jQLSQSAP7elREAhSiHKaTXdfdvzgjimSTJxXS/jeaO01EYaWzcSUQCKajaXymzCfzqjMBCcQUofB/2q4B/rtuveu261XpllVb4+4Vzkzfx5G/7VObwhJ3fj49v44Jqc3bMLUl2G042kuvLx3IWjB37ay3/yX34CADW01zVfHdMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/951b7d99cad673b600e2b007c4632544/37523/0.png\"\n        srcset=\"/static/951b7d99cad673b600e2b007c4632544/e9ff0/0.png 180w,\n/static/951b7d99cad673b600e2b007c4632544/f21e7/0.png 360w,\n/static/951b7d99cad673b600e2b007c4632544/37523/0.png 720w,\n/static/951b7d99cad673b600e2b007c4632544/02cd5/0.png 821w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>{: width=“65%” height=“65%“}</p>\n<ul>\n<li>RVA 01AAF3A0 주소에는 IMAGE_TLS_DIRECTORY 구조체가 있다.</li>\n</ul>\n<h3 id=\"image_tls_directory\" style=\"position:relative;\"><a href=\"#image_tls_directory\" aria-label=\"image_tls_directory permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IMAGE_TLS_DIRECTORY</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_TLS_DIRECTORY64</span> <span class=\"token punctuation\">{</span>\n    ULONGLONG StartAddressOfRawData<span class=\"token punctuation\">;</span>\n    ULONGLONG EndAddressOfRawData<span class=\"token punctuation\">;</span>\n    ULONGLONG AddressOfIndex<span class=\"token punctuation\">;</span>         <span class=\"token comment\">// PDWORD</span>\n    ULONGLONG AddressOfCallBacks<span class=\"token punctuation\">;</span>     <span class=\"token comment\">// PIMAGE_TLS_CALLBACK *;</span>\n    DWORD SizeOfZeroFill<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">union</span> <span class=\"token punctuation\">{</span>\n        DWORD Characteristics<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n            DWORD Reserved0 <span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n            DWORD Alignment <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n            DWORD Reserved1 <span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> DUMMYSTRUCTNAME<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> DUMMYUNIONNAME<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span> IMAGE_TLS_DIRECTORY64<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">typedef</span> IMAGE_TLS_DIRECTORY64 <span class=\"token operator\">*</span> PIMAGE_TLS_DIRECTORY64<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IMAGE_TLS_DIRECTORY32</span> <span class=\"token punctuation\">{</span>\n    DWORD   StartAddressOfRawData<span class=\"token punctuation\">;</span>\n    DWORD   EndAddressOfRawData<span class=\"token punctuation\">;</span>\n    DWORD   AddressOfIndex<span class=\"token punctuation\">;</span>             <span class=\"token comment\">// PDWORD</span>\n    DWORD   AddressOfCallBacks<span class=\"token punctuation\">;</span>         <span class=\"token comment\">// PIMAGE_TLS_CALLBACK *</span>\n    DWORD   SizeOfZeroFill<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">union</span> <span class=\"token punctuation\">{</span>\n        DWORD Characteristics<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n            DWORD Reserved0 <span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n            DWORD Alignment <span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n            DWORD Reserved1 <span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> DUMMYSTRUCTNAME<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> DUMMYUNIONNAME<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span> IMAGE_TLS_DIRECTORY32<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> IMAGE_TLS_DIRECTORY32 <span class=\"token operator\">*</span> PIMAGE_TLS_DIRECTORY32<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">_WIN64</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">IMAGE_ORDINAL_FLAG</span>              <span class=\"token expression\">IMAGE_ORDINAL_FLAG64</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">IMAGE_ORDINAL</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span>          <span class=\"token function\">IMAGE_ORDINAL64</span><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token keyword\">typedef</span> IMAGE_THUNK_DATA64              IMAGE_THUNK_DATA<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> PIMAGE_THUNK_DATA64             PIMAGE_THUNK_DATA<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">IMAGE_SNAP_BY_ORDINAL</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span>  <span class=\"token function\">IMAGE_SNAP_BY_ORDINAL64</span><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token keyword\">typedef</span> IMAGE_TLS_DIRECTORY64           IMAGE_TLS_DIRECTORY<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> PIMAGE_TLS_DIRECTORY64          PIMAGE_TLS_DIRECTORY<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">IMAGE_ORDINAL_FLAG</span>              <span class=\"token expression\">IMAGE_ORDINAL_FLAG32</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">IMAGE_ORDINAL</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span>          <span class=\"token function\">IMAGE_ORDINAL32</span><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token keyword\">typedef</span> IMAGE_THUNK_DATA32              IMAGE_THUNK_DATA<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> PIMAGE_THUNK_DATA32             PIMAGE_THUNK_DATA<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">IMAGE_SNAP_BY_ORDINAL</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span>  <span class=\"token function\">IMAGE_SNAP_BY_ORDINAL32</span><span class=\"token punctuation\">(</span>Ordinal<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token keyword\">typedef</span> IMAGE_TLS_DIRECTORY32           IMAGE_TLS_DIRECTORY<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">typedef</span> PIMAGE_TLS_DIRECTORY32          PIMAGE_TLS_DIRECTORY<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></code></pre></div>\n<ul>\n<li>IMAGE_TLS_DIRECTORY 구조체는 x86/x64 bit로 설계되어 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVQY033PUUvDMBAH8Hz/ryEoE9tVBlqf9+xEtzpZW6attKRZlibXmqYuuaHDsQ3193BwHHd/jlxcng3888FV4F/fDEfhbXgXhmEQBJ7n+d+Gh4Kv4v0gK1Gm70nFFVuD+vjEYwCNWAtoQAjBKial1FobY5x1iEg4Wy3TV0S0duMOWGsRMc/zh8kkjpOnx2k0nUWziHPe933XdcYYwhiL41QpwN9QSvMsrypWFmVRFHUtEXEfQEDBYj4vsjeQom3bXeCOtZZSum+dcyenSS2VN45G99n4pTL90c/WWs45/o1orZ8Xy3mSNd3mZOacA4B/lrdg+oIEw1W7fAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/047eb756a6e49b68888846fb2d4bde8e/37523/1.png\"\n        srcset=\"/static/047eb756a6e49b68888846fb2d4bde8e/e9ff0/1.png 180w,\n/static/047eb756a6e49b68888846fb2d4bde8e/f21e7/1.png 360w,\n/static/047eb756a6e49b68888846fb2d4bde8e/37523/1.png 720w,\n/static/047eb756a6e49b68888846fb2d4bde8e/47aef/1.png 1063w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>RVA 01AAF3A0 해당 위치에 구조체 멤버를 확인해보겠다.</li>\n<li><code class=\"language-text\">AddressOfCallbacks</code> 멤버는 TLS 콜백 함수 주소 (VA 형태) 배열을 가리키며 배열의 끝은 NULL로 표시한다.</li>\n<li>프로그램에 TLS Call Back Function 를 여러 개등록할 수 있다.</li>\n<li>프로세스가 시작될 때 Entry Point 코드 실행 전에 시스템에서 AddressOfCallback 의 배열에 저장된 함수를 하나씩 호출한다.</li>\n</ul>\n<h3 id=\"tls-call-back-function\" style=\"position:relative;\"><a href=\"#tls-call-back-function\" aria-label=\"tls call back function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TLS Call Back Function</h3>\n<ul>\n<li>리버싱 분야에서 Anti-Debugging 기법으로 주로 많이 사용된다.</li>\n<li>TLS Call Back Function은 EP(Entry-Point) 보다 먼저 실행되는 특징을 가지고 있다.</li>\n<li>프로세스의 스레드가 생성/종료될 때 마다 자동으로 호출되는 콜백 함수</li>\n<li>프로세스의 메인 스레드가 생성될 때도 콜백 함수가 호출된다.</li>\n<li>Entry Point 코드보다 먼저 호출되어 Anti-Debugging에서 많이 쓰인다.</li>\n<li>스레드의 생성시점과 종료시점에 2번 자동으로 호출되는 함수이다.</li>\n<li>프로세스의 EP 코드를 실해하는 메인 스레드가 실행될 때 TLS 콜백 함수가 먼저 호출되는 원리이다.</li>\n</ul>\n<h3 id=\"image_tls_callback\" style=\"position:relative;\"><a href=\"#image_tls_callback\" aria-label=\"image_tls_callback permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IMAGE_TLS_CALLBACK</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">typedef</span> <span class=\"token function\">VOID</span>\n<span class=\"token punctuation\">(</span>NTAPI <span class=\"token operator\">*</span>PIMAGE_TLS_CALLBACK<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>\n    PVOID DllHandle<span class=\"token punctuation\">,</span>\n    DWORD Reason<span class=\"token punctuation\">,</span>\n    PVOID Reserved\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>TLS 콜백 함수 정의는 DllMain() 함수 정의와 비슷 한 것을 알 수있다.</li>\n</ul>\n<h3 id=\"dllmain\" style=\"position:relative;\"><a href=\"#dllmain\" aria-label=\"dllmain permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DllMain()</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">BOOL WINAPI <span class=\"token function\">DllMain</span><span class=\"token punctuation\">(</span>\n    HINSTANCE hinstDLL<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// handle to DLL module</span>\n    <span class=\"token module\">DWORD</span> fdwReason<span class=\"token punctuation\">,</span>     <span class=\"token comment\">// reason for calling function</span>\n    LPVOID lpReserved <span class=\"token punctuation\">)</span>  <span class=\"token comment\">// reserved</span></code></pre></div>\n<ul>\n<li>\n<p>파라미터의 순서와 의미도 동일하다.</p>\n</li>\n<li>\n<p>DllHandle 파라미터는 모듈의 핸들, 로딩 주소 이다.</p>\n</li>\n<li>\n<p>Reason 파라미터는 TLS 콜백 함수가 호출된 이유</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">defind</span> <span class=\"token expression\">DLL_PROCESS_ATTACH  <span class=\"token number\">1</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DLL_THREAD_ATTACH</span>   <span class=\"token expression\"><span class=\"token number\">2</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">DLL_THREAD_DETACH</span>   <span class=\"token expression\"><span class=\"token number\">3</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token expression\">DEFINE </span><span class=\"token macro-name\">DLL_PROCESS_DETACH</span>  <span class=\"token expression\"><span class=\"token number\">0</span></span></span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"dll_process_attach\" style=\"position:relative;\"><a href=\"#dll_process_attach\" aria-label=\"dll_process_attach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DLL_PROCESS_ATTACH</h3>\n<ul>\n<li>프로세스의 메인 스레드가 main 함수를 호출하기 전에 등록된 TLS 콜백 함수들이 호출된다.</li>\n<li>이때 Reason  값은 1(DLL_PROCESS_ATTACH)</li>\n</ul>\n<h3 id=\"dll_thread_attach\" style=\"position:relative;\"><a href=\"#dll_thread_attach\" aria-label=\"dll_thread_attach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DLL_THREAD_ATTACH</h3>\n<ul>\n<li>TLS 콜백 함수들이 모두 종료되면 main 함수가 실행된다.</li>\n<li>사용자 스레드를 생성하는 순간 Reason = 2(DLL_THREAD_ATTACH)로 TLS 콜백 함수들이 동작한다.</li>\n</ul>\n<h3 id=\"dll_thread_detach\" style=\"position:relative;\"><a href=\"#dll_thread_detach\" aria-label=\"dll_thread_detach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DLL_THREAD_DETACH</h3>\n<ul>\n<li>TLS 콜백 함수들이 모두 종료되면 사용자 스레드로 생성한 해당 함수가 실행된다.</li>\n<li>그리고 스레드 함수가 종료되는 순간 Reason = 3(DLL_THREAD_DETACH)로 TLS 콜백 함수들이 호출된다.</li>\n</ul>\n<h3 id=\"dll_process_detach\" style=\"position:relative;\"><a href=\"#dll_process_detach\" aria-label=\"dll_process_detach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DLL_PROCESS_DETACH</h3>\n<ul>\n<li>사용자 쓰레드가 종료되면 스레드의 종료를 기다리던 main 함수(메인 스레드) 역시 종료한다.</li>\n<li>이때 마지막으로 Reason = 0 (DLL_PROCESS_DETACH) 값으로 TLS 콜백 함수들이 호출된다.</li>\n</ul>","frontmatter":{"date":"January 03, 2021","title":"TLS(Thread Local Storage CallBack)","categories":"Windows","author":"Zer0Luck","emoji":"🍯"},"fields":{"slug":"/window_5_theori/"}},"prev":{"id":"b8ba7110-bd58-55fc-9b7d-e2fd22b2ff00","html":"<h1 id=\"arm-instruction-layout\" style=\"position:relative;\"><a href=\"#arm-instruction-layout\" aria-label=\"arm instruction layout permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ARM Instruction Layout</h1>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token punctuation\">{</span>\n\tlabel\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span>\n\tinstruction\n<span class=\"token operator\">|</span>\n\tdirective\n<span class=\"token operator\">|</span>\npseudo<span class=\"token operator\">-</span>instruction\n<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">;</span> comment<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>label이 없더라도 명령어, 의사 명령어 및 지시어에는 공간이나 탭과 같은 공백이 선행되어야 한다.</li>\n</ul>\n<h3 id=\"case-rule\" style=\"position:relative;\"><a href=\"#case-rule\" aria-label=\"case rule permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CASE Rule</h3>\n<ul>\n<li>명령어, 지시문 및 기호 레지스터 이름은 대문자 또는 소문자로 쓸 수 는 있지만 혼합 불가</li>\n</ul>\n<h3 id=\"line-length\" style=\"position:relative;\"><a href=\"#line-length\" aria-label=\"line length permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Line Length</h3>\n<ul>\n<li>Line이 길면 <code class=\"language-text\">\\</code> 백 슬래시 문자를 바탕으로 여러 line으로 나누기 가능</li>\n<li>백슬래시 뒤에는 다른 문자가 올 수 었다.</li>\n</ul>\n<h3 id=\"label\" style=\"position:relative;\"><a href=\"#label\" aria-label=\"label permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Label</h3>\n<ul>\n<li>주소를 나타내는 기호이다.</li>\n<li>레이블에 지정된 주소는 assembly 중에 계산된다.</li>\n<li>어셈블러는 레이블이 정의 된 섹션의 원점을 기준으로 레이블의 주소를 계산한다.</li>\n<li>동일한 섹션 내의 레이블에 대한 참조는 오프셋을 더하거나 뺀 프로그램 카운터를 사용할 수 있으며 이를 프로그램 기준 주소 지정이라고 한다.</li>\n</ul>\n<h3 id=\"local-label\" style=\"position:relative;\"><a href=\"#local-label\" aria-label=\"local label permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local Label</h3>\n<ul>\n<li>지역 레이블은 레이블의 하위 클래스이다.</li>\n<li>지역 레이블은 0-99 범위의 숫자로 시작한다.</li>\n<li>다른 레이블과 달리 로컬 레이블은 여러 번 정의할 수 있다.</li>\n<li>지역 레이블은 매크로를 사용하여 레이블을 생성할 때 유리하다.</li>\n<li>어셈블러는 로컬 레이블에 대한 참조를 찾으면 해당 참조를 로컬 레이블의 가까운 인스턴스에 연결한다.</li>\n</ul>\n<h3 id=\"comment\" style=\"position:relative;\"><a href=\"#comment\" aria-label=\"comment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Comment</h3>\n<ul>\n<li>줄의 첫 번째 세미클론은 세미클론이 문자열 상수 내부에 나타나는 경우를 제외하고 주석의 시작을 표시한다.</li>\n<li>줄의 끝은 주석의 끝이다.</li>\n<li>주석 만 유효한 줄이다.</li>\n<li>어셈블러는 모든 주석을 무시한다.</li>\n</ul>\n<h3 id=\"arm-instruction-format\" style=\"position:relative;\"><a href=\"#arm-instruction-format\" aria-label=\"arm instruction format permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ARM Instruction Format</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADR0lEQVQoz03Ra2xTdRzG8b8RHaGI0XSX7kaAjW0w0UlK17KznvV6Lj2ja0s3W9gqkyHSOBMYJka2aBRpDCqSqLyThYuJm0twNTJlMw1G18toR3Eb8ZJgNHW1a6IkOE7PecwZkvjik+fd98XvR4pUtRcq1+uWPZ3PZ6ysP0ubvVnX7r5F2uxdVD1av7RuXc1TFWsbiOmB7YQ8VLl323bmn319A5mWNk+2scmWFVy9Wadnf6aZ6lh+cM3GI0RdRsXKq613Gho7crX1Qn5zQ3u+fqszX1PnWCotN91+TEOdER7euBqq84/Qj7edra4yLW+pc+RqN/H5DdW2/OZNfH5LnbBUV8PdLiulrhIjfTbPstMwmycli/WbeyxTksUyWWC4GGht6O9LpKkJhK14of5Y2klNwNN2WRwKfiu9elBxVTrovSLtoqYKnPYMiMky+qfgSMNuj8uMPQGbLQGGmQHLxiVeuIFntB/eepcQFXwgWu2bUx32ODrYeGGfL4lu7zUEupLo3BWHk5mFvXVEIrxhOOdlEgi4p+WAOyrv74rLPa6ovJv7TvLZ4nA3DN0ihKgiANHpQxFemAHDxQpWe0y2MTFZWTsblXnhukybR2XipoZzfmcKr72cll95KY3Q0DwGD6fxnD8h+fgk2p8+vhK8A5AduhMRnkuAZWMFjo3jPpaNgudnQbeNgriET3Mn3/gFxwd/kAcHbkDx3ls38fbrc9KxIz+BMb+vBNdmMkowFOG4lXMU2JXQfUrw+r0gw43k/HvnsKc7Kfv2pODzp9AdmIW3a0Y6FPwRL/af+5UQUvTXHyC65hMRQUiAZaIFholCocSUpwqOFEzmERCrdWyxvX0BHJcUeX52BcelRJ5L3nXw83C5Lvw2/f3FxtMfrCky0ienOr1zCATml/v6boq9vQvis4EFsadnTvT7fxZZLiwSXfPpu63GcbRQn4GixtBCjf23ozDSX+CJJwfzhwfYCuD39S7PO/M2+yUcCn6Fo0cn0d//NQ4cmEAwOAG3ewKtxo9A1GW6T0o0hi+LNfrxYo0+/D/jJRrDZXXpjo8JIatOnRomVRtaQhXVO68Ua/Sfq0v1YXWZPqypNIRLyg1hTeXOcHmVPvwvE2y5YwwkMRkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./ARM-BL.png\"\n        title=\"./ARM-BL.png\"\n        src=\"/static/3b432998e0387524dd176c2faab80b43/37523/ARM-BL.png\"\n        srcset=\"/static/3b432998e0387524dd176c2faab80b43/e9ff0/ARM-BL.png 180w,\n/static/3b432998e0387524dd176c2faab80b43/f21e7/ARM-BL.png 360w,\n/static/3b432998e0387524dd176c2faab80b43/37523/ARM-BL.png 720w,\n/static/3b432998e0387524dd176c2faab80b43/302a4/ARM-BL.png 1080w,\n/static/3b432998e0387524dd176c2faab80b43/58354/ARM-BL.png 1396w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">AREA     ARMtest<span class=\"token punctuation\">,</span> CODE<span class=\"token punctuation\">,</span> READONLY\n                                <span class=\"token punctuation\">;</span> 해당 code block의 이름을 ARMtest 지정\n        ENTRY                   <span class=\"token punctuation\">;</span> 실행할 첫 번째 명령 표시\nstart\n        MOV      r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">10</span>        <span class=\"token punctuation\">;</span> 파라미터 설정\n        MOV      r1<span class=\"token punctuation\">,</span> #<span class=\"token number\">3</span>\n        ADD      r0<span class=\"token punctuation\">,</span> r0<span class=\"token punctuation\">,</span> r1     <span class=\"token punctuation\">;</span> r0 <span class=\"token operator\">=</span> r0 <span class=\"token operator\">+</span> r1\nstop\n        MOV      r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x18</span>      <span class=\"token punctuation\">;</span> angel_SWIreason_ReportException\n        LDR      r1<span class=\"token punctuation\">,</span> <span class=\"token operator\">=</span><span class=\"token number\">0x20026</span>   <span class=\"token punctuation\">;</span> ADP_Stopped_ApplicationExit\n        SWI      <span class=\"token number\">0x123456</span>       <span class=\"token punctuation\">;</span> ARM semihosting SWI\n        END                     <span class=\"token punctuation\">;</span> Mark end of file</code></pre></div>\n<h3 id=\"elf-세션-및-area-instruction\" style=\"position:relative;\"><a href=\"#elf-%EC%84%B8%EC%85%98-%EB%B0%8F-area-instruction\" aria-label=\"elf 세션 및 area instruction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ELF 세션 및 AREA Instruction</h3>\n<ul>\n<li>\n<p>ELF 섹션은 코드, 데이터의 독립적이고 명명된 분할 불가능한 시퀸스이다.</p>\n</li>\n<li>\n<p>단일 코드 섹션은 애플리케이션을 생성하는데 필요하다.</p>\n</li>\n<li>\n<p>어셈블리 또는 컴파일의 출력에 다음이 포함될 수 있다.</p>\n<ul>\n<li>하나 이상의 코드 섹션, 일반적으로 읽기 전용 섹션</li>\n<li>하나 이상의 데이터 섹션, 일반적으로 읽기-쓰기 섹션, 0으로 초기화 될 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>링커는 섹션 배치 규칙에 따라 프로그램 이미지에 각 섹션을 배치한다.</p>\n</li>\n<li>\n<p>소스 파일에서 인접한 섹션이 응용 프로그램 이미지에서 반드시 인접한 것은 아니다.</p>\n</li>\n<li>\n<p>ARM 어셈블리 언어 소스 파일에서 섹션의 시작은 <code class=\"language-text\">AREA</code> 지시문으로 표시된다.</p>\n</li>\n<li>\n<p>해당 지시문은 섹션의 이름을 지정하고 해당 속성을 설정한다.</p>\n</li>\n<li>\n<p>속성은 쉼표로 구분 된 이름 뒤에 배치된다.</p>\n</li>\n</ul>\n<h3 id=\"entry-instruction\" style=\"position:relative;\"><a href=\"#entry-instruction\" aria-label=\"entry instruction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Entry Instruction</h3>\n<ul>\n<li>실행할 첫 번째 명령을 표시</li>\n<li>C 코드를 포함하는 응용 프로그램에서 진입 점은 C 라이브러리 초기화 코드에도 포함된다.</li>\n<li>초기화 코드 및 예외 처리기에도 진입 점이 포함된다.</li>\n</ul>\n<h3 id=\"application-start\" style=\"position:relative;\"><a href=\"#application-start\" aria-label=\"application start permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Application Start</h3>\n<ul>\n<li><code class=\"language-text\">start</code> label 실행을 시작</li>\n<li>여기서 10 진수 값과 10과, 3을 레지스터 r0, r1레 로드한다.</li>\n<li>이러한 레지스터는 함께 추가되고 결과는 r0에 배치된다.</li>\n</ul>\n<h3 id=\"application-terminate\" style=\"position:relative;\"><a href=\"#application-terminate\" aria-label=\"application terminate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Application Terminate</h3>\n<ul>\n<li>기본 코드를 실행 한 후 응용 프로그램은 디버거에 제어를 반환하여 종료된다.</li>\n<li>해당 작업은 다음 매개 변수와 함께 ARM 세미 호스트 SWI()를 사용하여 수행된다.</li>\n</ul>\n<h3 id=\"end-instruction\" style=\"position:relative;\"><a href=\"#end-instruction\" aria-label=\"end instruction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>END Instruction</h3>\n<ul>\n<li>해당 지시문은 이 소스 파일 처리 중지하도록 어셈블러에 지시하며 모든 어셈 블리 언어 소스 모듈은 END 한줄에 지시문으로 끝나야 한다.</li>\n</ul>\n<h2 id=\"calling-subroutines\" style=\"position:relative;\"><a href=\"#calling-subroutines\" aria-label=\"calling subroutines permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calling subroutines</h2>\n<ul>\n<li>서브 루틴을 호출하려면 분기 및 링크 명령어를 사용한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">BL destination</code></pre></div>\n<ul>\n<li><code class=\"language-text\">destination</code> 일반적으로 서브 루틴의 첫 번째 명령어에 있는 레이블은 어디에 있나?</li>\n<li><code class=\"language-text\">destination</code> 프로그램 기준 또는 레지스터 기준 식일 수도 있다.</li>\n</ul>\n<h2 id=\"branch-instruction\" style=\"position:relative;\"><a href=\"#branch-instruction\" aria-label=\"branch instruction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Branch Instruction</h2>\n<h3 id=\"b-branch--jump\" style=\"position:relative;\"><a href=\"#b-branch--jump\" aria-label=\"b branch  jump permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>B (Branch == Jump)</h3>\n<h3 id=\"bl-instruction\" style=\"position:relative;\"><a href=\"#bl-instruction\" aria-label=\"bl instruction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BL Instruction</h3>\n<ul>\n<li>링크 레지스터 r14 (lr) 에 반환 주소를 배치한다.</li>\n<li>PC를 서브 루틴의 주소로 설정한다.</li>\n</ul>\n<h3 id=\"bx-branch-and-exchange\" style=\"position:relative;\"><a href=\"#bx-branch-and-exchange\" aria-label=\"bx branch and exchange permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BX (Branch and Exchange)</h3>\n<h3 id=\"blx-branch-with-link-and-exchange\" style=\"position:relative;\"><a href=\"#blx-branch-with-link-and-exchange\" aria-label=\"blx branch with link and exchange permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BLX (Branch with Link and Exchange)</h3>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">Branch <span class=\"token operator\">:</span> B<span class=\"token punctuation\">{</span><span class=\"token operator\">&lt;</span>cond<span class=\"token operator\">></span><span class=\"token punctuation\">}</span> label\nBranch with Link <span class=\"token operator\">:</span> BL<span class=\"token punctuation\">{</span><span class=\"token operator\">&lt;</span>Cond<span class=\"token operator\">></span><span class=\"token punctuation\">}</span> sub routine label</code></pre></div>\n<ul>\n<li>서브 루틴 코드가 실행된 후 명령을 사용하여 반환 할 수 있다.</li>\n<li>규칙에 따라 레지스터 r0 ~ r3 매개 변수를 서브 루틴에 전달하고 결과를 호출자에게 다시 전달하는 데 사용한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">MOV pc<span class=\"token punctuation\">,</span> lr</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">AREA    subRoutTest<span class=\"token punctuation\">,</span> CODE<span class=\"token punctuation\">,</span> READONLY\n                   \n        ENTRY                     \nstart   MOV     r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">10</span>           \n        MOV     r1<span class=\"token punctuation\">,</span> #<span class=\"token number\">3</span>\n        BL      apple             <span class=\"token punctuation\">;</span> Call subroutine\nstop    MOV     r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x18</span>         <span class=\"token punctuation\">;</span> angel_SWIreason_ReportException\n        LDR     r1<span class=\"token punctuation\">,</span> <span class=\"token operator\">=</span><span class=\"token number\">0x20026</span>      <span class=\"token punctuation\">;</span> ADP_Stopped_ApplicationExit\n        SWI     <span class=\"token number\">0x123456</span>          <span class=\"token punctuation\">;</span> ARM semihosting SWI\napple   ADD     r0<span class=\"token punctuation\">,</span> r0<span class=\"token punctuation\">,</span> r1        <span class=\"token punctuation\">;</span> Subroutine code\n        MOV     pc<span class=\"token punctuation\">,</span> lr            <span class=\"token punctuation\">;</span> Return from subroutine\n        END                       <span class=\"token punctuation\">;</span> Mark end of file</code></pre></div>\n<h2 id=\"thumb-and-arm-assembly\" style=\"position:relative;\"><a href=\"#thumb-and-arm-assembly\" aria-label=\"thumb and arm assembly permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Thumb and ARM assembly</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">AREA ThumbArm<span class=\"token punctuation\">,</span> CODE<span class=\"token punctuation\">,</span> READONLY           \n        ENTRY                           \n        CODE32                          <span class=\"token punctuation\">;</span> 후속 명령어는 ARM이다<span class=\"token punctuation\">.</span>\nheader  ADR     r0<span class=\"token punctuation\">,</span> start <span class=\"token operator\">+</span> <span class=\"token number\">1</span>           <span class=\"token punctuation\">;</span> 프로세서는 ARM 상태에서 시작된다<span class=\"token punctuation\">.</span>\n        BX      r0                      <span class=\"token punctuation\">;</span> 너무 작은 ARM 코드 헤더가 사용되었다<span class=\"token punctuation\">.</span>\n                                        <span class=\"token punctuation\">;</span> Thumb 메인 프로그램 호출\n        CODE16                          <span class=\"token punctuation\">;</span> 후속 명령어는 Thumb이다<span class=\"token punctuation\">.</span>\nstart\n        MOV     r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">10</span>                 \n        MOV     r1<span class=\"token punctuation\">,</span> #<span class=\"token number\">3</span>\n        BL      apple                   \nstop\n        MOV     r0<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x18</span>               <span class=\"token punctuation\">;</span> angel_SWIreason_ReportException\n        LDR     r1<span class=\"token punctuation\">,</span> <span class=\"token operator\">=</span><span class=\"token number\">0x20026</span>            <span class=\"token punctuation\">;</span> ADP_Stopped_ApplicationExit\n        SWI     <span class=\"token number\">0xAB</span>                    <span class=\"token punctuation\">;</span> Thumb semihosting SWI\napple\n        ADD     r0<span class=\"token punctuation\">,</span> r0<span class=\"token punctuation\">,</span> r1              <span class=\"token punctuation\">;</span> Subroutine code\n        MOV     pc<span class=\"token punctuation\">,</span> lr                  <span class=\"token punctuation\">;</span> Return from subroutine\n        END                             <span class=\"token punctuation\">;</span> Mark end of file</code></pre></div>\n<h3 id=\"code32-and-code16-instruction\" style=\"position:relative;\"><a href=\"#code32-and-code16-instruction\" aria-label=\"code32 and code16 instruction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CODE32 and CODE16 Instruction</h3>\n<ul>\n<li>ARM(CODE32), Thumb(CODE16) 명령어로 어셈블하도록 지시한다.</li>\n<li>런타임에 프로세서 상태를 변경하는 명령어로 어셈블되지 않는다.</li>\n<li>어셈블러 상태만 변경한다.</li>\n</ul>\n<h3 id=\"bx-instruction\" style=\"position:relative;\"><a href=\"#bx-instruction\" aria-label=\"bx instruction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BX Instruction</h3>\n<ul>\n<li>런타임 프로세서 상태를 변경할 수 있는 분기</li>\n<li>대상 주소의 최하위 비트는 ARM, Thumb 명령어인지를 구분한다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<ul>\n<li><a href=\"#case-rule\">CASE Rule</a></li>\n<li><a href=\"#line-length\">Line Length</a></li>\n<li><a href=\"#label\">Label</a></li>\n<li><a href=\"#local-label\">Local Label</a></li>\n<li><a href=\"#comment\">Comment</a></li>\n<li><a href=\"#arm-instruction-format\">ARM Instruction Format</a></li>\n<li><a href=\"#elf-%EC%84%B8%EC%85%98-%EB%B0%8F-area-instruction\">ELF 세션 및 AREA Instruction</a></li>\n<li><a href=\"#entry-instruction\">Entry Instruction</a></li>\n<li><a href=\"#application-start\">Application Start</a></li>\n<li><a href=\"#application-terminate\">Application Terminate</a></li>\n<li><a href=\"#end-instruction\">END Instruction</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#calling-subroutines\">Calling subroutines</a></p>\n</li>\n<li>\n<p><a href=\"#branch-instruction\">Branch Instruction</a></p>\n<ul>\n<li><a href=\"#b-branch--jump\">B (Branch == Jump)</a></li>\n<li><a href=\"#bl-instruction\">BL Instruction</a></li>\n<li><a href=\"#bx-branch-and-exchange\">BX (Branch and Exchange)</a></li>\n<li><a href=\"#blx-branch-with-link-and-exchange\">BLX (Branch with Link and Exchange)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#thumb-and-arm-assembly\">Thumb and ARM assembly</a></p>\n<ul>\n<li><a href=\"#code32-and-code16-instruction\">CODE32 and CODE16 Instruction</a></li>\n<li><a href=\"#bx-instruction\">BX Instruction</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"February 09, 2021","title":"ARM Assembly 1","categories":"ARM","author":"Zer0Luck","emoji":"☕"},"fields":{"slug":"/arm-1/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/arm-2/","nextSlug":"/window_5_theori/","prevSlug":"/arm-1/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}