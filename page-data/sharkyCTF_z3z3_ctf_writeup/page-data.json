{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/sharkyCTF_z3z3_ctf_writeup/",
    "result": {"data":{"cur":{"id":"47894521-b3ce-54dd-8304-862db8bb314f","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-정보\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\" aria-label=\"바이너리 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 정보</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQUlEQVQoz12RWW7DMAxEc5HGEheR2hfbSZpu6P0vVShO+1FgPoSB3gwJnizQ59c3IL+czXmxhxYDxuKhxcBi4L//ME+AvO1XYhWNTsOUeEBeDFigxaIFMhZFg/qI5MzDPEJP7LS2kUqvY891pDpy7a2voiHVXvsGrMD69v5R24i51b6l0jXmCRPLWLeQKjlvSSwJsl5v9z62mJuEjM4D6+v9vfXhU/Gpik+s8Qm3vvpYnE/Iis6T8+u6E8tMlPCA5Xp7zaWFVFmjJQHWCSO5ELOG7FNF59F5p3G/3ADoDz5mIRYNmSTA7NDnzn3Msdt6aWP3qbKEUvt5sTG332a93t7W7ZJKj6UfC07YArFTA/yUJeQZZyxMWCM+vo51j6n4WPbLvfTNpzLhf1c1FgHdjJsPPg6DLLUNYrFAxMJOiWfzDxnwVGvCLA22AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/1694aa8e4d89aeb6cb53369da4819550/37523/0.png\"\n        srcset=\"/static/1694aa8e4d89aeb6cb53369da4819550/e9ff0/0.png 180w,\n/static/1694aa8e4d89aeb6cb53369da4819550/f21e7/0.png 360w,\n/static/1694aa8e4d89aeb6cb53369da4819550/37523/0.png 720w,\n/static/1694aa8e4d89aeb6cb53369da4819550/3f3b9/0.png 870w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"바이너리-실행\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%8B%A4%ED%96%89\" aria-label=\"바이너리 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 실행</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiklEQVQY06WNSQ7EIAwEuRGzBMRiDJrA/385GpygaG5R6mB12yoQKSUiklKq5wgiGmPEGJVSWmversCZ65rrKj7H0XuvtUoptwkAcIbJdrEqAJxya63W6r1HRCIqpYQQWmuImCelFK68IaKcM/vCWqu0NsbsF9Za59x+46/+FP6Z34CHnLJ6wSv5CykUFxiv3zssAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/5310d4599e7e9d5b75869e0db6766474/37523/1.png\"\n        srcset=\"/static/5310d4599e7e9d5b75869e0db6766474/e9ff0/1.png 180w,\n/static/5310d4599e7e9d5b75869e0db6766474/f21e7/1.png 360w,\n/static/5310d4599e7e9d5b75869e0db6766474/37523/1.png 720w,\n/static/5310d4599e7e9d5b75869e0db6766474/65c7b/1.png 795w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>입력 값을 받을 수 있도록 하며 임의의 문자열을 입력할 시 <code class=\"language-text\">3Z Z3 z3 zz3 3zz33</code> 해당 문자열을 출력하는 것을 알 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAh0lEQVQY05XNwQ6EIAxFUZe1YoGoYSiUAon//4uTMAvdmIxn9TY3bwKA4zhCCACAL02IGGMUEefc63jbNhFR1ZQSAMzDv7H3/jMQkTGGiNZ1RcT52RXnnHvvrbXe+3meIlJK2ffdWuuG+yAiZ61ZlitW1VqrqsYbHkSEmdPAzCGEnLMj+v1/AW+aFen46bDCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/5cb44bbf076a5c44ff76e761edcc233d/37523/2.png\"\n        srcset=\"/static/5cb44bbf076a5c44ff76e761edcc233d/e9ff0/2.png 180w,\n/static/5cb44bbf076a5c44ff76e761edcc233d/f21e7/2.png 360w,\n/static/5cb44bbf076a5c44ff76e761edcc233d/37523/2.png 720w,\n/static/5cb44bbf076a5c44ff76e761edcc233d/a242d/2.png 724w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqElEQVQI1z3NW26DQBBEUXaSD3DPTFc/geAMjh1iZf9rihIkS0el+rvD/XhW2HV/kMZbvpsHiuYUTDoWngqP/17nZaoYbo+jsPW+aOiyG5lLiStvKkmwBhdJkWzsDAeisUNCJKliuH99V9Z++2wW47JGzJuIsiXlTOnFSxOqcqm4VFCTc6nKVHg4nj8N/tFncZ27xapRY8fWeVt4FQ5GAH/xM9vYGHH6BR+3KnSH4ZclAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/40a77b183fa26e3d071db0735505182b/37523/3.png\"\n        srcset=\"/static/40a77b183fa26e3d071db0735505182b/e9ff0/3.png 180w,\n/static/40a77b183fa26e3d071db0735505182b/f21e7/3.png 360w,\n/static/40a77b183fa26e3d071db0735505182b/37523/3.png 720w,\n/static/40a77b183fa26e3d071db0735505182b/d44c9/3.png 722w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">fgets</code> 함수 호출 인자 <code class=\"language-text\">char *s</code>, <code class=\"language-text\">0x19</code>, <code class=\"language-text\">s1</code></li>\n<li><code class=\"language-text\">strcspn</code> 함수 호출 인자 <code class=\"language-text\">const char *s1</code>, <code class=\"language-text\">const char *s2</code>, <code class=\"language-text\">s1</code>\n<ul>\n<li>str1에 있는 문자열에서 str2 문자가 있을 경우 그 문자 까지의 개수를 리턴한다.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAm0lEQVQI1yXOWQrDMBAD0FyjTRvbM9asdlLo/e9WnMID6UegDZawlNvqnggXR2moFSCrLC/Cm2/Ua9d7ErDcZIWTLKwJza7JS9DiiMBIikExOCeP2X1hG5vnSeN8wJ9sO+LV4yBrzUvVZ5O9iln68Oqz5IfjMr1Mrm5nldzEXacW2MFWJRqCOEABztL0aMI22T7drj/277qt6/YPDz8j/8XBHtMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/3c7e35f6408a2a310661a3a71766e57f/37523/4.png\"\n        srcset=\"/static/3c7e35f6408a2a310661a3a71766e57f/e9ff0/4.png 180w,\n/static/3c7e35f6408a2a310661a3a71766e57f/f21e7/4.png 360w,\n/static/3c7e35f6408a2a310661a3a71766e57f/37523/4.png 720w,\n/static/3c7e35f6408a2a310661a3a71766e57f/302a4/4.png 1080w,\n/static/3c7e35f6408a2a310661a3a71766e57f/07a9c/4.png 1440w,\n/static/3c7e35f6408a2a310661a3a71766e57f/75b1f/4.png 1699w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>flag 값을 얻기 위해서는 <code class=\"language-text\">check_flag</code> 함수를 거쳐서 반환 값이 1이어야 한다.</p>\n</li>\n<li>\n<p>반환 값을 얻기 까지의 조건들이 너무 더럽다…</p>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 278px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 251.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAyCAIAAADTHmxxAAAACXBIWXMAAAsTAAALEwEAmpwYAAACX0lEQVRIx53W3U8TQRAA8LtrKVBpixShhetd73ZvdvZmry0tQaACfkAixqiJMSaaGKPxhcQQo4nhQWOMIWgQhBf/XXP1FYyzyT7uLzO7OzNZJ0G6aBmRYbQM0QAkpYm6cA85F2NFMSnRw/Z1GQ0AwDAwKCP7KlqF1lbcXgFITKL/PzKSMCi6OhjKcE2CZGFFESKkFK7JYChAZjwsOxj30b/dDm5wMZqko2VXL+6EwQY/cqRVQrS4HQYbMTcySYMyS5v3WsFmrAQTC4UA2cLdoMXGimKjZEfPP1rkYzRJV4seXnvSaG0xMaCBvo77WH8+x8aJMrKnRE/PvJxt3YzYZxYdJbN0+nXdvxXx0x7oeFlV96b5kZFEljdG5W3NJu1Y52lX9qtsDGjUko5WoPxhyuqpujmePCizi+TvO4dDOf55Itjg17Y0qr2WlL6W+C2JBrI0HMri4Rh7GOQX1tX+nah4VOSPITRCK3+nXfhRsMAEKS3sBt6xF7KxJkXUfOB7P71wXfKxMo2Hvnvq2mGaf7zg/nJHQ5+JQaZzT5vOmcPGUlMi09lnDefcsYhsdJbNvJq1w6SQpt/UbXGa1vauumdWaaOhyn7NPbO4bSQJaeVd1RIL0FfeV63eeVTb5Y9TNng0hnDi06RVeaJJKB3/MmGD89/QEpa+jXsnFhiMGMDYYck74bakHuFVKB6N8ftZk0qyaFMUjov5JGFjmQVbbe/EKxwXbM5cfzHnnDuF74VwXbBve/Kg7Px23FPXZnq2tuPGfb+5G4iOZn6ZkUAYFWcqzi6T/8J5njrNF16K/wBKpNvlNWs8RQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/74107c7c36ec434f97f8e7f5cee993a7/4e29d/5.png\"\n        srcset=\"/static/74107c7c36ec434f97f8e7f5cee993a7/e9ff0/5.png 180w,\n/static/74107c7c36ec434f97f8e7f5cee993a7/4e29d/5.png 278w\"\n        sizes=\"(max-width: 278px) 100vw, 278px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">_BOOL8 __fastcall <span class=\"token function\">check_flag</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>a1<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x2B</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">380</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">5</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x53</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">122</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">392</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">190</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x47</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">*</span>a1 <span class=\"token operator\">==</span> <span class=\"token number\">99</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x45</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">68</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x15</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">16</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">4</span> <span class=\"token operator\">==</span> <span class=\"token number\">7</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">*</span>a1 <span class=\"token operator\">>></span> <span class=\"token operator\">*</span>a1 <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">12</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xAC</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">40</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">115</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x1D</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">24</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">51</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">49</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">456</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">6</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token number\">47</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">108</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">4</span> <span class=\"token operator\">==</span> <span class=\"token number\">7</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x49</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">64</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">115</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">20</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">*</span>a1 <span class=\"token operator\">==</span> <span class=\"token number\">99</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">164</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span> <span class=\"token operator\">==</span> <span class=\"token number\">6080</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x2B</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x2C</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token number\">47</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">114</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">168</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">58</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">9</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">396</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">210</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xED</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">40</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xAC</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">12</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x6B</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">114</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>a1 <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x39</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">33</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x3C</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">114</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">52</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">41</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">50</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">167</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">68</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x2D</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">380</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x40</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">26</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">380</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x4E</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">99</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">4</span> <span class=\"token operator\">==</span> <span class=\"token number\">3</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">24</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">15616</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">24</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">9</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span> <span class=\"token operator\">==</span> <span class=\"token number\">380</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">58</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">115</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x1D</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">89</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">48</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x9F</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">31</span>\n      <span class=\"token operator\">&amp;&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">115</span>\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x4A</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">*</span>a1\n      <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x3C</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>해당 조건을 디컴파일 한 결과 조건을 만족할 시 반환 되는 값은 1이다. 문제 제목 처럼 Z3를 통해 풀어보도록 하겠다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> z3 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\ns <span class=\"token operator\">=</span> Solver<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\na1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 사용자의 입력으로 들어갈 인풋을 BitVec 타입으로 정의한다.</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    a1<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>BitVec<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x2B</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">380</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>                \ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x53</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">122</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">392</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">190</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">43</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x47</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">99</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x45</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">68</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x15</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">4</span> <span class=\"token operator\">==</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xAC</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">115</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x1D</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">51</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">49</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">456</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">6</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token number\">47</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">108</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">4</span> <span class=\"token operator\">==</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x49</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">115</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">99</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">164</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span> <span class=\"token operator\">==</span> <span class=\"token number\">6080</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x2B</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x2C</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">19</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token number\">47</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">114</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">168</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">58</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">396</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">210</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xED</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xAC</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x6B</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x7A</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">114</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x39</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">33</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x3C</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">114</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">52</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">41</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">167</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">68</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">95</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x2D</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">4</span> <span class=\"token operator\">*</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">380</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x40</span> <span class=\"token operator\">>=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">380</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x4E</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">99</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">19</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">4</span> <span class=\"token operator\">==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">15616</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">116</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">380</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">22</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">58</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">115</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x1D</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">89</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0x9F</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">115</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x4A</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x3C</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 앞의 조건을 만족한다면 Solver 클래스의 만족 결과가 충족하는지 검사한다.</span>\n<span class=\"token keyword\">assert</span> s<span class=\"token punctuation\">.</span>check<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> sat\n\nmodel <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nflag <span class=\"token operator\">=</span><span class=\"token string\">''</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    flag <span class=\"token operator\">+=</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>model<span class=\"token punctuation\">[</span>a1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>as_long<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span> flag</code></pre></div>\n<ul>\n<li>SAT (Boolean SATisfiability problem)\n<ul>\n<li>주어진 Boolean 식을 충족시키는 해 (True로 표현되는 해)가 존재하는지 결정하는 문제</li>\n<li>SAT는 명제논리식이기 때문에 각 변수에 True/False만 할당한다.</li>\n</ul>\n</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%A0%95%EB%B3%B4\">바이너리 정보</a></li>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%8B%A4%ED%96%89\">바이너리 실행</a></li>\n</ul>\n</div>","excerpt":"취약점 분석 바이너리 정보  바이너리 실행  입력 값을 받을 수 있도록 하며 임의의 문자열을 입력할 시  해당 문자열을 출력하는 것을 알 수 있다.    함수 호출 인자 , ,   함수 호출 인자 , ,  str1에 있는 문자열에서 str2 문자가 있을 경우 그 문자 까지의 개수를 리턴한다.  flag 값을 얻기 위해서는  함수를 거쳐서 반환 값이 1이어야 한다. 반환 값을 얻기 까지의 조건들이 너무 더럽다…  해당 조건을 디컴파일 한 결과 조건을 만족할 시 반환 되는 값은 1이다. 문제 제목 처럼 Z3를 통해 풀어보도록 하겠다. 해결 방안 SAT (Boolean SATisfiability problem) 주어진 Boolean 식을 충족시키는 해 (True로 표현되는 해)가 존재하는지 결정하는 문제 SAT는 명제논리식이기 때문에 각 변수에 True/False만 할당한다. 바이너리 정보 바이너리 실행","frontmatter":{"date":"August 14, 2020","title":"Sharky CTF Z3 Robot","categories":"CTF","author":"Zer0Luck","emoji":"🦈"},"fields":{"slug":"/sharkyCTF_z3z3_ctf_writeup/"}},"next":{"id":"98171d5a-b5e2-5938-8788-4669e33da2a9","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"안드로이드-앱의-시작점\" style=\"position:relative;\"><a href=\"#%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C-%EC%95%B1%EC%9D%98-%EC%8B%9C%EC%9E%91%EC%A0%90\" aria-label=\"안드로이드 앱의 시작점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>안드로이드 앱의 시작점</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2ElEQVQY003JW27DIBCFYS+oxmDLMQweriZchuB2/5upUvUhn/6HI52pdxq9fY+bqLaWG2Wq+Yo+BOu9jdGF4GJwIbqUrr+iNUZKCQATjR4ClHwR5VqudFlvT2tORNBwICo8NSIgKoPaGFBy39Z128S+r1OpLyV3JQ+tQQPI41i5YIyx5d/HfOOcL8syz2ye2US9poT3aGPQPTpRytn8vKj32uozRuMtXDG0VmrNrWWi4kDPXzNjbHqWqvXDWvTeOm+tO0+UGqQCJR8PwbkQXAghVvGJvw/+CwatR1CXT52PAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/6a0e53b0e3706eed1f7418dfe6d369d1/37523/1.png\"\n        srcset=\"/static/6a0e53b0e3706eed1f7418dfe6d369d1/e9ff0/1.png 180w,\n/static/6a0e53b0e3706eed1f7418dfe6d369d1/f21e7/1.png 360w,\n/static/6a0e53b0e3706eed1f7418dfe6d369d1/37523/1.png 720w,\n/static/6a0e53b0e3706eed1f7418dfe6d369d1/302a4/1.png 1080w,\n/static/6a0e53b0e3706eed1f7418dfe6d369d1/4fa52/1.png 1241w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>activity</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>theme</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@style/AppTheme.NoActionBar<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@string/app_name<span class=\"token punctuation\">\"</span></span>\n\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.example.puing.a2018codegate.MainActivity<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>intent-filter</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>action</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.action.MAIN<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>categories</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.categories.LAUNCHER<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>intent-filter</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>activity</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"mainactivty1\" style=\"position:relative;\"><a href=\"#mainactivty1\" aria-label=\"mainactivty1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MainActivty1</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 678px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAbUlEQVQI122NQQ6DMAwE+RAtVInXJhYFYisIX/r/11S5Zw67c1ntVMtu7gBEZCsdZhYRAMwMEPOS8+c1YjqhvzvMvVY7vod3qa01dzez67zMdtVtnkfjUsoTEU+o6vpeiIhyJiIAPXtzSmn4/AdGLicFQF4LCQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/445566d9867c223e049647148190ab5e/38cea/2.png\"\n        srcset=\"/static/445566d9867c223e049647148190ab5e/e9ff0/2.png 180w,\n/static/445566d9867c223e049647148190ab5e/f21e7/2.png 360w,\n/static/445566d9867c223e049647148190ab5e/38cea/2.png 678w\"\n        sizes=\"(max-width: 678px) 100vw, 678px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>k() 의 반환값이 False 이면 앱 종료</li>\n</ul>\n<h2 id=\"k-함수-분석\" style=\"position:relative;\"><a href=\"#k-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"k 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>K 함수 분석</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">k</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>FINGERPRINT<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"generic\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>FINGERPRINT<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unknown\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>FINGERPRINT<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sdk_google\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>MODEL<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"google_sdk\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>MODEL<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Emulator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>MODEL<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Android SDK built for x86\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>MANUFACTURER<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Genymotion\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token punctuation\">(</span><span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>BRAND<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"generic\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>DEVICE<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"generic\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> \\\n\t\t\t\t\t\t\t\t<span class=\"token string\">\"google_sdk\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Build</span><span class=\"token punctuation\">.</span>PRODUCT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>빌드 네임이 아래 중 하나 조건에 맞으면 통과</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.555555555555557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAVElEQVQI103LQQrAIAxEUU9SQcUhMWnShbjw/vcqTSn0LT7MYpK7m5mq2vkQEQtXANBaq7W+LaXknI9P2nuvteacKqKqYwwOEpOIeu8AmJmIAPzPN779EzLoFrpCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/d49a00ce46d6f1208b27d8213950a01e/37523/3.png\"\n        srcset=\"/static/d49a00ce46d6f1208b27d8213950a01e/e9ff0/3.png 180w,\n/static/d49a00ce46d6f1208b27d8213950a01e/f21e7/3.png 360w,\n/static/d49a00ce46d6f1208b27d8213950a01e/37523/3.png 720w,\n/static/d49a00ce46d6f1208b27d8213950a01e/b04e4/3.png 888w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- `\"google_sdk\".equals(Build.PRODUCT)` ← `google/sdk_gphone_x86`</code></pre></div>\n<h2 id=\"mainactivity2-intent-요청-조건-분석\" style=\"position:relative;\"><a href=\"#mainactivity2-intent-%EC%9A%94%EC%B2%AD-%EC%A1%B0%EA%B1%B4-%EB%B6%84%EC%84%9D\" aria-label=\"mainactivity2 intent 요청 조건 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MainActivity2 intent 요청 조건 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.777777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAbUlEQVQI13XLSw6CUAwFUBZEe1tqTDTvQ/xEBZ5FA+x/KQyIMznzU83fyUvpjpfl2Y3D+3UfYgwhxBRTyjmdzgEGAf9TFfdpmf32GPurf3p3b9tsZodN0xiEsZNVFYAQCxQQVVURopp+aibesQLFACY7iSxjfwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/e31723aa3969605e2970efd9020b1e9c/37523/4.png\"\n        srcset=\"/static/e31723aa3969605e2970efd9020b1e9c/e9ff0/4.png 180w,\n/static/e31723aa3969605e2970efd9020b1e9c/f21e7/4.png 360w,\n/static/e31723aa3969605e2970efd9020b1e9c/37523/4.png 720w,\n/static/e31723aa3969605e2970efd9020b1e9c/d26aa/4.png 839w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Button을 누르면 길이가 (10 ≥ &#x26;&#x26; ≤ 26) 일 경우 Main2Activity 를 호출</li>\n</ul>\n<h2 id=\"mainactivity2\" style=\"position:relative;\"><a href=\"#mainactivity2\" aria-label=\"mainactivity2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MainActivity2</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABC0lEQVQY023PW26DMBAFULYTHq0BA54ZEwPlZReTOCT9iKrsfxlVghS1DUf392rueGPd28XNtpum9ujGz2lo6ibLsyxnScKiX95eeFNrjJnOl+Uw28PBdl3b94MxWuu6FoBESqlKVQDw2ve6ql+sW5w7L5eTtmYYJ2u11ogyZnHKYsbY+8PG5eaj/b7dvtzpMuvr9eqOx74flFJlWUopJeMxYxuL1/K+Qne2Q9N1exzMqJTiPN35O9/3A98PgiC8i9b8L8uykHtRFEIgFgnHQlApiQgf4E4IkQpMAPnzhZVHJAERCakkKgQCkCSUhIRrAEFgBsiB8pSnSZo840VRFD5FYRCGwUP4x/bsH280aG+KX26tAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/dc348d7ae7e8007eab29f0b22657c7be/37523/5.png\"\n        srcset=\"/static/dc348d7ae7e8007eab29f0b22657c7be/e9ff0/5.png 180w,\n/static/dc348d7ae7e8007eab29f0b22657c7be/f21e7/5.png 360w,\n/static/dc348d7ae7e8007eab29f0b22657c7be/37523/5.png 720w,\n/static/dc348d7ae7e8007eab29f0b22657c7be/4e6ec/5.png 827w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> stringExtra <span class=\"token operator\">=</span> <span class=\"token function\">getIntent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getStringExtra</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"edittext\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>MainActivty에서 입력 받은 edittext 를 stringExtra 변수에 저장</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">String</span> obj <span class=\"token operator\">=</span> <span class=\"token class-name\">Main2Activity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">.</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Main2Activity</span><span class=\"token punctuation\">.</span><span class=\"token function\">a</span><span class=\"token punctuation\">(</span>stringExtra<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></code></pre></div>\n<ul>\n<li>obj에 Main2Activity에서 입력하는 값을 저장하고 <code class=\"language-text\">a</code> 함수를 stringExtra로 실행한 값과 일치하는지 비교한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">intent<span class=\"token punctuation\">.</span><span class=\"token function\">putExtra</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> stringExtra<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nintent<span class=\"token punctuation\">.</span><span class=\"token function\">putExtra</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pass\"</span><span class=\"token punctuation\">,</span> obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Main2Activity</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">startActivity</span><span class=\"token punctuation\">(</span>intent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>MainActivty에서 입력한 값이 id, Main2Acticity에서 입력한 값이 password인 것을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"mainactivity2-a-함수-분석\" style=\"position:relative;\"><a href=\"#mainactivity2-a-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"mainactivity2 a 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MainActivity2 a 함수 분석</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> str<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">char</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> cArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token char\">'c'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'o'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'d'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'e'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'g'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'t'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'e'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'2'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token char\">'0'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'8'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'h'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'u'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'r'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'r'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'y'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token char\">'!'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'H'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'L'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'O'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'L'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> length <span class=\"token operator\">=</span> str<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">String</span> str2 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">int</span> charAt <span class=\"token operator\">=</span> str<span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>cArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span>lengt\n        h <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> i2 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>i2 <span class=\"token operator\">&lt;</span> cArr<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">int</span> nextInt <span class=\"token operator\">=</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>charAt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Character</span><span class=\"token punctuation\">.</span>valu\n            <span class=\"token function\">eOf</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>cArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span>i2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> charA\n            t<span class=\"token punctuation\">;</span>\n            i2<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n            charAt <span class=\"token operator\">=</span> nextInt<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i3 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i3 <span class=\"token operator\">&lt;</span> charAt<span class=\"token punctuation\">;</span> i3 <span class=\"token operator\">=</span> i3 <span class=\"token operator\">+</span> i3 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n        i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n        str2 <span class=\"token operator\">=</span> str2 <span class=\"token operator\">+</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>i3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token class-name\">String</span> str3 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i4 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i4 <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> i4<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        str3 <span class=\"token operator\">=</span> str3 <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span>i4<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> i4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> str3<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>입력 받은 str(id) 를 갖고 xor 연산을 하면서 <code class=\"language-text\">무언가</code> 연산하는 함수</li>\n</ul>\n<h2 id=\"mainactivity3-분석\" style=\"position:relative;\"><a href=\"#mainactivity3-%EB%B6%84%EC%84%9D\" aria-label=\"mainactivity3 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MainActivity3 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVQY002NS3KDMBAFfaBgoxEjITT6QUyEBDbCLKjK/e+Rshexu3r3quudItK6bWVb1i0+9pxzGvph6IcGG+AAlwtjDAD4i7quzx+csun3EPe17Hsp5ZbSZL113vc+BOcctlZTCN77QIaAQ1VV7xjP7HiU4/e4u3EO16WU+zjdUso/cfLfeZljjPM8X8dR1ygY//qMgfM+tkpLiUKpVvDmKWKrlJBSvJBSSImyAYEAnL1jgUJ3pLV23rngiQvqyFprjCEiQ89Ja62UUB2Q4a3i/99/0TpFml1QD5QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/d809c6f1519d2527448c2006b713cb8e/37523/6.png\"\n        srcset=\"/static/d809c6f1519d2527448c2006b713cb8e/e9ff0/6.png 180w,\n/static/d809c6f1519d2527448c2006b713cb8e/f21e7/6.png 360w,\n/static/d809c6f1519d2527448c2006b713cb8e/37523/6.png 720w,\n/static/d809c6f1519d2527448c2006b713cb8e/7e509/6.png 745w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">k</code> 함수 반환 값과 Main3Activity 에서 입력하는 값을 비교 후 참을 반환하면 Main4Activity 호출</li>\n</ul>\n<h2 id=\"main3activity-k-함수-분석\" style=\"position:relative;\"><a href=\"#main3activity-k-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main3activity k 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Main3Activity K 함수 분석</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">k</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">char</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> cArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'c'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'d'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'e'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'f'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'g'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'h'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'i'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'j'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'k'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'l'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'m'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'n'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'o'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'p'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'q'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'r'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'s'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'t'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'u'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'v'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'w'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'x'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'y'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'z'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'0'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'2'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'3'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'4'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'5'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'6'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'7'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'8'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'9'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">StringBuffer</span> stringBuffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Random</span> random <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            stringBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>cArr<span class=\"token punctuation\">[</span>random<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span>cArr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> stringBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">cArr</code> 배열에서 랜덤한 문자열을 반환한다</li>\n</ul>\n<h2 id=\"main4activity-분석\" style=\"position:relative;\"><a href=\"#main4activity-%EB%B6%84%EC%84%9D\" aria-label=\"main4activity 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Main4Activity 분석</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Main4Activity</span> <span class=\"token keyword\">extends</span> c <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">EditText</span> l<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/* access modifiers changed from: protected */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Bundle</span> bundle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">onCreate</span><span class=\"token punctuation\">(</span>bundle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">setContentView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">R</span><span class=\"token punctuation\">.</span>layout<span class=\"token punctuation\">.</span>activity_main4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Toolbar</span><span class=\"token punctuation\">)</span> <span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">R</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>toolbar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FloatingActionButton</span><span class=\"token punctuation\">)</span> <span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">R</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>fab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setOnClickListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">View<span class=\"token punctuation\">.</span>OnClickListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onClick</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">View</span> view<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">Snackbar</span><span class=\"token punctuation\">.</span><span class=\"token function\">a</span><span class=\"token punctuation\">(</span>view<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Replace with your own action\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">View<span class=\"token punctuation\">.</span>OnClickListener</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadLibrary</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"native-lib\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>l <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">EditText</span><span class=\"token punctuation\">)</span> <span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">R</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>editText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>l<span class=\"token punctuation\">.</span><span class=\"token function\">setText</span><span class=\"token punctuation\">(</span><span class=\"token function\">stringFromJNI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">native</span> <span class=\"token class-name\">String</span> <span class=\"token function\">stringFromJNI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">stringFromJNI</code> 라는 native 함수를 실핸 후 반환 값을 EditText에 지정</li>\n</ul>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<ul>\n<li>각 스테이지 (Main{N}Activity) 별로 체크 로직이 존재하고 통과할 경우 다음 스테이지로 이동</li>\n<li>Main4Activity에서 FLAG를 호출한다. → <code class=\"language-text\">stringFromJNI()</code></li>\n</ul>\n<h1 id=\"문제-풀이-방법\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-%ED%92%80%EC%9D%B4-%EB%B0%A9%EB%B2%95\" aria-label=\"문제 풀이 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제 풀이 방법</h1>\n<ol>\n<li>Activity Start\n<ul>\n<li>바로 Main4Activity 를 호출한다.</li>\n</ul>\n</li>\n<li>Hooking\n<ul>\n<li>로직들을 통과할 수 있게 각 함수마다 후킹</li>\n</ul>\n</li>\n<li>JNI Load\n<ul>\n<li>Native 함수를 강제로 실행</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"activity-start\" style=\"position:relative;\"><a href=\"#activity-start\" aria-label=\"activity start permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Activity Start</h3>\n<ul>\n<li>Intent가 등록되어 있지 않은 액티비티 (→ exported=false)는 일반 유저가 호출할 수 없다.</li>\n</ul>\n<p>!<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFklEQVQY02XQTW6DMBAFYF+iSSUccAL4X8TEBmwPdkSVbaXueoFK3fQEPX1Vs6r66S1mNdJ7KBQAEEKIMU7TZK1dCl/M88w5p5SygnPOGKOUdl2HXDGOo7X2drsZY5RSQggppSiUUsMwaK2VUowxIQQv+r5HIYR1Xb33ALAWABCLZVmUUm3bEkIulwsh5PQXWtf1fr8DQM758Xhs25ZzfilSSvtf55zWuv4HxRj3wgCwbVtKKYRgi7mYpul6vXZtS+r6N02zH01dI+99jDGEkHNOKcUY99pSSkopIeRMyHNVHavqgPFTyRHjA8b4dEIpJb8szrl5nvdtjTH7Koyxvuua8/nbuY9heBXiXes3KT+N+RpHSsgPA+JNCbUneLEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/fab5bc10d9b0adda8479ab46e0223a57/37523/7.png\"\n        srcset=\"/static/fab5bc10d9b0adda8479ab46e0223a57/e9ff0/7.png 180w,\n/static/fab5bc10d9b0adda8479ab46e0223a57/f21e7/7.png 360w,\n/static/fab5bc10d9b0adda8479ab46e0223a57/37523/7.png 720w,\n/static/fab5bc10d9b0adda8479ab46e0223a57/302a4/7.png 1080w,\n/static/fab5bc10d9b0adda8479ab46e0223a57/07a9c/7.png 1440w,\n/static/fab5bc10d9b0adda8479ab46e0223a57/b1ffc/7.png 1492w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Root 권한이 존재하는 ADV Image이기 때문에 임의 액티비티 실행이 가능하다.</li>\n<li>권한 상승후 해당 액티비티를 실행하게 되면 FLAG값을 얻을 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZ0lEQVQoz43QzUoCURTA8XmDEVyk6J17Z6aPaZq7lPRhokW7omwTQQtNqIwoDCGdTT5DiYrl1CbFNAmKighapqHiR5nTOOYNDRdCoP/VWZzf4hxqShAFQTCbzTzPY4xnBpMkPDGOlla8mwd3C8743GJ0flnxy1fnibgkYcpun7XZbBjj6cFEUZS6YQQZ767/6aWZyrylc+/JbOE6+xqLRQEAFEKIYRgAANMP9vqbOY6jaVoOBgkhuq51Om1CSLlcOjkNI4Qo1N/7N5ZlDQZD4ChACGk0vlT1W9P0YrEUjkQghBQcActBmRDSVFWt1dJ1vVqpKooyMpa7uFos18sVTVUL+fxxKDQqDga6N9drtc/6R5t07h8feJbrPmw4punQcaj3MP2HdEiLPKduEYeAdRiGEJpMY6tOp8936PF4trw722sb++tuKExaLZYhGCFkNBpdLnfmJneWUC6USyWZTMeiew4HAuAXuwnNccgCViwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/ff620f8e3c17b5d2c9d433357632aeb7/37523/8.png\"\n        srcset=\"/static/ff620f8e3c17b5d2c9d433357632aeb7/e9ff0/8.png 180w,\n/static/ff620f8e3c17b5d2c9d433357632aeb7/f21e7/8.png 360w,\n/static/ff620f8e3c17b5d2c9d433357632aeb7/37523/8.png 720w,\n/static/ff620f8e3c17b5d2c9d433357632aeb7/302a4/8.png 1080w,\n/static/ff620f8e3c17b5d2c9d433357632aeb7/07a9c/8.png 1440w,\n/static/ff620f8e3c17b5d2c9d433357632aeb7/dd507/8.png 1528w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"hooking\" style=\"position:relative;\"><a href=\"#hooking\" aria-label=\"hooking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hooking</h2>\n<ul>\n<li>Frida를 통한 Hooking을 통해 체크 로직 우회</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcUlEQVQI13XN3QrCMAxA4T1Qk7XYTmxaiSIs/lCXZdD3fxPFa3fuP87AVG3bnvfH6zbrasu7qaqIMDNfL+d4jD4A/m8gKr13U2vCZovMklIKIcRfBx/8OOIeznWSxiUXSlOphYhyPiGicw4cAMLe9os/BLEnN3p/F/kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/c29d27d4567f33ea40feda900ea4f65a/37523/9.png\"\n        srcset=\"/static/c29d27d4567f33ea40feda900ea4f65a/e9ff0/9.png 180w,\n/static/c29d27d4567f33ea40feda900ea4f65a/f21e7/9.png 360w,\n/static/c29d27d4567f33ea40feda900ea4f65a/37523/9.png 720w,\n/static/c29d27d4567f33ea40feda900ea4f65a/20982/9.png 778w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAY0lEQVQI102JzQqDMBAGfaEk3+5KC/WnBUVBYjdmJb34/s9R9OSchpmqq59HsfIr9p42TWam86Kq6zilb4przDnn3Ya2b+QBJtyoIHh9iAhwAQARBedPYb4qmFlqkXMEH/ydP0T5G2QmASZ4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/8133540d784091d104a44646d9469723/37523/10.png\"\n        srcset=\"/static/8133540d784091d104a44646d9469723/e9ff0/10.png 180w,\n/static/8133540d784091d104a44646d9469723/f21e7/10.png 360w,\n/static/8133540d784091d104a44646d9469723/37523/10.png 720w,\n/static/8133540d784091d104a44646d9469723/e5715/10.png 768w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n- String.equals() 를 후킹해서 항상 true를 반환하도록 만들어도 되지만 이미 많은 곳에서 사용하기 때문에 노이즈가 심하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- Main2Activity.a 와 Main3Activity.k를 후킹해 빈 문자열을 반환하도록 해보겠다.</code></pre></div>\n<p><strong>Frida server background</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVQI122NSw6DIAAFvUj9oQgIqSCCWhTFaGxqd132/udoWu3OZPIym8nzhmVrhrmsO8QEQAwgmmAWQeKDLEiyIEFn4F285+ttl4cyo3GrMk73082tXJsIkjDFPoCX+IQjHpbNTPfWzo2dZWOVcXXvVDcq42RrSSGZUFRoKjQpJOUq54oU1RHnvCqqllzLMMURJPvhd38eIwoO2F9onNE9/gCvFSqU6ViVDwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/dac5a98b3f4a6103fadb6e20075f73c5/37523/11.png\"\n        srcset=\"/static/dac5a98b3f4a6103fadb6e20075f73c5/e9ff0/11.png 180w,\n/static/dac5a98b3f4a6103fadb6e20075f73c5/f21e7/11.png 360w,\n/static/dac5a98b3f4a6103fadb6e20075f73c5/37523/11.png 720w,\n/static/dac5a98b3f4a6103fadb6e20075f73c5/7608e/11.png 735w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> frida<span class=\"token punctuation\">,</span> sys\n\n<span class=\"token comment\"># print(frida.get_usb_device())</span>\n\njscode <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">\"\"\"\nJava.perform(function () {\n\t\t// main2, main3 &lt;- 해당 액티비티 패키지 선언\n    var main2 = Java.use('com.example.puing.a2018codegate.Main2Activity');\n    var main3 = Java.use('com.example.puing.a2018codegate.Main3Activity');\n\t\t\n\t\t// 액티비티2 a 함수 implementation(재구성) \n\t\t// 반환되는 값을 빈 문자열 로 변경\n    main2.a.implementation = function() {\n        console.log('called 2');\n        var str = Java.use('java.lang.String');\n        var exampleStirng1 = str.$new('');\n        return exampleStirng1;\n    }\n\n\t  // k 함수 반환되는 값을 빈 문자열 로 변경\n    main3.k.implementation = function() {\n        console.log('called 3');\n        var str = Java.use('java.lang.String');\n        var exampleString1 = str.$new('');\n        return exampleString1;\n    }\n\n});\n\"\"\"</span>\n\n<span class=\"token comment\"># process attach </span>\np <span class=\"token operator\">=</span> frida<span class=\"token punctuation\">.</span>get_usb_device<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>attach<span class=\"token punctuation\">(</span><span class=\"token string\">'com.example.puing.a2018codegate'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'load done'</span><span class=\"token punctuation\">)</span>\njs <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>create_script<span class=\"token punctuation\">(</span>jscode<span class=\"token punctuation\">)</span>\njs<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># for interrupt</span></code></pre></div>\n<hr>\n<h2 id=\"jni-load\" style=\"position:relative;\"><a href=\"#jni-load\" aria-label=\"jni load permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JNI Load</h2>\n<ul>\n<li>삽입 되어 있는 JNI (네이티브 라이브러리)를 로드하는 앱을 만들어서 실행</li>\n<li>실무에서도 리버싱할 때 많이 쓰인다.\n<ul>\n<li>Root Detecting 기능 혹은 디버깅 방지 기능이 많이 들어가 있다.</li>\n<li>해당 기능을 우회하는 비용보다 삽입된 JNI를 로드하는게 훨씬 쉽다.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 467px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsElEQVQY03XLSQ6CQBRF0VqP8ovfiFoYqokYhAInokHR6P5XYWwmJnpyZy9PkXCVmrgq94fj/Xbv+368XIfhMI7D+TTE2FZV3cQmBK816G9qYUwO5LKlDd4WRfCuLEtbOO+8MXkCCbzoX1SWZQyIiaYJQIpTxBRTIkJEEUHE5xM0/KLWLnSYN5xHXK7CZt602xh3u25b123XWVsQIf+hvHM8k3ciLMIsn42YWFhm8q8HyoxBU+EwV+kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/a5b78a89863e251cd79b09ea847f625b/85ff8/12.png\"\n        srcset=\"/static/a5b78a89863e251cd79b09ea847f625b/e9ff0/12.png 180w,\n/static/a5b78a89863e251cd79b09ea847f625b/f21e7/12.png 360w,\n/static/a5b78a89863e251cd79b09ea847f625b/85ff8/12.png 467w\"\n        sizes=\"(max-width: 467px) 100vw, 467px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>동일한 클래스명 생성\n<ul>\n<li>System.LoadLibrary를 호출하는 클래스의 이름으로 매핑되어 있다.</li>\n<li>Java_com_example_puing_a2018codegate_Main4Activity_stringFromJNI</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"main4activity\" style=\"position:relative;\"><a href=\"#main4activity\" aria-label=\"main4activity permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Main4Activity</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">```java\npackage com.example.puing.a2018codegate;\n\nimport android.util.Log;\n\npublic class Main4Activity {\n    public native String stringFromJNI(); // stringFromJNI 선언\n\n    static {\n        System.loadLibrary(\"native-lib\"); // JNI 로드\n    }\n    public Main4Activity() {\n        Log.d(\"FLAG\", stringFromJNI()); // logcat으로 해당 함수를 호출한 값을 출력\n    }\n}\n```\n\n </code></pre></div>\n<h3 id=\"mainactivity\" style=\"position:relative;\"><a href=\"#mainactivity\" aria-label=\"mainactivity permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MainActivity</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">```java\npackage com.Zer0Luck.android_analysis;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.os.Bundle;\n\nimport com.example.puing.a2018codegate.Main4Activity;\n\npublic class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        new Main4Activity(); // MainActivity에서 바로 액티비티 4를 호출\n    }\n}\n```</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C-%EC%95%B1%EC%9D%98-%EC%8B%9C%EC%9E%91%EC%A0%90\">안드로이드 앱의 시작점</a></p>\n</li>\n<li>\n<p><a href=\"#mainactivty1\">MainActivty1</a></p>\n</li>\n<li>\n<p><a href=\"#k-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">K 함수 분석</a></p>\n</li>\n<li>\n<p><a href=\"#mainactivity2-intent-%EC%9A%94%EC%B2%AD-%EC%A1%B0%EA%B1%B4-%EB%B6%84%EC%84%9D\">MainActivity2 intent 요청 조건 분석</a></p>\n</li>\n<li>\n<p><a href=\"#mainactivity2\">MainActivity2</a></p>\n</li>\n<li>\n<p><a href=\"#mainactivity2-a-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">MainActivity2 a 함수 분석</a></p>\n</li>\n<li>\n<p><a href=\"#mainactivity3-%EB%B6%84%EC%84%9D\">MainActivity3 분석</a></p>\n</li>\n<li>\n<p><a href=\"#main3activity-k-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">Main3Activity K 함수 분석</a></p>\n</li>\n<li>\n<p><a href=\"#main4activity-%EB%B6%84%EC%84%9D\">Main4Activity 분석</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n<ul>\n<li><a href=\"#activity-start\">Activity Start</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#hooking\">Hooking</a></p>\n</li>\n<li>\n<p><a href=\"#jni-load\">JNI Load</a></p>\n<ul>\n<li><a href=\"#main4activity\">Main4Activity</a></li>\n<li><a href=\"#mainactivity\">MainActivity</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"August 14, 2020","title":"Droid APK 취약점 연구","categories":"Mobile","author":"Zer0Luck","emoji":"📱"},"fields":{"slug":"/droidCTF_droid_ctf_writeup/"}},"prev":{"id":"a24a5aee-e8b3-5f07-97be-38cde1de2899","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"angry-bird-바이너리-동작-결과\" style=\"position:relative;\"><a href=\"#angry-bird-%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%8F%99%EC%9E%91-%EA%B2%B0%EA%B3%BC\" aria-label=\"angry bird 바이너리 동작 결과 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Angry Bird 바이너리 동작 결과</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 5.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOElEQVQI12OwtbW1NDdXt3fTNzI20Nc3NDQ0NzMztjSL0LJPFjfSl1WSl5YVEBQQ4OcXQgX8/PwATlwI0etcYhwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/3b5865e318632473c734c46d979a6987/37523/0.png\"\n        srcset=\"/static/3b5865e318632473c734c46d979a6987/e9ff0/0.png 180w,\n/static/3b5865e318632473c734c46d979a6987/f21e7/0.png 360w,\n/static/3b5865e318632473c734c46d979a6987/37523/0.png 720w,\n/static/3b5865e318632473c734c46d979a6987/302a4/0.png 1080w,\n/static/3b5865e318632473c734c46d979a6987/07a9c/0.png 1440w,\n/static/3b5865e318632473c734c46d979a6987/f33fc/0.png 1905w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>바이너리 실행시 아무 결과가 안나오는 것을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAk0lEQVQI102Myw6CMBQF+f+vsgi6p24sKpGoSW1LsbTXQh/XGGLi2c7MKSilhJCq2jL24ByNSTHmnBERnVuEcEqB0C8XrFvsHOaUEv5WUNqU5aauCWP3rsO+zwC4CtbO4+jFE463qzCD8+CDjyH+xxdCmt3+0Lb8fNJSqDe4lQEEYzznoLRFxGmygxr0qKWUMX4vPmOQp3GP1oScAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/00449beb5b381832f69e68bba481a5dc/37523/1.png\"\n        srcset=\"/static/00449beb5b381832f69e68bba481a5dc/e9ff0/1.png 180w,\n/static/00449beb5b381832f69e68bba481a5dc/f21e7/1.png 360w,\n/static/00449beb5b381832f69e68bba481a5dc/37523/1.png 720w,\n/static/00449beb5b381832f69e68bba481a5dc/108f8/1.png 777w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">Stack Smahsing Protector(SSP)</code> 보호기법이 적용되어 있어 Stack Prlog를 거치면서 <code class=\"language-text\">Stack Canary</code> 를 <code class=\"language-text\">rax</code> 레지스터에 <code class=\"language-text\">TEB</code>에서 생성된 값을 가져와 해당 값을 스택에 집어넣는 것을 확인할 수가 있으며</li>\n<li><code class=\"language-text\">eax</code> 레지스터를 0으로 초기화 한후 0과 비교를 하여 <code class=\"language-text\">exit</code> 함수로 점프하는 것을 볼 수 있다.</li>\n<li>그래서, 해당 바이너리를 실행하였을 때 바로 끝나는 모습을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"nop-sled-적용\" style=\"position:relative;\"><a href=\"#nop-sled-%EC%A0%81%EC%9A%A9\" aria-label=\"nop sled 적용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nop Sled 적용</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmklEQVQI1y3LsQ6CMBAAUP7/VxwcXfQfdBAJpS29RkDKXQsNBQY5E+LbX2YOABaxfQ9XgdKOhaKLJNBe6qCrvsrLm3En484d3XHgGL/e87Zx9s8G3NArej37XJIo3EORtqOFAHWo1QiCrPCmnXBNPKediJeFMzhYa8mTm1F7XQfTxU8bmyY2kmSJpSJVkTChxoRL4inuiLyu/ANyLqJ0lAxI5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/d69e02d27fa50f6c7aab28bacd1866c4/0a47e/2.png\"\n        srcset=\"/static/d69e02d27fa50f6c7aab28bacd1866c4/e9ff0/2.png 180w,\n/static/d69e02d27fa50f6c7aab28bacd1866c4/f21e7/2.png 360w,\n/static/d69e02d27fa50f6c7aab28bacd1866c4/0a47e/2.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">_exit</code> Hex 값을 90(Nop)으로 패치하여 점프를 뛰어도 끝날 수 없도록 진행하였다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhElEQVQI113LywqDMBQEUP//i1pIXHSnCw2k4MK9hLz0EszNA0ybUGjpLAaG4XTraodhG8dtWayUBaD8xrl4HNGfD4z1CCEYYwDAOYeIHeeM0nvf3+aZa/1l11UbIFiLbdbtvVctOedSSscYI4RSSqbpqdQ/3nfU+mz2g6WUQoiU0hu/AMSwqEwTb+luAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/c7c71e94b6a14b08fcd20f3dd63e27c0/37523/3.png\"\n        srcset=\"/static/c7c71e94b6a14b08fcd20f3dd63e27c0/e9ff0/3.png 180w,\n/static/c7c71e94b6a14b08fcd20f3dd63e27c0/f21e7/3.png 360w,\n/static/c7c71e94b6a14b08fcd20f3dd63e27c0/37523/3.png 720w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWUlEQVQY01XLzUvCcBzH8V9HlwsXhg958CECtaQ8WHSqTv4F/V0RFBRGEHVwkGIUZFZmG/iw+XAQSlMps0OkrKnMuf3aN7I69OLN5/ZBNFdMPDfZjpTryyVVLSnK9/6kKIXBoApwGDtb9a8E19aXA4E5v98667aYTEajEe3dlU4qraQwvBQEVpWyGs5pwMFvWYzLAMex8w37UtC9MO/1eHyLTq/P6bBP22woxKSi1XpKlJPdXlZVeYC0JLHiR0aW+dH5AWA3GqGmJmfcbpfL5XQ4rBazyWymKAqFGCZSaWSGn3kAXtN4ALbbS723c1jjNMio+B5gJ0yPIUQZDCRJ6vV6ghgnCEKn06H9NBOt1Zn+MC6+JTri+YvASoM84DxAAYDD+BFgmw4jhPQkqRsh/qCtKHPENk7LEl1sxxvKRU25elJvmmqypd2+wnUT8z3YPKARQiQ5Qfz3BS/y1Tv2Hj0KAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/8ce7efe9ddd4a1730a488b3f708c2ef9/37523/4.png\"\n        srcset=\"/static/8ce7efe9ddd4a1730a488b3f708c2ef9/e9ff0/4.png 180w,\n/static/8ce7efe9ddd4a1730a488b3f708c2ef9/f21e7/4.png 360w,\n/static/8ce7efe9ddd4a1730a488b3f708c2ef9/37523/4.png 720w,\n/static/8ce7efe9ddd4a1730a488b3f708c2ef9/302a4/4.png 1080w,\n/static/8ce7efe9ddd4a1730a488b3f708c2ef9/71e8d/4.png 1304w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>디버거를 바탕으로 <code class=\"language-text\">_exit</code> 함수로 점프하는 것은 우회를 하여 <code class=\"language-text\">you shoul return 21 not 1 :(</code> 문자열을 반환하는 것을 확인할 수있다.</li>\n</ul>\n<h2 id=\"you-should-return-21-not-1-\" style=\"position:relative;\"><a href=\"#you-should-return-21-not-1-\" aria-label=\"you should return 21 not 1  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>you should return 21 not 1 :(</h2>\n<ul>\n<li>출력된 결과를 확인해 보면 21을 반환해야 한다고 한다.</li>\n<li>해당 함수를 분석해보도록 하겠다.</li>\n</ul>\n<h2 id=\"sub_4006f6-함수-분석\" style=\"position:relative;\"><a href=\"#sub_4006f6-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"sub_4006f6 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sub_4006F6 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuUlEQVQI1z2O24qDMBRF/f+f8oI+KhRKZagiQgpWWquW5JzkJNlDxzLrfe21k2EYyrLM8/xyaYkQAgBsm7/fhTnsu2gtIh6ABEdC1lsWjogAkr7vq6oqiqJtf8YR44j3GwdE8nzqaTLTpK0VZkuGyJAXL38kXddlWZam6el0vt2wLHi9ED+7MMY9HnpZ7LrabeN53owxzCwizrlPWSnVNE1d19drJxKP5r77eXbrGpXyIt8jIfiDf/kXUIHg8KxWIggAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/e78579349755a3bd0a09187171016d3a/37523/5.png\"\n        srcset=\"/static/e78579349755a3bd0a09187171016d3a/e9ff0/5.png 180w,\n/static/e78579349755a3bd0a09187171016d3a/f21e7/5.png 360w,\n/static/e78579349755a3bd0a09187171016d3a/37523/5.png 720w,\n/static/e78579349755a3bd0a09187171016d3a/5a6dd/5.png 802w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>앞의 문자열을 출력한 함수 블록 내부이며 반환 되는 값 <code class=\"language-text\">dword_606060</code> 영역을 확인해보자</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 539px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAY0lEQVQI142MSwqAMBBDvf8RBX9V3BRFraOjdBIp2I0rH28RCElhBhIxGsl52lw/Dt4fcjEDvH4yyaKqpG3FuUXV6sY3XZnOcg9QJKnK8+S6ct9533kcAkIwICkHVEFYjPaHB3xQr3XEBD3WAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/3d0e2f0da47d21a8e2bf152607d98c5b/10f9a/6.png\"\n        srcset=\"/static/3d0e2f0da47d21a8e2bf152607d98c5b/e9ff0/6.png 180w,\n/static/3d0e2f0da47d21a8e2bf152607d98c5b/f21e7/6.png 360w,\n/static/3d0e2f0da47d21a8e2bf152607d98c5b/10f9a/6.png 539w\"\n        sizes=\"(max-width: 539px) 100vw, 539px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>확인 결과 <code class=\"language-text\">1</code>을 담고 있는 것을 확인하였다.</li>\n<li>우리는 21을 반환해야 하기 때문에 <code class=\"language-text\">21</code> 로 패치하도록 한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 676px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAWklEQVQI1yXKwQrAIAwDUP//H4UdNqbgHB5cbWvN6PYOIZCEnBEjUkIpqzWplQbN/WhbSg8TPnNiDIhAFUSevyCC3n0wW+fJ9008pFz6sF/so2rMJuJJ5OX3An8zdEHQir6CAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/8a2839d7516f5eef637a43f191a408ed/9bb7a/7.png\"\n        srcset=\"/static/8a2839d7516f5eef637a43f191a408ed/e9ff0/7.png 180w,\n/static/8a2839d7516f5eef637a43f191a408ed/f21e7/7.png 360w,\n/static/8a2839d7516f5eef637a43f191a408ed/9bb7a/7.png 676w\"\n        sizes=\"(max-width: 676px) 100vw, 676px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>하지만 중요한 사실은 반환된 결과 값을 mov 명령어를 바탕으로 <code class=\"language-text\">[rbp+n]</code> 대입 하는 것을 확인할 수 있는 데 OPER2에 해당하는 <code class=\"language-text\">eax</code> 레지스터는 32bit 형식이기에 <code class=\"language-text\">mov</code> 명령을 사용하게 되면 성질이 맞지 않아 <code class=\"language-text\">Segment Falut</code> 가 뜨고 만다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 685px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARUlEQVQI1wXB0QqAIAwF0P7/y3wSfJYCGeQeQmLWXJG7nbOUcsZYQ6CU9pyVCMwQAQB3B9CaijyV+7od9/XO+Y1hqmpmP4ZfN+kl+yPhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/2381009df4e303ad2da06ca16d484748/8ce22/8.png\"\n        srcset=\"/static/2381009df4e303ad2da06ca16d484748/e9ff0/8.png 180w,\n/static/2381009df4e303ad2da06ca16d484748/f21e7/8.png 360w,\n/static/2381009df4e303ad2da06ca16d484748/8ce22/8.png 685w\"\n        sizes=\"(max-width: 685px) 100vw, 685px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAj0lEQVQY022O0QqFMAiGe/+3DKIgjWVt58zUeWiL0cX5LkR+/NRhnn2aPCV391LuGsJ32xKRLgufZ1Ytx0EhBESMMV4VESmlDN3pzb5nxPTOiQgAEFFV/cUjt7kuAzT5pib7uq4A8F9+X25vi5iItTzGSBVV7RsfuaHqzO3yNY6Z2cyeoVxh5pzzp2J27/0BzYkklZW0UmQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/56523e94bfc63dede1162e9089c0362a/1f083/9.png\"\n        srcset=\"/static/56523e94bfc63dede1162e9089c0362a/e9ff0/9.png 180w,\n/static/56523e94bfc63dede1162e9089c0362a/f21e7/9.png 360w,\n/static/56523e94bfc63dede1162e9089c0362a/1f083/9.png 660w\"\n        sizes=\"(max-width: 660px) 100vw, 660px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">NOP</code> 명령으로 해당 값 부분을 패치하여 우회하도록 한다.</li>\n<li>sub_40070C  부분도 똑같이 NOP으로 채워 우회하도록 한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 677px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxklEQVQoz42Q246DMAwF+/+fWTXkhiglOLGTYFfFXbTqVivm2eNz7Iu1Mk1CJNsmrYmIMIu1a0pk7ZISEXXE3jszc9+RHy63m1yvYszLP3BuBWjG0P2Oy4LeP2Kc53lOKdVamfktOyd/8X6ttWsLEUEs487v2JdszBfZubXWTWVmAYAQQozxlGzMoskKAPidpl/5Xx6GpMmHrMmf8jCckr33IQStfephx1ApZdr5vHkcv8jWppxbKe+SRAQAOWdELKXknHXvE3BVDpQ3RkRwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/0cc3c4dd543f217c7fd015061c86f0a5/68de2/10.png\"\n        srcset=\"/static/0cc3c4dd543f217c7fd015061c86f0a5/e9ff0/10.png 180w,\n/static/0cc3c4dd543f217c7fd015061c86f0a5/f21e7/10.png 360w,\n/static/0cc3c4dd543f217c7fd015061c86f0a5/68de2/10.png 677w\"\n        sizes=\"(max-width: 677px) 100vw, 677px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"sub_40072a-함수\" style=\"position:relative;\"><a href=\"#sub_40072a-%ED%95%A8%EC%88%98\" aria-label=\"sub_40072a 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sub_40072A 함수</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA80lEQVQY01XI20uDUBwAYP/5vffW6GGXiFrDFcmK2MxBTc/JSw26sDbRKAt0hNPpjsfjOb8oCAy+p09SPL+DUcuYyvPlJC7HEdEL6gDYf8yq+sGYxbldextAOvOiNnbbaNl/+rze0FGYDj/CScqcZOzEpxant4xhSjEtzaqyAOqkoe/vY9RFU/l5oWdUW2VqtEGEzgDuQTgc0La6E3wG8Dv/SLsPXkM1GqObHfPlIChaLtmbk6OIybEYpCDH4vAt7QXJcZjLazFIoE7qLV6bhtnUcffRPf+iJ++5Em4v1qVKhFaCVgglyC5XmZrmV4RrFOq+AUH6A87C7TyiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/5eb37b2d4169c724b4719f2c2aa7cc0e/37523/11.png\"\n        srcset=\"/static/5eb37b2d4169c724b4719f2c2aa7cc0e/e9ff0/11.png 180w,\n/static/5eb37b2d4169c724b4719f2c2aa7cc0e/f21e7/11.png 360w,\n/static/5eb37b2d4169c724b4719f2c2aa7cc0e/37523/11.png 720w,\n/static/5eb37b2d4169c724b4719f2c2aa7cc0e/d7542/11.png 810w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>앞 조건을 마치고 해당 함수로 들어오는데 여기서는 <code class=\"language-text\">\"hello\"</code> 문자열 과 입려 값을 비교하여 동일할 경우 정상적으로 반환하는 것을 확인할 수 있다.</li>\n<li><code class=\"language-text\">0x606038</code> 주소가 어디인지 확인하였으나 <code class=\"language-text\">__libc_start_main</code> got 영역의 주소  값인 것을 알았으며 해당 부분에서 어떤 문자열을 가져와 비교하는지를 모르기 때문에 <code class=\"language-text\">Ghidra</code> 디컴파일을 통해 확인하여</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 615px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAu0lEQVQY04WQWW7DMAxEfZKkliyJokRa1BY5Sbf7X6pw+1MgGzCYjwEfMMNJSpsxHmidKb2xHFlUbr5twKIMaOufaMrjIvWU62lxqH4jZUD9uQFtnsK8XdfcbGANwflofXRIFiMgGQizcxq8gXAfHtfP0jdbenn/qn1bpdZ+zm30cUFKh6AtxUj3J0yY8vj4Lm1IboEFKWFMEBgpLQ732sY/Gj9ZFk3JBVbGL26P/vuLh1lpZifh5ekt/AMLLUN4oJ+B9QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/aeb0f08356c2c8ac7de4a2010e105f1f/f6b72/12.png\"\n        srcset=\"/static/aeb0f08356c2c8ac7de4a2010e105f1f/e9ff0/12.png 180w,\n/static/aeb0f08356c2c8ac7de4a2010e105f1f/f21e7/12.png 360w,\n/static/aeb0f08356c2c8ac7de4a2010e105f1f/f6b72/12.png 615w\"\n        sizes=\"(max-width: 615px) 100vw, 615px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 조건을 마찬가지로 <code class=\"language-text\">NOP</code> 으로 채워 우회하도록 하겠다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABD0lEQVQoz3XR22qEMBAGYN//nUSWeGQpLL3TjXRVsGDMwXVNNMZMQYXa4s5lZr78E+LkeR6G0fWaPB5PSmGarDEAAEKMnKuGdsYsr5caBqX1ZK2FQzlZliJ0SRIf4y5NoWn2thCKMflVEiakEEopDQB/LTj3e+H7H3F8w7iva5By73MuhdDf9aj10vdSysGYBeA/LhG6RdFnWQ7rxTumVG7T1gJjnBCyLCc4Q+gSx6iquiNm7Bdzztu2PcXY94MoCsuye5f8FmdZhhAKw6AoxGny+v43a2OMgyCI46iquvVkx4QM42jWZMsYo5RKKZVSx99y0jR1XdfzvLal26gQmnNDiO17u61t1prnWWt9xD8m3f+UOvitYQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./13.png\"\n        title=\"./13.png\"\n        src=\"/static/91a12462ee47d9525dddf6a6ee85e4d1/37523/13.png\"\n        srcset=\"/static/91a12462ee47d9525dddf6a6ee85e4d1/e9ff0/13.png 180w,\n/static/91a12462ee47d9525dddf6a6ee85e4d1/f21e7/13.png 360w,\n/static/91a12462ee47d9525dddf6a6ee85e4d1/37523/13.png 720w,\n/static/91a12462ee47d9525dddf6a6ee85e4d1/7e4a6/13.png 952w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>싹따 채워 버렸다. 😀</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAbElEQVQI103EsQrCMBAG4NAml7sOgqLp6PQnvbYBoZFbOvkUzr7/QxQHwW/4nJm1tj3a82KvPGkGkL8AlFIA1FpVdVnXRed32j4320/pPo7pfHUiQjFyjIPvQghE9D8Ree/Dj+Pecd8JEzOLHLbnCxjyZWO7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./14.png\"\n        title=\"./14.png\"\n        src=\"/static/3993938352d4ec16d5ef3f0085933325/37523/14.png\"\n        srcset=\"/static/3993938352d4ec16d5ef3f0085933325/e9ff0/14.png 180w,\n/static/3993938352d4ec16d5ef3f0085933325/f21e7/14.png 360w,\n/static/3993938352d4ec16d5ef3f0085933325/37523/14.png 720w,\n/static/3993938352d4ec16d5ef3f0085933325/302a4/14.png 1080w,\n/static/3993938352d4ec16d5ef3f0085933325/72372/14.png 1149w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>패치후 <code class=\"language-text\">fget</code> 함수를 바탕으로 입력을 받을 수 있도록 되었다.</li>\n</ul>\n<h2 id=\"미친-조건들\" style=\"position:relative;\"><a href=\"#%EB%AF%B8%EC%B9%9C-%EC%A1%B0%EA%B1%B4%EB%93%A4\" aria-label=\"미친 조건들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>미친 조건들</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQoz23K207DMBBFUf//1wFCAoSK2jqxk7aJ0lxcjy9zkJsQOS3S0jzsOSIwZgxch1HXdWQE3CP+8P8ERawC0I2T1JpidAwbOf8+EyZiNQUmoJ3MXunJB8swgfPBAzEE5HrPBmiM3ZW6Iz8xhsAPm5W4elzDRud5YFwMfRe6sa6PqaTZE9F6tB6N4wddxOnmvqSuJ+piGszLnDh7nByft+4FTUBt/UdRqdG2EenlkROVgyauHHJLIa49lA3vsjr05hxTyWdCEUrLipBbS0lQDoriq9S7bqzCZiYk4Wj5mSQsbLqFw4usPy994bC+xN4iufHGHLeOhDfd/phwoKX8AmQze0+YS0jtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./15.png\"\n        title=\"./15.png\"\n        src=\"/static/d264ef6c46a7e66f6c4d61866acc2f8e/37523/15.png\"\n        srcset=\"/static/d264ef6c46a7e66f6c4d61866acc2f8e/e9ff0/15.png 180w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/f21e7/15.png 360w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/37523/15.png 720w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/302a4/15.png 1080w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/07a9c/15.png 1440w,\n/static/d264ef6c46a7e66f6c4d61866acc2f8e/29114/15.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>무수히 많은 조건들을 거치고 거쳐 마지막에 “you typed : %s\\n” 출력하는 곳으로 가봐야 될 것 같다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3klEQVQY003NwU7DMAwG4L3/jRsSV55iEhwQFat2Kdpx7dZRDSUDJU5ck6RNbVQKGv/Bkn/rk1dF0W23Z2OCiDBLzhNAIBqW9WeyMGP0EAAjmi8z5PkqIquHx5uyvK3rrmlEKWbmlDKzAATEpDWe3qz30fc9IDh0xplh/MPF811V3betOhykaXgcl16sDc7F83twmPLIMQ4pzpF/Wa3XT2VZ1XW/30vbcghXjJiUok5dgCCGWYYYUkrTNP3izeZlt3vtOtRaAK6fvU9Eg9bpeKLmSJ8f6BxYa4ko57zgb6H4Ggp5jqgDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./16.png\"\n        title=\"./16.png\"\n        src=\"/static/be304a44ada0a4f1949b9eb66cc4e24a/37523/16.png\"\n        srcset=\"/static/be304a44ada0a4f1949b9eb66cc4e24a/e9ff0/16.png 180w,\n/static/be304a44ada0a4f1949b9eb66cc4e24a/f21e7/16.png 360w,\n/static/be304a44ada0a4f1949b9eb66cc4e24a/37523/16.png 720w,\n/static/be304a44ada0a4f1949b9eb66cc4e24a/5a190/16.png 800w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>angr 모듈을 사용하여 solve 를 작성해보겠다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"solved-code\" style=\"position:relative;\"><a href=\"#solved-code\" aria-label=\"solved code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">solved</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    p<span class=\"token operator\">=</span>angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./angrybird_3'</span><span class=\"token punctuation\">,</span> auto_load_libs<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token comment\"># state를 임의로 위 함수를 무시한채 해당 지역부터 시작하도록 한다.</span>\n    state <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>blank_state<span class=\"token punctuation\">(</span>addr<span class=\"token operator\">=</span><span class=\"token number\">0x4007C2</span><span class=\"token punctuation\">)</span>\n\n    sm <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simgr<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>\n    sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span><span class=\"token number\">0x404fab</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 최하단 True 주소 값</span>\n\n    flag <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"solved-code2\" style=\"position:relative;\"><a href=\"#solved-code2\" aria-label=\"solved code2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solved Code2</h2>\n<ul>\n<li>앞에서 해당 함수들을 패치를 진행하였는데 해당 패치를 하지 않고 angr 모듈을 사용하여 우회하는 방안도 존재한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 645px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA30lEQVQY01WPu3KDMBRE+f+/CtQZnBQJYJAspLHDGGEkIbh63kzSJN5iuzN7tmBlNb2daO8uDJsmM4bHgYiY809zrvY9DMNC2fx4wLpti1aL3KW0UtqCVdXXqSbdQS94u2Vr8X+E0PseONctE7PcvEsxhhCCcxBjKMbyZTq9kjMQgl2b7/cn+HfZc64In6yFlJL3znsHAN6H4lzVY90MnaMU+z5frxjjn7YQ2lrP+TpQqVTAnJXejQFjDAAUH2XL3hnpA6U4z7htT5+FUABhmszI9CeZV2O1RiljSjGl9A2Lahjo78fO7AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./17.png\"\n        title=\"./17.png\"\n        src=\"/static/d021af799dffbfa1be4bfde9355fde46/af192/17.png\"\n        srcset=\"/static/d021af799dffbfa1be4bfde9355fde46/e9ff0/17.png 180w,\n/static/d021af799dffbfa1be4bfde9355fde46/f21e7/17.png 360w,\n/static/d021af799dffbfa1be4bfde9355fde46/af192/17.png 645w\"\n        sizes=\"(max-width: 645px) 100vw, 645px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 <code class=\"language-text\">sub_4006F6</code>, <code class=\"language-text\">sub_40070C</code> 함수를 무시한채 <code class=\"language-text\">rbp</code> 기준 값을 현재 <code class=\"language-text\">0x4007c2</code> 주소로 기준을 잡도록 수정하도록 한다. 즉, 메인 함수 프롤로그를 해당 주소로 바꾸는 것이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.555555555555557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfElEQVQI1y3LSw7CIBQF0G7XNbgyTYzpyEQHftAG2qLIUwTKoGBioxGvDjzzU2imDvPdfratlydzgzEQAikBQM7Z+889LWQ7utBLGmq1aeogRMd5B6DwVaXK8jid0GqjzuAcjGEY/tm5d4zrRo6tfV6Dt6F39kEUte5/+QtiN2tm78BXHgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./18.png\"\n        title=\"./18.png\"\n        src=\"/static/c3c30d9bc922d388bdf0ba6515463301/37523/18.png\"\n        srcset=\"/static/c3c30d9bc922d388bdf0ba6515463301/e9ff0/18.png 180w,\n/static/c3c30d9bc922d388bdf0ba6515463301/f21e7/18.png 360w,\n/static/c3c30d9bc922d388bdf0ba6515463301/37523/18.png 720w,\n/static/c3c30d9bc922d388bdf0ba6515463301/c8e86/18.png 758w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> angr\n\nSTART_ADDR <span class=\"token operator\">=</span> <span class=\"token number\">0x4007c2</span>\nFIND_ADDR <span class=\"token operator\">=</span> <span class=\"token number\">0x404fab</span>  <span class=\"token comment\"># This is right before the printf</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    proj <span class=\"token operator\">=</span> angr<span class=\"token punctuation\">.</span>Project<span class=\"token punctuation\">(</span><span class=\"token string\">'./angrybird'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 해당 바이너리에서 함수 부분을 우회 한다.</span>\n    state <span class=\"token operator\">=</span> proj<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>entry_state<span class=\"token punctuation\">(</span>addr<span class=\"token operator\">=</span>START_ADDR<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 함수 프롤로그 변경</span>\n    state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rsp\n    <span class=\"token comment\"># 0x40의 길이 값</span>\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x74</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x40</span>\n\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x70</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1000</span> <span class=\"token comment\"># strncmp@got</span>\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1008</span> <span class=\"token comment\"># puts@got</span>\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x60</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1010</span> <span class=\"token comment\"># _stack_chk_fail@got</span>\n    state<span class=\"token punctuation\">.</span>mem<span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">.</span>regs<span class=\"token punctuation\">.</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x58</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">long</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x1018</span> <span class=\"token comment\"># _lib_start_main</span>\n\n    sm <span class=\"token operator\">=</span> proj<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>simulation_manager<span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 시뮬레이션 생성</span>\n    sm<span class=\"token punctuation\">.</span>explore<span class=\"token punctuation\">(</span>find<span class=\"token operator\">=</span>FIND_ADDR<span class=\"token punctuation\">)</span>\n\n    found <span class=\"token operator\">=</span> sm<span class=\"token punctuation\">.</span>found<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    flag <span class=\"token operator\">=</span> found<span class=\"token punctuation\">.</span>posix<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>    \n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAm0lEQVQI1xXLWxKCIBQAUPfR5epXM4kPHl7A0AQKbCr3v53GmfN7qvX4UX7546NStO+sSsJlgkDwNBAMCwaiaTYDu2OrxknAolEMzIiGZCVL6uI6lNBuvi+h3cOZtwkiQSIWCKKpo70UB4Fw7FGP2HUo+mYcK1MyleyP7/BYbn6+eoskmJNsVicr2V3XTsGimZXY8fO3HIceOf8DMAMjRtODJscAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./19.png\"\n        title=\"./19.png\"\n        src=\"/static/d86792bff2be708d2a6fcf4ad09b0b58/37523/19.png\"\n        srcset=\"/static/d86792bff2be708d2a6fcf4ad09b0b58/e9ff0/19.png 180w,\n/static/d86792bff2be708d2a6fcf4ad09b0b58/f21e7/19.png 360w,\n/static/d86792bff2be708d2a6fcf4ad09b0b58/37523/19.png 720w,\n/static/d86792bff2be708d2a6fcf4ad09b0b58/6d2da/19.png 936w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#angry-bird-%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%8F%99%EC%9E%91-%EA%B2%B0%EA%B3%BC\">Angry Bird 바이너리 동작 결과</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#nop-sled-%EC%A0%81%EC%9A%A9\">Nop Sled 적용</a></li>\n<li><a href=\"#you-should-return-21-not-1-\">you should return 21 not 1 :(</a></li>\n<li><a href=\"#sub_4006f6-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">Sub_4006F6 함수 분석</a></li>\n<li><a href=\"#sub_40072a-%ED%95%A8%EC%88%98\">sub_40072A 함수</a></li>\n<li><a href=\"#%EB%AF%B8%EC%B9%9C-%EC%A1%B0%EA%B1%B4%EB%93%A4\">미친 조건들</a></li>\n<li><a href=\"#solved-code\">Solved Code</a></li>\n<li><a href=\"#solved-code2\">Solved Code2</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 15, 2020","title":"CodeGate2017 angrybird 분석","categories":"CTF","author":"Zer0Luck","emoji":"🦩"},"fields":{"slug":"/codegate2017_angrybird_ctf_writeup/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/sharkyCTF_z3z3_ctf_writeup/","nextSlug":"/droidCTF_droid_ctf_writeup/","prevSlug":"/codegate2017_angrybird_ctf_writeup/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}