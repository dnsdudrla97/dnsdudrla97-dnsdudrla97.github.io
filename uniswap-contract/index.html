<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.f0f69b0fea852e43ed02.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}.search-input-wrapper{align-items:center;display:none;margin-top:3px;width:180px}@media(min-width:768px){.search-input-wrapper{display:flex}}.search-icon{color:var(--primary-text-color);margin-right:2px}.search-input{height:100%;width:100%}.search-input .MuiAutocomplete-inputRoot{padding-right:0!important}.search-input .MuiInputBase-input{color:var(--primary-text-color)!important;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;font-weight:500;padding-bottom:2px!important}.search-input .MuiInput-underline:before{border-bottom-width:1px}.search-input .MuiInput-underline:after,.search-input .MuiInput-underline:before{border-bottom-color:var(--primary-text-color)}.page-header-wrapper{display:flex;height:60px;justify-content:center;width:100%}.page-header-wrapper .page-header{align-items:center;display:flex;justify-content:space-between;max-width:720px;width:100%}.page-header-wrapper .page-header .link{color:var(--primary-text-color);font-size:17px;font-weight:700}@media(min-width:768px){.page-header-wrapper .page-header .link{font-size:20px;font-weight:700}}.page-header-wrapper .page-header .trailing-section{align-items:center;display:flex}.page-header-wrapper .page-header .trailing-section .link{margin-right:10px}@media(min-width:768px){.page-header-wrapper .page-header .trailing-section .link{margin-right:20px}}.page-footer-wrapper{align-items:center;display:flex;height:62px;justify-content:center;margin-top:auto;width:100%}.page-footer-wrapper .page-footer{max-width:720px;text-align:center;width:100%}.page-footer-wrapper .page-footer .link{color:var(--primary-text-color);font-size:20px;font-weight:700;margin-right:20px}.page-footer-wrapper .page-footer a{color:#3a95ff}.dark-mode-button-wrapper{align-items:center;bottom:20px;display:flex;justify-content:center;position:fixed;right:20px}.dark-mode-button{-webkit-backdrop-filter:blur(30px);backdrop-filter:blur(30px);background-color:#363f47!important;border-radius:50px;box-shadow:0 5px 25px rgba(0,0,0,.12);cursor:pointer;height:50px;width:50px;z-index:3}.dark-mode-icon{color:#fff}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{border:0;font-size:100%;font:inherit;margin:0;padding:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}table{border-collapse:collapse;border-spacing:0}a{outline:none;text-decoration:none}html{--background-color:#fff;--primary-text-color:#000;--secondary-text-color:#9e9e9e;--content-text-color:#37352f;--button-background-color:#f3f3f4;--button-text-color:#363f47;--tab-text-color:#6e6d7a;--tab-hover-text-color:#0d0c22;--tab-selected-background-color:rgba(13,12,34,.05);--bio-link-icon-color:rgba(0,0,0,.54);--about-link-icon-color:#a8a8a8;--chip-background-color:#f3f3f4;--link-text-color:rgba(55,53,47,.7);--post-card-border-color:rgba(0,0,0,.12);--markdown-table-even-cell-background-color:#f6f8fa;--markdown-table-border-color:#dfe2e5;--markdown-blockquote-border-color:#dfe2e5;--markdown-border-color:#e1e4e8}html[data-theme=dark]{--background-color:#232326;--primary-text-color:#e6e6e6;--secondary-text-color:#768390;--content-text-color:#e6e6e6;--button-background-color:#444c56;--button-text-color:#363f47;--tab-text-color:#768390;--tab-hover-text-color:#acbac7;--tab-selected-background-color:#373e47;--chip-background-color:#323a42;--bio-link-icon-color:#e6e6e6;--about-link-icon-color:#a8a8a8;--link-text-color:#90b0ec;--post-card-border-color:#363f47;--markdown-table-even-cell-background-color:#2d333b;--markdown-table-border-color:#444c56;--markdown-blockquote-border-color:#4f5864;--markdown-border-color:#e1e4e8}*{-webkit-appearance:none;appearance:none;box-sizing:border-box}html{font-size:14px;height:100%;overflow-y:scroll;width:100%}body{background-color:var(--background-color)!important}a{color:var(--link-text-color)}.page-wrapper{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:var(--primary-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;justify-content:center;min-height:100vh;padding-left:15px;padding-right:15px;word-break:keep-all}.page-wrapper,.page-wrapper .page-content{align-items:center;display:flex;flex-direction:column;width:100%}.page-wrapper .page-content{max-width:720px}.icon{color:var(--about-link-icon-color);font-size:20px}.social-links .icon{color:var(--bio-link-icon-color);font-size:30px}@-webkit-keyframes blinking-cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes blinking-cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}.bio{color:var(--primary-text-color);display:flex;flex-direction:column;justify-content:space-between;margin-bottom:120px;margin-top:120px;width:100%}@media(min-width:768px){.bio{align-items:center;flex-direction:row}}.bio .introduction{display:flex;flex-direction:column;word-break:keep-all}.bio .introduction .react-rotating-text-cursor{-webkit-animation:blinking-cursor .8s cubic-bezier(.68,.01,.01,.99) 0s infinite;animation:blinking-cursor .8s cubic-bezier(.68,.01,.01,.99) 0s infinite}.bio .introduction strong{display:inline-block;font-weight:600}.bio .introduction.korean{font-size:32px;font-weight:100;line-height:1.2}.bio .introduction.korean .title .react-rotating-text-cursor{font-size:35px;line-height:35px}@media(min-width:768px){.bio .introduction.korean{font-size:40px}.bio .introduction.korean .title .react-rotating-text-cursor{font-size:45px;line-height:45px}}.bio .introduction.english{font-family:montserrat;font-size:25px;line-height:1.2}@media(min-width:768px){.bio .introduction.english{font-size:45px}}.bio .introduction.english .name{font-size:35px;font-weight:600}.bio .introduction.english .job{font-size:35px}.bio .introduction.english .description{font-size:20px;font-weight:200;margin-top:8px}.bio .introduction.english .social-links{display:flex;margin-top:20px}.bio .thumbnail{display:none;width:250px}@media(min-width:768px){.bio .thumbnail{display:block}}.section-header-wrapper{display:flex;justify-content:center;margin-bottom:32px;width:100%}.section-header-wrapper .section-header{border-bottom:4px solid var(--primary-text-color);color:var(--primary-text-color);font-size:30px;font-weight:700;padding-bottom:5px}.timestamp-section{align-items:center;display:flex;flex-direction:column;justify-content:center;margin-bottom:50px;width:100%;word-break:keep-all}.timestamp-section .body{padding:0 10px;width:100%}.timestamp-section .body .timestamp{border-left:2px solid #bdbdbd;display:flex;font-size:18px;font-weight:400;justify-items:center;margin-left:5px;padding:10px 0;width:100%}.timestamp-section .body .timestamp:first-child{padding-top:7px}.timestamp-section .body .timestamp:last-child{padding-bottom:7px}.timestamp-section .body .timestamp:before{align-self:center;background-color:var(--background-color);border:2px solid #828282;border-radius:10px;content:"";height:10px;left:-1px;position:relative;-webkit-transform:translatex(-50%);transform:translatex(-50%);width:10px}.timestamp-section .body .timestamp .date{align-self:center;color:#828282;margin-left:5px;margin-right:5px;min-width:115px;width:115px}@media(min-width:768px){.timestamp-section .body .timestamp .date{min-width:200px;width:200px}}.timestamp-section .body .timestamp .activity{line-height:23px;width:100%}.project-section{align-items:center;justify-content:center}.project-section,.project-section .project{display:flex;flex-direction:column;width:100%}.project-section .project{margin-bottom:30px;padding:15px}.project-section .project .head{font-size:20px;font-weight:700;line-height:30px;margin-bottom:10px}.project-section .project .body{display:flex;flex-direction:column;width:100%}.project-section .project .body .thumbnail{margin-bottom:10px;width:100%}.project-section .project .body .tech-stack{display:flex;margin-bottom:10px}.project-section .project .body .tech-stack .tech{background-color:var(--chip-background-color);border-radius:10px;font-size:15px;font-weight:500;margin-right:5px;padding:5px 7px}.project-section .project .body .description{font-size:16px;font-weight:400;line-height:1.4}@media(min-width:768px){.project-section .project .body{flex-direction:column}.project-section .project .body .content{margin-top:0}}.post-header{border-bottom:1px solid var(--post-card-border-color);display:flex;flex-direction:column;justify-content:center;margin-bottom:40px;margin-top:20px;padding-bottom:10px;width:100%;word-break:keep-all}.post-header .emoji{font-size:78px;margin-bottom:20px}.post-header .categories{margin-bottom:5px}.post-header .categories .category{color:var(--primary-text-color);font-weight:600;margin-right:4px}.post-header .categories .category:hover{text-decoration:underline}.post-header .title{color:var(--primary-text-color);font-size:32px;font-weight:600;line-height:1.3;margin-bottom:6px}.post-header .info{color:var(--secondary-text-color);display:flex;flex-wrap:wrap;font-size:16px;font-weight:500;line-height:1.5;width:100%}.post-header .info .author{margin-right:4px}.post-header .info strong{color:var(--primary-text-color);font-weight:600}.post-navigator{-webkit-column-gap:1.4%;column-gap:1.4%;display:grid;grid-template-columns:49.3% 49.3%;width:100%}.post-navigator .post-card{border:1px solid var(--post-card-border-color);border-radius:6px;color:var(--primary-text-color);cursor:pointer;display:flex;flex-direction:column;padding:15px;transition:-webkit-transform .2s;transition:transform .2s;transition:transform .2s,-webkit-transform .2s;width:100%}.post-navigator .post-card:hover .title{text-decoration:underline}.post-navigator .post-card.prev{margin-right:auto}.post-navigator .post-card.next{margin-left:auto}.post-navigator .post-card .direction{color:gray;font-size:14px;font-weight:500;margin-bottom:5px}.post-navigator .post-card .title{font-size:16px;font-weight:600;line-height:1.4;margin-bottom:7px}.markdown .octicon{fill:currentColor;display:inline-block;vertical-align:text-bottom}.markdown .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown .anchor:focus{outline:none}.markdown h1 .octicon-link,.markdown h2 .octicon-link,.markdown h3 .octicon-link,.markdown h4 .octicon-link,.markdown h5 .octicon-link,.markdown h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown h1:hover .anchor,.markdown h2:hover .anchor,.markdown h3:hover .anchor,.markdown h4:hover .anchor,.markdown h5:hover .anchor,.markdown h6:hover .anchor{text-decoration:none}.markdown h1:hover .anchor .octicon-link,.markdown h2:hover .anchor .octicon-link,.markdown h3:hover .anchor .octicon-link,.markdown h4:hover .anchor .octicon-link,.markdown h5:hover .anchor .octicon-link,.markdown h6:hover .anchor .octicon-link{visibility:visible}.markdown h1:hover .anchor .octicon-link:before,.markdown h2:hover .anchor .octicon-link:before,.markdown h3:hover .anchor .octicon-link:before,.markdown h4:hover .anchor .octicon-link:before,.markdown h5:hover .anchor .octicon-link:before,.markdown h6:hover .anchor .octicon-link:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E");content:" ";display:inline-block;height:16px;width:16px}.markdown{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-wrap:break-word;color:var(--content-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;font-weight:500;line-height:1.5}.markdown details{display:block}.markdown summary{display:list-item}.markdown a{background-color:initial}.markdown a:active,.markdown a:hover{outline-width:0}.markdown strong{font-weight:inherit;font-weight:bolder}.markdown h1{margin:.67em 0}.markdown img{border-style:none}.markdown code,.markdown kbd,.markdown pre{font-family:monospace,monospace;font-size:1em}.markdown hr{box-sizing:initial;overflow:visible}.markdown input{font:inherit;margin:0;overflow:visible}.markdown [type=checkbox]{box-sizing:border-box;padding:0}.markdown *{box-sizing:border-box}.markdown input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown a{border-bottom:.05em solid;border-color:var(--link-text-color);color:var(--link-text-color);text-decoration:none}.markdown a.anchor{border-bottom:none}.markdown strong{font-weight:700}.markdown hr{background:transparent;border-bottom:1px solid var(--markdown-blockquote-border-color);height:0;margin:15px 0;overflow:hidden}.markdown hr:after,.markdown hr:before{content:"";display:table}.markdown hr:after{clear:both}.markdown table{border-collapse:collapse;border-spacing:0}.markdown td,.markdown th{padding:0}.markdown details summary{cursor:pointer}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{margin-bottom:0;margin-top:0}.markdown h1{font-size:32px}.markdown h1,.markdown h2{font-weight:600}.markdown h2{font-size:24px}.markdown h3{font-size:20px}.markdown h3,.markdown h4{font-weight:600}.markdown h4{font-size:16px}.markdown h5{font-size:14px}.markdown h5,.markdown h6{font-weight:600}.markdown h6{font-size:12px}.markdown p{margin-bottom:10px;margin-top:0}.markdown blockquote{margin:0}.markdown ol,.markdown ul{margin-bottom:0;margin-top:0;padding-left:0}.markdown ol ol,.markdown ul ol{list-style-type:lower-roman}.markdown ol ol ol,.markdown ol ul ol,.markdown ul ol ol,.markdown ul ul ol{list-style-type:lower-alpha}.markdown dd{margin-left:0}.markdown code,.markdown pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown code.language-text{border-radius:3px;font-size:85%;padding:.2em .4em}.markdown :not(pre)>code.language-text{background:hsla(44,6%,50%,.15);color:#eb5757;overflow-wrap:break-word}.markdown pre{margin-bottom:0;margin-top:0}.markdown input::-webkit-inner-spin-button,.markdown input::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}.markdown :checked+.radio-label{border-color:#0366d6;position:relative;z-index:1}.markdown .border{border:1px solid var(--markdown-border-color)!important}.markdown .border-0{border:0!important}.markdown .border-bottom{border-bottom:1px solid var(--markdown-border-color)!important}.markdown .rounded-1{border-radius:3px!important}.markdown .bg-white{background-color:transparent!important}.markdown .bg-gray-light{background-color:#fafbfc!important}.markdown .text-gray-light{color:#6a737d!important}.markdown .pl-3,.markdown .px-3{padding-left:16px!important}.markdown .px-3{padding-right:16px!important}.markdown .f6{font-size:12px!important}.markdown .lh-condensed{line-height:1.25!important}.markdown .text-bold{font-weight:600!important}.markdown .pl-c{color:#6a737d}.markdown .pl-c1,.markdown .pl-s .pl-v{color:#005cc5}.markdown .pl-e,.markdown .pl-en{color:#6f42c1}.markdown .pl-s .pl-s1,.markdown .pl-smi{color:#24292e}.markdown .pl-ent{color:#22863a}.markdown .pl-k{color:#d73a49}.markdown .pl-pds,.markdown .pl-s,.markdown .pl-s .pl-pse .pl-s1,.markdown .pl-sr,.markdown .pl-sr .pl-cce,.markdown .pl-sr .pl-sra,.markdown .pl-sr .pl-sre{color:#032f62}.markdown .pl-smw,.markdown .pl-v{color:#e36209}.markdown .pl-bu{color:#b31d28}.markdown .pl-ii{background-color:#b31d28;color:#fafbfc}.markdown .pl-c2{background-color:#d73a49;color:#fafbfc}.markdown .pl-c2:before{content:"^M"}.markdown .pl-sr .pl-cce{color:#22863a;font-weight:700}.markdown .pl-ml{color:#735c0f}.markdown .pl-mh,.markdown .pl-mh .pl-en,.markdown .pl-ms{color:#005cc5;font-weight:700}.markdown .pl-mi{color:#24292e;font-style:italic}.markdown .pl-mb{color:#24292e;font-weight:700}.markdown .pl-md{background-color:#ffeef0;color:#b31d28}.markdown .pl-mi1{background-color:#f0fff4;color:#22863a}.markdown .pl-mc{background-color:#ffebda;color:#e36209}.markdown .pl-mi2{background-color:#005cc5;color:#f6f8fa}.markdown .pl-mdr{color:#6f42c1;font-weight:700}.markdown .pl-ba{color:#586069}.markdown .pl-sg{color:#959da5}.markdown .pl-corl{color:#032f62;text-decoration:underline}.markdown .mb-0{margin-bottom:0!important}.markdown .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown .pl-0{padding-left:0!important}.markdown .py-0{padding-bottom:0!important;padding-top:0!important}.markdown .pl-1{padding-left:4px!important}.markdown .pl-2{padding-left:8px!important}.markdown .py-2{padding-bottom:8px!important;padding-top:8px!important}.markdown .pl-3{padding-left:16px!important}.markdown .pl-4{padding-left:24px!important}.markdown .pl-5{padding-left:32px!important}.markdown .pl-6{padding-left:40px!important}.markdown .pl-7{padding-left:48px!important}.markdown .pl-8{padding-left:64px!important}.markdown .pl-9{padding-left:80px!important}.markdown .pl-10{padding-left:96px!important}.markdown .pl-11{padding-left:112px!important}.markdown .pl-12{padding-left:128px!important}.markdown hr{border-bottom-color:#eee}.markdown kbd{background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da;color:#444d56;display:inline-block;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown:after,.markdown:before{content:"";display:table}.markdown:after{clear:both}.markdown>:first-child{margin-top:0!important}.markdown>:last-child{margin-bottom:0!important}.markdown a:not([href]){color:inherit;text-decoration:none}.markdown blockquote,.markdown details,.markdown dl,.markdown ol,.markdown p,.markdown pre,.markdown table,.markdown ul{margin-bottom:16px;margin-top:0}.markdown hr{background-color:var(--markdown-border-color);border:0;height:.25em;margin:24px 0;padding:0}.markdown blockquote{border-left:.25em solid var(--markdown-blockquote-border-color);color:#6a737d;padding:0 1em}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown h1{font-size:2em}.markdown h2{font-size:1.5em}.markdown h3{font-size:1.25em}.markdown h4{font-size:1em}.markdown h5{font-size:.875em}.markdown h6{color:#6a737d;font-size:.85em}.markdown ol,.markdown ul{padding-left:2em}.markdown ol ol,.markdown ol ul,.markdown ul ol,.markdown ul ul{margin-bottom:0;margin-top:0}.markdown ol{list-style-type:decimal}.markdown ul{list-style-type:disc}.markdown li{word-wrap:break-all;display:list-item;text-align:-webkit-match-parent}.markdown li>p{margin-top:16px}.markdown li+li{margin-top:.25em}.markdown dl{padding:0}.markdown dl dt{font-size:1em;font-style:italic;font-weight:600;margin-top:16px;padding:0}.markdown dl dd{margin-bottom:16px;padding:0 16px}.markdown table{display:block;overflow:auto;width:100%}.markdown table th{font-weight:600}.markdown table td,.markdown table th{border:1px solid var(--markdown-table-border-color);padding:6px 13px}.markdown table tr{border-top:1px solid var(--markdown-table-border-color)}.markdown table tr:nth-child(2n){background-color:var(--markdown-table-even-cell-background-color)}.markdown img{background-color:transparent;box-sizing:initial;display:block;margin:0 auto;max-width:100%}.markdown img[align=right]{padding-left:20px}.markdown img[align=left]{padding-right:20px}.markdown code{background-color:rgba(27,31,35,.05);border-radius:3px;font-size:85%;margin:0;padding:.2em .4em}.markdown pre{word-wrap:normal}.markdown pre>code{background:transparent;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown .highlight{margin-bottom:16px}.markdown .highlight pre{margin-bottom:0;word-break:normal}.markdown .highlight pre,.markdown pre{background-color:#f6f8fa;border-radius:3px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}.markdown pre code{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown .commit-tease-sha{color:#444d56;display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%}.markdown .full-commit .btn-outline:not(:disabled):hover{border-color:#005cc5;color:#005cc5}.markdown .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown .blob-num{color:rgba(27,31,35,.3);cursor:pointer;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;min-width:50px;padding-left:10px;padding-right:10px;text-align:right;-webkit-user-select:none;user-select:none;vertical-align:top;white-space:nowrap;width:1%}.markdown .blob-num:hover{color:rgba(27,31,35,.6)}.markdown .blob-num:before{content:attr(data-line-number)}.markdown .blob-code{line-height:20px;padding-left:10px;padding-right:10px;position:relative;vertical-align:top}.markdown .blob-code-inner{word-wrap:normal;color:#24292e;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;overflow:visible;white-space:pre}.markdown .pl-token.active,.markdown .pl-token:hover{background:#ffea7f;cursor:pointer}.markdown .tab-size[data-tab-size="1"]{-o-tab-size:1;tab-size:1}.markdown .tab-size[data-tab-size="2"]{-o-tab-size:2;tab-size:2}.markdown .tab-size[data-tab-size="3"]{-o-tab-size:3;tab-size:3}.markdown .tab-size[data-tab-size="4"]{-o-tab-size:4;tab-size:4}.markdown .tab-size[data-tab-size="5"]{-o-tab-size:5;tab-size:5}.markdown .tab-size[data-tab-size="6"]{-o-tab-size:6;tab-size:6}.markdown .tab-size[data-tab-size="7"]{-o-tab-size:7;tab-size:7}.markdown .tab-size[data-tab-size="8"]{-o-tab-size:8;tab-size:8}.markdown .tab-size[data-tab-size="9"]{-o-tab-size:9;tab-size:9}.markdown .tab-size[data-tab-size="10"]{-o-tab-size:10;tab-size:10}.markdown .tab-size[data-tab-size="11"]{-o-tab-size:11;tab-size:11}.markdown .tab-size[data-tab-size="12"]{-o-tab-size:12;tab-size:12}.markdown .task-list-item{list-style-type:none}.markdown .task-list-item+.task-list-item{margin-top:3px}.markdown .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown .table-of-contents{align-items:flex-start;display:flex;flex-direction:column;justify-content:center;position:fixed;right:0;top:75px;width:340px}@media(max-width:1300px){.markdown .table-of-contents{display:none}}.markdown .table-of-contents ul{cursor:pointer;list-style-type:none}.markdown .table-of-contents ul li a{border-bottom:none;color:var(--secondary-text-color);font-size:14px;height:30px;padding:6px 2px;width:100%}.markdown .table-of-contents ul p{margin:0}.markdown .gatsby-resp-image-wrapper{display:flex!important;justify-content:center!important;max-height:560px!important;width:100%!important}.markdown .gatsby-resp-image-wrapper img{height:auto!important;max-height:560px!important;max-width:100%!important;position:relative!important;width:auto!important}.markdown .gatsby-resp-image-wrapper+em{color:#6a737d;display:block;font-size:15px;font-style:italic;text-align:center}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.post-content{margin-bottom:20px;width:100%}.category-page-header-wrapper,.post-content{display:flex;flex-direction:column;justify-content:center}.category-page-header-wrapper{align-items:center;margin-bottom:30px;margin-top:30px}.category-page-header-wrapper .category-page-title{border-bottom:3px solid var(--primary-text-color);font-size:40px;font-weight:700;margin-bottom:15px;padding-bottom:7px;text-align:center;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.category-page-header-wrapper .category-page-subtitle{font-size:20px;font-weight:500;padding-bottom:10px;text-align:center}.post-card-wrapper{display:flex;justify-content:center;min-height:150px;width:100%}.post-card-wrapper .post-card{border:1px solid var(--post-card-border-color);border-radius:6px;color:var(--primary-text-color);cursor:pointer;display:flex;flex-direction:column;height:100%;margin-bottom:15px;max-width:720px;padding:15px;transition:-webkit-transform .2s;transition:transform .2s;transition:transform .2s,-webkit-transform .2s;width:100%}.post-card-wrapper .post-card:hover .title{text-decoration:underline}@media(min-width:768px){.post-card-wrapper .post-card{margin-bottom:0}}.post-card-wrapper .post-card .title{font-size:18px;font-weight:600;line-height:1.4;margin-bottom:7px}.post-card-wrapper .post-card .description{-webkit-line-clamp:3;-webkit-box-orient:vertical;color:var(--primary-text-color);display:-webkit-box;font-size:13px;line-height:20px;margin-bottom:10px;overflow:hidden;text-overflow:ellipsis}.post-card-wrapper .post-card .info{color:var(--about-link-icon-color);display:flex;font-size:14px;justify-content:space-between;margin-top:auto}.post-card-wrapper .post-card .info .categories{display:flex}.post-card-wrapper .post-card .info .categories .category{margin-left:4px}.post-card-wrapper .post-card .info .categories .category:hover{text-decoration:underline}.post-card-column-wrapper{display:flex;justify-content:center;width:100%}.post-card-column-wrapper .post-card-column{align-items:center;display:flex;flex-direction:column}.post-card-column-wrapper .post-card-column .post-card-wrapper{margin-bottom:10px}.post-card-column-wrapper .post-card-column .more-post-card-button{background-color:var(--button-background-color);font-size:15px;font-weight:500;height:40px}.post-tabs-wrapper{align-self:flex-start;display:flex;flex-direction:column;justify-content:center;top:0;width:100%}.post-tabs-wrapper .post-tabs{display:flex;height:40px;justify-content:center;margin-bottom:12px;max-width:760px;width:100%}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTab-root{color:var(--tab-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:17px;font-weight:500;height:40px;min-height:auto;min-width:auto;padding:10px 12px;transition:all .2s ease}.post-tabs-wrapper .post-tabs .mui-tabs .Mui-selected,.post-tabs-wrapper .post-tabs .mui-tabs .MuiTab-root :hover{color:var(--tab-hover-text-color);transition:all .2s ease}.post-tabs-wrapper .post-tabs .mui-tabs .Mui-selected{background-color:var(--tab-selected-background-color);border-radius:8px;font-weight:600}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabScrollButton-root{height:40px;width:20px}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabs-scrollable{height:40px}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabs-indicator{display:none}</style><meta name="generator" content="Gatsby 3.14.6"/><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css-global 1prfaxn">@-webkit-keyframes mui-auto-fill{from{display:block;}}@keyframes mui-auto-fill{from{display:block;}}@-webkit-keyframes mui-auto-fill-cancel{from{display:block;}}@keyframes mui-auto-fill-cancel{from{display:block;}}</style><style data-emotion="css 1l6di18 feqhe6 1yf1g2m mnn31 vubbuv 1yxmbwk 6flbmm">.css-1l6di18.Mui-focused .MuiAutocomplete-clearIndicator{visibility:visible;}@media (pointer: fine){.css-1l6di18:hover .MuiAutocomplete-clearIndicator{visibility:visible;}}.css-1l6di18 .MuiAutocomplete-tag{margin:3px;max-width:calc(100% - 6px);}.css-1l6di18 .MuiAutocomplete-inputRoot{-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.MuiAutocomplete-hasPopupIcon.css-1l6di18 .MuiAutocomplete-inputRoot,.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiAutocomplete-inputRoot{padding-right:30px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiAutocomplete-inputRoot{padding-right:56px;}.css-1l6di18 .MuiAutocomplete-inputRoot .MuiAutocomplete-input{width:0;min-width:30px;}.css-1l6di18 .MuiInput-root{padding-bottom:1px;}.css-1l6di18 .MuiInput-root .MuiInput-input{padding:4px 4px 4px 0px;}.css-1l6di18 .MuiInput-root.MuiInputBase-sizeSmall .MuiInput-input{padding:2px 4px 3px 0;}.css-1l6di18 .MuiOutlinedInput-root{padding:9px;}.MuiAutocomplete-hasPopupIcon.css-1l6di18 .MuiOutlinedInput-root,.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiOutlinedInput-root{padding-right:39px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiOutlinedInput-root{padding-right:65px;}.css-1l6di18 .MuiOutlinedInput-root .MuiAutocomplete-input{padding:7.5px 4px 7.5px 6px;}.css-1l6di18 .MuiOutlinedInput-root .MuiAutocomplete-endAdornment{right:9px;}.css-1l6di18 .MuiOutlinedInput-root.MuiInputBase-sizeSmall{padding:6px;}.css-1l6di18 .MuiOutlinedInput-root.MuiInputBase-sizeSmall .MuiAutocomplete-input{padding:2.5px 4px 2.5px 6px;}.css-1l6di18 .MuiFilledInput-root{padding-top:19px;padding-left:8px;}.MuiAutocomplete-hasPopupIcon.css-1l6di18 .MuiFilledInput-root,.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiFilledInput-root{padding-right:39px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiFilledInput-root{padding-right:65px;}.css-1l6di18 .MuiFilledInput-root .MuiFilledInput-input{padding:7px 4px;}.css-1l6di18 .MuiFilledInput-root .MuiAutocomplete-endAdornment{right:9px;}.css-1l6di18 .MuiFilledInput-root.MuiInputBase-sizeSmall{padding-bottom:1px;}.css-1l6di18 .MuiFilledInput-root.MuiInputBase-sizeSmall .MuiFilledInput-input{padding:2.5px 4px;}.css-1l6di18 .MuiInputBase-hiddenLabel{padding-top:8px;}.css-1l6di18 .MuiAutocomplete-input{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;opacity:1;}.css-feqhe6{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;min-width:0;padding:0;margin:0;border:0;vertical-align:top;width:100%;}.css-1yf1g2m{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.4375em;letter-spacing:0.00938em;color:rgba(0, 0, 0, 0.87);box-sizing:border-box;position:relative;cursor:text;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;position:relative;}.css-1yf1g2m.Mui-disabled{color:rgba(0, 0, 0, 0.38);cursor:default;}label+.css-1yf1g2m{margin-top:16px;}.css-1yf1g2m:after{border-bottom:2px solid #1976d2;left:0;bottom:0;content:"";position:absolute;right:0;-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);-webkit-transition:-webkit-transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;transition:transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;pointer-events:none;}.css-1yf1g2m.Mui-focused:after{-webkit-transform:scaleX(1) translateX(0);-moz-transform:scaleX(1) translateX(0);-ms-transform:scaleX(1) translateX(0);transform:scaleX(1) translateX(0);}.css-1yf1g2m.Mui-error:after{border-bottom-color:#d32f2f;-webkit-transform:scaleX(1);-moz-transform:scaleX(1);-ms-transform:scaleX(1);transform:scaleX(1);}.css-1yf1g2m:before{border-bottom:1px solid rgba(0, 0, 0, 0.42);left:0;bottom:0;content:"\00a0";position:absolute;right:0;-webkit-transition:border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;pointer-events:none;}.css-1yf1g2m:hover:not(.Mui-disabled):before{border-bottom:2px solid rgba(0, 0, 0, 0.87);}@media (hover: none){.css-1yf1g2m:hover:not(.Mui-disabled):before{border-bottom:1px solid rgba(0, 0, 0, 0.42);}}.css-1yf1g2m.Mui-disabled:before{border-bottom-style:dotted;}.css-mnn31{font:inherit;letter-spacing:inherit;color:currentColor;padding:4px 0 5px;border:0;box-sizing:content-box;background:none;height:1.4375em;margin:0;-webkit-tap-highlight-color:transparent;display:block;min-width:0;width:100%;-webkit-animation-name:mui-auto-fill-cancel;animation-name:mui-auto-fill-cancel;-webkit-animation-duration:10ms;animation-duration:10ms;}.css-mnn31::-webkit-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31::-moz-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31:-ms-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31::-ms-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31:focus{outline:0;}.css-mnn31:invalid{box-shadow:none;}.css-mnn31::-webkit-search-decoration{-webkit-appearance:none;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-webkit-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-moz-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:-ms-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-ms-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-webkit-input-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-moz-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus:-ms-input-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-ms-input-placeholder{opacity:0.42;}.css-mnn31.Mui-disabled{opacity:1;-webkit-text-fill-color:rgba(0, 0, 0, 0.38);}.css-mnn31:-webkit-autofill{-webkit-animation-duration:5000s;animation-duration:5000s;-webkit-animation-name:mui-auto-fill;animation-name:mui-auto-fill;}.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}.css-1yxmbwk{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1yxmbwk::-moz-focus-inner{border-style:none;}.css-1yxmbwk.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1yxmbwk{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1yxmbwk:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1yxmbwk:hover{background-color:transparent;}}.css-1yxmbwk.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}.css-6flbmm{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:2.1875rem;}</style><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-1H8JDW20BR',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-1H8JDW20BR', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="icon" href="/favicon-32x32.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=27ef31ca9d93d04a8a91b1ea72ecbc4b"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><title data-react-helmet="true">UniswapV2 Smart Contract</title><meta data-react-helmet="true" name="viewport" content="initial-scale=1, width=device-width"/><meta data-react-helmet="true" property="og:title" content="UniswapV2 Smart Contract"/><meta data-react-helmet="true" property="og:site_title" content="UniswapV2 Smart Contract"/><meta data-react-helmet="true" name="description" content="Overview How it works at the uniswap code level uniswap code structure method uniswap contract Core Contract: Pair Core Contract: Factory Periphery Contract: Router Core Contract SingleTone Factory, consists of several pairs where Factory is responsible for creation and indexing. Contracts with a smaller surface area are easier to reason about, more prone to bugs, and functionally better. This means that many desired properties of the system can be asserted directly in code, leaving little room…"/><meta data-react-helmet="true" property="og:description" content="Overview How it works at the uniswap code level uniswap code structure method uniswap contract Core Contract: Pair Core Contract: Factory Periphery Contract: Router Core Contract SingleTone Factory, consists of several pairs where Factory is responsible for creation and indexing. Contracts with a smaller surface area are easier to reason about, more prone to bugs, and functionally better. This means that many desired properties of the system can be asserted directly in code, leaving little room…"/><meta data-react-helmet="true" property="og:author" content="Zer0Luck"/><meta data-react-helmet="true" property="og:image" content="/og-image.png"/><meta data-react-helmet="true" property="og:type" content="website"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.woff2"/><style>@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxM.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc-.woff) format("woff")}</style><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link as="script" rel="preload" href="/webpack-runtime-21c37c0047ec80635d32.js"/><link as="script" rel="preload" href="/framework-98bc37d489de49fb3b96.js"/><link as="script" rel="preload" href="/app-7897b1f0db63ccdad229.js"/><link as="script" rel="preload" href="/f9d3028dbef90a6e9b8db85387d63dd9f4edf538-7d0583450b37cf198871.js"/><link as="script" rel="preload" href="/component---src-templates-blog-template-js-484a59d2475d768e59bb.js"/><link as="fetch" rel="preload" href="/page-data/uniswap-contract/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1073350324.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1956554647.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2938748437.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="page-wrapper"><header class="page-header-wrapper"><div class="page-header"><div class="front-section"><a class="link" href="/">Zer0Luck</a></div><div class="trailing-section"><a class="link" href="/about">about</a><a class="link" href="/posts">posts</a><div class="MuiAutocomplete-root MuiAutocomplete-hasPopupIcon css-1l6di18"><div class="search-input-wrapper"><div class="MuiFormControl-root MuiFormControl-fullWidth MuiTextField-root search-input css-feqhe6"><div class="MuiInputBase-root MuiInput-root MuiInput-underline MuiInputBase-colorPrimary MuiInputBase-fullWidth MuiInputBase-formControl MuiInputBase-adornedEnd MuiAutocomplete-inputRoot css-1yf1g2m"><input type="text" aria-invalid="false" autoComplete="off" value="" class="MuiInputBase-input MuiInput-input MuiInputBase-inputAdornedEnd MuiAutocomplete-input MuiAutocomplete-inputFocused css-mnn31" aria-autocomplete="list" aria-expanded="false" autoCapitalize="none" spellcheck="false" role="combobox"/><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium search-icon css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="SearchOutlinedIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></div></div></div></div></div></div></header><main class="page-content"><header class="post-header"><div class="emoji">🦄</div><div class="info"><div class="categories"><a class="category" href="/posts/Blockchain">Blockchain</a></div></div><h1 class="title">UniswapV2 Smart Contract</h1><div class="info"><div class="author">posted by <strong>Zer0Luck</strong>,</div> <!-- -->August 03, 2022</div></header><div class="post-content"><div class="markdown"><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACD0lEQVQoz6WSTU8TURiFX2baoZCgtTNTWootaYrId2oFCqnVVKGgo01EEkkqghChJGKI3xqjRhcqhoValK0fG1nrwvg7/AHGhSv/wmNmmNbCxoWLk3vuve97ct4PqfM0I2oQ+9Q8YRTnbiBaCFFjBDvPUXq5wZnJ44g0ImKieN0ctdnJq4VUiRp0BFt8cSISI5vMYU0XMbovMHFji+WNT5Q3V+lqj1VFd4s5OhV3FVEbwfoY4/4U86kp9gQiSH2SI9YVvq2VWBkeQET/t6DiwuMNOQ6GW6Pkox00RdKINJFojXD5RB9f7k1hBLZd2rF2ruoJua0Kbpe8TXREcSF7McJRJqwhRIQ64xCJ3EVEAjQl+tD8UUT2IXUBRDUR8TvcdWjSoEXINY+QMYcYDWU4Ghjk9MFTvHu7xa3SXW4O3WdxYZNrhRJj+ghZI82AnsJqOYbZGOdOx3kG9cOuGcVAb2ij3L/Ei955nvXM8TP/ig/JFcqjj/m48J4fuXVmowW+Zh/w29rkafcs670LfM+tMR7O8mu8zJOuGdepU7LJw84ir/sXGQtleNRZZLV9kpn9eU4aGT6nb5MxB1mOF3jTv8R0NM/VxFme98xxqc3i+oEp/L5YbQ9Np7GaN+xO2kQ8QVRvyGm8T4s4b5XY6gAUHc3bgl2ljR1TrqzM7hXa8a7+/atshs2VGi61Af+DirE/j440DqQledwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Uniswap"
        title="Uniswap"
        src="/static/8ca6b7eb5abaef56c52f9e1fa3eccc97/37523/uniswap-1.png"
        srcset="/static/8ca6b7eb5abaef56c52f9e1fa3eccc97/e9ff0/uniswap-1.png 180w,
/static/8ca6b7eb5abaef56c52f9e1fa3eccc97/f21e7/uniswap-1.png 360w,
/static/8ca6b7eb5abaef56c52f9e1fa3eccc97/37523/uniswap-1.png 720w,
/static/8ca6b7eb5abaef56c52f9e1fa3eccc97/302a4/uniswap-1.png 1080w,
/static/8ca6b7eb5abaef56c52f9e1fa3eccc97/07a9c/uniswap-1.png 1440w,
/static/8ca6b7eb5abaef56c52f9e1fa3eccc97/29114/uniswap-1.png 1920w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<h1 id="overview" style="position:relative;"><a href="#overview" aria-label="overview permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h1>
<ul>
<li>How it works at the uniswap code level</li>
<li>uniswap code structure method</li>
<li>uniswap contract
<ul>
<li>Core Contract: Pair</li>
<li>Core Contract: Factory</li>
<li>Periphery Contract: Router</li>
</ul>
</li>
</ul>
<h1 id="core-contract" style="position:relative;"><a href="#core-contract" aria-label="core contract permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Core Contract</h1>
<ul>
<li>SingleTone Factory, consists of several pairs where Factory is responsible for creation and indexing.</li>
<li>Contracts with a smaller surface area are easier to reason about, more prone to bugs, and functionally better.</li>
</ul>
<p>This means that many desired properties of the system can be asserted directly in code, leaving little room for error.</p>
<ul>
<li>Core Contract is somewhat unfriendly</li>
<li>In practice, interacting directly with these contracts is discouraged in most use cases.</li>
</ul>
<p><a href="https://github.com/Uniswap/v2-core">https://github.com/Uniswap/v2-core</a></p>
<h1 id="factory-contract" style="position:relative;"><a href="#factory-contract" aria-label="factory contract permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Factory Contract</h1>
<ul>
<li>Holds the generic bytecode that powers the factory pair.</li>
<li>The main task is to create only one smart contract per unique token pair.</li>
<li>Logic to control protocol power is also included.</li>
</ul>
<p><a href="https://docs.uniswap.org/protocol/V2/reference/smart-contracts/factory">https://docs.uniswap.org/protocol/V2/reference/smart-contracts/factory</a></p>
<h1 id="pairs-contract" style="position:relative;"><a href="#pairs-contract" aria-label="pairs contract permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pairs Contract</h1>
<ul>
<li>Acts as an AMM and keeps track of pool token balances</li>
<li>Exposes data that can be used to build a Decentralized Price Oracle.</li>
</ul>
<p><a href="https://docs.uniswap.org/protocol/V2/reference/smart-contracts/pair">https://docs.uniswap.org/protocol/V2/reference/smart-contracts/pair</a></p>
<p><a href="https://docs.uniswap.org/protocol/V2/reference/smart-contracts/pair-erc-20">https://docs.uniswap.org/protocol/V2/reference/smart-contracts/pair-erc-20</a></p>
<h1 id="periphery-contract" style="position:relative;"><a href="#periphery-contract" aria-label="periphery contract permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Periphery Contract</h1>
<ul>
<li>A set of smart contracts designed to support core and domain-specific interactions</li>
<li>Due to the permissionless nature of Uniswap, each contract has no specific authority and is actually only a part of possible peripheral-like contracts.</li>
<li>Safe and efficient interaction.</li>
</ul>
<p><a href="https://github.com/Uniswap/uniswap-v2-periphery">https://github.com/Uniswap/uniswap-v2-periphery</a></p>
<h1 id="library-contract" style="position:relative;"><a href="#library-contract" aria-label="library contract permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Library Contract</h1>
<ul>
<li>The library provides various convenient functions for data import and pricing.</li>
</ul>
<p><a href="https://docs.uniswap.org/protocol/V2/reference/smart-contracts/library">https://docs.uniswap.org/protocol/V2/reference/smart-contracts/library</a></p>
<h1 id="router-contract" style="position:relative;"><a href="#router-contract" aria-label="router contract permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Router Contract</h1>
<ul>
<li>The router using the library fully supports all the basic requirements of the front-end to provide transaction and liquidity management functions.</li>
<li>In particular, it basically supports multi-pair trades (e.g x to y to z), treats ETH as a first-class citizen, and provides meta-trading to eliminate liquidity.</li>
</ul>
<p><a href="https://docs.uniswap.org/protocol/V2/reference/smart-contracts/router-02">https://docs.uniswap.org/protocol/V2/reference/smart-contracts/router-02</a></p>
<h2 id="uniswap-code-level" style="position:relative;"><a href="#uniswap-code-level" aria-label="uniswap code level permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Uniswap Code Level</h2>
<ul>
<li>The whole purpose of Uniswap is to enable the exchange of one ERC20 token for another token.</li>
<li>For example, if you need tokenA but only have tokenB, you can use Uniswap to sell tokenB and get tokenA in return, all done in an automatic and decentralized way</li>
</ul>
<h3 id="two-models-of-exchange-way" style="position:relative;"><a href="#two-models-of-exchange-way" aria-label="two models of exchange way permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Two models of exchange way</h3>
<ul>
<li>Order Book Model
<ul>
<li>Buyers and sellers place orders</li>
<li>Centralized system matches buy orders with sell orders, how traditional stock exchanges work</li>
</ul>
</li>
<li>Automated Market Makers (AMM)
<ul>
<li>There is no centralized financial execution method, and there are people who offer both tokens, which are called liquidity providers.</li>
<li>This liquidity provider uses each token to create a token pool, where traders can come and etch the tokens they want to swap and receive the tokens in return.</li>
<li>It is done automatically without a centralized entity, and traders pay a small percentage of fees for transactions going to liquidity providers for services.</li>
</ul>
</li>
<li>In the previous chapter, Uniswap uses AMM technology and explains each technology.</li>
</ul>
<h2 id="uniswap-code-component" style="position:relative;"><a href="#uniswap-code-component" aria-label="uniswap code component permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Uniswap Code Component</h2>
<ul>
<li>Uniswap has a total of 4 smart contracts. It is divided into (Core, Periphery).</li>
<li>Core Contract
<ul>
<li>Storing funds (tokens) and exposing functions for token exchange, fund addition, rewards, etc.</li>
</ul>
</li>
<li>Periphery
<ul>
<li>Added convenience for interaction and development with Core Contract.</li>
</ul>
</li>
</ul>
<h3 id="core-contract-1" style="position:relative;"><a href="#core-contract-1" aria-label="core contract 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Core Contract</h3>
<ul>
<li>Pair (swapping, miniting, burning functions)
<ul>
<li>Generated for every exchange pair.</li>
</ul>
</li>
<li>Factory (Creates and keeps track of Pairs)
<ul>
<li>Create all pair contracts and proceed with tracking.</li>
</ul>
</li>
<li>ERC20 (Stores “ownerShip” tokens for the pool)
<ul>
<li>To track the Pool Owner</li>
<li>Treat the Pool as property and obtain “Pool Ownership Tokens” in return when liquidity providers provide funds to the pool</li>
<li>If you own these ownership tokens, you can get rewards. (By the trader paying a small percentage for each trade)</li>
<li>When the liquidity provider wants the funds returned, resubmit the ownership token and return the funds + accumulated rewards.</li>
<li>The ERC20 contract tracks ownership tokens.</li>
</ul>
</li>
</ul>
<h2 id="periphery-contract-1" style="position:relative;"><a href="#periphery-contract-1" aria-label="periphery contract 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Periphery Contract</h2>
<ul>
<li>Consists of only one smart contract.</li>
<li>Router(Interacts with the core)
<ul>
<li>Provides functions such as <code class="language-text">swapExactETHForTokens</code> and <code class="language-text">swapETHForEactTokens</code> to interact with the Core Contract</li>
</ul>
</li>
</ul>
<h1 id="uniswap-features" style="position:relative;"><a href="#uniswap-features" aria-label="uniswap features permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Uniswap Features</h1>
<ul>
<li>Liquidity provider
<ul>
<li>Deposit more funds and withdraw funds with rewards.</li>
</ul>
</li>
<li>Trader
<ul>
<li>Exchange each pool and funds.</li>
</ul>
</li>
<li>Pool Ownership Token Management
<ul>
<li>Address management of the owner deposited in the pool and tracking function for fund management, etc.</li>
</ul>
</li>
<li>Protocol fee
<ul>
<li>Uniswap V2 introduces convertible protocol fees.</li>
<li>This protocol fee is turned off, but you can enable it later through settings.</li>
<li>If enabled, traders pay the same transaction fee, but 1/6 of this fee goes to uniswap and the remaining 5/6 goes to liquidity providers as a reward for providing funds.</li>
</ul>
</li>
<li>Money management</li>
<li>Oracle price
<ul>
<li>Track token prices against each other</li>
<li>Can be used as Oracle Price for other smart contracts in the Ethereum ecosystem.</li>
<li>Due to arbitrage, Uniswap Price tends to closely follow the token’s actual starting price. Therefore, Uniswap Price Oracle is an approximation to the actual price.</li>
</ul>
</li>
</ul>
<hr>
<h1 id="uniswap-contract" style="position:relative;"><a href="#uniswap-contract" aria-label="uniswap contract permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Uniswap Contract</h1>
<h2 id="core-contract-pair" style="position:relative;"><a href="#core-contract-pair" aria-label="core contract pair permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Core. Contract (Pair)</h2>
<ul>
<li>It implements the exchange between each token pair. Here is the full code snippet.</li>
</ul>
<p><a href="https://github.com/Uniswap/v2-core/blob/master/contracts/UniswapV2Pair.sol">https://github.com/Uniswap/v2-core/blob/master/contracts/UniswapV2Pair.sol</a></p>
<h3 id="contract-init--state-variable" style="position:relative;"><a href="#contract-init--state-variable" aria-label="contract init  state variable permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contract Init &#x26;&#x26; State Variable</h3>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">contract</span> <span class="token class-name">UniswapV2Pair</span> <span class="token keyword">is</span> IUniswapV2Pair<span class="token punctuation">,</span> UniswapV2ERC20 <span class="token punctuation">{</span>
  <span class="token keyword">using</span> <span class="token class-name">SafeMath</span>  <span class="token keyword">for</span> <span class="token builtin">uint</span><span class="token punctuation">;</span>
  <span class="token keyword">using</span> <span class="token class-name">UQ112x112</span> <span class="token keyword">for</span> <span class="token builtin">uint224</span><span class="token punctuation">;</span>

  <span class="token builtin">uint</span> <span class="token keyword">public</span> <span class="token keyword">constant</span> MINIMUM_LIQUIDITY <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token builtin">bytes4</span> <span class="token keyword">private</span> <span class="token keyword">constant</span> SELECTOR <span class="token operator">=</span> <span class="token builtin">bytes4</span><span class="token punctuation">(</span><span class="token function">keccak256</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">'transfer(address,uint256)'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token builtin">address</span> <span class="token keyword">public</span> factory<span class="token punctuation">;</span>
  <span class="token builtin">address</span> <span class="token keyword">public</span> token0<span class="token punctuation">;</span>
  <span class="token builtin">address</span> <span class="token keyword">public</span> token1<span class="token punctuation">;</span>

  <span class="token builtin">uint112</span> <span class="token keyword">private</span> reserve0<span class="token punctuation">;</span>           <span class="token comment">// uses single storage slot, accessible via getReserves</span>
  <span class="token builtin">uint112</span> <span class="token keyword">private</span> reserve1<span class="token punctuation">;</span>           <span class="token comment">// uses single storage slot, accessible via getReserves</span>
  <span class="token builtin">uint32</span>  <span class="token keyword">private</span> blockTimestampLast<span class="token punctuation">;</span> <span class="token comment">// uses single storage slot, accessible via getReserves</span>

  <span class="token builtin">uint</span> <span class="token keyword">public</span> price0CumulativeLast<span class="token punctuation">;</span>
  <span class="token builtin">uint</span> <span class="token keyword">public</span> price1CumulativeLast<span class="token punctuation">;</span>
  <span class="token builtin">uint</span> <span class="token keyword">public</span> kLast<span class="token punctuation">;</span> <span class="token comment">// reserve0 * reserve1, as of immediately after the most recent liquidity event</span>

  <span class="token builtin">uint</span> <span class="token keyword">private</span> unlocked <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">modifier</span> <span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">require</span><span class="token punctuation">(</span>unlocked <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'UniswapV2: LOCKED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      unlocked <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">_</span><span class="token punctuation">;</span>
      unlocked <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>It relies on the <code class="language-text">IUniswapV2Pair, UniswapV2ERC20</code> contract, and the function implementation for each interface must be carried out.</li>
<li>The <code class="language-text">UniswapV2ERC20</code> Contract manages the full ownership token.</li>
</ul>
<h3 id="vaults-managerment-features" style="position:relative;"><a href="#vaults-managerment-features" aria-label="vaults managerment features permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Vaults Managerment features</h3>
<ul>
<li>Exchange between token pairs such as Uniswap Pair tokenA and tokenB.</li>
<li>These tokens are indicated as <code class="language-text">token0</code> in the contract and are the address of the ERC20 Smart Contract to implement <code class="language-text">token1</code>.</li>
<li><code class="language-text">reserve0 ~ 1</code> state variables store the amount of tokens in the pair.</li>
</ul>
<h3 id="how-to-store-tokens" style="position:relative;"><a href="#how-to-store-tokens" aria-label="how to store tokens permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to store tokens?</h3>
<ul>
<li>It is performed in the ERC20 contract of the token itself, not in the pair contract.</li>
<li>Pair Contract tracks the reserve, and from the point of view of ERC20, it is just a general user who can send and receive Pair Contract Tokens, and has its own balance.</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2UlEQVQoz0WSbUyVZRjHr/PKOZznnPOcl+ccPC/47Jx4GRAnT2mk64VEjEpjYylWUG7OqOVx6dQZpLYIhlCNqMFEXG+rzTWXbgYMYqCTChp1WMygNv2gfHBtzk99/LXzQPjhv933de3+Xdf1v24Ryef5Ha/x5+Idsuev82Vrln2PXiGVfBGvpqOFywiESogVpnCrCZzKevLd9+Xy6NidMcQSwmQNIyIOXnr1ALdv/Mv8jzeY/e4mVY804bAncSpxnEohdmeUcKQcry9p3P+H5c5efxJ/sBgxBe8Da3dkuDB6l76hX/l+8h7xB6rIdS6WMGIOIWYNry+BLS+CmDTjsSGzhs0RRQ0UGbBVoIv0lr10nLvF2x3TnPh0kYL4ZkR8mG0FxigiCnZ3ApHgWtzIiQ8RFZsjQo6zCvQbCU/BBpRQivxgBSJuTNaVzuzOOG+92cZHJ9p5v62L0vKn1kCpDTV0dw3S+/HntLS0rhRR1RL2PJthV83r7N72Bq/UHaDuiebVDlQi+kauz/zO7TYPd8f62HfwNCJ5hg4f7eKf5Xtkp2dZWFjGrSaRp7c0sjwJl/uznO+9ys/f3OK3i3dwKjoiHmLr02Sn5xj57BhLV8fY39K64q84OXTsFEt/LTIxOsxsdh6PP4lU6M107/2bDxqmGNiZ5ezLE1zYfQ1PXtIYXV9XwvxgL8Mf9rD01Rky9Q1GPOfr4Xd2MbfUww9TJ/nlj058mo74lVq2VnxN40NfcLxsmszGAd6t7CfoLcXmihHSivn2yCHGT77HT6c7ee6xasyOKCZLlPqGrYyPnWJ8pJ1zQxmsjpxNlgAepRI9Wk0sXEVlYjtFic2EY+VE4ynC0XIe1jM0bbpEpuYKwUAahxIj3xNHdaV5puQTDlbPUPdgh2GRGKs2+xGzilj8iMmLsXmztvbnfK40ulZH8boXsOcVIhJATAGs1jgR35MUFdQT0x5HLEH+A0Yug+z7ZAXXAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Uniswap-reserve-token-flow.png"
        title="Uniswap-reserve-token-flow.png"
        src="/static/9266aa22d881d0f993a55ebf7adfe11d/37523/Uniswap-reserve-token-flow.png"
        srcset="/static/9266aa22d881d0f993a55ebf7adfe11d/e9ff0/Uniswap-reserve-token-flow.png 180w,
/static/9266aa22d881d0f993a55ebf7adfe11d/f21e7/Uniswap-reserve-token-flow.png 360w,
/static/9266aa22d881d0f993a55ebf7adfe11d/37523/Uniswap-reserve-token-flow.png 720w,
/static/9266aa22d881d0f993a55ebf7adfe11d/302a4/Uniswap-reserve-token-flow.png 1080w,
/static/9266aa22d881d0f993a55ebf7adfe11d/07a9c/Uniswap-reserve-token-flow.png 1440w,
/static/9266aa22d881d0f993a55ebf7adfe11d/29114/Uniswap-reserve-token-flow.png 1920w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<ul>
<li>How to manage funds in each of 3 smart contracts</li>
<li>Calls ERC20 functions such as Pair Contractdms (OwnerAddress ⇒ Pair Contract address) and manages tokens.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token comment">// .. [OMIT]</span>
<span class="token builtin">bytes4</span> <span class="token keyword">private</span> <span class="token keyword">constant</span> SELECTOR <span class="token operator">=</span> <span class="token builtin">bytes4</span><span class="token punctuation">(</span><span class="token function">keccak256</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">'transfer(address,uint256)'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// .. [OMIT]</span>

<span class="token keyword">function</span> <span class="token function">_safeTransfer</span><span class="token punctuation">(</span><span class="token builtin">address</span> token<span class="token punctuation">,</span> <span class="token builtin">address</span> to<span class="token punctuation">,</span> <span class="token builtin">uint</span> value<span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token builtin">bool</span> success<span class="token punctuation">,</span> <span class="token builtin">bytes</span> <span class="token keyword">memory</span> data<span class="token punctuation">)</span> <span class="token operator">=</span> token<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>abi<span class="token punctuation">.</span><span class="token function">encodeWithSelector</span><span class="token punctuation">(</span>SELECTOR<span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>success <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> abi<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'UniswapV2: TRANSFER_FAILED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// .. [OMIT]</span></code></pre></div>
<ul>
<li>In Pair Contract, the ERC20 function implements the function selector as follows and calls the transfer function in the raw calling format.</li>
<li>The <code class="language-text">_update</code> function is called whenever there is a new fund deposited or withdrawn by the liquidity provider or a trader swaps tokens.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">function</span> <span class="token function">_update</span><span class="token punctuation">(</span><span class="token builtin">uint</span> balance0<span class="token punctuation">,</span> <span class="token builtin">uint</span> balance1<span class="token punctuation">,</span> <span class="token builtin">uint112</span> _reserve0<span class="token punctuation">,</span> <span class="token builtin">uint112</span> _reserve1<span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token punctuation">{</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>balance0 <span class="token operator">&lt;=</span> <span class="token builtin">uint112</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> balance1 <span class="token operator">&lt;=</span> <span class="token builtin">uint112</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'UniswapV2: OVERFLOW'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint32</span> blockTimestamp <span class="token operator">=</span> <span class="token builtin">uint32</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span>timestamp <span class="token operator">%</span> <span class="token number">2</span><span class="token operator">**</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint32</span> timeElapsed <span class="token operator">=</span> blockTimestamp <span class="token operator">-</span> blockTimestampLast<span class="token punctuation">;</span> <span class="token comment">// overflow is desired</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timeElapsed <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> _reserve0 <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> _reserve1 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// * never overflows, and + overflow is desired</span>
        price0CumulativeLast <span class="token operator">+=</span> <span class="token builtin">uint</span><span class="token punctuation">(</span>UQ112x112<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>_reserve1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uqdiv</span><span class="token punctuation">(</span>_reserve0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> timeElapsed<span class="token punctuation">;</span>
        price1CumulativeLast <span class="token operator">+=</span> <span class="token builtin">uint</span><span class="token punctuation">(</span>UQ112x112<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>_reserve0<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uqdiv</span><span class="token punctuation">(</span>_reserve1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> timeElapsed<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    reserve0 <span class="token operator">=</span> <span class="token builtin">uint112</span><span class="token punctuation">(</span>balance0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    reserve1 <span class="token operator">=</span> <span class="token builtin">uint112</span><span class="token punctuation">(</span>balance1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    blockTimestampLast <span class="token operator">=</span> blockTimestamp<span class="token punctuation">;</span>
    <span class="token keyword">emit</span> <span class="token function">Sync</span><span class="token punctuation">(</span>reserve0<span class="token punctuation">,</span> reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>ERC20 The return value of <code class="language-text">balanceOf</code> function <code class="language-text">balance0, balance1</code> is the token balance of ERC20.</li>
<li>Uniswap <code class="language-text">_reserve0, _reserve1</code> previously known balance. (Confirmed with the last <code class="language-text">balanceOf</code> .)</li>
<li>Check Overflow, update Oracle Price, update <code class="language-text">reserve</code> and update event <code class="language-text">Sync</code>.</li>
<li>The difference between the <code class="language-text">_reserve0, _reserve1</code> parameters and the stored variables <code class="language-text">reserve0, reserve1</code> is essentially the same.</li>
<li>The function caller already reads the variable from storage and passes it as an argument in the <code class="language-text">_update</code> function.</li>
<li>Just a way to save gas. (Reading from Storage is more expensive than reading from Memory)</li>
<li>Uniswap is implemented in an optimized way for efficiency and gas savings, and represents a single performance point.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token builtin">uint112</span> <span class="token keyword">private</span> reserve0<span class="token punctuation">;</span>           <span class="token comment">// uses single storage slot, accessible via getReserves</span>
<span class="token builtin">uint112</span> <span class="token keyword">private</span> reserve1<span class="token punctuation">;</span>           <span class="token comment">// uses single storage slot, accessible via getReserves</span>
<span class="token builtin">uint32</span>  <span class="token keyword">private</span> blockTimestampLast<span class="token punctuation">;</span> <span class="token comment">// uses single storage slot, accessible via getReserves</span></code></pre></div>
<h3 id="mint--burn-features" style="position:relative;"><a href="#mint--burn-features" aria-label="mint  burn features permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mint , Burn Features</h3>
<ul>
<li><code class="language-text">Mint</code> is a liquidity provider adding funds to the pool and consequently a new pool ownership token is issued for the liquidity provider.</li>
<li>‘Burn’, liquidity providers withdraw funds (and accumulated rewards) and pool ownership tokens are destroyed.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token comment">// this low-level function should be called from a contract which performs important safety checks</span>
<span class="token keyword">function</span> <span class="token function">mint</span><span class="token punctuation">(</span><span class="token builtin">address</span> to<span class="token punctuation">)</span> <span class="token keyword">external</span> lock <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint</span> liquidity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token builtin">uint112</span> _reserve0<span class="token punctuation">,</span> <span class="token builtin">uint112</span> _reserve1<span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">getReserves</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// gas savings</span>
    <span class="token builtin">uint</span> balance0 <span class="token operator">=</span> <span class="token function">IERC20</span><span class="token punctuation">(</span>token0<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint</span> balance1 <span class="token operator">=</span> <span class="token function">IERC20</span><span class="token punctuation">(</span>token1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint</span> amount0 <span class="token operator">=</span> balance0<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>_reserve0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint</span> amount1 <span class="token operator">=</span> balance1<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>_reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token builtin">bool</span> feeOn <span class="token operator">=</span> <span class="token function">_mintFee</span><span class="token punctuation">(</span>_reserve0<span class="token punctuation">,</span> _reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint</span> _totalSupply <span class="token operator">=</span> totalSupply<span class="token punctuation">;</span> <span class="token comment">// gas savings, must be defined here since totalSupply can update in _mintFee</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_totalSupply <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        liquidity <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>amount0<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>amount1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>MINIMUM_LIQUIDITY<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">_mint</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MINIMUM_LIQUIDITY<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// permanently lock the first MINIMUM_LIQUIDITY tokens</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        liquidity <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>amount0<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>_totalSupply<span class="token punctuation">)</span> <span class="token operator">/</span> _reserve0<span class="token punctuation">,</span> amount1<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>_totalSupply<span class="token punctuation">)</span> <span class="token operator">/</span> _reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>liquidity <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'UniswapV2: INSUFFICIENT_LIQUIDITY_MINTED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_mint</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> liquidity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_update</span><span class="token punctuation">(</span>balance0<span class="token punctuation">,</span> balance1<span class="token punctuation">,</span> _reserve0<span class="token punctuation">,</span> _reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>feeOn<span class="token punctuation">)</span> kLast <span class="token operator">=</span> <span class="token builtin">uint</span><span class="token punctuation">(</span>reserve0<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// reserve0 and reserve1 are up-to-date</span>
    <span class="token keyword">emit</span> <span class="token function">Mint</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> amount0<span class="token punctuation">,</span> amount1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>You can check the logic to save gas. <code class="language-text">reserve0, reserve1, totalSupply</code> These values are transferred from storage to memory to be cheaper to write.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity">
<span class="token comment">//.. [OMIT]   </span>
<span class="token builtin">bool</span> feeOn <span class="token operator">=</span> <span class="token function">_mintFee</span><span class="token punctuation">(</span>_reserve0<span class="token punctuation">,</span> _reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//.. [OMIT]</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>feeOn<span class="token punctuation">)</span> kLast <span class="token operator">=</span> <span class="token builtin">uint</span><span class="token punctuation">(</span>reserve0<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// reserve0 and reserve1 are up-to-date</span></code></pre></div>
<ul>
<li>You can check the fee and fee calculation logic of the optional protocol.</li>
<li><code class="language-text">totalSupply</code> represents the total supply of pool ownership tokens, and is a variable stored in the contract.</li>
<li>The pair contract expands, so you can access the variables.</li>
<li>If <code class="language-text">totalSupply</code> is 0, it means that the pool is an entirely new <code class="language-text">MINIMIUM_LIQUIDITY</code> Pool and the amount of pool ownership tokens should be fixed to avoid dividing by zero in liquidity calculations.</li>
<li><code class="language-text">_mint(**address**(**0**), **MINIMUM_LIQUIDITY**); // permanently lock the first MINIMUM_LIQUIDITY tokens</code> Since we don’t know the private key that leads to address(0), sending funds to address(0) essentially locks the funds forever.</li>
<li>The ‘liquidity’ variable is the amount of new pool ownership tokens that must be issued to the liquidity provider, and the liquidity provider can receive a proportional amount of pool ownership tokens according to the number of new funds provided.</li>
<li>Issue a new pool ownership token to the corresponding <code class="language-text">to</code> address, the address of the liquidity provider (this uses a router that calls the function <code class="language-text">to</code> )</li>
<li>The way that adding funds works is deposited into the ERC20 contract.</li>
<li>Pair Contract refers to the balance data, compares it with the last known balance, and then executes the final logic.</li>
<li>This is a method that allows the pair contract to check the deposited balance.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token comment">// this low-level function should be called from a contract which performs important safety checks</span>
<span class="token keyword">function</span> <span class="token function">burn</span><span class="token punctuation">(</span><span class="token builtin">address</span> to<span class="token punctuation">)</span> <span class="token keyword">external</span> lock <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint</span> amount0<span class="token punctuation">,</span> <span class="token builtin">uint</span> amount1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token builtin">uint112</span> _reserve0<span class="token punctuation">,</span> <span class="token builtin">uint112</span> _reserve1<span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">getReserves</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// gas savings</span>
    <span class="token builtin">address</span> _token0 <span class="token operator">=</span> token0<span class="token punctuation">;</span>                                <span class="token comment">// gas savings</span>
    <span class="token builtin">address</span> _token1 <span class="token operator">=</span> token1<span class="token punctuation">;</span>                                <span class="token comment">// gas savings</span>
    <span class="token builtin">uint</span> balance0 <span class="token operator">=</span> <span class="token function">IERC20</span><span class="token punctuation">(</span>_token0<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint</span> balance1 <span class="token operator">=</span> <span class="token function">IERC20</span><span class="token punctuation">(</span>_token1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint</span> liquidity <span class="token operator">=</span> balanceOf<span class="token punctuation">[</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token builtin">bool</span> feeOn <span class="token operator">=</span> <span class="token function">_mintFee</span><span class="token punctuation">(</span>_reserve0<span class="token punctuation">,</span> _reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">uint</span> _totalSupply <span class="token operator">=</span> totalSupply<span class="token punctuation">;</span> <span class="token comment">// gas savings, must be defined here since totalSupply can update in _mintFee</span>
    amount0 <span class="token operator">=</span> liquidity<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>balance0<span class="token punctuation">)</span> <span class="token operator">/</span> _totalSupply<span class="token punctuation">;</span> <span class="token comment">// using balances ensures pro-rata distribution</span>
    amount1 <span class="token operator">=</span> liquidity<span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>balance1<span class="token punctuation">)</span> <span class="token operator">/</span> _totalSupply<span class="token punctuation">;</span> <span class="token comment">// using balances ensures pro-rata distribution</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>amount0 <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> amount1 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'UniswapV2: INSUFFICIENT_LIQUIDITY_BURNED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_burn</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> liquidity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_safeTransfer</span><span class="token punctuation">(</span>_token0<span class="token punctuation">,</span> to<span class="token punctuation">,</span> amount0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_safeTransfer</span><span class="token punctuation">(</span>_token1<span class="token punctuation">,</span> to<span class="token punctuation">,</span> amount1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    balance0 <span class="token operator">=</span> <span class="token function">IERC20</span><span class="token punctuation">(</span>_token0<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    balance1 <span class="token operator">=</span> <span class="token function">IERC20</span><span class="token punctuation">(</span>_token1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_update</span><span class="token punctuation">(</span>balance0<span class="token punctuation">,</span> balance1<span class="token punctuation">,</span> _reserve0<span class="token punctuation">,</span> _reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>feeOn<span class="token punctuation">)</span> kLast <span class="token operator">=</span> <span class="token builtin">uint</span><span class="token punctuation">(</span>reserve0<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mul</span><span class="token punctuation">(</span>reserve1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// reserve0 and reserve1 are up-to-date</span>
    <span class="token keyword">emit</span> <span class="token function">Burn</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> amount0<span class="token punctuation">,</span> amount1<span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>Used for deletion of liquidity pool tracking tokens issued by <code class="language-text">mint</code> function. This logic is equally used to save gas.</li>
<li>‘balance0, balance1’ total balance of tokens in pool ‘liquidity’ amount of pool ownership tokens held by the provider</li>
<li>You can check that all liquidity has been transferred to the Pair Contract by accessing the liquidity token with the balance of <code class="language-text">address(this)</code>.</li>
<li>Calculate the amount of tokens to be withdrawn to the liquidity provider in proportion to how much liquidity the liquidity provider has.</li>
<li>Burn liquidity and transfer tokens, rewards to liquidity providers are automatically withdrawn with these funds.</li>
<li>Make sure that the rewards for profits are properly accumulated and you get more than you deposit.</li>
</ul>
<h1 id="uniswap-swapper-contract-dev--event-data-query-subgraph" style="position:relative;"><a href="#uniswap-swapper-contract-dev--event-data-query-subgraph" aria-label="uniswap swapper contract dev  event data query subgraph permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Uniswap Swapper Contract Dev + Event Data Query (Subgraph)</h1>
<ul>
<li>We are going to develop a simple swap contract focusing on each contract function described above.</li>
<li>With reference to the SDK provided by Uniswap, the dependency management of contracts configured by function is carried out.</li>
<li>Finally, the Uniswap Liquidity Pool performs the swapping function for each coin, and manages the liquidity pool based on CPMM. Tokens that will be used for deposit and reserve in the pool will be swapped in the form of ETH, DAI, and UDSC by selecting a pair of ‘DAI, USDC’ ERC20 tokens placed on the Ethereum chain.</li>
<li>The overall contract is going to be distributed on the Ethereum test net, and event data collection and handling are also carried out by locally turning a subgraph node that triggers each event issued by the transaction call of the deployed contract.</li>
</ul>
<h3 id="contract-dependencies" style="position:relative;"><a href="#contract-dependencies" aria-label="contract dependencies permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contract Dependencies</h3>
<ul>
<li>Uniswap contract dependency <code class="language-text">@uniswap/sdk</code> is used as follows, and it is used as a transaction utility when writing deployment scripts and test codes.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity">yarn add @uniswap<span class="token operator">/</span>sdk</code></pre></div>
<h3 id="interface" style="position:relative;"><a href="#interface" aria-label="interface permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interface</h3>
<ul>
<li>First, we will design the contract interface to proceed with the function definition.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity">IAdapter
IAsset 
ISwapper
IUniswapV2Pair
IUniswapV2Router01
IUniswapV2Router02
IWETH</code></pre></div>
<p><strong>Interface Adapter</strong></p>
<ul>
<li>Adaptar contracts can be designed to facilitate liquidity management and multi-pair trade function management can do.</li>
<li>The core function in this contract is <code class="language-text">swapExactTokensForTokens</code> among the methods of Uniswap Router Contract. Swapping according to the specified amount is executed by referring to the instance of each token specified by <code class="language-text">path</code>.</li>
</ul>
<blockquote>
<p>IAdapter.sol ⇒ (UniswapV2Adapter.sol : swapExactInputSingle)</p>
</blockquote>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity">
<span class="token keyword">function</span> <span class="token function">swapExactInputSingle</span><span class="token punctuation">(</span>
    <span class="token builtin">uint256</span> routerId<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amountIn<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amountOut<span class="token punctuation">,</span>
    <span class="token builtin">address</span> srcToken<span class="token punctuation">,</span>
    <span class="token builtin">address</span> destToken<span class="token punctuation">,</span>
    <span class="token builtin">address</span> <span class="token keyword">from</span><span class="token punctuation">,</span>
    <span class="token builtin">address</span> to<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> deadline
<span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span> amountSwapped<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>routers<span class="token punctuation">[</span>routerId<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"ERR-01"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IUniswapV2Router02 router <span class="token operator">=</span> <span class="token function">IUniswapV2Router02</span><span class="token punctuation">(</span>routers<span class="token punctuation">[</span>routerId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IERC20 tokenToSell <span class="token operator">=</span> <span class="token function">IERC20</span><span class="token punctuation">(</span>srcToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    swapper<span class="token punctuation">.</span><span class="token function">transferFrom</span><span class="token punctuation">(</span>tokenToSell<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> amountIn<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> path <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">address</span><span class="token punctuation">(</span>srcToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">address</span><span class="token punctuation">(</span>destToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span><span class="token punctuation">(</span>tokenToSell<span class="token punctuation">.</span><span class="token function">approve</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">,</span> amountIn<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    amountSwapped <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">swapExactTokensForTokens</span><span class="token punctuation">(</span>
        amountIn<span class="token punctuation">,</span>
        amountOut<span class="token punctuation">,</span>
        path<span class="token punctuation">,</span>
        to<span class="token punctuation">,</span>
        deadline
    <span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>The operation is carried out for the token pair to be swapped, and only for each of the two token pairs. Returns the swapped amount of the swapped token pair.</li>
</ul>
<p>✅ The address value of routers[routerId] must not be 0x0, that is, a valid address must be assigned.</p>
<ul>
<li>For ERC20 token, type cast srcToken and destToken respectively and send to the destination address.</li>
<li>To proceed with the two token pairs, refer to each address address to assign a value, then refer to the address of the corresponding router to confirm whether it is usable or not, and finally proceed with swapping.</li>
</ul>
<blockquote>
<p>IAdapter.sol ⇒ (UniswapV2Adapter.sol: swapExactInput)</p>
</blockquote>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity">
<span class="token keyword">function</span> <span class="token function">swapExactInput</span><span class="token punctuation">(</span>
    <span class="token builtin">uint256</span> routerId<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amountIn<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amountOut<span class="token punctuation">,</span>
    <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> path<span class="token punctuation">,</span>
    <span class="token builtin">address</span> <span class="token keyword">from</span><span class="token punctuation">,</span>
    <span class="token builtin">address</span> to<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> deadline
<span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> amounts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>routers<span class="token punctuation">[</span>routerId<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"ERR-01"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IUniswapV2Router02 router <span class="token operator">=</span> <span class="token function">IUniswapV2Router02</span><span class="token punctuation">(</span>routers<span class="token punctuation">[</span>routerId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IERC20 tokenToSell <span class="token operator">=</span> <span class="token function">IERC20</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    swapper<span class="token punctuation">.</span><span class="token function">transferFrom</span><span class="token punctuation">(</span>tokenToSell<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> amountIn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span><span class="token punctuation">(</span>tokenToSell<span class="token punctuation">.</span><span class="token function">approve</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">,</span> amountIn<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    amounts <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">swapExactTokensForTokens</span><span class="token punctuation">(</span>
        amountIn<span class="token punctuation">,</span>
        amountOut<span class="token punctuation">,</span>
        path<span class="token punctuation">,</span>
        to<span class="token punctuation">,</span>
        deadline
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>Same function as the previous function, but supports multiple tokens to be swapped.</li>
</ul>
<blockquote>
<p>AdapterStorage.sol</p>
</blockquote>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">contract</span> <span class="token class-name">AdapterStorage</span> <span class="token keyword">is</span> Ownable <span class="token punctuation">{</span>
    <span class="token keyword">mapping</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> <span class="token operator">=></span> <span class="token builtin">address</span><span class="token punctuation">)</span> <span class="token keyword">internal</span> routers<span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">registerRouter</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> routerId<span class="token punctuation">,</span> <span class="token builtin">address</span> routerAddress<span class="token punctuation">)</span>
        <span class="token keyword">external</span>
        onlyOwner
    <span class="token punctuation">{</span>
        routers<span class="token punctuation">[</span>routerId<span class="token punctuation">]</span> <span class="token operator">=</span> routerAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>The main function of the adapter must be in charge of the uniswap router security element. The following <code class="language-text">registerRouter</code> function manages the router address for each increase in the routers mapping structure, and it should be able to allocate only each approved data in fact. did.</li>
</ul>
<h3 id="interface-asset" style="position:relative;"><a href="#interface-asset" aria-label="interface asset permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interface Asset</h3>
<ul>
<li>This contract can design ERC20 compliant token contracts or functions used to express ETH. Since it is not used in the current Uniswap Liquidity Pool Swapping function, I will only allocate it with an empty contract.</li>
</ul>
<h3 id="interface-uniswapv2pair" style="position:relative;"><a href="#interface-uniswapv2pair" aria-label="interface uniswapv2pair permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interface UniswapV2Pair</h3>
<ul>
<li>You can check the total liquidity supply of the pair and the token balance. You need to insert it into a separate function and proceed.</li>
</ul>
<p>✅ Each contract dependency must be configured based on the deployed pair contract’s address instance.</p>
<p>✅ Each asset must exist in the Pair Contract.</p>
<p>✅ Get the total supply of Pair Liquidity.</p>
<p>✅ Reserves should be sorted in the order of tokenA and tokenB.</p>
<ul>
<li>Utilize the <code class="language-text">getReserves</code> method and return the reserves of token0 and token1, which are used to set the transaction price and distribute liquidity. Returns <code class="language-text">block.timestamp(mod 2**32)</code> of the last block in which the interaction occurred for the Pair.</li>
</ul>
<h3 id="interface-weth" style="position:relative;"><a href="#interface-weth" aria-label="interface weth permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interface WETH</h3>
<ul>
<li>In order to directly transact with other altcoins outside the ERC-20 standard protocol, wrapping is required during the swapping process.</li>
<li>In order to exchange ERC-20 tokens and Ether on a decentralized platform such as Radar Relay, and since it provides direct transactions between users using Ethereum smart contracts, all users receive the same tokens for all tokens traded. standards must be maintained.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token version number">0.8.0</span><span class="token punctuation">;</span>

<span class="token keyword">library</span> <span class="token class-name">Utils</span> <span class="token punctuation">{</span>
  <span class="token keyword">enum</span> <span class="token class-name">SwapType</span> <span class="token punctuation">{</span>
      GIVEN_IN<span class="token punctuation">,</span>
      GIVEN_OUT
  <span class="token punctuation">}</span>

  <span class="token builtin">address</span> <span class="token keyword">public</span> <span class="token keyword">constant</span> WETH <span class="token operator">=</span>
      <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0xc778417E063141139Fce010982780140Aa0cD5Ab</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">address</span> <span class="token keyword">public</span> <span class="token keyword">constant</span> ETH <span class="token operator">=</span>
      <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p><a href="https://rinkeby.etherscan.io/address/0xc778417e063141139fce010982780140aa0cd5ab#code">https://rinkeby.etherscan.io/address/0xc778417e063141139fce010982780140aa0cd5ab#code</a></p>
<ul>
<li>In order to refer to the WETH9 Contract distributed on the test net and use it, I implemented one for the corresponding access purpose.</li>
</ul>
<h2 id="swapper-contract-design" style="position:relative;"><a href="#swapper-contract-design" aria-label="swapper contract design permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Swapper Contract Design</h2>
<ul>
<li>We designed the basic utility and dependency interface before, and now we will implement the code level to perform the swapping function, which is the main contract.</li>
<li>In this contract, wrapper with WETH, multi- and single-swap functions are implemented.</li>
</ul>
<h3 id="how-to-pricing-a-transaction" style="position:relative;"><a href="#how-to-pricing-a-transaction" aria-label="how to pricing a transaction permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to Pricing a Transaction</h3>
<ul>
<li>Each pair of Uniswap is actually backed by a liquidity pool.</li>
<li>A liquidity pool is a smart contract that holds the balance of two unique tokens and enforces rules related to depositing and withdrawing them, and the basic rule is the constant product formula (X * Y = K).</li>
<li>When you buy a token, you need to sell a proportionate amount to keep it constant.</li>
<li>The token rate in the pool, along with a certain product formula, ultimately determines the price at which the swap is executed.</li>
</ul>
<h3 id="how-uniswap-handles-pricing" style="position:relative;"><a href="#how-uniswap-handles-pricing" aria-label="how uniswap handles pricing permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How Uniswap Handles Pricing</h3>
<ul>
<li>In v1, a transaction is always executed at the “best” price calculated at run time, and the calculation is actually done in one of two formulas depending on whether the transaction specifies an exact input or output amount.</li>
<li>Functionally, the difference between these two functions is negligible, but the existence of the difference itself increases the conceptual complexity.</li>
<li>Initial attempts to support both features in V2 were inappropriate and decided not to offer price features in Core</li>
</ul>
<p>Instead, the pair directly checks whether the invariant is satisfied after every trade.</p>
<ul>
<li>Enforce immutability rather than relying on pricing features and V2 pairs are simple and transparent to ensure their own safety and good separation of concerns.</li>
<li>One downstream advantage is that it more naturally supports other types of trades where V2 pairs can appear.</li>
</ul>
<h3 id="price-trading" style="position:relative;"><a href="#price-trading" aria-label="price trading permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>price trading</h3>
<ul>
<li>When exchanging tokens on Uniswap, it is common to either receive as many output tokens as possible for the correct input amount or pay as few input tokens as possible for the correct output amount.</li>
<li>To calculate these amounts, the contract needs to look up the pair’s current reserve to understand what the current price is.</li>
<li>It is not safe to perform a lookup and rely on results without access to external prices.</li>
<li>Let’s say the contract naively sends 10 DAI to a DAI/WETH pair and wants to receive as much WETH as it can get given the current reserve ratio.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token operator">></span> When a <span class="token keyword">pure</span> smart <span class="token keyword">contract</span> <span class="token class-name">is</span> invoked<span class="token punctuation">,</span> simply querying the current price and executing a transaction<span class="token operator">?</span>
<span class="token operator">=></span> Vulnerable to FlashAttack and likely to suffer economic loss<span class="token punctuation">.</span>
<span class="token operator">=></span> We have to think about the malicious actor who sees <span class="token keyword">this</span> transaction before it <span class="token keyword">is</span> confirmed in the transaction<span class="token punctuation">.</span>
<span class="token operator">=></span> You can execute a swap that dramatically changes the DAI<span class="token operator">/</span>WETH price just before the naive swap<span class="token punctuation">.</span>
<span class="token operator">=></span> You can change the price back to what it was before the naive swap by waiting <span class="token keyword">for</span> the naive swap to run at a bad rate and then swapping
<span class="token operator">=></span> This attack <span class="token keyword">is</span> fairly cheap<span class="token punctuation">,</span> low risk<span class="token punctuation">,</span> and can usually be done <span class="token keyword">for</span> profit<span class="token punctuation">.</span></code></pre></div>
<ul>
<li>To prevent the above attack, it is important to submit a swap with access to information about the “fair” price at which the swap should be executed.</li>
<li>Swap must be accessible to Oracle to ensure that the best practices you can get from Uniswap are close enough to what Oracle considers the “true” price.</li>
</ul>
<p>An oracle could be as simple as an off-chain observation of a pair’s current market price.</p>
<ul>
<li>Due to arbitrage, the reserve ratio within a pair of blocks is usually close to the “true” market price.</li>
<li>Therefore, if users submit transactions with this knowledge in mind, it is possible to ensure that losses from flash loan attacks are strictly limited.</li>
<li>Logic can be safely implemented client-side, and given the observed in-block price, calculate the optimal amount of input/output and perform swap using router</li>
<li>Guarantees that the swap will run at a rate that is at least % worse than the observed in-block rate of <code class="language-text">X</code>.</li>
</ul>
<h3 id="state-variables" style="position:relative;"><a href="#state-variables" aria-label="state variables permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>State Variables</h3>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">using</span> <span class="token class-name">SafeERC20</span> <span class="token keyword">for</span> IERC20<span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token keyword">mapping</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> <span class="token operator">=></span> <span class="token builtin">address</span><span class="token punctuation">)</span> <span class="token keyword">public</span> adapters<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">SwapStep</span> <span class="token punctuation">{</span>
    <span class="token builtin">uint256</span> adapterId<span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> routerId<span class="token punctuation">;</span>
    <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> path<span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> percent<span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> amountOut<span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> deadline<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token class-name">MultiSwapParams</span> <span class="token punctuation">{</span>
    <span class="token builtin">address</span> to<span class="token punctuation">;</span>
    <span class="token builtin">address</span> srcToken<span class="token punctuation">;</span>
    <span class="token builtin">address</span> destToken<span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> amountIn<span class="token punctuation">;</span>
    SwapStep<span class="token punctuation">[</span><span class="token punctuation">]</span> swaps<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token class-name">SingleSwap</span> <span class="token punctuation">{</span>
    <span class="token builtin">uint</span> adapterId<span class="token punctuation">;</span>
    <span class="token builtin">uint</span> routerId<span class="token punctuation">;</span>
    <span class="token builtin">uint</span> amountIn<span class="token punctuation">;</span>
    <span class="token builtin">uint</span> amountOut<span class="token punctuation">;</span>
    <span class="token builtin">uint</span> deadline<span class="token punctuation">;</span>
    <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> path<span class="token punctuation">;</span>
    <span class="token builtin">address</span> to<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span></code></pre></div>
<ul>
<li>We designed the contract for adapter management earlier, but based on the increased adapterID value, we manage each adapter mapping data in the storage.</li>
<li>During Uniswap Swapping, it is important to manage data by user on storage, and in the case of <code class="language-text">SwapStep</code> structure, index information of data managed by mapping, address values of multi-tokens, balance of liquidity pool, amount of money, and swapping are important. Used to store instantaneous time in case of failure.</li>
<li><code class="language-text">MultiSwapParams</code> and <code class="language-text">SingleSwap</code> are used when implementing the <code class="language-text">SwapExactInputSingle</code> function of each Swap Contract used in the Uniswap protocol, respectively.</li>
</ul>
<h3 id="functions" style="position:relative;"><a href="#functions" aria-label="functions permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Functions</h3>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">function</span> <span class="token function">simpleSwapExactInputSingle</span><span class="token punctuation">(</span>
    <span class="token builtin">uint256</span> adapterId<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> routerId<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amountIn<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> amountOut<span class="token punctuation">,</span>
    <span class="token builtin">address</span> srcToken<span class="token punctuation">,</span>
    <span class="token builtin">address</span> destToken<span class="token punctuation">,</span>
    <span class="token builtin">address</span> to<span class="token punctuation">,</span>
    <span class="token builtin">uint256</span> deadline
<span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">payable</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span>adapters<span class="token punctuation">[</span>adapterId<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Adapter not registered"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IAdapter adapter <span class="token operator">=</span> <span class="token function">IAdapter</span><span class="token punctuation">(</span>adapters<span class="token punctuation">[</span>adapterId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">address</span> <span class="token keyword">from</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span>srcToken<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">_wrapETH</span><span class="token punctuation">(</span>amountIn<span class="token punctuation">,</span> srcToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">from</span> <span class="token operator">==</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token function">IERC20</span><span class="token punctuation">(</span>Utils<span class="token punctuation">.</span>WETH<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">approve</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span>adapter<span class="token punctuation">)</span><span class="token punctuation">,</span> amountIn<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span>
        adapter<span class="token punctuation">.</span><span class="token function">swapExactInputSingle</span><span class="token punctuation">(</span>
            routerId<span class="token punctuation">,</span>
            amountIn<span class="token punctuation">,</span>
            amountOut<span class="token punctuation">,</span>
            srcToken<span class="token punctuation">,</span>
            destToken<span class="token punctuation">,</span>
            <span class="token keyword">from</span><span class="token punctuation">,</span>
            to<span class="token punctuation">,</span>
            deadline
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>✅ The value of the adapters mapping data must be a valid address, that is, an authenticated address.</p>
<ul>
<li>If it belongs to the certified adapter contract storage, the lower router is registered.</li>
<li>Wrapping before swapping (wrapperETH contract) Using <code class="language-text">_wrapETH</code> function</li>
<li>Approval process to deliver WETH based on the information of the contract to be swapped in. At this time, the value of <code class="language-text">from</code> should be the address of the current contract instance.</li>
<li>Perform a single swap function through the <code class="language-text">swapExactInputSingle</code> Uniswap function after real user authentication and approval are completed</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">function</span> <span class="token function">multiSwapExactInput</span><span class="token punctuation">(</span>MultiSwapParams <span class="token keyword">memory</span> params<span class="token punctuation">)</span>
    <span class="token keyword">external</span>
    <span class="token keyword">payable</span>
<span class="token punctuation">{</span>
    <span class="token builtin">address</span> <span class="token keyword">from</span><span class="token punctuation">;</span>
    <span class="token builtin">address</span> to <span class="token operator">=</span> params<span class="token punctuation">.</span>to<span class="token punctuation">;</span>
    <span class="token punctuation">(</span>params<span class="token punctuation">.</span>srcToken<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">_wrapETH</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>amountIn<span class="token punctuation">,</span> params<span class="token punctuation">.</span>srcToken<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>destToken <span class="token operator">==</span> Utils<span class="token punctuation">.</span>ETH<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        to <span class="token operator">=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token builtin">uint256</span> totalAmountsOut <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> params<span class="token punctuation">.</span>swaps<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        SwapStep <span class="token keyword">memory</span> swapParams <span class="token operator">=</span> params<span class="token punctuation">.</span>swaps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">require</span><span class="token punctuation">(</span>
            adapters<span class="token punctuation">[</span>swapParams<span class="token punctuation">.</span>adapterId<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"Adapter not registered"</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token builtin">address</span> destSwapToken <span class="token operator">=</span> swapParams<span class="token punctuation">.</span>path<span class="token punctuation">[</span>swapParams<span class="token punctuation">.</span>path<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">require</span><span class="token punctuation">(</span>
            destSwapToken <span class="token operator">==</span> params<span class="token punctuation">.</span>destToken <span class="token operator">||</span>
                <span class="token punctuation">(</span>destSwapToken <span class="token operator">==</span> Utils<span class="token punctuation">.</span>WETH <span class="token operator">&amp;&amp;</span>
                    params<span class="token punctuation">.</span>destToken <span class="token operator">==</span> Utils<span class="token punctuation">.</span>ETH<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"destToken doesn't match"</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token builtin">uint256</span> amountIn <span class="token operator">=</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>amountIn <span class="token operator">*</span> swapParams<span class="token punctuation">.</span>percent<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10000</span><span class="token punctuation">;</span>
        IAdapter adapter <span class="token operator">=</span> <span class="token function">IAdapter</span><span class="token punctuation">(</span>adapters<span class="token punctuation">[</span>swapParams<span class="token punctuation">.</span>adapterId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token builtin">uint256</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> amounts <span class="token operator">=</span> adapter<span class="token punctuation">.</span><span class="token function">swapExactInput</span><span class="token punctuation">(</span>
            swapParams<span class="token punctuation">.</span>routerId<span class="token punctuation">,</span>
            amountIn<span class="token punctuation">,</span>
            swapParams<span class="token punctuation">.</span>amountOut<span class="token punctuation">,</span>
            swapParams<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
            <span class="token keyword">from</span><span class="token punctuation">,</span>
            to<span class="token punctuation">,</span>
            swapParams<span class="token punctuation">.</span>deadline
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        totalAmountsOut <span class="token operator">+=</span> amounts<span class="token punctuation">[</span>amounts<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">emit</span> <span class="token function">Swap</span><span class="token punctuation">(</span>
            msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span>
            params<span class="token punctuation">.</span>to<span class="token punctuation">,</span>
            params<span class="token punctuation">.</span>srcToken<span class="token punctuation">,</span>
            params<span class="token punctuation">.</span>destToken<span class="token punctuation">,</span>
            swapParams<span class="token punctuation">.</span>amountOut<span class="token punctuation">,</span>
            amounts<span class="token punctuation">[</span>amounts<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            swapParams<span class="token punctuation">.</span>percent
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>destToken <span class="token operator">==</span> Utils<span class="token punctuation">.</span>ETH<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">IWETH</span><span class="token punctuation">(</span>Utils<span class="token punctuation">.</span>WETH<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withdraw</span><span class="token punctuation">(</span>totalAmountsOut<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">payable</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>totalAmountsOut<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>It was configured in a form that supports multi-tokens with the same function as the single above. After composing the data corresponding to the multi-token pair with <code class="language-text">SwapStep</code>, the value is stored in the form of an array, and then the previous logic is executed as much as the length of the array to sequentially perform swapping.</li>
<li>Since it is necessary to un-wrapping WETH and exchange it for ETH, when swapping with ether, the address is changed to the address of this contract and then delivered to the user</li>
</ul>
<p>✅ The second require condition is to check if the target token is swap and match the last token, then check if the target token is ETH, and the last token in the address of the multi-token array must be WETH.</p>
<ul>
<li>equally</li>
</ul>
<h3 id="util-functions" style="position:relative;"><a href="#util-functions" aria-label="util functions permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Util Functions</h3>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">function</span> <span class="token function">_wrapETH</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> amountToWrap<span class="token punctuation">,</span> <span class="token builtin">address</span> tokenInput<span class="token punctuation">)</span>
    <span class="token keyword">internal</span>
    <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">address</span> tokenOutput<span class="token punctuation">,</span> <span class="token builtin">address</span> <span class="token keyword">from</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tokenInput <span class="token operator">==</span> Utils<span class="token punctuation">.</span>ETH<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"ERR-04"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>value <span class="token operator">==</span> amountToWrap<span class="token punctuation">,</span> <span class="token string">"ERR-05"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">IWETH</span><span class="token punctuation">(</span>Utils<span class="token punctuation">.</span>WETH<span class="token punctuation">)</span><span class="token punctuation">.</span>deposit<span class="token punctuation">{</span>value<span class="token punctuation">:</span> msg<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tokenOutput <span class="token operator">=</span> Utils<span class="token punctuation">.</span>WETH<span class="token punctuation">;</span>
        <span class="token keyword">from</span> <span class="token operator">=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        tokenOutput <span class="token operator">=</span> tokenInput<span class="token punctuation">;</span>
        <span class="token keyword">from</span> <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>Provides a utility function that wraps ETH into WETH. Given a token, the function returns the WETH address as the token output if the token input is ETH. <code class="language-text">tokenInput</code> token input address, <code class="language-text">amountToWrap</code> used as the amount of token input to wrap. If the token input is not WETH, the return value tokenOutput is the same, and if the token input is not WETH, the from address is msg.sender.</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">function</span> <span class="token function">registerAdapter</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _adapterIdx<span class="token punctuation">,</span> <span class="token builtin">address</span> _routerAddress<span class="token punctuation">)</span>
    <span class="token keyword">external</span>
    onlyOwner
<span class="token punctuation">{</span>
    adapters<span class="token punctuation">[</span>_adapterIdx<span class="token punctuation">]</span> <span class="token operator">=</span> _routerAddress<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>
<p>It is designed to update and modify mapping data for contract adapters management.</p>
</li>
<li>
<p>Finally, Share-Value</p>
</li>
</ul>
<div class="gatsby-highlight" data-language="solidity"><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">function</span> <span class="token function">computeLiquidityShareValue</span><span class="token punctuation">(</span><span class="token builtin">uint</span> liquidity<span class="token punctuation">,</span> <span class="token builtin">address</span> tokenA<span class="token punctuation">,</span> <span class="token builtin">address</span> tokenB<span class="token punctuation">)</span> <span class="token keyword">external</span> override <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token builtin">uint</span> tokenAAmount<span class="token punctuation">,</span> <span class="token builtin">uint</span> tokenBAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">revert</span><span class="token punctuation">(</span><span class="token string">"TODO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span></code></pre></div>
<h2 id="contract-testing---deploy-testnet" style="position:relative;"><a href="#contract-testing---deploy-testnet" aria-label="contract testing   deploy testnet permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contract Testing  &#x26;&#x26; Deploy Testnet</h2>
<ul>
<li>As Uniswap Swapping Contract design and development have been completed previously, simple testing and distribution will be conducted on the Rinkeby testnet.</li>
<li>The data required for testing will be parsed by referring to the DAI, USDC, and USDT ERC20 token contracts that exist on the mainnet.</li>
<li>For some tests, we use the functional Rouunter contract of SushiSwap and ShibaSwap contracts implemented by forking Uniswap, and the current contract that has been deployed for some tests.</li>
</ul>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token punctuation">{</span>
  ChainId<span class="token punctuation">,</span>
  Fetcher<span class="token punctuation">,</span>
  Percent<span class="token punctuation">,</span>
  Route<span class="token punctuation">,</span>
  Token<span class="token punctuation">,</span>
  TokenAmount<span class="token punctuation">,</span>
  Trade<span class="token punctuation">,</span>
  TradeType<span class="token punctuation">,</span>
  <span class="token constant">WETH</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@uniswap/sdk"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BigNumber <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"ethers"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> ethers<span class="token punctuation">,</span> upgrades <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"hardhat"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dotenv <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"dotenv"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dotenv<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">"./.env.local"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> addresses <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">DAI</span><span class="token operator">:</span> <span class="token string">"0x6B175474E89094C44Da98b954EedeAC495271d0F"</span><span class="token punctuation">,</span>
  <span class="token constant">USDC</span><span class="token operator">:</span> <span class="token string">"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"</span><span class="token punctuation">,</span>
  <span class="token constant">DEAD</span><span class="token operator">:</span> <span class="token string">"0x000 000000000000000000000000000000000dEaD"</span><span class="token punctuation">,</span>
  <span class="token constant">USDT</span><span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token string">"0xdac17f958d2ee523a2206206994597c13d831ec7"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token constant">ETH</span><span class="token operator">:</span> <span class="token string">"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE"</span><span class="token punctuation">,</span>
  <span class="token constant">WETH</span><span class="token operator">:</span> <span class="token constant">WETH</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>address<span class="token punctuation">,</span>
  UniswapV2Router<span class="token operator">:</span> <span class="token string">"0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D"</span><span class="token punctuation">,</span>
  SushiSwapRouter<span class="token operator">:</span> <span class="token string">"0xd9e1cE17f2641f24aE83637ab66a2cca9C378B9F"</span><span class="token punctuation">,</span>
  ShibaSwapRouter<span class="token operator">:</span> <span class="token string">"0x03f7724180AA6b939894B5Ca4314783B0b36b329"</span><span class="token punctuation">,</span>
  SwapperContract<span class="token operator">:</span> <span class="token string">"0x522864625577b80fFaae1B94d703a1913350811d"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> DAIContract <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractAt</span><span class="token punctuation">(</span><span class="token string">"IERC20"</span><span class="token punctuation">,</span> addresses<span class="token punctuation">.</span><span class="token constant">DAI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> USDCContract <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractAt</span><span class="token punctuation">(</span><span class="token string">"IERC20"</span><span class="token punctuation">,</span> addresses<span class="token punctuation">.</span><span class="token constant">USDC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> WETHContractIWETH <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractAt</span><span class="token punctuation">(</span><span class="token string">"IWETH"</span><span class="token punctuation">,</span> addresses<span class="token punctuation">.</span><span class="token constant">WETH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> WETHContractIERC20 <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractAt</span><span class="token punctuation">(</span>
    <span class="token string">"IERC20"</span><span class="token punctuation">,</span>
    addresses<span class="token punctuation">.</span><span class="token constant">WETH</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> Utils <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractFactory</span><span class="token punctuation">(</span><span class="token string">"Utils"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> utils <span class="token operator">=</span> <span class="token keyword">await</span> Utils<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> utils<span class="token punctuation">.</span><span class="token function">deployed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> Swapper <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractFactory</span><span class="token punctuation">(</span><span class="token string">"Swapper"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> UniswapV2Adapter <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractFactory</span><span class="token punctuation">(</span><span class="token string">"UniswapV2Adapter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> swap <span class="token operator">=</span> <span class="token keyword">await</span> Swapper<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> uniswapV2Adapter <span class="token operator">=</span> <span class="token keyword">await</span> UniswapV2Adapter<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span>swap<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> swap<span class="token punctuation">.</span><span class="token function">deployed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Swap contract deployed at: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>swap<span class="token punctuation">.</span>address<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> uniswapV2Adapter<span class="token punctuation">.</span><span class="token function">deployed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">UniswapV2Adapter contract deployed at: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>uniswapV2Adapter<span class="token punctuation">.</span>address<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> adaptersRouters <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      adapterAddress<span class="token operator">:</span> uniswapV2Adapter<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
      routers<span class="token operator">:</span> <span class="token punctuation">[</span>
        addresses<span class="token punctuation">.</span>UniswapV2Router<span class="token punctuation">,</span>
        addresses<span class="token punctuation">.</span>SushiSwapRouter<span class="token punctuation">,</span>
        addresses<span class="token punctuation">.</span>ShibaSwapRouter<span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> adaptersRouters<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> swap<span class="token punctuation">.</span><span class="token function">registerAdapter</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> adaptersRouters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>adapterAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Register routers for adapters to use</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> adaptersRouters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>routers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log(`Index: ${j} - Address: ${adaptersRouters[i].routers[j]}`);</span>
      <span class="token keyword">await</span> uniswapV2Adapter<span class="token punctuation">.</span><span class="token function">registerRouter</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> adaptersRouters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>routers<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    DAIContract<span class="token punctuation">,</span>
    USDCContract<span class="token punctuation">,</span>
    WETHContractIWETH<span class="token punctuation">,</span>
    WETHContractIERC20<span class="token punctuation">,</span>
    utils<span class="token punctuation">,</span>
    swap<span class="token punctuation">,</span>
    uniswapV2Adapter<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>Based on the contract that exists on each on-chain and the contract built on the off-chain, the instance is activated and the required method is called.</li>
<li>The necessary part is to register each router with the adapter contract design pattern. At this time, by calling <code class="language-text">registerRounter</code>, which was designed as a utility function in the Swap contract, registration is completed and distribution is completed.</li>
</ul>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">multiSwapp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> chainId <span class="token operator">=</span> ChainId<span class="token punctuation">.</span><span class="token constant">RINKEBY</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token constant">DAI</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Token</span><span class="token punctuation">(</span>chainId<span class="token punctuation">,</span> addresses<span class="token punctuation">.</span><span class="token constant">DAI</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token constant">USDC</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Token</span><span class="token punctuation">(</span>chainId<span class="token punctuation">,</span> addresses<span class="token punctuation">.</span><span class="token constant">USDC</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>owner<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getSigners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Owner: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>owner<span class="token punctuation">.</span>address<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> amountIn <span class="token operator">=</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">parseEther</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> slippageTolerance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Percent</span><span class="token punctuation">(</span><span class="token string">"50"</span><span class="token punctuation">,</span> <span class="token string">"10000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> pair <span class="token operator">=</span> <span class="token keyword">await</span> Fetcher<span class="token punctuation">.</span><span class="token function">fetchPairData</span><span class="token punctuation">(</span><span class="token constant">DAI</span><span class="token punctuation">,</span> <span class="token constant">WETH</span><span class="token punctuation">[</span><span class="token constant">DAI</span><span class="token punctuation">.</span>chainId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> pair2 <span class="token operator">=</span> <span class="token keyword">await</span> Fetcher<span class="token punctuation">.</span><span class="token function">fetchPairData</span><span class="token punctuation">(</span><span class="token constant">DAI</span><span class="token punctuation">,</span> <span class="token constant">USDC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Route</span><span class="token punctuation">(</span><span class="token punctuation">[</span>pair<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">WETH</span><span class="token punctuation">[</span><span class="token constant">DAI</span><span class="token punctuation">.</span>chainId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> route2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Route</span><span class="token punctuation">(</span><span class="token punctuation">[</span>pair2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">DAI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> trade <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Trade</span><span class="token punctuation">(</span>
    route<span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">TokenAmount</span><span class="token punctuation">(</span><span class="token constant">WETH</span><span class="token punctuation">[</span><span class="token constant">DAI</span><span class="token punctuation">.</span>chainId<span class="token punctuation">]</span><span class="token punctuation">,</span> amountIn<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    TradeType<span class="token punctuation">.</span><span class="token constant">EXACT_INPUT</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token punctuation">[</span>addresses<span class="token punctuation">.</span><span class="token constant">ETH</span><span class="token punctuation">,</span> addresses<span class="token punctuation">.</span><span class="token constant">DAI</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> path2 <span class="token operator">=</span> <span class="token punctuation">[</span>addresses<span class="token punctuation">.</span><span class="token constant">DAI</span><span class="token punctuation">,</span> addresses<span class="token punctuation">.</span><span class="token constant">USDC</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> amountOutMin <span class="token operator">=</span> trade<span class="token punctuation">.</span><span class="token function">minimumAmountOut</span><span class="token punctuation">(</span>slippageTolerance<span class="token punctuation">)</span><span class="token punctuation">.</span>raw<span class="token punctuation">;</span> <span class="token comment">// needs to be converted to e.g. hex</span>
  <span class="token keyword">const</span> deadline <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 20 minutes from the current Unix time</span>

  <span class="token keyword">const</span> SwapperFactory <span class="token operator">=</span> <span class="token keyword">await</span> ethers<span class="token punctuation">.</span><span class="token function">getContractFactory</span><span class="token punctuation">(</span><span class="token string">"Swapper"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> Swapper <span class="token operator">=</span> <span class="token keyword">await</span> SwapperFactory<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>addresses<span class="token punctuation">.</span>SwapperContract<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"approve Swapper transfer for init.."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> tx <span class="token operator">=</span> <span class="token keyword">await</span> Swapper<span class="token punctuation">.</span><span class="token function">multiSwapExactInput</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
      to<span class="token operator">:</span> owner<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
      amountIn<span class="token punctuation">,</span>
      srcToken<span class="token operator">:</span> path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      destToken<span class="token operator">:</span> path<span class="token punctuation">[</span>path<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      swaps<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          routerId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          adapterId<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          amountOut<span class="token operator">:</span> amountOutMin<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          deadline<span class="token punctuation">,</span>
          path<span class="token operator">:</span> <span class="token punctuation">[</span>addresses<span class="token punctuation">.</span><span class="token constant">WETH</span><span class="token punctuation">,</span> addresses<span class="token punctuation">.</span><span class="token constant">DAI</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          percent<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> amountIn <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">MultiSwapExactInput tx: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tx<span class="token punctuation">.</span>hash<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>Next, in the state of simple deployment, we plan to test the swapping function for each token with the test net and query the data of the event that occurred in SubGraph.</li>
<li>Test the ETH↔DAI pair token through Uniswap Swapping.</li>
<li>Finally, deployment and testing are completed.</li>
</ul>
<h3 id="uniswap-contract-code" style="position:relative;"><a href="#uniswap-contract-code" aria-label="uniswap contract code permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Uniswap Contract Code</h3>
<ul>
<li>Github RP:  <a href="https://github.com/dnsdudrla97/unswap-contract">https://github.com/dnsdudrla97/unswap-contract</a></li>
</ul>
<div class="table-of-contents">
<ul>
<li>
<p><a href="#uniswap-code-level">Uniswap Code Level</a></p>
<ul>
<li><a href="#two-models-of-exchange-way">Two models of exchange way</a></li>
</ul>
</li>
<li>
<p><a href="#uniswap-code-component">Uniswap Code Component</a></p>
<ul>
<li><a href="#core-contract">Core Contract</a></li>
</ul>
</li>
<li>
<p><a href="#periphery-contract">Periphery Contract</a></p>
</li>
<li>
<p><a href="#core-contract-pair">Core. Contract (Pair)</a></p>
<ul>
<li><a href="#contract-init--state-variable">Contract Init &#x26;&#x26; State Variable</a></li>
<li><a href="#vaults-managerment-features">Vaults Managerment features</a></li>
<li><a href="#how-to-store-tokens">How to store tokens?</a></li>
<li><a href="#mint--burn-features">Mint , Burn Features</a></li>
<li><a href="#contract-dependencies">Contract Dependencies</a></li>
<li><a href="#interface">Interface</a></li>
<li><a href="#interface-asset">Interface Asset</a></li>
<li><a href="#interface-uniswapv2pair">Interface UniswapV2Pair</a></li>
<li><a href="#interface-weth">Interface WETH</a></li>
</ul>
</li>
<li>
<p><a href="#swapper-contract-design">Swapper Contract Design</a></p>
<ul>
<li><a href="#how-to-pricing-a-transaction">How to Pricing a Transaction</a></li>
<li><a href="#how-uniswap-handles-pricing">How Uniswap Handles Pricing</a></li>
<li><a href="#price-trading">price trading</a></li>
<li><a href="#state-variables">State Variables</a></li>
<li><a href="#functions">Functions</a></li>
<li><a href="#util-functions">Util Functions</a></li>
</ul>
</li>
<li>
<p><a href="#contract-testing---deploy-testnet">Contract Testing  &#x26;&#x26; Deploy Testnet</a></p>
<ul>
<li><a href="#uniswap-contract-code">Uniswap Contract Code</a></li>
</ul>
</li>
</ul>
</div></div></div><div class="post-navigator"><div class="post-navigator-card-wrapper"><a class="post-card prev" href="/defi-wargame-6/"><div class="direction">이전 글</div><div class="title">Damn Vulnerable DeFi Wargame Challenge6 — Selfie Contract Analysis ⚔️</div></a></div><div class="post-navigator-card-wrapper"><a class="post-card next" href="/uniswap-contract-event-graph/"><div class="direction">다음 글</div><div class="title">UniswapV2 Smart Contract Subgraph event query</div></a></div></div><div class="utterances"></div></main><footer class="page-footer-wrapper"><p class="page-footer">© <!-- -->2022<!-- --> <a href="https://github.com/dnsdudrla97">Zer0Luck</a></p></footer><div class="dark-mode-button-wrapper"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium dark-mode-button css-1yxmbwk" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeLarge dark-mode-icon css-6flbmm" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="DarkModeIcon"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path></svg></button></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1H8JDW20BR"></script><script>
      window.excludeGtagPaths=[/^(?:\/preview\/(?:(?!(?:\/|^)\.).)*?)$/,/^(?:\/do\-not\-track\/me\/too\/)$/];
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-1H8JDW20BR',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-1H8JDW20BR', {"optimize_id":"OPT_CONTAINER_ID","anonymize_ip":true,"cookie_expires":0,"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/uniswap-contract/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-1c8b3614439a319fec88.js"],"app":["/app-7897b1f0db63ccdad229.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-337569e9b8b595464a6b.js"],"component---src-pages-404-js":["/component---src-pages-404-js-4af44e3849f20b513e0c.js"],"component---src-pages-about-js":["/component---src-pages-about-js-4e6e8748abdae0a93053.js"],"component---src-pages-index-js":["/component---src-pages-index-js-88360669b62621f749e1.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-484a59d2475d768e59bb.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-d285fa677ae56436e6bf.js"]};/*]]>*/</script><script src="/polyfill-1c8b3614439a319fec88.js" nomodule=""></script><script src="/component---src-templates-blog-template-js-484a59d2475d768e59bb.js" async=""></script><script src="/f9d3028dbef90a6e9b8db85387d63dd9f4edf538-7d0583450b37cf198871.js" async=""></script><script src="/app-7897b1f0db63ccdad229.js" async=""></script><script src="/framework-98bc37d489de49fb3b96.js" async=""></script><script src="/webpack-runtime-21c37c0047ec80635d32.js" async=""></script></body></html>